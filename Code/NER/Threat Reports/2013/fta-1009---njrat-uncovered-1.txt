ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020Fidelis Threat Advisory #1009 ¡°njRAT¡± Uncovered June 28, 2013 Document Status: FINAL Last Revised: 2013-06-28 Executive Summary In the past thirty days (30) an increase attack activity has been observed using the "njRAT" malware. This remote access trojan (RAT) has capabilities to log keystrokes, access the victim's camera, steal credentials stored in browsers, open a reverse shell, upload/download files, view the victim's desktop, perform process, file, and registry manipulations, and capabilities to let the attacker update, uninstall, restart, close, disconnect the RAT and rename its campaign ID. Through the Command & Control (CnC) server software, the attacker has capabilities to create and configure the malware to spread through USB drives. "njRAT" is currently leveraged by advanced threat actors in the Middle East, in particular when delivered via HTTP (i.e. Phishing attack or Drive-by download). It has also been observed that attackers are delivering "njRAT" embedded in other applications (i.e. L517 v.0.994 Word List Generator), and compressed with EZIRIZ .NET Reactor/.NET protector. Obfuscation with the use of compressors or protectors is a technique used by attackers to prevent detection by network-based and host-based security defenses. We have observed the majority of the attacks leveraging "njRAT" to be against organizations based in or focused on the Middle East region in the government, telecom, and energy sectors. However as this is a publicly available tool it can be attained and deployed with ease regardless of location or industry. During the analysis of "njRAT", it was observed that some of the top antivirus vendors were not currently detecting some variants of this threat. Some of the file names of carrier files or njRAT samples observed were: L517 v0.994.exe, RealUpgrade.exe, password hotmail cracker 2013.exe, elisa.exe, Crack All Games.exe, fresh cc Usersargatedpermisiontocopand/odistributethisdocumentinitsorigialelectronicformandprintcopiesforpersonaluse.Thsdocumencanotbemdifedorconvrtedtoanyothrelectronicrmachine-readbleforminwholeorinpartwithoutpriorwrittapprovalfFidelisSecuritySystms,Inc.Whilewhavedoneourbesttoesurethatthematerialfoundinthisdocumentisaccurate,FidelisSecuritySystems,Inc.makesnoguaranteethattheinformationcontainedhereiniserrorfree.Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page1of27 ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020cvv all info 2013_txt.scr, spoolsv.exe, Hack Origin Game's.exe, Authorization form may -2013 .115444.scr, and Authorization.exe. This document will provide detailed information about the njRAT's functionality, file system indicators, network indicators, some of the campaign IDs observed, MD5 hashes, and domains. It will also go over a detailed analysis of one of the malware variants. Threat Overview The "njRAT" is a robust remote access trojan that once it reaches and infects the end-point, allows the attacker to have full control over the Victim system. With this access, the attacker can start scanning other systems in the victim network to perform lateral movement. We will start this section by performing analysis on the following "njRAT" sample: -Filename: Authorization.exe -MD5: 1d3baedd747f6f9bf92c81eb9f63b34b The "Authorization.exe" njRAT malware was embedded and dropped in the victim system by the following file: "Authorization form may -2013 -115444.scr" (MD5: 63781fe1932e612c6c29225d25515111). The next section (Indicators & Mitigation Strategies), will provide information about other variants of the malware obtained. Summary The "Authorization.exe" malware sample was created with version V.0.5 of this RAT. The njRAT application was developed with VB.NET (Visual Basic .NET). When the malware connects to the Command & Control (CnC) server, the attacker is able to perform the following actions from the njRAT CnC server GUI: -Open a 'File Manager' window to manipulate files o This window allows the attacker to Upload & Download, Run, Delete, Edit, Rename, Copy, Cut, Paste, and Empty files. o The window also allows the attacks to create new folders in the Victim system -Open a 'Run File' window o This window allows the attacker to upload a file, or provide a link to a file to run in the Victim system -Open a 'Remote Desktop' window o When selected, it opens a live window of the Victim's user desktop -Open a 'Remote Cam' window o This window allows the attacker to obtain access to the Victim's system camera to see the Victim user Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page2of27 ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSys-Open a 'Remote Shell' window o This window opens a reverse shell window and allow the attacker to perform all the activities possible from the command prompt -Open a 'Process Manager' window o This window allows the attacker to Refresh the process list, Kill processes, Suspend processes, Resume processes -Open a 'Registry' window o This window allows the attacker manipulate the Victim's system registry (edit, delete, create keys and values) -Open a 'Keylogger' window o When this option is selected, the keylogger file is automatically uploaded from the Victim system into the attacker's machine -Open a 'Get Passwords' window o This window appears to collect all the passwords stored by the browser (User, Password, URL, App). At the moment of writing this report, the functionality was not confirmed. When the option is selected, the malware searches Mozilla Firefox, Google Chrome, Opera directories. -Open a 'Server' window o This window allows the attacker to Update, Uninstall, Restart, Close, Disconnect, or Rename the malware running in the Victim system -Open an 'Open Folder' window o This window open the local folder in the attackers machine in which the artifacts collected through the "njRAT" GUI are stored in his/her system -Open a 'Builder' Window o This window allows the attacker to build new Clients to be deployed to Victims or used in attack campaigns. Some of the options in this builders allows the attacker to configure:  C2 node IP  C2 node port  Vic Tim Name (Looks like this could be used to identify the attack campaign)  Malware name (when it makes a copies itself)  Directory to make a copy of the malware when it is executed  Capabilities to spread via USB  Select the malware icon  Protect the malware process  Stub Randomization Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page3of27 ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020The following is a screenshot of the "njRAT" v.0.5 CnC GUI when a Victim system connects to it: The following "About" information was observed in this version (0.5.0) of the C2 server software found online: Rev.2013-06-25¡°njRAT¡± Uncovered ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020The following screenshot shows the Builder interface and default parameters: The "Authorization.exe" malware has keylogger functionality. It stores the logged keystrokes in the following file: "[CWD]\.tmp". When the malware is dropped by the "Authorization form may -2013 -115444.scr" carrier file, the logged keystrokes are stored in: "C:\Extracted\.tmp". The IP address used by the Command & Control (C2) node appears to be under an IP range owned by: "Palestinian Internet Services, P. O. BOX 5111 Gaza City, Palestine". Variants of this malware have been observed by the community since at least 2012. The malware appears to be known by the community as: njRAT, MSIL/Bladabindi, and Backdoor.LV. When the "Authorization.exe" malware is executed it: -Creates a copy of itself in the following locations: o %APPDATA%\msnco.exe o C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\b6554e5bcfef391ff7a7ffda58092e10.exe -Tries to open the following file: [CWD]\ Authorization.exe.config -Entrenches in the system for persistence in the following registry locations: o HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Ru n\b6554e5bcfef391ff7a7ffda58092e10 o HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\R un\b6554e5bcfef391ff7a7ffda58092e10 Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page5of27 ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSysMakes the following modifications to the registry to bypass the Windows Firewall: o Key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAcc ess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplic ations\List\[%APPDATA%]\msnco.exe o Value: [%APPDATA%]\msnco.exe:*:Enabled:msnco.exe -Beacons to the following C2 node over TCP port 1177:"217.66.231.245" The attacker tries to make sure the malware will run in the system by making the second copy into the above mentioned directory (C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\b6554e5bcfef391ff7a7ffda58092e10.exe) o This causes the malware to execute again when the system is rebooted and re-starts the infection in the system. Once the system is infected again, it will beacon to the C2 node. The attacker tries to trick the user by using different icons for the malware. Various samples were observed with MS Word and PDF icons. The following is a screenshot of how the file will look like to a normal user: When the system is configured to show file extensions, the EXE extension is now revealed: When the malware connects to the C2 node, it will send information about the victim system, malware version, open windows, etc. The following is the network traffic observed: ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020The following table provides information of some of the fields observed in the network traffic: Field  Information  TndfQzQyNjRFQkI=  Base64 encoded data. The decoded data reveals the following string: "Nw_C4264EBB". It appears that the string before the "_" (Nw) can be used by the attacker to identify the attack campaign. This is configured through the "njRAT" builder GUI. The second portion ("C4264EBB") is the Volume Serial Number of the victim system  VICTIM  Computer name  Examiner  Username  2013-06-21  Date Modified attribute of the malware. This date will match the first time the file is created in the victim system  USA  System locale  Win XP ProfessionalSP2 x86  Operating System Information  No  Report if the system has a camera  0.5.0E  Malware version  Y3B0YnRfUHJvY2Vzc19S ZWdpc3RyeV9GaWxlX0lu Zm8ubG9nIC0gTm90ZXB hZA==  Base64 encoded data. The decoded data reveals the following string: "cptbt_Process_Registry_File_Info.log -Notepad". In this case, the decoded string is just information about an open window used by the examiner to capture system activity  Information sent by the attacker on opened windows in the system could inform him/her of his malware being analyzed and allowed to connect to the C2 node. For example, if Wireshark, Filemon, Regmon, and IDA are opened in the system when the analyst executes the malware, this will quickly let the attacker know that someone is performing reverse engineering of his malicious code. Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page7of27 ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSysThe "Authorization.exe"variantinthisreportappearstohavebeenavailableatsome pointthroughthefollowingURL:"hxxp://bongdacongdong.vn/authorization.exe". ThedomaincurrentlyresolvestothefollowingIPaddress:"112.213.89.144",butat somepoint,thedomainwasassociatedwiththefollowingIPaddress:"31.170.165.90". ThefollowinginformationwasfoundatVirustotalfor"31.170.165.90": ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSys"Authorization.exe" File Information File Name: Authorization.exe File Size: 110080 bytes MD5: 1d3baedd747f6f9bf92c81eb9f63b34b SHA1: 328c12ba3e6e99e63968b066455b7575e7ee862b PE Time: 0x5197ACE1 [Sat May 18 16:31:29 2013 UTC] PEID Sig: Microsoft Visual C# / Basic .NET PEID Sig: Microsoft Visual Studio .NET Sections (4): Name Entropy MD5 .text 5.09 dd1ed0314f376bad9786d08b53796a67 .sdata 7.99 f92654e72b03e352178cad42896f9662 .rsrc 5.65 03e4e092203078e7957cd7c164240f3d .reloc 0.08 3f2e9251bcd17a2cb17e9202d1b100d3 Antivirus Hits AV Tool  Common Name  Kaspersky  Trojan.MSIL.Zapchast.zlg  AntiVir  TR/MSIL.Zapchast.zlg  Avast  Win32:Malware-gen  AVG  Generic33.AHLZ  BitDefender  Trojan.GenericKDV.1013622  F-Secure  Trojan.GenericKDV.1013622  Fortinet  W32/Zapchast.ZLG!tr  McAfee  RDN/Generic.grp!ep  Microsoft  Trojan:Win32/Comitsproc  Norman  Troj_Generic.LRVVH  Sophos  Mal/Generic-S  Symantec  WS.Reputation.1  TrendMicro  TROJ_GEN.RCCCDF5  VIPRE  Trojan.Win32.Generic!BT  Process artifacts The following processes were started when the "Authorization.exe" malware was executed:  C:\Windows\System32\netsh.exe  %APPDATA%\msnco.exe Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page10of27 ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020File system artifacts The following files were created when the "Authorization.exe" malware was executed:  %APPDATA%\msnco.exe  C:\WINDOWS\Prefetch\AUTHORIZATION.EXE-0AD199D6.pf  C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\b6554e5bcfef391ff7a7ffda58092e10.exe  C:\WINDOWS\Prefetch\NETSH.EXE-085CFFDE.pf  C:\WINDOWS\Prefetch\MSNCO.EXE-1616CBE8.pf  [CWD] \.tmp (or when created by the original dropper: "C:\Extracted\.tmp") Registry artifacts The following registry values were set by the "Authorization.exe" malware when it was executed:  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\b6554e5 bcfef391ff7a7ffda58092e10 [Value: "[%APPDATA%]\msnco.exe" ..]  HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\b6554e 5bcfef391ff7a7ffda58092e10 [Value: "[%APPDATA%]\msnco.exe" ..]  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Para meters\FirewallPolicy\StandardProfile\AuthorizedApplications\List\ [%APPDATA%]\msnco.exe [Value: [%APPDATA%]\msnco.exe:*:Enabled:msnco.exe] Network artifacts Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page11of27 Domain/IP  Port  Encrypted/Encoded  217.66.231.245  1177  Some data is Base64 encoded  ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020Indicators & Mitigation Strategies: The following three (3) tables will provide information about some of the malware observed to be njRAT itself or carrier files that once executed dropped njRAT in the victim system. The first table contains the MD5 hash , size, domain, port, njRat version, and campaign ID. The second table contains information about the file system artifacts (kelogger file location, files created). The third table contains information about registry key entrenchment for persistence. Then, a list of network indicators will be provided to assist network defenders with the creation of signatures to be deployed to the sensors. Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page12of27 ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020Table 1: MD5 hash, size, domain/IP, port, njRat version, and campaign ID Note: The Campaing ID named "HacKed" is the default string in the njRAT Builder interface. Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page13of27 MD5  Size (bytes)  Domain/IP  Port  Versio n  Campaign ID  2013385034e5c8dfbbe47958fd821ca0  441344  dr-vip.no-ip.org  1177  0.5.0E     7c42d2426c51318f5947a92bf23e1686  839101  mp3.servemp3.com  9632  0.5.0E  _     a6da3b63981e345e1c3cd58c6e3dc7fc  123904  mp3.servemp3.com  9632  0.5.0E  _     e1471b169d6b4049d757bb705877d329  233984  kyfen.dyndns.biz  288  0.5.0E  ~ ~  1d3baedd747f6f9bf92c81eb9f63b34b  790235  217.66.231.245  1177  0.5.0E  Nw  a669c0da6309a930af16381b18ba2f9d  26624  ksadxxd24.no-ip.org  80  0.3.6      5fcb5282da1a2a0f053051c8da1686ef  30208  xxsniper.no-ip.biz  81  0.3.5  sniper jordan  3b99f596b36ece7b6add78e3b14a3b17  295640  mohammad3badi.zapto.or g  120  0.5.0E  26-3-2013  79dce17498e1997264346b162b09bde8  40960  naif.no-ip.org  1177  0.4.1a  2013  3ad5fded9d7fdf1c2f6102f4874b2d52  79360  wolblid.zapto.org  1177  0.5.0E  VictimO  fc96a7e27b1d3dab715b2732d5c86f80  977408  m3333m.no-ip.org  1177  0.3.6  NEW XXX  60f1b8980d109a556922d5000ae02010  123084 8  zackhaviland.no-ip.org  1177  0.5.0E  leak  92ee1fb5df21d8cfafa2b02b6a25bd3b  26624  alitatat.no-ip.org  1177  0.3.6  IRAQ  2164c555f9f23dca54e76b94b1747480  59392  kurdkalar11.zapto.org  1177  0.5.0E  HacKed_By_XF  a98b4c99f64315aac9dd992593830f35  44544  kurdkalar11.zapto.org  1177  0.5.0E  HacKed_By_XF  7e34abdd10c5c763291e69a886452849  50688  hack-badone.no-ip.biz  1177  0.5.0E  HacKed By Badone  29daad42dafffab5e0f1f96d620e7392  96256  special.no-ip.biz  1500  0.5.0E  HacKed  4168543695513f767ba44997ebd71431  244736  nasr23200.no-ip.org  1177  0.5.0E  HacKed  fb671c8735461809534813b818d193f4  187904  wisam77.no-ip.biz  1177  0.5.0E  HacKed  2bf859ea02ae3340cd66eb5e46b1a704  75264  hassoon03.no-ip.info  1177  0.5.0E  HacKed  24cc5b811a7f9591e7f2cb9a818be104  314880  samirsamir.hopto.org  1177  0.5.0E  HacKed  11b79281a25da1b798574f667c56898b  428032  gdsg.no-ip.org  1199  0.5.0E  HacKed  2cdbbe5045bed2031a1fc77c3e30e719  583747  Saman70.no-ip.org  1177  0.5.0E  HacKed  f6b4a2be06fc3ba4bb02d1bcbea328fe  95232  Saman70.no-ip.org  1177  0.5.0E  HacKed  ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSys MD5  Keylogger File  Created Malware  2013385034e5c8dfbbe47958fd821ca0  %APPDATA%\ja33kk.exe.t mp  %APPDATA%\ja33kk.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\9758a8dfbe15a00f55a11c8306f80da1. exe  7c42d2426c51318f5947a92bf23e1686  [CWD]\.tmp  %USERPROFILE%\RealUpgrade.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\d30ac691925b853d59f2822ae7a67c9 4.exe (MD5: a6da3b63981e345e1c3cd58c6e3dc7fc, Size: 123904)  a6da3b63981e345e1c3cd58c6e3dc7fc  [CWD]\.tmp  %USERPROFILE%\RealUpgrade.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\d30ac691925b853d59f2822ae7a67c9 4.exe  e1471b169d6b4049d757bb705877d329  [CWD]\.tmp  %TEMP%\java.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\d2be3e6d11846430c067fc874a79f583 .exe  Table 2: MD5 hash, File system artifacts Note: The copy of njRAT created with the filename "Trojan.exe", is the default filename string in the njRAT Builder interface. The Keylogger file location referred to as "[CWD]\.tmp", refers to the location from which the original malware is executed. It was observed that this was used when the malware was embedded in a legitimate looking application, and the kelogger files get created in the directory of that application (i.e. C:\Program Files\Facebook\QuadAtom\.tmp). Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page14of27 ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSys1d3baedd747f6f9bf92c81eb9f63b34b  C:\Extracted\.tmp [CWD]\.tmp  %APPDATA%\msnco.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\b6554e5bcfef391ff7a7ffda58092e10.e xe  a669c0da6309a930af16381b18ba2f9d  %TEMP%\Trojan.exe.tmp  %TEMP%\Trojan.exe C:\Documents and Settings\Examiner\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  5fcb5282da1a2a0f053051c8da1686ef  %TEMP%\Trojan.exe.log  %TEMP%\Trojan.exe C:\Documents and Settings\Examiner\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  3b99f596b36ece7b6add78e3b14a3b17  [CWD]\.tmp  %TEMP%\mohd.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\2635ef5d1f5dc1ac753feb21f019d8e4. exe  79dce17498e1997264346b162b09bde8  %APPDATA%\Trojan.exe.t mp  %APPDATA%\Trojan.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\8515eb34d8f9de5af815466e9715b3e 5.exe  3ad5fded9d7fdf1c2f6102f4874b2d52  %TEMP%\trojen.exe.tmp  %TEMP%\trojen.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\49afcb0bd0c44cd98007157d78e8394 a.exe  fc96a7e27b1d3dab715b2732d5c86f80  %TEMP%\Trojan.exe.tmp  %TEMP%\Trojan.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  60f1b8980d109a556922d5000ae02010  %TEMP%\file.exe.tmp  %TEMP%\file.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\1052b8e9071d5b658c32c84c463014f 5.exe  92ee1fb5df21d8cfafa2b02b6a25bd3b  %APPDATA%\Trojan.exe.t mp  %APPDATA%\Trojan.exe C:\Documents and Settings\Examiner\Start Menu\Programs\Startup\8515eb34d8f9de5af815466e9715b3e 5.exe  2164c555f9f23dca54e76b94b1747480  %TEMP%\scvhost.exe.tmp  %TEMP%\scvhost.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\8cff24636d2a58810bd5cdc8cb1b8987 .exe %TEMP%\1.exe (MD5: a98b4c99f64315aac9dd992593830f35. Size: 44544)  Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page15of27 ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSys%TEMP%\2.exe  a98b4c99f64315aac9dd992593830f35  %TEMP%\scvhost.exe.tmp  %TEMP%\scvhost.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\8cff24636d2a58810bd5cdc8cb1b8987 .exe %TEMP%\1.exe (MD5: a98b4c99f64315aac9dd992593830f35. Size: 44544) %TEMP%\2.exe (MD5: a98b4c99f64315aac9dd992593830f35)  7e34abdd10c5c763291e69a886452849  %TEMP%\system.exe.tmp  %TEMP%\system.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\12ce4e06a81e8d54fd01d9b762f1b1bb .exe  29daad42dafffab5e0f1f96d620e7392  [CWD]\.tmp  %TEMP%\Trojan.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  4168543695513f767ba44997ebd71431  [CWD]\.tmp  %TEMP%\Trojan.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  fb671c8735461809534813b818d193f4  %TEMP%\wsmlol.exe.tmp  %TEMP%\wsmlol.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\191530b485fd6f0420e2c6bff7f0dbd7.e xe  2bf859ea02ae3340cd66eb5e46b1a704  [CWD]\.tmp  %TEMP%\Trojan.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  24cc5b811a7f9591e7f2cb9a818be104  %APPDATA%\spoolsv.exe .tmp  %APPDATA%\spoolsv.exe (MD5: 24cc5b811a7f9591e7f2cb9a818be104, size: 314880) C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\28a9e392f74a71da2b5285754eb1bac a.exe  11b79281a25da1b798574f667c56898b  %TEMP%\Win7.exe.tmp  %TEMP%\Win7.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\614ef891df302ed5efa9b06422720faf. exe  2cdbbe5045bed2031a1fc77c3e30e719  C:\Program Files\Facebook\QuadAtom\ .tmp  %TEMP%\Trojan.exe (MD5: f6b4a2be06fc3ba4bb02d1bcbea328fe, Size: 95232) C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page16of27 ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSysf6b4a2be06fc3ba4bb02d1bcbea328fe  [CWD]\.tmp, or C:\Program Files\Facebook\QuadAtom\ .tmp  %TEMP%\Trojan.exe C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Startup\5cd8f17f4086744065eb0992a09e05a2 .exe  Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page17of27 MD5  Registry Entrenchment  2013385034e5c8dfbbe47958fd821ca0  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\9758a8dfbe 15a00f55a11c8306f80da1 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\9758a8dfbe 15a00f55a11c8306f80da1  7c42d2426c51318f5947a92bf23e1686  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\d30ac69192 5b853d59f2822ae7a67c94 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\d30ac6 91925b853d59f2822ae7a67c94  a6da3b63981e345e1c3cd58c6e3dc7fc  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\d30ac69192 5b853d59f2822ae7a67c94 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\d30ac6 91925b853d59f2822ae7a67c94  e1471b169d6b4049d757bb705877d329  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\d2be3e6d11 846430c067fc874a79f583 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\d2be3e 6d11846430c067fc874a79f583  1d3baedd747f6f9bf92c81eb9f63b34b  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\b6554e5bcf ef391ff7a7ffda58092e10 HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\b6554e5bcf ef391ff7a7ffda58092e10  a669c0da6309a930af16381b18ba2f9d  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f40 86744065eb0992a09e05a2  5fcb5282da1a2a0f053051c8da1686ef  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f40 86744065eb0992a09e05a2  3b99f596b36ece7b6add78e3b14a3b17  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\2635ef5d1f5 dc1ac753feb21f019d8e4 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\2635ef5 d1f5dc1ac753feb21f019d8e4  79dce17498e1997264346b162b09bde8  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\8515eb34d8 f9de5af815466e9715b3e5 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\8515eb 34d8f9de5af815466e9715b3e5  3ad5fded9d7fdf1c2f6102f4874b2d52  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\49afcb0bd0 c44cd98007157d78e8394a  ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020Table 3: MD5 hash, Registry artifacts Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutionsThreatAdvisory#1009 Page18of27 Rev.2013-06-25ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSysHKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\49afcb0bd0 c44cd98007157d78e8394a  fc96a7e27b1d3dab715b2732d5c86f80  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\5cd8f17 f4086744065eb0992a09e05a2  60f1b8980d109a556922d5000ae02010  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\1052b8e907 1d5b658c32c84c463014f5 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\1052b8 e9071d5b658c32c84c463014f5  92ee1fb5df21d8cfafa2b02b6a25bd3b  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\8515eb34d8 f9de5af815466e9715b3e5 HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\8515eb34d 8f9de5af815466e9715b3e5  2164c555f9f23dca54e76b94b1747480  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\8cff24636d2 a58810bd5cdc8cb1b8987 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\8cff246 36d2a58810bd5cdc8cb1b8987  a98b4c99f64315aac9dd992593830f35  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\8cff24636d2 a58810bd5cdc8cb1b8987 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\8cff246 36d2a58810bd5cdc8cb1b8987  7e34abdd10c5c763291e69a886452849  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\12ce4e06a8 1e8d54fd01d9b762f1b1bb HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\12ce4e 06a81e8d54fd01d9b762f1b1bb  29daad42dafffab5e0f1f96d620e7392  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\5cd8f17 f4086744065eb0992a09e05a2  4168543695513f767ba44997ebd71431  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\5cd8f17 f4086744065eb0992a09e05a2  fb671c8735461809534813b818d193f4  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\191530b485 fd6f0420e2c6bff7f0dbd7 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\191530b485 fd6f0420e2c6bff7f0dbd7  2bf859ea02ae3340cd66eb5e46b1a704  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408  Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutions Rev.2013-06-25ThreatAdvisory#1009 Page19of27 ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSys6744065eb0992a09e05a2  24cc5b811a7f9591e7f2cb9a818be104  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\28a9e392f7 4a71da2b5285754eb1baca HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\28a9e392f7 4a71da2b5285754eb1baca  11b79281a25da1b798574f667c56898b  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\614ef891df3 02ed5efa9b06422720faf HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\614ef891df3 02ed5efa9b06422720faf  2cdbbe5045bed2031a1fc77c3e30e719  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2  f6b4a2be06fc3ba4bb02d1bcbea328fe  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\5cd8f17f408 6744065eb0992a09e05a2  The following will present the network traffic observed when different options were selected from the "njRAT" C2 server GUI (YELLOW = Data sent by C2. TURQUOISE = Response from Victim). These artifacts will hopefully assist the research community with generation of network signatures to detect this threat: -File Manager window In this case, the "C:\" directory of the Victim system was browsed and a folder named "njRAT_Directory_Created" was created in it. Main network traffic indicators of C2 activity through its "File Manager" window: o "FM|'|'|" o "nd|'|'|" New directory to be created Encoded Data  Decoded Data  QzpcO0ZpeGVk  C:\;Fixed  QzpcRG9jdW1lbnRzIGFuZCBTZXR0aW5nc1xFeGFtaW 5lclxEZXNrdG9wXDs=  C:\Documents and Settings\Examiner\Desktop\;  QzpcRG9jdW1lbnRzIGFuZCBTZXR0aW5nc1xFeGFtaW 5lclw7  C:\Documents and Settings\Examiner\;  QzpcRG9jdW1lbnRzIGFuZCBTZXR0aW5nc1xFeGFtaW 5lclxTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBc Ow==  C:\Documents and Settings\Examiner\Start Menu\Programs\Startup\;  bnRsZHI7MjUwMDMy;cGFnZWZpbGUuc3lzOzgwNTMw NjM2OA==  ntldr;250032  TlRERVRFQ1QuQ09NOzQ3NTY0  NTDETECT.COM;47564  TVNET1MuU1lTOzA=  MSDOS.SYS;0  ezkzNjI4OTA2LUE2QUItNENFNC1BQzhCLUI0MkYwRT hCRTc5N30=  {93628906-A6AB-4CE4-AC8B-B42F0E8BE797}  cGFnZWZpbGUuc3lzOzgwNTMwNjM2OA==  pagefile.sys;805306368  QzpcbmpSQVRfRGlyZWN0b3J5X0NyZWF0ZWQ=  C:\njRAT_Directory_Created  ww.fidelissecuritywww.threatgeek.om@FidSecSys+1800.652.4020In this case, an application called BinText (bintext.exe) was selected in the Attacker's Machine. This application was executed in the Victim's machine. The Victim system responded with the name of the new window opened: Encoded Data  Decoded Data  QmluVGV4dCAzLjAuMw==  BinText 3.0.3  Encoded Data  Decoded Data  TWljcm9zb2Z0IFdpbmRvd3MgWFAgW1ZlcnNpb24gNS 4xLjI2MDBd  Microsoft Windows XP [Version 5.1.2600]  KEMpIENvcHlyaWdodCAxOTg1LTIwMDEgTWljcm9zb2 Z0IENvcnAu  (C) Copyright 1985-2001 Microsoft Corp.  ZGlyIEM6XA==  dir C:\  QzpcRG9jdW1lbnRzIGFuZCBTZXR0aW5nc1xFeGFtaW 5lclxEZXNrdG9wXEdEPmRpciBDOlw=  C:\Documents and Settings\Examiner\Desktop\GD>dir C:\  ww.fidelissecuritywww.threatgeek.om+1800.652.4020@FidSecSysIFZvbHVtZSBpbiBkcml2ZSBDIGhhcyBubyBsYWJlbC4=  Volume in drive C has no label.  IFZvbHVtZSBTZXJpYWwgTnVtYmVyIGlzIEM0MjYtNEV CQg==  Volume Serial Number is C426-4EBB  IERpcmVjdG9yeSBvZiBDOlw=  Directory of C:\  MDQvMDIvMjAxMiAgMDM6MjkgUE0gICAgICAgICAgIC AgMSwwMjQgLnJuZA==  04/02/2012 03:29 PM 1,024 .rnd  MDIvMjcvMjAxMiAgMDk6MTIgQU0gICAgICAgICAgICAg ICAgIDAgQVVUT0VYRUMuQkFU  02/27/2012 09:12 AM 0 AUTOEXEC.BAT  MDIvMjcvMjAxMiAgMDk6MTIgQU0gICAgICAgICAgICAg ICAgIDAgQ09ORklHLlNZUw==  02/27/2012 09:12 AM 0 CONFIG.SYS  -Keylogger window Main network traffic indicator of C2 activity through its "Keylogger" window: "kl|'|'|" Encoded Data  Decoded Data  DQoBMTMvMDYvMDYgV0lOV09SRCBEb2N1bW VudDEgLSBNaWNyb3NvZnQgV29yZAENCkhlbG xvIFdvcmxkIQ0KATEzLzA2LzA2IFdJTldPUkQgRG 9jdW1lbnQxIC0gTWljcm9zb2Z0IFdvcmQBDQp0Z XN0DQoBMTMvMDYvMDYgbm90ZXBhZCBVbnR pdGxlZCAtIE5vdGVwYWQBDQpFeHBsb3JlciBwY XNzd29yZDogMTIzNDU1W0JhY2tdNg0KATEzLz A2LzA2IG5vdGVwYWQgVW50aXRsZWQgLSBOb 3RlcGFkAQ0KYXNkZmQ=  13/06/06 WINWORD Document1 -Microsoft WordHello World! 13/06/06 WINWORD Document1 -Microsoft Word test 13/06/06 notepad Untitled -Notepad Explorer password: 123455[Back]6 13/06/06 notepad Untitled -Notepad asdfd  The encoded data sent by the Victim system was the keystrokes collected into the keylogger file in the Victim. The data decodes to: Copyrightý2013GeneralDynamicsFidelisCybersecuritySolutionsThreatAdvisory#1009 Page26of27 Rev.2013-06-25