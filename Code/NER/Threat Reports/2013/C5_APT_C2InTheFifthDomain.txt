2. One of	 the callback locations used	 in the SK Communications hack was ¡®update.alyac.org¡¯.	 The domainwasregisteredon24	September2010	using registrationinformationalmost	 identicalto	that	of	a legitimatecompany	.atacticused	by	theattackeron severaloccasions4.	Following the intrusion into the SKCommunications network it	 became widely	 known that the domain was being used for malicious purposes,	and perhaps	 for this reason,	 the oneyear registrationwasnotrenewed	by	theattacker.	Despitethis,	anumberof	victims	aroundtheworldcontinuedto	usethedomainto	locatetheirC2server,	resulting inattempted	communicationsto	a C2	server that	no longerexists. THE VICTIMS Computers using	 IP addresses allocated	 to	 France,	thePeople¡¯sRepublicof	China,	Portugal,	SouthKorea,Taiwan,	 the United	 Kingdom	 and	 the United	 States areamong	thosethat	attemptedto	communicatewith¡®alyac.org¡¯ subdomains after the attacker¡¯sregistrationlapsedinSeptember2011. While some of	 these computers belong	 to security	 researchers who deliberately	 installedmalware for research purposes,	 most are victimscompromised by	 the attacker either directly	 or indirectly.	 The victims	 are from	 a variety of industries including	 the technology	 sector,	 highprecisionmanufacturing,	research	anddevelopment,testing	 and certification,	 global market research, executive headhunting	 and mentoring,	 andwebhosting	providers. THE COMMUNICATIONS Eight	 different	 types of C2	 communications were observed	 to ¡®alyac.org¡¯ subdomains from thecompromised computers. These communication types will be referred to as ¡®LURK¡¯, ¡®X.Shell C601¡¯,	¡®Update?¡¯, ¡®Murcy¡¯,	 ¡®Oscar¡¯, ¡®BB¡¯, ¡®DB¡¯,	 and	 ¡®Qdigit¡¯ respectively.	Severalvictimscommunicatedvia both¡®Update?¡¯ and	 ¡®Oscar¡¯ which	 are believed	 to	 beassociatedwith	 thesamemalware.	Noothervictimswere observed	 communicating	 with	 ¡®alyac.org¡¯ subdomainsviamorethanoneC2	protocol. 4 Other domains registered	 using	 a similar tactic include ¡®bomuls.com¡¯, ¡®nprotects.org¡¯, and ¡®trendmicros.net¡¯. (CommandFivePtyLtd,2011) THE ¡®LURK¡¯ COMMUNICATIONS Asinglecomputerwasobserved	communicating	withthecallbackdomain¡®path.alyac.org¡¯onTransmission Control Protocol (TCP) 80 via the ¡®LURK¡¯ protocol.The communications contained a 15.byte header5followed by data compressed	 using the DEFLATE compression method.	 The header contained aprotocolidentifier,sizeandcompressioninformation asshowninTable1. BYTE	 SIZE	(BYTES) DESCRIPTION POSITION 0  4  LURK	protocol	identifier.Hexadecimalbytes	¡®0x4C	0x550x52 0x4B¡¯	(or¡°LURK¡±inASCIIrepresentation).  4  1  Hexadecimalbyte 0x30 ( 0 )inallobservedsamples.Bytemayform partoftheprotocolidentifier.  5  4  Sizeby c Compressedmessagesizein tes	(includingheader).  9  4  Decompressed	datasizeinbytes.  13  2  ZLIB6 streamheader.Hexadecimal bytes	¡®0x780x9c¡¯7 inallobserved	 communications,denoting	thattheDEFLATEcompressionmethod	was usedtocompressthedata(withawindow	sizeof32K).  15  [Sizec  15]  DEFLATEcompressed	data.  ALL	VALUES	ARE	LITTLE ENDIANUNLESS	OTHERWISE	STATED.TABLE1:LURK PROTOCOLFORMATThe decompressed	 data reveals informationabout	 the compromised computer such	 as its	 name,	computer specifications and	 operating	 system	 (OS)information as shown in Table 2.	 For example, itreveals that	 the compromised	 computer communicating with	 ¡®path.alyac.org¡¯ is running	 Windows 2003 Server Web Edition,	 Service Pack 2. 5 The DEFLATE compression method	 is	 specified in RFC 1951.(Deutsch,1996) 6 ZLIBisacompresseddataformatschemespecifiedinRFC1950.(Deutsch,ZLIB	CompressedDataFormatSpecificationversion3.3,1996)7 As	 describedin Section2.2	 ofRFC 1950, bits	 0	 to 3	inthe firstbyteoftheZLIBstreamheaderrepresentthecompressionmethodused, and	 bits	 4	 to 8 represent compression information. Thesecond	 byte in the header contains bits for an integrity check,along	 with two additional	 flags. With a second	 byte of ¡®9c¡¯	 theintegrity check passes (as 30876	 is	 divisible	 by 31), the presetdictionary flagisnotset,andthecompressionlevel	flag	 indicates that the default algorithm was used for compression. (Deutsch,ZLIBCompressed	DataFormatSpecificationversion3.3,	1996)BYTE	 SIZE	 DESCRIPTIONPOSITION (BYTES) 0  4  Possibleprotocolidentifier.Fixedbytes	¡®0x820x690x740x6B¡¯	inallobserved	communications.  4  260  ¡®0x00 bytesinallobservedcommunications.  264  1  ¡®0xD0¡¯	inallobserved	communications.  265  31  Null terminatedcomputername.  296  24  ¡®0x00 bytesinallobservedcommunications.  320  156  OSVERSIONINFOEX8 structure(formatshowninAnnexA).  476  9  Null terminatedaccountname.  485  19  Unknown.  504  4  Horizontal	screenresolution(pixels).  508  4  Verticalscreenresolution(pixels).  512  92  Unknown.  604  4  ComputerProcessorUnitspeedinmegahertz(MHz).  608  8  Null terminatedstring	containing	amountofmemoryand	unitofmeasurement(e.g.¡°1023MB¡±).  616  120  Unknown.  ALLVALUESARE	LITTLE ENDIANUNLESSOTHERWISE	STATED.TABLE 2: FORMAT OF DECODED LURKCOMMUNICATIONSSimilar communications9 are known to begenerated	 by	 malware that communicates with thecallback domain ¡®office.windowupdate.org¡¯ . adomain that	 is linked	 to	 ¡®alyac.org¡¯ not only	 by	 thecommunications protocol but also	 by	 both	 domainregistrationtacticand	infrastructure.The domain ¡®windowupdate.org¡¯ is	 ostensibly	registered to ¡®Microsoft	 Corporation¡¯. Theadministrativeaddressand	contact	informationlistedin the domain registration is identical to	 that	 listedfor the legitimate Microsoft domain¡®windowsupdate.com¡¯10.	 This is	 thesame tactic used1by	theattackerwith	registrationof	¡®alyac.org¡¯ 1. 8 The OSVERSIONINFOEX system information structure includesmajor and	 minor version numbers, a build number, platformidentifier and	 information about product suites	 and the latestServicePackinstalled.(MicrosoftCorporation,2011)9Themalware¡®Troj/Agent.UDR¡¯	with	MD5	hash¡®42377E7248752912 5EBE 7C95 02B9 4CD7¡¯	 is	 known to generatecommunications of the format 0\xAC x ¡¯,¡¯LURK0\xAD\x01¡¯, ¡®LURK0\B3\x01¡¯	 and	 ¡®LURK0\xB5\x01¡¯.(Sophos	Ltd.,2011)10 The legitimate domain ¡®windowsupdate.com¡¯ is used	 byMicrosofttodeliverupdates	totheWindowsOS.11Thedomain¡®alyac.org¡¯was registeredusing	registrationdetailsthatmade	thedomainappearas	though	itwas	associatedwith	thelegitimate,trusted	entityESTsoft.theproducerofALYacantivirussoftware.(Command	FivePtyLtd,	2011) The domain ¡®windowupdate.org¡¯ previously	pointedtoSouth	KoreanIP	address222.122.20.241.an IP address to which	 ¡®alyac.org¡¯ also	 previouslypointed. This	 shared	 infrastructure further suggeststhattheobservedcommunicationsto	¡®path.alyac.org¡¯and	thoseto	¡®office.windowupdate.org¡¯may	belinkedto	thesameattacker.The malware that	 generates the LURKcommunications sent to	 ¡®office.windowupdate.org¡¯was signed using a compromised code signingcertificatebelongingto	YNKJapanInc	.aproducerof	onlinegames.	Thesamecertificatehasbeenused	inanumber of attacks including	 by	 Hupigon malwareand	 malware similar to that used in the SK12 Communications hack.	 Details of	 the compromisedcode signing	 certificate are shown in Figure 2.(Fagerland,	2011)SerialNumber: 046931BF57EBC5947D3DC4EE7A236ECommonName: YNKJAPANIncStatus: RevokedValidity(GMT): Nov27,2009.Nov272011Class: DigitalID	Class3.SoftwareValidationOr nisation: YNKJAPANIncOrganisational DigitalID	Class3.Microsoft	SoftwareUnit: Validationv2State: Chuo.kuCity/Location: NihonbashiKodenmachou10.6Country: JPSerialNumber: 6724340ddbc7252f7fb714b812a5c04dIssuerDigest: 96c16fb10ef41f9736c50c5bac0ddd67 FIGURE2:COMPROMISEDCERTIFICATEDETAILSThe compromised	 code signing certificate wasrevoked	 on 29 July	 2011	 but,	 as the malware wassigned on 3	 July	 2010	 and the revocation was notactiveforsoftwaresignedbefore29 July	2011 ,	thecertificate continued to validate for this ma1l3wareaftertherevocation.	(Fagerland,	2011)The date of	 effect of the revocation has sincebeen backdatedtopreventthismalware¡¯scertificate14fromvalidating .	Thenewdateofeffectstillmay	notprevent the validation of all malware using	 this	compromisedcodesigning	certificate. 12 Hupigon is a remote administration tool from China. It hasrootkit functionality, can log user activity and	 establishesoutbound	communications	toaC2	server.(F.SecureCorporation)13 Therevocationisactive from the¡®revocationDate¡¯(inthis	case,29July2011)specified	intheCertificateRevocationList.14Therevocationforthecompromised	codesigningcertificatehasbeen backdated	 to 12	 April 2010	 so that the earliest knownmalwaresigned	with	itnolongervalidates.(Verisign,2011)THE ¡®X.SHELL C601¡¯ COMMUNICATIONS Numerous compromised computers communicatedwith ¡®path.alyac.org¡¯ on TCP	 port 443 .a portcommonly	 used	 for SSL. These communications,however,	 were not	 SSL but	 instead	 unencrypted	communications likely	generated	by	aversionof	the command.line based 1¡®X5.Shell 601¡¯ Remote AdministrationTool(RAT) .	A summary	 of	 the observed X.Shellcommunications,	 and the information they revealabout	thecompromisedcomputer,isshowninTable3.	 The ¡®C¡¯ immediately	 preceding	 the ¡®601¡¯ in the communications is believed	 to indicate that	 themalwareisnotafreeversionbut	instead	acustom,	or commercial,	versionof	theX.Shell601RAT. BYTE	 SIZE	 DESCRIPTION POSITION (BYTES) 0  8  ¡®0x00 bytesinallobserved	samples.  8  4  Tick	count(numberofmillisecondssincesystemwasstarted.resets	after 49.7	days).  12  4  ¡®0x00 bytesinallobserved	samples.  16  4  Protocolidentifier ¡¯0x430x360x30	 0x31¡¯	(¡°C601¡±).  20  28  Null terminatedusername(ifsuccessfullyobtainedfromthesystem).  48 156 OSVERSIONINFOEXstructure(formatshowninAnnexA). 204 52 Unknown. 256 32 Nullterminatedcomputername(ifsuccessfullyobtainedfromthesystem). 288 12 Processname. 300 52 ¡®0x00bytesinallobservedcommunications. 352 36 SYSTEM_INFO16 structure(format showninAnnexB). 388 72 ¡®0x00bytesinallobserved	samples. 460 12 Unknown. 472 4 Localeidentifier17. 476 4 Tick	count(repeated). 480 300 Unknown.Mainly¡¯0x00bytes	in observedcommunications. ALL	VALUES	ARELITTLE ENDIANUNLESS	OTHERWISE	STATED.TABLE3:X.SHELLC601COMMUNICATION FORMAT 15The X.Shell RAT is	 commercial software. (XTiger, Xdoors.net,1620T1he1) SYSTEM_INFO structure contains information about acomputersuchas	its	architecture,typeofprocessorandnumberofprocessors	used.(MicrosoftCorporation,2011)17 A locale is a collection of language.related user preference information that typically identifies a user¡¯s	 country and	 dialect.(MicrosoftCorporation,2011) In	 all observed communications the process18namelistedatbyte288was¡®svchost.exe¡¯ .	Based	on this,	 the malware has likely	 modified the system registry	 on the compromised	 computers in such	 away	 that the RAT	 gets executed as a service by	 thetrusted	process¡®svchost.exe¡¯each	timethecomputer is	started.	This	processname,	along	withthecallbacklocation,	isconfigurable,	and	can beconfigured	after theRAThasbeencompiledinto	executableform. WhileX.ShellsupportsnumerousversionsoftheWindowsOS(includingWindowsXP,	Vista,Windows 7,	and	Windows	2000,2003	and2008server .both32 and	 64 bit	 versions),	 only	 computers running Windows XP were observed communicating	 with¡®path.alyac.org¡¯.The functionality of the RAT	 depends	 on the version,	releasenumber,pluginsinstalled	andtheOS on which	 the RAT	 is installed19.	 Several versions oftheX.ShellRAT	exist,	includinga freeversionand	 a20¡®spy¡¯ version .	 The free version of the RAT	 is no longer available for download	 from	 the XDoors website,	 however,	 development of the software continues21.	 Current	 release numbers of the X.ShellRAT	 include 601 and	 603. Previous releases date backto	at	least	200622.	Some functionality	 comes standard	 in allversions of	 the RAT including	 the ability to	 start	 acommand	 shell,	 control processes and services,upload/download	 files,	 terminate TCP connections,createuseraccounts,	retrievesystem	information,	log useractivity(viaakeylogger),	modifytimestampson files,	 conduct process injection, conduct denial ofservice attacks and shutdown or restart the computer.	 Commands supported	 by	 the X.Shellsoftwarearelisted	inAnnexC.	(XTiger) 18 The process	 ¡®svchost.exe¡¯ is a generic host process for services which	 run from DLLs. (Microsoft, A description of Svchost.exe inWindowsXP	ProfessionalEdition2007)19 Not all features	 are supported	 in each	 OS. For example, raw socket sniffing is	 only supported in Windows 2000 and 2003.(XTiger)20 Versions	ofX.Shellincludea¡®personal¡¯edition,a¡®mini¡¯version,an ¡®advanced¡¯	version,a¡®spy¡¯versionand	an ¡®enterprise¡¯version.(XTiger.Crackersoftware,2011)21 Duetotheauthorwantingtoavoid	¡°unnecessarytrouble¡±,asof16 March 2011, the free versionof the X.ShellRAT(and	 also itssisterproducttheX.DoorRAT)is	nolongeravailable	fordownloadfrom the ¡®xdoors.net¡¯	 webpage, however, an online forum containing	 a list of changes	 made to the RAT continues to beupdated. (XTiger, forum.xdoors.net. Topic: X.Door/X.Shell free download	paused,2011)22 Previous releases	 of X.Shellinclude	 release numbers 323, 325,327,	329,331,333,335	and337.(XTiger,2010)The RAT is	 Virtual Machine (VM) aware,	 proxyaware and can also	 use a specified	 DNS	 server toresolvecallbackdomains.	Someversionshaverootkitfunctionality	 and can avoid detection by antivirussoftware.	 Third.party	 plugins can be developed	 andintegrated	intotheproduct.Optional features include encrypted file search,an SMS	 notification service,	 and	 functionality	 that	enables the compromised computer to be used aspart	 of	 a botnet	 to	 send spam	 or to conductdistributeddenialof	serviceattacks.	This	broadrangeoffunctionality	makesthesoftware fitforanumberofpurposesand	reflectsthecommercialnatureofthesoftware.	(XTiger)The X.Shell RAT is generated by the X.ShellControlProgram	.thesameprogramfromwhich	themalware is controlled.The control program can berun in either Chinese language mode or Englishlanguagemode,	andallows themalwareto beeasily	configured.	 It provides options to digitally	 sign themalware, specify its connection mode(connect/listen/sniff), install the malware in one of	several covert manners, recover the System	 Service23Dispatch	Table(SSDT) beforeinstallation,	and	abortinstallationifavirtualmachineisdetected.(XTiger)When X.Shell malware is generated,	 and the¡®connect¡¯connectionmode24selected,	themalwareis	configured with	 a static C2 host	 (IP	 address orcallback domain) and	 control port.	 Additionally,	 anoptioncanbeselectedduringthegenerationprocessto	actively	notifythemalwareof	anew	 C2host	and25port via a configuration webpage .	 If this option isselected,	 the malware communicates with both	 aconfiguration webpage, and	 a C2 server at	 regularintervals.	 The interval for each	 can be separately	configured to a value of between 30 and 3600seconds	(inclusive).	(XTiger)TheX.ShellRATs	thatcommunicated	withtheC2host¡®path.alyac.org¡¯hadbeenconfiguredtousea36second	interval.	It	is	notknownwhetherthemalwarewas configured	 solely	 with a static C2	 host	 or 23 The SSDT is often used	 by kernel	 mode	 rootkits	 to evade 24deItnectthione .¡®connect¡¯ mode	 the malware attempts to communicatewithitsC2	server,asopposedtothe¡®listen¡¯	modeinwhichitwaitsforaC2	servertoattempttoconnecttoit.25 Theconfigurationwebpageisoftennamed¡®xci .asp¡¯	and	canbegenerated	and	uploaded	fromwithinthecontrolprogram.¡®Xcip¡¯	ispresumably	 an acronym for ¡®X.door Configure IP	 address¡¯	 orsomething	similar. whether the malware also retrieves its	 C2 host andportfrom	aconfigurationwebpage. X.Shell Configuration WebpagesX.Shell configuration webpages contain, in encoded	form, a colon.separated	 IP	 address (or callbackdomain) and port for the malware to use tocommunicate with	 its C2	 server. The encoded IPaddress(orcallbackdomain)andcontrolport	canbedecodedonebyteat	atimeusing	theformula:di=	ei.((i%8)+x),wherei	is	thebyteindex,	di	is	thedecoded	byte,	eiistheencoded	byteandx	isaonebytekey.Thisis	theequivalent of subtracting both	 the key	 and	 the byteposition number [0.7]	 from each	 byte.	 The positionnumberis	modulo	8i.e.repeatsevery	8bytes.For example,	 if	 the compromised	 computersreceived	 a C2	 host	 of	 ¡®PATH.ALYAC.ORG¡¯ and	 acontrol port of	 443	 from	 a configuration webpage,and	akey	of0x16	(22	indecimal)wasusedto	encodethe control information,	 the configuration webpagewould	 have contained the encoded string¡®fXlaH\hvWZFhlbVQJJ¡¯.	 THE ¡®UPDATE?¡¯ COMMUNICATIONSHyperText	 TransferProtocol(HTTP)	 POST¡®Update?¡¯ requests were sent to both	 ¡®path.alyac.org¡¯ and	¡®update.alyac.org¡¯ from compromised	 computers.	Two request	 formats were observed; Variant A(showninFigure3)inwhich	thefilepath	requested	was ¡®/update?product=windows¡¯, and Variant B(showninFigure4)inwhich	thefilepath	requested	was¡®/update?id=number¡¯,wherenumber refersto	aneight	 digit hexadecimal number that	 changesbetween requests.	 The domain ¡®path.alyac.org¡¯ onlyreceivedVariant	Brequests,	whilebothvariantsweresentto	¡®update.alyac.org¡¯. POST /update?product=windows HTTP/1.1 Accept: */*X-Session: 0 X-Status: 0 X-Size: 61456 X-Sn: 1 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1; Host: update.alyac.orgContent-Length: 0 Connection: Keep-AliveCache-Control: no-cache Cookie: VisitorID=c2a4b456-e11e-4c37-88d8.e770aa88058d&Exp=9/25/2014 6:14:17 AM FIGURE3:VARIANTACOMMUNICATIONS POST /update?id=3109c2a2 HTTP/1.1 Accept: */*X-Session: 0 X-Status: 0 X-Size: 61456 X-Sn: 1 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1; Host: path.alyac.orgContent-Length: 0 Connection: Keep-AliveCache-Control: no-cache Cookie: VisitorID=bd5ab197-355d-42cb-ae1b.8d23f1dd55ed&Exp=9/25/2014 6:03:33 AM FIGURE4:VARIANTBCOMMUNICATIONSThe format	 of	 Variant A is	 identical to thecommunicationsgeneratedby	theDestoryRAT	usedin the SK Communications hack26.	 The format	 of	Variant	 B is	 identical to	 the communicationsgenerated	by	malwarethat	usesthecallbackdomain27¡®gm1.network.sec.net¡¯ .	Both	 variants are associated with the DestoryRAT	familyofmalwarethatdatesbackatleastasfar28asJanuary	2007 and	hasbeenusedinseveralmajortargetedattacks. 26For a detailed	 analysis	 of the Destory RAT used in the SKCommunications hack (including	 a complete list of deobfuscatedstrings)refertotheCommandFivepaper¡®SKHack	byanAdvancedPersistentThreat¡¯.(Command	FivePtyLtd,2011)27 Malware detected as ¡®Troj_Inject.AMR¡¯ submits HTTP	 POSTrequests	to¡®gm1.network.sec.net/update?id={value}¡¯.Thedomain¡®gm1.network.sec.net¡¯is	aknowncallbackofmalwaredetectedasBackdoor:Win32/Thoper.A.(Mendoza,2011)(Wong,2011)28TheDestoryRATwithMD5hash¡®70CDC9A2	D9CC276B	C5D1D47D21FB	24DF¡®	wascompiledon3	January2007. The Destory RAT family	 includes malware that isdetectedas: . Backdoor.Sogu, 29. Backdoor:Win32/Thoper.A , 30. Trojan.Downloader:Win32/ThoperB .The observed	 communications to the ¡®alyac.org¡¯ subdomainsalloccurredonTCPport80,however,avariety	 of ports (TCP	 ports 8080,	 443,	 12345	 etc.)have beenusedbythisparticularfamily	ofmalwareforsimilarrequests.	Theport	useddependson howthemalwareisconfigured.Connection attempts from	 each of	 thecompromised computers occurred frequently whilethe computers were powered on.	 For example, onecomputer connected at 16 second intervals andanother approximately	 every 200 seconds	 (¡À15	seconds).ThreeHTTPPOST	requestsweresubmitted	during each	 connection, each approximately	 onesecondapart.	 31Thefollowingmalformeduser.agent is	present	intheHTTP	POST	requests of	 bothvariants (spacesshownhereas¡®¡¤¡¯):¡®Mozilla/4.0¡¤(compatible;¡¤MSIE¡¤6.0;¡¤Windows¡¤NT¡¤5.1;SV1;¡¯ This	 user.agent is consistent with that whichmay	 be generated by	 version 6.0 of the MicrosoftInternet Explorer web browser running on theMicrosoft	Windows	XP	OS,	except	that	it	ismissing	aclosing	 bracketafter the last semicolonand a spaceafter the second to last semicolon. This malformed	user.agent	is	hardcodedinto	themalwareand	canbeusedasasignaturetodetect	thecommunications.Four custom headers are also	 present in theHTTPrequests:	¡®X.Session¡¯,	¡®X.Status¡¯,	¡®X.Size¡¯,and¡®X.Sn¡¯.ForsomemalwareintheDestory	RATfamily	notallof	theseheaderswillbepresent. 29 TheDestoryRATwithMD5hash¡®5FCE1FC1	8283D76C396A3CCC 64BD BBDE¡¯	 is detected by antivirus software as bothBackdoor.Soguand	Backdoor:Win32/Thoper.A.This	malicious	files	identical	tothatused	intheSK	Communications	hack	exceptforitsconfiguration.(HispasecSistemas,2011)30 TheDestoryRATwithMD5hash¡®754364D9	DB702DC715327B40 BF97 E556¡¯	 is detected	 by antivirus	 software as bothBackdoor.Sogu and	 TrojanDownloader:Win32/Thoper.B.(HispasecSistemas,2011)31 User.agents	 are used in HTTP	 communications to tellwebserverswhichOSand	webbrowsertheirclientsareusing,sotheycanservecompatiblewebpages. Cookie	 StealingCookiesweresentwiththeHTTPPOSTrequestsfrom allbut	threeIPaddresses.Acookienamed¡®VistorID¡¯ waspresentany	timeacookiewassent.	Onoccasion a ¡®Yahoo¡¯,	 ¡®SessionId¡¯ and/or ¡®fcVal¡¯ cookie was also	 present	 in the requests. The transmission of these cookies could facilitate session stealing and, in the case of	 the Yahoo cookie,	 enable unauthorisedwebmailaccess.Each	 VisitorID	 cookie contained an expiry	 time between 9/25/2014 5:50:03	 AM and	 9/25/20146:14:17AM.	Theexpiry	timeisuniqueforeach	victim and	remainedconstant(pervictim)	acrosstheHTTPPOST	requests.	Itis	possiblethevictims	received	the cookie from	 a C2 server with which	 they	 hadpreviously	communicated,	or,	from	aserverhosting	a webpage that caused the initial infection. It is	 also possible that the cookie, and the propinquity	 of	 thetimes in the cookies, is coincidental,	 and that thevictims	receivedthecookiefrom	otherlocations. THE ¡®MURCY¡¯ COMMUNICATIONS Multiple Chinese IP	 addresses were observedsubmitting HTTP GET	 requests to the host¡®path.alyac.org¡¯. Data contained	 within the communicationsindicated	that	therequestswereallsent	 from	 a single computer,	 and	 therefore thatcomputerwasnot	using	astaticIP	address.The data from	 the computer was carried in the requests in an encoded	 form	 (as described	 below)withinaHTTPheadernamed¡®Extra.Data¡¯.	Two	other unique headers were also present	 in the requests;¡®Extra.Data.Bind¡¯ and ¡®Extra.Data.Space¡¯. Thecommunicationsappeartobegeneratedbymalware knownas ¡®Backdoor.Murcy¡¯thatis	reportedly	not	in32widespread	use .	Anexampleof	anactualHTTP	GETrequestis	showninFigure5. 32 Symantec Corporation assesses the number of Backdoor.Murcy infections	tobelessthan50.(Ward,2011) GET /150828 HTTP/1.0 Connection: Keep-Alive Accept: */* Host: path.alyac.orgUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1) Extra-Data-Bind: DE6A34D80D43B930 Extra-Data-Space: 65536 Extra-Data: 4ZFNSAAEAAh2AoNAAAAAAgRCHACwoSogAjKhCCf/HAAVNAAAAeAAAgDBAAABIAAAs0kAAUAAAAQAAAAAooAAAIAAAAATAAAAKCAAAgKAAAgqAAAA4CAAAgNAAAAOAM xxxxAEEAzAQOAADA5AAMAkDAwAgNAkDAxAAAAMFAlBgcAYHApBwYAUGAgAAUAEGAjBwaAACAzAAAAAAATBQWAMFAUBQRA0EAAAwVA8EAXBQLAUEA4AQRAxxxxxxxxx xxxxxxxxxx2AAAAAAA Cache-Control: no-cache Pragma: no-cache Content-Length: 0 FIGURE5:SAMPLEOFMURCYCOMMUNICATIONSThe path	 in the HTTP GET	 requests is the computer¡¯stickcount(i.e.thenumberofmilliseconds	sincethesystemwasstarted).	Therequestsfrom	thevictim	 occurred	 approximatelwhenthecomputerwas turney	 every	 11 seconds.	Accordingly,	the d	on numberintheURI	increasedbyapproximately11000each	 request. Where there was a break in the communications (presumably	 due to the computer being	shutdownorrebooted),	thecounterreset	andwas between 128703 and	 133243	 in the next communication. This indicates that the malware began communicating	 from	 this compromised	computer within minutes of	 the computer being booted.Theencodeddatawithinthe¡®Extra.Data¡¯header can bedecoded	using	 thestandard	Base64 alphabetbut	 with	 modified	 bit	 placement.	 The standardBase64	 algorithm	 decodes encoded strings using consecutive bitsread	leftto right i.e.bits0.7	wouldformthefirst	decodedbyte (shownin Figure6).For Murcycommunications,	theinputbits	that	formeach	output	 byte are not taken contiguously.	 Figure 7describes how	 the first three decoded bytes are constructed, and can be used to implement	 adecoding	algorithm. 2nd Base64encodedcharacter 4thBase64encodedcharacter FIGURE6:BITPLACEMENTINBASE64DECODING The data sent	 to the C2	 server is	 dependent	 on the C2 instructions received.	 Commands the Murcy malwarereportedly	understandsareshowninAnnex D.(SafeZoneCast,	2011)The Murcy malware is commonly	 named35¡®cydll.dll¡¯,	 creates a mutual exclusion (mutex )handle named	 ¡®Cy1.0Mutex¡¯,	 and	 installs a service named¡®CyService¡¯with	a display	nameof ¡®CyService Service¡¯.	 It	 also commonly	 gains persistence bycreating	 the registry key	 ¡®ServiceDll =	 %System%\cydll.com¡¯ in the ¡®ControlSet001¡¯ key in theLocalMachinehiveoftheWindowsregistry.	 Symantec Corporation discoveredBackdoor.Murcy on 31	 July	 2011,	 yet	 the same malware appears to	 have been first	 detected	 by36Kaspersky	 Lab on 11 January	 2010 .	 Malware sampleswiththesameattributesdatebackto	at	least	37October 2009 .	 This suggests that the Murcy	 malwarehasbeeninuseforat	leasttwo	years.Known Murcy	 malware uses the callback38domains ¡®albertstein.ddns.us¡¯ ,39 40¡®alvington.jetos.com¡¯ ,	 ¡®ftp.xmahone.ocry.com¡¯ ,	 and41¡®superaround.ns02.biz¡¯ .	 These callback domains were all also	 reportedly	 used	 in the March	 2011intrusionintoRSA¡¯snetwork.	Thatintrusionresultedin the theft	 of	 information related to	 RSA¡¯s SecurID two.factor authentication products.	 The stolen information was later used	 to	 enable targeting	 ofdefence contractors. (Coviello,	 2011). (Rasmussen,2011)(US.CERT,	2011).	 35 Amutexisatechnical	constructused	tocontrolaccesstosystem resources.Inthis	casethetechnicalmeaning	islesssignificantthan thefactthatthemutexintheMurcymalwareis	uniquelynamed.36 Malwarethatfits	theprofileofMurcymalwarewas	detected	on 11 January 2010as ¡®Backdoor.Win32.Agent.anvj¡¯. (Kaspersky LabZAO,2010)37Malware detected	 in 2009 with the MD5	 hashes ¡®3FDE A18B9610 CBC9 B63B	 A7A4 4899 FBFB¡¯ and	 ¡®42E8 163B 7F08 DD38 3E62 E4BD B7F0 7C08¡¯	 is known to callback	 to IP address 203.160.67.130.(Sunbelt,2009)(SunbeltSecurity,2009)38Malware with the MD5 hashes ¡®19B0 227B	 EC75 BEF9 3C6CCC549B6D2BA0¡¯	and	¡®3DF0D0AB	4AD9	DA4559A1	C6464C8526D1¡¯	 callback	 tothe domain¡®albertstein.ddns.us¡¯. (GFI Software,2010)(Sandbox,2010)39Malware with	 the MD5 hashes ¡®91A2	 68B3 17D2 CC65	 69B8 5BB0	 3A5F F841¡¯ and	 ¡®69ED 8F7B	 0046 9560 45A9	 0E36 E3C83F6A¡¯	 callback to the domain ¡®www.alvington.JetOS.com¡¯. (GFISandBox,2011)(SunbeltSecurity,2010) 40Malware with the MD5 hashes	 ¡®0D38 D6C2 B9EB 817B 40AFC4272545A43B¡¯,¡®3E3736DFFEDAF2A0AE4D948567933B3F¡¯and	¡®9ADDC6D5	7330	9399	E2B878873A00A921¡¯	callbacktothedomain¡®ftp.xmahone.ocry.com¡¯.(GFISandbox,2011)(Telus,2011)(ThreatExpertLtd,2011)(GFISandbox,2011)41Malware with	 MD5	 hash ¡®3740 5D5B	 CF64 FB95	 47CA CDA95F4C E8B4¡¯ is known to callback to ¡®www.superaround.ns02.biz¡¯.(GFISandbox,2010) THE ¡®OSCAR¡¯ PROTOCOLNumerouscomputerswereobserved	communicating withan¡®alyac.org¡¯subdomainonTCP	port	80	viathe ¡®Oscar¡¯ protocol. Most, but	 not all,	 of the computers also	 communicated to the same domain via the ¡®Update?¡¯ communications.	 The protocol is	 believedto	 be associated	 with the same malware thatproducesthe¡®Update?¡¯communications.theDestory RAT.Each	compromisedcomputercommunicatedat	adifferent interval to the others, and	 accordingly,	 the malware on each of	 the compromised	 computers appears to have been individually	 configured.	 For example,	 one computer communicated every 12seconds	and	anotherevery	16seconds.Encrypted data was sent during each	communication. The length of	theencrypted data in each	 packet	 varied between 16 bytes and 89 bytes.	Aftersending	theencrypteddatathemalwarewaitedforaresponse.	 THE ¡®BB¡¯ PROTOCOLTwo computers wereobserved communicating with¡®update.alyac.org¡¯ via the ¡®BB¡¯ protocol.	 One of	 thecomputers used	 a Chinese IP	 address,	 the other a South	Korean IPaddress.	The¡®BB¡¯protocol hasa 21byteheadercontaining	a4byteXORkeythat	canbeusedtodecodetheremaining	bytesinthepacket.The packet	format	isdescribed	inTable5. BYTE	 SIZE	 DESCRIPTION POSITION (BYTES) 0  4  SizeheaderBB Sizeinbytes	(including).  4  4  Possiblecommunicationtypeindicator.¡®0x010x000x000x00¡¯inallobservedcommunications.  8  4  Victimspecificbytes.  12  4  XORkey.  16  4  Unknown.¡®0x010x040x010x00 inallobservedcommunications.  20  1  Unknown.commun ¡¯0x00 inallobserved	 ications.  21  [SizeBB]  Dataencodedusing	the4byteXORkeyspecifiedinbytes	12.15.  ALL	VALUES	ARE	LITTLE ENDIANUNLESS	OTHERWISE	STATED.TABLE5:'BB'PROTOCOLPACKETFORMATOnce decoded,	 the data reveals a basic beacon containingthecomputernameandIPaddressof	the infectedcomputer.	 Aftersending	thebasicbeacon,	thecompromisedcomputers waited for a response from the server,	then closed the connection when they had	 not receivedseconds. a response from the server within fiveBoth	ofthecompromised	computersreattemptedthe communications approximately	 every	 eight seconds. On some days the high frequency	 of	 thebeacon activity resulted in over 10000 connection attemptspervictimina24hourperiod. THE ¡®DB¡¯ PROTOCOL Asinglecomputerwasobserved	communicating	withthe domain ¡®update.alyac.org¡¯ via the ¡®DB¡¯ protocol.	The communications originated from the same Chinesecomputernetworkasoneof	the¡®BB¡¯victims but	froma different	computeron that	network.	Itis not known what	 malware generates the ¡®DB¡¯ communications,	orwhetheritisthesamemalware thatgeneratesthe¡®BB¡¯communications.The communications reveal detailed	 OS andsystem	 information about	 the compromisedcomputer as shown in Table 6.	 The OS information reveals that	 the compromised	 computer is running Windows 2003 Server Service Pack 2. The detailedsystem	 information reveals that	 the compromisedcomputer has an Intel Pentium	 Pro.class processor,42four logical processors and	 an LGA 775 CentralProcessing	Unit(CPU)socket. BYTE	 SIZE	 DESCRIPTION POSITION43 (BYTES) 0 156 OSVERSIONINFOEXstructure(formatshowninAnnexA). 156 36 SYSTEM_INFOstructure(formatshowninAnnexB). 192 10 Computername.TABLE 6: SUMMARY OF FIRST 202 BYTES OF A ¡®DB¡¯ PACKETThe DB communications typically	 occurred atintervals of	 between 4	 and 92	 seconds, however,sometimes they were much further apart. After sending	 the detailed beacon to	 the command	 andcontrolserver,	thecompromisedcomputerappearedto	expectaresponsefromtheserver.	 42 The combined processor level and processor revision information indicates the computer has an LGA 775	 CPU socket(Intel family 6/ model	 15/ stepping	 11). (Microsoft Corporation,2011)(Wikipedia)43 Onseveraloccasionsthe4bytes	¡®70170000¡¯	wereprependedtothecommunications. THE ¡®QDIGIT¡¯ PROTOCOL OnecomputerusingastaticSouthKoreanIPaddress wasobserved	sendingthefivebytes0x510x31	0x39	 0x21	0x00(¡°\x51Q19!¡±)	to	¡®update.alyac.org¡¯on TCPport 80	 up	 to nearly	 800 times a day.	 While the communications did	 not occur continuously	 (likelydueto	thecomputerbeingturned	off),	whoccur a new	 connection was attempteentheydidand	 thed,packet	 containing ¡®Q19!¡¯ sent,	 approximately every minute.	It is assumed	 these communications are generated by	 malware but it	 is	 not	 known what	malware,	 or which	 other callback domains that	malware uses. The malware appeared to expect	 aresponsefrom	theserverafterit	senteach	packet. FREQUENCY OF	 COMMUNICATIONS The communications to ¡®alyac.org¡¯ subdomains occurred frequently	 from	 each	 compromisedcomputer. A summary	 of typical observed	 intervalsbetweencommunications,	brokendown by	protocol,is	showninTable7. PROTOCOL TYPICAL	BEACON	INTERVAL (SECONDS) LURK 26 XShellC601 36 Update? 1	to13,12¡À3,16,104¡À3or200	¡À15 Murcy 11 Oscar 12¡À2,13,15,16,(55or155¡À5),(7.5,	8.5or15),(45,55,	106) BB 8 DB 4	to92 Qdigit 60 Commas	indicatethattheinterval	changed	betweenvictims.Bracketsindicatethatavarietyofintervalswereobserved	from asinglecomputer.TABLE7:INTERVALBETWEENCOMMUNICATIONSThe single LURK	 victim	 was typically observedbeaconingat26secondintervals,	theMurcy	victimat11 second intervals,	 and the Qdigit victim at 60second	intervals.	Allof	theX.ShellC601	victims	were typically	observedbeaconing	at	36second	intervals,	and	 the BB victims at	 8 second intervals. The beaconing interval of the other victims	 does not appear to be a fixed time,	 and	 instead	 a degree of randomnessappearstobeemployed. Ports usedAs shown in Table 8,	 the observed communications alloccurred	onTCP	port	80orTCP	port443	.ports 44commonly	used	forlegitimatepurposes .	 PROTOCOL PORT LURK  80  X ShellC601  443  Update?  80  Murcy  80  Oscar  80  BB  80  DB  80  Qdigit 80 TABLE8:COMMUNICATION PORTSUSED NAME SERVERS While most	 malware uses the local DNS	 server settingsofthecompromised	computertoresolveits callbackdomainto	an IP	address,	insomeobservedcommunications the attackers appear to	 have specifically	chosentheDNSservers.	ThemajorityofX.ShellC601malwarethatcalled	back to	 ¡®path.alyac.org¡¯ used	 Google DNS servers,presumably	 instead	 of the DNS settings on thecompromisedcomputers.	TheX.ShellC601	malware supports use of	 a specified	 DNS	 server to	 resolve callback domains,	 and	 it	 appears the attackers have madeuseof	thisfunctionality.	 The¡®Update?¡¯,	Oscar,	Murcyand	Qdigit	victims	allappeartohaveused	theirlocalDNS	serversettingstoresolvethecallbackdomains.Ontheotherhand,	the single LURK victim	 used	 Google DNS	 servers toresolve its	 callback domain,	 as did the Chinese BB victim	 (and	associated	DB victim)but not	 the SouthKorean BB victim. This	 suggests that the LURK,	 BB and	 DB malware may	 also	 have the same DNSfunctionality	 as X.Shell, although it is possible thatthevictimsareconfiguredto	usetheGoogleservers astheirregularDNS	servers,	andthat	themalwareis	 not	using	different	servers. 44TCPports	 80and	 443arecommonly	 used forlegitimateHTTPand	 HTTPS activity respectively, and	 as such	 communications totheseports	areoftenallowedthrough	firewalls. ASSOCIATION WITH	 MALWARE AND ATTACKS Theobservedcommunicationshavelinkstoavariety ofmalwareand	to	anumberof	attacks,	asillustrated	inFigure9,and	detailedbelow.	The ¡®Update?¡¯ communications and the Oscar communicationsarebothassociated	withtheDestory RAT	familyofmalware.Thismalwarefamily	hasbeen used in a number of targeted	 attacks including the July	2011SK Communicationshack.	Throughsharedinfrastructure themalwarehas linkstotheseriesof coordinated,	 covert	 and	 targeted	 cyber attacks45dubbed	¡®NightDragon¡¯ ,	andalso	to	therecentseries of targeted attacks that have used ¡®Sykipot¡¯malware.	 46 Through a shared	 callback domain the Destory RAT	 malware also	 has links to	 socially	 engineeredemails including	 those that targeted	 experts on the relationship of the United States with Japan,	 China and	 Taiwan. The Destory RAT	 is also	 connected toLURK	 malware via a compromised code signing certificate which	 was used to sign both	 pieces of malware, and to IP2B communications by a sharedcallbackdomain.The X.Shell RAT has been used in numerous attacksbut	many	of	theseattacksarenot	expected	tobeassociated with	 thesameattackers. Onthe other hand,	 the callbackdomains used by Murcy malware suggest	that	themalwareis used,	perhaps	solely,	bythe attackers responsible for the March 2011 RSA breach.IP	 addresses,	 to	 which ¡®alyac.org¡¯ and itssubdomains previously	 pointed,	 associate thedomain, and the attackers behind it, with a raft	 ofactivity. This	 includes activity	 involving	 callbackdomains registered	 to appear as though they	 were associated with legitimate,	 trusted	 entities,	 anddomainsregistered	to	a¡®LeeCooper¡¯that	tiebacktotheSKCommunicationshack. 45 The NightDragon series of attacks	 began in, or prior to,November 2009 and targeted global	 oil and petrochemicalcompanies.(McAfeeFoundationProfessionalServices	andMcAfee Labs,2011)46 Sykipot is a family	 of malware used since 2007 to stealintellectual property. The malware has been used in a series ofsocially engineered	 email campaigns	 against a variety of sectors.On a number of occasions, the attackers have exploited zero day vulnerabilities	 to install the malware. Some variants	 of themalware include features that enable	 it to hijack	 smartcards.(Thakur,2011)(Lelli,2010)(Blasco,2012)68.178.232.100 NightDragonDestory	RATmalwareisknowntocommunicatewith47the callback domain ¡®vupdate.mail.kr2.com¡¯ ,	 whileNightDragonmalwareis	knownto	communicatewith¡®ma2.mail.kr2.com¡¯48and ¡®www2.mail.kr2.com¡¯49.The communications sent to ¡®www2.mail.kr2.com¡¯ 50are similar ,	 but	 not identical,	 to IP2Bcommunications,	 further linking the observedactivity. Other ¡®mail.kr2.com¡¯ subdomains include¡®cb85.mail.kr.com¡¯,	 ¡®sa****.mail.kr2.com¡¯,	 and¡®skylie.mail.kr2.com¡¯ .at least two of	 which	 areknowntobeassociatedwithmalware51.Destory	 RAT	 malware is known to use thecallback domain ¡®bbs.afbjz.com¡¯52,	 while knownNightDragon malware uses the callback domain53¡®blog.afbjz.com¡¯ .	Asof	3February	2012, bothofthesubdomains point	 to US IP address 67.90.204.228.This	 overlap in infrastructure appears to be ofparticular significance given the following	 linksbetweenotheractivityonthesameIPaddress.	Asof	6February 2012,thedomains ¡®gmail.mail.ru2.com¡¯,	 ¡®live.mail.ru2.com¡¯,	 ¡®mail.ru2.com¡¯,¡®msn.mail.ru2.com¡¯, ¡®usaisbig.oerco.com¡¯,¡®whois.oerco.com¡¯,	 ¡®www.afbjz.com¡¯,	 and¡®www2.oerco.com¡¯ also	 point to IP address67.90.204.228. At	 least	 one of	 these domains is	otherwiseknowntobeassociatedwith	malware54.	 47 TheDestoryRATwithMD5hash¡®95558985D211	F768	1ACC1AC9	 2DCB	 07C8	 A096	 B403¡¯ uses	 the callback	 location¡®vupdate.mail.kr2.com¡¯.48Malware with MD5 hash	 ¡®2D8A 9038 E151 FB30 D45E A8668AFD	2A8E¡¯,knowntocallback	to¡®ma2.mail.kr2.com¡¯,is	detectedbyantivirus	softwareas	 ¡®TrojanDropper:Win32.RedSip.A¡¯,analiasfor NightDragon malware. (ThreatExpert Ltd., 2010) (HispasecSistemas,2011)(Kurc,2011)49Malware with MD5 hash ¡®5BC5 97E4 8270 F04E C9B6 83432432 E352¡¯, known to call back to ¡®www2.mail.kr2.com¡¯, isdetectedbyantivirussoftwareas¡®Backdoor:Win32/RedSip.A!svc¡¯,an alias	 for NightDragon malware. (Sunbelt Security, 2010)(HispasecSistemas,2010)50 Both	communicationsbeginwith	a16byteheadercontaining	theprotocolidentifier ¡®0x12345678¡¯ and	 a data size, and	 the data inbothcontains	similarsysteminformationbutinadifferentorder.51 Maliciousfiles	areseparately	knowntoattemptcommunicationswith ¡®sa*****.mail.kr2.com¡¯ on TCP	 port 8000, and	 ¡®cb85.mail.kr2.com¡¯onTCP	port6543.	(DoctorWeb,2011)(SunbeltSecurity,2011)52The domain ¡®bbs.afbjz.com¡¯	 is a known callback domain ofDestory RAT malware that is	 detected by antivirus software asbothBackdoor:Win32/Thoper.Aand	Backdoor.Sogu.(Wong,	2011)(Mullaney,2011)53 The domain ¡®blog.afbjz.com¡¯	 is	 a known callback	 domain ofNightDragon malware that is detected by antivirus software as¡®Tro n.Dropper:Win32/Redsip.A¡¯.(Kurc,2011)54 Malware that is	 detected by antivirus software as¡®Trojan.DownLoader4.8565¡¯ communicates withus****ig.oerco.comonTCPport100.(Dr.Web,2011) The¡®oerco.com¡¯domainis	registeredto	thesame55personas ¡®afbjz.com¡¯ ,	associating	 thetwo domainswith a single entity.	 The ¡®mail.ru2.com¡¯ domainappearsto	 beassociated	withthesameentity	asthe¡®mail.kr2.com¡¯domainusedby	NightDragonmalwareand	theDestroyRAT	(asdescribedabove).	Whilethedomainswereregisteredusing	different	details,they	were registered	 on the same day	 through the samedomainnameregistrar,	and	therecordslaterupdated56minutes apart .	 This suggests that	 all C2	 activity	involving	 IP address 67.90.204.228 may	 beassociatedwithasingleentity.	Therecently	expired	domain¡®todaygonever.com¡¯also	 previously	 pointed	 to	 the same IP	 address.	 Aswill be discussed later in the paper,¡®todaygonever.com¡¯ is	 directly	 associated with	malwareand	haslinksto	therecent	seriesofSykipotattacks.	 The recently expired	 domains¡®goodfeelingauto.com¡¯ and ¡®deadlinely.com¡¯ also	pointed	 to	 the same IP	 address and	 were likelyassociatedwiththesameattackers. Socially	 Engineered EmailsOther Destory	 RAT	 callback domains are alsootherwise linked to malicious activity.	 For example,	the callback domain 'www.adv138mail.com'57was58used by	 a Poison Ivy RAT sent	 in a July	 2011	socially	 engineered	 email campaign. The emailscontained	 an attachment,	 named	 ¡®MeetingAgenda.pdf¡¯,	 which	 attempted	 to exploit	 avulnerability	 specified by	 the CommonVulnerabilities and Exposure (CVE) number 2010.592883 to	 install the Poison Ivy RAT.	 A clean decoyPDFfilewasshowntotheuserwhentheattachmentwas opened. A copy	 of	 the text used in the socially	60engineered	emailcampaignisshowninFigure10 .	 55 Both	 domains	 are registered to a person whose contact emailaddress is	 ¡®madconnon@126.com¡¯. The name and	address detailsareidenticalforbothdomainregistrations.56The domain ¡®mail.kr2.com¡¯	 was	 last modified on 24 February2012 at 1:40:32, while	 the domain ¡®mail.ru2.com¡¯	 was	 lastmodified on the same day at 1:43:53. Both	 domains wereregisteredthrough	35	Technology	Co.,Ltdon8March	2010.57 Thedomain¡®www.adv138mail.com¡¯	is	listed	as	aBackdoor.Sogucallback.(Mullaney,2011)58 ThePoison IvyRATis	anadvanced	remote administration toolforWindows.Both	freeandpaid	versionsoftheRATareavailable.(shapelessn.d.)59CVE 2010.2883 refers	 to a particular vulnerability in certainversionsofAdobeReaderand	Acrobatwhichanattackercanusetotake	 control	 of affected	 Windows, Macintosh and	 UNIX systems.AdobeSystemsIncorporated2010)60 EmailcourtesyofMila	Parkourof¡®contagiodump.blogspot.com¡¯.(Parkour2011)Dear <recipient>, The Sasakawa Peace Foundation would like to extend to you an invitation to be our guest speaker at the America¡¯s Strategic Restraint and its Implications for the U.S.-Japan Alliance. As you know, the Sasakawa Peace Foundation is interested in the U.S.-Japan Alliance Since you are familiar with the field, we know your views will be extremelyinteresting to us. please find enclosed further details, we would appreciate having your acceptance soon so we may complete our agenda. Best wishes, <purported sender> FIGURE10:TEXTOFASOCIALLY ENGINEEREDEMAILASSOCIATEDWITHWWW.ADV138MAIL.COMThe domain ¡®www.adv138mail.com¡¯ is	 also	associated with	 malware detected by	 antivirussoftware as ¡®Backdoor.Win32.Delf.abow¡¯61.	 Otherknownsubdomainsinclude: . ¡®asm.adv138mail.com¡¯,. ¡®dns.adv138mail.com¡¯,. ¡®ftp.adv138mail.com¡¯,. ¡®ihi.adv138mail.com¡¯ ,. ¡®nov.adv138mail.com6¡¯2.	These domains (with the possible exception ofthe¡®dns¡¯and¡®ihi¡¯subdomains)haveallpointedtothe63same infrastructure as the domains ¡®pu.flower.show.org¡¯ and ¡®www.mailsignin.net¡¯.	 That sharedinfrastructure is	 known to	 have been used to sendsocially	 engineered emails that	 contained	 anattachment	named¡®invtation.pdf¡¯[sic].	Similartothe¡®Meeting	 Agenda¡¯ attachment, ¡®invtation¡¯ installs aPoisonIvy	RAT,	 butoneconfiguredtocommunicate64withthecallbackdomain¡®pu.flower.show.org¡¯ .	The65textusedintheemailsisshowninFigure11 .	 61ThemalwarewithMD5hash¡®F0B848A8	41D4EF3406A6	F9C4766C	 540B¡¯modifies	 the¡®hosts¡¯ file oncomputers	 itisrunonsothat the file contains	 an entry for ¡®www.adv138mail.com¡¯.(ThreatExpertLtd.,2011)62 The domain ¡®ihi.adv138mail.com¡¯	 is	 listed	 as aBackdoor:Win32/Thoper.Acallback	location.(Wong,	2011)63 The domains	 previously pointed	 to a C2	 server located	 at IPaddress112.121.171.94.64 The socially engineered email that communicated back to¡®pu.flower.show.org¡¯	 was	 sent from IP	 address 112.121.171.94 . thesameIP	addresstowhichthecallbackdomainpointed.	65 EmailcourtesyofMila	Parkourof¡®contagiodump.blogspot.com¡¯.(Parkour, contagio: Jul 5	 CVE.2010.2883 PDF invitation.pdf withPoisonIvyfrom112.121.171.94|pu.flower.show.org,2011) Dear Sir/Madam, I¡¯m greatly honored to invite you to the seminar about technology, which will be held on 28th,July.We would appreciate it if you would take your spare time to share the occasion with us. The detail information is in the attachment. Please confirm your participation at your earlist convenience. Looking forward to your reply.Thanks very much. Best Regards,<purported sender> FIGURE11:TEXTOFASOCIALLY ENGINEEREDEMAILSENTFROMIPADDRESS112.121.171.94 Additional Destory	 RAT LinksIn	 addition to having	 previously	 sharedinfrastructurewiththeknownDestoryRATcallbackdomain ¡®www.adv138mail.com¡¯,	 the domain¡®www.mailsignin.net¡¯ has also previously	 sharedinfrastructurewith	atleast	twootherknownDestoryRAT	 callback domains.	 The domain¡®www.mailsignin.net¡¯ previously	 pointed	 to	 IPaddress 175.45.22.220,	 as did	 the known DestoryRAT	 callback domains ¡®newhose.ntimobile.com¡¯ and66¡®sms.servegame.com¡¯ .	 A number of	 subdomains ofthe Destory	 RAT.associated	 domain ¡®join3com.com¡¯ 67also	previously	pointed	tothesameIPaddress .	These links suggest that	 many	 attacks in whichtheDestory	 RAT	has been used are linked,	 not	 only	by	 the malware, but	 also	 through C2 infrastructure.This	 further supports the notion that the Destory	RAT	 was developed by,	 or for, particular attackersand	 that	 most,	 if not	 all,	 of	 the malicious activityinvolvingit	is	attributabletothoseattackers.TheDestorycallbackdomainsalso	have linkstoadditional malware.	 For example,	 the domain¡®network.sec.net¡¯has been used	by	theDestory	RAT¡®gm1.network.sec.net¡¯),	 by	 Poison Ivy malware68(¡®yoyo.network.sec.net¡¯ ) and	 by	 ¡®Backdoor.FCQ¡¯ 66 Thedomains¡®newhose.ntimobile.com¡¯and¡®sms.servegame.com¡¯ are listed as known callbacks for Backdoor.Sogu and Thoper.Arespectively.(Wong,	2011)(Mullaney,2011)67 The ¡®join3com.com¡¯	 subdomains ¡®123.join3com.com¡¯,¡®dow.join3com.com¡¯,¡®ftp.join3com.com¡¯,and¡®ico.join3com.com¡¯areall known to have pointed to IP	 address 175.45.22.220. Thedomain ¡®catalog.join3com.com¡¯ is listed	 as	 a knownBackdoor:Win32/Thoper.Acallback	location. (Wong,	2011)68 The domain ¡®yoyo.network.sec.net¡¯	 is	 used by malware withMD5	hash¡®37037F674BCB	BB7EEF3889AB	6EB3	0268¡¯.(ThreatExpertLtd.,2008)(¡®pingabm.network.sec.net¡¯,¡¯ ¡®psbm11025.network.69sec.net¡¯and	¡®psbm10.network.sec.net¡¯ ). Compromised Code	Signing CertificateTheobservedLURK	communicationsappeartobethesame as those generated by malware that	 wasdigitally	 signed using	 a compromised code signingcertificatethat	wasusedtosignaDestory	RAT,and	other malware used	 in several attacks70.	 Thatmalware communicates with	 the domain¡®office.windowupdate.org¡¯.adomainthatis	linkedto¡®alyac.org¡¯ not	 only	 by	 the communications protocolbut	 also by	 both domain registration tactic and71infrastructure .	(Fagerland,	2011)Travlman LinksThe Destory	 RAT	 malware used	 in the SK	72Communications hack is	 identical,	 except for its73configuration, to	 malware that communicates withthe callback domain ¡®wow.travlman.com¡¯.	 Thecallback domain previously pointed	 to	 the same IPaddress as that	 used	 in the SK	 Communications74hack .	 Both	 of	 the malicious files were compiledfrom the same code on 27 September 2010 at7509:17:04 Greenwich Mean Time (GMT) ,	 and laterconfigured.	Thecallbackdomain76¡®wow.travlman.com¡¯is	also	used by	 malware that produces ¡®IP2B¡¯communications of an identical format	 to thosedecoded from the ¡®Extra.Data¡¯ in the Murcy	communications.	 This	 highlights an additional link 69 Backdoor.FCQ uses	 several	 ¡®network.sec.net¡® subdomains	 ascallbacklocations.(McAfeeInc.,2011)70ThefirstreportedabuseofthecertificatewasinrelationtotheHupigontrojanwithMD5	hash	¡®8800839871A3	3801B2B46F9E23B7 B7A5¡¯. (Hispasec Sistemas, 2011) (Common ComputerSecurityStandards)71Refer to the ¡®LURK Communications¡¯ section for additionalinformation.72The Destory RAT used in the SK	 Communications	 hack	 washosted	 on a toolbox as ¡®nateon.exe¡¯, and	 called back	 to¡®nateon.duamlive.com¡¯. It has a SHA1 hash of ¡®F84C D73D ABF186607F98	6DF98C5402A5	7BB58AD1¡¯	andMD5of¡®461884F1D41E9E0709B4	0AB2	CE5AFCA7¡¯.(CommandFivePtyLtd,2011)73Malwarewith	theMD5	hash¡®5FCE1FC18283D76C396A3CCC64BDBBDE¡¯	callsbackto¡®wow.travlman.com¡¯.74Both	¡®wow.travlman.com¡¯	and	¡®duamlive.com¡¯	previouslypointedto IP address	 203.160.67.131. (rbls, shenqi.travlman.com is notlisted	inanyblacklists,2011)(DomainTools,LLC)75 Automatedanalysisreportsconfirmthecompilationtimeofthecodeandthat,whiletheMD5hashofeach	ofthefilesis	different,theMD5	hashes	ofeachofthecode sections,exceptfor the.datasection, are identical. (Hispasec Sistemas, 2011) (HispasecSistemas,2011)76Malware with	 MD5	 hash ¡®B098	 AEE1 6BD1	 38C4	 1207 5C9D315A	EFC9¡¯.(ThreatExpertLtd,2010) between the Destory	 RAT and	 the IP2Bcommunications.Several other ¡®travlman.com¡¯ sub.domains areknown to	 exist including at	 least one that isassociated with	77 malware. The sub.domain78¡®dm.travlman.com¡¯ is	thecallbackusedby	malwaredetected by antivirus software as79¡®Trojan:Win32/Boupke¡¯ .	 Link to	 RSA BreachThe majority	 of	 the known callback domains forMurcy malware were used in the March	 2011 RSAbreach.	 This suggests that the attackers responsiblefor the RSA breach	 also use the Murcy malware.Given that	 the malware is	 reportedly	 not inwidespread	 use,	 the Chinese server communicatingwith¡®path.alyac.org¡¯may	havebeencompromisedbythesameattackersresponsiblefortheRSA	breach.	 X.Shell RATThe X.Shell RAT is	 commercially	 available softwarethat appears to	 have been used in a number ofattacks.	 There are numerous versions of the X.ShellRAT,	andnotallproducethesamecommunications.	Malware that	 generates the same X.Shell C60180communications observed to	 ¡®path.alyac.org¡¯appears to	 have been used in a number of attacks.Malwarethat	generatessimilarcommunicationsalso	81appearstohave beenusedinanumberof	attacks .	That	malwareis	thought	 tobean X.ShellC603	RAT	and	notanX.ShellC601	RAT.	It	is	not	knownwhetherany	 of these malicious files were used	 by the same 77 The following	 are known ¡®travlman.com¡¯ subdomains;¡®dm.travlman.com¡¯, ¡®g.travlman.com¡¯, ¡®g1.travlman.com¡¯,¡®g2.travlman.com¡¯, ¡®luandao.travlman.com¡¯, ¡®mail.travman.com¡¯,¡®seo.travlman.com¡¯, ¡®shenqi.travlman.com¡¯, ¡®wayi.travlman.com¡¯,and	¡®www.travlman.com¡¯.78Malware with MD5 hash ¡®70A8	 8091 E1F9	 A7BE E246	 488CCE79 936A¡¯	 is known to request the webpage¡®http://dm.travlman.com/up.txt¡¯.(SunbeltSecurity,2009)79Malware with	 MD5	 hash ¡®70A8	 8091 E1F9	 A7BE E246	 488CCE79 936A¡¯ is detected by antivirus software asro n. n . o e!IK¡¯, ¡®Trojan:Win32/Boupke.gen!A¡¯, and¡®Trojan.Win32.Boupke¡¯.(HispasecSistemas,2009)80 Automated	analysis	reportsexistontheInternetforprobable	X.Shell601	 malware with	MD5	 hash ¡®6581 3CBB	 660E 91CD 5FA08300 E177	EB09¡¯, ¡®229947CC71A4601B8B7794B402E536A9¡¯,¡®DA2F 9831 5F4C 56FC E212 73E2 1E45 3B76¡¯, and¡®F4C0 8D3DF5ED E079 0E34 EAE0 C5DB 8A7A¡¯.(Hispasec Sistemas, 2011)(Threat Expert Ltd, 2011) (Threat Expert Ltd, 2011) (ThreatExpertLtd,	2011)81Automated	analysis	reportsexistontheInternetforprobableX.Shell603	malwarewith	MD5	hash¡®679993AD2CF8EFDC788E0BA204D69B0D¡¯,and¡¯CE938C647831080B71165389E43E744D¡¯.(HispasecSistemas,2011)(HispasecSistemas,2011)attackers who	 used the X.shell malware which	communicateswith¡®path.alyac.org¡¯. Shared Alyac	InfrastructureThe domain ¡®alyac.org¡¯ previously	 pointed	 to a C2server located at	 IP address 222.122.20.241	 andanotherlocatedatIP	address202.30.224.240. TheseIP	 addresses are associated with	 a number of othercallback domains including	 ¡®bbs.ezxsoft.com¡¯,¡®pc.nprotects.org¡¯,	 and ¡®wow.travlman.com¡¯ .thelatterbeing	linked	toboththeDestory	RATand	IP2B82communications(aspreviously	discussed) .	In	additionto	 bothhaving	shared	infrastructurewith ¡®alyac.org¡¯,	 the two callback domains¡®bbs.ezxsoft.com¡¯ and	 ¡®pc.nprotects.org¡¯ are used by83malware that creates a uniquely	 named	 directory .	This	indicatesadirect	relationship	 betweenthe twopiecesofmalware.	The domain ¡®ezxsoft.com¡¯ was registered	 by thesameentity	(¡®LeeCooper¡¯)asadomainused	intheSKCommunications hack (¡®ro.diggfunny.com¡¯),	 furtherlinking	it	to	thesameattackers.	TheC2	serverand	thecallbackdomainsalso	havelinkstoamyriad	of	other84maliciousactivity . Sykipot ActivityAs previously	 discussed,	 before it expired,	¡®todaygonever.com¡¯pointedto	aC2serverassociatedwith both the Destroy	 RAT	 and NightDragonmalware.	 The same domain is also	 associated with	Sykipot activity	 through	 shared C2 serverinfrastructure,	and	domainregistrationinformation.Over its lifetime the domain ¡®todaygonever.com¡¯ pointedto	numerousIP	addresses,	many	ofwhicharenot	noteworthyasthey	wereassigned	toserversthat	hosted	numerouswebsites.	Fourof	theIP	addresses,	however,	 are of particular note . IP	 addresses67.90.204.228 (as previously discussed),67.79.149.90,	 209.133.72.83 and	 an IP addressallocated	toalargeUSfinancialinstitution.	 82 Malware detected as	 'Trojan.Win32.AgentBypass' uses	 thecallback domain 'bbs.ezxsoft.com'. Malware detected	 as¡®Trojan.Win32.Generic¡¯	usesthecallback	domain¡®pc.nprotects.org¡¯.(GFISandBox2011) (GFISandBox2011)83 Both	 pieces	 of malware create a directory named¡®03a075fb70d5d675f9dc26fc¡¯	 anda subdirectory named ¡®update¡¯.(GFISandBox2011)(GFISandBox2011)84 Forfurtherdetails	ofthelinks,refertothepaper¡®SKHackbyanAdvancedPersistentThreat¡¯.(CommandFivePtyLtd,2011) IP	 address 67.79.149.90 previously	 hosted	 theknown Sykipot domain ¡®help.newcarstyle.com¡¯. BothIP	 address 67.79.149.90 and IP address209.133.72.83	 previously	 hosted ¡®bluelightness.com¡¯85subdomains .	Theythereforehaveadditionallinksto	Sykipot activity	 as ¡®shopping.bluelightness.com¡¯ waspreviously	hostedonIP	address209.53.155.244.thesame IP address as the known Sykipot domains¡®www.topix21century.com¡¯ and¡®notes.topix21century.com¡¯86.	The¡®bluelightness.com¡¯domain is also	 linked	 to	 ¡®mail.kr2.com¡¯ .a DestoryRAT	and NightDragondomainpreviously	discussed.	Both	 domains share infrastructure with	 the domain¡®worldsecuritys.com¡¯87.As of	 6 February,	 the domains¡®file.filesdelete.com¡¯,	 ¡®news.welldone123.net¡¯ and¡®well.welldone123.net¡¯ all point to the IP	 addressallocated	 to the large US financial institution (towhich	 ¡®todaygonever.com¡¯ also previously	 pointed.)	The domain ¡®welldone123.net¡¯ is	 a known Sykipotcallback domain88.	 The domain ¡®filesdelete.com¡¯ isalso	otherwiseassociated	withmalware89.The email address listed	 in the domainregistration for ¡®todaygonever.com¡¯ was¡®janagreen2000@gmail.com¡¯.	Thesamecontact	emailaddress(but	different	name,address,	and	phoneandfax	 numbers) was also	 used	 in the domainregistration for ¡®centurycpc.com¡¯, ¡®filesdelete.com¡¯,¡®greenrightway.com¡¯, ¡®quicklyfindme.com¡¯, and¡®newcarstyle.com¡¯ .at	leasttwoofwhich	areknown90Sykipotmalwaredomains . 85 IP address 67.79.149.90 previously hosted¡®helpdesk.bluelightness.com¡¯ and	 IP address 209.133.72.83previouslyhosted¡®shopping.bluelightness.com¡¯.86 IP	 address 209.53.155.244 previously hosted¡®notes.to ix21centur .com¡¯, ¡®shopping.bluelightness.com¡¯, and¡®www.topix21century.com¡¯. The webpage ¡®topix21century.com¡¯ was used, in what is believed to have been a targeted	 attack, toinstallSykipotmalwareoncomputers	which	visitedthewebpage.The installed malware then communicated with a C2 serverlocated at ¡®notes.topix21century.com¡¯. (Symantec Corporation,2010)(MalwareGroup.com)87In 2011 both the known callback	 domain ¡®cb85.mail.kr2.com¡¯ and	 ¡®test.worldsecuritys.com¡¯	 pointed	 to IP	 address 12.68.249.62the later still points there as	 of 9	 February 2012. In 2011,¡®bluelightness.com¡¯	 and ¡®worldsecuritys.com¡¯	 both	 pointed	 to IPaddress68.178.232.100,thelaterstillpoints	thereasof9	February2012.88The domain ¡®welldone123.net¡¯	 is known to be associated withtheSykipotseries	ofattacks.(SymantecCorporation,2012)89 The domain ¡®www.filesdelete.com¡¯	 is	 associated with¡®Troj/Bdoor.BDM¡¯.(SophosLtd.,2012)90Thedomain¡®help.newcarstyle.com¡¯	isaknownSykipotcallback,asis¡®greenrightway.com¡¯.(SymantecCorporation,2012)(MalwareDomains,2012). . . . . INSIGHTS Increasingly,	insteadof	malwareusingthedefault	DNSserversonacompromisedcomputerto	resolveits	callbackdomainsto IP	addresses,	attackerswillspecifyDNS	serversforthemalwaretouse.	Thishas significantimplicationsfornetworkdefenders.	Such	requests,	ifallowed,	willbypassthevictim¡¯sDNSserversanddefeat	any	blacklistsusedby	thevictim¡¯sownDNSservers.	Furthermore,	therequestswillnot	appearinthevictim¡¯sDNSserverlogs,	making	detectionandinvestigationmore difficult.	Organisationsshould	considerblocking internalDNStraffic	toalllthanthecompany¡¯sownDNocationsotherS	servers.	Furthermoretheyshould	bealert	toany	DNS	communicationattemptstolthanthecompany¡¯sownDNS	ocationsother ,	asthis servers may	beanindicatorof	amalwareinfection.Whencodesigningcertificatesarerevoked	thedateof	effect	of	therevocationis	chosen sothat,wherepossible,	legitimatesoftware signedwith	thecertificatecontinuestovalidate.	Unfortunately,	thismeansthat	sometimesmalwaresignedwithacompromisedcertificatewillalso	continuetovalidate(despitetherevocation).Somemalwareattempts	tocommunicate withC2infrastructureatfrequentintervals.	Thefrequency	ofthesecommunicationattemptscanbeusedtodetect	themalicious activity.TCPport443	trafficisoftenallowed	outofanetworkwithout	inspectionby	networksecurity	appliancesasit	is	expectedto	belegitimate,	encrypted	SSLcommunications thatcanbedifficult	to	inspect.	Unfortunately,	 attackerstakeadvantageof	thisby	using	the portto	bypasssecurity	appliancesto communicatewith	aC2server(such	aswith	theobservedX.Shellcommunications). . Attackersoftenreusethesamecodefortheirmalware.	Sometimestheywillrecompilethe code,	sometimesthey	willmerely	reconfigurethemalware.	Thisaltersthefile hashand	effectivesthereforesuch	ahash	isnotan ofthemaignatureforotherconfigurations lware.Hashesoftheindividualcode sections(e.g..text,.rdata,	.reloc)makefor morerobustdetectionassectionswithinthemaliciousfilesoftenremainthesame.	 . ThemajorityoflegitimateexternalnetworkcommunicationsusetheDNS	protocolto	determinetheirdestination¡¯sIP	address.	Outboundnetworkactivitythatoccurs	 withoutaDNS	lookupshould	betreatedwith	suspicionuntilthepurposeof	thecommunicationscanotherwisebedetermined. . Blocking	outbound	communicationattemptsthatarenot	preceded	by	aDNS	lookup	can beeffectiveinblockingC2	communication attemptsthataremadedirectto	anIP	 address(such	astoanIP	addresslistedwithinanX.Shellconfigurationwebpage).	LegitimatedestinationIPaddressesshould	bewhitelistedto	prevent	legitimateactivity	 fromalsobeingblocked. . Attackerswillsometimescontinueto	usea callbackdomainevenwhenitislisted	on blacklistsand	inmultiplemalwareanalysis reports. . Blacklisting	adomaincanbeusefulbut	taking	thetimetoresearch	thedomainand	associatedactivity	canhelp	withthedevelopmentofmoreeffective,longerterm	 mitigationstrategies. DISCLAIMER Machinetranslationsoftwareand	automated	malwareanalysis	reportshavebeenheavily	reliedonthroughout	thedevelopment	ofthispaper.Whiledatahas beenverified	againstmultiplesources wherepossible,CommandFivePtyLtddoesnotguaranteetheveracity	ofsourcesorthe accuracy	of	theinformation.CommandFivePty	Ltd	reminds	readersto	exercise caution when visiting untrusted websites and/or opening untrusteddigitaldocuments.	Command	Five Pty	Ltddoesnotwarrantthatthewebsitesreferencedinthispaperaretrustworthy. PAGE17OF29COPYRIGHTý	COMMANDFIVEPTY	LTD.ALLRIGHTSRESERVED. REFERENCES Blasco,J.	(2012,	January12).Sykipot variant hijacks DOD and Windows smart cards.	RetrievedFebruary	05,	2012,	 fromAlienvaultLabs:http://labs.alientvault.com/labs/index.php/2012/when.the.apt.owns.your.smart.cards.and.certs/CommandFivePty	Ltd.	(2011,	June).Advanced Persistent Threats: A	 Decade	 in Review. Retrieved	September24, 2011,	fromCommand	FivePty	Ltd:	 http://www.commandfive.com/papers/C5_APT_ADecadeInReview.pdfCommandFivePty	Ltd.	(2011,	September).	SK	 Hack	 by an Advanced Persistent Threat.	RetrievedJanuary	06,2012,	fromCommand	FivePty	Ltd:http://www.commandfive.com/papers/C5_APT_SKHack.pdfCommonComputerSecurityStandards.	(n.d.).	Digital	 Certificates Used by	 Malware.	RetrievedFebruary02,2012,	 fromCCSSForum:http://www.ccssforum.org/malware.certificates.php?&pag=4Coviello,	A.	(2011,	March	17).	Open Letter to	 RSA Customers.	Retrieved	June13,	2011,from	RSA:	 http://www.rsa.com/node.aspx?id=3872Deutsch,	P.(1996,May).	DEFLATE	 Compressed Data Format Specification version 1.3.	Retrieved	January08,	2012,	 fromIETF	RFC1951:http://www.ietf.org/rfc/rfc1951.txtDeutsch,	P.(1996,May).	ZLIB Compressed Data Format Specification version 3.3.	RetrievedJanuary	25,	2012,	from IETF	RFC1951:http://www.ietf.org/rfc/rfc1950.txtDoctorWeb.	(2011,December29).	Dr. Web	 Anti.virus .How To Remove Virus (Trojan.DownLoader4.20396) .[DRWEBHK.COM].	Retrieved	December29,	2011,from	Dr.	WebHK:	 http://www.drwebhk.com/en/virus_techinfo/Trojan.DownLoader4.20396.html DomainTools,	LLC.	(n.d.).203.160.67.131 	IP	 Address | WHOIS 	| DomainTools.com.RetrievedfromDomainTools:http://whois.domaintools.com/203.160.67.131Dr.	Web.(2011,	July	10).Dr.Web .innovation IT.security	 solutions. Complex protection against Internet threats. Retrieved	0203,	2012,from	Dr.Web:	http://vms.drweb.com/virus/?i=1007435 Fagerland,	S.	(2011,	November17).	Invisible YNK, a Code	 Signing Conundrum | Norman Blog.	Retrieved	December 13,	2011,from	Norman.com:http://blogs.norman.com/2011/malware.detection.team/invisble.ynk.a.code.signing.conundrum F.SecureCorporation.(n.d.).Threat Description: Backdoor: W32/Hupigon.	Retrieved	December23,2011,	from	F.Secure:	http://www.f.secure.com/v.descs/backdoor_w32_hupigon.shtml GFISandbox.	(2010,	May	07).	GFI Sandbox Analysis Report.	Retrieved	January06,	2011,	from	GFI	Sandbox:http://xml.ssdsandbox.net/index.php/37405d5bcf64fb9547cacda95f4ce8b4GFISandBox.(2011,August	04).	GFI SandBox Analysis Report.	Retrieved	October17,2011,	fromGFI	SandBox:http://xml.ssdsandbox.net/index.php/91a268b317d2cc6569b85bb03a5ff841GFISandBox.(2011,July	15).	GFI SandBox Malware Analysis Report: Trojan.Win32.AgentBypass.	Retrieved	August25,	2011,from	http://xml.ssdsandbox.net/view/fdf2c5c2b1874efe7fd335092df2d3bcGFISandbox.	(2011,	September04).GFI Sandbox Malware Analysis Report: Trojan.Win32.Generic.	Retrieved	January	06,	2012,	fromGFI	Sandbox:http://xml.ssdsandbox.net/index.php/9addc6d573309399e2b878873a00a921 GFISandBox.(2011,May	29).	GFI SandBox Malware Analysis Report: Trojan.Win32.Generic!SB Trojan.Trojan.Win32.Generic.	RetrievedSeptember2011,2011,	from	http://www.xml.ssandbox.net/view/bce1069dd099f15170c5fd05bae921b5GFISandbox.	(2011,	March	20).	GFI Sandbox Malware Analysis Report: Trojan.Dropper.Win32.Wykores.	RetrievedJanuary	06,	2012,	fromGFI	Sandbox:http://xml.ssdsandbox.net/index.php/0d38d6c2b9eb817b40afc4272545a43bGFISoftware.(2010,December26).CWSandbox Report by MD5 at Sunbelt Security.Retrieved	December27,2011,	fromSunbeltSecurity:http://www.sunbeltsecurity.com/partnerresources/cwsandbox/md5.aspx?id=19b0227bec75bef93c6ccc549b6d2ba0	HispasecSistemas.	(2009,	April15).Antivirus scan for 70a88091e1f9a7bee246488cce79936a at 2009.04.15 11/52/02 UTC.	Retrieved	February02,	2012,	from	VirusTotal:	https://www.virustotal.com/file/63ac63f59700dbcc3778a9c1e9f5689869c86ac2aa3295ad93278f9244cff7f4HispasecSistemas.	(2010,	May	22).	Antivirus	scan for	5bc597e48270f04ec9b683432432e352 at 2010.05.22 17/52/37 UTC .VirusTotal.	RetrievedFebruary	07,	2012,	fromVirusTotal:https://www.virustotal.com/file/e4711259a3dd9af85b649cc8afcf34bc86d1d68ed7286db35f7b260e6027c110/analysis/HispasecSistemas.	(2011,	August15).	Antivirus scan for	 2d8a9038e151fb30d45ea8668afd2a8e	at 2011.08.15 13/34/31 UTC .VirusTotal.	RetrievedFebruary	03,	2012,	fromVirusTotal:https: /www.virustotal.com/file/76747e708d79925ba0817d48c96f4c85938bfe3f0f5b681ff204a09bd3ebc1cc/analysisHispasecSistemas.	(2011,	August19).	Antivirus scan for	 461884f1d41e9e0709b40ab2ce5afca7 at 2011.08.19 13/31/35 UTC.	RetrievedFebruary02,	2012,	from	VirusTotal:https://www.virustotal.com/file/74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5a4fb1feHispasecSistemas.	(2011,	November06).	Antivirus	scan for	 5fce1fc18283d76c396a3ccc64bdbbde	at 2011.11.06 09/44/14 UTC.	RetrievedJanuary	30,	2012,	from	VirusTotal:https://www.virustotal.com/file/4dc0c7d8d84838c9b209ea727bd4ab7471a88fba55b786f7e37ce6394565b6aa/analysisHispasecSistemas.	(2011,	November08).	Antivirus	scan for	 754364d9db702dc715327b40bf97e556 at 2011.11.08 18/29/09 UTC.	RetrievedJanuary	30,	2012,	from	VirusTotal:https://www.virustotal.com/file/781c30714ff5304b7e9530ec879ef4ed7e94a0138537563b4c12b158c7bcab40/analysisHispasecSistemas.	(2011,	May	10).	VirusTotal	 .Free Online	Virus, Malware and URL Scanner.RetrievedDecember30,	2011,from	VirusTotal:	http://www.virustotal.com/report.html?id=5e29960ba0bb544623b52e5db592242f30c05ca1336ec667d0a162b9a7584f90HispasecSistemas.	(2011,	November21).	VirusTotal	 .Free	Online Virus, Malware and URL Scanner.	Retrieved	December30,	2011,from	VirusTotal:http://www.virustotal.com/file.scan/report.html?id=deb83be93eb74a66b8c654ddb28c3a1c58ee89abf3a72ce616755deb6f9902c.1321864468 HispasecSistemas.	(2011,	December21).	VirusTotal	 .Free	 Online Virus, Malware and URL Scanner.	Retrieved	December30,	2011,from	VirusTotal:http://www.virustotal.com/file.scan/report.html?id=251b196f94d6a858941cb2e18b6879fc2d3f4ef580a8cae338f42e7776229fc.1324454798HispasecSistemas.	(2011,	May	24).VirusTotal	 .Free 	Online	Virus, Malware and URL Scanner.RetrievedJanuary	04,	 2012,	fromVirusTotal:http://www.virus.scan/file.scan/report.html?id=5999da598ee19708c997e77650b0b423c0337ebff16c6ad7d929fc3a84f10f13Kaspersky	LabZAO.	(2010,	January12).	Backdoor.Win32.Agent.anvj.RetrievedDecember09,2011,	from Securelist:http://www.securelist.com/en/descriptions/7440365/Backdoor.Win32.Agent.anvjKurc,	D.(2011,April17).	Encyclopedia entry: TrojanDropper:Win32/Redsip.A	 .Learn more	about malware .Microsoft Malware Protection Center.	RetrievedJanuary	25,	2012,from	MicrosoftMalwareProtection Center:http://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Trojan.Dropper%3AWin32%2FRedsip.A Lelli,	A.	(2010,	March	12).	Zero.Day	 Attack	 on IE6 .JS.Sykipot Doesn't Spare Retired Software.	RetrievedFebruary 01,	2012,from	SymantecConnect	Community:	http://www.symantec.com/connect/blogs/zero.day.attack.ie6.jssykipot.doesn.t.spare.retired.software MalwareDomains.	(2012,January	16).Malware Domains.	RetrievedJanuary	30,2012,	from	MalwareDomains:	http://mirror1.malwaredomains.com/updates/20120116.txt MalwareGroup.com.	(n.d.).	209.53.155.244 	|	 Ipaddress .	Retrieved	January18,	2012,	from	MalwareGroup: http://www.malwaregroup.com/ipaddresses/details/209.53.155.244 McAfeeFoundationProfessionalServicesand	McAfeeLabs.	(2011,February10).	Global	 Energy	 Cyberattacks: "Night Dragon".RetrievedJune13,	2011,	from	McAfee:	http://www.mcafee.com/us/resources/white.papers/wp.global.energy.cyberattacks.night.dragon.pdf McAfeeInc.	(2011,	December22).	Backdoor.FCQ .Malware .McAfee	 Labs Threat Center.	RetrievedFebruary02,	2012,	fromMcAfeeLabsThreat	Center:http://www.mcafee.com/threat.intelligence/malware/default.aspx?id=670739Mendoza,	E.	(2011).TROJ_INJECT.AMR 	| Low Risk | Trend Micro	 Threat Encyclopedia.RetrievedNovember21,	2011,	fromTrend	Micro:	http://about.threats.trendmicro.com/malware/aspx?language=au&name=TROJ_INJECT.AMR Microsoft.	(2007,	December10).A description of Svchost.exe	 in Windows XP Professional Edition. Retrieved	September07,	2011,	from	Microsoft	Support:http://support.microsoft.com/?kbid=314056 Microsoft	Corporation.	(2011,	September07).Locales	and Languages (Windows).	RetrievedJanuary24,2012,fromMicrosoft	SoftwareDevelopment	Network:	http://msdn.microsoft.com/en.us/library/dd318716.aspx Microsoft	Corporation.	(2011,	September07).OSVERSIONINFOEX structure.	Retrieved	January	17,2012,from	 Microsoft	SoftwareDevelopment	Network:	http://msdn.microsoft.com/en.us/library/windows/desktop/ms724833(v=vs.85).aspx Microsoft	Corporation.	(2011,	September07).SYSTEM_INFO structure.	Retrieved	January	24,	2012,	from	Microsoft	 MSDN:http://msdn.microsoft.com/en.us/library/windows/desktop/ms724958(v=vs.85).aspx PAGE20OF29COPYRIGHTý	COMMANDFIVEPTY	LTD.ALLRIGHTSRESERVED. Mullaney,	C.	(2011,July	30).	Backdoor.Sogu Technical	 Details	| Symantec.	Retrieved	August18,	2011,	from	http://www.symantec.com/security_response/writeup.jsp?docid=2011.073003.5345.99&tabid=2Parkour,	M.(2011,July	05).contagio: Jul 5	CVE.2010.2883	PDF invitation.pdf with Poison Ivy from 112.121.171.94 | pu.flower.show.org.RetrievedJanuary28,2012,from	Contagio:	http://contagiodump.blogspot.com/2011/07/message.targeting.experts.on.Japan.htmlParkour,	M.(2011,July	14).Jul 13 CVE.2010.2883 PDF Meeting Agenda with more Poison Ivy	 www.adv138mail.com |	 112.121.171.94. Retrieved	September22,	2011,fromContagiodump	Blog:http://contagiodump.blogspot.com/2011/07/jul.13.cve.2010.2883.pdf.meeting.agenda.htmlRasmussen,	R.	(2011).Practical Usage of Passive	DNS Monitoring for	 E.Crime Investigations.	Retrieved	January04,2011,	fromhttp://conferences.npl.co.uk/satin/presentations/satin2011slide3.Rasmussen.pdf rbls.	(2011,November01).	shenqi.travlman.com is not listed in any blacklists.	Retrieved	November01,	2011,	from	rbls:	http://rbls.org/shenqi.travlman.comSafeZoneCast.	(2011,	August09).	SafeZoneCast.Retrieved	December30,	2011,	fromhttp://safezonecast.lgcns.com/Common/MenaceInfo/pop.MenaceInfo.jsp?code=SZ1108.0003NSSandbox,	G.(2010,December26).GFI Sandbox Malware Analysis Report: Trojan.Downloader.Win32.Generic.	Retrieved	November29,	2011,	from	GFI	Sandbox:http://xml.ssdsandbox.net/view/3df0d0ab4ad9da4559a1c6464c8526d1 shapeless.	(n.d.).	Poison Ivy 2.3.0	Documentation. Retrieved	August17,2011,	from	PoisonIvy	.RemoteAdministrationTool:	http://www.poisonivy.rat.com/dl.php?file=230docsSophosLtd.	(2011,November25).	Detailed Analysis .Troj/Agent.UDR .Viruses and Spyware .Threat Analyses .Threat Center .Sophos.Retrieved	December8,2011,	from	Sophos:	http://www.sophos.com/en.us/threat.center/threat.analyses/viruses.and.spyware/Troj~Agent.UDR/detailed.analysis.aspxSophosLtd.	(2012,January	19).Detailed Analysis .Troj/Bdoor.BDM .Viruses and Spyware .Threat Analyses .Threat Center .Sophos.Retrieved	January	31,	2012,	fromSophosThreat	Center:http: /www.sophos.com/en.us/threat.center/threat.analyses/viruses.and.spyware/Troj~BDoor.BDM/detailed.analysis.aspxSunbelt.(2009,October15).Sunbelt CWSandbox Malware Analysis Report: Backdoor.Win32.Pasur.Retrieved	December19,	2011,from	SunbeltSecuritySandbox:	http://xml.ssdsandbox.net/archive/42e8163b7f08dd383e62e4bdb7f07c08Sunbelt	Security.	(2009,	May03).	Sunbelt CWSandbox Malware Analysis Report.Retrieved	December01,2011,fromSunbeltSecurity	Sandbox:	http://xml.ssdsandbox.net/archive/70a88091e1f9a7bee246488cce79936aSunbelt	Security.	(2009,	October16).	Sunbelt CWSandbox Malware Analysis Report: Trojan.Win32.Sisproc.	Retrieved	December19,	2011,	from	SunbeltSecurity	Sandbox:http://xml.ssdsandbox.net/archive/3fdea18b9610cbc9b63ba7a44899fbfbSunbelt	Security.	(2010,	December31).CWSandbox Report by MD5 at Sunbelt Security.RetrievedOctober25,	2011,	fromSunbeltSecurity:http://www.sunbeltsecurity.com/partnerresources/cwsandbox/md5.aspx?id=69ed8f7b0046956045a90e36e3c83f6aSunbelt	Security.	(2010,	May12).	GFI SandBox Analysis Report.	RetrievedFebruary	07,	2012,from	SunbeltSecurity	SandBox:http://xml.ssdsandbox/archive/5bc597e48270f04ec9b683432432e352 PAGE21OF29COPYRIGHTý	COMMANDFIVEPTY	LTD.ALLRIGHTSRESERVED. SunbeltSecurity.	(2011,	June01).GFI SandBox Malware Analysis Report/ Trojan.Win32.Generic!SB.	RetrievedJanuary	23,	2012,	fromGFI	SandBox:http://xml.ssdsandbox.net/view/228191d05a09877f90c8b802617bb25fSymantecCorporation.(2010,	March	11).	Backdoor.Sykipot At Work.	RetrievedFebruary	02,2012,	from	Symantec ConnectCommunity:	http://www.symantec.com/connect/blogs/backdoorsykipot.workSymantecCorporation.(2012,	January	26).	Insight into Sykipot Operations | Symantec Connect Community.Retrieved	February05,2012,	from	SymantecConnect	Community:	 http://www.symantec.com/connect/blogs/insight.sykipot.operations.0Telus.	(2011,August03).	Backdoor.Win32.Murcy.A .TELUS	Security	 Labs.	Retrieved	December06,2011,	from	 TELUS	SecurityLabs:http://telussecuritylabs.com/threats/show/TSL20110803.01Thakur,	V.	(2011,	December14).	The	Sykipot Attacks	 | Symantec 	Connect Community.Retrieved	February	04,2012,	fromSymantecConnectCommunity:	http://www.symantec.com/connect/blogs/sykipot.attacksThreatExpert	Ltd.(2010,	June15).	ThreatExpert Report.	Retrieved	January11,	2012,	fromThreatExpert:http://www.threatexpert.com/report.aspx?md5=b098aee16bd138c412075C9d315aefc9 ThreatExpert	Ltd.(2011,	July26).	ThreatExpert Report: Backdoor.Win32.Agent.anvj, Trojan.Downloader.Delphi.	Retrieved	December17,	2011,	from	ThreatExpert:	 http://www.threatexpert.com/report.aspx?md5=3e3736dffedaf2a0ae4d948567933b3f	ThreatExpert	Ltd.(2011,	November04).ThreatExpert report: Mal/Behav.027, Backdoor:Win32/Idicaf.gen!B.	Retrieved	November25,	2011,from	ThreatExpert:	 http://www.threatexpert.com/report.aspx?md5=229947cc71a4601b8b7794b402e536a9ThreatExpert	Ltd.(2011,	October06).	ThreatExpert Report: Mal/Behav.027, Virus/Win32.Atraps.CK.	RetrievedNovember21,2011,from	ThreatExpert:http://www.threatexpert.com/report.aspx?md5=da2f98315f4c56fce21273e21e453b76ThreatExpert	Ltd.(2011,	September25).ThreatExpert Report: TrojanDropper: Win32/Idicaf.C, Virus.Win32.Atraps.CK, Backdoor.Win32.Agent.bhxn.	Retrieved	December25,	2011,fromThreatExpert: http://www.threatexpert.com/report.aspx?md5=f4c08d3df5ede0790e34eae0c5db8a7aThreatExpert	Ltd.(2008,	December18).	ThreatExpert Report: Mal/EncPk.BL, Worm:Win32/Emerleox.J, Packed.Win32.Klone.af.	RetrievedJanuary	15,	2012,fromThreatExpert: http://www.threatexpert.com/report.aspx?md5=37037f674bcbbb7eef3889ab6eb30268 ThreatExpertLtd.	(2010,	March	18).ThreatExpert Report: Troj/Agent.MSC, BinImage/Agent.283805.	RetrievedJanuary	26,	2012,	fromThreatExpert:	 http://www.threatexpert.com/report.aspx?md5=2d8a9038e151fb30d45ea8668afd2a8eThreatExpertLtd.	(2011,	December09).	ThreatExpert Report: Backdoor.Win32.Delf.abow, Trojan.Win32.CDur, Mal/Behav.058.. RetrievedFebruary	03,	2012,	fromThreatExpert:	 http://www.threatexpert.com/report.aspx?md5=f0b848a841d4ef3406a6f9c4766c540b US.CERT.	(2011,	March	26).	Early Warning and Indicator	 Notice	(EWIN).11.077.01A UPDATE.	Retrieved	January	 06,	2011,from	IncidentPreventionand	Detection:	ProtectingInformationSecurity	of	NationalBanks:	http://www.occ.treas.gov/news.issuances/alerts/2011/alert.2011.4b.pdfVerisign.(2011).	Verisign Authentication Services.	Retrieved	December29,2011,fromVerisignClass3	Code Signing	CertificateRevocationList:http://crl.verisign.com/CSC3.2009.crl Ward,E.	(2011,July	31).	Backdoor.Murcy |	 Symantec.	RetrievedJanuary05,2011,from	Symantec:http://www.symantec.com/security_response/writeup.jsp?docid=2011.080105.2030.99Wikipedia.	(n.d.).	List of Intel microprocessors.Retrieved	January	21,	2012,from	Wikipedia,	thefreeencyclopedia:http://en.wikipedia.org/wiki/List_of_Intel_microprocessorsWong,	J.	(2011,	August16).	Encyclopedia entry:Backdoor.Win32/Thoper.A.	RetrievedJanuary	24,2012,	fromMicrosoft	MalwareProtectionCenter:http://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Backdoor%3AWin32%2FThoper.AXTiger.Crackersoftware.(2011,	February	14).	All for	Dream... RetrievedDecember23,	2011,from	xdoors.net:http://www.xdoors.net/faq/index.htmlXTiger.	(2010,April28).	forum.xdoors.net.RetrievedDecember19,2011,from	xdoors.net:http://forum.xdoors.net/viewtopic.php?f=4&t=7XTiger.	(2011,March16).forum.xdoors.net. Topic: X.Door/X.Shell free download paused.	RetrievedDecember27,2011,	fromforum.xdoors.net:	http://forum.xdoors.net/viewtopic.php?f=5&t=76XTiger.	 2011).Xdoors.net.	RetrievedDecember23,2011,	from	Allfordream...:	http://www.xdoors.netXTiger.	(n.d.).	X.Shell.	Retrieved	December23,2011,from	XDoors:http://www.xdoors.net/help/X.Shell.htm ANNEX A FORMAT	 OF OSVERSIONINFOEX STRUCTURE OFFSET  LENGTH	(IN	BYTES)  MEMBERDESCRIPTION  0  4  Structuresizeinbytes.¡®0x9C (156bytes).  4  4  OSmajorversion.  8  4  OSminorversion.  12  4  OSbuildnumber.  16  4  AnidentifierfortheOSplatform.  20  128  Anullterminated	string	thatindicatesthelatestServicePackinstalled.  148  2  ServicePackmajorversionnumber.  150  2  ServicePackminorversionnumber.  152  2  Abitmask91 thatidentifiestheproductsuites	installed	onthesystem.  154  1  Producttypethatindicateswhetherthesystemisaworkstation(0x01),adomaincontroller (¡®0x02¡¯)oranNTserverbutnotadomaincontroller(¡®0x03¡¯).  155  1  Abytereservedforfutureuse.  91 For a detailed description of the product suite bit mask refer to the Microsoft MSDN OSVERSIONINFOEX reference page. (MicrosoftCorporation,2011) PAGE24OF29COPYRIGHTý	COMMANDFIVEPTY	LTD.ALLRIGHTSRESERVED. ANNEX B FORMAT	 OF SYSTEM_INFO STRUCTURE OFFSET  LENGTH	(IN	BYTES)  MEMBERDESCRIPTION  0  2  Anumberindicating	theprocessorarchitectureoftheinstalled	OS.  2  2  Bytes	reservedforfutureuse.  4  4  Pagesizeusedand	thegranularityofpageprotectionandcommitment.  8  4  Minimumapplicationaddress.Thisis	thelowestmemoryaddressthatapplicationsand	 DLLscanaccess.  12  4  Maximumapplicationaddress.Thisisthehighestmemoryaddressthatapplications and	DLLscanaccess.  16  4  Amask	representing	thesetofprocessors	configuredintothesystem.  20  4  Thenumberoflogical	processors.  24  4  Processortype.  28  4  Granularityforthestarting	addressatwhich	virtualmemorycanbeallocated.  32  2  Thearchitecture dependentprocessorlevel.  34  2  Thearchitecture dependentprocessorrevision.  ANNEX C SUMMARY OF	 X.SHELL COMMANDS COMMAND COMMANDDESCRIPTION svc Servicecontrol	(list/stop/start/view/installetc.). pslist Listsprocesses. pskill Kills	process. shell Startsacommand	shell. reboot Restarts	thecomputer. shutdown Shuts	downthecomputer. filetime Modifiestimestamponafile(datecreatedetc.). uninstall UninstallsRAT. mlist Gets	processmodulespecificinformation. idle Gets	hostmouseand	keyboard	idletime. uptime Gets	systemuptime. update UpdatepluginfromURL. urlh Opens	aURLinhiddenview. urln Opens	aURLinnormalview. exeh Executesaprograminhiddenview. exen Executesaprograminnormalview. zip Compresses	afileorfoldertoaCabfile. mhost Gets	currentControl	HostIP	addressand	port. fputs Uploads	afiletotheControlHost. fgets Downloads	afilefromtheControl	HostoraURL. inject Injectsapluginintoanotherprocess.(Thedefaultprocesstoinjectintois	¡®IEXPLORE.EXE.) pei Infects	aportableexecutablefile. per Repairsaportableexecutable	file. avinfo Displays	informationaboutinstalled	antivirussoftware. htan TCP	portforwarding	and	mapping. devcon Devicemanager. keylog Keyloggercontrol. cleanl Cleanseventlog. display Displays	control	proxy. proxy HTTPproxyservice. socks5 SOCK5proxyservice. tcpagent TCP	portforwarding. clipboard Clipboard	control. tcplist ListsTCPconnections. tcpkill TerminatesaTCP	connection. sysinfo Gets	systeminformation. spilist SPIlayerinformation. cdrom ControlsCDROM(open/close). sens Extracts	sensitiveinformation. rebind RebindsTCP	porttogetpassword. fport Displays	portinformationwith	processpath. user Usercontrol	(list/add/delete/controletc.).Supports	cloning	andcloning	check	flood. flood Initiatesafloodattack. term Terminal	managementsettings	(viewport/setport/start/stop). findpass Attempts	tofind	currentuser¡¯sloginpassword. myplug Aninterfacetothirdpartydevelopedplugins. ANNEX D SUMMARY OF	 MURCY COMMANDS COMMANDCODE  COMMANDDESCRIPTION  0x1003  GenerateSxl	valuefromtheregistrykeygroup.  0x1004  AddSxl	descriptiontoregistrykey.  0x2000  Lockcomputer.  0x2001  Logoff.  0x2002  Reboot.  0x2003  Shutdown.  0x2004  Executefile.  0x2005  Executemsg.exe.  0x3000  Getsystemdriveinformation.  0x3001  File	search.  0x3003  File	search.  0x300A  Createdirectory.  0x300B  Createprocess.  0x300C  Deletefile(s).  0x3200  Performfileoperations.  0x5000  Obtainprocessinformation.  0x5002  Obtainprocessinformation.  0x5004  Killprocess.  0x6000  Listservices.  0x6002  Deleteservice.  0x6003  Modifyserviceconfiguration.  0x6004  Startservice.  0x6005  Stopservice.  0x7000  Input/outputgenerated	intheprocesswith	anamedpipe.  0x8000  Getenvironmentstring.  COPYRIGHT	 NOTICE CopyrightýCommandFivePty	Ltd.	Allrightsreserved.This	document	is	providedby	thecopyrightholdersunderthelicence thatfollows.	Byobtaining,using,	and/ordistributingthisdocumentyouagree that	 you have read, understood,	 and	 agree to the terms andconditionsthatfollow.Thenamesandtrademarksof CommandFivePty Ltd may	not beusedinadvertisingorpublicity	relatingtothisdocumentorits	contentswithoutspecific,	prior,	writtenpermission.Nopermissionisgivenforthisdocumenttobeused	forcommercialpurposes or as part	 of	 any	 commercial activity	 or undertaking, including,	 but not	 limited to, use in or relating	 to advertising	 or publicity,	and/oruseinsupportof,oraspartof,any	pre.salesorsales activities.Nopermissionisgiventocreatemodifiedorderivativeworks.	Youmay	 distribute this	 document	 in its original form for non.commercialpurposes in accordance with	 the other terms and	 conditions stated	herein.	 Copyright title will at all times remain with the copyrightholders.Allreferencedtrademarksremaintheproperty	of	theirrespective owners.THIS DOCUMENT	 IS PROVIDED ¡®AS	 IS¡¯ FOR INFORMATIONALPURPOSES ONLY WITH NO REPRESENTATIONS OR WARRANTIES	 OFANY KIND, INCLUDING BUT NOT LIMITED TO ANY WARRANTY,EXPRESS OR IMPLIED, OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE; WARRANTY OF	 NON.INFRINGEMENT, ORTITLE; NOR ANY WARRANTIES	 PERTAINING TO	 THE ACCURACY ORCOMPLETENESSOF	CONTENT. ANY OPINIONS	 EXPRESSED IN THIS DOCUMENT MAY CHANGEWITHOUT NOTICE AND	 ARE NOT NECESSARILY THE CONSIDEREDOPINIONS	OF	COMMAND	 FIVEPTYLTD,ITSPARTNERS,	 EMPLOYEES,OR AFFILIATE	 ORGANISATIONS.	 ANY ADVICE OFFERED IN THISDOCUMENTISOFFERED	WITHOUTWARRANTYOFANYKIND. CommandFivePty	LtdABN:	49149	576	670http://www.commandfive.cominfo@commandfive.com 