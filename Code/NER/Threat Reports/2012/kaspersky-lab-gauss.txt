 = zerospywarelite_installer.exe  clamd.exe  fgui.exe  dlservice.exe  Wireshark.exe  sab_wab.exe  filedeleter.exe  ashwebsv.exe  tshark.exe  SUPERAntiSpyware.exe  firewall.exe  ashdisp.exe  rawshark.exe  vdtask.exe  firewall2004.exe  ashmaisv.exe  Ethereal.exe  asr.exe  firewallgui.exe  ashserv.exe  Tethereal.exe  NetguardLite.exe  gateway.exe  aswupdsv.exe  Windump.exe  nstzerospywarelite.exe  hpf_.exe  avastui.exe  Tcpdump.exe  cdinstx.exe  iface.exe  avastsvc.exe  Netcap.exe  cdas17.exe  invent.exe  Netmon.exe  fsrt.exe  ipcserver.exe  CV.exe  VSDesktop.exe  ipctray.exe  The module reads the registry value “SOFTWARE\Microsoft\Windows\CurrentVersion\Reliability” “TimeStampForUI”. It is an encrypted configuration file. The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules’ additional files. Checks for running anti-malware products by names and exits if they are present: Each directory contains a specially crafted desktop.ini file and target.lnk file that exploits the LNK vulnerability. target.lnk [.ShellClassInfo] CLSID = {0AFACED1-E828-11D1-9187-B532F1E9575D} CLSID2 = {0AFACED1-E828-11D1-9187-B532F1E9575D} UICLSID = {0AFACED1-E828-11D1-9187-B532F1E9575D} desktop.ini Listing of .Backup0* directory In the root directory of the drive it creates files “System32.dat” and “System32.bin”, the payload DLLs, and the “.thumbs.db” file. The payloads are stored as resources and encrypted with a simple XOR routine. thumbs.db file This is a container for data stolen by the “dskapi” payload. Magic number : 0xEB397F2B … Encoded data The encoded data consists of arrays of encoded strings, separated by a magic value 0xFF875686. Magic number : 0xFF875686 – end of array of records, must search for the next Magic 0xFF875683 XOR ( recordLength + 5 ) – start of record Every record is encrypted by a simple algorithm using the character’s position and record length and can be decrypted with the following code: for ( unsigned int j = 0; j < recordLen; j++ ) { ptr[i + j] ^= recordLen; ptr[i + j] -= j; } Smdk.ocx Name of the module used in Gauss: “UsbDir” Some known MD5 5604A86CE596A239DD5B232AE32E02C6 90F5C45420C295C73067AF44028CE0DD Date of compilation 27.09.2011 17.10.2011 Creates events: “{B336C220-B158}”, “Global\SmSrvReady” All functionality is implemented in “RevertCache” export. The module starts its main thread and then returns. The main thread waits for the “{B336C220-B158}” event and continuously checks for the presence of anti-malware software. “ValidateEntry” signals the “{B336C220-B158}” event, allowing for the disk enumeration routine to start. Writes log file: %temp%\~mdk.tmp Reads registry key HKLM\SYSTEM\CurrentControlSet\Services\Disk\Enum Checks for running antimalware products by names and exits if they are present: McDmn.ocx Name of the module used in Gauss: “McDomain” known MD5 9CA4A49135BCCDB09931CF0DBE25B5A9 Date of compilation 16.09.2011 This module is a Windows DLL file with one exported function called “DllRegisterServer.” It creates log file: %temp%\md.bak that is encrypted with 2-byte XOR. Uses LsaQueryInformationPolicy to retrieve the name of the primary domain. Retrieves information about network adapters. All this information is encrypted and stored in the log file. On Windows Vista and Windows 7 : ..\Utils\MyWlanApi.cpp .\SavedWNetworkConnectionsWin6.cpp .\VisibleNetworks.cpp Uses extended wlanapi.dll API to access WLAN information. Enumerates available wireless interfaces, then enumerates all profiles and extracts SSID, name and wireless key information. Then, it retrieves the list of wireless networks visible to all the wireless interfaces. The log file is encrypted with a simple 1-byte XOR. Contains encrypted debug information that includes the location and files of the project: Telemetry: It retrieves and logs the following: . Computer name . Windows OS version . List of running processes . List of directories in %PROGRAMFILES% . Version of Internet Explorer browser . Primary domain name . Network adapter information Searches for Cookies directory, retrieves all cookie files and writes their contents into its log. Searches for cookies that contain the following strings: Installs the Firefox extension, on Windows Vista and Windows 7 into AppData\Roaming\Mozilla\Firefox\Profiles, on earlier versions into Application Data\Mozilla\Firefox\Profiles. All files are written in a directory named “{a288cad4-7b24-43f8-9f4d-8e156305a8bc}”. The Firefox extension extracts the following data: . Browsing history . Passwords (saved and entered by the user) . Cookies. The extension can be configured to look only for cookies of Google, Hotmail, Facebook, Yahoo The Firefox extension writes several log files in its directory:  rssf.dat  Browsing history  mppd.dat Collected passwords Font information from Font Viewer In the example above, we can see the C&C domains/hosts together with the name of the script (userhome.php) on the server which is used for communication. Going through the multitude of Gauss samples, we identified several domains used as C&C servers: . *.gowin7.com . *.secuurity.net . *.datajunction.org . *.bestcomputeradvisor.com . *.dotnetadvisor.info . *.guest-access.net 01.06.2011 dotnetadvisor.info bestcomputeradvisor.info datajunction.org guest-access.net 18.07.2011 *.bestcomputeradvisor.info *.guest-access.net 20.10.2011 *.datajunction.org *.dotnetadvisor.info Depending on the variant, * can be ‘a’ or ‘b’ or ‘c’ – and so on.For instance, a fully qualified hostname as in the example above is “b.gowin7.com”. Most samples we have use “*.gowin7.com” and “*.secuurity.net”. The domains “gowin7.com” and “secuurity.net “ have been registered by  an “Adolph Dybevek, which is most likely a fake identity: They were previously hosted in the US, at the IPs: 173.204.235.204 and 173.204.235.196. We currently have seen samples which used {e,g,h}.bestcomputeradvisor.com and “c.dotnetadvisor.info” for command-and.control. It’s quite possible that other samples exist pointing to different hosts. The additional domains ”datajunction.org” and “guest-access.net” can be found in some samples and it is also used for C&C communications. We currently have samples which use “c.datajunction.org” and “d.datajunction.org” but there are probably others using “a.*” and “b.*”. Both have been registered by somebody named “Peter Kulmann,” probably another fake identity: 