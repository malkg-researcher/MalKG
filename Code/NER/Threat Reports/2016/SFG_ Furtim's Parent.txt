Nt* 
and 
Rtl* 
INT 
2Eh 
CALL 
ntdll!KiFastSystemCall 



ntdll.dll 


kernel32.dll 
user32.dll 
C:\Windows\Temp:1 
explorer.exe 
SetupExecute 
BootExecute 
HKLM\SYSTEM\CurrentControlSet\Control\Session 
Manager\\ 


rdpinst.exe 
\Registry\Machine\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce 


Subsystem 


Native 
WindowsGUI 



Intel(R) 
Xeon(R) 
CPU 
Common 
KVM 
processor 
Common 
32-bit 
KVM 
Virtual 
CPU 
Intel 
Celeron_4x0 
(Conroe/Merom 
Class 
Core 
2) 
Westmere 
E56xx/L56xx/X56xx 
(Nehalem-C) 
Intel 
Core 
2 
Duo 
P9xxx 
(Penryn 
Class 
Core 
2) 
Intel 
Core 
i7 
9xx 
(Nehalem 
Class 
Core 
i7) 
Intel 
Xeon 
E312xx 
(Sandy 
Bridge) 
AMD 
Opteron 
240 
(Gen 
1 
Class 
Opteron) 
AMD 
Opteron 
22xx 
(Gen 
2 
Class 
Opteron) 
AMD 
Opteron 
23xx 
(Gen 
3 
Class 
Opteron) 
AMD 
Opteron 
62xx 
class 
CPU 
Intel 
CPU 
version 


# 
kvm 
cpu 
? 
x86 
qemu64 
QEMU 
Virtual 
CPU 
version 
2.4.0 
x86 
phenom 
AMD 
Phenom(tm) 
9550 
Quad-Core 
Processor 
x86 
core2duo 
Intel(R) 
Core(TM)2 
Duo 
CPU 
T7700 
@ 
2.40GHz 
x86 
kvm64 
Common 
KVM 
processor 
x86 
qemu32 
QEMU 
Virtual 
CPU 
version 
2.4.0 
x86 
kvm32 
Common 
32-bit 
KVM 
processor 
x86 
coreduo 
Genuine 
Intel(R) 
CPU 
T2600 
@ 
2.16GHz 
x86 
486 
x86 
pentium 
x86 
pentium2 
x86 
pentium3 
x86 
athlon 
QEMU 
Virtual 
CPU 
version 
2.4.0 
x86 
n270 
Intel(R) 
Atom(TM) 
CPU 
N270 
@ 
1.60GHz 
x86 
Conroe 
Intel 
Celeron_4x0 
(Conroe/Merom 
Class 
Core 
2) 
x86 
Penryn 
Intel 
Core 
2 
Duo 
P9xxx 
(Penryn 
Class 
Core 
2) 
x86 
Nehalem 
Intel 
Core 
i7 
9xx 
(Nehalem 
Class 
Core 
i7) 
x86 
Westmere 
Westmere 
E56xx/L56xx/X56xx 
(Nehalem-C) 
x86 
SandyBridge 
Intel 
Xeon 
E312xx 
(Sandy 
Bridge) 
x86 
IvyBridge 
Intel 
Xeon 
E3-12xx 
v2 
(Ivy 
Bridge) 
x86 
Haswell-noTSX 
Intel 
Core 
Processor 
(Haswell, 
no 
TSX) 
x86 
Haswell 
Intel 
Core 
Processor 
(Haswell) 
x86 
Broadwell-noTSX 
Intel 
Core 
Processor 
(Broadwell, 
no 
TSX) 
x86 
Broadwell 
Intel 
Core 
Processor 
(Broadwell) 
x86 
Opteron_G1 
AMD 
Opteron 
240 
(Gen 
1 
Class 
Opteron) 
x86 
Opteron_G2 
AMD 
Opteron 
22xx 
(Gen 
2 
Class 
Opteron) 
x86 
Opteron_G3 
AMD 
Opteron 
23xx 
(Gen 
3 
Class 
Opteron) 
x86 
Opteron_G4 
AMD 
Opteron 
62xx 
class 
CPU 
x86 
Opteron_G5 
AMD 
Opteron 
63xx 
class 
CPU 
x86 
host 
KVM 
processor 
with 
all 
supported 
host 
features 
(only 
available 
in 
KVM 
mode) 


VMwareVMware 
XenVMMXenVMM 
KVMKVMKVM 
prl 
hyperv 
Microsoft 
Hv 


GetComputerNameW() 


brbrb-d8fb22af1 
jonathan-c561e0 
avreview1-VMXP 
vwinxp-maltest 
avreview-VMSunbox 
infected-system 



GetModuleFileNameW() 


C:\xxx\sample.exe 
C:\sample.exe 
C:\Shared\dum._vxe 
C:\SniferFiles\sample.exe 
C:\virus\virus.exe 
C:\virus.exe 
c:\sampel.exe 
C:\setup.exe 
C:\runme.exe 
c:\VMRun\Zample.exe 
c:\FILE.EXE 
C:\run\temp.exe 
c:\taskrun\samples\rtktst.exe.exe 
c:\artifact.exe 
C:\manual\sunbox.exe 
C:\1.exe 


malware.exe 
\virus\ 
admin\downloads\samp1e_ 
sample_execution 
mlwr_smpl.exe 


'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\\xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx' 


kernel32.dll 
ntdll.dll 
ntdll.dll 
ntdll.dll 
kernel32.dll 


ntdll.dll 
kernel32.dll 
ntdll.dll 


ntdll!LdrGetDllHandle() 
kernel32!GetModuleHandle() 



C:\agent\agent.pyw 
C:\sandbox\starter.exe 
c:\ipf\BDCore_U.dll 
C:\cwsandbox_manager 
C:\cwsandbox 
C:\Stuff\odbg110 
C:\gfisandbox 
C:\Virus 
Analysis 
C:\iDEFENSE\SysAnalyzer 
c:\gnu\bin 
C:\SandCastle\tools 
C:\cuckoo\dll 
C:\MDS\WinDump.exe 
C:\tsl\Raptorclient.exe 
C:\guest_tools\start.bat 
C:\tools\aswsnx\snxcmd.exe 
C:\Winap\ckmon.pyw 
c:\tools\decodezeus 
c:\tools\aswsnx 
C:\sandbox\starter.exe 
C:\Kit\procexp.exe 
c:\tracer\mdare32_0.sys 
C:\tool\malmon 
C:\Samples\102114\Completed 
c:\vmremote\VmRemoteGuest.exe 
d:\sandbox_svc.exe 


RtlGetNativeSystemInformation(SystemBasicInformation, 
...) 
struct 
SYSTEM\_BASIC\_INFORMATION 
\_SYSTEM\_BASIC\_INFORMATION.NumberOfProcessors 


'Intel(R) 
Core(TM) 
i7' 
'Intel(R) 
Core(TM) 
i5' 
'Intel(R) 
Core(TM) 
i3' 
'Intel(R) 
Core(TM)2 
Duo 
CPU' 


NtQuerySystemInformation() 


struct 


SYSTEM_BASIC_INFORMATION 


dir_watch.dll 
tracer.dll 
SbieDll.dll 
APIOverride.dll 
NtHookEngine.dll 
api_log.dll 
LOG_API.DLL 
LOG_API32.DLL 


ntdll!LdrGetDllHandle() 


ntdll!RtlGetNativeSystemInformation(SystemModuleInformation, 
...) 



QueryFullProcessImageNameW() 




\Registry\Machine\HARDWARE\DESCRIPTION\System\ 



IPHLPAPI!GetAdaptersInfo() 



00:01:02:03:04:xx 
00:03:FF:xx:xx:xx 
00:0C:29:xx:xx:xx 
08:00:27:xx:xx:xx 
00:07:e9:e4:ce:4d 
00:30:18:ab:d7:f2 
00:ff:f2:f8:30:xx 
00:50:56:xx:xx:xx 
52:54:00:12:34:56 
00:1c:42:xx:xx:xx 
00:15:5d:xx:xx:xx 
00:1d:d8:xx:xx:xx 



IN 


IN 



GetCursorPosition() 


GetCursorPosition() 



host 


0.0.0.0 



%SystemRoot%\rdpinst.exe 



\Registry\Machine\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce 



nullptr 


Tweet 



